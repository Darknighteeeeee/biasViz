  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
V3.1.0
**What is the issue or idea you have?**
browser.apps only include some browser, example my phone has installed Firefox,Chrome,UC Browser,QQ Browser,System Browser, but only Firefox and System Browser are visible.
![image](https://user-images.githubusercontent.com/26616673/43186647-e2f26c54-9021-11e8-9c7b-6e7b0226d441.png)


**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
Every devices.

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  First thank you for this great tool! :)

**My issue:**
I have 7 devices attached to my local server, somehow some of the phones are detected with phone numbers and others not.

It is helpful to see the numbers for each attached device and would be good if all of them displays the number. Is this issue device related?

Many thanks! Thank you for your response.

Here are the 7 devices: _(**NND** - number not detected)_

- Wiko Lenny 2 - **_NND_** (Vodafone, Android 5.1)
- Samsung S5 Mini - **_NND_** (Orange, Android 6.0.1)
- Samsung S8 - **_NND_** (Vodafone, Android 8.0)
- Samsung S6 Edge - OK, Android 6.0.1
- Samsung A5 (2017) - OK, Android 7.0
- Sony Z3 - OK, Android 6.0.1
- Sony Z5 - OK , Android 7.0

 @newbie-qa do that devices marked NND have the same SIM card as one of the OK?
On some SIM cards number is not stored. the 7 devices have their own different SIMs.  Sometimes when i change SIM for OK devices, it does not reflect the correct number but after restart of ADB, it works and displays the correct number. For NND devices, ADB restart does not fix the problem :(
  Hi,
When I use stf , always it works very vell, but it may be black screen sometime.
The console output as follows:
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Requesting frame producer to stop
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Disconnecting from minicap service
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Stopping minicap service
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Sending SIGTERM to minicap
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (jni/minicap/minicap.cpp:197) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (jni/minicap/minicap.cpp:516) Closing client connection"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:291) Destroying virtual display"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Keeping 627x867 as current frame producer projection
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Requesting frame producer to start
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Launching screen service
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "PID: 12690"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: Using projection 1080x1920@488x867/0"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:241) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:244) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:255) Creating virtual display"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:261) Creating buffer queue"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:264) Setting buffer options"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:268) Creating CPU consumer"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:272) Creating frame waiter"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:276) Publishing virtual display"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Connecting to minicap service
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 6268932 bytes for JPG encoder"
INF/device:plugins:screen:stream 19027 [GWY0217117012398] Reading minicap banner
INF/device:plugins:screen:stream 19027 [GWY0217117012398] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
IMP/device:plugins:connect 19027 [GWY0217117012398] Remote Connect Started for device "GWY0217117012398" at "10.167.3.124:7401"

![image](https://user-images.githubusercontent.com/26616673/42796020-f96d9d32-89b9-11e8-801f-0291eefd4f2c.png)



 The device is HUA WEI Mate9，the model is MHA-AL00.   The latest version of ADB introduced 2 new device status: connecting and authorizing

See https://github.com/aosp-mirror/platform_system_core/commit/704494b0707a49e064b63192619a73336c1be05a

Without these states, devices sometimes have a problem getting registered with STF.  The error that's encountered is something along the lines of:

```
Jul 13 15:00:36 stf run.sh[2109]: Unhandled rejection Error: Illegal value for Message.Field .DeviceIntroductionMessage.status of type enum: undefined (not a valid enum value)
Jul 13 15:00:36 stf run.sh[2109]:     at Field.<anonymous> (/home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:2641:27)
Jul 13 15:00:36 stf run.sh[2109]:     at Field.ProtoBuf.Reflect.FieldPrototype.verifyValue (/home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:2738:25)
Jul 13 15:00:36 stf run.sh[2109]:     at MessagePrototype.set (/home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:1799:63)
Jul 13 15:00:36 stf run.sh[2109]:     at Message (/home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:1728:42)
Jul 13 15:00:36 stf run.sh[2109]:     at /home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/lib/units/provider/index.js:165:29
Jul 13 15:00:36 stf run.sh[2109]:     at /home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/lib/units/provider/index.js:161:22
Jul 13 15:00:36 stf run.sh[2109]:     at Tracker.<anonymous> (/home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/lib/units/provider/index.js:144:16)
Jul 13 15:00:36 stf run.sh[2109]:     at emitOne (events.js:96:13)
Jul 13 15:00:36 stf run.sh[2109]:     at Tracker.emit (events.js:191:7)
Jul 13 15:00:36 stf run.sh[2109]:     at Tracker.update (/home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/node_modules/adbkit/lib/adb/tracker.js:62:14)
Jul 13 15:00:36 stf run.sh[2109]:     at /home/tapjoy/.nvm/versions/node/v7.8.0/lib/node_modules/stf/node_modules/adbkit/lib/adb/tracker.js:38:15
Jul 13 15:00:36 stf run.sh[2109]:     at runCallback (timers.js:672:20)
```

If you look at the device status, you'll see

```
Jul 13 15:00:35 stf run.sh[2109]: 2018-07-13T19:00:35.994Z INF/provider 2321 [*] Found device "..." (connecting)
```

I was able to verify after making this change that my phones would get properly registered and no errors were shown when unplugging / plugging back in.

This fixes #907.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

I have STF up and running just fine without any issues. It is very stable and works great. My only question is if there is a way to refresh STF without having to restart it to pick up new phones. Whenever I plug in a new phone, STF attempts to read it and then throws some error. To get it to register, I have to close the CLI and re-run STF to get the server back up which then reads the phone just fine. 

Note: I am running stf local - public IP (which I know is not recommended) for testing reasons. 

Outside of having to restart STF to pick up newly plugged in devices, the system works great. Thanks for all the hard work put into this. 
 I've had these exact symptoms but had assumed it was my wonky docker deployment. Ill get it all hooked up again and get dumps of all the logs when I can. My issue had todo with how I was passing the USB devices in docker and not a problem with STF itself.  I downloaded the stf files from the github and made a few UI changes and I want to deploy STF locally with the UI changes I have made. How do I do this?  I am using docker-compose with a Raspberry Pi. One device is not shown within openSTF, I see no logs about it.

**What is the issue or idea you have?**

 When I do a lsusb, I can only see IDs, not the device.
```Bus 001 Device 004: ID 274c:0101```
dmesg gives me some information:
```[    2.152638] usb 1-1.3: New USB device found, idVendor=274c, idProduct=0101```
For another issue, I saw that you advised to use
```DEBUG=adb* stf local```
to get more information.
I tried that, but it did not change anything:
```services:
    stf:
        image: openstf/stf-armv7l
        privileged: true
        container_name: openstf
        depends_on:
            - db
            - adb
        network_mode: host
        environment:
          - DEBUG=adb*
        command: "stf local --public-ip 192.168.0.12"
```

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
Yes, it does happen only on one specific device.
I added
```# MyDeviceName
SUBSYSTEMS=="usb", ATTRS{idVendor}=="274c", ATTRS{idProduct}=="0101", MODE="0666" GROUP="plugdev", SYMLINK+="android%n"
```
in /etc/udev/rules.d/51-android.rules but that didn't change anything (yes, I rebooted).

**Please provide the steps to reproduce the issue.**
After modifying my install with what I found [there](https://stackoverflow.com/questions/9210152/set-up-device-for-development-no-permissions), I managed to get the device available under my Linux machine:
```$ adb devices -l
List of devices attached
42583930325537345546   device usb:1-1.1.2
A0F6FD7290AA           device usb:1-1.3 product:myproduct model:myModel device:myDevice
```
Unfortunately, it still can't be seen under Docker. If someone knows what I should modify in the Docker image, please let me know.

I have modified the ADB image, replicating the changes I had made on my machine hosting Docker:
```
ADD files/51-android.rules /etc/udev/rules.d/51-android.rules
RUN chmod 644 /etc/udev/rules.d/51-android.rules && chown root. /etc/udev/rules.d/51-android.rules
```
but that did not make a single change in the device detection.

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
```
$ docker-compose exec stf stf doctor
2018-07-12T16:19:11.626Z INF/cli:doctor 146 [*] OS Arch: arm
2018-07-12T16:19:11.636Z INF/cli:doctor 146 [*] OS Platform: linux
2018-07-12T16:19:11.639Z INF/cli:doctor 146 [*] OS Platform: 4.14.34-hypriotos-v7+
2018-07-12T16:19:11.640Z INF/cli:doctor 146 [*] Using Node 6.11.2
2018-07-12T16:19:11.722Z INF/cli:doctor 146 [*] Using ZeroMQ 4.1.5
2018-07-12T16:19:11.814Z INF/cli:doctor 146 [*] Using GraphicsMagick 1.3.25
2018-07-12T16:19:11.816Z INF/cli:doctor 146 [*] Using ProtoBuf 3.1.0
2018-07-12T16:19:11.820Z ERR/cli:doctor 146 [*] RethinkDB is not installed (`rethinkdb` is missing)
2018-07-12T16:19:11.821Z ERR/cli:doctor 146 [*] ADB is not installed (`adb` is missing)
```
 Thanks @sorccu . The device is not a phone (my specialty, plugging in Android devices which are not phones), and is not powered by USB.
So there is nothing to change in the STF image, nor ARM image (except the ADB version maybe). If this works on the Raspberry machine directly, it should work within Docker, am I right? Thanks a lot @sorccu , will do.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 Thank you   Simo Kinnunen ,I think thanks word is very less now.


*Best Regards*

*Manju Yadav*


On Thu, Jul 12, 2018 at 4:27 PM, Simo Kinnunen <notifications@github.com>
wrote:

> When you install STF, it builds a new resource cache. You have to clear
> the cache first if you change something. Run:
>
> ‘./node_modules/.bin/gulp clean’
>
> Then try again.
>
> —
> You are receiving this because you authored the thread.
> Reply to this email directly, view it on GitHub
> <https://github.com/openstf/stf/issues/909#issuecomment-404473713>, or mute
> the thread
> <https://github.com/notifications/unsubscribe-auth/AnNf7VmcVbQdyasSb7yDj5g4Ps-Xz01kks5uFyuUgaJpZM4VMWaa>
> .
>
 Hi  Simo Kinnunen,

*will it work for IOS?*

Best Regards
*Manju Yadav*

On Sat, Jul 14, 2018 at 9:43 PM, Manju Yadav <manjuyadav.16ss@gmail.com>
wrote:

> Thank you   Simo Kinnunen ,I think thanks word is very less now.
>
>
> *Best Regards*
>
> *Manju Yadav*
>
>
> On Thu, Jul 12, 2018 at 4:27 PM, Simo Kinnunen <notifications@github.com>
> wrote:
>
>> When you install STF, it builds a new resource cache. You have to clear
>> the cache first if you change something. Run:
>>
>> ‘./node_modules/.bin/gulp clean’
>>
>> Then try again.
>>
>> —
>> You are receiving this because you authored the thread.
>> Reply to this email directly, view it on GitHub
>> <https://github.com/openstf/stf/issues/909#issuecomment-404473713>, or mute
>> the thread
>> <https://github.com/notifications/unsubscribe-auth/AnNf7VmcVbQdyasSb7yDj5g4Ps-Xz01kks5uFyuUgaJpZM4VMWaa>
>> .
>>
>
>
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
I just changed the auth setting from mock to LDAP since our team wanted this way. But after switching to LDAP, an logged in user can not access to the smartphone. An user can log in, and provider could recognize the device, but when I click the 'use' button, I get "Socket connection was lost" message.

**Please provide the steps to reproduce the issue.**
I am using Docker Compose to run

here is the docker-compose segment that is related to this issue

```
app:
    image: openstf/stf:latest
    restart: unless-stopped
    environment:
      - RETHINKDB_PORT_28015_TCP
      - SECRET
    command: stf app --auth-url http://${PUBLIC_IP}/auth/ldap/ --websocket-url ws://${PUBLIC_IP}/ --port 3000
    depends_on:
      - rethinkdb
      - auth
      - websocket
  auth:
    image: openstf/stf:latest
    restart: unless-stopped
    environment:
      - SECRET
    command:
      stf auth-ldap --app-url http://${PUBLIC_IP}/ --port 3000 \
      stf auth-ldap --ldap-search-dn ou=people,ou=intranet,dc=motorola,dc=com \
      stf auth-ldap --ldap-search-field uid \
      stf auth-ldap --ldap-url ldap://ids.mot-solutions.com:389 


```
**Error message when I toggle 'use' button on the pannel.**

Here are the logs when I try to use the device.
```
nginx_1                 | 10.2.114.41 - - [11/Jul/2018:14:38:58 +0000] "GET /static/app/devices/icon/x24/E30HT.jpg HTTP/1.1" 304 0 "http://stf.am.mot-solutions.com/" "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0"
nginx_1                 | 10.2.114.41 - - [11/Jul/2018:14:38:58 +0000] "GET /static/app/build/fda02a702c4a73c27958341c42582645.png HTTP/1.1" 304 0 "http://stf.am.mot-solutions.com/" "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0"
websocket_1             | /app/node_modules/protobufjs/dist/ProtoBuf.js:2641
websocket_1             |                     throw Error("Illegal value for "+this.toString(true)+" of type "+this.type.name+": "+val+" ("+msg+")");
nginx_1                 | 10.2.114.41 - - [11/Jul/2018:14:38:58 +0000] "GET /socket.io/?uip=10.2.114.41&EIO=3&transport=websocket HTTP/1.1" 101 122 "-" "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0"
websocket_1             |                     ^
websocket_1             | 
websocket_1             | Error: Illegal value for Message.Field .OwnerMessage.name of type string: object (no array expected)
websocket_1             |     at Error (native)
websocket_1             |     at T.<anonymous> (/app/node_modules/protobufjs/dist/ProtoBuf.js:2641:27)
websocket_1             |     at T.ProtoBuf.Reflect.FieldPrototype.verifyValue (/app/node_modules/protobufjs/dist/ProtoBuf.js:2659:21)
websocket_1             |     at MessagePrototype.set (/app/node_modules/protobufjs/dist/ProtoBuf.js:1799:63)
websocket_1             |     at Message (/app/node_modules/protobufjs/dist/ProtoBuf.js:1728:42)
websocket_1             |     at Socket.<anonymous> (/app/lib/units/websocket/index.js:683:17)
websocket_1             |     at emitThree (events.js:116:13)
websocket_1             |     at Socket.emit (events.js:194:7)
websocket_1             |     at /app/node_modules/socket.io/lib/socket.js:528:12
websocket_1             |     at _combinedTickCallback (internal/process/next_tick.js:73:7)
websocket_1             |     at process._tickCallback (internal/process/next_tick.js:104:9)
```

**Please run `stf doctor` and paste the output here.**

Here are the results when I run `stf doctor` on websocket container.  I have Rethink Cluster running. I am wondering if this is happening because of ProtoBuf is not installed inside of the websocket container. But the error messages point to the ProtoBuf.js path. I don't know what is causing this disconnection error. 
```
2018-07-11T14:37:46.011Z INF/cli:doctor 58 [*] OS Arch: x64
2018-07-11T14:37:46.013Z INF/cli:doctor 58 [*] OS Platform: linux
2018-07-11T14:37:46.014Z INF/cli:doctor 58 [*] OS Platform: 4.13.0-46-generic
2018-07-11T14:37:46.014Z INF/cli:doctor 58 [*] Using Node 6.11.2
2018-07-11T14:37:46.034Z INF/cli:doctor 58 [*] Using ZeroMQ 4.1.4
2018-07-11T14:37:46.057Z INF/cli:doctor 58 [*] Using GraphicsMagick 1.3.23
2018-07-11T14:37:46.058Z ERR/cli:doctor 58 [*] RethinkDB is not installed (`rethinkdb` is missing)
2018-07-11T14:37:46.059Z ERR/cli:doctor 58 [*] ProtoBuf is not installed (`protoc` is missing)
2018-07-11T14:37:46.059Z ERR/cli:doctor 58 [*] ADB is not installed (`adb` is missing)

``` Thank you @sorccu, the cn value which is the default value of the --ldap-username-field's was weird on our end. Fixing the value of --ldap-username-field to point to uid worked. Thank you!  when the smartphone change, there is error below
then device isn't recognized

reinstalling nodejs, protobuf etc..
 
Unhandled rejection Error: Illegal value for Message.Field .DeviceIntroductionMessage.status of type enum: undefined (not a valid enum value)
    at Error (native)
    at T.<anonymous> (/usr/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:2641:27)
    at T.ProtoBuf.Reflect.FieldPrototype.verifyValue (/usr/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:2738:25)
    at MessagePrototype.set (/usr/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:1799:63)
    at Message (/usr/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:1728:42)
    at /usr/lib/node_modules/stf/lib/units/provider/index.js:165:29
    at /usr/lib/node_modules/stf/lib/units/provider/index.js:161:22
    at Tracker.<anonymous> (/usr/lib/node_modules/stf/lib/units/provider/index.js:144:16)
    at emitOne (events.js:96:13)
    at Tracker.emit (events.js:188:7)
    at Tracker.update (/usr/lib/node_modules/stf/node_modules/adbkit/lib/adb/tracker.js:62:14)
    at /usr/lib/node_modules/stf/node_modules/adbkit/lib/adb/tracker.js:38:15
Unhandled rejection Error: Illegal value for Message.Field .DeviceIntroductionMessage.status of type enum: undefined (not a valid enum value)
    at Error (native)
    at T.<anonymous> (/usr/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:2641:27)
    at T.ProtoBuf.Reflect.FieldPrototype.verifyValue (/usr/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:2738:25)
    at MessagePrototype.set (/usr/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:1799:63)
    at Message (/usr/lib/node_modules/stf/node_modules/protobufjs/dist/ProtoBuf.js:1728:42)
    at /usr/lib/node_modules/stf/lib/units/provider/index.js:165:29
    at /usr/lib/node_modules/stf/lib/units/provider/index.js:161:22
    at Tracker.<anonymous> (/usr/lib/node_modules/stf/lib/units/provider/index.js:144:16)
    at emitOne (events.js:96:13)
    at Tracker.emit (events.js:188:7)
    at Tracker.update (/usr/lib/node_modules/stf/node_modules/adbkit/lib/adb/tracker.js:62:14)
    at /usr/lib/node_modules/stf/node_modules/adbkit/lib/adb/tracker.js:38:15
 I appear to get this error because the device's `type` is set to `connecting` and there's no corresponding status here: https://github.com/openstf/stf/blob/616d4407ce1494a7a89ed6c1a17677b88e15e455/lib/wire/util.js#L10-L17 Looks like some new states have been added in the latest version of ADB: https://github.com/aosp-mirror/platform_system_core/commit/704494b0707a49e064b63192619a73336c1be05a

Specifically "connecting" and "authorizing"  **Is your feature request related to a problem? Please describe.**
Let's say that I have a bunch of providers running Docker. Would there be any advantage to use Docker swarm instead of different Docker machines running docker-compose (except for administrating these machines)?

**Describe the solution you'd like**
docker stack deploy instead of multiple docker-compose --build up.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
One or two Android devices per provider (cheap provider, not powerful).

Thanks.
 I've just started setting up openSTF and more as tech demo then a "prod" ready service for QA but the issues I've run into with docker swarm is privileged containers aren't support on docker swarm, the way around this is to make a docker image that loads the privileged images. This is all doable what I'm trying to get going is two distributed system one for the reThinkDB so thats distributed throughout the stack and then also have the stf cluster distribute throughout so the load balanced, My theory is hopefully everything should be pretty smooth if the services can use the resources of every device. I'm doing all this testing on a raspberry pi 3 B with raspberry pi 2s as the worker nodes. Hi @mr-sour,

I was subscribing to this issue since I also want to implement openSTF on Docker Swarm. I just started to learn Docker and Docker Swarm and some sort of guide would be super helpfull. Could you please share how you implemented STF with Docker Swarm?  @sonamoo I have only been able to implement each device as a standalone instance of openSTF but though swarmmode with services (I guess if your using standalone swarm thats a whole different can of worms) I can get a gist of what I've done so far it not that bad when you break it down. Like I mentioned the only thing that throws a wrench in things is the lack of privileged containers in swarm mode I talked with them about this and I'm not sure they're gonna get that implemented anytime soon. I've got a workaround from the docker team that I'm sure if you dug around enough you would find on their github but Ill get that in there to. Like I said this is more of a tech demo and I dont even have all the parts yet (just ordered a pico cluster) So development might be a little slow for a couple of days here. @mr-sour, @sorccu,  Thanks! I will also be learning docker swarm and trying to implement this. I will probably do this on the weekends. I will update here when I find solutions.    can stf run on android? if not ,why?has anyone done this? 
I want use tablet （Android） control several devices . i still have no idea.  I could be wrong, but I think porting stf to Android could prove as difficult as porting Linux to your tablet.
A Raspberry Pi 3B+ is not the recommended platform, but it works for me. At $35, you can't go wrong...  **What is the issue or idea you have?**

STF does not appear to be passing the state token to the Oauth2 provider (IBM Security Access Manager) when running "local" with a public IP

**Please provide the steps to reproduce the issue.**
Running an instance of STF local with a remote Nginx server doing HTTPS (configured per deployment guide)

1. Launch STF:

<pre>export STF_AUTH_OAUTH2_OAUTH_CLIENT_SECRET=XXXXXXX
export STF_AUTH_OAUTH2_OAUTH_CALLBACK_URL=https://XXXXXXX/auth/oauth/callback
export STF_AUTH_OAUTH2_OAUTH_USERINFO_URL=https://XXXXXXX/mga/sps/oauth/oauth20/introspect
export STF_AUTH_OAUTH2_OAUTH_SCOPE=openid email
export STF_AUTH_OAUTH2_OAUTH_CLIENT_ID=XXXXXXX
export STF_AUTH_OAUTH2_OAUTH_AUTHORIZATION_URL=https://XXXXXXX/mga/sps/oauth/oauth20/authorize
export STF_AUTH_OAUTH2_OAUTH_TOKEN_URL=https://XXXXXXX/mga/sps/oauth/oauth20/token

stf local --public-ip XXXXXXX --lock-rotation --auth-type oauth2</pre>

**What is the expected behavior?**

I'd expect the state token to be sent to the authentication provider

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

<pre>AuthorizationError: FBTOAU202E The required parameter: [state] was not found in the request.
    at Strategy.OAuth2Strategy.authenticate (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/passport-oauth2/lib/strategy.js:131:25)
    at attempt (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/passport/lib/middleware/authenticate.js:348:16)
    at authenticate (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/passport/lib/middleware/authenticate.js:349:7)
    at Layer.handle [as handle_request] (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/index.js:317:13)
    at /home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/index.js:284:7
    at Function.process_params (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/index.js:335:12)
    at next (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/index.js:275:10)
    at initialize (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/passport/lib/middleware/initialize.js:53:5)
    at Layer.handle [as handle_request] (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/index.js:317:13)
    at /home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/index.js:284:7
    at Function.process_params (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/index.js:335:12)
    at next (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/index.js:275:10)
    at expressInit (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/middleware/init.js:40:5)
    at Layer.handle [as handle_request] (/home/stfuser/npm/build/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)</pre>

**Please run `stf doctor` and paste the output here.**

<pre>2018-07-03T15:41:08.920Z INF/cli:doctor 40144 [*] OS Arch: x64
2018-07-03T15:41:08.921Z INF/cli:doctor 40144 [*] OS Platform: linux
2018-07-03T15:41:08.922Z INF/cli:doctor 40144 [*] OS Platform: 4.4.0-128-generic
2018-07-03T15:41:08.922Z INF/cli:doctor 40144 [*] Using Node 8.11.1
2018-07-03T15:41:08.951Z INF/cli:doctor 40144 [*] Using ZeroMQ 4.2.3
2018-07-03T15:41:08.985Z INF/cli:doctor 40144 [*] Using ADB 1.0.39
2018-07-03T15:41:08.987Z INF/cli:doctor 40144 [*] Using RethinkDB 2.3.6~0xenial
2018-07-03T15:41:09.147Z INF/cli:doctor 40144 [*] Using ProtoBuf 3.5.1
2018-07-03T15:41:09.313Z INF/cli:doctor 40144 [*] Using GraphicsMagick 1.3.23</pre> Yep, that fixed it. Thanks!  Maybe next time I'll send a patch.  You know, once I learn a thing or two about NodeJS  Is there any way for me for Remote control  device from the phone devices not browser?  The license file says that STF is under Apache license 2.0, but some packages (i.e packery, hipchatter) used by STF are under GPLv2 and GPLv3 licenses, is it means that STF should be under the more restrictive license, that is GPL ?

What is the impact for external contributors ?

On behalf of my company, I would like to contribute to OpenSTF to add some rich features, but I saw in the code that no contributor has added their author copyright, is it the rule in the OpenSTF project or is it possible to add our copyright ?

Thanks. What about also my third question relating to copyright ?

Regarding licenses, I found a tool named 'npm-consider' (cf. https://github.com/delfrrr/npm-consider) which analyses dependencies of dependencies from package.json:
```
$ npm-consider install
stf@3.3.0
Packages  1373                      
Size      84.15 MB                  
Licenses  Permissive         1317   
          Protective         2      
          Uncategorized      49     
          Weakly Protective  2      
          Public Domain      3      
? What is next? Details
```
Here is an extract of the console output:
```
hipchatter@0.3.2, Protective, GPL-2.0, dependencies: async@~0.2.9, needle@^1.0.0
xmldom@0.1.27, Weakly Protective, LGPL
xmldom@0.1.19, Weakly Protective, LGPL
stf-device-db@1.2.0, Protective, CC-BY-SA-4.0
```
But it exists a general tool named 'scancode' (cf. https://github.com/nexB/scancode-toolkit) which can be used to analyse deeper the code both for npm and bower packages. For instance, I found some npm packages as 'adm-zip' or 'aws-sdk' which are published under permissive licenses but including 'js' files under protective licenses...

At bower side, I just find 'packery' under GPLv3 license but sure a deeper inspection has to be made.


 The GPLv2 does not infect other projects unless you actually link them into your program (ie shared object).  So for a shared object the library needs to be licensed LGPL -- that is the specific exception included in the LGPL, that the GPL will not infect programs linked to the library. Virtually zero shared objects are licensed GPL since that prevents them from being used in anything other than a GPL program.

The accepted wisdom is that the GPLv2 does not infect over a Javascript module boundary.  This is due to Javascript being a dynamic language.  The GPL only applies to a derived work, a dynamic linkage is not considered a derived work.  Of course none of this is truly settled by going to court, so if you are paranoid you should avoid GPL licensed Javascript modules. You migiht also simply ask the project owner to switch to the LGPL since the LGPL is always safe.

Also note that dev tools have no impact on the license of the output they produce unless they are inserting code. gcc contains a specific exception allowing free use of the run-time it inserts. 

The GPLv3 license of Packery is probably a significant licensing problem (which is why most people avoid GPLv3). I would recommend removing it from the project. Looking at the website, this is likely someone who is going to show up demanding that a commercial license be bought. 

 I am concerned about the Packery module because they have commercial licensing terms in big bold letters right on their home page. They have also picked a very unfriendly open source license as a means of forcing almost everyone to buy a license.  These guys have paid $$$ to lawyer to write all of this....
https://packery.metafizzy.co/license.html Everything else seemed reasonable. Given that Packery is an old MIT version, there shouldn't be any obvious problems.

As for the initial poster's concern with copyright assignment, I'd suggest assigning copyright to the STF team. The only reason for doing this is to make it possible to change the license later without locating all of the copyright holders (which can be a real problem 20 years later). Of course you don't have to do this, it just makes things easier. And for sure the contributor can take credit for their contributions in the files.

An example of this causing a problem is the Linux kernel. The GPL used by the kernel is silent on patent licenses. It would be very beneficial to the kernel to add a patent license clause, but it is impossible to locate all 3,000 of the contributors to get permission to do that change. 

IANAL but I have been dealing with various open source license issues for decades (I'm one of those 3,000 kernel contributors).  I do wish that open source licensing was easier for people to work with. Thanks for these precious answers !
@jonsmirl, what do you mean about "take credit for their contributions (of contributors) in the files" and in the same time "assigning copyright to the STF team" ? In practice, may you give an example of what form should take such a contribution in a file ? You can always write a note into the file saying something like "This code contributed by Acme Corp, www.acme.com". There is no problem with letting contributors let people reading the code know where they are if they are looking for consulting business. There is no legal meaning to the acknowledgement comment, it can be anything you feel is appropriate.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
I am doing the automation.

Appium Docker container -> OpenSTF

The workflow I am doing:
1. Create an Appium Server container from appium/appium image
2. Get remote debug connection string via STF API. (adb connect xxxxxxxx:7676)
3. Run "adb start-server" on Appium server.(in container)
4. Get the adb key from "~./android/adbkey.pub" in Appium server. (in container)
5. **Insert the adb key to STF via API.**
6. Run "adb connect xxxxxxxx:7676" on Appium server (in container)

How to do step 5?


**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  Hi,
I am customising the openstf js code, I am able to track the touchDown events, In order to proceed further I need to identify if the user clicked an area that is clickable. Ex clicking on an open space returns back the same image, but nothing changes, however if user clicks on a icon or button, then there an app or the subsequent screen is displayed. Is there a logic to check if user clicked on a clickable spot  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Hi , when i connect my device to my ubuntu laptop, it says the device is ignored, i disabled the firewalls and everything but still it does not work. do you guys think if i set up a VPN it might work. I am on a office network by the way.
**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  When I use the screenshots and then change other tabs，how to Keep the data when tab switch？
I dont want my screenshots loss。 @sorccu screenshot file is not less，it's on the server，my point is the tab change will destroy screenshots controller。Is there a simple way to keep this controller data?  when I use phone google-Pixel 2 XL  version  9，It cannot work ，minitouch service cannot start ,maybe the minitouch cannot support version 9，here is the log


![qq 20180619145431](https://user-images.githubusercontent.com/16664041/41581335-c0a4e072-73d0-11e8-9d37-7d51de07e594.jpg)
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Hey guys, i am new to this and trying to install stf on ubuntu using google cloud, but due to some reason or other i couldn't get it done, there are like different types of errors thrown up everytime. So i just wanna ask is there any setup guide for ubuntu 16.04 and any ports and firewall setting that i need to add. Thanks, below is just one of the many errors i get during installation.
**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
p WARN EACCES user "root" does not have permission to access the dev dir "/usr/lib/node_modules/stf/node_modules/dtrace-provider/.node-gyp/8.11.3"
gyp WARN EACCES attempting to reinstall using temporary dev dir "/usr/lib/node_modules/stf/node_modules/dtrace-provider/.node-gyp"
gyp WARN EACCES user "root" does not have permission to access the dev dir "/usr/lib/node_modules/stf/node_modules/dtrace-provider/.node-gyp/8.11.3"

 Hey sorccu, thanks
I got it installed
 how its resolved @habeebshk ? because i also face same issue while installing stf
 if we are using nvm node-pre-gyp gets error not found and when we are officially installing node and node-pre-gyp then permission error gets occured please let me know what the resolution  I already use the latest docker version
[Docker Environment]
1. STF 
2. ADB
3. RethinkDB

[Issue]
Step1. Click any Product
![image](https://user-images.githubusercontent.com/26316763/41453004-bf650be2-70a6-11e8-9c39-3bf212af1cce.png)

Step2. Display screen normally
![image](https://user-images.githubusercontent.com/26316763/41453089-fc10cd1a-70a6-11e8-80ec-02e35817e82f.png)

Step3. Click "x" to stop using and back to home page
Step4. Click the previous product, but no screen display
![image](https://user-images.githubusercontent.com/26316763/41453219-736a1614-70a7-11e8-90e4-1b0fdc18019f.png)
 
Step5. Click "x", then pop up "No device found"
![image](https://user-images.githubusercontent.com/26316763/41453240-9535084e-70a7-11e8-88ac-08fc68c613bd.png)

from Chrome develop tools:
{Normal case}
![image](https://user-images.githubusercontent.com/26316763/41453329-eba03faa-70a7-11e8-85fd-5b821d862b6b.png)

{error case}
![image](https://user-images.githubusercontent.com/26316763/41453350-fd9fa16e-70a7-11e8-891d-7f166f560621.png)

seems no "websocket" pop up?
Any idea for this? Hi Sorccu,
From DEVtools, I only see 1 websockets when the screen is active.
![image](https://user-images.githubusercontent.com/26316763/41454463-0bb47438-70ac-11e8-954b-77a875eff523.png)

May I know anyone have the same issue and how to resolve?

Request 2 times, one is "200 OK" another is "304 Not Modified" 
![image](https://user-images.githubusercontent.com/26316763/41456574-774486d2-70b3-11e8-8215-67a0f1b967d4.png)
![image](https://user-images.githubusercontent.com/26316763/41456583-7ffb6ef8-70b3-11e8-8201-1e13334db95e.png)
 Hi @sorccu ,
We found this issue only happened in Win10.
If user site is win10, then access the STF will encounter this issue The error log as below
-----------------------------------------------------------------------------------------------------------------
018-06-19T18:13:46.821Z INF/device:plugins:group 121 [8SGIKVIZGEZDPV5L] Unsubscribing from group channel "ohcMtwovRNyNuNgoYC0yrg=="
events.js:160
      throw er; // Unhandled 'error' event
      ^
Error: read ECONNRESET
    at exports._errnoException (util.js:1020:11)
    at TCP.onread (net.js:568:26)
2018-06-19T18:13:46.867Z INF/provider 43 [*] Cleaning up device worker "8SGIKVIZGEZDPV5L"
2018-06-19T18:13:46.868Z ERR/provider 43 [*] Device worker "8SGIKVIZGEZDPV5L" died with code 1
2018-06-19T18:13:46.868Z INF/provider 43 [*] Restarting device worker "8SGIKVIZGEZDPV5L"
---------------------------------------------------------------------------------------------------------------  **What is the issue or idea you have?**
First of all, this piece of software is amazing and the support the devs provide is top notch.  The issue my team and I are experiencing is our devices are recognized by STF but all of them are disconnected.  Our deployment is in google cloud using kubernetes, all 3 devices are on connected to my desktop which is running on MacOS high sierra, and we followed the deployment instructions as best we could for our situation.  We can see the dashboard when we enter our url and the service will often 'disconnect: socket connection lost' and the we have to reconnect.  Also, I entered the adb key in the settings.  Can we get a hint at where to be looking to fix out issue?  Do we need to run adb connect so each device connects to the outside server? Please let me know if you need any more information and I'll be happy to provide it.  Our deployment is based on this [script.](https://github.com/dimasaryo/stf-k8s)

**What is the expected behavior?**
All of our devices are connected and behave gracefully.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
stf local works fine on my local machine.  that's why we decided to deploy.


**stf doctor output:**
2018-06-08T23:16:18.836Z INF/cli:doctor 84472 [*] OS Arch: x64
2018-06-08T23:16:18.838Z INF/cli:doctor 84472 [*] OS Platform: darwin
2018-06-08T23:16:18.838Z INF/cli:doctor 84472 [*] OS Platform: 17.6.0
2018-06-08T23:16:18.838Z INF/cli:doctor 84472 [*] Using Node 9.4.0
2018-06-08T23:16:18.903Z INF/cli:doctor 84472 [*] Using ZeroMQ 4.2.5
2018-06-08T23:16:18.920Z INF/cli:doctor 84472 [*] Using ADB 1.0.39
2018-06-08T23:16:18.923Z INF/cli:doctor 84472 [*] Using ProtoBuf 3.5.1
2018-06-08T23:16:18.995Z INF/cli:doctor 84472 [*] Using GraphicsMagick 1.3.29
2018-06-08T23:16:19.146Z INF/cli:doctor 84472 [*] Using RethinkDB 2.3.6
 Here is some output from the logs.  The devices are being ignored.

2018-06-13T15:25:31.688Z INF/provider 128 [*] Found device “04157df438f3b51b” (device)
2018-06-13T15:25:41.708Z INF/provider 128 [*] Providing all 0 of 1 device(s); ignoring “04157df438f3b51b” thank you for the quick response.  i will keep looking into and post the solution when we find it. Can you give me a suggestion on how to debug:

> provider unit was unable to connect to the processor (via triproxy) and receive instructions back

thank you for your help. Hey did you fix your issue, i have pretty much the same deployment as well, and i am trying it hard to connect.
 yes, just fixed it today.  so what we found out is deployment cannot be run on macOS by itself since it has connection issues with android just like sorccu said in many of his posts.  our solution was to follow these instructions from [stack overflow](https://stackoverflow.com/questions/29776333/mobile-devices-under-mac-os-x-to-connect-to-docker).  Then deploy with docker using this [project](https://github.com/nikosch86/stf-poc/blob/master/.env).  Worked like a charm. hi thanks, but i am good with the setup but when i try to connect using the provider command my devices are getting ignored, regardless of using docker. I have disabled all the firewalls but still they dont work.
can you suggest something.  For example:
**Server 1:** 
[Docker] 3 container
1. docker run -d --name rethinkdb -v /srv/rethinkdb:/data --net host rethinkdb rethinkdb --bind all --cache-size 8192 --http-port 8090
2. docker run -d --name adbd --privileged -v /dev/bus/usb:/dev/bus/usb --net host sorccu/adb:latest
3. docker run -d --name stf --net host openstf/stf stf local --public-ip 192.168.1.100

**Server 2:**
[Docker] 2 container
1. docker run -d --name adbd --privileged -v /dev/bus/usb:/dev/bus/usb --net host sorccu/adb:latest

> got the mobile devices

2. docker run -d --name stf --net host openstf/stf stf provider --name STF-VM --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 20000 --public-ip 192.168.1.100 --storage-url http://192.168.1.100:7100/

> Cannot see the device in 192.168.1.100:7100
anyone can help on this?
 fixed the issue.
  I use follow common start stf, it is ok while accessing with ip(eg.http://192.168.1.16:7100), I login once，then I no need to login. But while accessing with domain name(eg.http://phone.tecent.com), I need to login while using http://phone.tecent.com. Please help me!!!
stf local --public-ip='本机IP' --auth-type ldap --auth-options '["--ldap-url","$LDAP SERVER URI", "--ldap-bind-dn","$LDAP BIND DN","--ldap-search-dn","$LDAP BASE DN", "--ldap-bind-credentials","$LDAP BIND DN PWD", "--ldap-search-class","user", "--ldap-search-field", "mail"]'  Hi,
is it possible to run adb on two different ports ex port 5037 and 5038
If yes, how do I configure stf to listen on port 5038.
I require this because I have another console based application that uses minicap and runs on port 5037 Thank for your response, the reason I want to run two instances on separate ports is because the other application also use minicap and this is causing the device to hang some time  I can't get `stf` installed on my mac os:
```
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
In file included from ../src/bufferutil.cc:16:
In file included from ../../nan/nan.h:190:
../../nan/nan_maybe_43_inl.h:88:15: error: no member named 'ForceSet' in 'v8::Object'
```
It seems bufferutil version should be bumped... `$ npm -v`
`6.1.0` I believe it's related to:
https://github.com/websockets/bufferutil/issues/96 I faced the same issue and managed to find a workaround. Still have to remember though. :-(
I am now using Docker because it's easier to set up. @gounthar what's your workaround? I should have written it. I only found a few hints in my shell history.
```
npm install npm@latest -g
sudo ln -s ../../lib/libSystem.B.dylib libgcc_s.10.5.dylib
sudo ln -s ../../lib/libSystem.B.dylib libgcc_s.10.4.dylib
npm install -g bufferutil@1.3.0
xcode-select -p @gounthar didn't work for me. It's not a blocker to me though, I can use docker stf.
Last version of `bufferutil` is 3.0.5 btw Sorry for that. I know I had a look at https://github.com/websockets/bufferutil/issues/17 for some commands I tried and that I had to go back to Node 8.  I have installed stf ,it runs very well. But I need to modify some source, could you tell me how to debug the code? When I debug stf local with webstorm as follow,
![image](https://user-images.githubusercontent.com/26616673/40582599-98bcb42a-61ad-11e8-8471-773befc5ab25.png)

 there are some error:
![image](https://user-images.githubusercontent.com/26616673/40582592-887f0202-61ad-11e8-8d59-e624fe84079b.png)


 hello, what the debug  software call? I find somewhere to debug but I can't .  hi
After I deploy the stf code on the server, some computers can access the server pages correctly,but some computers displays blank when access device control page,like the picture below; Do you know the reason? 
![image](https://user-images.githubusercontent.com/35100562/40353238-95cb1392-5de3-11e8-822a-1279c7cd9707.png)
  Now I Use follow command，
stf local --public-ip='本机IP' --auth-type ldap --auth-options '["--ldap-url","$LDAP SERVER URI", "--ldap-bind-dn","$LDAP BIND DN","--ldap-search-dn","$LDAP BASE DN", "--ldap-bind-credentials","$LDAP BIND DN PWD", "--ldap-search-class","user", "--ldap-search-field", "mail"]'
It words well，but while i have already logged in other system, i want to skip this login step when i use ldap ？Please help!!!  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
STF can't connect Huawei P20
to get /arm64-v8a/lib/android-8.1.0 or arm64-v8a/lib/android-27 and so on.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
yes
![image](https://user-images.githubusercontent.com/20472976/40154576-8e83d5f4-59c1-11e8-8b88-bf8717afefef.png)

**Please provide the steps to reproduce the issue.**
Huawei P20,  android system 8.1.0

**What is the expected behavior?**
![image](https://user-images.githubusercontent.com/20472976/40154557-7158a7f2-59c1-11e8-955d-93e1e9165c8c.png)
Other android system 8.0.0 is ok.
**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
stf version 3.1.0  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Devices are not connected and showing as preparing for long time and giving error in console.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
List of devices attached
06157df68947b219       device usb:51445760X product:zerofltexx model:SM_G920F device:zeroflte transport_id:4
FA6A10305277           device usb:18874368X product:sailfish model:Pixel device:sailfish transport_id:3
04157df45bc7e123       device usb:19922944X product:zeroltexx model:SM_G925F device:zerolte transport_id:2
52006ec3804042b7       device usb:17825792X product:kminiltexx model:SM_G800F device:kminilte transport_id:1


**Please provide the steps to reproduce the issue.**
Just connect the devices and run on remote machine

**What is the expected behavior?**
available devices should be connected

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
"intldevicehub:~ international$ stf local --public-ip 10.1.87.184
2018-05-16T11:05:58.465Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
2018-05-16T11:05:58.706Z INF/db 4813 [*] Connecting to 127.0.0.1:28015
2018-05-16T11:05:58.723Z INF/db:setup 4813 [*] Database "stf" already exists
2018-05-16T11:05:58.728Z INF/db:setup 4813 [*] Table "users" already exists
2018-05-16T11:05:58.728Z INF/db:setup 4813 [*] Table "accessTokens" already exists
2018-05-16T11:05:58.728Z INF/db:setup 4813 [*] Table "vncauth" already exists
2018-05-16T11:05:58.728Z INF/db:setup 4813 [*] Table "devices" already exists
2018-05-16T11:05:58.728Z INF/db:setup 4813 [*] Table "logs" already exists
2018-05-16T11:05:58.735Z INF/db:setup 4813 [*] Index "users"."adbKeys" already exists
2018-05-16T11:05:58.735Z INF/db:setup 4813 [*] Index "accessTokens"."email" already exists
2018-05-16T11:05:58.735Z INF/db:setup 4813 [*] Waiting for index "users"."adbKeys"
2018-05-16T11:05:58.735Z INF/db:setup 4813 [*] Waiting for index "accessTokens"."email"
2018-05-16T11:05:58.738Z INF/db:setup 4813 [*] Index "vncauth"."response" already exists
2018-05-16T11:05:58.738Z INF/db:setup 4813 [*] Index "vncauth"."responsePerDevice" already exists
2018-05-16T11:05:58.738Z INF/db:setup 4813 [*] Index "devices"."owner" already exists
2018-05-16T11:05:58.738Z INF/db:setup 4813 [*] Index "devices"."present" already exists
2018-05-16T11:05:58.738Z INF/db:setup 4813 [*] Index "devices"."providerChannel" already exists
2018-05-16T11:05:58.739Z INF/db:setup 4813 [*] Waiting for index "vncauth"."response"
2018-05-16T11:05:58.739Z INF/db:setup 4813 [*] Waiting for index "vncauth"."responsePerDevice"
2018-05-16T11:05:58.739Z INF/db:setup 4813 [*] Waiting for index "devices"."owner"
2018-05-16T11:05:58.739Z INF/db:setup 4813 [*] Waiting for index "devices"."present"
2018-05-16T11:05:58.740Z INF/db:setup 4813 [*] Waiting for index "devices"."providerChannel"
2018-05-16T11:05:58.741Z INF/db:setup 4813 [*] Index "users"."adbKeys" is ready
2018-05-16T11:05:58.741Z INF/db:setup 4813 [*] Index "accessTokens"."email" is ready
2018-05-16T11:05:58.742Z INF/db:setup 4813 [*] Index "vncauth"."response" is ready
2018-05-16T11:05:58.742Z INF/db:setup 4813 [*] Index "vncauth"."responsePerDevice" is ready
2018-05-16T11:05:58.743Z INF/db:setup 4813 [*] Index "devices"."owner" is ready
2018-05-16T11:05:58.743Z INF/db:setup 4813 [*] Index "devices"."present" is ready
2018-05-16T11:05:58.743Z INF/db:setup 4813 [*] Index "devices"."providerChannel" is ready
2018-05-16T11:05:58.749Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
2018-05-16T11:05:58.751Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
2018-05-16T11:05:58.753Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2018-05-16T11:05:58.754Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2018-05-16T11:05:58.756Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
2018-05-16T11:05:58.758Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli provider --name intldevicehub.prod.williamhill.plc --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip 10.1.87.184 --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800 --mute-master never"
2018-05-16T11:05:58.760Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://10.1.87.184:7100/"
2018-05-16T11:05:58.762Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://10.1.87.184:7100/auth/mock/ --websocket-url http://10.1.87.184:7110/"
2018-05-16T11:05:58.765Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
2018-05-16T11:05:58.767Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
2018-05-16T11:05:58.770Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-temp --port 7102"
2018-05-16T11:05:58.774Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
2018-05-16T11:05:58.781Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
2018-05-16T11:05:58.796Z INF/util:procutil 4811 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
2018-05-16T11:05:59.176Z INF/triproxy 4814 [app001] PUB socket bound on tcp://127.0.0.1:7111
2018-05-16T11:05:59.180Z INF/triproxy 4814 [app001] DEALER socket bound on tcp://127.0.0.1:7112
2018-05-16T11:05:59.180Z INF/triproxy 4814 [app001] PULL socket bound on tcp://127.0.0.1:7113
2018-05-16T11:05:59.192Z INF/triproxy 4815 [dev001] PUB socket bound on tcp://127.0.0.1:7114
2018-05-16T11:05:59.196Z INF/triproxy 4815 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
2018-05-16T11:05:59.197Z INF/triproxy 4815 [dev001] PULL socket bound on tcp://127.0.0.1:7116
2018-05-16T11:05:59.349Z INF/poorxy 4827 [*] Listening on port 7100
2018-05-16T11:05:59.385Z INF/db 4816 [*] Connecting to 127.0.0.1:28015
2018-05-16T11:05:59.390Z INF/db 4817 [*] Connecting to 127.0.0.1:28015
2018-05-16T11:05:59.411Z INF/processor 4816 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
2018-05-16T11:05:59.412Z INF/processor 4816 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
2018-05-16T11:05:59.415Z INF/processor 4817 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
2018-05-16T11:05:59.415Z INF/processor 4817 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
2018-05-16T11:05:59.452Z INF/reaper 4818 [reaper001] Subscribing to permanent channel "*ALL"
2018-05-16T11:05:59.457Z INF/reaper 4818 [reaper001] Reaping devices with no heartbeat
2018-05-16T11:05:59.461Z INF/db 4818 [reaper001] Connecting to 127.0.0.1:28015
2018-05-16T11:05:59.466Z INF/reaper 4818 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
2018-05-16T11:05:59.467Z INF/reaper 4818 [reaper001] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:05:59.524Z INF/auth-mock 4820 [*] Listening on port 7120
2018-05-16T11:05:59.535Z INF/provider 4819 [*] Subscribing to permanent channel "AqsL675oReODztgmT61CYw=="
2018-05-16T11:05:59.545Z INF/storage:plugins:image 4825 [*] Listening on port 7103
2018-05-16T11:05:59.555Z INF/storage:plugins:apk 4826 [*] Listening on port 7104
2018-05-16T11:05:59.563Z INF/provider 4819 [*] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:05:59.565Z INF/provider 4819 [*] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:05:59.573Z INF/provider 4819 [*] Tracking devices
2018-05-16T11:05:59.575Z INF/provider 4819 [*] Found device "06157df68947b219" (device)
2018-05-16T11:05:59.579Z INF/provider 4819 [*] Found device "FA6A10305277" (device)
2018-05-16T11:05:59.580Z INF/provider 4819 [*] Found device "04157df45bc7e123" (device)
2018-05-16T11:05:59.580Z INF/provider 4819 [*] Found device "52006ec3804042b7" (device)
2018-05-16T11:05:59.625Z INF/provider 4819 [*] Registered device "FA6A10305277"
2018-05-16T11:05:59.626Z INF/reaper 4818 [reaper001] Device "FA6A10305277" is present
2018-05-16T11:05:59.627Z INF/provider 4819 [*] Registered device "52006ec3804042b7"
2018-05-16T11:05:59.629Z INF/reaper 4818 [reaper001] Device "52006ec3804042b7" is present
2018-05-16T11:05:59.632Z INF/provider 4819 [*] Registered device "04157df45bc7e123"
2018-05-16T11:05:59.633Z INF/reaper 4818 [reaper001] Device "04157df45bc7e123" is present
2018-05-16T11:05:59.634Z INF/provider 4819 [*] Registered device "06157df68947b219"
2018-05-16T11:05:59.634Z INF/reaper 4818 [reaper001] Device "06157df68947b219" is present
2018-05-16T11:05:59.645Z INF/storage:temp 4824 [*] Listening on port 7102
2018-05-16T11:05:59.763Z INF/app 4821 [*] Using pre-built resources
2018-05-16T11:05:59.788Z INF/app 4821 [*] Listening on port 7105
2018-05-16T11:05:59.790Z INF/db 4821 [*] Connecting to 127.0.0.1:28015
2018-05-16T11:05:59.851Z INF/websocket 4823 [*] Subscribing to permanent channel "*ALL"
2018-05-16T11:05:59.858Z INF/websocket 4823 [*] Listening on port 7110
2018-05-16T11:05:59.878Z INF/db 4823 [*] Connecting to 127.0.0.1:28015
2018-05-16T11:05:59.884Z INF/websocket 4823 [*] Sending output to "tcp://127.0.0.1:7113"
2018-05-16T11:05:59.885Z INF/websocket 4823 [*] Receiving input from "tcp://127.0.0.1:7111"
2018-05-16T11:06:00.096Z INF/device:support:push 4829 [FA6A10305277] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:06:00.099Z INF/device 4829 [FA6A10305277] Preparing device
2018-05-16T11:06:00.103Z INF/device:support:push 4830 [52006ec3804042b7] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:06:00.105Z INF/device:support:push 4832 [06157df68947b219] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:06:00.107Z INF/device 4830 [52006ec3804042b7] Preparing device
2018-05-16T11:06:00.107Z INF/device:support:push 4831 [04157df45bc7e123] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:06:00.109Z INF/device 4832 [06157df68947b219] Preparing device
2018-05-16T11:06:00.111Z INF/device 4831 [04157df45bc7e123] Preparing device
2018-05-16T11:06:00.178Z INF/api 4822 [*] Subscribing to permanent channel "*ALL"
2018-05-16T11:06:00.225Z INF/api 4822 [*] Listening on port 7106
2018-05-16T11:06:00.264Z INF/api 4822 [*] Sending output to "tcp://127.0.0.1:7113"
2018-05-16T11:06:00.265Z INF/api 4822 [*] Receiving input from "tcp://127.0.0.1:7111"
2018-05-16T11:06:00.419Z INF/db 4822 [*] Connecting to 127.0.0.1:28015
2018-05-16T11:06:00.478Z INF/device:support:sub 4829 [FA6A10305277] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:06:00.480Z INF/device:support:sub 4829 [FA6A10305277] Subscribing to permanent channel "*ALL"
2018-05-16T11:06:00.482Z INF/device:support:sub 4830 [52006ec3804042b7] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:06:00.483Z INF/device:support:sub 4830 [52006ec3804042b7] Subscribing to permanent channel "*ALL"
2018-05-16T11:06:00.485Z INF/device:support:sub 4832 [06157df68947b219] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:06:00.486Z INF/device:support:sub 4832 [06157df68947b219] Subscribing to permanent channel "*ALL"
2018-05-16T11:06:00.494Z INF/device:support:sub 4831 [04157df45bc7e123] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:06:00.496Z INF/device:support:sub 4831 [04157df45bc7e123] Subscribing to permanent channel "*ALL"
2018-05-16T11:06:01.490Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:01.490Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:01.492Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:01.504Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:02.496Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:02.496Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:02.496Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:02.506Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:03.500Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:03.500Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:03.500Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:03.505Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:04.503Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:04.503Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:04.503Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:04.508Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:05.503Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:05.503Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:05.503Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:05.510Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:06.503Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:06.505Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:06.505Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:06.514Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:07.503Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:07.505Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:07.505Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:07.515Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:08.504Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:08.506Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:08.507Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:08.515Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:09.520Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:09.523Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:09.527Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:09.539Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:09.582Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "04157df45bc7e123", "06157df68947b219"
2018-05-16T11:06:10.508Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:10.520Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:10.520Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:10.528Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:11.510Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:11.525Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:11.525Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:11.534Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:12.515Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:12.529Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:12.529Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:12.536Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:13.520Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:13.530Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:13.530Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:13.539Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:14.526Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:14.536Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:14.536Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:14.540Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:15.530Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:15.537Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:15.537Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:15.543Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:16.536Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:16.536Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:16.536Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:16.547Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:17.539Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:17.539Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:17.539Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:17.552Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:18.541Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:18.541Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:18.541Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:18.556Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:19.541Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:19.541Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:19.541Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:19.562Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:19.586Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "04157df45bc7e123", "06157df68947b219"
2018-05-16T11:06:20.541Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:20.541Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:20.541Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:20.567Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:21.547Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:21.547Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:21.547Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:21.570Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:22.548Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:22.548Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:22.548Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:22.571Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:23.550Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:23.550Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:23.550Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:23.576Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:24.553Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:24.553Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:24.553Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:24.576Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:25.558Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:25.558Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:25.558Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:25.580Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:26.563Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:26.563Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:26.563Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:26.586Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:27.564Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:27.564Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:27.564Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:27.590Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:28.569Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:28.569Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:28.569Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:28.596Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:29.570Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:29.570Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:29.570Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:29.592Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "04157df45bc7e123", "06157df68947b219"
2018-05-16T11:06:29.600Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:30.571Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:30.571Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:30.571Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:30.604Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:31.571Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:31.571Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:31.572Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:31.605Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:32.575Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:32.576Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:32.576Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:32.609Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:33.578Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:33.578Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:33.578Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:33.615Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:34.580Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:34.580Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:34.580Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:34.616Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:35.586Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:35.586Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:35.586Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:35.619Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:36.590Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:36.590Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:36.590Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:36.620Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:37.596Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:37.596Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:37.596Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:37.625Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:38.600Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:38.600Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:38.600Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:38.630Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:39.597Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "04157df45bc7e123", "06157df68947b219"
2018-05-16T11:06:39.606Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:39.606Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:39.606Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:39.634Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:40.610Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:40.610Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:40.610Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:40.637Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:41.616Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:41.616Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:41.616Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:41.637Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:42.620Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:42.620Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:42.620Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:42.638Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:43.625Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:43.625Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:43.625Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:43.640Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:44.630Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:44.630Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:44.630Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:44.640Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:45.634Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:45.634Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:45.634Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:45.645Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:46.636Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:46.636Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:46.636Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:46.647Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:47.637Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:47.637Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:47.637Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:47.653Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:48.642Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:48.642Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:48.642Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:48.654Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:49.602Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "04157df45bc7e123", "06157df68947b219"
2018-05-16T11:06:49.641Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:49.641Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:49.642Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:49.660Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:50.642Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:50.642Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:50.642Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:50.660Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:51.644Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:51.644Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:51.644Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:51.666Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:52.644Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:52.644Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:52.644Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:52.669Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:53.649Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:53.649Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:53.649Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:53.675Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:54.650Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:54.650Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:54.650Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:54.675Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:55.656Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:55.656Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:55.656Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:55.675Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:56.660Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:56.660Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:56.660Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:56.680Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:57.666Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:57.666Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:57.666Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:57.681Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:58.670Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:58.670Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:58.670Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:58.683Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:06:59.603Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "04157df45bc7e123", "06157df68947b219"
2018-05-16T11:06:59.671Z INF/device:support:adb 4829 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:06:59.671Z INF/device:support:adb 4832 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:06:59.671Z INF/device:support:adb 4831 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:06:59.686Z INF/device:support:adb 4830 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:00.487Z FTL/device 4829 [FA6A10305277] Setup had an error TimeoutError: operation timed out
    at ontimeout (timers.js:458:11)
    at tryOnTimeout (timers.js:296:5)
    at Timer.listOnTimeout (timers.js:259:5)
From previous event:
    at ensureBootComplete (/usr/local/lib/node_modules/stf/lib/units/device/support/adb.js:25:10)
    at /usr/local/lib/node_modules/stf/lib/units/device/support/adb.js:28:12
    at SerialSyrup.ParallelSyrup.invoke (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at process._tickCallback (internal/process/next_tick.js:150:11)
2018-05-16T11:07:00.488Z FTL/util:lifecycle 4829 [FA6A10305277] Shutting down due to fatal error
2018-05-16T11:07:00.492Z FTL/device 4830 [52006ec3804042b7] Setup had an error TimeoutError: operation timed out
    at ontimeout (timers.js:458:11)
    at tryOnTimeout (timers.js:296:5)
    at Timer.listOnTimeout (timers.js:259:5)
From previous event:
    at ensureBootComplete (/usr/local/lib/node_modules/stf/lib/units/device/support/adb.js:25:10)
    at /usr/local/lib/node_modules/stf/lib/units/device/support/adb.js:28:12
    at SerialSyrup.ParallelSyrup.invoke (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at process._tickCallback (internal/process/next_tick.js:150:11)
2018-05-16T11:07:00.492Z FTL/util:lifecycle 4830 [52006ec3804042b7] Shutting down due to fatal error
2018-05-16T11:07:00.494Z INF/provider 4819 [*] Cleaning up device worker "FA6A10305277"
2018-05-16T11:07:00.495Z ERR/provider 4819 [*] Device worker "FA6A10305277" died with code 1
2018-05-16T11:07:00.495Z INF/provider 4819 [*] Restarting device worker "FA6A10305277"
2018-05-16T11:07:00.495Z FTL/device 4832 [06157df68947b219] Setup had an error TimeoutError: operation timed out
    at ontimeout (timers.js:458:11)
    at tryOnTimeout (timers.js:296:5)
    at Timer.listOnTimeout (timers.js:259:5)
From previous event:
    at ensureBootComplete (/usr/local/lib/node_modules/stf/lib/units/device/support/adb.js:25:10)
    at /usr/local/lib/node_modules/stf/lib/units/device/support/adb.js:28:12
    at SerialSyrup.ParallelSyrup.invoke (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at process._tickCallback (internal/process/next_tick.js:150:11)
2018-05-16T11:07:00.495Z FTL/util:lifecycle 4832 [06157df68947b219] Shutting down due to fatal error
2018-05-16T11:07:00.496Z INF/provider 4819 [*] Cleaning up device worker "52006ec3804042b7"
2018-05-16T11:07:00.497Z ERR/provider 4819 [*] Device worker "52006ec3804042b7" died with code 1
2018-05-16T11:07:00.497Z INF/provider 4819 [*] Restarting device worker "52006ec3804042b7"
2018-05-16T11:07:00.499Z INF/provider 4819 [*] Cleaning up device worker "06157df68947b219"
2018-05-16T11:07:00.499Z ERR/provider 4819 [*] Device worker "06157df68947b219" died with code 1
2018-05-16T11:07:00.500Z INF/provider 4819 [*] Restarting device worker "06157df68947b219"
2018-05-16T11:07:00.504Z FTL/device 4831 [04157df45bc7e123] Setup had an error TimeoutError: operation timed out
    at ontimeout (timers.js:458:11)
    at tryOnTimeout (timers.js:296:5)
    at Timer.listOnTimeout (timers.js:259:5)
From previous event:
    at ensureBootComplete (/usr/local/lib/node_modules/stf/lib/units/device/support/adb.js:25:10)
    at /usr/local/lib/node_modules/stf/lib/units/device/support/adb.js:28:12
    at SerialSyrup.ParallelSyrup.invoke (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at process._tickCallback (internal/process/next_tick.js:150:11)
2018-05-16T11:07:00.505Z FTL/util:lifecycle 4831 [04157df45bc7e123] Shutting down due to fatal error
2018-05-16T11:07:00.509Z INF/provider 4819 [*] Cleaning up device worker "04157df45bc7e123"
2018-05-16T11:07:00.509Z ERR/provider 4819 [*] Device worker "04157df45bc7e123" died with code 1
2018-05-16T11:07:00.509Z INF/provider 4819 [*] Restarting device worker "04157df45bc7e123"
2018-05-16T11:07:01.338Z INF/device:support:push 4890 [FA6A10305277] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:07:01.342Z INF/device 4890 [FA6A10305277] Preparing device
2018-05-16T11:07:01.347Z INF/device:support:push 4892 [06157df68947b219] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:07:01.349Z INF/device:support:push 4893 [04157df45bc7e123] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:07:01.351Z INF/device 4892 [06157df68947b219] Preparing device
2018-05-16T11:07:01.353Z INF/device 4893 [04157df45bc7e123] Preparing device
2018-05-16T11:07:01.354Z INF/device:support:push 4891 [52006ec3804042b7] Sending output to "tcp://127.0.0.1:7116"
2018-05-16T11:07:01.358Z INF/device 4891 [52006ec3804042b7] Preparing device
2018-05-16T11:07:01.703Z INF/device:support:sub 4890 [FA6A10305277] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:07:01.704Z INF/device:support:sub 4890 [FA6A10305277] Subscribing to permanent channel "*ALL"
2018-05-16T11:07:01.712Z INF/device:support:sub 4893 [04157df45bc7e123] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:07:01.713Z INF/device:support:sub 4892 [06157df68947b219] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:07:01.714Z INF/device:support:sub 4893 [04157df45bc7e123] Subscribing to permanent channel "*ALL"
2018-05-16T11:07:01.715Z INF/device:support:sub 4892 [06157df68947b219] Subscribing to permanent channel "*ALL"
2018-05-16T11:07:01.719Z INF/device:support:sub 4891 [52006ec3804042b7] Receiving input from "tcp://127.0.0.1:7114"
2018-05-16T11:07:01.721Z INF/device:support:sub 4891 [52006ec3804042b7] Subscribing to permanent channel "*ALL"
2018-05-16T11:07:02.709Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:02.721Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:02.721Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:02.729Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:03.710Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:03.726Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:03.726Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:03.734Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:04.711Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:04.730Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:04.730Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:04.737Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:05.717Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:05.736Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:05.736Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:05.737Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:06.719Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:06.740Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:06.740Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:06.740Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:07.719Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:07.740Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:07.740Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:07.740Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:08.722Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:08.745Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:08.745Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:08.745Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:09.603Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "06157df68947b219", "04157df45bc7e123"
2018-05-16T11:07:09.722Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:09.747Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:09.747Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:09.748Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:10.747Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:10.759Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:10.759Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:10.763Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:11.733Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:11.764Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:11.764Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:11.766Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:12.738Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:12.769Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:12.769Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:12.770Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:13.739Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:13.774Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:13.774Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:13.774Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:14.740Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:14.775Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:14.775Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:14.775Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:15.741Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:15.775Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:15.775Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:15.775Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:16.742Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:16.775Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:16.775Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:16.775Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:17.743Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:17.777Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:17.777Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:17.777Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:18.748Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:18.780Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:18.780Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:18.780Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:19.605Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "06157df68947b219", "04157df45bc7e123"
2018-05-16T11:07:19.752Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:19.781Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:19.781Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:19.781Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:20.752Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:20.784Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:20.784Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:20.784Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:21.752Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:21.786Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:21.786Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:21.786Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:22.753Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:22.788Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:22.788Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:22.788Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:23.756Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:23.790Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:23.790Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:23.790Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:24.760Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:24.791Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:24.791Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:24.791Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:25.766Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:25.797Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:25.797Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:25.797Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:26.767Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:26.798Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:26.798Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:26.798Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:27.770Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:27.802Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:27.802Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:27.802Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:28.771Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:28.803Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:28.803Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:28.803Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:29.606Z INF/provider 4819 [*] Providing 0 of 4 device(s); waiting for "FA6A10305277", "52006ec3804042b7", "06157df68947b219", "04157df45bc7e123"
2018-05-16T11:07:29.771Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:29.805Z INF/device:support:adb 4892 [06157df68947b219] Waiting for boot to complete
2018-05-16T11:07:29.805Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete
2018-05-16T11:07:29.805Z INF/device:support:adb 4893 [04157df45bc7e123] Waiting for boot to complete
2018-05-16T11:07:30.772Z INF/device:support:adb 4890 [FA6A10305277] Waiting for boot to complete
2018-05-16T11:07:30.806Z INF/device:support:adb 4891 [52006ec3804042b7] Waiting for boot to complete"

**Please run `stf doctor` and paste the output here.**
2018-05-16T11:16:29.630Z INF/cli:doctor 5443 [*] OS Arch: x64
2018-05-16T11:16:29.632Z INF/cli:doctor 5443 [*] OS Platform: darwin
2018-05-16T11:16:29.633Z INF/cli:doctor 5443 [*] OS Platform: 17.4.0
2018-05-16T11:16:29.633Z INF/cli:doctor 5443 [*] Using Node 9.5.0
2018-05-16T11:16:29.647Z INF/cli:doctor 5443 [*] Using ZeroMQ 4.2.3
2018-05-16T11:16:29.658Z INF/cli:doctor 5443 [*] Using GraphicsMagick 1.3.28
2018-05-16T11:16:29.664Z INF/cli:doctor 5443 [*] Using RethinkDB 2.3.6
2018-05-16T11:16:29.665Z INF/cli:doctor 5443 [*] Using ADB 1.0.39
2018-05-16T11:16:29.669Z INF/cli:doctor 5443 [*] Using ProtoBuf 3.5.1 4 devices are connected. It was working until yesterday. I have updated latest STF code yesterday and I am seeing this. Can you please let me know the cause. thanks  our users have a urgent needs that when the mouse wheeling ,the device can scroll too.
In the screen-directive.js code ,i have add some code like the following, when mousewheel, it can execute  function _onWheel ,  but i dont know how to simulated sliding event to the device in_onWheel, can someone give a idea

 element[0].addEventListener('mousewheel',_onWheel,false)
        function _onWheel(e) {
            console.log(e)
            console.log('mousewheel')
            // control.touchMove(nextSeq(), 0, 0.5423280423280423, 0.45351473922902497, 0                                                                              .5)
            // control.touchCommit(nextSeq())
            // control.touchMove(nextSeq(), 0, 0.5423280423280423, 0.4444444444444444, 0.                                                                              5)
            // control.touchCommit(nextSeq())
            // control.touchMove(nextSeq(), 0, 0.5423280423280423, 0.40816326530612246, 0                                                                              .5)
            // control.touchCommit(nextSeq())
            mouseMoveListener(e)
        }
   just as the title..
how can I get the real IP address of the phone  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
yes using latest STF - setupExamples from git

**What is the issue or idea you have?**
ISSUE : I am deploying open STF using https://github.com/openstf/setup-examples and then using https://github.com/openstf/setup-examples/blob/master/docs/coreos_fleet.md

All installation is fine but when i start configuring FleetCTL, i export FLEETCTL_ENDPOINT=http://172.17.8.101:2379
and then run fleetctl list-machines command, to see list of VMs, i am getting following error

Error retrieving list of active machines from fleet API (Get http://172.17.8.101:2379/fleet/v1/machines?alt=json:dial tcp 172.17.8.101:2379: getsockopt: connection refused)
Possible issues:
etcd is unhealthy and/or lost quorum
connection cannot be established to any etcd servers.

 Thanks @thinkhy for your reply. I tried running following commands and got the respective results shown below 
1. 
etcdctl cluster-health
cluster may be unhealthy: failed to list members
Error:  client: etcd cluster is unavailable or misconfigured; error #0: dial tcp 172.17.8.101:2379: connect: connection refused

error #0: dial tcp 172.17.8.101:2379: connect: connection refused
2. 
curl -L http://172.17.8.101:2379/health
curl: (7) Failed to connect to 172.17.8.101 port 2379: Connection refused
staff-158:coreos qaadmin$ etcdctl ls /_etcd/machines --recursive
Error:  client: etcd cluster is unavailable or misconfigured; error #0: dial tcp 172.17.8.101:2379: connect: connection refused

error #0: dial tcp 172.17.8.101:2379: connect: connection refused

Can u please help me on how to start etc service or how to get ACL to access 172.17.8.101:2379 Hi @thinkhy So, I tried running etcd and then checked etcd cluster health and I got "member 8e9e05c52164694d is healthy: got healthy result from http://localhost:2379
cluster is healthy"

but still getting some issue "Error retrieving list of active machines from fleet API (Get http://domain-sock/fleet/v1/machines?alt=json: dial unix /var/run/fleet.sock: connect: no such file or directory)
Possible issues:
  etcd is unhealthy and/or lost quorum
  connection cannot be established to any etcd server" on fleetctl list-machines

I also tried to ssh into cores -01 and found that etcd.service is not present

So how should I go about it now? Kindly help  hi, there

we are now deploying STF and it worked out fine. 
<img width="609" alt="image" src="https://user-images.githubusercontent.com/37066792/39609325-bb84af70-4f7a-11e8-870f-b05821fb3609.png">

As the above figure shows,  we want to figure it out that whether remote debugging support user authentication or not ? If not, does it mean that after copying the public key, by just typing "**adb connect IP:port**" provided by the figure, a user can connect the smartphone remotely without any authentication even if they are not logging in STF and are not occupying any device?

yours, 
David   <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
No it happens on most of the devices I have.

**Please provide the steps to reproduce the issue.**

- When pressing the get button on the UI it fires the command : wire.LogcatStartMessage
- I added a log on  **function entryListener(entry) ** and it is logging for the first time the logcat is pressed.
- After stopping the wire.LogcatStopMessage is fired.
- Next time onwards the start message is fired and then the entry log is never fired.
- Works again after plugging out and plugging the device back again (or group.kick() and join() again may be.!, I din't try this though) 
**EDIT:Also, the device.kick and device.join doesn't solve that problem as well.**

**What is the expected behavior?**
The log should be retrieved when pressing the get logs button in the UI and the stf backend should return the logs from the entryListener().

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
2018-05-03T17:26:39.324Z INF/util:procutil 74777 [*]lalith Forking "/Users/lalith/Desktop/stf/lib/cli migrate"
2018-05-03T17:26:39.515Z INF/db 74778 [*] Connecting to 127.0.0.1:28015
2018-05-03T17:26:39.529Z INF/db:setup 74778 [*] Database "stf" already exists
2018-05-03T17:26:39.533Z INF/db:setup 74778 [*] Table "users" already exists
2018-05-03T17:26:39.533Z INF/db:setup 74778 [*] Table "accessTokens" already exists
2018-05-03T17:26:39.533Z INF/db:setup 74778 [*] Table "vncauth" already exists
2018-05-03T17:26:39.533Z INF/db:setup 74778 [*] Table "devices" already exists
2018-05-03T17:26:39.533Z INF/db:setup 74778 [*] Table "logs" already exists
2018-05-03T17:26:39.541Z INF/db:setup 74778 [*] Index "users"."adbKeys" already exists
2018-05-03T17:26:39.541Z INF/db:setup 74778 [*] Index "accessTokens"."email" already exists
2018-05-03T17:26:39.541Z INF/db:setup 74778 [*] Index "vncauth"."response" already exists
2018-05-03T17:26:39.541Z INF/db:setup 74778 [*] Index "vncauth"."responsePerDevice" already exists
2018-05-03T17:26:39.541Z INF/db:setup 74778 [*] Waiting for index "users"."adbKeys"
2018-05-03T17:26:39.541Z INF/db:setup 74778 [*] Waiting for index "accessTokens"."email"
2018-05-03T17:26:39.541Z INF/db:setup 74778 [*] Waiting for index "vncauth"."response"
2018-05-03T17:26:39.542Z INF/db:setup 74778 [*] Waiting for index "vncauth"."responsePerDevice"
2018-05-03T17:26:39.544Z INF/db:setup 74778 [*] Index "devices"."owner" already exists
2018-05-03T17:26:39.544Z INF/db:setup 74778 [*] Index "devices"."present" already exists
2018-05-03T17:26:39.544Z INF/db:setup 74778 [*] Index "devices"."providerChannel" already exists
2018-05-03T17:26:39.544Z INF/db:setup 74778 [*] Index "users"."adbKeys" is ready
2018-05-03T17:26:39.544Z INF/db:setup 74778 [*] Waiting for index "devices"."owner"
2018-05-03T17:26:39.544Z INF/db:setup 74778 [*] Waiting for index "devices"."present"
2018-05-03T17:26:39.544Z INF/db:setup 74778 [*] Waiting for index "devices"."providerChannel"
2018-05-03T17:26:39.546Z INF/db:setup 74778 [*] Index "accessTokens"."email" is ready
2018-05-03T17:26:39.546Z INF/db:setup 74778 [*] Index "vncauth"."response" is ready
2018-05-03T17:26:39.546Z INF/db:setup 74778 [*] Index "vncauth"."responsePerDevice" is ready
2018-05-03T17:26:39.546Z INF/db:setup 74778 [*] Index "devices"."owner" is ready
2018-05-03T17:26:39.546Z INF/db:setup 74778 [*] Index "devices"."present" is ready
2018-05-03T17:26:39.547Z INF/db:setup 74778 [*] Index "devices"."providerChannel" is ready
2018-05-03T17:26:39.552Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
2018-05-03T17:26:39.554Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
2018-05-03T17:26:39.555Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2018-05-03T17:26:39.557Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2018-05-03T17:26:39.558Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
2018-05-03T17:26:39.559Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli provider --name 2030007493 --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800 --mute-master never"
2018-05-03T17:26:39.561Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
2018-05-03T17:26:39.563Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
2018-05-03T17:26:39.566Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
2018-05-03T17:26:39.573Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
2018-05-03T17:26:39.585Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli storage-temp --port 7102"
2018-05-03T17:26:39.600Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
2018-05-03T17:26:39.629Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
2018-05-03T17:26:39.670Z INF/util:procutil 74777 [*] Forking "/Users/lalith/Desktop/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
2018-05-03T17:26:39.930Z INF/triproxy 74780 [dev001] PUB socket bound on tcp://127.0.0.1:7114
2018-05-03T17:26:39.934Z INF/triproxy 74780 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
2018-05-03T17:26:39.934Z INF/triproxy 74780 [dev001] PULL socket bound on tcp://127.0.0.1:7116
2018-05-03T17:26:40.068Z INF/triproxy 74779 [app001] PUB socket bound on tcp://127.0.0.1:7111
2018-05-03T17:26:40.071Z INF/triproxy 74779 [app001] DEALER socket bound on tcp://127.0.0.1:7112
2018-05-03T17:26:40.072Z INF/triproxy 74779 [app001] PULL socket bound on tcp://127.0.0.1:7113
2018-05-03T17:26:40.215Z INF/db 74782 [*] Connecting to 127.0.0.1:28015
2018-05-03T17:26:40.233Z INF/processor 74782 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
2018-05-03T17:26:40.244Z INF/processor 74782 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
2018-05-03T17:26:40.285Z INF/reaper 74783 [reaper001] Subscribing to permanent channel "*ALL"
2018-05-03T17:26:40.285Z INF/db 74781 [*] Connecting to 127.0.0.1:28015
2018-05-03T17:26:40.288Z INF/reaper 74783 [reaper001] Reaping devices with no heartbeat
2018-05-03T17:26:40.294Z INF/db 74783 [reaper001] Connecting to 127.0.0.1:28015
2018-05-03T17:26:40.300Z INF/reaper 74783 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
2018-05-03T17:26:40.300Z INF/reaper 74783 [reaper001] Sending output to "tcp://127.0.0.1:7116"
2018-05-03T17:26:40.301Z INF/poorxy 74792 [*] Listening on port 7100
2018-05-03T17:26:40.312Z INF/processor 74781 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
2018-05-03T17:26:40.313Z INF/processor 74781 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
2018-05-03T17:26:40.396Z INF/auth-mock 74785 [*] Listening on port 7120
2018-05-03T17:26:40.435Z INF/storage:plugins:image 74790 [*] Listening on port 7103
2018-05-03T17:26:40.436Z INF/provider 74784 [*] Subscribing to permanent channel "3X2HD/6QR2aC+d5Cc/loCw=="
2018-05-03T17:26:40.467Z INF/provider 74784 [*] Sending output to "tcp://127.0.0.1:7116"
2018-05-03T17:26:40.468Z INF/provider 74784 [*] Receiving input from "tcp://127.0.0.1:7114"
2018-05-03T17:26:40.474Z INF/provider 74784 [*] Tracking devices
2018-05-03T17:26:40.476Z INF/provider 74784 [*] Found device "98885135314e35354e" (device)
2018-05-03T17:26:40.494Z INF/storage:plugins:apk 74791 [*] Listening on port 7104
2018-05-03T17:26:40.517Z INF/storage:temp 74789 [*] Listening on port 7102
2018-05-03T17:26:40.527Z INF/provider 74784 [*] Registered device "98885135314e35354e"
2018-05-03T17:26:40.528Z INF/reaper 74783 [reaper001] Device "98885135314e35354e" is present
2018-05-03T17:26:40.626Z INF/app 74786 [*] Using pre-built resources
2018-05-03T17:26:40.643Z INF/app 74786 [*] Listening on port 7105
2018-05-03T17:26:40.645Z INF/db 74786 [*] Connecting to 127.0.0.1:28015
2018-05-03T17:26:40.698Z INF/websocket 74788 [*] Subscribing to permanent channel "*ALL"
2018-05-03T17:26:40.702Z INF/websocket 74788 [*] Listening on port 7110
2018-05-03T17:26:40.704Z INF/db 74788 [*] Connecting to 127.0.0.1:28015
2018-05-03T17:26:40.707Z INF/websocket 74788 [*] Sending output to "tcp://127.0.0.1:7113"
2018-05-03T17:26:40.708Z INF/websocket 74788 [*] Receiving input from "tcp://127.0.0.1:7111"
2018-05-03T17:26:40.890Z INF/api 74787 [*] Subscribing to permanent channel "*ALL"
2018-05-03T17:26:40.904Z INF/device:support:push 74798 [98885135314e35354e] Sending output to "tcp://127.0.0.1:7116"
2018-05-03T17:26:40.907Z INF/device 74798 [98885135314e35354e] Preparing device
2018-05-03T17:26:40.927Z INF/api 74787 [*] Listening on port 7106
2018-05-03T17:26:40.957Z INF/api 74787 [*] Sending output to "tcp://127.0.0.1:7113"
2018-05-03T17:26:40.958Z INF/api 74787 [*] Receiving input from "tcp://127.0.0.1:7111"
2018-05-03T17:26:41.066Z INF/db 74787 [*] Connecting to 127.0.0.1:28015
2018-05-03T17:26:41.234Z INF/device:support:sub 74798 [98885135314e35354e] Receiving input from "tcp://127.0.0.1:7114"
2018-05-03T17:26:41.235Z INF/device:support:sub 74798 [98885135314e35354e] Subscribing to permanent channel "*ALL"
2018-05-03T17:26:41.270Z INF/device:support:properties 74798 [98885135314e35354e] Loading properties
2018-05-03T17:26:41.301Z INF/device:support:sdk 74798 [98885135314e35354e] Supports SDK 26
2018-05-03T17:26:41.302Z INF/device:support:abi 74798 [98885135314e35354e] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
2018-05-03T17:26:41.381Z INF/device:resources:minicap 74798 [98885135314e35354e] Installing "/Users/lalith/Desktop/stf/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/bin/minicap" as "/data/local/tmp/minicap"
2018-05-03T17:26:41.382Z INF/device:resources:minicap 74798 [98885135314e35354e] Installing "/Users/lalith/Desktop/stf/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/lib/android-26/minicap.so" as "/data/local/tmp/minicap.so"
2018-05-03T17:26:41.448Z INF/device:resources:service 74798 [98885135314e35354e] Checking whether we need to install STFService
2018-05-03T17:26:41.902Z INF/device:resources:service 74798 [98885135314e35354e] Running version check
2018-05-03T17:26:42.329Z INF/device:resources:service 74798 [98885135314e35354e] STFService up to date
2018-05-03T17:26:42.331Z INF/device:plugins:service 74798 [98885135314e35354e] Launching agent
2018-05-03T17:26:42.804Z INF/device:plugins:service 74798 [98885135314e35354e] Agent says: "Listening on @stfagent"
2018-05-03T17:26:42.862Z INF/device:plugins:service 74798 [98885135314e35354e] Launching service
2018-05-03T17:26:42.863Z INF/device:plugins:service 74798 [98885135314e35354e] Agent says: "InputClient started"
2018-05-03T17:26:42.909Z INF/device:plugins:display 74798 [98885135314e35354e] Reading display info
2018-05-03T17:26:42.935Z INF/device:plugins:phone 74798 [98885135314e35354e] Fetching phone info
2018-05-03T17:26:42.955Z INF/device:plugins:identity 74798 [98885135314e35354e] Solving identity
2018-05-03T17:26:42.956Z INF/device:plugins:solo 74798 [98885135314e35354e] Subscribing to permanent channel "ny4xLYJddNEKWFjMUpX1P23su5Y="
2018-05-03T17:26:42.958Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Starting WebSocket server on port 7400
2018-05-03T17:26:43.031Z INF/device:resources:minitouch 74798 [98885135314e35354e] Installing "/Users/lalith/Desktop/stf/node_modules/minitouch-prebuilt/prebuilt/arm64-v8a/bin/minitouch" as "/data/local/tmp/minitouch"
2018-05-03T17:26:43.065Z WRN/device:plugins:data 74798 [98885135314e35354e] Unable to find device data { serial: '98885135314e35354e',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: 'AT&T',
  model: 'SM-G955U',
  version: '8.0.0',
  abi: 'arm64-v8a',
  sdk: '26',
  product: 'dream2qltesq',
  cpuPlatform: 'msm8998',
  openGLESVersion: '3.2',
  display: 
   { id: 0,
     width: 1080,
     height: 2220,
     xdpi: 391.885498046875,
     ydpi: 394.321533203125,
     fps: 60.000003814697266,
     density: 2.625,
     rotation: 0,
     secure: true,
     size: 6.268258154652902,
     url: 'ws://localhost:7400' },
  phone: 
   { imei: '******************', **I removed these for privacy purposes**
     imsi: '******************',**I removed these for privacy purposes**
     phoneNumber: '+************',**I removed these for privacy purposes**
     iccid: '*****************',**I removed these for privacy purposes**
     network: 'LTE' } }
2018-05-03T17:26:43.069Z INF/device:plugins:touch 74798 [98885135314e35354e] Touch origin is top left
2018-05-03T17:26:43.069Z INF/device:plugins:touch 74798 [98885135314e35354e] Requesting touch consumer to start
2018-05-03T17:26:43.070Z INF/device:plugins:touch 74798 [98885135314e35354e] Launching touch service
2018-05-03T17:26:43.076Z INF/device:plugins:touch 74798 [98885135314e35354e] Connecting to minitouch service
2018-05-03T17:26:43.086Z INF/device:plugins:touch 74798 [98885135314e35354e] minitouch says: "Note: device /dev/input/mouse2 is not supported by libevdev"
2018-05-03T17:26:43.087Z INF/device:plugins:touch 74798 [98885135314e35354e] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2018-05-03T17:26:43.087Z INF/device:plugins:touch 74798 [98885135314e35354e] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
2018-05-03T17:26:43.087Z INF/device:plugins:touch 74798 [98885135314e35354e] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
2018-05-03T17:26:43.088Z INF/device:plugins:touch 74798 [98885135314e35354e] minitouch says: "Note: device /dev/input/event3 was outscored by /dev/input/event2 (2109 >= 1109)"
2018-05-03T17:26:43.088Z INF/device:plugins:touch 74798 [98885135314e35354e] minitouch says: "Type B touch device sec_touchscreen (1439x2959 with 10 contacts) detected on /dev/input/event2 (score 2109)"
2018-05-03T17:26:43.190Z INF/device:plugins:touch 74798 [98885135314e35354e] Reading minitouch banner
2018-05-03T17:26:43.194Z INF/device:plugins:touch 74798 [98885135314e35354e] minitouch says: "Connection established"
2018-05-03T17:26:43.195Z INF/device:plugins:vnc 74798 [98885135314e35354e] Starting VNC server on port 7402
2018-05-03T17:26:43.197Z INF/device:plugins:browser 74798 [98885135314e35354e] Loading browser list
2018-05-03T17:26:43.226Z INF/device:plugins:browser 74798 [98885135314e35354e] Updating browser list
2018-05-03T17:26:43.229Z INF/device:plugins:mute 74798 [98885135314e35354e] Will not mute master volume
2018-05-03T17:26:43.298Z INF/device:resources:minirev 74798 [98885135314e35354e] Installing "/Users/lalith/Desktop/stf/vendor/minirev/arm64-v8a/minirev" as "/data/local/tmp/minirev"
2018-05-03T17:26:43.339Z INF/device:plugins:forward 74798 [98885135314e35354e] Launching reverse port forwarding service
2018-05-03T17:26:43.344Z INF/device:plugins:forward 74798 [98885135314e35354e] Connecting to reverse port forwarding service
2018-05-03T17:26:43.899Z INF/device:plugins:connect 74798 [98885135314e35354e] Listening on port 7401
2018-05-03T17:26:43.902Z INF/device 74798 [98885135314e35354e] Fully operational
2018-05-03T17:26:50.487Z INF/provider 74784 [*] Providing all 1 device(s)
2018-05-03T17:26:53.842Z IMP/device:plugins:group 74798 [98885135314e35354e] Now owned by "test@test.com"
2018-05-03T17:26:53.842Z INF/device:plugins:group 74798 [98885135314e35354e] Subscribing to group channel "BxeBwZ+rSCGKJn1ANpi8BA=="
2018-05-03T17:26:54.004Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Setting frame producer projection to 862x1370
2018-05-03T17:26:54.004Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Requesting frame producer to start
2018-05-03T17:26:54.006Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Launching screen service
2018-05-03T17:26:54.008Z IMP/device:plugins:connect 74798 [98885135314e35354e] Remote Connect Started for device "98885135314e35354e" at "localhost:7401"
2018-05-03T17:26:54.092Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "PID: 30161"
2018-05-03T17:26:54.092Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: Using projection 1080x2220@666x1370/0"
2018-05-03T17:26:54.093Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:241) Creating SurfaceComposerClient"
2018-05-03T17:26:54.095Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:244) Performing SurfaceComposerClient init check"
2018-05-03T17:26:54.095Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:255) Creating virtual display"
2018-05-03T17:26:54.096Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:261) Creating buffer queue"
2018-05-03T17:26:54.096Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:264) Setting buffer options"
2018-05-03T17:26:54.097Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:268) Creating CPU consumer"
2018-05-03T17:26:54.097Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:272) Creating frame waiter"
2018-05-03T17:26:54.097Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (external/MY_minicap/src/minicap_26.cpp:276) Publishing virtual display"
2018-05-03T17:26:54.098Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Connecting to minicap service
2018-05-03T17:26:54.107Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 7261188 bytes for JPG encoder"
2018-05-03T17:26:54.211Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
2018-05-03T17:26:54.212Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Reading minicap banner
2018-05-03T17:27:12.280Z INF/device:plugins:logcat 74798 [98885135314e35354e] Starting logcat
2018-05-03T17:27:12.372Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:11.489Z,
  pid: 30196,
  tid: 30196,
  priority: 6,
  tag: 'propClient',
  message: 'PropClient failed to load' }
2018-05-03T17:27:12.565Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:11.686Z,
  pid: 631,
  tid: 761,
  priority: 4,
  tag: 'qti_sensors_hal',
  message: 'processReportInd: Accel - X: 0.166 Y: 0.107 Z: 9.731' }
2018-05-03T17:27:12.648Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:11.769Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'pcf : 0x1012' }
2018-05-03T17:27:12.649Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:11.769Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'thread id : 1, preenroll_flag : 0, nd cnt : 0, cso : 0' }
2018-05-03T17:27:12.649Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:11.769Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'FPBAuthService, 7733' }
2018-05-03T17:27:13.111Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:12.232Z,
  pid: 3897,
  tid: 4521,
  priority: 4,
  tag: 'WifiTrafficPoller',
  message: 'mCpuCoreBooster Lock' }
2018-05-03T17:27:13.137Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:12.260Z,
  pid: 661,
  tid: 661,
  priority: 4,
  tag: 'HWComposer',
  message: 'getActiveConfigs: Attempted to access invalid display -1' }
2018-05-03T17:27:13.282Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:12.403Z,
  pid: 3897,
  tid: 4641,
  priority: 3,
  tag: 'WifiConnectivityMonitor',
  message: ' [] [|203]' }
2018-05-03T17:27:13.371Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:12.492Z,
  pid: 12179,
  tid: 12551,
  priority: 3,
  tag: 'com.facebook.appevents.AppEventsLogger',
  message: 'Got unexpected exception: java.io.WriteAbortedException: writing aborted; java.io.NotSerializableException: org.json.JSONObject' }
2018-05-03T17:27:13.647Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:12.769Z,
  pid: 5600,
  tid: 5600,
  priority: 3,
  tag: 'io_stats',
  message: '!@   8,0 r 3492961 113468096 w 1495977 27724392 d 107024 8681360 f 585906 624927 iot 2501000 1479910 th 307200 0 0 pt 0 inp 0 0 96096.398' }
2018-05-03T17:27:13.647Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:12.770Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'pcf : 0x1012' }
2018-05-03T17:27:13.648Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:12.770Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'thread id : 1, preenroll_flag : 0, nd cnt : 0, cso : 0' }
2018-05-03T17:27:13.649Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:12.770Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'FPBAuthService, 7733' }
2018-05-03T17:27:14.024Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:13.148Z,
  pid: 3897,
  tid: 8725,
  priority: 3,
  tag: 'SSRM:B',
  message: 'SIOP:: AP = 310, PST = 314 (W:15), BAT = 294, USB = 288, CHG = 320, CP = 307' }
2018-05-03T17:27:14.112Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:13.234Z,
  pid: 3897,
  tid: 4521,
  priority: 4,
  tag: 'WifiTrafficPoller',
  message: 'mCpuCoreBooster Lock' }
2018-05-03T17:27:14.137Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:13.261Z,
  pid: 661,
  tid: 661,
  priority: 4,
  tag: 'HWComposer',
  message: 'getActiveConfigs: Attempted to access invalid display -1' }
2018-05-03T17:27:14.648Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:13.770Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'pcf : 0x1012' }
2018-05-03T17:27:14.649Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:13.770Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'thread id : 1, preenroll_flag : 0, nd cnt : 0, cso : 0' }
2018-05-03T17:27:14.649Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:13.770Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'FPBAuthService, 7733' }
2018-05-03T17:27:14.713Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:13.833Z,
  pid: 29498,
  tid: 29655,
  priority: 3,
  tag: 'com.facebook.appevents.AppEventsLogger',
  message: 'Got unexpected exception: java.io.WriteAbortedException: writing aborted; java.io.NotSerializableException: org.json.JSONObject' }
2018-05-03T17:27:15.115Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:14.237Z,
  pid: 3897,
  tid: 4521,
  priority: 4,
  tag: 'WifiTrafficPoller',
  message: 'mCpuCoreBooster Lock' }
2018-05-03T17:27:15.138Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:14.262Z,
  pid: 661,
  tid: 661,
  priority: 4,
  tag: 'HWComposer',
  message: 'getActiveConfigs: Attempted to access invalid display -1' }
2018-05-03T17:27:15.649Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:14.771Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'pcf : 0x1012' }
2018-05-03T17:27:15.649Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:14.771Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'thread id : 1, preenroll_flag : 0, nd cnt : 0, cso : 0' }
2018-05-03T17:27:15.649Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:14.771Z,
  pid: 3642,
  tid: 6128,
  priority: 3,
  tag: 'bauth_FPBAuthService',
  message: 'FPBAuthService, 7733' }
2018-05-03T17:27:16.118Z INF/device:plugins:logcat 74798 [98885135314e35354e] Log Entry:entryListener :::  Entry {
  date: 2018-05-03T17:27:15.239Z,
  pid: 3897,
  tid: 4521,
  priority: 4,
  tag: 'WifiTrafficPoller',
  message: 'mCpuCoreBooster Lock' }
2018-05-03T17:27:16.444Z INF/device:plugins:logcat 74798 [98885135314e35354e] Stopping logcat
2018-05-03T17:27:31.969Z INF/device:plugins:logcat 74798 [98885135314e35354e] Starting logcat
2018-05-03T17:27:36.223Z INF/device:plugins:logcat 74798 [98885135314e35354e] Stopping logcat
2018-05-03T17:27:39.913Z INF/device:plugins:logcat 74798 [98885135314e35354e] Starting logcat
2018-05-03T17:27:46.907Z INF/device:plugins:logcat 74798 [98885135314e35354e] Stopping logcat
2018-05-03T17:27:52.640Z INF/util:lifecycle 74786 [*] Winding down for graceful exit
2018-05-03T17:27:52.640Z INF/util:lifecycle 74785 [*] Winding down for graceful exit
2018-05-03T17:27:52.640Z INF/util:lifecycle 74798 [98885135314e35354e] Winding down for graceful exit
2018-05-03T17:27:52.640Z INF/cli:local 74777 [*] Received SIGINT, waiting for processes to terminate
2018-05-03T17:27:52.640Z INF/auth-mock 74785 [*] Waiting for client connections to end
2018-05-03T17:27:52.641Z INF/util:lifecycle 74783 [reaper001] Winding down for graceful exit
2018-05-03T17:27:52.643Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Requesting frame producer to stop
2018-05-03T17:27:52.643Z INF/util:lifecycle 74782 [proc002] Winding down for graceful exit
2018-05-03T17:27:52.643Z INF/util:lifecycle 74786 [*] Winding down for graceful exit
2018-05-03T17:27:52.643Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Disconnecting from minicap service
2018-05-03T17:27:52.644Z INF/util:lifecycle 74781 [proc001] Winding down for graceful exit
2018-05-03T17:27:52.645Z INF/util:lifecycle 74780 [dev001] Winding down for graceful exit
2018-05-03T17:27:52.645Z INF/util:lifecycle 74779 [app001] Winding down for graceful exit
2018-05-03T17:27:52.645Z INF/device:plugins:screen:stream 74798 [98885135314e35354e] Requesting frame producer to stop
2018-05-03T17:27:52.645Z INF/util:lifecycle 74788 [*] Winding down for graceful exit
2018-05-03T17:27:52.640Z INF/util:lifecycle 74784 [*] Winding down for graceful exit
2018-05-03T17:27:52.646Z INF/util:lifecycle 74787 [*] Winding down for graceful exit
2018-05-03T17:27:52.647Z IMP/device:plugins:group 74798 [98885135314e35354e] No longer owned by "test@test.com"
2018-05-03T17:27:52.647Z INF/device:plugins:group 74798 [98885135314e35354e] Unsubscribing from group channel "BxeBwZ+rSCGKJn1ANpi8BA=="
2018-05-03T17:27:52.648Z INF/util:lifecycle 74788 [*] Winding down for graceful exit
2018-05-03T17:27:52.649Z INF/util:lifecycle 74787 [*] Winding down for graceful exit
2018-05-03T17:27:52.649Z WRN/db 74782 [proc002] Connection closed
2018-05-03T17:27:52.650Z INF/util:lifecycle 74784 [*] Winding down for graceful exit
2018-05-03T17:27:52.650Z INF/provider 74784 [*] Cleaning up device worker "98885135314e35354e"
2018-05-03T17:27:52.651Z INF/provider 74784 [*] Gracefully killing device worker "98885135314e35354e"
2018-05-03T17:27:52.651Z WRN/db 74786 [*] Connection closed
2018-05-03T17:27:52.651Z WRN/db 74783 [reaper001] Connection closed
2018-05-03T17:27:52.652Z WRN/db 74781 [proc001] Connection closed
2018-05-03T17:27:52.652Z WRN/db 74787 [*] Connection closed
2018-05-03T17:27:52.653Z WRN/db 74788 [*] Connection closed
2018-05-03T17:27:52.663Z INF/provider 74784 [*] Device worker "98885135314e35354e" has retired


**Please run `stf doctor` and paste the output here.**
2018-05-03T17:21:28.235Z INF/cli:doctor 70520 [*] OS Arch: x64
2018-05-03T17:21:28.237Z INF/cli:doctor 70520 [*] OS Platform: darwin
2018-05-03T17:21:28.237Z INF/cli:doctor 70520 [*] OS Platform: 15.2.0
2018-05-03T17:21:28.237Z INF/cli:doctor 70520 [*] Using Node 8.9.1
2018-05-03T17:21:28.261Z INF/cli:doctor 70520 [*] Using ZeroMQ 4.2.2
2018-05-03T17:21:28.293Z INF/cli:doctor 70520 [*] Using ADB 1.0.39
2018-05-03T17:21:28.309Z INF/cli:doctor 70520 [*] Using GraphicsMagick 1.3.26
2018-05-03T17:21:28.314Z INF/cli:doctor 70520 [*] Using RethinkDB 2.3.5
2018-05-03T17:21:28.350Z INF/cli:doctor 70520 [*] Using ProtoBuf 3.3.2
 no, it works only once the button ('Get') is pressed and once ('Stop') is pressed it stops and ('Get') never works again. Browser refresh solves nothing. If you'd notice the above logs are from the remote/webserver.

Also I noted that when running 
'adb logcat' in command line and then running the above steps will not work even once.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
/usr/local/bin/stf --version
3.3.0
**What is the issue or idea you have?**
Can't connect to Orange Pi One Plus

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
20080411               device usb:337641472X product:petrel_fvd_p1 model:molly device:petrel-p1 transport_id:10

**Please provide the steps to reproduce the issue.**
Just connect the Orange Pi One Plus to the STF local.

**What is the expected behavior?**
Well, being able to launch applications on the device.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
2018-05-03T08:03:48.816Z INF/device:support:push 2893 [20080411] Sending output to "tcp://127.0.0.1:7116"
2018-05-03T08:03:48.821Z INF/device 2893 [20080411] Preparing device
2018-05-03T08:03:49.589Z INF/device:support:sub 2893 [20080411] Receiving input from "tcp://127.0.0.1:7114"
2018-05-03T08:03:49.591Z INF/device:support:sub 2893 [20080411] Subscribing to permanent channel "*ALL"
2018-05-03T08:03:49.664Z INF/device:support:properties 2893 [20080411] Loading properties
2018-05-03T08:03:49.709Z INF/device:support:sdk 2893 [20080411] Supports SDK 24
2018-05-03T08:03:49.710Z INF/device:support:abi 2893 [20080411] Supports ABIs armeabi-v7a, armeabi
2018-05-03T08:03:49.790Z INF/device:resources:minicap 2893 [20080411] Installing "/Users/openstf/local/stf/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
2018-05-03T08:03:49.791Z INF/device:resources:minicap 2893 [20080411] Installing "/Users/openstf/local/stf/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
2018-05-03T08:03:49.874Z INF/device:resources:service 2893 [20080411] Checking whether we need to install STFService

2018-05-03T08:03:50.577Z INF/device:resources:service 2893 [20080411] Running version check
2018-05-03T08:03:51.328Z INF/device:resources:service 2893 [20080411] STFService up to date
2018-05-03T08:03:51.333Z INF/device:plugins:service 2893 [20080411] Launching agent
2018-05-03T08:03:52.170Z INF/device:plugins:service 2893 [20080411] Launching service
2018-05-03T08:03:52.229Z INF/device:plugins:service 2893 [20080411] Agent says: "Listening on @stfagent"
2018-05-03T08:03:52.229Z INF/device:plugins:service 2893 [20080411] Agent says: "InputClient started"
2018-05-03T08:03:52.900Z INF/device:plugins:display 2893 [20080411] Reading display info
2018-05-03T08:03:52.913Z INF/device:plugins:phone 2893 [20080411] Fetching phone info
2018-05-03T08:03:52.924Z INF/device:plugins:identity 2893 [20080411] Solving identity
2018-05-03T08:03:52.925Z INF/device:plugins:solo 2893 [20080411] Subscribing to permanent channel "t3aRBtU4pcakPT94k1nnxInAnAI="
2018-05-03T08:03:52.928Z INF/device:plugins:screen:stream 2893 [20080411] Starting WebSocket server on port 7416
2018-05-03T08:03:52.989Z INF/device:resources:minitouch 2893 [20080411] Installing "/Users/openstf/local/stf/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
2018-05-03T08:03:53.029Z WRN/device:plugins:data 2893 [20080411] Unable to find device data { serial: '20080411',
  platform: 'Android',
  manufacturer: 'ALLWINNER',
  operator: null,
  model: 'molly',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'petrel_fvd_p1',
  cpuPlatform: 'petrel',
  openGLESVersion: '2.0',
  display:
   { id: 0,
     width: 1280,
     height: 1024,
     xdpi: 213,
     ydpi: 213,
     fps: 50,
     density: 1,
     rotation: 0,
     secure: true,
     size: 7.6957737313746915,
     url: 'ws://10.24.73.106:7416' },
  phone: { network: 'UNKNOWN' } }
2018-05-03T08:03:53.034Z INF/device:plugins:touch 2893 [20080411] Touch origin is top left
2018-05-03T08:03:53.035Z INF/device:plugins:touch 2893 [20080411] Requesting touch consumer to start
2018-05-03T08:03:53.036Z INF/device:plugins:touch 2893 [20080411] Launching touch service
2018-05-03T08:03:53.043Z INF/device:plugins:touch 2893 [20080411] Connecting to minitouch service
2018-05-03T08:03:53.177Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
2018-05-03T08:03:53.424Z INF/provider 2880 [*] Providing 1 of 2 device(s); waiting for "20080411"
2018-05-03T08:03:53.497Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
2018-05-03T08:03:53.617Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2018-05-03T08:03:53.778Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Unable to find a suitable touch device"
2018-05-03T08:03:53.779Z WRN/device:plugins:touch 2893 [20080411] Shell keeping minitouch running ended unexpectedly
2018-05-03T08:03:53.781Z INF/device:plugins:touch 2893 [20080411] Disconnecting from minitouch service
2018-05-03T08:03:53.784Z INF/device:plugins:touch 2893 [20080411] Stopping minitouch service
2018-05-03T08:03:53.785Z INF/device:plugins:touch 2893 [20080411] Launching touch service
2018-05-03T08:03:53.792Z INF/device:plugins:touch 2893 [20080411] Connecting to minitouch service
2018-05-03T08:03:53.907Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
2018-05-03T08:03:53.915Z INF/reaper 2879 [reaper001] Reaping device "20080411" due to heartbeat timeout
2018-05-03T08:03:54.307Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
2018-05-03T08:03:54.457Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2018-05-03T08:03:54.608Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Unable to find a suitable touch device"
2018-05-03T08:03:54.609Z WRN/device:plugins:touch 2893 [20080411] Shell keeping minitouch running ended unexpectedly
2018-05-03T08:03:54.610Z INF/device:plugins:touch 2893 [20080411] Disconnecting from minitouch service
2018-05-03T08:03:54.612Z INF/device:plugins:touch 2893 [20080411] Stopping minitouch service
2018-05-03T08:03:54.613Z INF/device:plugins:touch 2893 [20080411] Launching touch service
2018-05-03T08:03:54.619Z INF/device:plugins:touch 2893 [20080411] Connecting to minitouch service
2018-05-03T08:03:54.726Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
2018-05-03T08:03:54.927Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
2018-05-03T08:03:55.047Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2018-05-03T08:03:55.208Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Unable to find a suitable touch device"
2018-05-03T08:03:55.209Z WRN/device:plugins:touch 2893 [20080411] Shell keeping minitouch running ended unexpectedly
2018-05-03T08:03:55.211Z INF/device:plugins:touch 2893 [20080411] Disconnecting from minitouch service
2018-05-03T08:03:55.212Z INF/device:plugins:touch 2893 [20080411] Stopping minitouch service
2018-05-03T08:03:55.213Z INF/device:plugins:touch 2893 [20080411] Launching touch service
2018-05-03T08:03:55.220Z INF/device:plugins:touch 2893 [20080411] Connecting to minitouch service
2018-05-03T08:03:55.337Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
2018-05-03T08:03:55.527Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
2018-05-03T08:03:55.647Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2018-05-03T08:03:55.797Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Unable to find a suitable touch device"
2018-05-03T08:03:55.798Z WRN/device:plugins:touch 2893 [20080411] Shell keeping minitouch running ended unexpectedly
2018-05-03T08:03:55.801Z INF/device:plugins:touch 2893 [20080411] Disconnecting from minitouch service
2018-05-03T08:03:55.804Z WRN/device:plugins:touch 2893 [20080411] Will not apply desired state due to too many failures
2018-05-03T08:03:55.807Z INF/device:plugins:touch 2893 [20080411] Stopping minitouch service
2018-05-03T08:03:55.810Z FTL/device 2893 [20080411] Setup had an error Error: Failed more than 3 times in 10000ms
    at TouchConsumer._failLimitExceeded (/Users/openstf/local/stf/lib/units/device/plugins/touch/index.js:230:26)
    at FailCounter.emit (/Users/openstf/local/stf/node_modules/eventemitter3/index.js:117:35)
    at FailCounter.inc (/Users/openstf/local/stf/lib/util/failcounter.js:29:10)
    at TouchConsumer._outputEnded (/Users/openstf/local/stf/lib/units/device/plugins/touch/index.js:223:24)
    at RiskyStream.emit (/Users/openstf/local/stf/node_modules/eventemitter3/index.js:115:35)
    at RiskyStream.<anonymous> (/Users/openstf/local/stf/lib/util/riskystream.js:14:12)
    at emitNone (events.js:111:20)
    at Socket.emit (events.js:208:7)
    at endReadableNT (_stream_readable.js:1064:12)
    at _combinedTickCallback (internal/process/next_tick.js:138:11)
From previous event:
    at startConsumer (/Users/openstf/local/stf/lib/units/device/plugins/touch/index.js:511:14)
    at /Users/openstf/local/stf/lib/units/device/plugins/touch/index.js:526:12
    at SerialSyrup.ParallelSyrup.invoke (/Users/openstf/local/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /Users/openstf/local/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at _combinedTickCallback (internal/process/next_tick.js:131:7)
    at process._tickCallback (internal/process/next_tick.js:180:9)

**Please run `stf doctor` and paste the output here.**
 /usr/local/bin/stf doctor
2018-05-03T08:08:01.775Z INF/cli:doctor 2910 [*] OS Arch: x64
2018-05-03T08:08:01.778Z INF/cli:doctor 2910 [*] OS Platform: darwin
2018-05-03T08:08:01.778Z INF/cli:doctor 2910 [*] OS Platform: 15.6.0
2018-05-03T08:08:01.778Z INF/cli:doctor 2910 [*] Using Node 8.11.1
2018-05-03T08:08:01.887Z INF/cli:doctor 2910 [*] Using ZeroMQ 4.3.1
2018-05-03T08:08:01.942Z INF/cli:doctor 2910 [*] Using ADB 1.0.39
2018-05-03T08:08:02.544Z INF/cli:doctor 2910 [*] Using GraphicsMagick 1.3.28
2018-05-03T08:08:02.589Z INF/cli:doctor 2910 [*] Using ProtoBuf 3.5.1
2018-05-03T08:08:02.598Z INF/cli:doctor 2910 [*] Using RethinkDB 2.3.6
 Thanks @thinkhy. I used the OrangePi_OnePlus_Android_7.0_en_gapps_v1.3.img ROM.
I'm trying to compile a version myself (but not with much luck for the time being).
I don't know how to start, but I will see if I can make anything to get it to work for this board/ROM. Wow, thanks a lot! I will have a look at the security option if it ever exists. This issue seems to be similar to: https://github.com/openstf/stf/issues/599 
This part of the log:
```
2018-05-03T08:03:55.337Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
2018-05-03T08:03:55.527Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
2018-05-03T08:03:55.647Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2018-05-03T08:03:55.797Z INF/device:plugins:touch 2893 [20080411] minitouch says: "Unable to find a suitable touch device"
```
suggests that there is no touchscreen.
At the time of writing multitouch capability is required for minitouch to work. Yes, it looks like the source of the error is the same. I was thinking of buying an Odroid C2 to get rid of this issue as this card is way more supported than Orange Pi, but thanks to #599, I know it won't solve this issue.
I'll clone the minitouch repo, and see what I can do.
Thanks @koral-- . @gounthar please provide the steps you made to install it on pi @nateby : sorry for not understanding. What do you want to know? How I installed Android on the OrangePi One Plus, or how I installed openSTF?
Thanks. @gounthar I noticed that you made it with docker and docker-compose on a Raspberry 3B,and it works flawlessly,I try hard and useless,I can't find docker images for 32bits and ARM,please provide some steps
I highly appreciate your help, thanks.  There's not much effort put into this: just a few images modified and built on the pi. I'll try to set it up in a repo and give you the link. Thanks for your interest @nateby. @nateby : I wrote a quick documentation about my use of hypriotOS and openSTF local there: https://github.com/gounthar/openstf-armv7-behind-proxy-with-hypriot.
I haven't done much, just gathered some information.
I will someday write another one regarding hypriotOS and openSTF provider (with some images of my own). @gounthar thanks for your help^o^ ^o^ ^o^  hello,guys!!!
It's my first time to use STF to manager mobile phone, STF show devices normality when I connect devices by usb, but STF can not show the devices when I connect devices by ip:port.
I connect devices with this command:
```
adb connect <host>[:<port>]
```
Is there a way to show the devices connected by ip:port ?
  I have some question do this openstf can control 1 process in all mobile?

For example:
If i have 50 phone number with the some model and the position of apps placement are the same position on display.. But I want to control only 1 phone and others will follow the same flow... can it do that?  Can you give me some clue..  Hello,

I am attempting to make some modifications to OpenSTF and am encountering some issues when trying to interact between classes. This appears to be due to STF-Syrup's dependency injection blocking functions from an external scope. 

In short, I would like to be able to reference functions in _bar.js_ (Uses Syrup) FROM _foo.js_ (Does not use Syrup). I can successfully require and assign _bar.js_, but instead of a typical class object, I receive a SerialSyrup object that util.inspect shows is constructed like this:

```
SerialSyrup {
  options: {},
  body: [Function],
  dependencies:
   [ SerialSyrup {
       options: {},
       body: [Function],
       dependencies: [],
       resolved: null } ],
  resolved: null }
```
  
Every attempt to reference functions that exist within the "module.exports" block of _bar.js_ fails with "...is not a function" when called from _foo.js_ . Is there a way I can reach inside this block, other than totally refactoring _foo.js_ to be a Syrup module and importing _bar.js_ as a dependency?

PS: Reposting from [/openstf/stf-syrup](https://github.com/openstf/stf-syrup/issues/3), as that issue page appears dead.
 Same issue here. Attempting to modify the packages auto-cleanup to be scheduled every few days. For that I've written a simple cron that injects cleanup.js. 

```
module.exports = syrup.serial()
  .dependency(require('./cleanup'))
  .define(function(options, cleanup) {
    var log = logger.createLogger('device:plugins:cleanupCron')
    return {
      uninstallPackagesCron: function() {
        nodeSchedule.scheduleJob(CLEANUP_EVERY_SUNDAY, function() {
          log.info('Cleanup job launched')
          // *logic here*
        })
      }
    }
  })
```
Cron is then required in app/index.js with the server startup
```
var cleanupCron = require('./../device/plugins/cleanupCron')
```
And what I get from logging the cleanupCron is the whole SerialSyrup object with no way to reach the uninstallPackagesCron function
```
 SerialSyrup {
  options: {},
  body: [Function],
  dependencies: 
   [ SerialSyrup {
       options: {},
       body: [Function],
       dependencies: [Array],
       resolved: null } ],
  resolved: null }
```  Touch point doesn't match between the touch on STF Control and the touch on Real Device.
Please see the bellow picture, mobile is OPPO R15.

Any solution? @sorccu 

![touchpoint](https://user-images.githubusercontent.com/7412385/39171852-9725b872-47d2-11e8-95d8-10835424ae37.png)
 @sorccu thank you S.K. for the reply, I'll try if it was fixed. Once I've done, will update result here. @sorccu thanks sk，looks working fine.  I installed app and run stf, after sometime it removes this app. If not using stf, app still there forever. This happen on all my devices (7 devices).

Here is stf doctor:
2018-04-24T02:58:50.746Z INF/cli:doctor 29317 [*] OS Arch: x64
2018-04-24T02:58:50.747Z INF/cli:doctor 29317 [*] OS Platform: linux
2018-04-24T02:58:50.748Z INF/cli:doctor 29317 [*] OS Platform: 4.4.0-119-generic
2018-04-24T02:58:50.748Z INF/cli:doctor 29317 [*] Using Node 8.11.1
2018-04-24T02:58:50.758Z INF/cli:doctor 29317 [*] Using ZeroMQ 4.2.2
2018-04-24T02:58:50.767Z INF/cli:doctor 29317 [*] Using GraphicsMagick 1.3.28
2018-04-24T02:58:50.768Z INF/cli:doctor 29317 [*] Using ProtoBuf 3.2.0
2018-04-24T02:58:50.768Z INF/cli:doctor 29317 [*] Using ADB 1.0.39
2018-04-24T02:58:50.769Z INF/cli:doctor 29317 [*] Using RethinkDB 2.3.6~0xenial
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
STF 3.3.0
**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
root@piseth-Latitude-E6320:/home/piseth/Desktop/stf/stf# stf local
2018-04-19T17:38:05.576Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli migrate"
2018-04-19T17:38:05.859Z INF/db 19029 [*] Connecting to 127.0.0.1:28015
2018-04-19T17:38:05.880Z INF/db:setup 19029 [*] Database "stf" already exists
2018-04-19T17:38:05.887Z INF/db:setup 19029 [*] Table "users" already exists
2018-04-19T17:38:05.887Z INF/db:setup 19029 [*] Table "accessTokens" already exists
2018-04-19T17:38:05.887Z INF/db:setup 19029 [*] Table "vncauth" already exists
2018-04-19T17:38:05.887Z INF/db:setup 19029 [*] Table "devices" already exists
2018-04-19T17:38:05.888Z INF/db:setup 19029 [*] Table "logs" already exists
2018-04-19T17:38:05.903Z INF/db:setup 19029 [*] Index "users"."adbKeys" already exists
2018-04-19T17:38:05.903Z INF/db:setup 19029 [*] Index "accessTokens"."email" already exists
2018-04-19T17:38:05.903Z INF/db:setup 19029 [*] Index "vncauth"."response" already exists
2018-04-19T17:38:05.904Z INF/db:setup 19029 [*] Index "vncauth"."responsePerDevice" already exists
2018-04-19T17:38:05.904Z INF/db:setup 19029 [*] Index "devices"."owner" already exists
2018-04-19T17:38:05.904Z INF/db:setup 19029 [*] Index "devices"."present" already exists
2018-04-19T17:38:05.904Z INF/db:setup 19029 [*] Index "devices"."providerChannel" already exists
2018-04-19T17:38:05.904Z INF/db:setup 19029 [*] Waiting for index "users"."adbKeys"
2018-04-19T17:38:05.905Z INF/db:setup 19029 [*] Waiting for index "accessTokens"."email"
2018-04-19T17:38:05.905Z INF/db:setup 19029 [*] Waiting for index "vncauth"."response"
2018-04-19T17:38:05.906Z INF/db:setup 19029 [*] Waiting for index "vncauth"."responsePerDevice"
2018-04-19T17:38:05.906Z INF/db:setup 19029 [*] Waiting for index "devices"."owner"
2018-04-19T17:38:05.906Z INF/db:setup 19029 [*] Waiting for index "devices"."present"
2018-04-19T17:38:05.907Z INF/db:setup 19029 [*] Waiting for index "devices"."providerChannel"
2018-04-19T17:38:05.910Z INF/db:setup 19029 [*] Index "users"."adbKeys" is ready
2018-04-19T17:38:05.910Z INF/db:setup 19029 [*] Index "accessTokens"."email" is ready
2018-04-19T17:38:05.910Z INF/db:setup 19029 [*] Index "vncauth"."response" is ready
2018-04-19T17:38:05.912Z INF/db:setup 19029 [*] Index "vncauth"."responsePerDevice" is ready
2018-04-19T17:38:05.912Z INF/db:setup 19029 [*] Index "devices"."owner" is ready
2018-04-19T17:38:05.912Z INF/db:setup 19029 [*] Index "devices"."present" is ready
2018-04-19T17:38:05.912Z INF/db:setup 19029 [*] Index "devices"."providerChannel" is ready
2018-04-19T17:38:05.918Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
2018-04-19T17:38:05.920Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
2018-04-19T17:38:05.924Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2018-04-19T17:38:05.937Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2018-04-19T17:38:05.943Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
2018-04-19T17:38:05.949Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli provider --name piseth-Latitude-E6320 --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800 --mute-master never"
2018-04-19T17:38:05.957Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
2018-04-19T17:38:05.969Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
2018-04-19T17:38:05.980Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
2018-04-19T17:38:05.985Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
2018-04-19T17:38:05.997Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-temp --port 7102"
2018-04-19T17:38:06.005Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
2018-04-19T17:38:06.017Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
2018-04-19T17:38:06.026Z INF/util:procutil 19023 [*] Forking "/usr/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
/usr/lib/node_modules/stf/lib/cli triproxy [name]

Options:
  -h, --help         Show help.                                        [boolean]
  -V, --version      Show version.                                     [boolean]
  --bind-dealer, -d  The address to bind the ZeroMQ DEALER endpoint to.
                                              [string] [default: "tcp://*:7112"]
  --bind-pub, -u     The address to bind the ZeroMQ PUB endpoint to.
                                              [string] [default: "tcp://*:7111"]
  --bind-pull, -p    The address to bind the ZeroMQ PULL endpoint to.
                                              [string] [default: "tcp://*:7113"]
  --name             An easily identifiable name for log output.
                                     [string] [default: "piseth-Latitude-E6320"]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_TRIPROXY_` (e.g. `STF_TRIPROXY_BIND_PUB`).

Could not locate the bindings file. Tried:
 → /usr/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/compiled/9.11.1/linux/x64/zmq.node
2018-04-19T17:38:07.334Z FTL/cli:local 19023 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:180:13)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:209:12)
2018-04-19T17:38:07.335Z INF/cli:local 19023 [*] Shutting down all child processes
/usr/lib/node_modules/stf/lib/cli triproxy [name]

Options:
  -h, --help         Show help.                                        [boolean]
  -V, --version      Show version.                                     [boolean]
  --bind-dealer, -d  The address to bind the ZeroMQ DEALER endpoint to.
                                              [string] [default: "tcp://*:7112"]
  --bind-pub, -u     The address to bind the ZeroMQ PUB endpoint to.
                                              [string] [default: "tcp://*:7111"]
  --bind-pull, -p    The address to bind the ZeroMQ PULL endpoint to.
                                              [string] [default: "tcp://*:7113"]
  --name             An easily identifiable name for log output.
                                     [string] [default: "piseth-Latitude-E6320"]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_TRIPROXY_` (e.g. `STF_TRIPROXY_BIND_PUB`).

Could not locate the bindings file. Tried:
 → /usr/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/compiled/9.11.1/linux/x64/zmq.node
**Please run `stf doctor` and paste the output here.**
root@piseth-Latitude-E6320:/home/piseth/Desktop/stf/stf# stf doctor
2018-04-19T17:40:28.254Z INF/cli:doctor 19150 [*] OS Arch: x64
2018-04-19T17:40:28.258Z INF/cli:doctor 19150 [*] OS Platform: linux
2018-04-19T17:40:28.258Z INF/cli:doctor 19150 [*] OS Platform: 4.13.0-37-generic
2018-04-19T17:40:28.258Z INF/cli:doctor 19150 [*] Using Node 9.11.1
2018-04-19T17:40:28.311Z ERR/cli:doctor 19150 [*] Unexpected error checking ZeroMQ: Error: Could not locate the bindings file. Tried:
 → /usr/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/compiled/9.11.1/linux/x64/zmq.node
2018-04-19T17:40:28.312Z INF/cli:doctor 19150 [*] Using RethinkDB 2.3.6~0xenial
2018-04-19T17:40:28.313Z INF/cli:doctor 19150 [*] Using GraphicsMagick 1.3.23
2018-04-19T17:40:28.313Z INF/cli:doctor 19150 [*] Using ProtoBuf 3.2.0
2018-04-19T17:40:28.313Z INF/cli:doctor 19150 [*] Using ADB 1.0.32
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Follow the steps to install, an error occurs when you finally install STF
**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
<--- Last few GCs --->

[31404:0x28396b0]  1115108 ms: Mark-sweep 1257.0 (1820.7) -> 1257.0 (1820.7) MB, 748.9 / 0.0 ms  allocation failure GC in old space requested
[31404:0x28396b0]  1116145 ms: Mark-sweep 1257.0 (1820.7) -> 1257.0 (1768.2) MB, 1037.0 / 0.0 ms  last resort GC in old space requested
[31404:0x28396b0]  1117158 ms: Mark-sweep 1257.0 (1768.2) -> 1257.0 (1746.7) MB, 1013.8 / 0.0 ms  last resort GC in old space requested


<--- JS stacktrace --->

==== JS stack trace =========================================

Security context: 0x209416da57c1 <JSObject>
    1: eaccesFallback [/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/install.js:~412] [pc=0x3595fefbf73c](this=0xdf835d8c211 <JSGlobal Object>)
    2: /* anonymous */ [/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/install.js:132] [bytecode=0x1acba325e2f1 offset=52](this=0xdf835d8c211 <JSGlobal Object>,err=0x2a88cfe6fad1 <Error map = 0x1501d2b84e59>,created=0x9089dd82201 <...

FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memory
 1: node::Abort() [node-gyp]
 2: 0x11f127c [node-gyp]
 3: v8::Utils::ReportOOMFailure(char const*, bool) [node-gyp]
 4: v8::internal::V8::FatalProcessOutOfMemory(char const*, bool) [node-gyp]
 5: v8::internal::Factory::NewUninitializedFixedArray(int) [node-gyp]
 6: 0xdf1d33 [node-gyp]
 7: v8::internal::Runtime_GrowArrayElements(int, v8::internal::Object**, v8::internal::Isolate*) [node-gyp]
 8: 0x3595fee842fd
Aborted (core dumped)
npm ERR! code ELIFECYCLE
npm ERR! errno 134
npm ERR! bufferutil@1.3.0 install: `node-gyp rebuild`
npm ERR! Exit status 134
npm ERR! 
npm ERR! Failed at the bufferutil@1.3.0 install script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /home/data/.npm/_logs/2018-04-18T07_38_03_323Z-debug.log

**Please run `stf doctor` and paste the output here.**
 @sorccu  please help me thanks! node version is 8.11.1   npm is 5.6.0 @sorccu  I don't have this issue with nodejs version 0.x.x, but 0.x.x does not meet the requirements; using the >6.9 version will have this problem, do not know how to solve
Is it related to the order of installation?  Hello, i getting error on;

> apt-get install libtool autoconf automake
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Package autoconf is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source

Package automake is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source

Package libtool is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source

E: Package 'libtool' has no installation candidate
E: Package 'autoconf' has no installation candidate
E: Package 'automake' has no installation candidate

Someone have experience on install it? i have try to install in a week cant find the problem that i facing it..  This one

https://gist.github.com/yasuyk/bbaa28568c497d95ff92566efc4ecc3c  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Use the window system to access web pages, web fonts do not show up.I tried to use Chrome, Firefox and other browsers, but all have the same problem.
![Markdown](http://i1.bvimg.com/640766/e4d32d3d8492d6aa.png)
![Markdown](http://i1.bvimg.com/640766/7932fdb9d969cc7e.png)

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  Hi, I am install latest version of OpenSTF without docker...

Please tell what web-server using by default where is necessary files? I want to configuring it with Apache server, maybe you have some ready documentation about it?  ![image](https://user-images.githubusercontent.com/23339100/38464844-d5dfb89e-3b46-11e8-84bf-534bea079194.png)
 @sorccu some CPU and Memory info can be retrieved from filesystem /proc, we may need a PR for this feature ...  Ok, after many tries I found a way to solve this by reinstalling npm packages  We tried switching to Https but we don't see any change in behavior.
Observation :- stf screen gets immediately refreshed when we refresh the browser.

Now we need to refresh stf screen on browser every time after performing action on device so that both should remain in sync.

Please let us know if there is any parameter we need to update for auto refreshing browser screen. hey guys, i am trying to set this up as well. but i am having trouble setting up the provider client in my remote laptop, i tried everything but in the end it shows that the devices are ignored. can you guy help me on this.
 @habeebshk Can you post your provider file.  In this way #47 , the system prompts "Missing or rejected email address Retry". Must OAuth support openid? For now, our OAuth doesn't support it.  When I run the command "adb -s 10.167.44.71:7401 shell ps "  on Android 8.0, there is no result for pids.
 
![image](https://user-images.githubusercontent.com/26616673/38286511-597f79b6-37f8-11e8-838f-3e2044661144.png)

But if I run the command "adb -s 10.167.44.71:7401 shell ps "  on Android 8.0 without stf, the result is ok.
![image](https://user-images.githubusercontent.com/26616673/38286664-12ddc6f6-37f9-11e8-9106-a0c45ccc5091.png)

And,"adb -s 10.167.44.71:* shell ps "  on Android 7.0,Android6.0,Android5.0, is there some problems on Android8.0？
  Hey, we've integrated STF into our QA infrastructure and I'd like to stream STF device display to webpage out of STF, is there any limitation (cross-origin or smth) for getting screen images by wss://<public>/d/<private>/<udid>/<port>?   I have tried to set something in settings, ,but useless,the phone is meitu MP1602,version 6.0,this is the log:
INF/provider 39615 [*] Restarting device worker "K50LHMB790144"
INF/device:support:push 39977 [K50LHMB790144] Sending output to "tcp://127.0.0.1:7116"
INF/device 39977 [K50LHMB790144] Preparing device
INF/device:support:sub 39977 [K50LHMB790144] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 39977 [K50LHMB790144] Subscribing to permanent channel "*ALL"
INF/device:support:properties 39977 [K50LHMB790144] Loading properties
INF/device:support:sdk 39977 [K50LHMB790144] Supports SDK 23
INF/device:support:abi 39977 [K50LHMB790144] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:minicap 39977 [K50LHMB790144] Installing "/Users/mtp/stf/dy_stf/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 39977 [K50LHMB790144] Installing "/Users/mtp/stf/dy_stf/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/lib/android-23/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 39977 [K50LHMB790144] Checking whether we need to install STFService
INF/device:resources:service 39977 [K50LHMB790144] Running version check
INF/device:resources:service 39977 [K50LHMB790144] STFService up to date
INF/device:plugins:service 39977 [K50LHMB790144] Launching agent
INF/device:plugins:service 39977 [K50LHMB790144] Launching service
INF/device:plugins:service 39977 [K50LHMB790144] Agent says: "Listening on @stfagent"
INF/device:plugins:service 39977 [K50LHMB790144] Agent says: "InputClient started"
FTL/device 39977 [K50LHMB790144] Setup had an error Error: Service had an error: "Error: Requires permission private to package"
    at /Users/mtp/stf/dy_stf/lib/units/device/plugins/service.js:101:23
From previous event:
    at /Users/mtp/stf/dy_stf/lib/units/device/plugins/service.js:76:14
    at runCallback (timers.js:789:20)
    at tryOnImmediate (timers.js:751:5)
    at processImmediate [as _immediateCallback] (timers.js:722:5)
FTL/util:lifecycle 39977 [K50LHMB790144] Shutting down due to fatal error
INF/provider 39615 [*] Cleaning up device worker "K50LHMB790144"
ERR/provider 39615 [*] Device worker "K50LHMB790144" died with code 1
 it is ok now,I  just try these steps:
adb uninstall jp.co.cyberagent.stf 
adb install d:/xxx/STFService.apk 
adb shell am start -n jp.co.cyberagent.stf/.IdentityActivity
adb shell am startservice  -n jp.co.cyberagent.stf/.Service @sorccu I have a MeiTu device, which can't self-start STFService, so we should start it with adb command. Some of Meizu and LeTV devices have similar problem.  Hi @thinkhy 

Interesting FrameSkip strategy.  In your experience: What is the optimal value for **MIN_SENT_INTERVAL**?

Thank you. Great. Thank you.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
3.2.0

**What is the issue or idea you have?**
when i try to run provider in other computer, the provider fails to run because of the error that Tracker had an error Error: Connection closed?
**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
miuireport@miuireport:~/remote-device/StfProject/stf_agent$ adb devices -l
List of devices attached
4a719d85               device usb:1-8.2.1 product:sirius model:sirius device:sirius
6e89d803               device usb:1-8.2.4 product:polaris model:MIX_2S device:polaris
4a48ac23               device usb:1-8.3.3 product:whyred model:Redmi_Note_5 device:whyred
62a0ca8                device usb:1-6.2.1 product:jason model:Mi_Note_3 device:jason
2087b5eb               device usb:1-6.2.2 product:hydrogen model:MI_MAX device:hydrogen
cac9b7a5               device usb:1-8.3.1 product:sagit model:MI_6 device:sagit
391db2                 device usb:1-6.3.3 product:nitrogen model:Nitrogen device:nitrogen
f39179db               device usb:1-8.2.3 product:chiron model:MIX_2 device:chiron
313ca0                 device usb:1-6.2.3 product:nitrogen model:Nitrogen device:nitrogen
a81fc24f               device usb:1-6.2.4 product:wayne model:WAYNE device:wayne
bd53db41               device usb:1-6.3.1 product:polaris model:MIX_2S device:polaris
69074d0                offline usb:1-8.3.4



**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

2018-03-24T07:01:11.750Z FTL/util:lifecycle 23495 [4a48ac23] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.750Z FTL/util:lifecycle 23532 [a81fc24f] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.750Z FTL/util:lifecycle 23489 [62a0ca8] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23520 [f39179db] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23479 [4a719d85] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23489 [62a0ca8] Shutting down due to fatal error
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23520 [f39179db] Shutting down due to fatal error
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23479 [4a719d85] Shutting down due to fatal error
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23495 [4a48ac23] Shutting down due to fatal error
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23532 [a81fc24f] Shutting down due to fatal error
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23513 [bd53db41] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.751Z WRN/device:plugins:touch 23501 [2087b5eb] Shell keeping minitouch running ended unexpectedly
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23513 [bd53db41] Shutting down due to fatal error
2018-03-24T07:01:11.751Z FTL/util:lifecycle 23526 [313ca0] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.752Z FTL/util:lifecycle 23526 [313ca0] Shutting down due to fatal error
2018-03-24T07:01:11.752Z INF/device:plugins:touch 23501 [2087b5eb] Disconnecting from minitouch service
2018-03-24T07:01:11.752Z FTL/util:lifecycle 23519 [cac9b7a5] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.752Z FTL/util:lifecycle 23519 [cac9b7a5] Shutting down due to fatal error
2018-03-24T07:01:11.753Z FTL/util:lifecycle 23501 [2087b5eb] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.753Z FTL/util:lifecycle 23501 [2087b5eb] Shutting down due to fatal error
2018-03-24T07:01:11.753Z FTL/util:lifecycle 23488 [6e89d803] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.754Z FTL/util:lifecycle 23488 [6e89d803] Shutting down due to fatal error
2018-03-24T07:01:11.758Z FTL/util:lifecycle 23538 [391db2] Forward shell ended; we shall share its fate
2018-03-24T07:01:11.759Z FTL/util:lifecycle 23538 [391db2] Shutting down due to fatal error
2018-03-24T07:01:11.762Z FTL/util:lifecycle 23467 [*] Tracker had an error Error: Connection closed
    at /home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_adbkit@2.11.0@adbkit/lib/adb/tracker.js:21:13
    at tryCatcher (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/util.js:26:23)
    at CatchFilter.doFilter (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/catch_filter.js:40:36)
    at CatchFilter.tryCatcher (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/util.js:26:23)
    at Promise._settlePromiseFromHandler (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/promise.js:503:31)
    at Promise._settlePromiseAt (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/promise.js:577:18)
    at Promise._settlePromises (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/promise.js:693:14)
    at Async._drainQueue (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/async.js:123:16)
    at Async._drainQueues (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/async.js:133:10)
    at Immediate.Async.drainQueues (/home/miuireport/remote-device/StfProject/stf_agent/assets/package/node_modules/_bluebird@2.9.34@bluebird/js/main/async.js:15:14)
    at runCallback (timers.js:672:20)
    at tryOnImmediate (timers.js:645:5)
    at processImmediate [as _immediateCallback] (timers.js:617:5)
2018-03-24T07:01:11.762Z FTL/util:lifecycle 23467 [*] Shutting down due to fatal error

**Please run `stf doctor` and paste the output here.**
  Hi!
I've set up stf locally on PC (Ubuntu 16.04) with connected Android device and it works well. `stf doctor` answers all is OK.
Now I'm trying to re-run stf with remote access from another PC (Windows 10)

Ubuntu network is
inet addr: 10.62.10.16
mask: 255.255.255.0
Windows network is
inet addr: 10.62.24.90
mask: 255.255.254.0
I'm starting `stf local --public-ip 10.62.24.90` on Ubuntu PC and going to `http://10.62.10.16:7100` on Windows. But this link redirects me onto `http://10.62.24.90:7100/auth/mock/` with message "This site can’t be reached"

Tell me please, is there ability to use stf from another local subnetwork? Or maybe did I some errors during its set up? Clients can see each other.

> do a full deployment

do you mean this [DEPLOYMENT.md](https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md)? where is `--allow-remote true`? Thanks, I've forgot about it.  As the title say, now I have two STF Server on two machines,Also they connect to the RethinDB Cluster(share data),but some trouble with me ,how I can  let two STF Server share the devices?once I have one stf server, I use stf provider xxxx to connect devices, but now two server how to share the devices?
Thx a lots. @thinkhy  thanks for your reply。I want to make devices on one server，and usable on two STF web UI。Can it Work？Such STF1 and STF2 can show all devices(devices from one server)，users also can use devices from STF1 or STF2. STF1 and STF2 share the devices Pool. apology for my poor English why two stf servers but extend triproxys? you are trying to solve the performance issue, right? @BenZii yes, it's workable for STF to make devices be used across servers. For example, you can deploy your devices on server A, then connect with these devices thru IP and port on server B.  I have an application that uses ZMQ Pub-Sub Model. I have an algorithm in my sub side that if the socket remains idle for 40 seconds it should disconnect and reconnect again. Now, I want to remove this algorithm. Instead i want to use TCP KeepAlive Packets so that my socket does not remain idle  and thus my sub does not disconnect and connect frequently. 
Please find my code below:

zmq_socket_t socket;
socket = zmq_socket(_zmq_context, ZMQ_PUB);

int tcp_keepalive = 1, tcp_keepalive_idle = 25;

 if(zmq_setsockopt(socket, ZMQ_TCP_KEEPALIVE, &tcp_keepalive, sizeof(tcp_keepalive))) {
        INFO(0, "sanjay keepalive error -err %d", tcp_keepalive);
        return NULL;
    }
    else
    {
        INFO(0, "keepalive set -noerr %d", tcp_keepalive);
    }

    if(zmq_setsockopt(socket, ZMQ_TCP_KEEPALIVE_IDLE, &tcp_keepalive_idle, sizeof(tcp_keepalive_idle))) 
    {
        INFO(0, "keepalive idle error -err %d", tcp_keepalive_idle);
        return NULL;
    }
    else
    {
        INFO(0, "idle set -noerr %d", tcp_keepalive_idle);
    }
  if (zmq_bind(socket, urlp)) {
        ERR(0, "zmq_bind(PUB): %s", ERRNO);
        FREE(urlp);
        return NULL;
    }

Please help me on this ??  I am not able to achieve my target. Am i missing anything? No its not related to STF.  after the device is running, about 15 minutes, it will automatically turn off the control, there is no log  Hi, there

We are now deploying STF in production mode(App role and provider role separately). Taking disaster recovery into consideration, we want to double stf services for the APP role. We tried to configure that by ourself by doubling triproxy app (each with two processors connected), triproxy dev(each with  2 processors connected), and modifying the configuration of the reaper, websocket, api and the  provider. Then we found we can not control the smartphone remotely on the webpage. 

I want to know Is it possible to run  same stf services on a single server ? Looking forward for your advices! 

In addition, also provide the statements for starting the above mentioned STF services using docker:

APP Role：

[1] triproxy app 
docker run -d  -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"  --name stf-triproxy-app01   --net host   openstf/stf:latest   stf triproxy app     --bind-pub **"tcp://*:7350"**     --bind-dealer **"tcp://*:7360"**     --bind-pull **"tcp://*:7370"**

docker run -d  -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"  --name stf-triproxy-app   --net host   openstf/stf:latest   stf triproxy app     --bind-pub **"tcp://*:7150**"     --bind-dealer **"tcp://*:7160"**     --bind-pull **"tcp://*:7170"**

[2] triproxy dev 
docker run -d  -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"   --name stf-triproxy-dev01   --net host   openstf/stf:latest   stf triproxy dev     --bind-pub **"tcp://*:7450"**     --bind-dealer **"tcp://*:7460"**     --bind-pull **"tcp://*:7470"**

docker run -d  -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"   --name stf-triproxy-dev   --net host   openstf/stf:latest   stf triproxy dev     --bind-pub **"tcp://*:7250"**     --bind-dealer **"tcp://*:7260"**     --bind-pull **"tcp://*:7270"**

[3] reaper
docker run -d   --name stf-reaper01   --link rethinkdb-proxy-28015:rethinkdb   openstf/stf:latest   stf reaper dev     --connect-push tcp://$(FAKE_IP_STF_APP):7270 tcp://$(FAKE_IP_STF_APP):7470     --connect-sub tcp://$(FAKE_IP_STF_APP):7150 tcp://$(FAKE_IP_STF_APP):7350     --heartbeat-timeout 30000

[4] processor
docker run -d   -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"   --name stf-processor01   --link rethinkdb-proxy-28015:rethinkdb   openstf/stf:latest   stf processor stf-processor     --connect-app-dealer tcp://$(FAKE_IP_STF_APP):7160     --connect-dev-dealer tcp://$(FAKE_IP_STF_APP):7260

docker run -d   -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"   --name stf-processor   --link rethinkdb-proxy-28015:rethinkdb   openstf/stf:latest   stf processor stf-processor     --connect-app-dealer tcp://$(FAKE_IP_STF_APP):7160     --connect-dev-dealer tcp://$(FAKE_IP_STF_APP):7260

docker run -d   -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"   --name stf-processor02   --link rethinkdb-proxy-28015:rethinkdb   openstf/stf:latest   stf processor stf-processor     --connect-app-dealer tcp://$(FAKE_IP_STF_APP):7360     --connect-dev-dealer tcp://$(FAKE_IP_STF_APP):7460

docker run -d   -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"   --name stf-processor03   --link rethinkdb-proxy-28015:rethinkdb   openstf/stf:latest   stf processor stf-processor     --connect-app-dealer tcp://$(FAKE_IP_STF_APP):7360     --connect-dev-dealer tcp://$(FAKE_IP_STF_APP):7460

[5] websocket
docker run -d  -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"   --name stf-websocket01   --link rethinkdb-proxy-28015:rethinkdb   -e "SECRET=YOUR_SESSION_SECRET_HERE"   -p 7110:7110   openstf/stf:latest  stf websocket --port 7110     --storage-url http://$(FAKE_IP_STF_APP):7100/     --connect-sub tcp://$(FAKE_IP_STF_APP):7150 tcp://$(FAKE_IP_STF_APP):7350    --connect-push tcp://$(FAKE_IP_STF_APP):7170 tcp://$(FAKE_IP_STF_APP):7370

[6] api
docker run -d   --name stf-api01   --link rethinkdb-proxy-28015:rethinkdb   -e "SECRET=YOUR_SESSION_SECRET_HERE"   -p 7106:7106   openstf/stf:latest   stf api --port 7106   --connect-sub tcp://$(FAKE_IP_STF_APP):7150 tcp://$(FAKE_IP_STF_APP):7350   --connect-push tcp://$(FAKE_IP_STF_APP):7170 tcp://$(FAKE_IP_STF_APP):7370

Provider Role:

[1] provider 
docker run -d  -e "ZMQ_TCP_KEEPALIVE=1"  -e "ZMQ_TCP_KEEPALIVE_IDLE=300"  --name stfprovider-floor01   --net host   openstf/stf:latest   stf provider     --name stfprovider/floor01     --connect-sub tcp://$(FAKE_IP_STF_APP):7250 tcp://$(FAKE_IP_STF_APP):7450    --connect-push tcp://$(FAKE_IP_STF_APP):7270 tcp://$(FAKE_IP_STF_APP):7470     --storage-url http://$(FAKE_IP_STF_APP):7100/     --public-ip $(FAKE_IP_STF_PROVIDER)     --min-port=15000     --max-port=17000     --heartbeat-interval 10000   --screen-ws-url-pattern "ws://$(FAKE_IP_STF_APP):7100/d/floor01/<%= serial %>/<%= publicPort %>/"

Thanks a lot! 

yours David
 not change anything about nginx. Should I change the configuration of nginx under such condition? yes, you can add more instances in nginx config. I am trying to do the same configuration as this one, which has more than one tri-proxy-dev. I encounter the same problem which cannot control the device remotely. It seems like only half of event messages can go through zmq channel to the device side.  theoretically this configuration should work, couldn't figure out what is the issue.  nginx configuration does't seem to affect anything with this configuration.  @David-gulu have you solved the issue? @zr0827  not yet. We are trying using k8s for redundancy.  I have read Dockerfile,only have two lines use -y option.
someone can tell me why occurs this error?
![image](https://user-images.githubusercontent.com/20439554/37574922-21b0af5a-2b5f-11e8-9169-de4fd9ab802e.png)
 HI @thinkhy,thanks for your reply.
I have try to remove unmet,but not make effect. Hi sorccu,here is the Dockerfile link i used.
https://github.com/openstf/stf/blob/master/Dockerfile Because china network can't access some source url,so I change to china source url.
===============================================================




FROM ubuntu:16.04

# Sneak the stf executable into $PATH.
ENV PATH /app/bin:$PATH

# Work in app dir by default.
WORKDIR /app

# Export default app port, not enough for all processes but it should do
# for now.
EXPOSE 3000

# Install app requirements. Trying to optimize push speed for dependant apps
# by reducing layers as much as possible. Note that one of the final steps
# installs development files for node-gyp so that npm install won't have to
# wait for them on the first native module installation.

RUN	export DEBIAN_FRONTEND=noninteractive 
RUN    useradd --system \
      --create-home \
      --shell /usr/sbin/nologin 
RUN      stf-build \
RUN      stf-build \
    useradd --system \
      --create-home \
      --shell /usr/sbin/nologin 
RUN   stf 
RUN    sed -i'' 's@http://mirrors.aliyun.com/ubuntu/@mirror://mirrors.ubuntu.com/mirrors.txt@' /etc/apt/sources.list 
RUN    apt-get update 
RUN    apt-get install wget python build-essential apt-utils -y 
RUN    wget --progress=dot:mega \
      https://npm.taobao.org/mirrors/node/v8.9.3/node-v8.9.3-linux-x64.tar.xz 
RUN    tar -xJf node-v*.tar.xz --strip-components 1 -C /usr/local 
RUN    rm node-v*.tar.xz 
RUN    su stf-build -s /bin/bash -c '/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js install' 
RUN    apt-get install libzmq3-dev libprotobuf-dev git graphicsmagick yasm -y
RUN    apt-get clean 
RUN    rm -rf /var/cache/apt/* /var/lib/apt/lists/*


# Copy app source.
COPY . /tmp/build/

# Give permissions to our build user.
RUN mkdir -p /app && \
    chown -R stf-build:stf-build /tmp/build /app

# Switch over to the build user.
USER stf-build

# Run the build.
RUN set -x && \
    cd /tmp/build && \
    export PATH=$PWD/node_modules/.bin:$PATH && \
    npm install --loglevel http && \
    npm pack && \
    tar xzf stf-*.tgz --strip-components 1 -C /app && \
    bower cache clean && \
    npm prune --production && \
    mv node_modules /app && \
    npm cache clean && \
    rm -rf ~/.node-gyp && \
    cd /app && \
    rm -rf /tmp/*

# Switch to the app user.
USER stf

# Show help by default.
CMD stf --help Many thanks!
can you also post your Dockerfile here.  Hi! I am able to run stf locally but when I am trying to access from another machine, device screen is all greyed out. I'm using the mac's ip on which stf is set up locally. please suggest how to access STF from another machine. I read some other related issues and its mentioned to do proper deployment to access. Is there any other way or have to follow deployment guide only?
Thanks!
<img width="1109" alt="screen shot 2018-03-14 at 5 17 52 pm" src="https://user-images.githubusercontent.com/10398051/37439894-27caf5f8-2835-11e8-8373-c55c4af04896.png"> Thanks so much..I resolved it using sudo stf local --public-ip x.x.x.x --poorxy-port 80  but still I believe doing proper deployment will help me to expose all features  I have set up STF locally and attached Samsung S7. when I try to upload apk's it doesn't throw any error but still apk doesn't upload and it keeps showing 100%.

![screen shot 2018-03-14 at 11 35 25 am](https://user-images.githubusercontent.com/10398051/37382109-e08448ca-277b-11e8-923d-b9dfc9ae3d24.png)

stf doctor output 
2018-03-14T03:37:40.473Z INF/cli:doctor 61435 [*] OS Arch: x64
2018-03-14T03:37:40.477Z INF/cli:doctor 61435 [*] OS Platform: darwin
2018-03-14T03:37:40.477Z INF/cli:doctor 61435 [*] OS Platform: 16.7.0
2018-03-14T03:37:40.477Z INF/cli:doctor 61435 [*] Using Node 8.10.0
2018-03-14T03:37:40.510Z INF/cli:doctor 61435 [*] Using ZeroMQ 4.2.3
2018-03-14T03:37:40.546Z INF/cli:doctor 61435 [*] Using GraphicsMagick 1.3.28
2018-03-14T03:37:40.559Z INF/cli:doctor 61435 [*] Using ADB 1.0.39
2018-03-14T03:37:40.560Z ERR/cli:doctor 61435 [*] ProtoBuf version cannot be detected
2018-03-14T03:37:40.602Z INF/cli:doctor 61435 [*] Using RethinkDB 2.3.6
 Please find following logs
<img width="1440" alt="screen shot 2018-03-14 at 11 44 58 am" src="https://user-images.githubusercontent.com/10398051/37382324-376abf42-277d-11e8-99e0-71c9ec96886c.png">
 Many thanks for your reply and quick fix.. I will test n let u know. Thanks it works for me now.. :) m closing this issue  Hi, there.

We deployed Openstf in production mode(APP role, database role, proxy role on one server and provider role on another server). When tried to install an app of small size(20MB), everything worked out fine. Yet when tried installing apks of relatively bigger sizes(100MB above), the progress bar was stuck there whereas the apk activity was launched successfully in the webpage (the following figure).

![1](https://user-images.githubusercontent.com/37066792/37328154-0c62972e-26d4-11e8-8725-e5e3781871c9.jpg)


Worse still, sometimes the following situation came up as well(the following figure). After stucking for  a period of time, the apk activity was launched successfully in the webpage. In addition at the same time  a hint came up to inform the socket connection was lost. 


![2](https://user-images.githubusercontent.com/37066792/37328163-1754d868-26d4-11e8-9b4c-32c5f5e6a264.jpg)





This was not a problem on a specific device. There was no problem when checking logs of the provider, triproxy, processor and the stf doctor. In case the logs are useful, the stf doctor logs of the provider are given as follow:

2018-03-13T07:11:53.582Z INF/cli:doctor 133 [*] OS Arch: x64
2018-03-13T07:11:53.583Z INF/cli:doctor 133 [*] OS Platform: linux
2018-03-13T07:11:53.584Z INF/cli:doctor 133 [*] OS Platform: 3.10.0-514.el7.x86_64
2018-03-13T07:11:53.584Z INF/cli:doctor 133 [*] Using Node 6.11.2
2018-03-13T07:11:53.618Z INF/cli:doctor 133 [*] Using ZeroMQ 4.1.4
2018-03-13T07:11:53.632Z ERR/cli:doctor 133 [*] RethinkDB is not installed (`rethinkdb` is missing)
2018-03-13T07:11:53.632Z ERR/cli:doctor 133 [*] ProtoBuf is not installed (`protoc` is missing)
2018-03-13T07:11:53.632Z ERR/cli:doctor 133 [*] ADB is not installed (`adb` is missing)
2018-03-13T07:11:54.002Z INF/cli:doctor 133 [*] Using GraphicsMagick 1.3.23

I want to know under what situation will trigger the prompting of  "socket connection was lost" and are there any advices to help solve this problem?

Thanks a lot. 

yours,
David


 Thanks for your reply @sorccu. Our client is a Windows machine, and  the stf running on 7100. Through our research, the behavior of "socket connection was lost" seems to be clear. When it comes to separation mode, the performance of the client as well as the browser itself truly becomes the bottleneck. When pushing large apks, Firefox 55 and above will stuck for a while. When stuck happens, the browser itself will not response any operation. If the performance of the client is relatively poor, then the stuck period is longer than it should be, which may be regarded as connection lost at the STF server side. Testing shows that Chrome 34 is a good choice.

The progress bar still was  stuck there when using Chrome 34, yet socket connection lost never happened again,  and the  apk activity was launched successfully. We will try to figure out why progress bar was stuck and reply.
 Thanks for your reply @sorccu. We will try your advices. We  noticed poorxy when investigating stf local mode. Currently we are not using stf local. we are now using multiple docker containers  to run each stf service individually and using nginx for url mappings. We just use the same port 7100 with nothing more than that.  Team,

Is there any possibility to add object spy feature with STF, because it will be really useful for the team to launch the device and click on object spy to view the android elements for the automation purposes.

We can use Macaca's app inspector to do that, or we can also use Appium's UIautomator feature to do that.

Here is the link to Macaca's object spy.
https://github.com/macacajs/app-inspector

  @terminalone I'll try my best. Recently I have been busy on other urgent project ... @thinkhy please also share the scripts with me, thanks  Expecting the great project to support Android P... 
When can support Android P?  Has anyone successfully installed OpenSTF on a Raspberry Pi? And more specifically on Cent OS 7? I am not very Linux savy, but have done a few minor installs in the past and am trying to put OpenSTF on a Pi. Does anyone have instructions for how to go about doing that?
Thanks! @thinkhy : Yep, you can https://www.raspberrypi.org/blog/docker-comes-to-raspberry-pi/
However, the question is why not using the "local deployment" way only? Install node, "npm -g" install stf and run it? I managed to get OpenSTF running on the Pi. Utilizing Pacman to get the dependencies and then NPM to install stf. I had to make some changes to the npm default folder because I was getting a lot of permissions errors. Now I am having trouble getting the phones to actually connect. What is required to be on the phones besides USB debugging enabled? If I can get it working I'll rebuild it with instructions.
Do I need to so something with the keys to enable the phones to connect? Thanks,


![image](https://user-images.githubusercontent.com/37095625/37260595-9a7db346-256b-11e8-9d7b-b6fcdcddcb17.png)

![image](https://user-images.githubusercontent.com/37095625/37260617-af61cb9e-256b-11e8-8a35-82f190a407a0.png)
 Also I am wondering how people are running the RethinkDB and STF on the same machine, everytime I run RethinkDB I am unable to then run the STF Local command. My current work (due to being in a minimal OS) is to run RethinkDB on the actual Raspberry Pi terminal, then I SSH into the Raspberry Pi from another computer and run stf local --public-ip 192.168.60.23 --allow-remote
Thanks again, Installing Arch Linux on a Raspberry Pi:
https://archlinuxarm.org/platforms/armv7/broadcom/raspberry-pi-2#qt-platform_tabs-ui-tabs2


# System Upgrade
pacman -Syu
# STF deps:
pacman -S android-tools nodejs npm graphicsmagick zeromq pkg-config 
# RethinkDB build dependencies
pacman -S base-devel # Select ALL
pacman -S libsodium libpgm protobuf protobuf-c libboost boost boost-libs python2 gperftools python2-pip
#### libboost was not found... so I installed "boost-libs"###
# Download rethinkDB sources
##################################################
I may have had to install curl with pacman but don't remember
#################################################

curl -O http://download.rethinkdb.com/dist/rethinkdb-2.0.4.tgz
tar zxvf rethinkdb-2.0.4.tgz
 # Change default python version 
ln -sf /usr/bin/python2.7 /usr/bin/python
# Configure and build! (it may take hours on Pi)
cd rethinkdb-2.0.4
./configure --with-system-malloc --allow-fetch
make

make install
# finally install stf

#################################################
Permissions issues found here:
https://docs.npmjs.com/getting-started/fixing-npm-permissions
#################################################

 mkdir ~/.npm-global
npm config set prefix '~/.npm-global'
 export PATH=~/.npm-global/bin:$PATH
 source ~/.profile ####THIS FAILED FOR ME#####
 npm install -g jshint
    NPM_CONFIG_PREFIX=~/.npm-global


pacman -S android-udev

npm install -g stf

To then run STF I had to run:

RethinkDB

Then I SSH'd into the pi from a different machine and issued this:

stf local --public-ip 192.168.60.23 --allow-remote

Then I was able to access it remotely at:
http://x.x.x.x:7100/

This is more or less what I did. Also had to allow it through the firewall because it was being blocked. You mean by running rethinkdb and stf on the same machine that once you start rethinkdb it blocks your terminal and you cannot execute any more commands on that terminal unless you kill rethinkdb?
That would also imply that if you log out of the Pi or lose the network connection, STF gets terminated?
If so, have a look at "screen": https://www.howtoforge.com/linux_screen. It lets commands continue to run and be sent to the background so you can keep on working on the same terminal and/or log off Made it with docker and docker-compose on a Raspberry 3B with latest Raspbian.
```
pi@openstf-provider:~ $ uname -a
Linux openstf-provider 4.9.80-v7+ #1098 SMP Fri Mar 9 19:11:42 GMT 2018 armv7l GNU/Linux
```
```
pi@openstf-provider:~ $ docker-compose version
docker-compose version 1.13.0dev, build ae2cc6b
docker-py version: 2.2.1
CPython version: 2.7.13
OpenSSL version: OpenSSL 1.0.1t  3 May 2016
```
```
pi@openstf-provider:~ $ docker version
Client:
 Version:       18.03.0-ce
 API version:   1.37
 Go version:    go1.9.4
 Git commit:    0520e24
 Built: Wed Mar 21 23:18:35 2018
 OS/Arch:       linux/arm
 Experimental:  false
 Orchestrator:  swarm

Server:
 Engine:
  Version:      18.03.0-ce
  API version:  1.37 (minimum version 1.12)
  Go version:   go1.9.4
  Git commit:   0520e24
  Built:        Wed Mar 21 23:14:37 2018
  OS/Arch:      linux/arm
  Experimental: false

```
For the time being, it works flawlessly (except the limitations due to the device).
![screenshot-2018-3-23 stf](https://user-images.githubusercontent.com/116569/37855560-22105074-2ef0-11e8-87b1-866917572c44.png)
 @gounthar can you provide the steps you made to install it, please?  Good day!

**In the process of using STF, I found a Bug  which is necessary.**
**After it is finished using the device, minitouch and screenshots can still work, which is not common sense**

Reproduce the steps:
1. When the device is out of time or click to stop using on the list page, the operation page will pop up a box indicating that the device has finished using ,like this:
![capture_201836_103046](https://user-images.githubusercontent.com/23167666/37011229-2a5179c6-212a-11e8-9ee9-6f27f0f253cd.jpg)

2. Click on the external area of the box, the box will disappear immediately, the page still remain in the operation page.
![capture_201836_103222](https://user-images.githubusercontent.com/23167666/37011281-63b760fe-212a-11e8-916b-b4b894c7ad85.jpg)
![capture_201836_103304](https://user-images.githubusercontent.com/23167666/37011290-6934d6c4-212a-11e8-9f9d-d8e1ff0a2fec.jpg)

3. Now operating the device display area (although there is no image display), the actual device is still responding to the minitouch operation, in addition, the screenshot button can still correctly capture screenshots.
![capture_201836_103443](https://user-images.githubusercontent.com/23167666/37011414-fe6e6b6a-212a-11e8-8e38-ff99d115b974.jpg)

4.  I think this is not normal. Thank you for help! @sorccu Thx, @thinkhy says he will recently submit a PR to fix the issue.

  Hi, there

I have read through the deployment document and deployed OpenSTF in production mode, with (app & database role) and the provider role deployed on two separated servers. One server ran the app.service, app-auth.service and other necessary services according to the deployment document  ,
and the other server only ran the provider service and adbd service. The deployment was base on docker.

At  the beginning, the overall system worked properly, yet , if we just left the connected phones there with no one using them after a specific period of time (seems to be 40 mins) , then a problem occured.  When we clicked the "use" button,  the screen monitoring part on the webpage turned out to be gray and we were not able to do anything to such phones, including checking status infos of them.  We tried to replug these devices, and found that they were offline on the webpage whereas connected when checking using "adb devices" (status device). 

To best of our knowledge, we have tried everything we can  and find out that the problem will not disappear unless we restart the provider container.  

This problem is not happen on a specific device. We've also checked the logs of the provider container and found no difference between  the problem occured and not.

the stf doctor output at the provider is 

2018-03-05T09:51:50.533Z INF/cli:doctor 155 [*] OS Arch: x64
2018-03-05T09:51:50.534Z INF/cli:doctor 155 [*] OS Platform: linux
2018-03-05T09:51:50.535Z INF/cli:doctor 155 [*] OS Platform: 3.10.0-514.el7.x86_64
2018-03-05T09:51:50.535Z INF/cli:doctor 155 [*] Using Node 6.11.2
2018-03-05T09:51:50.570Z INF/cli:doctor 155 [*] Using ZeroMQ 4.1.4
2018-03-05T09:51:50.585Z ERR/cli:doctor 155 [*] RethinkDB is not installed (`rethinkdb` is missing)
2018-03-05T09:51:50.585Z ERR/cli:doctor 155 [*] ProtoBuf is not installed (`protoc` is missing)
2018-03-05T09:51:50.585Z ERR/cli:doctor 155 [*] ADB is not installed (`adb` is missing)
2018-03-05T09:51:50.956Z INF/cli:doctor 155 [*] Using GraphicsMagick 1.3.23

When the problem occured,  the statues of the adb container was up, together with the provider container. Can you please do us a favor to  help solve the problem?

yours, 

David
 Thanks for your advice. We will check and feedback. We checked #100, #104, #342, and #528 and finally solved the problem according to #342， by adding 

-e "ZMQ_TCP_KEEPALIVE=1" 
-e "ZMQ_TCP_KEEPALIVE_IDLE=300" 
to the below unit-files
stf-triproxy-app
stf-triproxy-dev
stf-websocket
stf-provider@
stf-processor@

the smartphones were kept idle for about 2 hours and still connectable.   A little advice here is to update the DEPLOYMENT.md and thus can help more people to avoid encountering such problem. Thank you very much. closing.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**

Hi, 

How can i know how many providers running through any tools? And is there any administrator pages that we can see some system information?

Thanks very much. thanks thanks @thinkhy

I will look into it. Please send PR.  I have two PC use the same codes, one is OK, but another when I use the Screen Capture feature it show this log.
Screen capture failed Error: Upload to "http://localhost:7100/s/upload/image" failed: HTTP 404
    at Request._callback (/Users/my/avatar/lib/units/device/support/storage.js:29:27)
    at Request.self.callback (/Users/my/avatar/node_modules/request/request.js:186:22)
    at Request.emit (events.js:159:13)
    at Request.<anonymous> (/Users/my/avatar/node_modules/request/request.js:1163:10)
    at Request.emit (events.js:159:13)
    at IncomingMessage.<anonymous> (/Users/my/avatar/node_modules/request/request.js:1085:12)
    at Object.onceWrapper (events.js:254:19)
    at IncomingMessage.emit (events.js:164:20)
    at endReadableNT (_stream_readable.js:1062:12)
    at process._tickCallback (internal/process/next_tick.js:152:19)
Does anybody know the reason? i am also facing same error  hello, I'm working on a project that based on the github project,so l'm learning the stf code recently.Thank you for sharing.It’s amazing that it displays the phone screen fluently .  I haven‘t used nodejs before that，so  I have a question that why you choose nodejs to implement it? What’s the nodejs‘s advantage？
 thanks for answer.  Hi stf devs!

I'm trying to use the STF in a manner where I control the device and the dev I'm working with is connecting with the device via adb connect to see the logs locally.

Is that possible scenario? When we try that, dev is able to connect, but doesn't see the device in the list. WE can do that via myself going physically to the device but that takes a while each time a change is pushed.

Unfortunately remote control by the dev is not possible because of huge delays (USA -> Europe). In our env sometimes that dialog does not appear on the web UI. But navigating to settings and adding the key manually helps. It also happens that users mistype their email-address and as such do not have the ADB keys in the same account  Hi!
**in stf the touch point not match the real device screen.  Please look at the picture，however there is a law**

**no errors or warnings in the `stf local` output**

**`stf doctor` no problem **

what should be modified?

![2](https://user-images.githubusercontent.com/7235547/36582000-8812627e-18aa-11e8-9628-abb386dea39f.JPG)
 @sorccu Thank you very much!  Hi there, 
Actually this is not a issue for the project, it's about the webpage of openstf.
I noticed in https://openstf.io/, 'feature' section, you guys used a phone picture.
But why the picture looks so much like a IPhone ?
Could you please replace it with a real android device picture?

![image](https://user-images.githubusercontent.com/939583/36521901-6888a3cc-17d4-11e8-96cb-0fca575e6024.png)

 Cool, thanks!  I try to run stf on localhost and it worked till now, for some reason when I hit stf local and go to the localhost:7100 it redirect me to the http://localhost:7100/auth/mock/ which require some username/pwd.
When I check devices list (adb devices) I see my devices connected. What is the issue here?What creds I am supposed to use?  android P  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
It would be nice if we can add a reverse proxy so that we can connect to devices using {serial}.something.tld e.g adb connect deviceserial93.stf.farm.com this way adb connect will be on the default port 
**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  Did you try the teamview remote control, how it can share screen view without shell? Could you show me the API detail information?  @sorccu on Android 8.0  it's not going to find a process with 'ps' when  the process isn't running OR the process is not attached to current terminal's PTY. So we can't give up running the extra command 'ps -lef' just because ps works and there were no matches in the output. Consider the following case(Android version >= 8.0, Manufactor: Google, Huawei, XiaoMi, Oppo).:

```shell
ps
USER           PID  PPID     VSZ    RSS WCHAN            ADDR S NAME                       
shell        15491  1137   10204   2056 0          7f8007a898 R ps
ps -elf
UID            PID  PPID C STIME TTY          TIME CMD
root             1     0 0 03:08:24 ?     00:00:21 init
root             2     0 0 03:08:24 ?     00:00:00 [kthreadd]
root             3     2 0 03:08:24 ?     00:03:52 [ksoftirqd/0]
root             7     2 0 03:08:24 ?     00:00:26 [rcu_preempt]
root             8     2 0 03:08:24 ?     00:00:00 [rcu_sched]
root             9     2 0 03:08:24 ?     00:00:00 [rcu_bh]
root            10     2 0 03:08:24 ?     00:00:38 [rcuop/0]
root            11     2 0 03:08:24 ?     00:00:00 [rcuos/0]
root            12     2 0 03:08:24 ?     00:00:00 [rcuob/0]
... ...
```

In above case, both 'ps' and 'ps -lef' can run well, but we cant only find STF related processes thru 'ps -lef'.

I will add '2>/dev/null' in next commit. Thanks for your reviewing.
 OK, gotcha. Current code has already support scenario 1 and scenario 2:
    
   1. Found matching process(es) → End here
   2. Got an empty list, found no processes of any kind whatsoever → Try again with ps -lef

For scenario 3, suggest to divide it into two cases:    

   * 3. Got a non-empty list, but did not find any matching process 
       * 3.1 list contains any process launched by root user which suggests 'ps' can output the whole process list  → End here 
       * 3.2 list just contains processes launched by non-root user which suggests 'ps' might only output processes in current terminal  → Try again with ps -lef 
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  Hi guys,
When I run stf in docker env and try to connect android device in USB mode, I get the error below. Could anyone support this? Thanks a lot.

Device info:
MODEL: TPS650
VERSION: 5.1.1 (SDK 22)

error message in output
2018-02-02T07:41:30.564Z FTL/device 12139 [17088013200005] Setup had an error TypeError: Cannot read property 'length' of undefined
    at devutil.makeIdentity (/app/lib/util/devutil.js:113:28)
    at solve (/app/lib/units/device/plugins/util/identity.js:15:30)
    at /app/lib/units/device/plugins/util/identity.js:21:12
    at SerialSyrup.ParallelSyrup.invoke (/app/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /app/node_modules/stf-syrup/lib/serial.js:43:33
    at tryCatch1 (/app/node_modules/stf-syrup/node_modules/bluebird/js/main/util.js:63:19)
    at Promise$_callHandler [as _callHandler] (/app/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:708:13)
    at Promise$_settlePromiseFromHandler [as _settlePromiseFromHandler] (/app/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:724:18)
    at Promise$_settlePromiseAt [as _settlePromiseAt] (/app/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:896:14)
    at Promise$_fulfillPromises [as _fulfillPromises] (/app/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:1041:14)
    at Async$_consumeFunctionBuffer [as _consumeFunctionBuffer] (/app/node_modules/stf-syrup/node_modules/bluebird/js/main/async.js:74:12)
    at Async$consumeFunctionBuffer (/app/node_modules/stf-syrup/node_modules/bluebird/js/main/async.js:37:14)
    at _combinedTickCallback (internal/process/next_tick.js:73:7)
    at process._tickCallback (internal/process/next_tick.js:104:9) Thanks @sorccu
[UserVolumeLabel]: [RockChips]
[camera2.portability.force_api]: [1]
[dalvik.vm.dex2oat-Xms]: [64m]
[dalvik.vm.dex2oat-Xmx]: [512m]
[dalvik.vm.dexopt-flags]: [m=y]
[dalvik.vm.heapgrowthlimit]: [192m]
[dalvik.vm.heapmaxfree]: [8m]
[dalvik.vm.heapminfree]: [512k]
[dalvik.vm.heapsize]: [512m]
[dalvik.vm.heapstartsize]: [16m]
[dalvik.vm.heaptargetutilization]: [0.75]
[dalvik.vm.image-dex2oat-Xms]: [64m]
[dalvik.vm.image-dex2oat-Xmx]: [64m]
[dalvik.vm.isa.arm.features]: [div]
[dalvik.vm.jniopts]: [warnonly]
[dalvik.vm.lockprof.threshold]: [500]
[dalvik.vm.stack-trace-file]: [/data/anr/traces.txt]
[debug.force_rtl]: [0]
[debug.nfc.fw_download]: [false]
[debug.nfc.se]: [false]
[dev.bootcomplete]: [1]
[dhcp.eth0.pid]: [566]
[dhcp.eth0.reason]: [PREINIT]
[dhcp.eth0.result]: []
[dhcp.wlan0.dns1]: [192.168.137.1]
[dhcp.wlan0.dns2]: []
[dhcp.wlan0.dns3]: []
[dhcp.wlan0.dns4]: []
[dhcp.wlan0.domain]: [mshome.net]
[dhcp.wlan0.gateway]: [192.168.137.1]
[dhcp.wlan0.ipaddress]: [192.168.137.91]
[dhcp.wlan0.leasetime]: [604800]
[dhcp.wlan0.mask]: [255.255.255.0]
[dhcp.wlan0.mtu]: []
[dhcp.wlan0.pid]: [7759]
[dhcp.wlan0.reason]: [RENEW]
[dhcp.wlan0.result]: [ok]
[dhcp.wlan0.server]: [192.168.137.1]
[dhcp.wlan0.vendorInfo]: []
[drm.service.enabled]: [false]
[gsm.current.phone-type]: [1]
[gsm.network.type]: [Unknown]
[gsm.operator.alpha]: []
[gsm.operator.iso-country]: []
[gsm.operator.isroaming]: [false]
[gsm.operator.numeric]: []
[gsm.sim.operator.alpha]: []
[gsm.sim.operator.iso-country]: []
[gsm.sim.operator.numeric]: []
[gsm.sim.state]: [NOT_READY]
[gsm.version.ril-impl]: [SIMCOM_RIL51_20170412]
[init.svc.adbd]: [running]
[init.svc.bootanim]: [stopped]
[init.svc.console]: [running]
[init.svc.daemonsu]: [running]
[init.svc.debuggerd]: [running]
[init.svc.dhcpcd_eth0]: [stopped]
[init.svc.dhcpcd_wlan0]: [running]
[init.svc.displayd]: [running]
[init.svc.drm]: [running]
[init.svc.drmservice]: [stopped]
[init.svc.flash_recovery]: [stopped]
[init.svc.healthd]: [running]
[init.svc.installd]: [running]
[init.svc.keystore]: [running]
[init.svc.lmkd]: [running]
[init.svc.logd]: [running]
[init.svc.media]: [running]
[init.svc.netd]: [running]
[init.svc.ril-daemon]: [running]
[init.svc.rtw_suppl_con]: [running]
[init.svc.sdcard]: [stopping]
[init.svc.servicemanager]: [running]
[init.svc.surfaceflinger]: [running]
[init.svc.telpo-st-setup]: [stopped]
[init.svc.tplcdinit]: [stopped]
[init.svc.ueventd]: [running]
[init.svc.vold]: [running]
[init.svc.zygote]: [running]
[keyguard.no_require_sim]: [true]
[media.sink.audio]: []
[net.bt.name]: [Android]
[net.change]: [net.dns1]
[net.dns1]: [192.168.137.1]
[net.hostname]: [android-7b6487cb19eecc2c]
[net.qtaguid_enabled]: [1]
[net.tcp.default_init_rwnd]: [60]
[persist.logd.size]: []
[persist.service.bdroid.bdaddr]: [22:22:1d:d6:44:39]
[persist.sys.country]: [CN]
[persist.sys.dalvik.vm.lib.2]: [libart.so]
[persist.sys.first_booting]: [false]
[persist.sys.language]: [zh]
[persist.sys.overscan.aux]: [overscan 100,100,100,100]
[persist.sys.overscan.main]: [overscan 100,100,100,100]
[persist.sys.preinstalled]: [1]
[persist.sys.profiler_ms]: [0]
[persist.sys.strictmode.visual]: [false]
[persist.sys.timezone]: [Asia/Shanghai]
[persist.sys.usb.config]: [mass_storage,adb]
[persist.tegra.nvmmlite]: [1]
[ril.function.dataonly]: [1]
[rild.simcom.gps]: [1]
[rild.simcom.stk]: [0]
[rild.simcom.ussd]: [0]
[ro.adb.secure]: [0]
[ro.allow.mock.location]: [0]
[ro.audio.monitorOrientation]: [true]
[ro.baseband]: [unknown]
[ro.board.platform]: [rk3288]
[ro.boot.console]: [ttyS2]
[ro.boot.hardware]: [rk30board]
[ro.boot.mode]: [emmc]
[ro.boot.selinux]: [permissive]
[ro.boot.serialno]: [17088013200005]
[ro.bootloader]: [unknown]
[ro.bootmode]: [emmc]
[ro.bt.bdaddr_path]: [/data/misc/bluetoothd/bt_addr]
[ro.build.characteristics]: [tablet]
[ro.build.date.utc]: [1502859194]
[ro.build.date]: [Wed Aug 16 12:53:14 HKT 2017]
[ro.build.description]: [rk3288-userdebug 5.1.1 LMY49F eng.luorf.20170816.125105 test-keys]
[ro.build.display.id]: [TPS650_ALL_V1.0.1_20170816]
[ro.build.fingerprint]: [Android/rk3288/rk3288:5.1.1/LMY49F/luorf08161252:userdebug/test-keys]
[ro.build.flavor]: [rk3288-userdebug]
[ro.build.host]: [ubuntu]
[ro.build.id]: [LMY49F]
[ro.build.product]: [rk3288]
[ro.build.tags]: [test-keys]
[ro.build.type]: [userdebug]
[ro.build.user]: [luorf]
[ro.build.version.all_codenames]: [REL]
[ro.build.version.base_os]: []
[ro.build.version.codename]: [REL]
[ro.build.version.incremental]: [eng.luorf.20170816.125105]
[ro.build.version.release]: [5.1.1]
[ro.build.version.sdk]: [22]
[ro.build.version.security_patch]: [2016-03-01]
[ro.carrier]: [unknown]
[ro.com.android.dataroaming]: [true]
[ro.com.android.dateformat]: [MM-dd-yyyy]
[ro.config.alarm_alert]: [Alarm_Classic.ogg]
[ro.config.enable.remotecontrol]: [false]
[ro.config.notification_sound]: [pixiedust.ogg]
[ro.config.ringtone]: [Ring_Synth_04.ogg]
[ro.crypto.state]: [unencrypted]
[ro.dalvik.vm.native.bridge]: [0]
[ro.debuggable]: [1]
[ro.default.size]: [100]
[ro.enable_boot_charger_mode]: [0]
[ro.factory.hasGPS]: [false]
[ro.factory.hasUMS]: [true]
[ro.factory.storage_suppntfs]: [true]
[ro.factory.tool]: [0]
[ro.factory.without_battery]: [false]
[ro.factorytest]: [0]
[ro.hardware]: [rk30board]
[ro.htg.force]: [1]
[ro.internal.model]: [TPS650]
[ro.kernel.android.checkjni]: [0]
[ro.nfc.port]: [I2C]
[ro.opengles.version]: [196609]
[ro.product.board]: [rk30sdk]
[ro.product.cpu.abi2]: [armeabi]
[ro.product.cpu.abi]: [armeabi-v7a]
[ro.product.cpu.abilist32]: [armeabi-v7a,armeabi]
[ro.product.cpu.abilist64]: []
[ro.product.cpu.abilist]: [armeabi-v7a,armeabi]
[ro.product.device]: [TPS650]
[ro.product.locale.language]: [zh]
[ro.product.locale.region]: [CN]
[ro.product.manufacturer]: [rockchip]
[ro.product.model]: [TPS650]
[ro.product.name]: [TPS650]
[ro.product.ota.host]: [www.rockchip.com:2300]
[ro.product.usbfactory]: [rockchip_usb]
[ro.product.version]: [1.0.1]
[ro.radio.platform]: [ALL]
[ro.revision]: [0]
[ro.ril.ecclist]: [112,911]
[ro.rk.LowBatteryBrightness]: [false]
[ro.rk.MassStorage]: [false]
[ro.rk.bt_enable]: [true]
[ro.rk.cpu]: [rk3288v2]
[ro.rk.cpu_min_freq]: [126000
]
[ro.rk.def_brightness]: [200]
[ro.rk.homepage_base]: [http://www.google.com/webhp?client={CID}&amp;source=android-home]
[ro.rk.install_non_market_apps]: [false]
[ro.rk.screenoff_time]: [-1]
[ro.rk.screenshot_enable]: [true]
[ro.rk.soc]: [rk3288]
[ro.rk.systembar.tabletUI]: [false]
[ro.rk.systembar.voiceicon]: [true]
[ro.rksdk.version]: [RK30_ANDROID5.1.1-SDK-v1.00.00]
[ro.runtime.firstboot]: [1517551015475]
[ro.secure]: [0]
[ro.serialno]: [17088013200005]
[ro.sf.fakerotation]: [false]
[ro.sf.hwrotation]: [0]
[ro.sf.lcd_density]: [160]
[ro.simcomril.version]: [simcom_ril5x_20170412]
[ro.target.product]: [tablet]
[ro.tether.denied]: [false]
[ro.wifi.channels]: []
[ro.zygote]: [zygote32]
[selinux.reload_policy]: [1]
[service.adb.tcp.port]: [5555]
[service.bootanim.exit]: [1]
[sf.power.control]: [2073600]
[sys.ID.mID]: [4]
[sys.boot_completed]: [1]
[sys.display.oritation]: [0]
[sys.ggralloc.version]: [1.0.2]
[sys.ggsurflgr.version]: [1.000]
[sys.ghwc.version]: [2.067-3288MID]
[sys.gmali.version]: [r6p0-02rel0-13-11@0]
[sys.grga.version]: [2.000]
[sys.hwc.compose_policy]: [0]
[sys.hwc.htg]: [true]
[sys.pms.finishscan]: [true]
[sys.resolution.changed]: [false]
[sys.rkadb.root]: [0]
[sys.settings_system_version]: [302]
[sys.sysctl.extra_free_kbytes]: [12294]
[sys.sysctl.tcp_def_init_rwnd]: [60]
[sys.underUmsMode.enable]: [false]
[sys.usb.config]: [mass_storage,adb]
[sys.usb.state]: [mass_storage,adb]
[sys.usb.umsavailible]: [true]
[sys.wallpaper.rgb565]: [0]
[sys_graphic.cam_camboard.ver]: [0.13.0]
[sys_graphic.cam_hal.ver]: [1.54.13]
[sys_graphic.cam_isi.ver]: [0.10.0]
[sys_graphic.cam_libisp.ver]: [1.39.0]
[sys_graphic.cam_trace]: [0]
[testing.mediascanner.skiplist]: [/mnt/internal_sd/Android/]
[vold.post_fs_data_done]: [1]
[wifi.interface]: [wlan0]
[wifi.supplicant_scan_interval]: [15]
[wlan.driver.status]: [ok]
 Ok, I see. Thanks for the info. Thanks @thinkhy  @sorccu 
I will try for your suggestion. Please let me know if you have new patch for the issue. That would be great @sorccu . Would you update openstf/stf docker image too? I build stf environment in that way.      Hi, can you help me with problem, when i connect to device and nothing do with it, i see a lot of generated screenshots. And it will be stop, when i'll disconnect.

[video](https://yadi.sk/i/jtywALOu3RfeLd)

stf doctor 
`INF/cli:doctor 9674 [*] OS Arch: x64
INF/cli:doctor 9674 [*] OS Platform: linux
INF/cli:doctor 9674 [*] OS Platform: 4.4.0-87-generic
INF/cli:doctor 9674 [*] Using Node 6.11.5
INF/cli:doctor 9674 [*] Using ZeroMQ 4.1.4
INF/cli:doctor 9674 [*] Using RethinkDB 2.3.6~0xenial
INF/cli:doctor 9674 [*] Using GraphicsMagick 1.3.26
INF/cli:doctor 9674 [*] Using ADB 1.0.39
INF/cli:doctor 9674 [*] Using ProtoBuf 3.4.0`

stf - V: 3.1.0

List devices:
`c1607561a248e5f        device usb:2-1.1 product:espresso10rfxx model:GT_P5100 device:espresso10rf
4df112a063ffaf9d       device usb:2-1.2
02bccebd               device usb:2-6.1 product:serranodsxx model:GT_I9192 device:serranods
0019d33d026f3f         device usb:2-1.3` ok, thanks!  I tried to run my appium script with stf but i could not connect device via this script.
Below is error:
(node:24087) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Required parameter serial is not provided
(node:24087) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  this is my first patch. i come from china internet corp  I'll be going to use STF  without login. Ex  using iframe tag in my html file.

like this
 <iframe src="http://xxxxxxx:7100/?jwt=eyJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNoZXJhbmp1bkB3ZWlkaWFuLmNvbSIsIm5hbWUiOiJzaGVyYW5qdW4ifQ.w9JJtvHr32q71BRmbu4c0w9ezwD51P8v-bEgiRoW6qU" frameborder="0" scrolling="no" width="100%" height="630">

The jwt code was generated by myself program that used  PHP-JWT , But it was unsuccessful. I guessed  the key was wrong ,but  I didn't find it in STF. 

where  is wrong?

PHP CODE
 public function one(){
        $key = "eyJjc3JmU2VjcmV0IjoiV2VxdUpONFJELWV0M1FCMHJuYzJSeDdTIn0=";
        $token = array(
            'name' => '111',
            'email' => '1@1.com',
        );

        $jwt = Jwt::encode($token, $key);
        return $jwt;
 Thank you very much~  It is useful :)  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
I use the STF version 3.2.0
**What is the issue or idea you have?**
Over time of the using the stf local I noticed that the `adb devices` returns `error: protocol fault (couldn't read status): Undefined error: 0`, but if to stop the stf - `adb devices` works correctly. After rebooting the machine I can use the STF and adb again without problems.
**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**
The stf was started by the command `/usr/local/bin/stf local --allow-remote --public-ip 192.168.0.214 --provider 192.168.0.214 --bind-dev-pub tcp://192.168.0.214:7114 --bind-dev-pull tcp://192.168.0.214:7116`
**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
All devices status in the stf is disconnected.
**Please run `stf doctor` and paste the output here.**
2018-01-17T06:55:32.026Z INF/cli:doctor 798 [*] OS Arch: x64
2018-01-17T06:55:32.028Z INF/cli:doctor 798 [*] OS Platform: darwin
2018-01-17T06:55:32.029Z INF/cli:doctor 798 [*] OS Platform: 16.7.0
2018-01-17T06:55:32.029Z INF/cli:doctor 798 [*] Using Node 9.4.0
2018-01-17T06:55:32.053Z INF/cli:doctor 798 [*] Using ZeroMQ 4.2.3
2018-01-17T06:55:32.073Z INF/cli:doctor 798 [*] Using RethinkDB 2.3.6
2018-01-17T06:55:32.074Z INF/cli:doctor 798 [*] Using GraphicsMagick 1.3.27
2018-01-17T06:55:32.078Z INF/cli:doctor 798 [*] Using ADB 1.0.39
2018-01-17T06:55:32.083Z INF/cli:doctor 798 [*] Using ProtoBuf 3.5.1  ![image](https://user-images.githubusercontent.com/25398776/34927845-45ca4d7a-f9f4-11e7-9bce-544128d6f03a.png)


![image](https://user-images.githubusercontent.com/25398776/34927859-653d8f1e-f9f4-11e7-99c3-593e88312814.png)
 ![image](https://user-images.githubusercontent.com/25398776/34968905-11bde0f6-faa7-11e7-8aa0-a7eb2099104f.png)

I have solved this problem in this way。  **Problems**

1. Found `FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memory` in stf-websocket docker log, and it has stopped several times.

2. User operation has latency

**Scenario**

* device total: > 450 （50 provider role pc，10 phone per provider）
* device available: 300
* device busy: 130

**Deployment**

stf app role & db in one server

![image](https://user-images.githubusercontent.com/1922222/34865799-0349868c-f7b5-11e7-84b7-9d4661c23895.png)

stf-provider role in other dozens hosts


**Logs**

* stf-websocket@3602.service log

```
Jan 10 15:42:01 stf-app docker[15596]: (node:1) Warning: Possible EventEmitter memory leak detected. 11 *ALL listeners added. Use emitter.setMaxListeners() to increase limit
Jan 10 15:42:01 stf-app docker[15596]: (node:1) Warning: Possible EventEmitter memory leak detected. 11 wlMv5QCmSrK2xnad04BmGA== listeners added. Use emitter.setMaxListeners() to increase li
Jan 11 09:23:34 stf-app docker[15596]: (node:1) Warning: Possible EventEmitter memory leak detected. 11 *ALL listeners added. Use emitter.setMaxListeners() to increase limit
Jan 11 09:23:34 stf-app docker[15596]: (node:1) Warning: Possible EventEmitter memory leak detected. 11 wlMv5QCmSrK2xnad04BmGA== listeners added. Use emitter.setMaxListeners() to increase li
Jan 11 13:44:56 stf-app docker[15596]: <--- Last few GCs --->
Jan 11 13:44:56 stf-app docker[15596]: 79412940 ms: Mark-sweep 1374.0 (1434.1) -> 1374.0 (1434.1) MB, 1233.2 / 0.0 ms [allocation failure] [GC in old space requested].
Jan 11 13:44:56 stf-app docker[15596]: 79414166 ms: Mark-sweep 1374.0 (1434.1) -> 1374.0 (1434.1) MB, 1226.1 / 0.1 ms [allocation failure] [GC in old space requested].
Jan 11 13:44:56 stf-app docker[15596]: 79415691 ms: Mark-sweep 1374.0 (1434.1) -> 1375.3 (1407.1) MB, 1524.6 / 0.0 ms [last resort gc].
Jan 11 13:44:56 stf-app docker[15596]: 79417094 ms: Mark-sweep 1375.3 (1407.1) -> 1376.6 (1407.1) MB, 1402.1 / 0.1 ms [last resort gc].
Jan 11 13:44:56 stf-app docker[15596]: <--- JS stacktrace --->
Jan 11 13:44:56 stf-app docker[15596]: ==== JS stack trace =========================================
Jan 11 13:44:56 stf-app docker[15596]:     2: arguments adaptor frame: 2->1
Jan 11 13:44:56 stf-app docker[15596]: Security context: 0x146517a3fa99 <JS Object>
Jan 11 13:44:56 stf-app docker[15596]:     3: /* anonymous */ [/app/lib/units/websocket/index.js:~221] [pc=0x1b8aada5eabe] (this=0x292db1f849d1 <a Router with map 0x319dc588d951>,channel=0x3
Jan 11 13:44:56 stf-app docker[15596]:     4: arguments adaptor frame: 3->2
Jan 11 13:44:56 stf-app docker[15596]:     5: emit [/app/node_modules/eventemitter3/index.js:~101] [...
Jan 11 13:44:56 stf-app docker[15596]: FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memory
Jan 11 13:44:56 stf-app docker[15596]:  1: node::Abort() [node]
Jan 11 13:44:56 stf-app docker[15596]:  2: 0x109cafc [node]
Jan 11 13:44:56 stf-app docker[15596]:  3: v8::Utils::ReportApiFailure(char const*, char const*) [node]
Jan 11 13:44:56 stf-app docker[15596]:  4: v8::internal::V8::FatalProcessOutOfMemory(char const*, bool) [node]
Jan 11 13:44:56 stf-app docker[15596]:  5: v8::internal::Factory::NewOneByteInternalizedString(v8::internal::Vector<unsigned char const>, unsigned int) [node]
Jan 11 13:44:56 stf-app docker[15596]:  6: v8::internal::AstRawStringInternalizationKey::AsHandle(v8::internal::Isolate*) [node]
Jan 11 13:44:56 stf-app docker[15596]:  7: v8::internal::StringTable::LookupKey(v8::internal::Isolate*, v8::internal::HashTableKey*) [node]
Jan 11 13:44:56 stf-app docker[15596]:  8: v8::internal::AstRawString::Internalize(v8::internal::Isolate*) [node]
Jan 11 13:44:56 stf-app docker[15596]:  9: v8::internal::AstValueFactory::Internalize(v8::internal::Isolate*) [node]
Jan 11 13:44:56 stf-app docker[15596]: 10: v8::internal::Parser::Internalize(v8::internal::Isolate*, v8::internal::Handle<v8::internal::Script>, bool) [node]
Jan 11 13:44:56 stf-app docker[15596]: 11: v8::internal::Parser::Parse(v8::internal::ParseInfo*) [node]
Jan 11 13:44:56 stf-app docker[15596]: 12: v8::internal::Parser::ParseStatic(v8::internal::ParseInfo*) [node]
Jan 11 13:44:56 stf-app docker[15596]: 13: 0xb4ef2e [node]
Jan 11 13:44:56 stf-app docker[15596]: 14: 0xb566b6 [node]
Jan 11 13:44:56 stf-app docker[15596]: 15: v8::internal::Compiler::Compile(v8::internal::Handle<v8::internal::JSFunction>, v8::internal::Compiler::ClearExceptionFlag) [node]
Jan 11 13:44:56 stf-app docker[15596]: 16: v8::internal::Runtime_CompileLazy(int, v8::internal::Object**, v8::internal::Isolate*) [node]
Jan 11 13:44:56 stf-app docker[15596]: 17: 0x1b8aace060c7
Jan 11 13:44:57 stf-app systemd[1]: stf-websocket@3602.service: Main process exited, code=exited, status=139/n/a
Jan 11 13:44:57 stf-app docker[6602]: Error response from daemon: no such id: stf-websocket-3602
Jan 11 13:44:57 stf-app docker[6602]: time="2018-01-11T13:44:57+08:00" level=fatal msg="Error: failed to stop one or more containers"
Jan 11 13:44:57 stf-app systemd[1]: stf-websocket@3602.service: Control process exited, code=exited status=1
Jan 11 13:44:57 stf-app systemd[1]: stf-websocket@3602.service: Unit entered failed state.
Jan 11 13:44:57 stf-app systemd[1]: stf-websocket@3602.service: Failed with result 'exit-code'.
Jan 11 13:44:57 stf-app systemd[1]: stf-websocket@3602.service: Service hold-off time over, scheduling restart.
Jan 11 13:44:57 stf-app systemd[1]: Stopped STF websocket.
Jan 11 13:44:57 stf-app systemd[1]: Starting STF websocket...
```

* top

![image](https://user-images.githubusercontent.com/1922222/34865997-e36beb88-f7b5-11e7-8f97-6b734696faac.png)

* netstat

```
netstat -an | awk '/tcp/{print $6}' | sort | uniq -c
      5 CLOSE_WAIT
   1604 ESTABLISHED
      1 FIN_WAIT2
      1 LAST_ACK
     47 LISTEN
      2 SYN_RECV
     80 TIME_WAIT
```
 @thinkhy I deployed stf depending on https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md.

I have 50 provider role machine (10 devices per provider), the devices are not connected to single machine directly. 
But I only have one app role machine, is that the problem? What is the maximum devices can connect to one stf app role? 500? 1000? Is there any practical experience with that scale?
  This contributes to the server side, see this ticket:
https://github.com/openstf/STFService.apk/issues/18
and the corresponding pull request:
https://github.com/openstf/STFService.apk/pull/20

The STFService.apk was updated to the changes in the pull request in order to be able to set and get the Bluetooth status. The .proto files have been adjusted. The functionality was very similiar implemented to the WiFi functionality. Like for WiFi, similiar buttons have been added to the Device->Automation view.

Be aware, that setting and getting the Bluetooth status is only possible with the new updated .apk, otherwise a timeout occurs. Rebased and fixed that issue  Hi,
I am using STF 3.2.0 version. and There's issues during attaching emulators to STF.
I wanted to attach android emulators on server version of centos. 
So when I ran the emulator, I used  -no-skin -no-audio -no-window options. 

I have the 2 questions for this errors. and details are described on below.
- When I clicked the device from STF main screen, Error was occurred. 
- Attaching arm based emulator was failed.

<br><br>

## development environment
- Centos7.4 VM, 64bit
- hardware machine : x86_64
- server mode, no UI
- AVD info
  Name: testAVD3
  Target: Google APIs (Google Inc.)
          Based on: Android 6.0 (Marshmallow) Tag/ABI: google_apis/x86

  Name: testAVD7
  Target: Google APIs (Google Inc.)
          Based on: Android 7.0 (Nougat) Tag/ABI: google_apis/armeabi-v7a

## stf doctor
2018-01-03T02:16:06.250Z INF/cli:doctor 110396 [*] OS Arch: x64
2018-01-03T02:16:06.253Z INF/cli:doctor 110396 [*] OS Platform: linux
2018-01-03T02:16:06.253Z INF/cli:doctor 110396 [*] OS Platform: 3.10.0-693.2.2.el7.x86_64
2018-01-03T02:16:06.253Z INF/cli:doctor 110396 [*] Using Node 6.12.0
2018-01-03T02:16:06.303Z INF/cli:doctor 110396 [*] Using ZeroMQ 4.1.4
2018-01-03T02:16:06.323Z INF/cli:doctor 110396 [*] Using ADB 1.0.31
2018-01-03T02:16:06.470Z INF/cli:doctor 110396 [*] Using GraphicsMagick 1.3.27a
2018-01-03T02:16:06.476Z ERR/cli:doctor 110396 [*] Unexpected error checking GraphicsMagick: TypeError: Invalid Version: 1.3.27a
2018-01-03T02:16:06.558Z INF/cli:doctor 110396 [*] Using RethinkDB 2.3.6
2018-01-03T02:16:06.567Z INF/cli:doctor 110396 [*] Using ProtoBuf 3.5.0
<br><br>
## 1. When I clicked the device from STF main screen, the device is disconnected. 

* Case description : x86 based emulator
> ./avdmanager create avd --force --name testAVD3 --abi google_apis/x86 --package 'system-images;android-26;google_apis;x86'
> ./emulator -avd testAVD3 -no-skin -no-audio -no-window &
- log : [log_x86_case1.txt](https://github.com/openstf/stf/files/1599399/log_x86_case1.txt)
* part of error message on log
2018-01-03T03:50:29.365Z WRN/device:plugins:screen:stream 120143 
[emulator-5554] Shell keeping minicap running ended unexpectedly
2018-01-03T03:50:29.367Z INF/device:plugins:screen:stream 120143 [emulator-5554] Disconnecting from minicap service
2018-01-03T03:50:29.368Z FTL/device:plugins:screen:stream 120143 [emulator-5554] Frame producer had an error Error: Failed more than 3 times in 10000ms
    at FrameProducer._failLimitExceeded (/usr/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:222:26)
    at FailCounter.emit (/usr/lib/node_modules/stf/node_modules/eventemitter3/index.js:117:35)
    at FailCounter.inc (/usr/lib/node_modules/stf/lib/util/failcounter.js:29:10)
    at FrameProducer._outputEnded (/usr/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:215:24)
    at RiskyStream.emit (/usr/lib/node_modules/stf/node_modules/eventemitter3/index.js:115:35)
    at RiskyStream.<anonymous> (/usr/lib/node_modules/stf/lib/util/riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:974:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
2018-01-03T03:50:29.370Z FTL/util:lifecycle 120143 [emulator-5554] Shutting down due to fatal error
2018-01-03T03:50:29.399Z INF/provider 116273 [*] Cleaning up device worker "emulator-5554"
2018-01-03T03:50:29.401Z ERR/provider 116273 [*] Device worker "emulator-5554" died with code 1
2018-01-03T03:50:29.401Z INF/provider 116273 [*] Restarting device worker "emulator-5554"
2018-01-03T03:50:30.780Z INF/device:support:push 120217 [emulator-5554] Sending output to "tcp://127.0.0.1:7116"


<br><br>
## 2. Attaching arm based emulator was failed. 

* Case description : armeabi-v7a based emulator
> ./avdmanager create avd --name testAVD7 --abi google_apis/armeabi-v7a --package 'system-images;android-24;google_apis;armeabi-v7a'
> ./emulator  -avd testAVD7 -no-skin -no-audio -no-window &
- log :  [log_arm_emul.txt](https://github.com/openstf/stf/files/1599479/log_arm_emul.txt)
- test result : Keep waiting for completion of booting for more than 20 mins




Thanks in advance.


  
    I want to modify front-end UI and maybe contribute.

What I want to do:
> Change device selection page to checkbox style
> Add button which executes "install Android application to all of chosen devices".
> Add button which executes "run instrumentation test using gradle command".

However, I don't know how to build this project. I also don't know which front-end framework did you use.

Could you guide me a little bit?  Dear,
        Back、Menu and Home key have no response in Vivo X9, but it work normally in other mobile phones。

<img width="402" alt="dingtalk20180103112403" src="https://user-images.githubusercontent.com/26616673/34508299-b352307c-f078-11e7-9ab0-e7f6c7cfa166.png">
 Dear,
      I wan't debug on Vivo X9, i has read code in "/Users/zhj/Api/stf/res/app/control-panes/device-control/device-control-key-directive.js",as follow:

![image](https://user-images.githubusercontent.com/26616673/34550125-446a0a5a-f149-11e7-8751-9cab4979435d.png)

could you tell me which code can response after " scope.control.keyUp(key)"?
 @thinkhy ,thanks. I have solve the problem  Currently our device list displayed by STF looks like this:
![image](https://user-images.githubusercontent.com/3340954/34461934-c3399cba-ee38-11e7-9263-7c7271e0e7b1.png)

Some devices have unfriendly names like XT1032 and C6603 however, their market names are Moto G and Xperia Z respectively. It will be nice feature to include those market names in STF UI.

There is an official list of Android devices maintained by Google: https://support.google.com/googleplay/answer/1727131?hl=en and there are Android libraries which map model names to market names e.g.: https://github.com/jaredrummler/AndroidDeviceNames or https://github.com/tslamic/AndroidDeviceNames
 What is approx. price and what else will be included (if any)?  While below 'DELETE request' disconnects adb successfully.
> DELETE http://xx.xx.xx.xx:7100/api/v1/user/devices/xxxxxxxx/remoteConnect

Below 'POST request' doesn't do anything but shows "remoteConnectUrl" 
> POST http://xx.xx.xx.xx:7100/api/v1/user/devices/xxxxxxxx/remoteConnect
'{
    "success": true,
    "remoteConnectUrl": "xx.xx.xx.xx:7405"
}'

 I expected this request to do this:
>adb connect xx.xx.xx.xx:7405

Is it a bug or intended result?


Please run stf doctor and paste the output here.
2017-12-29T03:18:06.891Z INF/cli:doctor 4752 [] OS Arch: x64
2017-12-29T03:18:06.892Z INF/cli:doctor 4752 [] OS Platform: darwin
2017-12-29T03:18:06.892Z INF/cli:doctor 4752 [] OS Platform: 17.2.0
2017-12-29T03:18:06.892Z INF/cli:doctor 4752 [] Using Node 8.4.0
2017-12-29T03:18:06.905Z INF/cli:doctor 4752 [] Using ZeroMQ 4.2.3
2017-12-29T03:18:06.917Z INF/cli:doctor 4752 [] Using GraphicsMagick 1.3.27
2017-12-29T03:18:06.920Z INF/cli:doctor 4752 [] Using RethinkDB 2.3.6
2017-12-29T03:18:06.921Z INF/cli:doctor 4752 [] Using ADB 1.0.39
2017-12-29T03:18:06.929Z INF/cli:doctor 4752 [*] Using ProtoBuf 3.5.1 I am a little bit confused, because it is POST not GET.
Thank you very much.
  Hello!
STF is a great tool , thank you!

I have a question.

I want to get the device on the left screen as DOM.
Because I want to operate the screen of the smartphone with selenium.
Do you know how to do it?
Or if you know another method other than selenium please tell me... Thank you very match!

I want to controll the pre-installed application on andoroid-OS.
For example, to make a call from a phone-application which pre-installed, etc.

Can I use appium with STF?  Could not locate the bindings file. Tried:
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/build/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/build/Debug/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/build/Release/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/out/Debug/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/Debug/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/out/Release/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/Release/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/build/default/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/compiled/8.1.2/darwin/x64/zmq.node
Could not locate the bindings file. Tried:
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/build/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/build/Debug/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/build/Release/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/out/Debug/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/Debug/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/out/Release/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/Release/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/build/default/zmq.node
 → /Users/misfit/Documents/ADBKIT/stf/node_modules/zmq/compiled/8.1.2/darwin/x64/zmq.node
2017-12-28T03:47:15.856Z FTL/cli:local 7184 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/Users/misfit/Documents/ADBKIT/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:125:13)
    at ChildProcess.emit (events.js:213:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:197:12)
2017-12-28T03:47:15.856Z INF/cli:local 7184 [*] Shutting down all child processes  
 Thanks @sorccu   Sometimes apps requires a device having some minimal OpenGL ES version. This PR adds corresponding column in device list and field in API.

Version is always in format: `<major>.<minor>`. If undefined it falls back to `0.0` to be consistent with [GL_ES_VERSION_UNDEFINED](https://developer.android.com/reference/android/content/pm/FeatureInfo.html#GL_ES_VERSION_UNDEFINED) and to be always parsable as a float. @sorccu what about reviewing this PR?
PS
Sorry, if this comment is too offensive but I haven't found any info that reminders like this post are unwelcome.  Cool, thanks :)  Adds option to control SAML callback URL explicitly, similarly to oauth2 unit. Thanks!    INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli migrate"
INF/db 13203 [*] Connecting to 127.0.0.1:28015
INF/db:setup 13203 [*] Database "stf" already exists
INF/db:setup 13203 [*] Table "users" already exists
INF/db:setup 13203 [*] Table "accessTokens" already exists
INF/db:setup 13203 [*] Table "vncauth" already exists
INF/db:setup 13203 [*] Table "devices" already exists
INF/db:setup 13203 [*] Table "logs" already exists
INF/db:setup 13203 [*] Index "users"."adbKeys" already exists
INF/db:setup 13203 [*] Index "accessTokens"."email" already exists
INF/db:setup 13203 [*] Index "vncauth"."response" already exists
INF/db:setup 13203 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 13203 [*] Index "devices"."owner" already exists
INF/db:setup 13203 [*] Index "devices"."present" already exists
INF/db:setup 13203 [*] Index "devices"."providerChannel" already exists
INF/db:setup 13203 [*] Waiting for index "users"."adbKeys"
INF/db:setup 13203 [*] Waiting for index "accessTokens"."email"
INF/db:setup 13203 [*] Waiting for index "vncauth"."response"
INF/db:setup 13203 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 13203 [*] Waiting for index "devices"."owner"
INF/db:setup 13203 [*] Waiting for index "devices"."present"
INF/db:setup 13203 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 13203 [*] Index "users"."adbKeys" is ready
INF/db:setup 13203 [*] Index "accessTokens"."email" is ready
INF/db:setup 13203 [*] Index "vncauth"."response" is ready
INF/db:setup 13203 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 13203 [*] Index "devices"."owner" is ready
INF/db:setup 13203 [*] Index "devices"."present" is ready
INF/db:setup 13203 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli provider --name aslanatc --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip 100.100.32.232 --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://100.100.32.232:7100/"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://100.100.32.232:7100/auth/mock/ --websocket-url http://100.100.32.232:7110/"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-temp --port 7102"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 13197 [*] Forking "/usr/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
INF/triproxy 13209 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 13209 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 13209 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/triproxy 13215 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 13215 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 13215 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/poorxy 13284 [*] Listening on port 7100
INF/reaper 13228 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 13228 [reaper001] Reaping devices with no heartbeat
INF/db 13228 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 13228 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 13228 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/db 13227 [*] Connecting to 127.0.0.1:28015
INF/db 13216 [*] Connecting to 127.0.0.1:28015
INF/processor 13227 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 13227 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/processor 13216 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 13216 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/storage:plugins:image 13271 [*] Listening on port 7103
INF/auth-mock 13240 [*] Listening on port 7120
INF/provider 13234 [*] Subscribing to permanent channel "cr0dV5COTkm/pN7eamsmWw=="
INF/storage:plugins:apk 13277 [*] Listening on port 7104
INF/provider 13234 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 13234 [*] Receiving input from "tcp://127.0.0.1:7114"
INF/provider 13234 [*] Tracking devices
INF/provider 13234 [*] Found device "Q4FQ59JRO7BQ99BY" (device)
INF/storage:temp 13265 [*] Listening on port 7102
INF/app 13246 [*] Using pre-built resources
INF/app 13246 [*] Listening on port 7105
INF/db 13246 [*] Connecting to 127.0.0.1:28015
INF/websocket 13259 [*] Subscribing to permanent channel "*ALL"
INF/websocket 13259 [*] Listening on port 7110
INF/db 13259 [*] Connecting to 127.0.0.1:28015
INF/provider 13234 [*] Registered device "Q4FQ59JRO7BQ99BY"
INF/reaper 13228 [reaper001] Device "Q4FQ59JRO7BQ99BY" is present
INF/websocket 13259 [*] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 13259 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/api 13252 [*] Subscribing to permanent channel "*ALL"
INF/api 13252 [*] Listening on port 7106
INF/api 13252 [*] Sending output to "tcp://127.0.0.1:7113"
INF/api 13252 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/device:support:push 13309 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
INF/device 13309 [Q4FQ59JRO7BQ99BY] Preparing device
INF/db 13252 [*] Connecting to 127.0.0.1:28015
FTL/device 13309 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
FTL/util:lifecycle 13309 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
INF/provider 13234 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
ERR/provider 13234 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
INF/provider 13234 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
INF/device:support:push 13323 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
INF/device 13323 [Q4FQ59JRO7BQ99BY] Preparing device
FTL/device 13323 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
FTL/util:lifecycle 13323 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
INF/provider 13234 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
ERR/provider 13234 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
INF/provider 13234 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
INF/device:support:push 13331 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
INF/device 13331 [Q4FQ59JRO7BQ99BY] Preparing device
FTL/device 13331 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
FTL/util:lifecycle 13331 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
INF/provider 13234 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
ERR/provider 13234 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
INF/provider 13234 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
INF/device:support:push 13339 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
INF/device 13339 [Q4FQ59JRO7BQ99BY] Preparing device
FTL/device 13339 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
FTL/util:lifecycle 13339 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
INF/provider 13234 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
ERR/provider 13234 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
INF/provider 13234 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
^CINF/util:lifecycle 13259 [*] Winding down for graceful exit
INF/util:lifecycle 13215 [dev001] Winding down for graceful exit
INF/util:lifecycle 13216 [proc001] Winding down for graceful exit
INF/util:lifecycle 13227 [proc002] Winding down for graceful exit
INF/util:lifecycle 13228 [reaper001] Winding down for graceful exit
INF/util:lifecycle 13234 [*] Winding down for graceful exit
INF/util:lifecycle 13209 [app001] Winding down for graceful exit
WRN/db 13216 [proc001] Connection closed
INF/cli:local 13197 [*] Received SIGINT, waiting for processes to terminate
INF/util:lifecycle 13240 [*] Winding down for graceful exit
INF/util:lifecycle 13246 [*] Winding down for graceful exit
WRN/provider 13234 [*] Device worker "Q4FQ59JRO7BQ99BY" was killed with signal SIGINT, assuming deliberate action and not restarting
INF/util:lifecycle 13234 [*] Winding down for graceful exit
INF/util:lifecycle 13252 [*] Winding down for graceful exit
INF/provider 13234 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
INF/provider 13234 [*] Device worker "Q4FQ59JRO7BQ99BY" has retired
INF/auth-mock 13240 [*] Waiting for client connections to end
INF/util:lifecycle 13259 [*] Winding down for graceful exit
INF/util:lifecycle 13246 [*] Winding down for graceful exit
WRN/db 13259 [*] Connection closed
INF/util:lifecycle 13228 [reaper001] Winding down for graceful exit
INF/util:lifecycle 13252 [*] Winding down for graceful exit
WRN/db 13246 [*] Connection closed
WRN/db 13252 [*] Connection closed
WRN/db 13228 [reaper001] Connection closed
INF/util:lifecycle 13227 [proc002] Winding down for graceful exit
WRN/db 13227 [proc002] Connection closed Thanks for your suggestion
qiniu@aslanatc:~$ stf doctor
INF/cli:doctor 13532 [*] OS Arch: x64
INF/cli:doctor 13532 [*] OS Platform: linux
INF/cli:doctor 13532 [*] OS Platform: 3.19.0-25-generic
INF/cli:doctor 13532 [*] Using Node 7.10.1
INF/cli:doctor 13532 [*] Using ZeroMQ 4.1.6
INF/cli:doctor 13532 [*] Using RethinkDB 2.3.6~0trusty
INF/cli:doctor 13532 [*] Using GraphicsMagick 1.3.18
INF/cli:doctor 13532 [*] Using ProtoBuf 3.5.0
INF/cli:doctor 13532 [*] Using ADB 1.0.31

when ran "stf doctor",it is OK.

I ran sudo apt-get install yasm ,the probelm didn't resolved.
 Yes,i install and reinstall STF but the problem didn't resolved.
The log please see the below. 

2017-12-12T06:19:13.666Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli migrate"
2017-12-12T06:19:13.975Z INF/db 15416 [*] Connecting to 127.0.0.1:28015
2017-12-12T06:19:13.996Z INF/db:setup 15416 [*] Database "stf" already exists
2017-12-12T06:19:14.007Z INF/db:setup 15416 [*] Table "users" already exists
2017-12-12T06:19:14.007Z INF/db:setup 15416 [*] Table "accessTokens" already exists
2017-12-12T06:19:14.007Z INF/db:setup 15416 [*] Table "vncauth" already exists
2017-12-12T06:19:14.007Z INF/db:setup 15416 [*] Table "devices" already exists
2017-12-12T06:19:14.007Z INF/db:setup 15416 [*] Table "logs" already exists
2017-12-12T06:19:14.023Z INF/db:setup 15416 [*] Index "users"."adbKeys" already exists
2017-12-12T06:19:14.023Z INF/db:setup 15416 [*] Index "accessTokens"."email" already exists
2017-12-12T06:19:14.023Z INF/db:setup 15416 [*] Index "vncauth"."response" already exists
2017-12-12T06:19:14.023Z INF/db:setup 15416 [*] Index "vncauth"."responsePerDevice" already exists
2017-12-12T06:19:14.023Z INF/db:setup 15416 [*] Index "devices"."owner" already exists
2017-12-12T06:19:14.023Z INF/db:setup 15416 [*] Index "devices"."present" already exists
2017-12-12T06:19:14.023Z INF/db:setup 15416 [*] Index "devices"."providerChannel" already exists
2017-12-12T06:19:14.023Z INF/db:setup 15416 [*] Waiting for index "users"."adbKeys"
2017-12-12T06:19:14.024Z INF/db:setup 15416 [*] Waiting for index "accessTokens"."email"
2017-12-12T06:19:14.024Z INF/db:setup 15416 [*] Waiting for index "vncauth"."response"
2017-12-12T06:19:14.025Z INF/db:setup 15416 [*] Waiting for index "vncauth"."responsePerDevice"
2017-12-12T06:19:14.025Z INF/db:setup 15416 [*] Waiting for index "devices"."owner"
2017-12-12T06:19:14.026Z INF/db:setup 15416 [*] Waiting for index "devices"."present"
2017-12-12T06:19:14.026Z INF/db:setup 15416 [*] Waiting for index "devices"."providerChannel"
2017-12-12T06:19:14.030Z INF/db:setup 15416 [*] Index "users"."adbKeys" is ready
2017-12-12T06:19:14.030Z INF/db:setup 15416 [*] Index "accessTokens"."email" is ready
2017-12-12T06:19:14.030Z INF/db:setup 15416 [*] Index "vncauth"."response" is ready
2017-12-12T06:19:14.030Z INF/db:setup 15416 [*] Index "vncauth"."responsePerDevice" is ready
2017-12-12T06:19:14.032Z INF/db:setup 15416 [*] Index "devices"."owner" is ready
2017-12-12T06:19:14.032Z INF/db:setup 15416 [*] Index "devices"."present" is ready
2017-12-12T06:19:14.032Z INF/db:setup 15416 [*] Index "devices"."providerChannel" is ready
2017-12-12T06:19:14.043Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
2017-12-12T06:19:14.047Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
2017-12-12T06:19:14.050Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2017-12-12T06:19:14.052Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2017-12-12T06:19:14.058Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
2017-12-12T06:19:14.074Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli provider --name aslanatc --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip 100.100.32.232 --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800 --mute-master never"
2017-12-12T06:19:14.086Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://100.100.32.232:7100/"
2017-12-12T06:19:14.102Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://100.100.32.232:7100/auth/mock/ --websocket-url http://100.100.32.232:7110/"
2017-12-12T06:19:14.118Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
2017-12-12T06:19:14.134Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
2017-12-12T06:19:14.140Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-temp --port 7102"
2017-12-12T06:19:14.162Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
2017-12-12T06:19:14.194Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
2017-12-12T06:19:14.206Z INF/util:procutil 15410 [*] Forking "/usr/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
2017-12-12T06:19:15.352Z INF/triproxy 15422 [app001] PUB socket bound on tcp://127.0.0.1:7111
2017-12-12T06:19:15.374Z INF/triproxy 15422 [app001] DEALER socket bound on tcp://127.0.0.1:7112
2017-12-12T06:19:15.385Z INF/triproxy 15422 [app001] PULL socket bound on tcp://127.0.0.1:7113
2017-12-12T06:19:15.443Z INF/triproxy 15428 [dev001] PUB socket bound on tcp://127.0.0.1:7114
2017-12-12T06:19:15.462Z INF/triproxy 15428 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
2017-12-12T06:19:15.465Z INF/triproxy 15428 [dev001] PULL socket bound on tcp://127.0.0.1:7116
2017-12-12T06:19:15.975Z INF/db 15440 [*] Connecting to 127.0.0.1:28015
2017-12-12T06:19:16.010Z INF/processor 15440 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
2017-12-12T06:19:16.012Z INF/processor 15440 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
2017-12-12T06:19:16.049Z INF/db 15429 [*] Connecting to 127.0.0.1:28015
2017-12-12T06:19:16.050Z INF/reaper 15441 [reaper001] Subscribing to permanent channel "*ALL"
2017-12-12T06:19:16.068Z INF/reaper 15441 [reaper001] Reaping devices with no heartbeat
2017-12-12T06:19:16.076Z INF/db 15441 [reaper001] Connecting to 127.0.0.1:28015
2017-12-12T06:19:16.076Z INF/poorxy 15495 [*] Listening on port 7100
2017-12-12T06:19:16.109Z INF/reaper 15441 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
2017-12-12T06:19:16.110Z INF/reaper 15441 [reaper001] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:16.146Z INF/processor 15429 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
2017-12-12T06:19:16.158Z INF/processor 15429 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
2017-12-12T06:19:16.372Z INF/auth-mock 15453 [*] Listening on port 7120
2017-12-12T06:19:16.509Z INF/storage:plugins:image 15488 [*] Listening on port 7103
2017-12-12T06:19:16.556Z INF/provider 15447 [*] Subscribing to permanent channel "PbtyAnUQQAi1nk7bjyv52A=="
2017-12-12T06:19:16.577Z INF/provider 15447 [*] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:16.579Z INF/provider 15447 [*] Receiving input from "tcp://127.0.0.1:7114"
2017-12-12T06:19:16.599Z INF/provider 15447 [*] Tracking devices
2017-12-12T06:19:16.602Z INF/provider 15447 [*] Found device "Q4FQ59JRO7BQ99BY" (device)
2017-12-12T06:19:16.621Z INF/storage:plugins:apk 15489 [*] Listening on port 7104
2017-12-12T06:19:16.673Z INF/provider 15447 [*] Registered device "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:16.679Z INF/reaper 15441 [reaper001] Device "Q4FQ59JRO7BQ99BY" is present
2017-12-12T06:19:16.765Z INF/storage:temp 15477 [*] Listening on port 7102
2017-12-12T06:19:16.854Z INF/app 15459 [*] Using pre-built resources
2017-12-12T06:19:16.870Z INF/app 15459 [*] Listening on port 7105
2017-12-12T06:19:16.873Z INF/db 15459 [*] Connecting to 127.0.0.1:28015
2017-12-12T06:19:16.912Z INF/websocket 15471 [*] Subscribing to permanent channel "*ALL"
2017-12-12T06:19:16.917Z INF/websocket 15471 [*] Listening on port 7110
2017-12-12T06:19:16.920Z INF/db 15471 [*] Connecting to 127.0.0.1:28015
2017-12-12T06:19:16.932Z INF/websocket 15471 [*] Sending output to "tcp://127.0.0.1:7113"
2017-12-12T06:19:16.932Z INF/websocket 15471 [*] Receiving input from "tcp://127.0.0.1:7111"
2017-12-12T06:19:17.346Z INF/api 15465 [*] Subscribing to permanent channel "*ALL"
2017-12-12T06:19:17.411Z INF/device:support:push 15518 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:17.416Z INF/api 15465 [*] Listening on port 7106
2017-12-12T06:19:17.417Z INF/device 15518 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:17.432Z INF/api 15465 [*] Sending output to "tcp://127.0.0.1:7113"
2017-12-12T06:19:17.433Z INF/api 15465 [*] Receiving input from "tcp://127.0.0.1:7111"
2017-12-12T06:19:17.758Z INF/db 15465 [*] Connecting to 127.0.0.1:28015
2017-12-12T06:19:17.860Z FTL/device 15518 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:17.861Z FTL/util:lifecycle 15518 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:17.867Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:17.868Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:17.868Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:18.828Z INF/device:support:push 15534 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:18.832Z INF/device 15534 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:19.130Z FTL/device 15534 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:19.131Z FTL/util:lifecycle 15534 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:19.135Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:19.135Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:19.135Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:20.073Z INF/device:support:push 15542 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:20.077Z INF/device 15542 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:20.374Z FTL/device 15542 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:20.376Z FTL/util:lifecycle 15542 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:20.379Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:20.380Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:20.380Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:21.316Z INF/device:support:push 15550 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:21.320Z INF/device 15550 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:21.660Z FTL/device 15550 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:21.662Z FTL/util:lifecycle 15550 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:21.667Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:21.667Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:21.667Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:22.592Z INF/device:support:push 15558 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:22.596Z INF/device 15558 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:22.900Z FTL/device 15558 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:22.901Z FTL/util:lifecycle 15558 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:22.905Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:22.907Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:22.907Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:23.844Z INF/device:support:push 15566 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:23.848Z INF/device 15566 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:24.149Z FTL/device 15566 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:24.150Z FTL/util:lifecycle 15566 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:24.155Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:24.155Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:24.155Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:25.092Z INF/device:support:push 15574 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:25.096Z INF/device 15574 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:25.400Z FTL/device 15574 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:25.401Z FTL/util:lifecycle 15574 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:25.405Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:25.405Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:25.405Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:26.341Z INF/device:support:push 15582 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:26.345Z INF/device 15582 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:26.612Z INF/provider 15447 [*] Providing 0 of 1 device(s); waiting for "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:26.644Z FTL/device 15582 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:26.646Z FTL/util:lifecycle 15582 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:26.651Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:26.651Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:26.651Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:27.577Z INF/device:support:push 15590 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:27.581Z INF/device 15590 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:27.883Z FTL/device 15590 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:27.885Z FTL/util:lifecycle 15590 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:27.890Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:27.891Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:27.891Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:28.829Z INF/device:support:push 15598 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:28.833Z INF/device 15598 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:29.182Z FTL/device 15598 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:29.184Z FTL/util:lifecycle 15598 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:29.188Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:29.188Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:29.189Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:30.128Z INF/device:support:push 15606 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:30.132Z INF/device 15606 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:30.430Z FTL/device 15606 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:30.432Z FTL/util:lifecycle 15606 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:30.438Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:30.438Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:30.438Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:31.432Z INF/device:support:push 15614 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:31.435Z INF/device 15614 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:31.786Z FTL/device 15614 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:31.787Z FTL/util:lifecycle 15614 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:31.791Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:31.792Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:31.792Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:32.731Z INF/device:support:push 15622 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:32.735Z INF/device 15622 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:33.080Z FTL/device 15622 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:33.081Z FTL/util:lifecycle 15622 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:33.086Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:33.086Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:33.086Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:34.026Z INF/device:support:push 15630 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:34.030Z INF/device 15630 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:34.331Z FTL/device 15630 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:34.332Z FTL/util:lifecycle 15630 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:34.338Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:34.339Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:34.339Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:35.279Z INF/device:support:push 15638 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
2017-12-12T06:19:35.284Z INF/device 15638 [Q4FQ59JRO7BQ99BY] Preparing device
2017-12-12T06:19:35.586Z FTL/device 15638 [Q4FQ59JRO7BQ99BY] Setup had an error Error: Cannot find module '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/index.js:5:15)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at /usr/lib/node_modules/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
2017-12-12T06:19:35.588Z FTL/util:lifecycle 15638 [Q4FQ59JRO7BQ99BY] Shutting down due to fatal error
2017-12-12T06:19:35.593Z INF/provider 15447 [*] Cleaning up device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:35.593Z ERR/provider 15447 [*] Device worker "Q4FQ59JRO7BQ99BY" died with code 1
2017-12-12T06:19:35.593Z INF/provider 15447 [*] Restarting device worker "Q4FQ59JRO7BQ99BY"
2017-12-12T06:19:36.535Z INF/device:support:push 15646 [Q4FQ59JRO7BQ99BY] Sending output to "tcp://127.0.0.1:7116"
 Sorry , i misunderstanding.

qiniu@aslanatc:~$ npm install
npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@^1.0.0 (node_modules/chokidar/node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.3: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})
npm WARN enoent ENOENT: no such file or directory, open '/home/qiniu/package.json'
npm WARN qiniu No description
npm WARN qiniu No repository field.
npm WARN qiniu No README data
npm WARN qiniu No license field. Okay
qiniu@aslanatc:~$ npm install -g stf
npm WARN deprecated node-uuid@1.4.8: Use uuid module instead
/usr/bin/stf -> /usr/lib/node_modules/stf/bin/stf
/usr/lib
└── stf@3.2.0

qiniu@aslanatc:~$ stf doctor
2017-12-12T06:51:49.515Z INF/cli:doctor 17373 [*] OS Arch: x64
2017-12-12T06:51:49.517Z INF/cli:doctor 17373 [*] OS Platform: linux
2017-12-12T06:51:49.518Z INF/cli:doctor 17373 [*] OS Platform: 3.19.0-25-generic
2017-12-12T06:51:49.518Z INF/cli:doctor 17373 [*] Using Node 7.10.1
2017-12-12T06:51:49.543Z INF/cli:doctor 17373 [*] Using ZeroMQ 4.1.6
2017-12-12T06:51:49.562Z INF/cli:doctor 17373 [*] Using RethinkDB 2.3.6~0trusty
2017-12-12T06:51:49.562Z INF/cli:doctor 17373 [*] Using GraphicsMagick 1.3.18
2017-12-12T06:51:49.563Z INF/cli:doctor 17373 [*] Using ProtoBuf 3.5.0
2017-12-12T06:51:49.563Z INF/cli:doctor 17373 [*] Using ADB 1.0.31 I resolved my problem by "npm install jpeg-turbo " at /usr/lib/node_modules/stf  
Thanks for your patient and suggestion. @sorccu   ### I setup the STF follow the step in README.md, and my stf version is 3.2.0
### So, when I finished setup, I connect my Nexus6 use USB, and start stf with the command `stf  local`.
## Then I open my FireFox, and type in  http://127.0.0.1:7100, after I input the username and email. it came out this mistake:
<img width="1278" alt="1" src="https://user-images.githubusercontent.com/7285031/33814811-ca567116-de67-11e7-93ba-c128be97cf84.png">

### and when I close it and open the control tap, it like this:
<img width="1279" alt="2" src="https://user-images.githubusercontent.com/7285031/33814946-c7869582-de68-11e7-8748-5cdc24adc701.png">

### the stf log seems everything is OK!
<img width="1272" alt="3" src="https://user-images.githubusercontent.com/7285031/33814979-ff0df22a-de68-11e7-9a18-2b8d9ede1366.png">

## But, It is strange that when i use safari to open the url, it's OK, every thing goes well. 
<img width="1278" alt="4" src="https://user-images.githubusercontent.com/7285031/33815023-4897676e-de69-11e7-9f3e-1d43017891bf.png">

# do you have any idea about this ? @thinkhy FireFox Quantum 57.0.1 @thinkhy I tried remove all the plugin and restart the firefox, but stil cannot work  I have to get hold of UDID so that I can use it in my automation. However when I pick the UDID from adb devices output it does not seem to work.


$ adb connect 10.41.171.4:7409
already connected to 10.41.171.4:7409

$ adb devices -l
List of devices attached
10.41.171.4:7409	device product:albus model:Moto_Z2_Play device:albus

$ adb -s "10.41.171.4:7409" shell ls
error: unknown host service

$ adb -s 10.41.171.4:7409 shell ls
error: unknown host service



ashishs-mini:SampleTest admin$ stf doctor
INF/cli:doctor 20931 [*] OS Arch: x64
INF/cli:doctor 20931 [*] OS Platform: darwin
INF/cli:doctor 20931 [*] OS Platform: 16.7.0
INF/cli:doctor 20931 [*] Using Node 6.11.2
INF/cli:doctor 20931 [*] Using ZeroMQ 4.2.2
INF/cli:doctor 20931 [*] Using RethinkDB 2.3.6
INF/cli:doctor 20931 [*] Using GraphicsMagick 1.3.26
INF/cli:doctor 20931 [*] Using ADB 1.0.39
INF/cli:doctor 20931 [*] Using ProtoBuf 3.5.0
ashishs-mini:SampleTest admin$ 
ashishs-mini:SampleTest admin$ 


 
 $ stf local --public-ip 10.41.17.66
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
INF/db 21207 [*] Connecting to 127.0.0.1:28015
INF/db:setup 21207 [*] Database "stf" already exists
INF/db:setup 21207 [*] Table "users" already exists
INF/db:setup 21207 [*] Table "accessTokens" already exists
INF/db:setup 21207 [*] Table "vncauth" already exists
INF/db:setup 21207 [*] Table "devices" already exists
INF/db:setup 21207 [*] Table "logs" already exists
INF/db:setup 21207 [*] Index "users"."adbKeys" already exists
INF/db:setup 21207 [*] Index "accessTokens"."email" already exists
INF/db:setup 21207 [*] Index "vncauth"."response" already exists
INF/db:setup 21207 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 21207 [*] Index "devices"."owner" already exists
INF/db:setup 21207 [*] Index "devices"."present" already exists
INF/db:setup 21207 [*] Waiting for index "users"."adbKeys"
INF/db:setup 21207 [*] Waiting for index "accessTokens"."email"
INF/db:setup 21207 [*] Waiting for index "vncauth"."response"
INF/db:setup 21207 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 21207 [*] Waiting for index "devices"."owner"
INF/db:setup 21207 [*] Waiting for index "devices"."present"
INF/db:setup 21207 [*] Index "devices"."providerChannel" already exists
INF/db:setup 21207 [*] Index "users"."adbKeys" is ready
INF/db:setup 21207 [*] Index "accessTokens"."email" is ready
INF/db:setup 21207 [*] Index "vncauth"."response" is ready
INF/db:setup 21207 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 21207 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 21207 [*] Index "devices"."owner" is ready
INF/db:setup 21207 [*] Index "devices"."present" is ready
INF/db:setup 21207 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli provider --name ashishs-mini.corp.adobe.com --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip 10.41.17.66 --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://10.41.17.66:7100/"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://10.41.17.66:7100/auth/mock/ --websocket-url http://10.41.17.66:7110/"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-temp --port 7102"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 21205 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"


INF/triproxy 21209 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 21209 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 21209 [dev001] PULL socket bound on tcp://127.0.0.1:7116


INF/triproxy 21208 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 21208 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 21208 [app001] PULL socket bound on tcp://127.0.0.1:7113

INF/poorxy 21221 [*] Listening on port 7100
INF/db 21210 [*] Connecting to 127.0.0.1:28015
INF/db 21211 [*] Connecting to 127.0.0.1:28015
INF/processor 21210 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 21210 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/reaper 21212 [reaper001] Subscribing to permanent channel "*ALL"
INF/processor 21211 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 21211 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/reaper 21212 [reaper001] Reaping devices with no heartbeat
INF/db 21212 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 21212 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 21212 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/storage:plugins:image 21219 [*] Listening on port 7103
INF/provider 21213 [*] Subscribing to permanent channel "uxR8y5OkRXaoA5PvhAmuvg=="
INF/provider 21213 [*] Sending output to "tcp://127.0.0.1:7116"
INF/auth-mock 21214 [*] Listening on port 7120
INF/provider 21213 [*] Receiving input from "tcp://127.0.0.1:7114"
INF/provider 21213 [*] Tracking devices
INF/provider 21213 [*] Found device "ZY2246762T" (device)
INF/storage:plugins:apk 21220 [*] Listening on port 7104
INF/provider 21213 [*] Registered device "ZY2246762T"
INF/reaper 21212 [reaper001] Device "ZY2246762T" is present
INF/storage:temp 21218 [*] Listening on port 7102
INF/app 21215 [*] Using pre-built resources
INF/app 21215 [*] Listening on port 7105
INF/db 21215 [*] Connecting to 127.0.0.1:28015
INF/websocket 21217 [*] Subscribing to permanent channel "*ALL"
INF/websocket 21217 [*] Listening on port 7110
INF/db 21217 [*] Connecting to 127.0.0.1:28015
INF/websocket 21217 [*] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 21217 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/device:support:push 21222 [ZY2246762T] Sending output to "tcp://127.0.0.1:7116"
INF/device 21222 [ZY2246762T] Preparing device
INF/api 21216 [*] Subscribing to permanent channel "*ALL"
INF/api 21216 [*] Listening on port 7106
INF/api 21216 [*] Sending output to "tcp://127.0.0.1:7113"
INF/api 21216 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/device:support:sub 21222 [ZY2246762T] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 21222 [ZY2246762T] Subscribing to permanent channel "*ALL"
INF/device:support:properties 21222 [ZY2246762T] Loading properties
INF/device:support:sdk 21222 [ZY2246762T] Supports SDK 25
INF/device:support:abi 21222 [ZY2246762T] Supports ABIs armeabi-v7a, armeabi
INF/db 21216 [*] Connecting to 127.0.0.1:28015
INF/device:resources:minicap 21222 [ZY2246762T] Installing "/usr/local/lib/node_modules/stf/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 21222 [ZY2246762T] Installing "/usr/local/lib/node_modules/stf/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-25/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 21222 [ZY2246762T] Checking whether we need to install STFService
INF/device:resources:service 21222 [ZY2246762T] Running version check
INF/device:resources:service 21222 [ZY2246762T] STFService up to date
INF/device:plugins:service 21222 [ZY2246762T] Launching agent
INF/device:plugins:service 21222 [ZY2246762T] Agent says: "Listening on @stfagent"
INF/device:plugins:service 21222 [ZY2246762T] Launching service
INF/device:plugins:service 21222 [ZY2246762T] Agent says: "InputClient started"
INF/device:plugins:display 21222 [ZY2246762T] Reading display info
INF/device:plugins:phone 21222 [ZY2246762T] Fetching phone info
INF/device:plugins:identity 21222 [ZY2246762T] Solving identity
INF/device:plugins:solo 21222 [ZY2246762T] Subscribing to permanent channel "/MVeQaMK50KlQy8gRUv7CFbFSaU="
INF/device:plugins:screen:stream 21222 [ZY2246762T] Starting WebSocket server on port 7400
INF/device:resources:minitouch 21222 [ZY2246762T] Installing "/usr/local/lib/node_modules/stf/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
WRN/device:plugins:data 21222 [ZY2246762T] Unable to find device data { serial: 'ZY2246762T',
  platform: 'Android',
  manufacturer: 'MOTOROLA',
  operator: ',',
  model: 'Moto Z2 Play',
  version: '7.1.1',
  abi: 'armeabi-v7a',
  sdk: '25',
  product: 'albus',
  display: 
   { id: 0,
     width: 1080,
     height: 1920,
     xdpi: 403.4110107421875,
     ydpi: 403.0409851074219,
     fps: 60.000003814697266,
     density: 3,
     rotation: 0,
     secure: true,
     size: 5.464510452525597,
     url: 'ws://10.41.17.66:7400' },
  phone: { imei: '358225070872339', network: 'UNKNOWN' } }
INF/device:plugins:touch 21222 [ZY2246762T] Touch origin is top left
INF/device:plugins:touch 21222 [ZY2246762T] Requesting touch consumer to start
INF/device:plugins:touch 21222 [ZY2246762T] Launching screen service
INF/device:plugins:touch 21222 [ZY2246762T] Connecting to minitouch service
INF/device:plugins:touch 21222 [ZY2246762T] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
INF/device:plugins:touch 21222 [ZY2246762T] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 21222 [ZY2246762T] minitouch says: "Type B touch device synaptics_dsx_i2c (1079x1919 with 10 contacts) detected on /dev/input/event1 (score 2109)"
INF/device:plugins:touch 21222 [ZY2246762T] Reading minitouch banner
INF/device:plugins:touch 21222 [ZY2246762T] minitouch says: "Connection established"
INF/device:plugins:vnc 21222 [ZY2246762T] Starting VNC server on port 7402
INF/device:plugins:browser 21222 [ZY2246762T] Loading browser list
INF/device:plugins:browser 21222 [ZY2246762T] Updating browser list
INF/device:plugins:mute 21222 [ZY2246762T] Will not mute master volume during use
INF/device:resources:minirev 21222 [ZY2246762T] Installing "/usr/local/lib/node_modules/stf/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 21222 [ZY2246762T] Launching reverse port forwarding service
INF/device:plugins:forward 21222 [ZY2246762T] Connecting to reverse port forwarding service
INF/device:plugins:connect 21222 [ZY2246762T] Listening on port 7401
INF/device 21222 [ZY2246762T] Fully operational












INF/provider 21213 [*] Providing all 1 device(s)
IMP/device:plugins:group 21222 [ZY2246762T] Now owned by "gchauhan.blr@gmail.com"
INF/device:plugins:group 21222 [ZY2246762T] Subscribing to group channel "LFvAvugVThSq9q2NGwuYww=="
INF/device:plugins:screen:stream 21222 [ZY2246762T] Setting frame producer projection to 446x1154
INF/device:plugins:screen:stream 21222 [ZY2246762T] Requesting frame producer to start
INF/device:plugins:screen:stream 21222 [ZY2246762T] Launching screen service
IMP/device:plugins:connect 21222 [ZY2246762T] Remote Connect Started for device "ZY2246762T" at "10.41.17.66:7401"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "PID: 27768"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: Using projection 1080x1920@446x793/0"
INF/device:plugins:screen:stream 21222 [ZY2246762T] Connecting to minicap service
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:241) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:244) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:251) Creating virtual display"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:257) Creating buffer queue"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:262) Creating CPU consumer"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:266) Creating frame waiter"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:270) Publishing virtual display"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:287) Found 7.1 Developer Preview SurfaceComposerClient::setDisplaySurface"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 6268932 bytes for JPG encoder"
INF/device:plugins:screen:stream 21222 [ZY2246762T] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
INF/device:plugins:screen:stream 21222 [ZY2246762T] Reading minicap banner
INF/device:plugins:connect 21222 [ZY2246762T] New remote ADB connection from ::ffff:10.43.100.201





$ adb connect 10.41.17.66:7401
connected to 10.41.17.66:7401

$ adb devices -l
List of devices attached
10.41.17.66:7401	device product:albus model:Moto_Z2_Play device:albus

$ adb -s 10.41.17.66:7401 shell ls
error: unknown host service
  $ DEBUG=adb* stf local --public-ip 10.41.17.66
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
INF/db 21530 [*] Connecting to 127.0.0.1:28015
INF/db:setup 21530 [*] Database "stf" already exists
INF/db:setup 21530 [*] Table "users" already exists
INF/db:setup 21530 [*] Table "accessTokens" already exists
INF/db:setup 21530 [*] Table "vncauth" already exists
INF/db:setup 21530 [*] Table "devices" already exists
INF/db:setup 21530 [*] Table "logs" already exists
INF/db:setup 21530 [*] Index "users"."adbKeys" already exists
INF/db:setup 21530 [*] Index "accessTokens"."email" already exists
INF/db:setup 21530 [*] Index "vncauth"."response" already exists
INF/db:setup 21530 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 21530 [*] Index "devices"."owner" already exists
INF/db:setup 21530 [*] Index "devices"."present" already exists
INF/db:setup 21530 [*] Waiting for index "users"."adbKeys"
INF/db:setup 21530 [*] Waiting for index "accessTokens"."email"
INF/db:setup 21530 [*] Waiting for index "vncauth"."response"
INF/db:setup 21530 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 21530 [*] Waiting for index "devices"."owner"
INF/db:setup 21530 [*] Waiting for index "devices"."present"
INF/db:setup 21530 [*] Index "devices"."providerChannel" already exists
INF/db:setup 21530 [*] Index "users"."adbKeys" is ready
INF/db:setup 21530 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 21530 [*] Index "accessTokens"."email" is ready
INF/db:setup 21530 [*] Index "vncauth"."response" is ready
INF/db:setup 21530 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 21530 [*] Index "devices"."owner" is ready
INF/db:setup 21530 [*] Index "devices"."present" is ready
INF/db:setup 21530 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli provider --name ashishs-mini.corp.adobe.com --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip 10.41.17.66 --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://10.41.17.66:7100/"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://10.41.17.66:7100/auth/mock/ --websocket-url http://10.41.17.66:7110/"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-temp --port 7102"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 21529 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"




INF/triproxy 21531 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 21531 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 21531 [app001] PULL socket bound on tcp://127.0.0.1:7113

INF/triproxy 21532 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 21532 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 21532 [dev001] PULL socket bound on tcp://127.0.0.1:7116


INF/db 21534 [*] Connecting to 127.0.0.1:28015
INF/db 21533 [*] Connecting to 127.0.0.1:28015
INF/processor 21534 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 21534 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/poorxy 21544 [*] Listening on port 7100
INF/reaper 21535 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 21535 [reaper001] Reaping devices with no heartbeat
INF/processor 21533 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 21533 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/db 21535 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 21535 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 21535 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/storage:plugins:image 21542 [*] Listening on port 7103
INF/auth-mock 21537 [*] Listening on port 7120
INF/provider 21536 [*] Subscribing to permanent channel "8/CsgxUKS6y62f3Ng/sAEA=="
INF/provider 21536 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 21536 [*] Receiving input from "tcp://127.0.0.1:7114"
  adb:command Send '0012host:track-devices' +0ms
INF/provider 21536 [*] Tracking devices
INF/provider 21536 [*] Found device "ZY2246762T" (device)
INF/storage:plugins:apk 21543 [*] Listening on port 7104
INF/provider 21536 [*] Registered device "ZY2246762T"
INF/reaper 21535 [reaper001] Device "ZY2246762T" is present
INF/storage:temp 21541 [*] Listening on port 7102
INF/app 21538 [*] Using pre-built resources
INF/app 21538 [*] Listening on port 7105
INF/db 21538 [*] Connecting to 127.0.0.1:28015
INF/websocket 21540 [*] Subscribing to permanent channel "*ALL"
INF/websocket 21540 [*] Listening on port 7110
INF/db 21540 [*] Connecting to 127.0.0.1:28015
INF/websocket 21540 [*] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 21540 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/device:support:push 21547 [ZY2246762T] Sending output to "tcp://127.0.0.1:7116"
INF/device 21547 [ZY2246762T] Preparing device
INF/api 21539 [*] Subscribing to permanent channel "*ALL"
INF/api 21539 [*] Listening on port 7106
INF/api 21539 [*] Sending output to "tcp://127.0.0.1:7113"
INF/api 21539 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/db 21539 [*] Connecting to 127.0.0.1:28015
INF/device:support:sub 21547 [ZY2246762T] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 21547 [ZY2246762T] Subscribing to permanent channel "*ALL"
  adb:command Send '0019host:transport:ZY2246762T' +0ms
  adb:command Send '0044shell:while getprop sys.boot_completed 2>/dev/null; do sleep 1; done' +3ms
INF/device:support:properties 21547 [ZY2246762T] Loading properties
  adb:command Send '0019host:transport:ZY2246762T' +60ms
  adb:command Send '000Dshell:getprop' +1ms
INF/device:support:sdk 21547 [ZY2246762T] Supports SDK 25
INF/device:support:abi 21547 [ZY2246762T] Supports ABIs armeabi-v7a, armeabi
  adb:command Send '0019host:transport:ZY2246762T' +45ms
  adb:command Send '000Ashell:'ps'' +1ms
INF/device:resources:minicap 21547 [ZY2246762T] Installing "/usr/local/lib/node_modules/stf/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 21547 [ZY2246762T] Installing "/usr/local/lib/node_modules/stf/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-25/minicap.so" as "/data/local/tmp/minicap.so"
  adb:command Send '0019host:transport:ZY2246762T' +96ms
  adb:command Send '0019host:transport:ZY2246762T' +2ms
  adb:command Send '0024shell:'rm' '/data/local/tmp/minicap'' +0ms
  adb:command Send '0027shell:'rm' '/data/local/tmp/minicap.so'' +3ms
  adb:command Send '0019host:transport:ZY2246762T' +30ms
  adb:command Send '0019host:transport:ZY2246762T' +0ms
  adb:command Send '0005sync:' +1ms
  adb:command Send '0005sync:' +0ms
  adb:sync SEND /data/local/tmp/minicap,33261 +4ms
  adb:sync SEND /data/local/tmp/minicap.so,33261 +4ms
  adb:sync DONE +5ms
  adb:sync DONE +1ms
  adb:command Send '0019host:transport:ZY2246762T' +10ms
  adb:command Send '0005sync:' +1ms
  adb:sync STAT /data/local/tmp/minicap.so +11ms
  adb:command Send '0019host:transport:ZY2246762T' +1ms
  adb:command Send '0005sync:' +0ms
  adb:sync STAT /data/local/tmp/minicap +4ms
INF/device:resources:service 21547 [ZY2246762T] Checking whether we need to install STFService
  adb:command Send '0019host:transport:ZY2246762T' +15ms
  adb:command Send '0028shell:'pm' 'path' 'jp.co.cyberagent.stf'' +1ms
INF/device:resources:service 21547 [ZY2246762T] Running version check
  adb:command Send '0019host:transport:ZY2246762T' +757ms
  adb:command Send '0093shell:export CLASSPATH='/data/app/jp.co.cyberagent.stf-1/base.apk'; exec app_process /system/bin 'jp.co.cyberagent.stf.Agent' --version 2>/dev/null' +2ms
INF/device:resources:service 21547 [ZY2246762T] STFService up to date
INF/device:plugins:service 21547 [ZY2246762T] Launching agent
  adb:command Send '0019host:transport:ZY2246762T' +761ms
  adb:command Send '000Ashell:'ps'' +0ms
  adb:command Send '0019host:transport:ZY2246762T' +89ms
  adb:command Send '0016localabstract:stfagent' +2ms
  adb:command Send '0019host:transport:ZY2246762T' +4ms
  adb:command Send '007Dshell:export CLASSPATH='/data/app/jp.co.cyberagent.stf-1/base.apk'; exec app_process /system/bin 'jp.co.cyberagent.stf.Agent'' +1ms
  adb:command Send '0019host:transport:ZY2246762T' +4ms
  adb:command Send '0016localabstract:stfagent' +0ms
  adb:command Send '0019host:transport:ZY2246762T' +108ms
  adb:command Send '0016localabstract:stfagent' +0ms
  adb:command Send '0019host:transport:ZY2246762T' +108ms
  adb:command Send '0016localabstract:stfagent' +1ms
  adb:command Send '0019host:transport:ZY2246762T' +102ms
  adb:command Send '0016localabstract:stfagent' +1ms
  adb:command Send '0019host:transport:ZY2246762T' +104ms
  adb:command Send '0016localabstract:stfagent' +0ms
  adb:command Send '0019host:transport:ZY2246762T' +102ms
  adb:command Send '0016localabstract:stfagent' +1ms
  adb:command Send '0019host:transport:ZY2246762T' +108ms
  adb:command Send '0016localabstract:stfagent' +1ms
INF/device:plugins:service 21547 [ZY2246762T] Agent says: "Listening on @stfagent"
  adb:command Send '0019host:transport:ZY2246762T' +106ms
  adb:command Send '0016localabstract:stfagent' +1ms
INF/device:plugins:service 21547 [ZY2246762T] Launching service
INF/device:plugins:service 21547 [ZY2246762T] Agent says: "InputClient started"
  adb:command Send '0019host:transport:ZY2246762T' +5ms
  adb:command Send '0068shell:am startservice --user 0 -a 'jp.co.cyberagent.stf.ACTION_START' -n 'jp.co.cyberagent.stf/.Service'' +5ms
  adb:command Send '0019host:transport:ZY2246762T' +710ms
  adb:command Send '0018localabstract:stfservice' +1ms
INF/device:plugins:display 21547 [ZY2246762T] Reading display info
INF/device:plugins:phone 21547 [ZY2246762T] Fetching phone info
INF/device:plugins:identity 21547 [ZY2246762T] Solving identity
INF/device:plugins:solo 21547 [ZY2246762T] Subscribing to permanent channel "/MVeQaMK50KlQy8gRUv7CFbFSaU="
INF/device:plugins:screen:stream 21547 [ZY2246762T] Starting WebSocket server on port 7400
  adb:command Send '0019host:transport:ZY2246762T' +64ms
  adb:command Send '000Ashell:'ps'' +0ms
INF/device:resources:minitouch 21547 [ZY2246762T] Installing "/usr/local/lib/node_modules/stf/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
  adb:command Send '0019host:transport:ZY2246762T' +86ms
  adb:command Send '0026shell:'rm' '/data/local/tmp/minitouch'' +0ms
  adb:command Send '0019host:transport:ZY2246762T' +29ms
  adb:command Send '0005sync:' +0ms
  adb:sync SEND /data/local/tmp/minitouch,33261 +1ms
  adb:sync DONE +1ms
  adb:command Send '0019host:transport:ZY2246762T' +6ms
  adb:command Send '0005sync:' +0ms
  adb:sync STAT /data/local/tmp/minitouch +1ms
WRN/device:plugins:data 21547 [ZY2246762T] Unable to find device data { serial: 'ZY2246762T',
  platform: 'Android',
  manufacturer: 'MOTOROLA',
  operator: ',',
  model: 'Moto Z2 Play',
  version: '7.1.1',
  abi: 'armeabi-v7a',
  sdk: '25',
  product: 'albus',
  display: 
   { id: 0,
     width: 1080,
     height: 1920,
     xdpi: 403.4110107421875,
     ydpi: 403.0409851074219,
     fps: 60.000003814697266,
     density: 3,
     rotation: 0,
     secure: true,
     size: 5.464510452525597,
     url: 'ws://10.41.17.66:7400' },
  phone: { imei: '358225070872339', network: 'UNKNOWN' } }
INF/device:plugins:touch 21547 [ZY2246762T] Touch origin is top left
INF/device:plugins:touch 21547 [ZY2246762T] Requesting touch consumer to start
INF/device:plugins:touch 21547 [ZY2246762T] Launching screen service
  adb:command Send '0019host:transport:ZY2246762T' +18ms
  adb:command Send '0024shell:exec /data/local/tmp/minitouch' +0ms
INF/device:plugins:touch 21547 [ZY2246762T] Connecting to minitouch service
  adb:command Send '0019host:transport:ZY2246762T' +7ms
  adb:command Send '0017localabstract:minitouch' +2ms
  adb:command Send '0019host:transport:ZY2246762T' +108ms
  adb:command Send '0017localabstract:minitouch' +0ms
INF/device:plugins:touch 21547 [ZY2246762T] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
INF/device:plugins:touch 21547 [ZY2246762T] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
  adb:command Send '0019host:transport:ZY2246762T' +204ms
  adb:command Send '0017localabstract:minitouch' +0ms
INF/device:plugins:touch 21547 [ZY2246762T] minitouch says: "Type B touch device synaptics_dsx_i2c (1079x1919 with 10 contacts) detected on /dev/input/event1 (score 2109)"
  adb:command Send '0019host:transport:ZY2246762T' +406ms
  adb:command Send '0017localabstract:minitouch' +1ms
INF/device:plugins:touch 21547 [ZY2246762T] Reading minitouch banner
INF/device:plugins:touch 21547 [ZY2246762T] minitouch says: "Connection established"
INF/device:plugins:vnc 21547 [ZY2246762T] Starting VNC server on port 7402
INF/device:plugins:browser 21547 [ZY2246762T] Loading browser list
INF/device:plugins:browser 21547 [ZY2246762T] Updating browser list
INF/device:plugins:mute 21547 [ZY2246762T] Will not mute master volume during use
  adb:command Send '0019host:transport:ZY2246762T' +31ms
  adb:command Send '000Ashell:'ps'' +0ms
INF/device:resources:minirev 21547 [ZY2246762T] Installing "/usr/local/lib/node_modules/stf/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
  adb:command Send '0019host:transport:ZY2246762T' +96ms
  adb:command Send '0024shell:'rm' '/data/local/tmp/minirev'' +1ms
  adb:command Send '0019host:transport:ZY2246762T' +28ms
  adb:command Send '0005sync:' +1ms
  adb:sync SEND /data/local/tmp/minirev,33261 +1ms
  adb:sync DONE +2ms
  adb:command Send '0019host:transport:ZY2246762T' +6ms
  adb:command Send '0005sync:' +0ms
  adb:sync STAT /data/local/tmp/minirev +1ms
INF/device:plugins:forward 21547 [ZY2246762T] Launching reverse port forwarding service
  adb:command Send '0019host:transport:ZY2246762T' +5ms
  adb:command Send '0026shell:'exec' '/data/local/tmp/minirev'' +1ms
INF/device:plugins:forward 21547 [ZY2246762T] Connecting to reverse port forwarding service
  adb:command Send '0019host:transport:ZY2246762T' +6ms
  adb:command Send '0015localabstract:minirev' +0ms
  adb:command Send '0019host:transport:ZY2246762T' +107ms
  adb:command Send '0015localabstract:minirev' +0ms
  adb:command Send '0019host:transport:ZY2246762T' +3ms
  adb:command Send '0022shell:pm list packages 2>/dev/null' +1ms
INF/device:plugins:connect 21547 [ZY2246762T] Listening on port 7401
INF/device 21547 [ZY2246762T] Fully operational
INF/provider 21536 [*] Providing all 1 device(s)








IMP/device:plugins:group 21547 [ZY2246762T] Now owned by "gchauhan.blr@gmail.com"
INF/device:plugins:group 21547 [ZY2246762T] Subscribing to group channel "LFvAvugVThSq9q2NGwuYww=="
INF/device:plugins:screen:stream 21547 [ZY2246762T] Setting frame producer projection to 446x1154
INF/device:plugins:screen:stream 21547 [ZY2246762T] Requesting frame producer to start
INF/device:plugins:screen:stream 21547 [ZY2246762T] Launching screen service
  adb:command Send '0019host:transport:ZY2246762T' +21s
  adb:command Send '0063shell:LD_LIBRARY_PATH=/data/local/tmp exec /data/local/tmp/minicap -S -Q 80 -P 1080x1920@446x1154/0' +2ms
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "PID: 28553"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: Using projection 1080x1920@446x793/0"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:241) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:244) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:251) Creating virtual display"
INF/device:plugins:screen:stream 21547 [ZY2246762T] Connecting to minicap service
  adb:command Send '0019host:transport:ZY2246762T' +89ms
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:257) Creating buffer queue"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:262) Creating CPU consumer"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:266) Creating frame waiter"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:270) Publishing virtual display"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:287) Found 7.1 Developer Preview SurfaceComposerClient::setDisplaySurface"
  adb:command Send '0015localabstract:minicap' +9ms
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 6268932 bytes for JPG encoder"
INF/device:plugins:screen:stream 21547 [ZY2246762T] Reading minicap banner
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
IMP/device:plugins:connect 21547 [ZY2246762T] Remote Connect Started for device "ZY2246762T" at "10.41.17.66:7401"
INF/device:plugins:connect 21547 [ZY2246762T] New remote ADB connection from ::ffff:10.43.100.201
  adb:tcpusb:socket I:A_CNXN Packet {
  command: 1314410051,
  arg0: 16777216,
  arg1: 262144,
  length: 35,
  check: 3388,
  magic: 2980557244,
  data: <Buffer 68 6f 73 74 3a 3a 66 65 61 74 75 72 65 73 3d 63 6d 64 2c 73 74 61 74 5f 76 32 2c 73 68 65 6c 6c 5f 76 32> } +9s
  adb:tcpusb:socket Created challenge '+IQmfhjFkSIn7M73l9LO6AbKrTQ=' +4ms
  adb:tcpusb:socket O:A_AUTH +1ms
  adb:tcpusb:socket I:A_AUTH Packet {
  command: 1213486401,
  arg0: 2,
  arg1: 0,
  length: 256,
  check: 32954,
  magic: 3081480894,
  data: <Buffer 00 f6 f3 72 85 63 ed 72 fc c8 25 03 4c 76 21 7f a7 3b 88 82 90 16 92 4d 18 05 9e 33 2f e2 38 3b 70 39 8c 96 c1 88 a1 66 03 ee 85 92 57 a1 19 d3 a0 ae ... > } +13ms
  adb:tcpusb:socket Received signature 'APbzcoVj7XL8yCUDTHYhf6c7iIKQFpJNGAWeMy/iODtwOYyWwYihZgPuhZJXoRnToK7UEqW6uVzWpFC3fZdGfRSANqw0jBmVFmAOw5JtOkNGvnTCRjnd4fZhCkyaKeLfagPzbLDTjPyTrCK1UlEzzhZAGus0o/WBhmZUf+0SO4AhnEQ/w3wxWu/qhLjF1EWLkKcTHXotrmDa5RJb/7e6xHX2IsMhiG4rmXm9cpg9avZwZrR8VX22OKJ9rXpJ0ZXzsQWhZleiTx7uzpQXLuwfljW8+VhrYicu2xCWMudVv46XWN/qOJ6IxnD2zJjtf5/aq+Jv9LSBERtpzqIQ1FzpTg==' +0ms
  adb:tcpusb:socket O:A_AUTH +0ms
  adb:tcpusb:socket I:A_AUTH Packet {
  command: 1213486401,
  arg0: 3,
  arg1: 0,
  length: 726,
  check: 62379,
  magic: 3081480894,
  data: <Buffer 51 41 41 41 41 4d 6b 73 55 49 61 48 55 6d 41 69 74 65 4f 53 31 2f 48 53 56 6e 38 58 4f 66 75 38 75 4a 75 39 51 6c 78 4d 43 51 5a 76 32 4c 4f 5a 2f 7a ... > } +3ms
  adb:tcpusb:socket Received RSA public key 'UUFBQUFNa3NVSWFIVW1BaXRlT1MxL0hTVm44WE9mdTh1SnU5UWx4TUNRWnYyTE9aL3pOa0E2R1RwNGkxRy9Yb2FrWkNXM25RRjRmcnpCWEE0dTl1SjVadTFoUGwxWnNRbHZrUjJLSGFXSEFUOTN1TWhnRFEyWmpvNklUNEJkQTRTaVZsaVdXTW9iaUt6TEdBMmR6cFZnQ3RkM2NxTW8rY0NmSGp6YjNXTWFTWTNLMVFtbG9vcDBYUFIxLysraDlPa29OSEduRVpCWmpRbDlCYkI3bk1CMmtHSTFUcC9qbExMSlpGSmR0eXF0aEZXc1Q0ZGV5S1BLZkNhdXVmYmJZWTV5U2pzZ3Fydnh6NVdQRDBnV1ZJUE1qUkRsSlBQNHlQQkdyV0JwMXdKYzY2VFk4blZwVkRHZzRBS3lsTDhTOEs4T1Irb0ROQnd0SzVxTEhkcGQ0bXF0YmhGYkhodWRYaXhFQlNKL3cvWWgyaUxrU2c0QjVUQUZkbGtjMkR6dTNzS0M4NkQ1TCt5akRFS2xJN0hDZlFIeGZ4RlNnRnVyVXpha2h5TS8rRVYzK3BTNVVtN0xGQlNyL2FkMkF3dGtZOUZMLytYUEZwc2hVYmhHNHNHZ3lvc3ZJdnlxdVhER2FFK2JiU3NWN3RLMEZPZXFPNHpEYm9jb3Z1RVR4TXJnelhKanZyblFBaklwSkhqS1k2U1d4dHpOZ201U3BpeWljeFYxSjRXa09FeFB6b3lpTlV1RVQwZWg2TmVJeEk4bDRkbmFFQ0Fxa3BFYUJzSyt1TDhXZVFvb29oSGpEVG8veURDV1FZcGNaT0F5UFZjM2wwMGYxU2xmWEhiWUdlVEdVb1lsME94bTI5dTAvV1Vlc2N3U3QxY1NHejE2VVpqa0hvSURKbjFDd0RjQzlJK3JMa1diMVk0QUVBQVFBPQAgX3VzYm11eGRAZ2FjaGF1aGEtbWFjT1MA' +1ms
  adb:tcpusb:socket Signature verified +23ms
  adb:tcpusb:socket Loading device properties to form a standard device ID +14ms
  adb:command Send '0019host:transport:ZY2246762T' +1ms
  adb:command Send '000Dshell:getprop' +0ms
  adb:tcpusb:socket O:A_CNXN +59ms






INF/device:plugins:screen:stream 21547 [ZY2246762T] Requesting frame producer to stop
INF/device:plugins:screen:stream 21547 [ZY2246762T] Disconnecting from minicap service
INF/device:plugins:screen:stream 21547 [ZY2246762T] Stopping minicap service
INF/device:plugins:screen:stream 21547 [ZY2246762T] Sending SIGTERM to minicap
  adb:command Send '0019host:transport:ZY2246762T' +2m
  adb:command Send '0016shell:'kill' -15 28553' +1ms
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (jni/minicap/minicap.cpp:197) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (jni/minicap/minicap.cpp:516) Closing client connection"
INF/device:plugins:screen:stream 21547 [ZY2246762T] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:308) Destroying virtual display"

$ adb connect 10.41.17.66:7401
connected to 10.41.17.66:7401
$ adb devices -l
List of devices attached
10.41.17.66:7401	device product:albus model:Moto_Z2_Play device:albus

$ adb -s 10.41.17.66:7401 shell ls
error: unknown host service

 hi sorccu,
any clue about this issue Thanks buddy. which machine do you recommend.I have a Mac mini for now. Hi Sorccu,
it worked on other machine. Not sure what went wrong with this one. I will revisit it later.
Thanks for your help!!! 
Cheers,
Gaurav
  Is there any consideration for audio synchronization  on stf ?
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 Thanks for your reply，but my STF service have no way  connect with the Android Machine ..  Where to use  "allow-remote"?  Adds option to control screen resetting when user releases device. Resolves #722. +1 for this feature please. I also have a use case where I need the device left in the same state after automation Yes, my editors and IDEs actively fight me with this formatting. Sorry for overlooking that.

PS. Could you, please, take a look at #778 as well? No problem and thank you for your work!  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
Yes, Using STF v3.1.0 from npm

**What is the issue or idea you have?**
Samsung devices will be lost and offline after no one use for a long time(e.g. 24hours). Re-plug out and in, they work again.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
Occured on all Samsung devices(Galaxy A7, Note 2, G900F) I owned.

**Please provide the steps to reproduce the issue.**
currently I used 2 Plugable USB 2.0  7 ports with 60W power adapter hubs(the recommended one) connecting ~10 devices. I installed STF to V3.1.0 several days ago. What I found now is all samsung devices will be lost and offline if it keeps available for a long time(e.g one day). Others devices(Sony, Nexus, HUAWEI) work well. 

**What is the expected behavior?**
should not be lost automatically.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
INF/device:plugins:screen:stream 57602 [YT9118F9ND] minicap says: "INFO: (external/MY_minicap/src/minicap_23.cpp:284) Destroying virtual display"
INF/provider 58892 [*] Lost device "75ecccbf" (device)
INF/provider 58892 [*] Shutting down device worker "75ecccbf"
INF/provider 58892 [*] Cleaning up device worker "75ecccbf"
INF/provider 58892 [*] Gracefully killing device worker "75ecccbf"
IMP/device:plugins:service 34069 [75ecccbf] Agent connection ended, attempting to relaunch
INF/device:plugins:service 34069 [75ecccbf] Launching service
IMP/device:plugins:service 34069 [75ecccbf] Service connection ended, attempting to relaunch
INF/device:plugins:service 34069 [75ecccbf] Launching service
WRN/device:plugins:touch 34069 [75ecccbf] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 34069 [75ecccbf] Disconnecting from minitouch service
FTL/util:lifecycle 34069 [75ecccbf] Forward shell ended; we shall share its fate
FTL/util:lifecycle 34069 [75ecccbf] Shutting down due to fatal error
INF/provider 58892 [*] Device worker "75ecccbf" has retired
INF/provider 58892 [*] Providing all 7 device(s)

**Please run `stf doctor` and paste the output here.**
11:13:50 $ stf doctor
INF/cli:doctor 83430 [*] OS Arch: x64
INF/cli:doctor 83430 [*] OS Platform: darwin
INF/cli:doctor 83430 [*] OS Platform: 15.6.0
INF/cli:doctor 83430 [*] Using Node 8.4.0
INF/cli:doctor 83430 [*] Using ZeroMQ 4.2.2
INF/cli:doctor 83430 [*] Using RethinkDB 2.3.6
INF/cli:doctor 83430 [*] Using ADB 1.0.39
INF/cli:doctor 83430 [*] Using GraphicsMagick 1.3.26
INF/cli:doctor 83430 [*] Using ProtoBuf 3.4.0 More logs before and after:

INF/provider 58892 [*] Providing all 8 device(s)
INF/device:support:channels 43235 [0123456789ABCDEF] Channel "+RH+H9enQ2a5eOfeyzzMtQ==" timed out
IMP/device:plugins:group 43235 [0123456789ABCDEF] No longer owned by "jon@xx.com"
INF/device:plugins:group 43235 [0123456789ABCDEF] Unsubscribing from group channel "+RH+H9enQ2a5eOfeyzzMtQ=="
INF/device:support:channels 34620 [5ada595d] Channel "+RH+H9enQ2a5eOfeyzzMtQ==" timed out
IMP/device:plugins:group 34620 [5ada595d] No longer owned by "jon@xx.com"
INF/device:plugins:group 34620 [5ada595d] Unsubscribing from group channel "+RH+H9enQ2a5eOfeyzzMtQ=="
INF/device:support:channels 57602 [YT9118F9ND] Channel "+RH+H9enQ2a5eOfeyzzMtQ==" timed out
IMP/device:plugins:group 57602 [YT9118F9ND] No longer owned by "jon@xx.com"
INF/device:plugins:group 57602 [YT9118F9ND] Unsubscribing from group channel "+RH+H9enQ2a5eOfeyzzMtQ=="
INF/device:plugins:screen:stream 57602 [YT9118F9ND] Requesting frame producer to stop
INF/device:plugins:screen:stream 57602 [YT9118F9ND] Disconnecting from minicap service
INF/device:plugins:screen:stream 57602 [YT9118F9ND] Stopping minicap service
INF/device:plugins:screen:stream 57602 [YT9118F9ND] Sending SIGTERM to minicap
INF/device:plugins:screen:stream 57602 [YT9118F9ND] minicap says: "INFO: (jni/minicap/minicap.cpp:197) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 57602 [YT9118F9ND] minicap says: "INFO: (jni/minicap/minicap.cpp:516) Closing client connection"
INF/device:plugins:screen:stream 57602 [YT9118F9ND] minicap says: "INFO: (external/MY_minicap/src/minicap_23.cpp:284) Destroying virtual display"
INF/provider 58892 [*] Lost device "75ecccbf" (device)
INF/provider 58892 [*] Shutting down device worker "75ecccbf"
INF/provider 58892 [*] Cleaning up device worker "75ecccbf"
INF/provider 58892 [*] Gracefully killing device worker "75ecccbf"
IMP/device:plugins:service 34069 [75ecccbf] Agent connection ended, attempting to relaunch
INF/device:plugins:service 34069 [75ecccbf] Launching service
IMP/device:plugins:service 34069 [75ecccbf] Service connection ended, attempting to relaunch
INF/device:plugins:service 34069 [75ecccbf] Launching service
WRN/device:plugins:touch 34069 [75ecccbf] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 34069 [75ecccbf] Disconnecting from minitouch service
FTL/util:lifecycle 34069 [75ecccbf] Forward shell ended; we shall share its fate
FTL/util:lifecycle 34069 [75ecccbf] Shutting down due to fatal error
INF/provider 58892 [*] Device worker "75ecccbf" has retired
INF/provider 58892 [*] Providing all 7 device(s)
IMP/device:plugins:service 34620 [5ada595d] Agent connection ended, attempting to relaunch
INF/provider 58892 [*] Lost device "5ada595d" (device)
INF/device:plugins:service 34620 [5ada595d] Launching service
INF/provider 58892 [*] Shutting down device worker "5ada595d"
INF/provider 58892 [*] Cleaning up device worker "5ada595d"
INF/provider 58892 [*] Gracefully killing device worker "5ada595d"
IMP/device:plugins:service 34620 [5ada595d] Service connection ended, attempting to relaunch
INF/device:plugins:service 34620 [5ada595d] Launching service
WRN/device:plugins:touch 34620 [5ada595d] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 34620 [5ada595d] Disconnecting from minitouch service
FTL/util:lifecycle 34620 [5ada595d] Forward shell ended; we shall share its fate
FTL/util:lifecycle 34620 [5ada595d] Shutting down due to fatal error
INF/provider 58892 [*] Device worker "5ada595d" has retired
INF/provider 58892 [*] Providing all 6 device(s)
IMP/device:plugins:group 57602 [YT9118F9ND] Now owned by "jon@xx.com"
INF/device:plugins:group 57602 [YT9118F9ND] Subscribing to group channel "+RH+H9enQ2a5eOfeyzzMtQ=="
INF/device:plugins:screen:stream 57602 [YT9118F9ND] Keeping 692x692 as current frame producer projection
 Thanks @sorccu . But it seems to be a minicap compatibility issue? because on my side only samsung devices have this problems. Currently the STF runs well on the macMini except this issue. Will consider if need to move it to another linux host machine. Actually quite enjoyed the STF v3.1. thanks for the great work! @sorccu Thanks for the suggestion. I will try to test on Linux if it resolves the problem. Currently I have 13 connected devices with two Plugable USB 2.0 7 ports with 60W power adapter hubs.   Yes, on one MacMini. ok, let me try it @sorccu I tried decreasing to 6(one hub connect to only SM-G900F, another connect to 5 other brand devices), the SM-G900 still go offline after one day, while other devices work well. Anyway, i will try to use a linux device  my new huawei mate10 device with  2160x1080 pixels, which  is  a zero bezel huawei product named ALP-AL00 , shows a Non -full screen display on our stf just as my screenshot bellow . and I cannot swipe or click on the screen button either.
BTW: No setting changed after i got my device,except openning USB  debug 
screenshot on stf:
![image](https://user-images.githubusercontent.com/28615244/33362378-2d4121cc-d517-11e7-9d67-01c16989bf7f.png)
 I wanna to konw why this issue happened ?  and how to get full-sceen display? thx ···
run 'adb shell dumpsys window',  I found nothing about mDisplayId
run 'adb shell wm size', it shows just like below:
![image](https://user-images.githubusercontent.com/28615244/33369441-95135654-d52f-11e7-8c24-60d86e2567f6.png)

··· Aha! Here at last, the answer to my question: setting-> Dispaly->Screen resolution, change default setting from FHD to WQHD,then everything goes well on STF !!
![image](https://user-images.githubusercontent.com/28615244/33429297-35b1a4ee-d607-11e7-9916-9ede30d2a708.png)
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
2017-11-29T03:10:46.979Z FTL/cli:local 1571 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:194:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
2017-11-29T03:10:46.979Z INF/cli:local 1571 [*] Shutting down all child processes
2017-11-29T03:10:46.987Z INF/util:lifecycle 1583 [app001] Winding down for graceful exit
2017-11-29T03:10:46.988Z INF/util:lifecycle 1589 [dev001] Winding down for graceful exit
2017-11-29T03:10:46.996Z INF/util:lifecycle 1596 [proc002] Winding down for graceful exit
2017-11-29T03:10:46.996Z INF/util:lifecycle 1608 [*] Winding down for graceful exit
2017-11-29T03:10:46.997Z INF/util:lifecycle 1595 [proc001] Winding down for graceful exit
2017-11-29T03:10:47.001Z INF/util:lifecycle 1614 [*] Winding down for graceful exit
2017-11-29T03:10:47.003Z WRN/db 1595 [proc001] Connection closed
2017-11-29T03:10:47.003Z INF/util:lifecycle 1602 [reaper001] Winding down for graceful exit
2017-11-29T03:10:47.008Z INF/auth-mock 1614 [*] Waiting for client connections to end
2017-11-29T03:10:47.012Z WRN/db 1596 [proc002] Connection closed
2017-11-29T03:10:47.014Z WRN/db 1602 [reaper001] Connection closed
2017-11-29T03:10:47.051Z INF/websocket 1632 [*] Subscribing to permanent channel "*ALL"
2017-11-29T03:10:47.057Z INF/websocket 1632 [*] Listening on port 7110
2017-11-29T03:10:47.058Z INF/util:lifecycle 1632 [*] Winding down for graceful exit
2017-11-29T03:10:47.060Z INF/db 1632 [*] Connecting to 127.0.0.1:28015

**Please run `stf doctor` and paste the output here.**
![wechatimg84](https://user-images.githubusercontent.com/18587194/33356365-0b7f36de-d4f7-11e7-8e7b-1b36d17f4cdf.jpeg)

 2017-11-29T03:29:53.846Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli migrate"
2017-11-29T03:29:54.140Z INF/db 1714 [*] Connecting to 127.0.0.1:28015
2017-11-29T03:29:54.160Z INF/db:setup 1714 [*] Database "stf" already exists
2017-11-29T03:29:54.170Z INF/db:setup 1714 [*] Table "users" already exists
2017-11-29T03:29:54.170Z INF/db:setup 1714 [*] Table "accessTokens" already exists
2017-11-29T03:29:54.170Z INF/db:setup 1714 [*] Table "vncauth" already exists
2017-11-29T03:29:54.171Z INF/db:setup 1714 [*] Table "devices" already exists
2017-11-29T03:29:54.171Z INF/db:setup 1714 [*] Table "logs" already exists
2017-11-29T03:29:54.187Z INF/db:setup 1714 [*] Index "users"."adbKeys" already exists
2017-11-29T03:29:54.187Z INF/db:setup 1714 [*] Index "accessTokens"."email" already exists
2017-11-29T03:29:54.187Z INF/db:setup 1714 [*] Index "vncauth"."response" already exists
2017-11-29T03:29:54.187Z INF/db:setup 1714 [*] Index "vncauth"."responsePerDevice" already exists
2017-11-29T03:29:54.187Z INF/db:setup 1714 [*] Index "devices"."owner" already exists
2017-11-29T03:29:54.187Z INF/db:setup 1714 [*] Index "devices"."present" already exists
2017-11-29T03:29:54.187Z INF/db:setup 1714 [*] Index "devices"."providerChannel" already exists
2017-11-29T03:29:54.188Z INF/db:setup 1714 [*] Waiting for index "users"."adbKeys"
2017-11-29T03:29:54.189Z INF/db:setup 1714 [*] Waiting for index "accessTokens"."email"
2017-11-29T03:29:54.189Z INF/db:setup 1714 [*] Waiting for index "vncauth"."response"
2017-11-29T03:29:54.190Z INF/db:setup 1714 [*] Waiting for index "vncauth"."responsePerDevice"
2017-11-29T03:29:54.190Z INF/db:setup 1714 [*] Waiting for index "devices"."owner"
2017-11-29T03:29:54.190Z INF/db:setup 1714 [*] Waiting for index "devices"."present"
2017-11-29T03:29:54.191Z INF/db:setup 1714 [*] Waiting for index "devices"."providerChannel"
2017-11-29T03:29:54.196Z INF/db:setup 1714 [*] Index "users"."adbKeys" is ready
2017-11-29T03:29:54.196Z INF/db:setup 1714 [*] Index "accessTokens"."email" is ready
2017-11-29T03:29:54.196Z INF/db:setup 1714 [*] Index "vncauth"."response" is ready
2017-11-29T03:29:54.196Z INF/db:setup 1714 [*] Index "vncauth"."responsePerDevice" is ready
2017-11-29T03:29:54.196Z INF/db:setup 1714 [*] Index "devices"."owner" is ready
2017-11-29T03:29:54.196Z INF/db:setup 1714 [*] Index "devices"."present" is ready
2017-11-29T03:29:54.197Z INF/db:setup 1714 [*] Index "devices"."providerChannel" is ready
2017-11-29T03:29:54.205Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
2017-11-29T03:29:54.209Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
2017-11-29T03:29:54.211Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2017-11-29T03:29:54.213Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2017-11-29T03:29:54.222Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
2017-11-29T03:29:54.234Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli provider --name aslanatc --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800 --mute-master never"
2017-11-29T03:29:54.254Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
2017-11-29T03:29:54.274Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
2017-11-29T03:29:54.285Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
2017-11-29T03:29:54.302Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
2017-11-29T03:29:54.318Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-temp --port 7102"
2017-11-29T03:29:54.330Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
2017-11-29T03:29:54.350Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
2017-11-29T03:29:54.378Z INF/util:procutil 1708 [*] Forking "/usr/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
2017-11-29T03:29:55.372Z INF/triproxy 1726 [dev001] PUB socket bound on tcp://127.0.0.1:7114
2017-11-29T03:29:55.386Z INF/triproxy 1726 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
2017-11-29T03:29:55.397Z INF/triproxy 1726 [dev001] PULL socket bound on tcp://127.0.0.1:7116
2017-11-29T03:29:55.682Z INF/triproxy 1720 [app001] PUB socket bound on tcp://127.0.0.1:7111
2017-11-29T03:29:55.706Z INF/triproxy 1720 [app001] DEALER socket bound on tcp://127.0.0.1:7112
2017-11-29T03:29:55.720Z INF/triproxy 1720 [app001] PULL socket bound on tcp://127.0.0.1:7113
2017-11-29T03:29:56.126Z INF/poorxy 1793 [*] Listening on port 7100
2017-11-29T03:29:56.203Z INF/db 1727 [*] Connecting to 127.0.0.1:28015
2017-11-29T03:29:56.264Z INF/db 1738 [*] Connecting to 127.0.0.1:28015
2017-11-29T03:29:56.302Z INF/processor 1727 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
2017-11-29T03:29:56.309Z INF/processor 1727 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
2017-11-29T03:29:56.299Z INF/reaper 1739 [reaper001] Subscribing to permanent channel "*ALL"
2017-11-29T03:29:56.316Z INF/reaper 1739 [reaper001] Reaping devices with no heartbeat
2017-11-29T03:29:56.344Z INF/db 1739 [reaper001] Connecting to 127.0.0.1:28015
2017-11-29T03:29:56.379Z INF/processor 1738 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
2017-11-29T03:29:56.382Z INF/reaper 1739 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
2017-11-29T03:29:56.390Z INF/reaper 1739 [reaper001] Sending output to "tcp://127.0.0.1:7116"
2017-11-29T03:29:56.390Z INF/processor 1738 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
2017-11-29T03:29:56.593Z INF/storage:plugins:image 1781 [*] Listening on port 7103
2017-11-29T03:29:56.649Z INF/auth-mock 1751 [*] Listening on port 7120
2017-11-29T03:29:56.732Z INF/provider 1745 [*] Subscribing to permanent channel "FxB/KFKeT2iWeT4+Pqexzg=="
2017-11-29T03:29:56.760Z INF/storage:plugins:apk 1787 [*] Listening on port 7104
2017-11-29T03:29:56.768Z INF/provider 1745 [*] Sending output to "tcp://127.0.0.1:7116"
2017-11-29T03:29:56.771Z INF/provider 1745 [*] Receiving input from "tcp://127.0.0.1:7114"
2017-11-29T03:29:56.783Z INF/provider 1745 [*] Tracking devices
2017-11-29T03:29:56.929Z INF/storage:temp 1775 [*] Listening on port 7102
2017-11-29T03:29:57.021Z INF/app 1757 [*] Using webpack
/usr/bin/nodejs /usr/lib/node_modules/stf/lib/cli app

Options:
  -h, --help           Show help.                                      [boolean]
  -V, --version        Show version.                                   [boolean]
  --auth-url, -a       URL to the auth unit.                 [string] [required]
  --port, -p           The port to bind to.             [number] [default: 7105]
  --secret, -s         The secret to use for auth JSON Web Tokens. Anyone who
                       knows this token can freely enter the system if they
                       want, so keep it safe.                [string] [required]
  --ssid, -i           The name of the session ID cookie.
                                                      [string] [default: "ssid"]
  --user-profile-url   URL to an external user profile page.            [string]
  --websocket-url, -w  URL to the websocket unit.            [string] [required]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_APP_` (e.g. `STF_APP_AUTH_URL`).

Cannot find module './../../../webpack.config'
2017-11-29T03:29:57.045Z FTL/cli:local 1708 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:194:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
2017-11-29T03:29:57.045Z INF/cli:local 1708 [*] Shutting down all child processes
2017-11-29T03:29:57.050Z INF/util:lifecycle 1720 [app001] Winding down for graceful exit
2017-11-29T03:29:57.050Z INF/util:lifecycle 1726 [dev001] Winding down for graceful exit
2017-11-29T03:29:57.058Z INF/util:lifecycle 1727 [proc001] Winding down for graceful exit
2017-11-29T03:29:57.061Z INF/util:lifecycle 1738 [proc002] Winding down for graceful exit
2017-11-29T03:29:57.064Z WRN/db 1727 [proc001] Connection closed
2017-11-29T03:29:57.065Z INF/util:lifecycle 1745 [*] Winding down for graceful exit
2017-11-29T03:29:57.066Z INF/util:lifecycle 1751 [*] Winding down for graceful exit
2017-11-29T03:29:57.073Z WRN/db 1738 [proc002] Connection closed
2017-11-29T03:29:57.073Z INF/auth-mock 1751 [*] Waiting for client connections to end
2017-11-29T03:29:57.065Z INF/util:lifecycle 1739 [reaper001] Winding down for graceful exit
2017-11-29T03:29:57.080Z WRN/db 1739 [reaper001] Connection closed
2017-11-29T03:29:57.097Z INF/websocket 1769 [*] Subscribing to permanent channel "*ALL"
2017-11-29T03:29:57.102Z INF/websocket 1769 [*] Listening on port 7110
2017-11-29T03:29:57.103Z INF/util:lifecycle 1769 [*] Winding down for graceful exit
2017-11-29T03:29:57.105Z INF/db 1769 [*] Connecting to 127.0.0.1:28015

this is all my log ,please help  look like you don't have `./../../../webpack.config`

so it could be related to #651 or #40. 
i'd suggest to check these two issues for solution and give more information it it doesn't help.
 My problem is similar to #651，If I install webpack by running "sudo npm install webpack", I get the following warnings and the problem of missing webpack.config is still unresolved.

npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@^1.0.0 (node_modules/chokidar/node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.3: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})
npm WARN enoent ENOENT: no such file or directory, open '/home/qiniu/package.json'
npm WARN qiniu No description
npm WARN qiniu No repository field.
npm WARN qiniu No README data
npm WARN qiniu No license field.

but in my device bower and gulp were there
qiniu@aslanatc:~$ bower --version
1.8.2
qiniu@aslanatc:~$ gulp --version
[09:35:38] CLI version 3.9.1

I don't know what's wrong ，please help me ,thanks Yes,i install stf from npm , sudo npm install -g stf.   But,why the log  display " Cannot find module './../../../webpack.config'  " My problem was resolved. I ran **npm install -g stf**  and  sudo chown the directory
everything went well. 
Thanks @sorccu  root@ubuntu:~# stf local
2018-05-23T15:10:48.000Z INF/util:procutil 8099 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
2018-05-23T15:10:48.258Z INF/db 8105 [*] Connecting to 127.0.0.1:28015
2018-05-23T15:10:48.268Z INF/db 8105 [*] Unable to connect to 127.0.0.1:28015
2018-05-23T15:10:48.270Z FTL/db 8105 [*] No hosts left to try
2018-05-23T15:10:48.271Z FTL/util:lifecycle 8105 [*] Shutting down due to fatal error

/usr/local/lib/node_modules/stf/node_modules/bluebird/js/main/promise.js:680
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:182:13)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:225:12)
root@ubuntu:~# stf local
2018-05-23T15:14:12.275Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
2018-05-23T15:14:13.263Z INF/db 17876 [*] Connecting to 127.0.0.1:28015
2018-05-23T15:14:13.378Z INF/db:setup 17876 [*] Database "stf" created
2018-05-23T15:14:14.093Z INF/db:setup 17876 [*] Table "devices" created
2018-05-23T15:14:14.118Z INF/db:setup 17876 [*] Index "devices"."owner" created
2018-05-23T15:14:14.119Z INF/db:setup 17876 [*] Waiting for index "devices"."owner"
2018-05-23T15:14:14.140Z INF/db:setup 17876 [*] Table "users" created
2018-05-23T15:14:14.177Z INF/db:setup 17876 [*] Index "devices"."present" created
2018-05-23T15:14:14.177Z INF/db:setup 17876 [*] Waiting for index "devices"."present"
2018-05-23T15:14:14.183Z INF/db:setup 17876 [*] Table "accessTokens" created
2018-05-23T15:14:14.185Z INF/db:setup 17876 [*] Table "vncauth" created
2018-05-23T15:14:14.188Z INF/db:setup 17876 [*] Table "logs" created
2018-05-23T15:14:14.201Z INF/db:setup 17876 [*] Index "users"."adbKeys" created
2018-05-23T15:14:14.201Z INF/db:setup 17876 [*] Waiting for index "users"."adbKeys"
2018-05-23T15:14:14.251Z INF/db:setup 17876 [*] Index "devices"."owner" is ready
2018-05-23T15:14:14.253Z INF/db:setup 17876 [*] Index "devices"."providerChannel" created
2018-05-23T15:14:14.253Z INF/db:setup 17876 [*] Waiting for index "devices"."providerChannel"
2018-05-23T15:14:14.255Z INF/db:setup 17876 [*] Index "accessTokens"."email" created
2018-05-23T15:14:14.255Z INF/db:setup 17876 [*] Waiting for index "accessTokens"."email"
2018-05-23T15:14:14.269Z INF/db:setup 17876 [*] Index "vncauth"."response" created
2018-05-23T15:14:14.269Z INF/db:setup 17876 [*] Waiting for index "vncauth"."response"
2018-05-23T15:14:14.274Z INF/db:setup 17876 [*] Index "vncauth"."responsePerDevice" created
2018-05-23T15:14:14.274Z INF/db:setup 17876 [*] Waiting for index "vncauth"."responsePerDevice"
2018-05-23T15:14:14.386Z INF/db:setup 17876 [*] Index "devices"."present" is ready
2018-05-23T15:14:14.413Z INF/db:setup 17876 [*] Index "users"."adbKeys" is ready
2018-05-23T15:14:14.449Z INF/db:setup 17876 [*] Index "accessTokens"."email" is ready
2018-05-23T15:14:14.454Z INF/db:setup 17876 [*] Index "vncauth"."response" is ready
2018-05-23T15:14:14.625Z INF/db:setup 17876 [*] Index "devices"."providerChannel" is ready
2018-05-23T15:14:14.657Z INF/db:setup 17876 [*] Index "vncauth"."responsePerDevice" is ready
2018-05-23T15:14:14.671Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
2018-05-23T15:14:14.679Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
2018-05-23T15:14:14.698Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2018-05-23T15:14:14.720Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
2018-05-23T15:14:14.747Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
2018-05-23T15:14:14.773Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli provider --name ubuntu --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800 --mute-master never"
2018-05-23T15:14:14.820Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
2018-05-23T15:14:14.889Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
2018-05-23T15:14:14.911Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
2018-05-23T15:14:14.979Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
2018-05-23T15:14:15.011Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-temp --port 7102"
2018-05-23T15:14:15.099Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
2018-05-23T15:14:15.189Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
2018-05-23T15:14:15.255Z INF/util:procutil 17870 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
/usr/local/lib/node_modules/stf/lib/cli triproxy [name]

Options:
  -h, --help         Show help.                                        [boolean]
  -V, --version      Show version.                                     [boolean]
  --bind-dealer, -d  The address to bind the ZeroMQ DEALER endpoint to.
                                              [string] [default: "tcp://*:7112"]
  --bind-pub, -u     The address to bind the ZeroMQ PUB endpoint to.
                                              [string] [default: "tcp://*:7111"]
  --bind-pull, -p    The address to bind the ZeroMQ PULL endpoint to.
                                              [string] [default: "tcp://*:7113"]
  --name             An easily identifiable name for log output.
                                                    [string] [default: "ubuntu"]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_TRIPROXY_` (e.g. `STF_TRIPROXY_BIND_PUB`).

/usr/local/lib/node_modules/stf/lib/cli triproxy [name]

Options:
  -h, --help         Show help.                                        [boolean]
  -V, --version      Show version.                                     [boolean]
  --bind-dealer, -d  The address to bind the ZeroMQ DEALER endpoint to.
                                              [string] [default: "tcp://*:7112"]
  --bind-pub, -u     The address to bind the ZeroMQ PUB endpoint to.
                                              [string] [default: "tcp://*:7111"]
  --bind-pull, -p    The address to bind the ZeroMQ PULL endpoint to.
                                              [string] [default: "tcp://*:7113"]
  --name             An easily identifiable name for log output.
                                                    [string] [default: "ubuntu"]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_TRIPROXY_` (e.g. `STF_TRIPROXY_BIND_PUB`).

Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/10.0.0/linux/x64/zmq.node
Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/10.0.0/linux/x64/zmq.node
2018-05-23T15:14:29.820Z FTL/cli:local 17870 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:182:13)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:225:12)
2018-05-23T15:14:29.852Z INF/cli:local 17870 [*] Shutting down all child processes
 I need some help ， thank you very much !!! Thank you for your reply, though I have to decide again what the problem is. But I feel that success is in front of me. Thanks again @sorccu   <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Withstf provider command, says "**the device is ignoring**"
In rethinkdb page, the log says "**Someone asked for the nonwhitelisted file "/proxy.pac". If this should be accessible, add it to the static web assets.**"
 By the way, firewall is closed.

**Please provide the steps to reproduce the issue.**
steps:
1. in master computer command:
` rethinkdb`
`stf local --public-ip <masterip> --allow-remote`
2. in slave comouter command:
`stf provider --connect-sub tcp://<localip>:5037 --connect-push tcp:<localip>:5038 --storage-url http://<masterip>:7100  --public-ip <slaveip> `

**Please run `stf doctor` and paste the output here.**
`stf doctor`
INF/cli:doctor 5474 [*] OS Arch: x64
INF/cli:doctor 5474 [*] OS Platform: darwin
INF/cli:doctor 5474 [*] OS Platform: 17.2.0
INF/cli:doctor 5474 [*] Using Node 6.10.0
INF/cli:doctor 5474 [*] Using ZeroMQ 4.2.2
INF/cli:doctor 5474 [*] Using RethinkDB 2.3.6
INF/cli:doctor 5474 [*] Using GraphicsMagick 1.3.26
INF/cli:doctor 5474 [*] Using ProtoBuf 3.5.0
INF/cli:doctor 5474 [*] Using ADB 1.0.36
 I just change the ports to 7114 and 7116 but it also show me ignoring, The master and slave are both mac. Does any body know the reason?

I use this command nc -w 2 -v <masterip> 7114 in the slave computer, and it shows connection refused. Is this the reason? I find this problem on my service
`
2018-03-03T13:32:02.001Z INF/provider 11628 [*] Tracking devices
2018-03-03T13:32:02.003Z INF/provider 11628 [*] Found device "5LM7N16531007291" (device)
2018-03-03T13:32:02.007Z INF/provider 11628 [*] Found device "2339d8e5" (device)
2018-03-03T13:32:12.010Z INF/provider 11628 [*] Providing all 0 of 2 device(s); ignoring "5LM7N16531007291", "2339d8e5"
`  When i take a screenshot in openstf ui , i couldn't able to find those screenshot in that mobile devices. Where these taken screenshots will actually gets stored ?
  Why the `screen-jpeg-quality` option is not available in stf local mode while it is available in stf provider mode ? Shame on me it was obvious :-)
Thanks !  I'm running STF using Docker. I have one VM in the app and db role and one physical machine in the provider role. I also have HTTPS reverse proxy on another machine. After setting up everything and connecting a device to provider, I'm getting this error when opening STF and logging in:
![STF screenshot with error message](https://i.imgur.com/CWBDmjP.png)
And in the Developer console I see an error in when trying to establish a websocket connection:
```
Request URL:wss://stf.example.com/socket.io/?uip=10.1.90.25&EIO=3&transport=websocket
Request Method:GET
Status Code:400 Bad Request
```
In all examples here I've replaced my actual domain with stf.example.com.
I checked Nginx access logs on the VM and the request is being forwarded to the websocket service.
Here is how I started stf-app service:
```
sudo docker run -d \
  --name stf-app.service \
  --link rethinkdb-proxy-28015.service:rethinkdb \
  -e "SECRET=XXX" \
  -p 3000 \
  openstf/stf:latest \
  stf app --port 3000 \
    --auth-url https://stf.example.com/auth/ldap/ \
    --websocket-url wss://stf.example.com/
```
and the stf-websocket service:
```
sudo docker run -d \
  --name stf-websocket.service-1 \
  --link rethinkdb-proxy-28015.service:rethinkdb \
  -e "SECRET=XXX" \
  -p 3000 \
  openstf/stf:latest \
  stf websocket --port 3000 \
    --storage-url https://stf.example.com/ \
    --connect-sub tcp://10.1.2.28:7150 \
    --connect-push tcp://10.1.2.28:7170
```
The IP address is of the VM itself.
In the logs of the websocket service I do not see anything.
Here is the Nginx configuration (SSL part is handled by the external reverse proxy):
```
upstream stf_app {
  server 172.17.0.3:3000 max_fails=0;
}

upstream stf_auth {
  server 172.17.0.12:3000 max_fails=0;
}

upstream stf_storage_apk {
  server 172.17.0.8:3000 max_fails=0;
}

upstream stf_storage_image {
  server 172.17.0.9:3000 max_fails=0;
}

upstream stf_storage {
  server 172.17.0.10:3000 max_fails=0;
}

upstream stf_websocket {
  server 172.17.0.4:3000 max_fails=0;
}

upstream stf_api {
  server 172.17.0.11:3000 max_fails=0;
}

types {
  application/javascript  js;
  image/gif               gif;
  image/jpeg              jpg;
  text/css                css;
  text/html               html;
}

map $http_upgrade $connection_upgrade {
  default  upgrade;
  ''       close;
}

server {
  listen 80;
  server_name stf.example.com;
  keepalive_timeout 70;
  root /dev/null;

  resolver 8.8.4.4 8.8.8.8 valid=300s;
  resolver_timeout 10s;

  # Handle stf-provider.service-1
  location ~ "^/d/mobileteam-android-devices/([^/]+)/(?<port>[0-9]{5})/$" {
    proxy_pass http://10.1.1.195:$port/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection $connection_upgrade;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header X-Real-IP $remote_addr;
  }

  location /auth/ {
    proxy_pass http://stf_auth/auth/;
  }

  location /api/ {
    proxy_pass http://stf_api/api/;
  }

  location /s/image/ {
    proxy_pass http://stf_storage_image;
  }

  location /s/apk/ {
    proxy_pass http://stf_storage_apk;
  }

  location /s/ {
    client_max_body_size 1024m;
    client_body_buffer_size 128k;
    proxy_pass http://stf_storage;
  }

  location /socket.io/ {
    proxy_pass http://stf_websocket;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection $connection_upgrade;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Real-IP $http_x_real_ip;
  }

  location / {
    proxy_pass http://stf_app;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Real-IP $http_x_real_ip;
  }
}
```
I'm not sure where to look or what I should additionally check. Any help is appreciated. Hi,

I am using my domain but I changed it here as an example. Also, I'm using SSL but through additional reverse proxy. I'll try to see if bypassing SSL reverse proxy helps. This is actually not working. I cannot have reverse HTTPS proxy and open websocket connection to non HTTPS endpoint.
```
Mixed Content: The page at 'https://devicefarm.example.com/' was loaded over HTTPS, but attempted to connect to the insecure WebSocket endpoint 'ws://10.1.2.28/socket.io/?uip=10.1.90.25&EIO=3&transport=websocket'. This request has been blocked; this endpoint must be available over WSS.
``` Is there a way to get some debug logs on the websocket service? Thanks for the tip. I also found this issue: https://github.com/socketio/socket.io/issues/1942 and I think it's the problem with Apache reverse proxy. I'll check that as well. have the same problem... but in my case i'm using HAproxy in front of stf. 
and it is so painful to set it up. 

but, ok. will set it only for IP's. and will put simple redirect from outside. 
 yea. i fixed it for me. 

now it works with HAproxy and on the coreos with oauth.

thanks @nemanjanedic @sorccu @vbanthia  This was the issue on the Apache HTTPS Proxy. Additional rewrite rule is needed for /socket.io/ and /d/ paths.  
Hi,
Has anyone tried to authenticate the STF app using the Bearer token key generated by Settings->Keys section? (https://github.com/openstf/stf/blob/master/doc/API.md)

I found the thread #311 helpful (https://github.com/openstf/stf/issues/311) however it requires many settings:

```
export OAUTH_AUTHORIZATION_URL="https://accounts.google.com/o/oauth2/v2/auth"
export OAUTH_TOKEN_URL="https://www.googleapis.com/oauth2/v4/token"
export OAUTH_USERINFO_URL="https://www.googleapis.com/oauth2/v3/userinfo"
export OAUTH_CLIENT_ID="AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.apps.googleusercontent.com"
export OAUTH_CLIENT_SECRET="BBBBBBBBBBBBBBBBBBBBBBBB"
export OAUTH_CALLBACK_URL="http://localhost:7100/auth/oauth/callback"
export OAUTH_SCOPE="openid email"

# Now you can just run stf local without the annoying auth options.
stf local --auth-type oauth
```

I am wondering whether I can simplify these settings to make my Bearer token work. My setup has only one user and I don't want to use the mock authentication.

Appreciate your help!
 Thank you vabanthia for your explanation. In fact, I did successfully use OAUTH using Google credentials. My issue is that I embed OpenSTF in another app which already has one layer of authentication so I want something simple that allows all users who can login my app successfully can use OpenSTF without the second layer of authentication -- only one account is needed for my app and I can pass the login information in command line, no second login screen. I will look into #254 to see whether it can help. I tried #254 but it seems that it not what I need. I would need to modify STF myself to disable the login screen (one default user only) or synchronize two authentication layers so that STF authentication layer can use user credentials from my app's login information.  #353 looks good.

Many thanks for your support!  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
run  stf local   failed 
`ERR/cli:doctor 4007 [*] Unexpected error checking ZeroMQ: Error: Could not locate the bindings file. Tried:`
`Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/9.1.0/darwin/x64/zmq.node
../stf/lib/cli triproxy [name]`

**Please provide the steps to reproduce the issue.**
brew installed , node v9.0.1 installed  , npm  5.5.1 installed
> brew install rethinkdb graphicsmagick zeromq protobuf yasm pkg-config     
  **done**
> sudo npm install -g stf       
 **done**
> rethinkdb
 **done**
> stf local 
 **exception**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
`chendongtaodeMacBook-Pro:zmq chendongtao$ stf local
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
INF/db 4017 [*] Connecting to 127.0.0.1:28015
INF/db:setup 4017 [*] Database "stf" already exists
INF/db:setup 4017 [*] Table "users" already exists
INF/db:setup 4017 [*] Table "accessTokens" already exists
INF/db:setup 4017 [*] Table "vncauth" already exists
INF/db:setup 4017 [*] Table "devices" already exists
INF/db:setup 4017 [*] Table "logs" already exists
INF/db:setup 4017 [*] Index "users"."adbKeys" already exists
INF/db:setup 4017 [*] Index "accessTokens"."email" already exists
INF/db:setup 4017 [*] Index "vncauth"."response" already exists
INF/db:setup 4017 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 4017 [*] Waiting for index "users"."adbKeys"
INF/db:setup 4017 [*] Waiting for index "accessTokens"."email"
INF/db:setup 4017 [*] Waiting for index "vncauth"."response"
INF/db:setup 4017 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 4017 [*] Index "devices"."owner" already exists
INF/db:setup 4017 [*] Index "devices"."present" already exists
INF/db:setup 4017 [*] Index "devices"."providerChannel" already exists
INF/db:setup 4017 [*] Waiting for index "devices"."owner"
INF/db:setup 4017 [*] Waiting for index "devices"."present"
INF/db:setup 4017 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 4017 [*] Index "users"."adbKeys" is ready
INF/db:setup 4017 [*] Index "accessTokens"."email" is ready
INF/db:setup 4017 [*] Index "vncauth"."response" is ready
INF/db:setup 4017 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 4017 [*] Index "devices"."owner" is ready
INF/db:setup 4017 [*] Index "devices"."present" is ready
INF/db:setup 4017 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli provider --name chendongtaodeMacBook-Pro.local --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-temp --port 7102"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 4016 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
../stf/lib/cli triproxy [name]

选项：
  -h, --help         Show help.                                           [布尔]
  -V, --version      Show version.                                        [布尔]
  --bind-dealer, -d  The address to bind the ZeroMQ DEALER endpoint to.
                                               [字符串] [默认值: "tcp://*:7112"]
  --bind-pub, -u     The address to bind the ZeroMQ PUB endpoint to.
                                               [字符串] [默认值: "tcp://*:7111"]
  --bind-pull, -p    The address to bind the ZeroMQ PULL endpoint to.
                                               [字符串] [默认值: "tcp://*:7113"]
  --name             An easily identifiable name for log output.
                             [字符串] [默认值: "chendongtaodeMacBook-Pro.local"]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_TRIPROXY_` (e.g. `STF_TRIPROXY_BIND_PUB`).

Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/9.1.0/darwin/x64/zmq.node
../stf/lib/cli triproxy [name]

选项：
  -h, --help         Show help.                                           [布尔]
  -V, --version      Show version.                                        [布尔]
  --bind-dealer, -d  The address to bind the ZeroMQ DEALER endpoint to.
                                               [字符串] [默认值: "tcp://*:7112"]
  --bind-pub, -u     The address to bind the ZeroMQ PUB endpoint to.
                                               [字符串] [默认值: "tcp://*:7111"]
  --bind-pull, -p    The address to bind the ZeroMQ PULL endpoint to.
                                               [字符串] [默认值: "tcp://*:7113"]
  --name             An easily identifiable name for log output.
                             [字符串] [默认值: "chendongtaodeMacBook-Pro.local"]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_TRIPROXY_` (FTL/cli:local 4016 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:135:13)
    at ChildProcess.emit (events.js:224:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:209:12)
INF/cli:local 4016 [*] Shutting down all child processes
e.g. `STF_TRIPROXY_BIND_PUB`).

Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/9.1.0/darwin/x64/zmq.node
`

**Please run `stf doctor` and paste the output here.**
`chendongtaodeMacBook-Pro:zmq chendongtao$ stf doctor
INF/cli:doctor 4007 [*] OS Arch: x64
INF/cli:doctor 4007 [*] OS Platform: darwin
INF/cli:doctor 4007 [*] OS Platform: 16.7.0
INF/cli:doctor 4007 [*] Using Node 9.1.0
ERR/cli:doctor 4007 [*] Unexpected error checking ZeroMQ: Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/9.1.0/darwin/x64/zmq.node
INF/cli:doctor 4007 [*] Using GraphicsMagick 1.3.26
INF/cli:doctor 4007 [*] Using ProtoBuf 3.4.0
INF/cli:doctor 4007 [*] Using ADB 1.0.39
INF/cli:doctor 4007 [*] Using RethinkDB 2.3.6` I try #250 and #420 solution . but didn't work @sorccu  what about handle  run  `stf doctor ` causes the exception after finish  install zmq .

`chendongtaodeMacBook-Pro:zmq chendongtao$ stf doctor
INF/cli:doctor 4542 [*] OS Arch: x64
INF/cli:doctor 4542 [*] OS Platform: darwin
INF/cli:doctor 4542 [*] OS Platform: 16.7.0
INF/cli:doctor 4542 [*] Using Node 9.1.0
ERR/cli:doctor 4542 [*] Unexpected error checking ZeroMQ: Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/9.1.0/darwin/x64/zmq.node
INF/cli:doctor 4542 [*] Using GraphicsMagick 1.3.26
INF/cli:doctor 4542 [*] Using ADB 1.0.39
INF/cli:doctor 4542 [*] Using ProtoBuf 3.4.0
INF/cli:doctor 4542 [*] Using RethinkDB 2.3.6` I try  reinstall  zeromq with  libsodium  and reinstall stf 。fix this issue

```
brew uninstall zeromq
brew install zeromq --with-libsodium

npm uninstall -g stf 
npm install -g stf
```
you can close the issue  INF/util:procutil 8798 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
INF/db 8799 [*] Connecting to 127.0.0.1:28015
INF/db 8799 [*] Unable to connect to 127.0.0.1:28015
FTL/db 8799 [*] No hosts left to try
FTL/util:lifecycle 8799 [*] Shutting down due to fatal error

/usr/local/lib/node_modules/stf/node_modules/bluebird/js/main/promise.js:680
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12) I tried command `rethinkdb&` but show error log: irectory 'rethinkdb_data' is already in use, perhaps another instance of rethinkdb is using it.  Adds option "--ldap-group-membership" which can take name of the group as parameter "CN=STF Users" and filter users, depending on their group. Parameter can get one or more groups.
Example
`stf local  --public-ip somecompany.insider.net -p 80 --auth-type ldap --auth-options '["--ldap-bind-credentials","ldapstfpassword","--ldap-bind-dn","CN=ldapstfuser, CN=Users, DC=company, DC=loc","--ldap-search-dn","OU=COMPANY, DC=company, DC=loc","--ldap-url","ldap://company.loc","--ldap-search-field","sAMAccountName", "--ldap-group-membership", "CN=STF Users, CN=QATeam"]'`
Here we grant access to users who are in groups STF Users and QATeam

Since LDAP can response with string (user with one group) or array (user with multiple groups) - we implemented check that handles this. @sorccu Is there any problems with this pull request? Merge, merge ;) whew...weekend in rheelm Zero. Make it fun......Make it yours.......dw.xo_ ping @sorccu Looks like we need to remake everything. Our developer who worked on this feature is not available now and won't be accessible for several months. Is it available that you accept this Pull Request and refactor it to your liking? Feature works fine now.
If not - then we will fix it when dev'll be available.  I have been trying to use STF to connect to my Android. I am able to connect, sometimes for a few minutes and sometimes only a few seconds. Following are system specs and log output.

PC OS: Ubuntu 16.04 (lxde desktop) 64 bit
PC Browser: Firefox 56 64 bit
Mobile Device: Nexus 6
Mobile OS: 7.1

STF version: 3.1.0
Nodejs version: 7.10.1
ADB version: 1.0.32

Connection is made using a 32' MonoPrice extender USB cable. I have tried with and without a powered USB hub (on the phone side). The hub does not seem to make a difference.

Log output:
INF/provider 6740 [*] Device "ZX1G223ZGH" is now "device" (was "offline")
INF/device:support:push 11287 [ZX1G223ZGH] Sending output to "tcp://127.0.0.1:7116"
INF/device 11287 [ZX1G223ZGH] Preparing device
INF/device:support:sub 11287 [ZX1G223ZGH] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 11287 [ZX1G223ZGH] Subscribing to permanent channel "*ALL"
INF/device:support:properties 11287 [ZX1G223ZGH] Loading properties
INF/device:support:sdk 11287 [ZX1G223ZGH] Supports SDK 25
INF/device:support:abi 11287 [ZX1G223ZGH] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:minicap 11287 [ZX1G223ZGH] Installing "/usr/lib/node_modules/stf/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 11287 [ZX1G223ZGH] Installing "/usr/lib/node_modules/stf/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-25/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 11287 [ZX1G223ZGH] Checking whether we need to install STFService
INF/device:resources:service 11287 [ZX1G223ZGH] Running version check
INF/device:resources:service 11287 [ZX1G223ZGH] STFService up to date
INF/device:plugins:service 11287 [ZX1G223ZGH] Launching agent
INF/device:plugins:service 11287 [ZX1G223ZGH] Agent says: "Listening on @stfagent"
INF/device:plugins:service 11287 [ZX1G223ZGH] Launching service
INF/device:plugins:service 11287 [ZX1G223ZGH] Agent says: "InputClient started"
INF/device:plugins:display 11287 [ZX1G223ZGH] Reading display info
INF/device:plugins:phone 11287 [ZX1G223ZGH] Fetching phone info
INF/device:plugins:identity 11287 [ZX1G223ZGH] Solving identity
INF/device:plugins:solo 11287 [ZX1G223ZGH] Subscribing to permanent channel "VhffyrV0m5bF7RcK4H8AFlXpG84="
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] Starting WebSocket server on port 7508
INF/device:resources:minitouch 11287 [ZX1G223ZGH] Installing "/usr/lib/node_modules/stf/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
INF/device:plugins:touch 11287 [ZX1G223ZGH] Touch origin is top left
INF/device:plugins:touch 11287 [ZX1G223ZGH] Requesting touch consumer to start
INF/device:plugins:touch 11287 [ZX1G223ZGH] Launching screen service
INF/device:plugins:touch 11287 [ZX1G223ZGH] Connecting to minitouch service
INF/device:plugins:touch 11287 [ZX1G223ZGH] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 11287 [ZX1G223ZGH] minitouch says: "Type B touch device atmel_mxt_ts (1439x2559 with 16 contacts) detected on /dev/input/event0 (score 2115)"
INF/device:plugins:touch 11287 [ZX1G223ZGH] minitouch says: "Note: hard-limiting maximum number of contacts to 10"
INF/device:plugins:touch 11287 [ZX1G223ZGH] Reading minitouch banner
INF/device:plugins:touch 11287 [ZX1G223ZGH] minitouch says: "Connection established"
INF/device:plugins:vnc 11287 [ZX1G223ZGH] Starting VNC server on port 7510
INF/device:plugins:browser 11287 [ZX1G223ZGH] Loading browser list
INF/device:plugins:browser 11287 [ZX1G223ZGH] Updating browser list
WRN/device:plugins:browser 11287 [ZX1G223ZGH] Unmapped browser "mobi.mgeek.TunnyBrowser"
WRN/device:plugins:browser 11287 [ZX1G223ZGH] Unmapped browser "org.mozilla.focus"
INF/device:plugins:mute 11287 [ZX1G223ZGH] Will not mute master volume during use
INF/device:resources:minirev 11287 [ZX1G223ZGH] Installing "/usr/lib/node_modules/stf/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 11287 [ZX1G223ZGH] Launching reverse port forwarding service
INF/device:plugins:forward 11287 [ZX1G223ZGH] Connecting to reverse port forwarding service
INF/device:plugins:connect 11287 [ZX1G223ZGH] Listening on port 7509
INF/device 11287 [ZX1G223ZGH] Fully operational
INF/provider 6740 [*] Providing all 1 device(s)
IMP/device:plugins:group 11287 [ZX1G223ZGH] Now owned by "none@none.none"
INF/device:plugins:group 11287 [ZX1G223ZGH] Subscribing to group channel "fpX1QyxcQEau01p3AJNnrA=="
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] Setting frame producer projection to 922x922
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] Requesting frame producer to start
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] Launching screen service
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "PID: 5314"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: Using projection 1440x2560@519x922/0"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:241) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:244) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:251) Creating virtual display"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:257) Creating buffer queue"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:262) Creating CPU consumer"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:266) Creating frame waiter"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:270) Publishing virtual display"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:287) Found 7.1 Developer Preview SurfaceComposerClient::setDisplaySurface"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] Connecting to minicap service
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 11061252 bytes for JPG encoder"
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] Reading minicap banner
INF/device:plugins:screen:stream 11287 [ZX1G223ZGH] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
IMP/device:plugins:connect 11287 [ZX1G223ZGH] Remote Connect Started for device "ZX1G223ZGH" at "localhost:7509"
IMP/device:plugins:service 11287 [ZX1G223ZGH] Agent connection ended, attempting to relaunch
INF/device:plugins:service 11287 [ZX1G223ZGH] Launching service
INF/provider 6740 [*] Lost device "ZX1G223ZGH" (device)
INF/provider 6740 [*] Shutting down device worker "ZX1G223ZGH"
INF/provider 6740 [*] Cleaning up device worker "ZX1G223ZGH"
INF/provider 6740 [*] Gracefully killing device worker "ZX1G223ZGH"
IMP/device:plugins:service 11287 [ZX1G223ZGH] Service connection ended, attempting to relaunch
INF/device:plugins:service 11287 [ZX1G223ZGH] Launching service
WRN/device:plugins:touch 11287 [ZX1G223ZGH] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 11287 [ZX1G223ZGH] Disconnecting from minitouch service
FTL/util:lifecycle 11287 [ZX1G223ZGH] Forward shell ended; we shall share its fate
FTL/util:lifecycle 11287 [ZX1G223ZGH] Shutting down due to fatal error
INF/provider 6740 [*] Device worker "ZX1G223ZGH" has retired
INF/provider 6740 [*] Found device "ZX1G223ZGH" (offline)
INF/reaper 6734 [reaper001] Device "ZX1G223ZGH" is present
INF/provider 6740 [*] Registered device "ZX1G223ZGH"
INF/provider 6740 [*] Lost device "ZX1G223ZGH" (offline)
INF/provider 6740 [*] Found device "ZX1G223ZGH" (offline)
INF/reaper 6734 [reaper001] Device "ZX1G223ZGH" is present
INF/provider 6740 [*] Registered device "ZX1G223ZGH"
INF/provider 6740 [*] Lost device "ZX1G223ZGH" (offline)
INF/provider 6740 [*] Found device "ZX1G223ZGH" (offline)
INF/reaper 6734 [reaper001] Device "ZX1G223ZGH" is present
INF/provider 6740 [*] Registered device "ZX1G223ZGH"
INF/provider 6740 [*] Lost device "ZX1G223ZGH" (offline)
INF/provider 6740 [*] Found device "ZX1G223ZGH" (offline)
INF/reaper 6734 [reaper001] Device "ZX1G223ZGH" is present
INF/provider 6740 [*] Registered device "ZX1G223ZGH"
INF/provider 6740 [*] Lost device "ZX1G223ZGH" (offline)

The application will keep looping from Registered/Lost/Found until the usb cable unplugged and plugged back in. Any help is greatly appreciated. I am fairly new to nodejs so if there is something I am missing, please let me know.

Thanks I will see what I can find on the hub. When you say it is a 'Hardware issue', can you be more specific? Do you suspect that it is USB/hub related or some other device issue? What is the longest recommended USB cord? I see the one mentioned in the README is only 1.5'.  Sorry, I forgot to mention the phone batt, is only at 33%. Might things work better if the phone has a full charge? Thank you for the follow up. I am not trying to achieve stellar performance from the remote device. I have my home office in the basement and do not get cell service in the dungeon. With the help of a BT head set and your UI (using --allow-remote and wifi), I am able to make/receive calls and text messages remotely. 

By trade, I am a certified Penetration Tester so there is a definite possibility of using this solution when performing mobile device testing.  

Thanks again for your help and all of your hard work providing this FOSS solution.

Regards The maximum length of a USB connection (better: link) is 5m (= ~ 16'5"): https://superuser.com/a/64747  As stated in the title, I am trying to deal with two issues. 

First I am running on ubuntu and starting sft with: 'sft local &' for force it to the background. This works fine except when I try to do an orderly shut down, I need to run ps and kill a bunch of different processes.

Second, I started playing with stf weeks ago and am just now getting back to using it. I have forgotten the user/password to access to web UI. Is there a way to recover or reset the credentials?

Thanks FYI, I have tried deleting the stf db in rethinkdb and restarting the stf service but still cannot log in. Don't use "&" to start a process in the background if you want to cleanly shut it down later. Better use "screen" (https://www.gnu.org/software/screen/) or some process manager.
For the credentials: RethinkDB has its own web UI that you can use to have a look or modify data stored  Hi,
I am using STF for a while now, but i have observed that for most of the devices it shows the default image. Only in case of Nexus 6P i was able to get the proper device image.
Can any one help me with how to make the desired changes in order to get the specific device image properly. Thanks for the quick response Simo Kinnunen. I have already forked the STF but how can we make changes to the node modules directory stf-device-db module and rebuild it in order to get the updated images of the devices. I tried doing it but in vain. So can you please suggest some way to do it.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

My phone use 2.4G route to connect router. And if there are more than 15 phones connect to the same Wi-Fi hot point at the same time, then none of the phone can connect to the internet. Because of the signal interference of Wi-Fi

So can you suggest me some method to solve the interference?

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

No, It happen to all phone if there are more than 15 phones.

**Please provide the steps to reproduce the issue.**

Connect more 15 phones to the same Wi-Fi hot point.

**What is the expected behavior?**

All phone should have connected to the internet.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

No Error, Because it is out of stf's business.

**Please run `stf doctor` and paste the output here.**

None Thanks for your reply. But in fact I have to setup a cluster in the size of 10000 android phones. So routers make no sense. I have to deal with the signal interference of electromagnetic wave. Thanks @sorccu I will do it myself. But can you tell me wether your scale of phone cluster can be handled only by a good router? Ok Got, LTE is a really excellent solution. But in my country, Phone number must be binded with everyone's ID Card, and every person could have at most 5 Phone number. Nobody or company could have anonymous phone number.  that is b\*\*\*s\*\*t. Sure. Thanks again.  Hello! 
I'was able to start your amazing app on docker, on remote server...
but, something differs from local machine and i get "500 Internal server error" and on login page i see only this: "**Server error. Check log output.**"

I tried to connect to stf-auth image (`docker exec -i -t stf-auth-3200 /bin/bash`), but i don't see any logs.
is it there a way to get more details? poor me. 
thanks!  in your help i see this:

    #Each option can be be overwritten with an environment variable by converting the
    #option to uppercase, replacing dashes with underscores and prefixing it with
    #`STF_AUTH_LDAP_` (e.g. `STF_AUTH_LDAP_SECRET`). Legacy environment variables
    #like LDAP_USERNAME_FIELD are still accepted, too, but consider them deprecated.

but you have these options:
```
--app-url, -a            URL to the app unit.              [string] [required]
--ldap-bind-credentials  LDAP bind credentials.                       [string]
--ldap-bind-dn           LDAP bind DN.                                [string]
--ldap-search-class      LDAP search objectClass.    [string] [default: "top"]
--ldap-search-dn         LDAP search DN.                   [string] [required]
--ldap-search-field      LDAP search field.                [string] [required]
--ldap-search-scope      LDAP search scope.          [string] [default: "sub"]
--ldap-timeout, -t       LDAP timeout.                [number] [default: 1000]
--ldap-url, -u           URL to the LDAP server (e.g. `ldap://127.0.0.1`).
                                                            [string] [required]
--ldap-username-field    LDAP username field.
```

am i getting right, that correct ones are:
```
STF_AUTH_LDAP_APP_URL
STF_AUTH_LDAP_BIND_CREDENTIALS
STF_AUTH_LDAP_BIND_DN
STF_AUTH_LDAP_SEARCH_CLASS
STF_AUTH_LDAP_SEARCH_DN
STF_AUTH_LDAP_SEARCH_FIELD
STF_AUTH_LDAP_SEARCH_SCOPE
STF_AUTH_LDAP_TIMEOUT
STF_AUTH_LDAP_URL
STF_AUTH_LDAP_USERNAME_FIELD
```
?


or i have to write this:
```
STF_AUTH_LDAP_APP_URL
STF_AUTH_LDAP_LDAP_BIND_CREDENTIALS
STF_AUTH_LDAP_LDAP_BIND_DN
STF_AUTH_LDAP_LDAP_SEARCH_CLASS
STF_AUTH_LDAP_LDAP_SEARCH_DN
STF_AUTH_LDAP_LDAP_SEARCH_FIELD
STF_AUTH_LDAP_LDAP_SEARCH_SCOPE
STF_AUTH_LDAP_LDAP_TIMEOUT
STF_AUTH_LDAP_LDAP_URL
STF_AUTH_LDAP_LDAP_USERNAME_FIELD
```

which is correct one? ok. second one. 
thanks, i'll use it.   Hi all,
I can control the flow of the code to handle touch events from its device control pane to the touch plugin (stf/lib/units/device/plugins/touch/index.js). Basically, the frontend calls functions in control-service.js and control-service.js subsequently sends Websocket requests to websocket service. After that, the websocket service creates TouchXYZMessages and passes them to touch service for handling.  However, I don't know how the touch plugin interacts with the real device -- I suspect that eventually, STF needs to send some ADB commands to the device to simulate the events however I cannot find that code.
Could someone please help me on that?
Many thanks  When I click the "Automation" tab, it asks for my "Store" login (I'm assuming this means my Google Play Store login?). But when I click sign in nothing happens. What is this supposed to do?
![2017-10-27 03 29 29](https://user-images.githubusercontent.com/15389183/32092565-2107143a-bac7-11e7-9f1a-be9fc30a1189.gif)
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**
open STF on win7
**What is the expected behavior?**

![image](https://user-images.githubusercontent.com/20472976/32083837-34272a6a-baf8-11e7-9e2c-58fa65a76df6.png)
![image](https://user-images.githubusercontent.com/20472976/32083840-382a746e-baf8-11e7-8815-1e26d3a9af67.png)
When I open STF on win10，it's OK! Like this:
![image](https://user-images.githubusercontent.com/20472976/32083896-9b5e5172-baf8-11e7-8fee-8c58697bfa62.png)

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 There is error shows "Provisional headers are shown"
![image](https://user-images.githubusercontent.com/20472976/32084981-0a002082-baff-11e7-9a0e-741979d5333d.png)
 @sorccu I open STF on win7 chrome v58/v61, it's empty.But open on win7 chrome v59 and win10 chrome v61, it's ok.  I haven't modify any font codes. How can I solve this problem? @gunta Both I select Disable cache checkbox or not, the same.
[Canary version of Chrome](https://www.google.com/chrome/browser/canary.html) is crashed always.
The same on Firefox.
STF opennig on Win7 chrome v58/v61 is empty,  on Win7 chrome v59 is ok, on Win10 chrome is always ok.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Unable to connect STF devices on Appium Server through adb connect. Success Rate is very low, its like 2 out of 10 trials, not sure whether this is related to the STF stability.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
[agus@appium ~]$ adb devices -l
List of devices attached
![image](https://user-images.githubusercontent.com/25218731/32046321-f0185564-ba6c-11e7-8d35-711b0bf700bd.png)


**Please provide the steps to reproduce the issue.**
1. Start with the fresh Appium Server connection
2. Kill adb server by running 'adb kill-server'
3. Start adb server by running 'adb start-server'
4. Connect the STF device by running 'adb connect 192.168.10.48:7477'
5. Device is connected and make sure device is available on the list by typing 'adb devices'
6. Then I stop the session through STF Web, and I look for the new device connection
7. In the server type 'adb connect 192.168.10.48:7479'
8. It doesnt listed any device <= PROBLEM
9. And in the STF Web will appear as this:
![image](https://user-images.githubusercontent.com/25218731/32046477-61f08f9e-ba6d-11e7-8dd6-6d8b9db68d95.png)

Note:
I am using the same LDAP access on both Appium Server and STF


**What is the expected behavior?**
I should be able to connect STF devices by running adb connect xxx.xxx.xxx.xxx:xxxx

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
No

**Please run `stf doctor` and paste the output here.**
![image](https://user-images.githubusercontent.com/25218731/32050568-7ce5c798-ba7b-11e7-8aa2-092794ce36d1.png)
 @dsuryadi1 @sorccu Hello guys, I had the same issue, does it have any solution? I tried to up STF with docker-compose from https://github.com/nikosch86/stf-poc/blob/master/docker-compose.yml, as I see it is latest images for STF Can you guys try to run adb from a different machine? Have you configured multiple stf servers and switched among them? 
It appears that if your local machine is registered to one stf-server(via adb-key) it doesn't register to the other server. As a consequence , adb devices does not list anything even after connection success.  One thing you can check , if your adb-keys show as registered on the stf settings page.  Basing on commented functionality and mostly the problem with issues mentioned in https://github.com/openstf/stf/issues/460 and https://github.com/openstf/stf/issues/349 I noticed that mostly my problem was connected with not using imagemagick. Mostly I had problem with proper converting bitmap which was collected from blob.
After changing:
var gm = require('gm')
to:
var gm = require('gm').subClass({imageMagick: true})
Screenshots bitmaps are properly displayed on stf screenshot div. There is one dependency which will need to be added, need of installation of imagemagick. Hi Simo, 

I made small investigation. Without using : 
var gm = require('gm').subClass({imageMagick: true})

http://aheckmann.github.io/gm/docs.html

I receive

 Error: Command failed: gm convert: No decode delegate for this image format (/tmp/gmYAAOaw).

    at ChildProcess.onExit (/home/luze/stf/stf/node_modules/gm/lib/command.js:301:17)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at maybeClose (internal/child_process.js:920:16)
    at Socket.<anonymous> (internal/child_process.js:351:11)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at Pipe._handle.close [as _onclose] (net.js:497:12) code: 1, signal: null }

Mostly looks like gm nodejs module have problem with converting jpg images stored in s/blob.

To reproduce this error you can add in:
lib/units/storage/plugins/image/task/transform.js

var gm = require('gm')
var Promise = require('bluebird')
var logger = require('../../../../../util/logger')
var request = require('request').defaults({ encoding: null });;

module.exports = function(stream, options) {
 var log = logger.createLogger('storage:plugins:image:task:transform.js')
 log.info('debug log for me')
 log.info(stream)
  return new Promise(function(resolve, reject) {
    log.info("imagemagick")
    var test = JSON.parse(JSON.stringify(stream))
    log.info(JSON.stringify(test.uri))
    log.info("imagemagick will continue")

    var url = test.uri.href;
    gm(request(url)).write('/tmp/reformat.jpg', function (err) {
      if (!err) {log.info('done')}
      else {log.info(err)};
   })
   
   var transform = gm(stream)
   ....

The solution works on my machine. Hmm, thats true. gm convert ad hoc on my machine did not support jpg.

luze@luze-001:~/stf/stf$ gm convert -list format | grep JPG
luze@luze-001:~/stf/stf$ gm convert -size 120x120 ~/Desktop/0657049c0062100d.jpg  -resize 120x120 +profile "*" thumbail.jpg
gm convert: No decode delegate for this image format (/home/luze/Desktop/0657049c0062100d.jpg).
but imagemagick it is.

So mostly looks like add hoc-gm is not supporting jpg. There is a workaround for not using installed local imagemagick. I found this solution:
https://stackoverflow.com/questions/16094875/how-do-i-configure-a-jpeg-delegate-for-graphicsmagick
`$ cd ~/source
$ wget http://www.ijg.org/files/jpegsrc.v6b.tar.gz
$ tar -xzvf jpegsrc.v6b.tar.gz
$ cd jpeg-6b
$ ./configure
$ make
$ sudo make install

$ cd ~/source
$ wget ftp://ftp.graphicsmagick.org/pub/GraphicsMagick/1.3/GraphicsMagick-1.3.18.tar.xz
$ tar -xJvf GraphicsMagick-1.3.18.tar.xz
$ cd GraphicsMagick-1.3.18
$ ./configure
$ make
$ sudo make install

$ npm install gm`

After installing jpg-6b as well rebuilding GraphicsMagick and installation one more time gm, my gm is recognizing JPG format.  The gm is installed locally during building process. 
`
npm install
`
when is downloading needed modules from package.json. I'm not doing anything else. 

I'm working at:
` 
lsb_release -a
LSB Version:	core-9.20160110ubuntu0.2-amd64:core-9.20160110ubuntu0.2-noarch:printing-9.20160110ubuntu0.2-amd64:printing-9.20160110ubuntu0.2-noarch:security-9.20160110ubuntu0.2-amd64:security-9.20160110ubuntu0.2-noarch
Distributor ID:	Ubuntu
Description:	Ubuntu 16.04.3 LTS
Release:	16.04
Codename:	xenial
` If I good remember I downloaded  sources from:
https://sourceforge.net/projects/graphicsmagick/files/graphicsmagick/1.3.26/

and I created graphicsmagick from source. Thank you for your patience and support @sorccu   Hello, 

Is it possible to have 3 Servers with installed ADBD and connected devices, and having one main OpenSTF host which is connect to 3 hosts and collect data from ADB ports?
If yes, could you please provide minimum configuration (give multiple adb IP addresses to STF provider. )

Thanks, Many thanks  Proposed fix for issue: 
https://github.com/openstf/stf/issues/735  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**Description:**
During filtering devices via Battery Level or Battery Temp filer, I noticed, that results for query like:
batteryLevel: > 20

Did not return Android devices passing this criteria. The same issue I observed when I tried to filter devices using this query:
 batteryTemp: >20

STF source code checkout with : d5ab5fd83d2e9a1dab2c61dc42b0ba999a6dbb1a

**Steps to reproduce**
A)
Insert in  input tag with name="deviceFilter" this query:
batteryLevel: >50

**What is the expected behavior?**
We should expect to see only devices which battery level is bigger then 50%. But we see only devices, which body contains 50%.

B)
Insert in  input tag with name="deviceFilter" this query:
batteryTemp: <40

**What is the expected behavior?**
We should expect to see only devices which battery temp is lower then 40°C. But we see only devices, which body contains 40.

**Investigation**:
The problem is mostly connected with using text filtering for both of params: Battery Level and Battery Temp. 
stf/res/app/device-list/column/device-column-service.js: ln340

As we can see both of params are marked as TextCell. To parse them as values we might to add additional extra checking in :
stf/res/app/device-list/column/device-column-service.js: ln340

to parse those data properly by adding this part:
  , filter: function(item, filter) {
      if ( options.title == "Battery Level" || options.title == "Battery Temp" ) {
        //Exception in TextCell. We want to filter after integer values for two columns, Battery Level and Battery Temp
        var remove_unit_character = ''
        switch (options.title){
        case "Battery Level":
          remove_unit_character = "%"
          break
        case "Battery Temp":
          remove_unit_character = "°C"
          break
        }

        var parsed_value = parseInt((options.value(item)).replace(remove_unit_character,''))

        return filterOps[filter.op || '='](
            parsed_value
          , Number(filter.query)
        )
      }
      else{
        return filterIgnoreCase(options.value(item), filter.query)
      }
    }

 Hi @sorccu ,

Not to many, only 5, but I thinking about adding few more devices to my environment. I'm just playing around in different locations. I think about adding one more thing , which I'm missing in your framework. 

It will be cool to have possibilities to compute few filters queries for instance:
batteryLevel:>20 AND sdk:>20 AND name: Nexus 5

But I would like to do it everything by baby steps. The fix for filtering I added in PR:
https://github.com/openstf/stf/pull/736  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
3.1.0

**What is the issue or idea you have?**
I changed hostname of machine. 
I cleared rethinkdb data, but Location still shown old hostname.
I want to update 'Location'

 @sorccu thank you. So if hostname is changed - there is no way to "update" it, only to set manually? You could modify the data in the database directly? Thanks, issue is resolved.  Xiaomi mix 2 resolution is 2160x1080 pixels, the virtual status bar can not be displayed on stf. But Samsung S8 resolution is 2960x1440 pixels, the virtual status bar can be displayed properly.
This is Xiaomi mix2's screenshot on stf:
![image](https://user-images.githubusercontent.com/26139195/31701348-6a5331e4-b402-11e7-87a7-3cc7a687fdcd.png)

This is  Xiaomi mix2's correct screenshot:
![image](https://user-images.githubusercontent.com/26139195/31701427-ec8b30bc-b402-11e7-8a5c-7e288628f8bf.png)
 XiaoMi Mix2 is a popular full-screen phone in China. I can get a new device this weekend, will try to debug this problem or provide a way for @sorccu to remote-debug this problem. The remote control tool STF can't used to remote debug itself, from this point of view, STF is not self-host :-)
I get used to using TeamView to do remote debugging, but it's indeed painful to connect across countries, network delays can't be tolerated.

Thanks for your hints, this weekend I will verify if XiaoMi Mix2 crops out the actual size of screen.
 @sorccu The culprit is the absolute height of the available display size retrieved by STFService, related code can be found in /android/view/DisplayInfo.java:

```java
    private void getMetricsWithSize(DisplayMetrics outMetrics, CompatibilityInfo compatInfo,
            Configuration configuration, int width, int height) {
        outMetrics.densityDpi = outMetrics.noncompatDensityDpi = logicalDensityDpi;
        outMetrics.density = outMetrics.noncompatDensity =
                logicalDensityDpi * DisplayMetrics.DENSITY_DEFAULT_SCALE;
        outMetrics.scaledDensity = outMetrics.noncompatScaledDensity = outMetrics.density;
        outMetrics.xdpi = outMetrics.noncompatXdpi = physicalXDpi;
        outMetrics.ydpi = outMetrics.noncompatYdpi = physicalYDpi;

        width = (configuration != null
                && configuration.screenWidthDp != Configuration.SCREEN_WIDTH_DP_UNDEFINED)
                ? (int)((configuration.screenWidthDp * outMetrics.density) + 0.5f) : width;
        height = (configuration != null
                && configuration.screenHeightDp != Configuration.SCREEN_HEIGHT_DP_UNDEFINED)
                ? (int)((configuration.screenHeightDp * outMetrics.density) + 0.5f) : height;

        outMetrics.noncompatWidthPixels  = outMetrics.widthPixels = width;
        outMetrics.noncompatHeightPixels = outMetrics.heightPixels = height;

        if (!compatInfo.equals(CompatibilityInfo.DEFAULT_COMPATIBILITY_INFO)) {
            compatInfo.applyToDisplayMetrics(outMetrics);
        }
    }
```
Width x height retrieved in above code is 1080x1980, but the actual resolution rate is 1080x2160. 

Fortunately the shell command "wm size" can output the correct value:

```
chiron:/data/local/tmp $ wm size
Physical size: 1080x2160
```

So I wrote some code to workaround this problem:

  * Add a new function getResolution in lib/util/devutil.js

```javascript

// get window size (resolution)
devutil.getResolution = function(adb, serial) {
  return new Promise(function(resolve, reject) {
    client.shell(serial, "wm size").timeout(2 * 1000)
      .then(function processAdbOutput(output) {
        var content = ""
        var resolver = Promise.defer()

        function processData(data) {
          content += data
        }

        function errorListener(err) {
          resolver.reject(err)
        }

        function endListener() {
          var res = /(\d+)x(\d+)/.exec(content)
          if (res === null)
            reject("Can't find valid resolution rate")
          else {
            resolve({width: res[1], height: res[2]})  // get matched group
          }
        }

        output.on('data', processData)
        output.on('error', errorListener)
        output.on('end', endListener)

        return resolver.promise.finally(function () {
          output.removeListener('data', processData)
          output.removeListener('error', errorListener)
          output.removeListener('end', endListener)
        })
      })
  })
}

```
  * Invoke devutil.getResolution to get screen size in lib/units/device/plugins/service.js  
 
```javascript
    plugin.getDisplay = function(id) {
      return Promise.join(runServiceCommand(
          apk.wire.MessageType.GET_DISPLAY
        , new apk.wire.GetDisplayRequest(id)
        ), devutil.getResolution(
          adb
        , options.serial)
        )
        .timeout(10000)
        .then(function(data, resolution) {
          var response = apk.wire.GetDisplayResponse.decode(data)

          if (response.success) {
            return {
              id: id
            //, width: response.width
            //, height: response.height
            , width: resolution.width
            , height: resolution.height
            , xdpi: response.xdpi
            , ydpi: response.ydpi
            , fps: response.fps
            , density: response.density
            , rotation: response.rotation
            , secure: response.secure
            , size: Math.sqrt(
                Math.pow(response.width / response.xdpi, 2) +
                Math.pow(response.height / response.ydpi, 2)
              )
            }
          }
          throw new Error('Unable to retrieve display information')
        })
    }
```
Til now STF can support XiaoMi Mix2 perfectly.

![image](https://user-images.githubusercontent.com/140176/31861492-b11d660a-b6f3-11e7-925f-c9974893c4f5.png)




 @sorccu Thank you for reviewing my code! I will fix the bug soon. I've applied the code for almost 90 devices covering 20 brands(Android 4.2~8.0), it works well.

BTW, this week I will contact engineer in XiaoMi to discuss about the issue ...
 OK, I will look into openstf/minicap#93 after work. Seems to introduce more code changes.  Xiaomi has [a blog](https://dev.mi.com/console/doc/detail?pId=1160) about this issue, which is written in Chinese. 

It's fine if you don't know Chinese. The solution is to declare the maximum aspect ratio larger than 2.0. Here is the [documentation](https://developer.android.com/guide/practices/screens_support.html#MaxAspectRatio) about how to declare the maximum aspect ratio written by Android team. 

Note that Mix 2 is running Android N.

I hope it helps. @sorccu  I will try it tonight. Thanks @linzhaoqin from XiaoMi. @sorccu The problem has been resolved perfectly after adding meta-data in AndroidManifest.xml as @linzhaoqin mentioned:

```
<application android:allowBackup="true"
        android:label="@string/app_name"
        android:icon="@drawable/ic_launcher"
        android:persistent="true">

      <meta-data android:name="android.max_aspect"
        android:value="3.0" />

```

Added two debug log in lib/units/device/plugins/service.js:

```
    plugin.getDisplay = function(id) {
      return runServiceCommand(
          apk.wire.MessageType.GET_DISPLAY
        , new apk.wire.GetDisplayRequest(id)
        )
        .timeout(10000)
        .then(function(data) {
          var response = apk.wire.GetDisplayResponse.decode(data)
          console.log("+++++++++++++ width:", response.width)
          console.log("+++++++++++++ height:", response.height)
```
Then run STF and connect with the Mix2 device, the output is as expected

```
INF/device:plugins:service 28623 [c4700512] Agent says: "InputClient started"
INF/device:plugins:display 28623 [c4700512] Reading display info
+++++++++++++ width: 1080
+++++++++++++ height: 2160
```

Thanks

 I met the same problem recently. I guess some manufacturers force return an error resolution because they want the virtual button to be shown forever and not covered by other apps, I think getting resolution from adb command is a good solution.  I have pulled the code from Git but i am unable to run the source code in order to make changes to its UI. Can anyone please help me with this.                                                                                                                                       I have tried with the below steps                                                                                                                                      1. Pulled the code from Git                                                                                                                                              2. Installed the dependencies mentioned as per the Requirements in STF notes.                                                   3. Also installed the dependencies using "npm install -g stf"                                                                                      4. Fetched all NPM and Bower modules using "npm install"                                                                                    5. linked the module using "npm link"

After doing "npm link" i get the same  thing which i get on "npm -h" . So exactly how should we run it, is there any other way to do so ? 
 Hi yogesh8384,
Please try the following steps. I used it for both Ubuntu 16.04 and 14.04 64-bit and it works properly. Now I can modify OpenSTF code, rebuild and run with no issue. Hope it helps

Step 1. Install Android ADB
Download Android Studio & Extract it
cd to android-studio/bin
./studio.sh
Update PATH in ~/.bashrc
export PATH=$PATH:/home/ubuntu/Android/Sdk/platform-tools

Step 2. Update apt and install commonly required packages
sudo apt-get update
sudo apt-get install libtool autoconf automake

Step 3. Install some required packages using apt
sudo apt-get install graphicsmagick yasm pkg-config

Step 4. Install rethinkdb
source /etc/lsb-release && echo "deb http://download.rethinkdb.com/apt $DISTRIB_CODENAME main" | sudo tee /etc/apt/sources.list.d/rethinkdb.list
wget -qO- https://download.rethinkdb.com/apt/pubkey.gpg | sudo apt-key add -
sudo apt-get update
sudo apt-get install rethinkdb

Step 5. Install nodejs
wget --progress=dot:mega https://nodejs.org/dist/v6.11.0/node-v6.11.0-linux-x64.tar.xz
sudo tar -xJf node-v*.tar.xz --strip-components 1 -C /usr/local

Step 6. Install ZeroMQ & Protocol Buffers
wget https://github.com/zeromq/libzmq/releases/download/v4.2.1/zeromq-4.2.1.tar.gz
tar -xvf zeromq-4.2.1.tar.gz
cd zeromq-4.2.1
./autogen.sh
./configure
make
sudo make install

cd ..
curl -OL https://github.com/google/protobuf/releases/download/v3.2.0/protoc-3.2.0-linux-x86_64.zip
unzip protoc-3.2.0-linux-x86_64.zip -d protoc3
sudo mv protoc3/bin/protoc /usr/bin/protoc

sudo apt-get -y install libzmq3-dev libprotobuf-dev

Step 7. Install bower, gulp and node-gyp
sudo npm install -g bower gulp
sudo /usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js install

Step 8. Download and install stf
git clone https://github.com/openstf/stf.git
cd stf
npm install
sudo npm link

Step 9. Run OpenSTF
rethinkdb --bind all
adb start-server
stf local
OR stf local --public-ip=IP of the host

Step 10. Update code and recompile stf
run "sudo npm link"

Thuan
 Thank you Thuan Pham,
Its working now, i am working on modifying the UI but i am unable to make changes to the default device image that comes when the devices are connected. Is there any way to do it, or we need to make the changes to the stf-device-db that is present in the node module as the images are present there only. Thanks @thuanpv - your instructions worked for me on Kubuntu 17.10 with a minor modification:

```
wget http://mirrors.kernel.org/ubuntu/pool/main/p/protobuf/libprotobuf9v5_2.6.1-1.3_amd64.deb
sudo dpkg -i libprotobuf9v5_2.6.1-1.3_amd64.deb
```

Your instructions also worked without modification on KDE Neon (which is based on Ubuntu 16.04).

Is there any way of installing everything on Ubuntu from a repo? Hello, im using Kali Linux... but when i follow you step 2 i getting this problem
`Reading package lists... Done
Building dependency tree       
Reading state information... Done
Package autoconf is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source

Package automake is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source
```

Package libtool is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source

E: Package 'libtool' has no installation candidate
E: Package 'autoconf' has no installation candidate
E: Package 'automake' has no installation candidate
```
Can someone help me i have been google in a week I havent solve this problem...

Question : This STF can control apps that have different account? Actually i am trying to make ui changes but its not reflecting.Can any one help me  logger.js has timestamp variable but I can't use it.
This PR makes timestamp available in log.

#### example
```
[2017/10/13 22:10:59] WRN/db 15255 [*] Connection closed
[2017/10/13 22:10:59] INF/db 15255 [*] Connecting to 127.0.0.1:28015
[2017/10/13 22:11:00] WRN/db 15257 [*] Connection closed
[2017/10/13 22:11:00] INF/db 15257 [*] Connecting to 127.0.0.1:28015
[2017/10/13 22:11:00] WRN/db 15256 [*] Connection closed
[2017/10/13 22:11:00] INF/db 15256 [*] Connecting to 127.0.0.1:28015
```  It is not an issue just a question:  is STF 3.1.0 available soon on ARM from docker hub in order to get the Android O compatibility ? Arrgh, do you have a trail about the error causing the build to fail ? My target is raspberry Pi3, may be I can try to build on it ? Thanks, I currently download the latest image !

De : Simo Kinnunen [mailto:notifications@github.com]
Envoyé : mercredi 11 octobre 2017 15:16
À : openstf/stf
Cc : BARBARON Denis IMT/OLS; Author
Objet : Re: [openstf/stf] is STF 3.1.0 available soon on ARM ? (#729)


Should be working again.

—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/729#issuecomment-335805692>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkCrjCY6L2f_orUPx8HUrcwc7pFzd-ks5srL-ogaJpZM4P1EhN>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 It works well !

From my side, I tried to build the docker image on Raspberry Pi3, but it seems to be blocked on the compilation of a file at “building app” step:

  g++ '-DNODE_GYP_MODULE_NAME=libsass' '-DUSING_UV_SHARED=1' '-DUSING_V8_SHARED=1' '-DV8_DEPRECATION_WARNINGS=1' '-D_LARGEFILE_SOURCE' '-D_FILE_OFFSET_BITS=64' '-DLIBSASS_VERSION="3.3.6"' -I/home/stf/.node-gyp/6.11.2/include/node -I/home/stf/.node-gyp/6.11.2/src -I/home/stf/.node-gyp/6.11.2/deps/uv/include -I/home/stf/.node-gyp/6.11.2/deps/v8/include -I../src/libsass/include  -fPIC -pthread -Wall -Wextra -Wno-unused-parameter                                                      -O3 -fno-omit-frame-pointer -std=gnu++0x -std=c++0x -fexceptions -frtti -MMD -MF ./Release/.deps/Release/obj.target/libsass/src/libsass/src/context.o.d.raw   -c -o Release/obj.target/libsass/src/libsass/src/context.o ../src/libsass/src/context.cpp

Do you what it means ?


De : BARBARON Denis IMT/OLS
Envoyé : mercredi 11 octobre 2017 15:18
À : 'openstf/stf'
Objet : RE: [openstf/stf] is STF 3.1.0 available soon on ARM ? (#729)

Thanks, I currently download the latest image !

De : Simo Kinnunen [mailto:notifications@github.com]
Envoyé : mercredi 11 octobre 2017 15:16
À : openstf/stf
Cc : BARBARON Denis IMT/OLS; Author
Objet : Re: [openstf/stf] is STF 3.1.0 available soon on ARM ? (#729)


Should be working again.

—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/729#issuecomment-335805692>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkCrjCY6L2f_orUPx8HUrcwc7pFzd-ks5srL-ogaJpZM4P1EhN>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 Hi,

Thanks for your answer, this morning I saw that the build failed:
Killed
The command '/bin/sh -c set -xo pipefail &&     echo '--- Updating repositories' &&     apk update &&     echo '--- Building node' &&     apk add curl make gcc g++ binutils-gold python linux-headers paxctl libgcc libstdc++ &&     curl -sSL https://nodejs.org/dist/v6.11.2/node-v6.11.2.tar.gz | tar -xz &&     cd /node-v* &&     ./configure --prefix=/usr &&     make -j$(grep -c ^processor /proc/cpuinfo 2>/dev/null || 1) &&     make install &&     paxctl -cm /usr/bin/node &&     echo '--- Building app' &&     addgroup -S stf &&     adduser -S -G stf stf &&     chown -R stf:stf /tmp/build &&     cd /tmp/build &&     export PATH=$PWD/node_modules/.bin:$PATH &&     sed -i'' -e '/phantomjs/d' package.json &&     apk add git zeromq-dev protobuf-dev graphicsmagick &&     export JOBS=$(grep -c ^processor /proc/cpuinfo 2>/dev/null || 1) &&     echo 'npm install --no-optional' | su stf -s /bin/sh &&     echo '--- Assembling app' &&     echo 'npm pack' | su stf -s /bin/sh &&     tar -xzf stf-*.tgz &&     mv package /app &&     echo 'bower cache clean' | su stf -s /bin/sh &&     echo 'npm prune --production' | su stf -s /bin/sh &&     mv node_modules /app &&     chown -R root:root /app &&     echo '--- Cleaning up' &&     echo 'npm cache clean' | su stf -s /bin/sh &&     rm -rf /home/stf/.node-gyp &&     apk del curl make gcc g++ binutils-gold python linux-headers paxctl &&     rm -rf /node-v*       /usr/share/man /tmp/* /var/cache/apk/* /root/.npm /root/.node-gyp       /usr/lib/node_modules/npm/man /usr/lib/node_modules/npm/doc /usr/lib/node_modules/npm/html' returned a non-zero code: 137

I have no problem of disk space on my SD Card (64 Go), so do you have any idea about this fail ?
Sure the raspberry is not enough powerful, so what do you advise me to use as ARM hardware to build ? Do you think a cross compilation may be a good solution ?
Thanks.

De : Simo Kinnunen [mailto:notifications@github.com]
Envoyé : mercredi 11 octobre 2017 19:27
À : openstf/stf
Cc : BARBARON Denis IMT/OLS; Author
Objet : Re: [openstf/stf] is STF 3.1.0 available soon on ARM ? (#729)


It might just take a super long time. RPi is not very powerful. The full build can take several hours.

—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/729#issuecomment-335885018>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkCgC4OTrsqpzCIfCNrEd3-fiK8fdqks5srPpNgaJpZM4P1EhN>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 Thanks !

De : Simo Kinnunen [mailto:notifications@github.com]
Envoyé : jeudi 12 octobre 2017 09:07
À : openstf/stf
Cc : BARBARON Denis IMT/OLS; Author
Objet : Re: [openstf/stf] is STF 3.1.0 available soon on ARM ? (#729)


Yes that may work, docker makes it fairly easy nowadays. We use a Scaleway C1 which is only 2.99EUR per month. Build still takes an hour or more but it does at least finish. An ODROID XU4 is also able to finish the build, and relatively quickly too.

—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/729#issuecomment-336040266>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkChBzcAxnvrUg3dTbJ-DYx6U3DUbMks5srbqZgaJpZM4P1EhN>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 Just a detail perhaps, but I changed the release tag in “Dockerfile” from “3.5” to “edge” because in “mkimage-alpine.sh” file the “edge” tag is configured, otherwise the build fails at starting, do you think this changing may fails the build ? If I set the “3.5” tag in “mkimage-alpine.sh” file then the image building fails also at starting..

De : BARBARON Denis IMT/OLS
Envoyé : jeudi 12 octobre 2017 09:11
À : 'openstf/stf'
Objet : RE: [openstf/stf] is STF 3.1.0 available soon on ARM ? (#729)

Thanks !

De : Simo Kinnunen [mailto:notifications@github.com]
Envoyé : jeudi 12 octobre 2017 09:07
À : openstf/stf
Cc : BARBARON Denis IMT/OLS; Author
Objet : Re: [openstf/stf] is STF 3.1.0 available soon on ARM ? (#729)


Yes that may work, docker makes it fairly easy nowadays. We use a Scaleway C1 which is only 2.99EUR per month. Build still takes an hour or more but it does at least finish. An ODROID XU4 is also able to finish the build, and relatively quickly too.

—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/729#issuecomment-336040266>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkChBzcAxnvrUg3dTbJ-DYx6U3DUbMks5srbqZgaJpZM4P1EhN>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 Sorry, I read the README.md only, I will try that !
Thanks.

De : Simo Kinnunen [mailto:notifications@github.com]
Envoyé : jeudi 12 octobre 2017 11:47
À : openstf/stf
Cc : BARBARON Denis IMT/OLS; Author
Objet : Re: [openstf/stf] is STF 3.1.0 available soon on ARM ? (#729)


Check out https://github.com/openstf/stf/blob/master/docker/armv7l/stf-armv7l-baseimage%40.service. As you can see it sets an environment variable and also passes some options to the script.

—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/729#issuecomment-336078231>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkChLp4oA_MLtZM9oWXF1wyruIiR3Bks5srd_5gaJpZM4P1EhN>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 Finally, I took the Dockerfile for x86_64 architecture and adapted it for ARM, after what I successed to build the docker image for raspberry Pi3 in less than 40 mn, and it works well !

Obviously, the image size is about 714 MB while it is 311 MB for alpine, but it does not matter, do you see some potential drawbacks about this build ? Whatis the best way to share ? through a pull request ? you mean through docker hub ? ok, I took a debian source image but it should works well also with an ubuntu one:

```
FROM armv7/armhf-debian:latest

# Sneak the stf executable into $PATH.
ENV PATH /app/bin:$PATH

# Work in app dir by default.
WORKDIR /app

# Export default app port, not enough for all processes but it should do
# for now.
EXPOSE 3000

# Install app requirements. Trying to optimize push speed for dependant apps
# by reducing layers as much as possible. Note that one of the final steps
# installs development files for node-gyp so that npm install won't have to
# wait for them on the first native module installation.
RUN export DEBIAN_FRONTEND=noninteractive && \
    useradd --system \
      --create-home \
      --shell /usr/sbin/nologin \
      stf-build && \
    useradd --system \
      --create-home \
      --shell /usr/sbin/nologin \
      stf && \
    apt-get update && \
    apt-get -y install wget python build-essential && \
    cd /tmp && \
    wget --progress=dot:mega \
      https://nodejs.org/dist/v6.11.2/node-v6.11.2-linux-armv7l.tar.xz && \
    tar -xJf node-v*.tar.xz --strip-components 1 -C /usr/local && \
    rm node-v*.tar.xz && \
    su stf-build -s /bin/bash -c '/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js install' && \
    apt-get -y install libzmq3-dev libprotobuf-dev git graphicsmagick yasm && \
    apt-get clean && \
    rm -rf /var/cache/apt/* /var/lib/apt/lists/*

# Copy app source.
COPY . /tmp/build/

# Give permissions to our build user.
RUN mkdir -p /app && \
    chown -R stf-build:stf-build /tmp/build /app

# Switch over to the build user.
USER stf-build

# Run the build.
RUN set -x && \
    cd /tmp/build && \
    export PATH=$PWD/node_modules/.bin:$PATH && \
    sed -i'' -e '/phantomjs/d' package.json && \
    npm install --loglevel http && \
    npm pack && \
    tar xzf stf-*.tgz --strip-components 1 -C /app && \
    bower cache clean && \
    npm prune --production && \
    mv node_modules /app && \
    npm cache clean && \
    rm -rf ~/.node-gyp && \
    cd /app && \
    rm -rf /tmp/*

# Switch to the app user.
USER stf

# Show help by default.
CMD stf --help
```


 In synthesis, I just made the following modifications:
- replace `ubuntu:16.04` by `armv7/armhf-debian:latest`
- replace `node-v6.11.2-linux-x64.tar.xz` by `node-v6.11.2-linux-armv7l.tar.xz`
- add `sed -i'' -e '/phantomjs/d' package.json`  Good day!

I have STF deployed in Kubernetes. Now it has 4 real devices connected to real PC. Some time it works fine, but than it stops to work. I can not say how long it takes to get stuck, but after weekend it doesn't work as usually. 

Seems like something happens with the `device` component. I see the following:

1. This device exists in list of devices on web, but all detail fields of the device are ampty.

2. POST to API returns error:

```
# curl -X POST -H Content-Type: application/json -H Authorization: Bearer 44fc57bf30fc467d9381ba664c465285dbdf2b778a87488aa0482fe877269480 --data { "serial" : "3300a5cf2c4f233d" } http://api:3700/api/v1/user/devices
{"success":false,"description":"Device is not responding"}
```
3. Log contains messages from period when it worked find, now there is silence in it. I placed it at the bottom of the message.

4. Processes are alive, TCP ports for listening are open:

```
$ ps axwww
  PID TTY      STAT   TIME COMMAND
    1 ?        Ss     0:00 /bin/sh -c sleep 30 && stf provider --connect-sub "tcp://triproxy-dev:7250" --connect-push "tcp://triproxy-dev:7270" --min-port "15000" --max-port "25000" --heartbeat-interval "10000" --storage-url "https://stf.default.svc.agoda.mobi/" --screen-ws-url-pattern "wss://stf.default.svc.agoda.mobi/10.10.64.2/<%= publicPort %>/" --allow-remote --cleanup "false" 2>&1 | tee /var/log/stf/messages
    7 ?        Sl     0:00 node /app/bin/stf provider --connect-sub tcp://triproxy-dev:7250 --connect-push tcp://triproxy-dev:7270 --min-port 15000 --max-port 25000 --heartbeat-interval 10000 --storage-url https://stf.default.svc.agoda.mobi/ --screen-ws-url-pattern wss://stf.default.svc.agoda.mobi/10.10.64.2/<%= publicPort %>/ --allow-remote --cleanup false
    8 ?        S      0:00 tee /var/log/stf/messages
   64 ?        Ss+    0:00 /bin/sh
   70 ?        Ss+    0:00 /bin/bash
   98 ?        Ss+    0:00 /bin/bash
  114 ?        Sl     1:41 /usr/local/bin/node /app/lib/cli device --serial 3300a5fb184f2333 --provider stf-provider-real-1305165567-kz57b --screen-port 15016 --connect-port 15017 --vnc-port 15018 --public-ip 10.10.64.2 --group-timeout 900 --storage-url https://stf.default.svc.agoda.mobi/ --adb-host 127.0.0.1 --adb-port 5037 --screen-jpeg-quality 80 --screen-ping-interval 30000 --screen-ws-url-pattern wss://stf.default.svc.agoda.mobi/10.10.64.2/<%= publicPort %>/ --connect-url-pattern ${publicIp}:${publicPort} --heartbeat-interval 10000 --boot-complete-timeout 60000 --vnc-initial-size 600x800 --connect-sub tcp://triproxy-dev:7250 --connect-push tcp://triproxy-dev:7270 --no-cleanup
  126 ?        Sl     1:41 /usr/local/bin/node /app/lib/cli device --serial 3300a5ab28522391 --provider stf-provider-real-1305165567-kz57b --screen-port 15020 --connect-port 15021 --vnc-port 15022 --public-ip 10.10.64.2 --group-timeout 900 --storage-url https://stf.default.svc.agoda.mobi/ --adb-host 127.0.0.1 --adb-port 5037 --screen-jpeg-quality 80 --screen-ping-interval 30000 --screen-ws-url-pattern wss://stf.default.svc.agoda.mobi/10.10.64.2/<%= publicPort %>/ --connect-url-pattern ${publicIp}:${publicPort} --heartbeat-interval 10000 --boot-complete-timeout 60000 --vnc-initial-size 600x800 --connect-sub tcp://triproxy-dev:7250 --connect-push tcp://triproxy-dev:7270 --no-cleanup
  138 ?        Sl     1:03 /usr/local/bin/node /app/lib/cli device --serial 3300a5cf2c4f233d --provider stf-provider-real-1305165567-kz57b --screen-port 15024 --connect-port 15025 --vnc-port 15026 --public-ip 10.10.64.2 --group-timeout 900 --storage-url https://stf.default.svc.agoda.mobi/ --adb-host 127.0.0.1 --adb-port 5037 --screen-jpeg-quality 80 --screen-ping-interval 30000 --screen-ws-url-pattern wss://stf.default.svc.agoda.mobi/10.10.64.2/<%= publicPort %>/ --connect-url-pattern ${publicIp}:${publicPort} --heartbeat-interval 10000 --boot-complete-timeout 60000 --vnc-initial-size 600x800 --connect-sub tcp://triproxy-dev:7250 --connect-push tcp://triproxy-dev:7270 --no-cleanup
  150 ?        Sl     1:12 /usr/local/bin/node /app/lib/cli device --serial 3300a5c324502361 --provider stf-provider-real-1305165567-kz57b --screen-port 15028 --connect-port 15029 --vnc-port 15030 --public-ip 10.10.64.2 --group-timeout 900 --storage-url https://stf.default.svc.agoda.mobi/ --adb-host 127.0.0.1 --adb-port 5037 --screen-jpeg-quality 80 --screen-ping-interval 30000 --screen-ws-url-pattern wss://stf.default.svc.agoda.mobi/10.10.64.2/<%= publicPort %>/ --connect-url-pattern ${publicIp}:${publicPort} --heartbeat-interval 10000 --boot-complete-timeout 60000 --vnc-initial-size 600x800 --connect-sub tcp://triproxy-dev:7250 --connect-push tcp://triproxy-dev:7270 --no-cleanup
  191 ?        Ss     0:00 /bin/sh
  197 ?        R+     0:00 ps axwww
$ 
```

5. Devices are alive, I can connect to them:

```
/ # adb devices
List of devices attached
3300a5c324502361	device
3300a5cf2c4f233d	device
3300a5ab28522391	device
3300a5fb184f2333	device

/ # 
```

6. Restart of the 'device' component will solve the problem: I can kill it and start it again by the same command. Than it will work some time properly. 

Is there any ideas what to do? 

I can collect additional diagnostics if you advice how. 

**Please run `stf doctor` and paste the output here.**

```
$ stf doctor
INF/cli:doctor 204 [*] OS Arch: x64
INF/cli:doctor 204 [*] OS Platform: linux
INF/cli:doctor 204 [*] OS Platform: 4.12.14-coreos
INF/cli:doctor 204 [*] Using Node 6.11.2
INF/cli:doctor 204 [*] Using ZeroMQ 4.1.4
INF/cli:doctor 204 [*] Using GraphicsMagick 1.3.23
ERR/cli:doctor 204 [*] RethinkDB is not installed (`rethinkdb` is missing)
ERR/cli:doctor 204 [*] ProtoBuf is not installed (`protoc` is missing)
ERR/cli:doctor 204 [*] ADB is not installed (`adb` is missing)
$ 
```

The log:

```
$ cat /var/log/stf/*    
INF/provider 7 [*] Subscribing to permanent channel "Uwtfz7eYSami8YjRL85xUA=="
INF/provider 7 [*] Sending output to "tcp://triproxy-dev:7270"
INF/provider 7 [*] Receiving input from "tcp://triproxy-dev:7250"
INF/provider 7 [*] Tracking devices
INF/provider 7 [*] Found device "3300a5cf2c4f233d" (device)
INF/provider 7 [*] Found device "3300a5fb184f2333" (device)
INF/provider 7 [*] Found device "3300a5ab28522391" (device)
INF/provider 7 [*] Found device "3300a5c324502361" (device)
INF/provider 7 [*] Registered device "3300a5cf2c4f233d"
INF/provider 7 [*] Registered device "3300a5c324502361"
INF/provider 7 [*] Registered device "3300a5ab28522391"
INF/provider 7 [*] Registered device "3300a5fb184f2333"
INF/device:support:push 16 [3300a5cf2c4f233d] Sending output to "tcp://triproxy-dev:7270"
INF/device 16 [3300a5cf2c4f233d] Preparing device
INF/device:support:push 22 [3300a5c324502361] Sending output to "tcp://triproxy-dev:7270"
INF/device 22 [3300a5c324502361] Preparing device
INF/device:support:push 28 [3300a5ab28522391] Sending output to "tcp://triproxy-dev:7270"
INF/device 28 [3300a5ab28522391] Preparing device
INF/device:support:push 34 [3300a5fb184f2333] Sending output to "tcp://triproxy-dev:7270"
INF/device 34 [3300a5fb184f2333] Preparing device
INF/device:support:sub 16 [3300a5cf2c4f233d] Receiving input from "tcp://triproxy-dev:7250"
INF/device:support:sub 16 [3300a5cf2c4f233d] Subscribing to permanent channel "*ALL"
INF/device:support:sub 22 [3300a5c324502361] Receiving input from "tcp://triproxy-dev:7250"
INF/device:support:sub 22 [3300a5c324502361] Subscribing to permanent channel "*ALL"
INF/device:support:properties 16 [3300a5cf2c4f233d] Loading properties
INF/device:support:sub 28 [3300a5ab28522391] Receiving input from "tcp://triproxy-dev:7250"
INF/device:support:sub 28 [3300a5ab28522391] Subscribing to permanent channel "*ALL"
INF/device:support:sub 34 [3300a5fb184f2333] Receiving input from "tcp://triproxy-dev:7250"
INF/device:support:sub 34 [3300a5fb184f2333] Subscribing to permanent channel "*ALL"
INF/device:support:sdk 16 [3300a5cf2c4f233d] Supports SDK 24
INF/device:support:abi 16 [3300a5cf2c4f233d] Supports ABIs armeabi-v7a, armeabi
INF/device:support:properties 22 [3300a5c324502361] Loading properties
INF/provider 7 [*] Providing 0 of 4 device(s); waiting for "3300a5cf2c4f233d", "3300a5c324502361", "3300a5ab28522391", "3300a5fb184f2333"
INF/device:support:properties 28 [3300a5ab28522391] Loading properties
INF/device:support:sdk 22 [3300a5c324502361] Supports SDK 24
INF/device:support:abi 22 [3300a5c324502361] Supports ABIs armeabi-v7a, armeabi
INF/device:support:properties 34 [3300a5fb184f2333] Loading properties
INF/device:support:sdk 28 [3300a5ab28522391] Supports SDK 24
INF/device:support:abi 28 [3300a5ab28522391] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:minicap 16 [3300a5cf2c4f233d] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 16 [3300a5cf2c4f233d] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:support:sdk 34 [3300a5fb184f2333] Supports SDK 24
INF/device:support:abi 34 [3300a5fb184f2333] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:minicap 22 [3300a5c324502361] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 22 [3300a5c324502361] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:minicap 28 [3300a5ab28522391] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 28 [3300a5ab28522391] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 16 [3300a5cf2c4f233d] Checking whether we need to install STFService
INF/device:resources:minicap 34 [3300a5fb184f2333] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 34 [3300a5fb184f2333] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 28 [3300a5ab28522391] Checking whether we need to install STFService
INF/device:resources:service 22 [3300a5c324502361] Checking whether we need to install STFService
INF/device:resources:service 34 [3300a5fb184f2333] Checking whether we need to install STFService
INF/device:resources:service 16 [3300a5cf2c4f233d] Running version check
INF/device:resources:service 34 [3300a5fb184f2333] Running version check
INF/device:resources:service 22 [3300a5c324502361] Running version check
INF/device:resources:service 28 [3300a5ab28522391] Running version check
INF/device:resources:service 34 [3300a5fb184f2333] STFService up to date
INF/device:plugins:service 34 [3300a5fb184f2333] Launching agent
INF/device:resources:service 16 [3300a5cf2c4f233d] STFService up to date
INF/device:plugins:service 16 [3300a5cf2c4f233d] Launching agent
INF/device:resources:service 28 [3300a5ab28522391] STFService up to date
INF/device:plugins:service 28 [3300a5ab28522391] Launching agent
INF/device:resources:service 22 [3300a5c324502361] STFService up to date
INF/device:plugins:service 22 [3300a5c324502361] Launching agent
INF/device:plugins:service 34 [3300a5fb184f2333] Agent says: "Listening on @stfagent"
INF/device:plugins:service 34 [3300a5fb184f2333] Launching service
INF/device:plugins:service 34 [3300a5fb184f2333] Agent says: "InputClient started"
INF/device:plugins:service 16 [3300a5cf2c4f233d] Agent says: "Listening on @stfagent"
INF/device:plugins:service 16 [3300a5cf2c4f233d] Launching service
INF/device:plugins:service 16 [3300a5cf2c4f233d] Agent says: "InputClient started"
INF/device:plugins:service 28 [3300a5ab28522391] Agent says: "Listening on @stfagent"
INF/device:plugins:service 22 [3300a5c324502361] Agent says: "Listening on @stfagent"
INF/device:plugins:service 28 [3300a5ab28522391] Launching service
INF/device:plugins:service 22 [3300a5c324502361] Launching service
INF/device:plugins:service 22 [3300a5c324502361] Agent says: "InputClient started"
INF/device:plugins:service 28 [3300a5ab28522391] Agent says: "InputClient started"
INF/device:plugins:display 34 [3300a5fb184f2333] Reading display info
INF/device:plugins:phone 34 [3300a5fb184f2333] Fetching phone info
INF/device:plugins:display 16 [3300a5cf2c4f233d] Reading display info
INF/device:plugins:identity 34 [3300a5fb184f2333] Solving identity
INF/device:plugins:solo 34 [3300a5fb184f2333] Subscribing to permanent channel "Y0yxLfmkDNd+2AtgUkKv/XZ4SOM="
INF/device:plugins:screen:stream 34 [3300a5fb184f2333] Starting WebSocket server on port 15012
INF/device:plugins:phone 16 [3300a5cf2c4f233d] Fetching phone info
INF/device:plugins:identity 16 [3300a5cf2c4f233d] Solving identity
INF/device:plugins:solo 16 [3300a5cf2c4f233d] Subscribing to permanent channel "v3nRtvU1PnevNxRTxKXK7FUy41U="
INF/device:plugins:screen:stream 16 [3300a5cf2c4f233d] Starting WebSocket server on port 15000
INF/device:plugins:display 22 [3300a5c324502361] Reading display info
INF/device:plugins:display 28 [3300a5ab28522391] Reading display info
INF/device:plugins:phone 22 [3300a5c324502361] Fetching phone info
INF/device:plugins:phone 28 [3300a5ab28522391] Fetching phone info
INF/device:plugins:identity 28 [3300a5ab28522391] Solving identity
INF/device:plugins:solo 28 [3300a5ab28522391] Subscribing to permanent channel "LdyjAFjtwP4BTgbpL5hRr9XTkaA="
INF/device:plugins:screen:stream 28 [3300a5ab28522391] Starting WebSocket server on port 15008
INF/device:plugins:identity 22 [3300a5c324502361] Solving identity
INF/device:plugins:solo 22 [3300a5c324502361] Subscribing to permanent channel "Ejq2HUqsAnKkiDV3mIGoBCz0JVw="
INF/device:plugins:screen:stream 22 [3300a5c324502361] Starting WebSocket server on port 15004
INF/device:resources:minitouch 34 [3300a5fb184f2333] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
INF/device:resources:minitouch 16 [3300a5cf2c4f233d] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
WRN/device:plugins:data 34 [3300a5fb184f2333] Unable to find device data { serial: '3300a5fb184f2333',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'SM-T815Y',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'gts210ltedx',
  display: 
   { id: 0,
     width: 1536,
     height: 2048,
     xdpi: 265.40399169921875,
     ydpi: 264.0559997558594,
     fps: 59,
     density: 2,
     rotation: 0,
     secure: true,
     size: 9.6772154390038,
     url: 'wss://stf.default.svc.agoda.mobi/10.10.64.2/15012/' },
  phone: { imei: '353967070933679', network: 'UNKNOWN' } }
INF/device:plugins:touch 34 [3300a5fb184f2333] Touch origin is top left
INF/device:plugins:touch 34 [3300a5fb184f2333] Requesting touch consumer to start
INF/device:plugins:touch 34 [3300a5fb184f2333] Launching screen service
INF/device:plugins:touch 34 [3300a5fb184f2333] Connecting to minitouch service
INF/device:resources:minitouch 22 [3300a5c324502361] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
WRN/device:plugins:data 16 [3300a5cf2c4f233d] Unable to find device data { serial: '3300a5cf2c4f233d',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'SM-T815Y',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'gts210ltedx',
  display: 
   { id: 0,
     width: 1536,
     height: 2048,
     xdpi: 265.40399169921875,
     ydpi: 264.0559997558594,
     fps: 59,
     density: 2,
     rotation: 0,
     secure: true,
     size: 9.6772154390038,
     url: 'wss://stf.default.svc.agoda.mobi/10.10.64.2/15000/' },
  phone: { imei: '353967070933604', network: 'UNKNOWN' } }
INF/device:resources:minitouch 28 [3300a5ab28522391] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
INF/device:plugins:touch 16 [3300a5cf2c4f233d] Touch origin is top left
INF/device:plugins:touch 16 [3300a5cf2c4f233d] Requesting touch consumer to start
INF/device:plugins:touch 16 [3300a5cf2c4f233d] Launching screen service
INF/device:plugins:touch 16 [3300a5cf2c4f233d] Connecting to minitouch service
INF/device:plugins:touch 34 [3300a5fb184f2333] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 16 [3300a5cf2c4f233d] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
WRN/device:plugins:data 28 [3300a5ab28522391] Unable to find device data { serial: '3300a5ab28522391',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'SM-T815Y',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'gts210ltedx',
  display: 
   { id: 0,
     width: 1536,
     height: 2048,
     xdpi: 265.40399169921875,
     ydpi: 264.0559997558594,
     fps: 59,
     density: 2,
     rotation: 0,
     secure: true,
     size: 9.6772154390038,
     url: 'wss://stf.default.svc.agoda.mobi/10.10.64.2/15008/' },
  phone: { imei: '353967070934545', network: 'UNKNOWN' } }
INF/device:plugins:touch 28 [3300a5ab28522391] Touch origin is top left
INF/device:plugins:touch 28 [3300a5ab28522391] Requesting touch consumer to start
INF/device:plugins:touch 28 [3300a5ab28522391] Launching screen service
WRN/device:plugins:data 22 [3300a5c324502361] Unable to find device data { serial: '3300a5c324502361',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'SM-T815Y',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'gts210ltedx',
  display: 
   { id: 0,
     width: 1536,
     height: 2048,
     xdpi: 265.40399169921875,
     ydpi: 264.0559997558594,
     fps: 59,
     density: 2,
     rotation: 0,
     secure: true,
     size: 9.6772154390038,
     url: 'wss://stf.default.svc.agoda.mobi/10.10.64.2/15004/' },
  phone: { imei: '353967070933331', network: 'UNKNOWN' } }
INF/device:plugins:touch 22 [3300a5c324502361] Touch origin is top left
INF/device:plugins:touch 22 [3300a5c324502361] Requesting touch consumer to start
INF/device:plugins:touch 22 [3300a5c324502361] Launching screen service
INF/device:plugins:touch 34 [3300a5fb184f2333] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 28 [3300a5ab28522391] Connecting to minitouch service
INF/device:plugins:touch 22 [3300a5c324502361] Connecting to minitouch service
INF/device:plugins:touch 16 [3300a5cf2c4f233d] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 28 [3300a5ab28522391] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 22 [3300a5c324502361] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 34 [3300a5fb184f2333] minitouch says: "Type B touch device sec_touchscreen (1535x2047 with 10 contacts) detected on /dev/input/event3 (score 2109)"
INF/device:plugins:touch 28 [3300a5ab28522391] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 16 [3300a5cf2c4f233d] minitouch says: "Type B touch device sec_touchscreen (1535x2047 with 10 contacts) detected on /dev/input/event3 (score 2109)"
INF/device:plugins:touch 22 [3300a5c324502361] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 28 [3300a5ab28522391] minitouch says: "Type B touch device sec_touchscreen (1535x2047 with 10 contacts) detected on /dev/input/event3 (score 2109)"
INF/device:plugins:touch 22 [3300a5c324502361] minitouch says: "Type B touch device sec_touchscreen (1535x2047 with 10 contacts) detected on /dev/input/event3 (score 2109)"
INF/device:plugins:touch 22 [3300a5c324502361] Reading minitouch banner
INF/device:plugins:touch 22 [3300a5c324502361] minitouch says: "Connection established"
INF/device:plugins:vnc 22 [3300a5c324502361] Starting VNC server on port 15006
INF/device:plugins:browser 22 [3300a5c324502361] Loading browser list
INF/device:plugins:browser 22 [3300a5c324502361] Updating browser list
INF/device:plugins:mute 22 [3300a5c324502361] Will not mute master volume during use
INF/device:plugins:touch 34 [3300a5fb184f2333] Reading minitouch banner
INF/device:plugins:touch 34 [3300a5fb184f2333] minitouch says: "Connection established"
INF/device:plugins:touch 16 [3300a5cf2c4f233d] Reading minitouch banner
INF/device:plugins:touch 16 [3300a5cf2c4f233d] minitouch says: "Connection established"
INF/device:plugins:vnc 34 [3300a5fb184f2333] Starting VNC server on port 15014
INF/device:plugins:browser 34 [3300a5fb184f2333] Loading browser list
INF/device:plugins:vnc 16 [3300a5cf2c4f233d] Starting VNC server on port 15002
INF/device:plugins:browser 16 [3300a5cf2c4f233d] Loading browser list
INF/device:plugins:browser 34 [3300a5fb184f2333] Updating browser list
INF/device:plugins:mute 34 [3300a5fb184f2333] Will not mute master volume during use
INF/device:plugins:browser 16 [3300a5cf2c4f233d] Updating browser list
INF/device:plugins:mute 16 [3300a5cf2c4f233d] Will not mute master volume during use
INF/device:plugins:touch 28 [3300a5ab28522391] Reading minitouch banner
INF/device:plugins:touch 28 [3300a5ab28522391] minitouch says: "Connection established"
INF/device:resources:minirev 22 [3300a5c324502361] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:vnc 28 [3300a5ab28522391] Starting VNC server on port 15010
INF/device:plugins:browser 28 [3300a5ab28522391] Loading browser list
INF/device:plugins:browser 28 [3300a5ab28522391] Updating browser list
INF/device:plugins:mute 28 [3300a5ab28522391] Will not mute master volume during use
INF/device:resources:minirev 34 [3300a5fb184f2333] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 22 [3300a5c324502361] Launching reverse port forwarding service
INF/device:plugins:forward 22 [3300a5c324502361] Connecting to reverse port forwarding service
INF/device:resources:minirev 16 [3300a5cf2c4f233d] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 34 [3300a5fb184f2333] Launching reverse port forwarding service
INF/device:plugins:connect 22 [3300a5c324502361] Listening on port 15005
INF/device 22 [3300a5c324502361] Fully operational
INF/device:resources:minirev 28 [3300a5ab28522391] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 34 [3300a5fb184f2333] Connecting to reverse port forwarding service
INF/device:plugins:forward 16 [3300a5cf2c4f233d] Launching reverse port forwarding service
INF/device:plugins:forward 16 [3300a5cf2c4f233d] Connecting to reverse port forwarding service
INF/device:plugins:forward 28 [3300a5ab28522391] Launching reverse port forwarding service
INF/device:plugins:connect 34 [3300a5fb184f2333] Listening on port 15013
INF/device 34 [3300a5fb184f2333] Fully operational
INF/device:plugins:connect 16 [3300a5cf2c4f233d] Listening on port 15001
INF/device:plugins:forward 28 [3300a5ab28522391] Connecting to reverse port forwarding service
INF/device 16 [3300a5cf2c4f233d] Fully operational
INF/device:plugins:connect 28 [3300a5ab28522391] Listening on port 15009
INF/device 28 [3300a5ab28522391] Fully operational
INF/provider 7 [*] Providing all 4 device(s)
INF/util:lifecycle 22 [3300a5c324502361] Winding down for graceful exit
INF/device:plugins:screen:stream 22 [3300a5c324502361] Requesting frame producer to stop
INF/provider 7 [*] Device worker "3300a5c324502361" stopped cleanly
INF/provider 7 [*] Cleaning up device worker "3300a5c324502361"
INF/provider 7 [*] Device worker "3300a5c324502361" has retired
INF/provider 7 [*] Lost device "3300a5fb184f2333" (device)
IMP/device:plugins:service 34 [3300a5fb184f2333] Agent connection ended, attempting to relaunch
INF/device:plugins:service 34 [3300a5fb184f2333] Launching service
INF/provider 7 [*] Shutting down device worker "3300a5fb184f2333"
IMP/device:plugins:service 34 [3300a5fb184f2333] Service connection ended, attempting to relaunch
INF/device:plugins:service 34 [3300a5fb184f2333] Launching service
INF/provider 7 [*] Cleaning up device worker "3300a5fb184f2333"
WRN/device:plugins:touch 34 [3300a5fb184f2333] Shell keeping minitouch running ended unexpectedly
INF/provider 7 [*] Gracefully killing device worker "3300a5fb184f2333"
INF/device:plugins:touch 34 [3300a5fb184f2333] Disconnecting from minitouch service
FTL/util:lifecycle 34 [3300a5fb184f2333] Forward shell ended; we shall share its fate
FTL/util:lifecycle 34 [3300a5fb184f2333] Shutting down due to fatal error
INF/provider 7 [*] Device worker "3300a5fb184f2333" has retired
INF/provider 7 [*] Found device "3300a5fb184f2333" (offline)
INF/provider 7 [*] Registered device "3300a5fb184f2333"
INF/provider 7 [*] Device "3300a5fb184f2333" is now "device" (was "offline")
INF/device:support:push 114 [3300a5fb184f2333] Sending output to "tcp://triproxy-dev:7270"
INF/device 114 [3300a5fb184f2333] Preparing device
INF/device:support:sub 114 [3300a5fb184f2333] Receiving input from "tcp://triproxy-dev:7250"
INF/device:support:sub 114 [3300a5fb184f2333] Subscribing to permanent channel "*ALL"
INF/device:support:properties 114 [3300a5fb184f2333] Loading properties
INF/device:support:sdk 114 [3300a5fb184f2333] Supports SDK 24
INF/device:support:abi 114 [3300a5fb184f2333] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:minicap 114 [3300a5fb184f2333] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 114 [3300a5fb184f2333] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 114 [3300a5fb184f2333] Checking whether we need to install STFService
INF/device:resources:service 114 [3300a5fb184f2333] Running version check
INF/device:resources:service 114 [3300a5fb184f2333] STFService up to date
INF/device:plugins:service 114 [3300a5fb184f2333] Launching agent
INF/device:plugins:service 114 [3300a5fb184f2333] Agent says: "Listening on @stfagent"
INF/device:plugins:service 114 [3300a5fb184f2333] Launching service
INF/device:plugins:service 114 [3300a5fb184f2333] Agent says: "InputClient started"
INF/device:plugins:display 114 [3300a5fb184f2333] Reading display info
INF/device:plugins:phone 114 [3300a5fb184f2333] Fetching phone info
INF/device:plugins:identity 114 [3300a5fb184f2333] Solving identity
INF/device:plugins:solo 114 [3300a5fb184f2333] Subscribing to permanent channel "Y0yxLfmkDNd+2AtgUkKv/XZ4SOM="
INF/device:plugins:screen:stream 114 [3300a5fb184f2333] Starting WebSocket server on port 15016
INF/device:resources:minitouch 114 [3300a5fb184f2333] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
WRN/device:plugins:data 114 [3300a5fb184f2333] Unable to find device data { serial: '3300a5fb184f2333',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'SM-T815Y',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'gts210ltedx',
  display: 
   { id: 0,
     width: 1536,
     height: 2048,
     xdpi: 265.40399169921875,
     ydpi: 264.0559997558594,
     fps: 59,
     density: 2,
     rotation: 0,
     secure: true,
     size: 9.6772154390038,
     url: 'wss://stf.default.svc.agoda.mobi/10.10.64.2/15016/' },
  phone: { imei: '353967070933679', network: 'UNKNOWN' } }
INF/device:plugins:touch 114 [3300a5fb184f2333] Touch origin is top left
INF/device:plugins:touch 114 [3300a5fb184f2333] Requesting touch consumer to start
INF/device:plugins:touch 114 [3300a5fb184f2333] Launching screen service
INF/device:plugins:touch 114 [3300a5fb184f2333] Connecting to minitouch service
INF/device:plugins:touch 114 [3300a5fb184f2333] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 114 [3300a5fb184f2333] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 114 [3300a5fb184f2333] minitouch says: "Type B touch device sec_touchscreen (1535x2047 with 10 contacts) detected on /dev/input/event3 (score 2109)"
INF/device:plugins:touch 114 [3300a5fb184f2333] Reading minitouch banner
INF/device:plugins:touch 114 [3300a5fb184f2333] minitouch says: "Connection established"
INF/device:plugins:vnc 114 [3300a5fb184f2333] Starting VNC server on port 15018
INF/device:plugins:browser 114 [3300a5fb184f2333] Loading browser list
INF/device:plugins:browser 114 [3300a5fb184f2333] Updating browser list
INF/device:plugins:mute 114 [3300a5fb184f2333] Will not mute master volume during use
INF/device:resources:minirev 114 [3300a5fb184f2333] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 114 [3300a5fb184f2333] Launching reverse port forwarding service
INF/device:plugins:forward 114 [3300a5fb184f2333] Connecting to reverse port forwarding service
INF/device:plugins:connect 114 [3300a5fb184f2333] Listening on port 15017
INF/device 114 [3300a5fb184f2333] Fully operational
INF/provider 7 [*] Providing all 3 of 4 device(s); ignoring "3300a5c324502361"
IMP/device:plugins:service 28 [3300a5ab28522391] Agent connection ended, attempting to relaunch
INF/device:plugins:service 28 [3300a5ab28522391] Launching service
INF/provider 7 [*] Lost device "3300a5ab28522391" (device)
IMP/device:plugins:service 28 [3300a5ab28522391] Service connection ended, attempting to relaunch
INF/provider 7 [*] Shutting down device worker "3300a5ab28522391"
INF/device:plugins:service 28 [3300a5ab28522391] Launching service
WRN/device:plugins:touch 28 [3300a5ab28522391] Shell keeping minitouch running ended unexpectedly
INF/provider 7 [*] Cleaning up device worker "3300a5ab28522391"
INF/provider 7 [*] Gracefully killing device worker "3300a5ab28522391"
INF/device:plugins:touch 28 [3300a5ab28522391] Disconnecting from minitouch service
FTL/util:lifecycle 28 [3300a5ab28522391] Forward shell ended; we shall share its fate
FTL/util:lifecycle 28 [3300a5ab28522391] Shutting down due to fatal error
INF/provider 7 [*] Device worker "3300a5ab28522391" has retired
INF/provider 7 [*] Found device "3300a5ab28522391" (offline)
INF/provider 7 [*] Registered device "3300a5ab28522391"
INF/provider 7 [*] Device "3300a5ab28522391" is now "device" (was "offline")
INF/device:support:push 126 [3300a5ab28522391] Sending output to "tcp://triproxy-dev:7270"
INF/device 126 [3300a5ab28522391] Preparing device
INF/device:support:sub 126 [3300a5ab28522391] Receiving input from "tcp://triproxy-dev:7250"
INF/device:support:sub 126 [3300a5ab28522391] Subscribing to permanent channel "*ALL"
INF/device:support:properties 126 [3300a5ab28522391] Loading properties
INF/device:support:sdk 126 [3300a5ab28522391] Supports SDK 24
INF/device:support:abi 126 [3300a5ab28522391] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:minicap 126 [3300a5ab28522391] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 126 [3300a5ab28522391] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 126 [3300a5ab28522391] Checking whether we need to install STFService
INF/device:resources:service 126 [3300a5ab28522391] Running version check
INF/device:resources:service 126 [3300a5ab28522391] STFService up to date
INF/device:plugins:service 126 [3300a5ab28522391] Launching agent
INF/device:plugins:service 126 [3300a5ab28522391] Agent says: "Listening on @stfagent"
INF/device:plugins:service 126 [3300a5ab28522391] Launching service
INF/device:plugins:service 126 [3300a5ab28522391] Agent says: "InputClient started"
INF/device:plugins:display 126 [3300a5ab28522391] Reading display info
INF/device:plugins:phone 126 [3300a5ab28522391] Fetching phone info
INF/device:plugins:identity 126 [3300a5ab28522391] Solving identity
INF/device:plugins:solo 126 [3300a5ab28522391] Subscribing to permanent channel "LdyjAFjtwP4BTgbpL5hRr9XTkaA="
INF/device:plugins:screen:stream 126 [3300a5ab28522391] Starting WebSocket server on port 15020
INF/device:resources:minitouch 126 [3300a5ab28522391] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
WRN/device:plugins:data 126 [3300a5ab28522391] Unable to find device data { serial: '3300a5ab28522391',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'SM-T815Y',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'gts210ltedx',
  display: 
   { id: 0,
     width: 1536,
     height: 2048,
     xdpi: 265.40399169921875,
     ydpi: 264.0559997558594,
     fps: 59,
     density: 2,
     rotation: 0,
     secure: true,
     size: 9.6772154390038,
     url: 'wss://stf.default.svc.agoda.mobi/10.10.64.2/15020/' },
  phone: { imei: '353967070934545', network: 'UNKNOWN' } }
INF/device:plugins:touch 126 [3300a5ab28522391] Touch origin is top left
INF/device:plugins:touch 126 [3300a5ab28522391] Requesting touch consumer to start
INF/device:plugins:touch 126 [3300a5ab28522391] Launching screen service
INF/device:plugins:touch 126 [3300a5ab28522391] Connecting to minitouch service
INF/device:plugins:touch 126 [3300a5ab28522391] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 126 [3300a5ab28522391] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 126 [3300a5ab28522391] minitouch says: "Type B touch device sec_touchscreen (1535x2047 with 10 contacts) detected on /dev/input/event3 (score 2109)"
INF/device:plugins:touch 126 [3300a5ab28522391] Reading minitouch banner
INF/device:plugins:touch 126 [3300a5ab28522391] minitouch says: "Connection established"
INF/device:plugins:vnc 126 [3300a5ab28522391] Starting VNC server on port 15022
INF/device:plugins:browser 126 [3300a5ab28522391] Loading browser list
INF/device:plugins:browser 126 [3300a5ab28522391] Updating browser list
INF/device:plugins:mute 126 [3300a5ab28522391] Will not mute master volume during use
INF/device:resources:minirev 126 [3300a5ab28522391] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 126 [3300a5ab28522391] Launching reverse port forwarding service
INF/device:plugins:forward 126 [3300a5ab28522391] Connecting to reverse port forwarding service
INF/device:plugins:connect 126 [3300a5ab28522391] Listening on port 15021
INF/device 126 [3300a5ab28522391] Fully operational
INF/provider 7 [*] Providing all 3 of 4 device(s); ignoring "3300a5c324502361"
IMP/device:plugins:service 16 [3300a5cf2c4f233d] Agent connection ended, attempting to relaunch
INF/provider 7 [*] Lost device "3300a5cf2c4f233d" (device)
INF/device:plugins:service 16 [3300a5cf2c4f233d] Launching service
INF/provider 7 [*] Shutting down device worker "3300a5cf2c4f233d"
INF/provider 7 [*] Cleaning up device worker "3300a5cf2c4f233d"
INF/provider 7 [*] Gracefully killing device worker "3300a5cf2c4f233d"
IMP/device:plugins:service 16 [3300a5cf2c4f233d] Service connection ended, attempting to relaunch
INF/device:plugins:service 16 [3300a5cf2c4f233d] Launching service
WRN/device:plugins:touch 16 [3300a5cf2c4f233d] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 16 [3300a5cf2c4f233d] Disconnecting from minitouch service
FTL/util:lifecycle 16 [3300a5cf2c4f233d] Forward shell ended; we shall share its fate
FTL/util:lifecycle 16 [3300a5cf2c4f233d] Shutting down due to fatal error
INF/provider 7 [*] Device worker "3300a5cf2c4f233d" has retired
INF/provider 7 [*] Found device "3300a5cf2c4f233d" (offline)
INF/provider 7 [*] Lost device "3300a5c324502361" (device)
INF/provider 7 [*] Registered device "3300a5cf2c4f233d"
INF/provider 7 [*] Device "3300a5cf2c4f233d" is now "device" (was "offline")
INF/device:support:push 138 [3300a5cf2c4f233d] Sending output to "tcp://triproxy-dev:7270"
INF/device 138 [3300a5cf2c4f233d] Preparing device
INF/device:support:sub 138 [3300a5cf2c4f233d] Receiving input from "tcp://triproxy-dev:7250"
INF/device:support:sub 138 [3300a5cf2c4f233d] Subscribing to permanent channel "*ALL"
INF/device:support:properties 138 [3300a5cf2c4f233d] Loading properties
INF/device:support:sdk 138 [3300a5cf2c4f233d] Supports SDK 24
INF/device:support:abi 138 [3300a5cf2c4f233d] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:minicap 138 [3300a5cf2c4f233d] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 138 [3300a5cf2c4f233d] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 138 [3300a5cf2c4f233d] Checking whether we need to install STFService
INF/provider 7 [*] Found device "3300a5c324502361" (offline)
INF/provider 7 [*] Registered device "3300a5c324502361"
INF/provider 7 [*] Device "3300a5c324502361" is now "device" (was "offline")
INF/device:resources:service 138 [3300a5cf2c4f233d] Running version check
INF/device:support:push 150 [3300a5c324502361] Sending output to "tcp://triproxy-dev:7270"
INF/device 150 [3300a5c324502361] Preparing device
INF/device:resources:service 138 [3300a5cf2c4f233d] STFService up to date
INF/device:plugins:service 138 [3300a5cf2c4f233d] Launching agent
INF/device:support:sub 150 [3300a5c324502361] Receiving input from "tcp://triproxy-dev:7250"
INF/device:support:sub 150 [3300a5c324502361] Subscribing to permanent channel "*ALL"
INF/device:support:properties 150 [3300a5c324502361] Loading properties
INF/device:support:sdk 150 [3300a5c324502361] Supports SDK 24
INF/device:support:abi 150 [3300a5c324502361] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:minicap 150 [3300a5c324502361] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 150 [3300a5c324502361] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-24/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:plugins:service 138 [3300a5cf2c4f233d] Agent says: "Listening on @stfagent"
INF/device:plugins:service 138 [3300a5cf2c4f233d] Launching service
INF/device:plugins:service 138 [3300a5cf2c4f233d] Agent says: "InputClient started"
INF/device:resources:service 150 [3300a5c324502361] Checking whether we need to install STFService
INF/device:plugins:display 138 [3300a5cf2c4f233d] Reading display info
INF/device:plugins:phone 138 [3300a5cf2c4f233d] Fetching phone info
INF/device:plugins:identity 138 [3300a5cf2c4f233d] Solving identity
INF/device:plugins:solo 138 [3300a5cf2c4f233d] Subscribing to permanent channel "v3nRtvU1PnevNxRTxKXK7FUy41U="
INF/device:plugins:screen:stream 138 [3300a5cf2c4f233d] Starting WebSocket server on port 15024
INF/device:resources:service 150 [3300a5c324502361] Running version check
INF/device:resources:minitouch 138 [3300a5cf2c4f233d] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
WRN/device:plugins:data 138 [3300a5cf2c4f233d] Unable to find device data { serial: '3300a5cf2c4f233d',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'SM-T815Y',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'gts210ltedx',
  display: 
   { id: 0,
     width: 1536,
     height: 2048,
     xdpi: 265.40399169921875,
     ydpi: 264.0559997558594,
     fps: 59,
     density: 2,
     rotation: 0,
     secure: true,
     size: 9.6772154390038,
     url: 'wss://stf.default.svc.agoda.mobi/10.10.64.2/15024/' },
  phone: { imei: '353967070933604', network: 'UNKNOWN' } }
INF/device:plugins:touch 138 [3300a5cf2c4f233d] Touch origin is top left
INF/device:plugins:touch 138 [3300a5cf2c4f233d] Requesting touch consumer to start
INF/device:plugins:touch 138 [3300a5cf2c4f233d] Launching screen service
INF/device:plugins:touch 138 [3300a5cf2c4f233d] Connecting to minitouch service
INF/device:plugins:touch 138 [3300a5cf2c4f233d] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 138 [3300a5cf2c4f233d] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 138 [3300a5cf2c4f233d] minitouch says: "Type B touch device sec_touchscreen (1535x2047 with 10 contacts) detected on /dev/input/event3 (score 2109)"
INF/device:resources:service 150 [3300a5c324502361] STFService up to date
INF/device:plugins:service 150 [3300a5c324502361] Launching agent
INF/device:plugins:touch 138 [3300a5cf2c4f233d] Reading minitouch banner
INF/device:plugins:touch 138 [3300a5cf2c4f233d] minitouch says: "Connection established"
INF/device:plugins:vnc 138 [3300a5cf2c4f233d] Starting VNC server on port 15026
INF/device:plugins:browser 138 [3300a5cf2c4f233d] Loading browser list
INF/device:plugins:browser 138 [3300a5cf2c4f233d] Updating browser list
INF/device:plugins:mute 138 [3300a5cf2c4f233d] Will not mute master volume during use
INF/device:resources:minirev 138 [3300a5cf2c4f233d] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 138 [3300a5cf2c4f233d] Launching reverse port forwarding service
INF/device:plugins:forward 138 [3300a5cf2c4f233d] Connecting to reverse port forwarding service
INF/device:plugins:connect 138 [3300a5cf2c4f233d] Listening on port 15025
INF/device 138 [3300a5cf2c4f233d] Fully operational
INF/device:plugins:service 150 [3300a5c324502361] Agent says: "Listening on @stfagent"
INF/device:plugins:service 150 [3300a5c324502361] Launching service
INF/device:plugins:service 150 [3300a5c324502361] Agent says: "InputClient started"
INF/device:plugins:display 150 [3300a5c324502361] Reading display info
INF/device:plugins:phone 150 [3300a5c324502361] Fetching phone info
INF/device:plugins:identity 150 [3300a5c324502361] Solving identity
INF/device:plugins:solo 150 [3300a5c324502361] Subscribing to permanent channel "Ejq2HUqsAnKkiDV3mIGoBCz0JVw="
INF/device:plugins:screen:stream 150 [3300a5c324502361] Starting WebSocket server on port 15028
INF/device:resources:minitouch 150 [3300a5c324502361] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
WRN/device:plugins:data 150 [3300a5c324502361] Unable to find device data { serial: '3300a5c324502361',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'SM-T815Y',
  version: '7.0',
  abi: 'armeabi-v7a',
  sdk: '24',
  product: 'gts210ltedx',
  display: 
   { id: 0,
     width: 1536,
     height: 2048,
     xdpi: 265.40399169921875,
     ydpi: 264.0559997558594,
     fps: 59,
     density: 2,
     rotation: 0,
     secure: true,
     size: 9.6772154390038,
     url: 'wss://stf.default.svc.agoda.mobi/10.10.64.2/15028/' },
  phone: { imei: '353967070933331', network: 'UNKNOWN' } }
INF/device:plugins:touch 150 [3300a5c324502361] Touch origin is top left
INF/device:plugins:touch 150 [3300a5c324502361] Requesting touch consumer to start
INF/device:plugins:touch 150 [3300a5c324502361] Launching screen service
INF/device:plugins:touch 150 [3300a5c324502361] Connecting to minitouch service
INF/device:plugins:touch 150 [3300a5c324502361] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 150 [3300a5c324502361] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 150 [3300a5c324502361] minitouch says: "Type B touch device sec_touchscreen (1535x2047 with 10 contacts) detected on /dev/input/event3 (score 2109)"
INF/device:plugins:touch 150 [3300a5c324502361] Reading minitouch banner
INF/device:plugins:touch 150 [3300a5c324502361] minitouch says: "Connection established"
INF/device:plugins:vnc 150 [3300a5c324502361] Starting VNC server on port 15030
INF/device:plugins:browser 150 [3300a5c324502361] Loading browser list
INF/device:plugins:browser 150 [3300a5c324502361] Updating browser list
INF/device:plugins:mute 150 [3300a5c324502361] Will not mute master volume during use
INF/device:resources:minirev 150 [3300a5c324502361] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 150 [3300a5c324502361] Launching reverse port forwarding service
INF/device:plugins:forward 150 [3300a5c324502361] Connecting to reverse port forwarding service
INF/device:plugins:connect 150 [3300a5c324502361] Listening on port 15029
INF/device 150 [3300a5c324502361] Fully operational
INF/provider 7 [*] Providing all 4 device(s)
IMP/device:plugins:group 114 [3300a5fb184f2333] Now owned by "svarog-5@agoda.com"
INF/device:plugins:group 114 [3300a5fb184f2333] Subscribing to group channel "DsWrL2FcTm+gpW+MKq0Cug=="
IMP/device:plugins:connect 114 [3300a5fb184f2333] Remote Connect Started for device "3300a5fb184f2333" at "10.10.64.2:15017"
INF/device:plugins:connect 114 [3300a5fb184f2333] New remote ADB connection from ::ffff:10.10.42.4
IMP/device:plugins:group 138 [3300a5cf2c4f233d] Now owned by "svarog-5@agoda.com"
INF/device:plugins:group 138 [3300a5cf2c4f233d] Subscribing to group channel "DsWrL2FcTm+gpW+MKq0Cug=="
IMP/device:plugins:connect 138 [3300a5cf2c4f233d] Remote Connect Started for device "3300a5cf2c4f233d" at "10.10.64.2:15025"
INF/device:plugins:connect 138 [3300a5cf2c4f233d] New remote ADB connection from ::ffff:10.10.42.4
IMP/device:plugins:group 126 [3300a5ab28522391] Now owned by "svarog-5@agoda.com"
INF/device:plugins:group 126 [3300a5ab28522391] Subscribing to group channel "DsWrL2FcTm+gpW+MKq0Cug=="
IMP/device:plugins:connect 126 [3300a5ab28522391] Remote Connect Started for device "3300a5ab28522391" at "10.10.64.2:15021"
INF/device:plugins:connect 126 [3300a5ab28522391] New remote ADB connection from ::ffff:10.10.42.4
IMP/device:plugins:group 150 [3300a5c324502361] Now owned by "svarog-5@agoda.com"
INF/device:plugins:group 150 [3300a5c324502361] Subscribing to group channel "DsWrL2FcTm+gpW+MKq0Cug=="
IMP/device:plugins:connect 150 [3300a5c324502361] Remote Connect Started for device "3300a5c324502361" at "10.10.64.2:15029"
INF/device:plugins:connect 150 [3300a5c324502361] New remote ADB connection from ::ffff:10.10.42.4
INF/device:plugins:display 114 [3300a5fb184f2333] Rotation changed to 90
INF/device:plugins:screen:stream 114 [3300a5fb184f2333] Setting frame producer rotation to 90
INF/device:plugins:display 150 [3300a5c324502361] Rotation changed to 90
INF/device:plugins:screen:stream 150 [3300a5c324502361] Setting frame producer rotation to 90
INF/device:plugins:display 126 [3300a5ab28522391] Rotation changed to 90
INF/device:plugins:screen:stream 126 [3300a5ab28522391] Setting frame producer rotation to 90
INF/device:support:channels 138 [3300a5cf2c4f233d] Channel "DsWrL2FcTm+gpW+MKq0Cug==" timed out
IMP/device:plugins:group 138 [3300a5cf2c4f233d] No longer owned by "svarog-5@agoda.com"
INF/device:plugins:group 138 [3300a5cf2c4f233d] Unsubscribing from group channel "DsWrL2FcTm+gpW+MKq0Cug=="
INF/device:support:channels 150 [3300a5c324502361] Channel "DsWrL2FcTm+gpW+MKq0Cug==" timed out
IMP/device:plugins:group 150 [3300a5c324502361] No longer owned by "svarog-5@agoda.com"
INF/device:plugins:group 150 [3300a5c324502361] Unsubscribing from group channel "DsWrL2FcTm+gpW+MKq0Cug=="
INF/device:plugins:display 150 [3300a5c324502361] Rotation changed to 0
INF/device:plugins:screen:stream 150 [3300a5c324502361] Setting frame producer rotation to 0
IMP/device:plugins:group 126 [3300a5ab28522391] No longer owned by "svarog-5@agoda.com"
INF/device:plugins:group 126 [3300a5ab28522391] Unsubscribing from group channel "DsWrL2FcTm+gpW+MKq0Cug=="
IMP/device:plugins:group 114 [3300a5fb184f2333] No longer owned by "svarog-5@agoda.com"
INF/device:plugins:group 114 [3300a5fb184f2333] Unsubscribing from group channel "DsWrL2FcTm+gpW+MKq0Cug=="
INF/device:plugins:display 126 [3300a5ab28522391] Rotation changed to 0
INF/device:plugins:screen:stream 126 [3300a5ab28522391] Setting frame producer rotation to 0
INF/device:plugins:display 114 [3300a5fb184f2333] Rotation changed to 0
INF/device:plugins:screen:stream 114 [3300a5fb184f2333] Setting frame producer rotation to 0
$ 
```
 Sorry, what do you mean? 'adb devices', 'adb shell', 'adb install' work fine. I can restart the 'devices' component without touching devices, and it solves the problem. We use that hardware for tests a long time, it works without issues.  Ohh, I'm not sure that I understand you correctly sorry. 'provider' will restart 'device' when lack of device detected, isn't it? So why in my case restart doesn't happen automatically? 

Another question. I can write liveness probe and restart the provider myself. Do you have ideas how can I detect this situation? About hardware, in this case we use four Samsung SM-T815Y tablets and "plugable" hub with 50W power for devices.  Yep, seems like we're talking about separate issues. Logs from original message look good. But that logs show only the correct period. 

After 'provider' switched to the "get stuck" mode, there is no messages from 'provider' or 'device' at all! I can restart the whole 'provider', or kill 'device' and start it again manually, it will solve the problem for some time. 

 @sorccu Thank you. I've set environment variables for changing TCP keep-alive flags. Seems like it works - after last weekend all devices are still connected.   Notes content was deleted after restart the STF host.
I used STF model local.

Did I miss something from configuration note?
 Thanks @sorccu for your quick response. Let me scan through the steps I did to see whether I did that.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Problems unlocking devices sometimes

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
It happens in most new tablet devices that requires full swipe to the top to unlock (like Pixel C)

**Please provide the steps to reproduce the issue.**
1. Open up a newer tablet device, like Pixel C
2. Try to unlock it

**What is the expected behavior?**
It should unlock with no issues

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
No warnings.

**Please run `stf doctor` and paste the output here.**
All good here.

![2017-10-05_13-24-33](https://user-images.githubusercontent.com/10826482/31225062-9a68a832-a9d0-11e7-9528-60daf2a7489c.gif)
 Same drill.
![2017-10-05_13-31-57](https://user-images.githubusercontent.com/10826482/31225284-9b4d777c-a9d1-11e7-86bc-5d3fc0ffc3b0.gif)


Even leaving the cursor inside the device provides identical results:
![2017-10-05_13-32-42](https://user-images.githubusercontent.com/10826482/31225313-c5aee190-a9d1-11e7-8edd-e5bb94d61018.gif)


In case you'd like to debug on that device, I can give you a VPN/splashtop access to my device that hosts STF so you can see by yourself.

(i had to reupload second gif since it was the same)  I am trying to setup OpenSTF to make it work over HTTPS. However, once I type in the URL https://127.0.0.1:7100 I receive the error message "This site can't be reached". My OpenSTF setup works fine with HTTP.

Anyone has successfully setup OpenSTF with HTTPS? Is there any option to switch between HTTP and HTTPS support? If there is no such option and I need to modify OpenSTF to make it work, could you please give me some guidance -- which component(s) need to be changed and how?
Many thanks
  I'm trying STF locally with Android simulator, but seems it's not working properly. 

![image](https://user-images.githubusercontent.com/939583/31044256-6c2f4064-a5fe-11e7-9c9f-cd61f06a97d8.png)

Am I doing it wrong or it's just that STF doesn't  support simulator ?  Somehow connected to: #346 #242 
**What is the issue or idea you have?**

I've checked cli.js file and didn't found any flag that would be helpful.
When the session is closed ("stop using" option) for each device, the application which is on the top activity is closed (minimised).

Is there something that I've missed, flag or any other way to leave the application on the top after closing device session?

The case I'm thinking about:
Automated tests are running on the device (for example Espresso). While this is happening I would like to lookup on the device to check if everything is ok. But when I'm leaving the session ("stop using" option) the application is closed (minimised).

I would like that application to be still on top activity then I leave the device session to let the tests run without interruption. Sure. Understand. Any clue what can I do about it?
Any suggestion where I should lookup to make a PR with a new flag for example? Will you guys be ok with a new PR with a new flag to turn this off?
Will you accept it, will this be ok with your idea of this project.  **Not able to OnePlusOne 3T to STF in Ubuntu 16.04.1**

**Attached error in STF output**

<img width="1275" alt="image" src="https://user-images.githubusercontent.com/22715147/30775804-a8e7df7a-a0b8-11e7-9b7a-8f30b3abc31b.png">



 @sorccu 
We are using the latest stf version "3.1.0"
Attached screen shot
<img width="533" alt="image" src="https://user-images.githubusercontent.com/22715147/30795342-be70f736-a1ea-11e7-8a50-796ef3543d81.png">

Any help would be appreciated .  Its working fine on MAC with the same version of STF "3.1.0"
    Actually I have an STF server located in France and a user located in China which meets latency about ten seconds on screen display while the network rate seems to be good enough, so I would like to know if there is a way to reduce the quality of the screen streamed by minicap in order to reduce this latency ?

I know minicap takes a -P argument {RealWidth}x{RealHeight}@{VirtualWidth}x{VirtualHeight}/{Orientation} but in pratical how can I restart minicap in the mobile with the desired size ?

Thanks.
 Just a tip since I fiddled with it myself - it doesn't reduce latency really. I tried connecting to a PC connected to a 1ms ping PC with 50mb up 500 mb down speed with a PC with identical network settings, lowering the size of the screen by changing the code, and the screen have shown up in a new size... but it was still as laggy as it was.

I think some more work would have to be done to make it work as we'd like it to.  Will a server can connect up to a number of mobile phones? USB connected to more than one phone, the USB interface is not enough bandwidth how to solve? In the use of the process, often a mobile phone dropped, what is a good way?

Is there any recommended server model? How many phones can be connected to a server Is there a reference value? For example, you increase the use of what configuration, up to the number of mobile phones can support?
thank~  Hi,

Could I deploy two STF services on the same machine that has two different IPs?

Regards Hi again,

I have a machine with two network interfaces, some mobiles will be connected to one of the IP_A and the rest to the other IP_B, could I deploy two STF services, one for each IP on the same machine?

Thanks! @sorccu is it possible for stf-provider to support cesarca's requirement with "--exclude" and "--include" options which can filter different devices set for different providers on the same machine?  Hi all, 

I have configured and started STF using LDAP server authentication, when i access STF using the credentials i get the below error in STF server logs 

_```
> ERR/auth-ldap 21737 [127.0.0.1] Unexpected error InvalidCredentialsError: 80090308: LdapErr: DSID-0C0903A9, comment: AcceptSecurityContext error, data 52e, v1db0
    at messageCallback (/usr/local/lib/node_modules/stf/node_modules/ldapjs/lib/client/client.js:1423:40)
    at Parser.onMessage (/usr/local/lib/node_modules/stf/node_modules/ldapjs/lib/client/client.js:1089:14)
    at Parser.EventEmitter.emit (events.js:95:17)
    at Parser.write (/usr/local/lib/node_modules/stf/node_modules/ldapjs/lib/messages/parser.js:117:8)
    at Socket.onData (/usr/local/lib/node_modules/stf/node_modules/ldapjs/lib/client/client.js:1076:22)
    at Socket.EventEmitter.emit (events.js:95:17)
    at Socket.<anonymous> (_stream_readable.js:746:14)
    at Socket.EventEmitter.emit (events.js:92:17)
    at emitReadable_ (_stream_readable.js:408:10)
    at emitReadable (_stream_readable.js:404:5)
    at readableAddChunk (_stream_readable.js:165:9)
    at Socket.Readable.push (_stream_readable.js:127:10)
    at TCP.onread (net.js:526:21)
```_

Below is the step i have used to start STF


**stf local --auth-type ldap --auth-options '["--ldap-url","ldap://10.xx.x.xxx:3268","--ldap-search-dn","OU=inner_ou,OU=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-bind-dn","CN=username,OU=inner_ou,	=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-bind-credentials","username_actual_credential","--ldap-search-field","sAMAccountName"]'**

Please help me 

Thanks
RajendraC
	
 i have issue like that - i can't connect to the current LDAP server.

im tied several configs. last one is: 
```
  -e "STF_AUTH_LDAP_LDAP_BIND_CREDENTIALS=pass_for_stf_bind"\
  -e "STF_AUTH_LDAP_LDAP_BIND_DN=CN=stf bind,OU=System Users,DC=domain,DC=local" \
  -e "STF_AUTH_LDAP_LDAP_SEARCH_DN=DC=domain,DC=local" \
  -e "STF_AUTH_LDAP_LDAP_TIMEOUT=360" \
  -e "STF_AUTH_LDAP_LDAP_URL=ldap://192.168.2.100:389" \
  -e "STF_AUTH_LDAP_LDAP_USERNAME_FIELD=sAMAccountName" \
  -e "STF_AUTH_LDAP_LDAP_SEARCH_CLASS=(objectClass=*)" \
  -e "STF_AUTH_LDAP_LDAP_SEARCH_FIELD=uid" \
```

and i have that:
```
hramov-jenia-pc-autotest core # docker logs stf-auth-3200
INF/auth-ldap 1 [*] Listening on port 3000
WRN/auth-ldap 1 [::ffff:192.168.2.86] Authentication failure for "y.n"
Unhandled rejection InvalidCredentialsError
    at EventEmitter.endListener (/app/lib/util/ldaputil.js:78:25)
    at emitOne (events.js:96:13)
    at EventEmitter.emit (events.js:188:7)
    at sendResult (/app/node_modules/ldapjs/lib/client/client.js:1389:22)
    at messageCallback (/app/node_modules/ldapjs/lib/client/client.js:1421:16)
    at Parser.onMessage (/app/node_modules/ldapjs/lib/client/client.js:1089:14)
    at emitOne (events.js:96:13)
    at Parser.emit (events.js:188:7)
    at Parser.write (/app/node_modules/ldapjs/lib/messages/parser.js:111:8)
    at end (/app/node_modules/ldapjs/lib/messages/parser.js:66:19)
    at Parser.write (/app/node_modules/ldapjs/lib/messages/parser.js:112:10)
    at end (/app/node_modules/ldapjs/lib/messages/parser.js:66:19)
    at Parser.write (/app/node_modules/ldapjs/lib/messages/parser.js:112:10)
    at end (/app/node_modules/ldapjs/lib/messages/parser.js:66:19)
    at Parser.write (/app/node_modules/ldapjs/lib/messages/parser.js:112:10)
    at Socket.onData (/app/node_modules/ldapjs/lib/client/client.js:1076:22)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at readableAddChunk (_stream_readable.js:176:18)
    at Socket.Readable.push (_stream_readable.js:134:10)
    at TCP.onread (net.js:547:20)
```

could you, please, give name of framework that you use for the ldap to get correct examples? 
because main confuse is about:
STF_AUTH_LDAP_LDAP_SEARCH_CLASS
STF_AUTH_LDAP_LDAP_SEARCH_FIELD
STF_AUTH_LDAP_LDAP_SEARCH_SCOPE thanks.

still has this error :(

what the difference between STF_AUTH_LDAP_LDAP_USERNAME_FIELD and STF_AUTH_LDAP_LDAP_SEARCH_FIELD? thanks, so i understand why `STF_AUTH_LDAP_LDAP_SEARCH_FIELD ` is required. 

but, now i totally lost in configuration... 

```
  -e "STF_AUTH_LDAP_LDAP_BIND_CREDENTIALS=pass"\
  -e "STF_AUTH_LDAP_LDAP_BIND_DN=CN=stf bind,OU=System Users,DC=domain,DC=local" \
  -e "STF_AUTH_LDAP_LDAP_SEARCH_DN=DC=domain,DC=local" \
  -e "STF_AUTH_LDAP_LDAP_TIMEOUT=360" \
  -e "STF_AUTH_LDAP_LDAP_URL=ldap://192.168.2.100:389" \
  -e "STF_AUTH_LDAP_LDAP_SEARCH_CLASS=(objectClass=person)" \
  -e "STF_AUTH_LDAP_LDAP_SEARCH_SCOPE=sub" \
  -e "STF_AUTH_LDAP_LDAP_SEARCH_FIELD=sAMAccountName" \
  -e "STF_AUTH_LDAP_LDAP_USERNAME_FIELD=displayName" \
```

this looks fully correct. 

and last one `STF_AUTH_LDAP_LDAP_BIND_DN`. this is could be wrong, but... 
if binding works well (i checked it with wrong pass and it fails), so it should be correct too.

`STF_AUTH_LDAP_LDAP_SEARCH_CLASS` as i understand, it now correct too. 
i tried `STF_AUTH_LDAP_LDAP_SEARCH_CLASS=(objectClass=*)`, but it doesn't help. 

all other configs like:
`STF_AUTH_LDAP_LDAP_SEARCH_CLASS=objectClass=person`
`STF_AUTH_LDAP_LDAP_SEARCH_CLASS=person`
are failing on start, and i think its because of syntax errors. 

where i should look deeper?  so... i tried several configs with several servers.... and now i can say - LDAP is not working (  yep, if you mean 'ldapsearch' command.

also i configured all other services (such as jenkins, nextcloud, gitlab, rednine, etc.)  in my office and they all work.   Can you add scrolling ability with mouse wheel how it is implemented in android emulator?  **What is the issue or idea you have?**
Portrait/Landscape indicator logic is reversed on large (10"+) tablets, which are landscape by default. This happens for example on Samsing SM-P900.
Here is a screenshot:
![image](https://user-images.githubusercontent.com/3340954/30395710-6411758a-98c7-11e7-8728-2e87cc00393d.png)

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
```$ adb devices -l
List of devices attached
10.24.4.36:15029       device product:v1awifixx model:SM_P900 device:v1awifi
```

**Please provide the steps to reproduce the issue.**
Connect SM-P900 to STF.

**What is the expected behavior?**
Orientation indicator is consistent with actual orientation.

There are 2 10.1 Samsung tablets available in remote test lab: http://developer.samsung.com/remotetestlab/galaxy/rtlDeviceList.action they can be connected via adb. It looks like rotation comes from here: https://github.com/openstf/STFService.apk/blob/master/app/src/main/java/jp/co/cyberagent/stf/monitor/RotationMonitor.java#L69-L80
Current rotation in tooltip matches this value and is correct.

It seems that STF assumes that 0° rotation just means portrait however, it is not always true.
One of the way to determine if it is portrait or landscape is check the value of [orientation](https://developer.android.com/reference/android/content/res/Configuration.html#orientation).

Orientation can be passed along with rotation to STF UI and current portrait/landscape indicator state can be based on orientation. Rotation can be used for tooltip only. Will try to fix it in my spare time.  run ```npm link``` cause an exception in console, error log as follow:
```ERROR in ./res/web_modules/nine-bootstrap/index.js
Module not found: Error: Cannot resolve module 'nine-bootstrap/nine-bootstrap.sass' in D:\Projects\stf_orig\res\web_modules\nine-bootstrap
 @ ./res/web_modules/nine-bootstrap/index.js 3:0-45```
 1. I compile nine-bootstrap.sass by node-sass first;
``` shell
node-sass ./res/web_modules/nine-bootstrap/nine-bootstrap.scss >./res/web_modules/nine-bootstrap/nine-bootstrap.css
```
2. Modify the nine-bootstrap index.js:  
``` javascript
// require('nine-bootstrap/nine-bootstrap.sass')
require('nine-bootstrap/nine-bootstrap.css')
```
3. ```npm link```;
4. Run ```stf local ```;
5. Open the stf on my chrome browser, the font-color on my page is white?


 

![screenshot](https://user-images.githubusercontent.com/2938263/30373346-95afb926-98b3-11e7-85c2-845d1c673570.jpg)
 I have resolved this problem by rebuilding node-sass. Thank you @sorccu   <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
I use crash monkey for automation testing,  after 20 or 30 minutes, it will be disconnect to stf because the connect url is changed.
before disconnect the connect is 172.29.21.238:7409
after disconnect, I reconnect the connect is 172.29.21.238:7421
## So, why does the port will change？
## Can I get fixed port for one device？

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
![wx20170913-165119](https://user-images.githubusercontent.com/7402216/30368580-283414dc-98a4-11e7-8ecb-dd9a83e9edd9.png)
maybe it cause by my usb hub. maybe it cause by my usb hub.
the usb hub has 30 port Nice hub  It is not an issue but just a question.

I'm using the RestFul API to remote connect to a device and once connected to it I would like to know if there is a way to get its screen as a detached window, that is it means without to login to the OpenSTF GUI ?

I saw that properties returned for each device contain a "display" section with a web socket url value inside, is it possible to use it to reach my goal ?

At provider side, I also saw in log file that a VNC server is started, is it possible to interact with it using a VNC client ?

Thanks.
 Thanks for your answer  When i enter stf local after installation.
 I get the following error message. I have pasted full logs below this error message. 

Logs:-

INF/db 2888 [*] Connecting to 127.0.0.1:28015
/usr/local/lib/node_modules/stf/lib/cli websocket

Options:
  -h, --help          Show help.                                       [boolean]
  -V, --version       Show version.                                    [boolean]
  --connect-push, -c  App-side ZeroMQ PULL endpoint to connect to.
                                                              [array] [required]
  --connect-sub, -u   App-side ZeroMQ PUB endpoint to connect to.
                                                              [array] [required]
  --port, -p          The port to bind to.              [number] [default: 7110]
  --secret, -s        The secret to use for auth JSON Web Tokens. Anyone who
                      knows this token can freely enter the system if they want,
                      so keep it safe.                       [string] [required]
  --ssid, -i          The name of the session ID cookie.
                                                      [string] [default: "ssid"]
  --storage-url, -r   URL to the storage unit.               [string] [required]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_WEBSOCKET_` (e.g. `STF_WEBSOCKET_STORAGE_URL`).

**/usr/local/lib/node_modules/stf/node_modules/socket.io/node_modules/engine.io/node_modules/ws/index.js:9
const WebSocket = require('./lib/WebSocket');
^^^^^
Use of const in strict mode.
FTL/cli:local 2863 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:110:17)
    at Process.ChildProcess._handle.onexit (child_process.js:1074:12)
/usr/local/lib/node_modules/stf/node_modules/socket.io/node_modules/engine.io/node_modules/ws/index.js:9
const WebSocket = require('./lib/WebSocket');
^^^^^
Use of const in strict mode.
FTL/cli:local 2863 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:110:17)
    at Process.ChildProcess._handle.onexit (child_process.js:1074:12)**



_Pasting the Full Logs here._
[sudo] password for tauser: 
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
INF/db 2866 [*] Connecting to 127.0.0.1:28015
INF/db:setup 2866 [*] Database "stf" already exists
INF/db:setup 2866 [*] Table "users" already exists
INF/db:setup 2866 [*] Table "accessTokens" already exists
INF/db:setup 2866 [*] Table "vncauth" already exists
INF/db:setup 2866 [*] Table "devices" already exists
INF/db:setup 2866 [*] Table "logs" already exists
INF/db:setup 2866 [*] Index "users"."adbKeys" already exists
INF/db:setup 2866 [*] Index "accessTokens"."email" already exists
INF/db:setup 2866 [*] Index "vncauth"."response" already exists
INF/db:setup 2866 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 2866 [*] Index "devices"."owner" already exists
INF/db:setup 2866 [*] Index "devices"."present" already exists
INF/db:setup 2866 [*] Waiting for index "users"."adbKeys"
INF/db:setup 2866 [*] Waiting for index "accessTokens"."email"
INF/db:setup 2866 [*] Waiting for index "vncauth"."response"
INF/db:setup 2866 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 2866 [*] Waiting for index "devices"."owner"
INF/db:setup 2866 [*] Waiting for index "devices"."present"
INF/db:setup 2866 [*] Index "devices"."providerChannel" already exists
INF/db:setup 2866 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 2866 [*] Index "users"."adbKeys" is ready
INF/db:setup 2866 [*] Index "accessTokens"."email" is ready
INF/db:setup 2866 [*] Index "devices"."owner" is ready
INF/db:setup 2866 [*] Index "devices"."present" is ready
INF/db:setup 2866 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 2866 [*] Index "vncauth"."response" is ready
INF/db:setup 2866 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli provider --name tauser-VirtualBox --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-temp --port 7102"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 2863 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
INF/triproxy 2870 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 2870 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 2870 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/triproxy 2869 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 2869 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 2869 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/db 2873 [*] Connecting to 127.0.0.1:28015
INF/db 2876 [*] Connecting to 127.0.0.1:28015
INF/processor 2873 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 2873 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/reaper 2879 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 2879 [reaper001] Reaping devices with no heartbeat
INF/db 2879 [reaper001] Connecting to 127.0.0.1:28015
INF/processor 2876 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 2876 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/reaper 2879 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/poorxy 2906 [*] Listening on port 7100
INF/reaper 2879 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/provider 2882 [*] Subscribing to permanent channel "MnGATzy6TuqbnPcT3Q8XZQ=="
INF/provider 2882 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 2882 [*] Receiving input from "tcp://127.0.0.1:7114"
INF/provider 2882 [*] Tracking devices
INF/auth-mock 2885 [*] Listening on port 7120
INF/storage:plugins:image 2900 [*] Listening on port 7103
INF/storage:plugins:apk 2903 [*] Listening on port 7104
INF/storage:temp 2897 [*] Listening on port 7102
INF/app 2888 [*] Using pre-built resources
INF/app 2888 [*] Listening on port 7105
INF/db 2888 [*] Connecting to 127.0.0.1:28015
/usr/local/lib/node_modules/stf/lib/cli websocket

Options:
  -h, --help          Show help.                                       [boolean]
  -V, --version       Show version.                                    [boolean]
  --connect-push, -c  App-side ZeroMQ PULL endpoint to connect to.
                                                              [array] [required]
  --connect-sub, -u   App-side ZeroMQ PUB endpoint to connect to.
                                                              [array] [required]
  --port, -p          The port to bind to.              [number] [default: 7110]
  --secret, -s        The secret to use for auth JSON Web Tokens. Anyone who
                      knows this token can freely enter the system if they want,
                      so keep it safe.                       [string] [required]
  --ssid, -i          The name of the session ID cookie.
                                                      [string] [default: "ssid"]
  --storage-url, -r   URL to the storage unit.               [string] [required]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_WEBSOCKET_` (e.g. `STF_WEBSOCKET_STORAGE_URL`).

/usr/local/lib/node_modules/stf/node_modules/socket.io/node_modules/engine.io/node_modules/ws/index.js:9
const WebSocket = require('./lib/WebSocket');
^^^^^
Use of const in strict mode.
FTL/cli:local 2863 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:110:17)
    at Process.ChildProcess._handle.onexit (child_process.js:1074:12)
INF/cli:local 2863 [*] Shutting down all child processes
INF/util:lifecycle 2869 [app001] Winding down for graceful exit
INF/util:lifecycle 2870 [dev001] Winding down for graceful exit
INF/util:lifecycle 2873 [proc001] Winding down for graceful exit
INF/util:lifecycle 2879 [reaper001] Winding down for graceful exit
WRN/db 2879 [reaper001] Connection closed
INF/util:lifecycle 2876 [proc002] Winding down for graceful exit
INF/util:lifecycle 2882 [*] Winding down for graceful exit
WRN/db 2873 [proc001] Connection closed
INF/util:lifecycle 2885 [*] Winding down for graceful exit
INF/auth-mock 2885 [*] Waiting for client connections to end
INF/util:lifecycle 2888 [*] Winding down for graceful exit


Also I have sudo rethinkdb and started rethinkdb server as well.

tauser@tauser-VirtualBox:~$ sudo rethinkdb
[sudo] password for tauser: 
Running rethinkdb 2.3.6~0xenial (GCC 5.3.1)...
Running on Linux 4.10.0-33-generic x86_64
Loading data from directory /home/tauser/rethinkdb_data
Listening for intracluster connections on port 29015
Listening for client driver connections on port 28015
Listening for administrative HTTP connections on port 8080
Listening on cluster addresses: 127.0.0.1, 127.0.1.1, ::1
Listening on driver addresses: 127.0.0.1, 127.0.1.1, ::1
Listening on http addresses: 127.0.0.1, 127.0.1.1, ::1
To fully expose RethinkDB on the network, bind to all addresses by running rethinkdb with the `--bind all` command line option.
Server ready, "tauser_VirtualBox_g0p" 814aecfb-3052-494c-9c2e-15869a1d5c6e

Machine Details :+1: 
1) Ubuntu 16.04
2) 4GB RAM.

Regards,
Prasanna B





 Hi Sorccu,

Many thanks for your quick reply. I have updated nodejs version. PFB the results. but got different error.

tauser@tauser-VirtualBox:~$ ^C
tauser@tauser-VirtualBox:~$ stf doctor
INF/cli:doctor 2590 [*] OS Arch: x64
INF/cli:doctor 2590 [*] OS Platform: linux
INF/cli:doctor 2590 [*] OS Platform: 4.10.0-33-generic
INF/cli:doctor 2590 [*] Using Node 6.11.3
**ERR/cli:doctor 2590 [*] Unexpected error checking ZeroMQ: Error: Module version mismatch. Expected 48, got 14.**
INF/cli:doctor 2590 [*] Using RethinkDB 2.3.6~0xenial
INF/cli:doctor 2590 [*] Using ProtoBuf 3.4.0
INF/cli:doctor 2590 [*] Using ADB 1.0.32
INF/cli:doctor 2590 [*] Using GraphicsMagick 1.3.23



**Stf local logs**  
Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_TRIPROXY_` (e.g. `STF_TRIPROXY_BIND_PUB`).

Module version mismatch. Expected 48, got 14.
FTL/cli:local 2487 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:219:12)
INF/cli:local 2487 [*] Shutting down all child processes

 Thanks Sorccu,

I did a fresh install of STF. Got following error.

Installing STF, Please wait...
/usr/local/bin/stf -> /usr/local/lib/node_modules/stf/bin/stf

> dtrace-provider@0.8.5 install /usr/local/lib/node_modules/stf/node_modules/bunyan/node_modules/dtrace-provider
> node scripts/install.js


> dtrace-provider@0.7.1 install /usr/local/lib/node_modules/stf/node_modules/dtrace-provider
> node scripts/install.js


> uws@0.14.5 install /usr/local/lib/node_modules/stf/node_modules/uws
> node-gyp rebuild > build_log.txt 2>&1 || exit 0


> bufferutil@1.3.0 install /usr/local/lib/node_modules/stf/node_modules/bufferutil
> node-gyp rebuild

make: Entering directory '/usr/local/lib/node_modules/stf/node_modules/bufferutil/build'
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
  SOLINK_MODULE(target) Release/obj.target/bufferutil.node
  COPY Release/bufferutil.node
make: Leaving directory '/usr/local/lib/node_modules/stf/node_modules/bufferutil/build'

> jpeg-turbo@0.4.0 install /usr/local/lib/node_modules/stf/node_modules/jpeg-turbo
> node-pre-gyp install --fallback-to-build

make: Entering directory '/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/build'
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_0 Release/obj/gen/jfdctflt-sse-64.o
/bin/sh: 1: yasm: not found
deps/jpeg-turbo.target.mk:10: recipe for target 'Release/obj/gen/jfdctflt-sse-64.o' failed
make: *** [Release/obj/gen/jfdctflt-sse-64.o] Error 127
make: Leaving directory '/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/build'
gyp ERR! build error 
gyp ERR! stack Error: `make` failed with exit code: 2
gyp ERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:276:23)
gyp ERR! stack     at emitTwo (events.js:106:13)
gyp ERR! stack     at ChildProcess.emit (events.js:191:7)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
gyp ERR! System Linux 4.10.0-33-generic
gyp ERR! command "/usr/local/bin/node" "/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "build" "--fallback-to-build" "--module=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-linux-x64/jpegturbo.node" "--module_name=jpegturbo" "--module_path=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-linux-x64"
gyp ERR! cwd /usr/local/lib/node_modules/stf/node_modules/jpeg-turbo
gyp ERR! node -v v6.11.2
gyp ERR! node-gyp -v v3.4.0
gyp ERR! not ok 
node-pre-gyp ERR! build error 
node-pre-gyp ERR! stack Error: Failed to execute '/usr/local/bin/node /usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js build --fallback-to-build --module=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-linux-x64/jpegturbo.node --module_name=jpegturbo --module_path=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-linux-x64' (1)
node-pre-gyp ERR! stack     at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/node_modules/node-pre-gyp/lib/util/compile.js:83:29)
node-pre-gyp ERR! stack     at emitTwo (events.js:106:13)
node-pre-gyp ERR! stack     at ChildProcess.emit (events.js:191:7)
node-pre-gyp ERR! stack     at maybeClose (internal/child_process.js:891:16)
node-pre-gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:226:5)
node-pre-gyp ERR! System Linux 4.10.0-33-generic
node-pre-gyp ERR! command "/usr/local/bin/node" "/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/node_modules/.bin/node-pre-gyp" "install" **"--fallback-to-build"
node-pre-gyp ERR! cwd /usr/local/lib/node_modules/stf/node_modules/jpeg-turbo
node-pre-gyp ERR! node -v v6.11.2
node-pre-gyp ERR! node-pre-gyp -v v0.6.19
node-pre-gyp ERR! not ok 
Failed to execute '/usr/local/bin/node /usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js build --fallback-to-build --module=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-linux-x64/jpegturbo.node --module_name=jpegturbo --module_path=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-linux-x64' (1)
/usr/local/lib
`-- (empty)

npm ERR! Linux 4.10.0-33-generic
npm ERR! argv "/usr/local/bin/node" "/usr/local/bin/npm" "install" "-g" "stf"
npm ERR! node v6.11.2
npm ERR! npm  v3.10.10**
npm ERR! code ELIFECYCLE

npm ERR! jpeg-turbo@0.4.0 install: `node-pre-gyp install --fallback-to-build`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the jpeg-turbo@0.4.0 install script 'node-pre-gyp install --fallback-to-build'.
npm ERR! Make sure you have the latest version of node.js and npm installed.
npm ERR! If you do, this is most likely a problem with the jpeg-turbo package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-pre-gyp install --fallback-to-build
npm ERR! You can get information on how to open an issue for this project with:
npm ERR!     npm bugs jpeg-turbo
npm ERR! Or if that isn't available, you can get their info via:
npm ERR!     npm owner ls jpeg-turbo
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /opt/protobuf/npm-debug.log
npm ERR! code 1

Following below installation steps as mentioned in the git hub document:-

https://gist.github.com/prasb/458878000d05ae72c0906e7fa4f28708

  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
I got the following error when running npm.

npm ERR! code EINTEGRITY
npm ERR! sha1-yPxiAcf0DdCJQbh8CFdnOGpnmsw= integrity checksum failed when using sha1: wanted sha1-yPxiAcf0DdCJQbh8CFdnOGpnmsw= but got sha1-QqerEPTFvpQj+/AS9PGovYNfNL4=. (212467 bytes)

I'm running Ubuntu 16.04 with node v8.4.0 and npm  v5.3.0. Here're more details from npm log:

21563 verbose Linux 4.10.0-28-generic
21564 verbose argv "/usr/bin/nodejs" "/usr/bin/npm" "install"
21565 verbose node v8.4.0
21566 verbose npm  v5.3.0
21567 error code EINTEGRITY
21568 error sha1-yPxiAcf0DdCJQbh8CFdnOGpnmsw= integrity checksum failed when using sha1: wanted sha1-yPxiAcf0DdCJQbh8CFdnOGpnmsw= but got sha1-QqerEPTFvpQj+/AS9PGovYNfNL4=. (212467 bytes)
21569 verbose exit [ 1, true ]


**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

1. git clone https://github.com/openstf/stf.git
2. cd stf
3. npm install

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 Yes, this is an issue from npm. I got this fix by clearing npm's cache.  How can I open lock screen or lock device?
As workaround I can press power button and reconnect device.
In this case i will be on lock screen
But i want to open lock steen without recinnecting.
 I want to see notifications on lock screen
Or as an example media player controls This cace from my QA colleagues I resolved the problem by writing a Java program using UIAutomator to swipe the screen from bottom to top and from left to right. Or you can simulate the operation of unlocking device with any Android UI automation tool.  Sorry for my mistake. Today I checked "Advanced Input" -> "Special keys" -> "Power" button and this works for all devices. But need to press button 2 times. First click and devise screen is off after second click I can see lock screen.

@vbanthia 
input keyevent 82 dos not  work for me @vbanthia On some devices like HuaWei P10, "input keyevent 82" doesn't work when it's not password locked. Maybe some manufactures modified the default behavior of this keyevent.  On master branch, I found this problem on windows:
```
WRN/device:plugins:touch 5108 [d31dd7b87d43] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 5108 [d31dd7b87d43] Disconnecting from minitouch service
INF/device:plugins:touch 5108 [d31dd7b87d43] Stopping minitouch service
INF/device:plugins:touch 5108 [d31dd7b87d43] Launching screen service
INF/device:plugins:touch 5108 [d31dd7b87d43] Connecting to minitouch service
INF/device:plugins:touch 5108 [d31dd7b87d43] minitouch says: "open: Permission denied"
INF/device:plugins:touch 5108 [d31dd7b87d43] minitouch says: "Unable to open device /dev/input/event5 for inspectionopen
: Permission denied"
INF/device:plugins:touch 5108 [d31dd7b87d43] minitouch says: "Unable to open device /dev/input/event4 for inspectionopen
: Permission denied"
INF/device:plugins:touch 5108 [d31dd7b87d43] minitouch says: "Unable to open device /dev/input/event1 for inspectionopen
: Permission denied"
INF/device:plugins:touch 5108 [d31dd7b87d43] minitouch says: "Unable to open device /dev/input/event0 for inspectionopen
: Permission denied"
INF/device:plugins:touch 5108 [d31dd7b87d43] minitouch says: "Unable to open device /dev/input/mice for inspectionopen:
Permission denied"
INF/device:plugins:touch 5108 [d31dd7b87d43] minitouch says: "Unable to open device /dev/input/event2 for inspectionopen
: Permission denied"
INF/device:plugins:touch 5108 [d31dd7b87d43] minitouch says: "Unable to open device /dev/input/event3 for inspectionUnab
le to find a suitable touch device"
WRN/device:plugins:touch 5108 [d31dd7b87d43] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 5108 [d31dd7b87d43] Disconnecting from minitouch service
WRN/device:plugins:touch 5108 [d31dd7b87d43] Will not apply desired state due to too many failures
INF/device:plugins:touch 5108 [d31dd7b87d43] Stopping minitouch service
FTL/device 5108 [d31dd7b87d43] Setup had an error Error: Failed more than 3 times in 10000ms
    at TouchConsumer._failLimitExceeded (D:\Projects\stf\lib\units\device\plugins\touch\index.js:230:26)
    at FailCounter.emit (D:\Projects\stf\node_modules\eventemitter3\index.js:117:35)
    at FailCounter.inc (D:\Projects\stf\lib\util\failcounter.js:29:10)
    at TouchConsumer._outputEnded (D:\Projects\stf\lib\units\device\plugins\touch\index.js:223:24)
    at RiskyStream.emit (D:\Projects\stf\node_modules\eventemitter3\index.js:115:35)
    at RiskyStream.<anonymous> (D:\Projects\stf\lib\util\riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:974:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
From previous event:
    at startConsumer (D:\Projects\stf\lib\units\device\plugins\touch\index.js:511:14)
    at D:\Projects\stf\lib\units\device\plugins\touch\index.js:526:12
    at SerialSyrup.ParallelSyrup.invoke (D:\Projects\stf\node_modules\stf-syrup\lib\parallel.js:54:24)
    at D:\Projects\stf\node_modules\stf-syrup\lib\serial.js:43:33
    at _combinedTickCallback (internal/process/next_tick.js:73:7)
    at process._tickCallback (internal/process/next_tick.js:104:9)
FTL/util:lifecycle 5108 [d31dd7b87d43] Shutting down due to fatal error
INF/provider 7884 [*] Cleaning up device worker "d31dd7b87d43"
ERR/provider 7884 [*] Device worker "d31dd7b87d43" died with code 1
INF/provider 7884 [*] Restarting device worker "d31dd7b87d43"
INF/provider 7884 [*] Providing all 0 of 1 device(s); ignoring "d31dd7b87d43"
INF/device:support:push 3376 [d31dd7b87d43] Sending output to "tcp://127.0.0.1:7116"
INF/device 3376 [d31dd7b87d43] Preparing device
INF/device:support:sub 3376 [d31dd7b87d43] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 3376 [d31dd7b87d43] Subscribing to permanent channel "*ALL"
INF/device:support:properties 3376 [d31dd7b87d43] Loading properties
INF/device:support:sdk 3376 [d31dd7b87d43] Supports SDK 23
INF/device:support:abi 3376 [d31dd7b87d43] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:minicap 3376 [d31dd7b87d43] Installing "D:\Projects\stf\node_modules\minicap-prebuilt\prebuilt\arm6
4-v8a\bin\minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 3376 [d31dd7b87d43] Installing "D:\Projects\stf\node_modules\minicap-prebuilt\prebuilt\arm6
4-v8a\lib\android-23\minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 3376 [d31dd7b87d43] Checking whether we need to install STFService
INF/device:resources:service 3376 [d31dd7b87d43] Running version check
INF/device:resources:service 3376 [d31dd7b87d43] STFService up to date
INF/device:plugins:service 3376 [d31dd7b87d43] Launching agent
INFINFINFINFINF/util:lifecycle 7588 [*] Winding down for graceful exit
/util:lifecycle 2644 [*] Winding down for graceful exit
INF/util:lifecycle 1544 [proc001] Winding down for graceful exit
/util:lifecycle 5852 [dev001] Winding down for graceful exit
/util:lifecycle 3972 [reaper001] Winding down for graceful exit
INFWRNWRN/util:lifecycle 7884 [*] Winding down for graceful exit
/db 1544 [proc001] Connection closed
/db 7588 [*] Connection closed
INF/cli:local 5548 [*] Received SIGINT, waiting for processes to terminate
FTL/cli:local 5548 [*] Child process had an error ExitError: Exit code "3221225786"
    at ChildProcess.<anonymous> (D:\Projects\stf\lib\util\procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 5548 [*] Shutting down all child processes
``` Thank you!   stf version 3.1.0

Hi!
Can you help me.
How can I type russian characters from PC keyboard?
English characters from PC keyboard and russian keyboard on device works fine.  Hi guys, any support would be appreciated as I am new. I have spent hours and hours searching but I couldn't find anything. Hopeless! I want to  make publicly access-able so they can use the Public IP address access the STF.

I have tried port forwarding on my router but it redirects top local ip (192.168.1.9:7100) but I want make publicly access able . When I type in the public IP with the port (x.x.x.x:7100) it directs me to (http://localhost:7100/auth/mock/). I have also tried to NGrok still the same. 


Any help would be appreciated.

Thank you all. 


 @vbanthia it only works internal network not outside, I have opened the ports from 7000-25000. <your_internal_network_ip_here>
should this be the public ip or internal IP.   INF/device 10336 [d31dd7b87d43] Preparing device
INF/device:support:sub 10336 [d31dd7b87d43] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 10336 [d31dd7b87d43] Subscribing to permanent channel "*ALL"
INF/device:support:properties 10336 [d31dd7b87d43] Loading properties
INF/device:support:sdk 10336 [d31dd7b87d43] Supports SDK 23
INF/device:support:abi 10336 [d31dd7b87d43] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:minicap 10336 [d31dd7b87d43] Installing "D:\Projects\stf\node_modules\minicap-prebuilt\prebuilt\arm
64-v8a\bin\minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 10336 [d31dd7b87d43] Installing "D:\Projects\stf\node_modules\minicap-prebuilt\prebuilt\arm
64-v8a\lib\android-23\minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:minicap 10336 [d31dd7b87d43] Pushed "minicap.so" not executable, attempting fallback location
INF/device:resources:minicap 10336 [d31dd7b87d43] Installing "D:\Projects\stf\node_modules\minicap-prebuilt\prebuilt\arm
64-v8a\lib\android-23\minicap.so" as "/data/data/com.android.shell/minicap.so"
INF/device:resources:minicap 10336 [d31dd7b87d43] Pushed "minicap.so" not executable, attempting fallback location
FTL/device 10336 [d31dd7b87d43] Setup had an error Error: Out of fallback locations for "D:\Projects\stf\node_modules\mi
nicap-prebuilt\prebuilt\arm64-v8a\lib\android-23\minicap.so"
    at Resource.shift (D:\Projects\stf\lib\units\device\resources\util\resource.js:13:11)
    at D:\Projects\stf\lib\units\device\resources\minicap.js:110:19
    at runCallback (timers.js:666:20)
    at tryOnImmediate (timers.js:639:5)
    at processImmediate [as _immediateCallback] (timers.js:611:5)
FTL/util:lifecycle 10336 [d31dd7b87d43] Shutting down due to fatal error
INF/provider 6112 [*] Cleaning up device worker "d31dd7b87d43"
ERR/provider 6112 [*] Device worker "d31dd7b87d43" died with code 1
INF/provider 6112 [*] Restarting device worker "d31dd7b87d43"
INF/device:support:push 3944 [d31dd7b87d43] Sending output to "tcp://127.0.0.1:7116"
INF/device 3944 [d31dd7b87d43] Preparing device
INFINFINF/util:lifecycle 9456 [*] Winding down for graceful exit
INFINF/cli:local 9844 [*] Received SIGINT, waiting for processes to terminate
FTL/cli:local 9844 [*] Child process had an error ExitError: Exit code "3221225786"
    at ChildProcess.<anonymous> (D:\Projects\stf\lib\util\procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
 I have tried the same device on Linux, the device is showed in the devices center.
But on my windows dev environment, it like this:
![image](https://user-images.githubusercontent.com/2938263/30064435-549f5ef8-9284-11e7-8bd5-3c7118776817.png)
 3q I have fixed the problem by this way:
``` js
 function checkExecutable(res) {
        return adb.stat(options.serial, res.dest)
          .timeout(5000)
          .then(function(stats) {
            // return (stats.mode & fs.constants.S_IXUSR) === fs.constants.S_IXUSR
            return true;
          });
 }
``` ```
device:plugins:screen:stream 4940 [ACE2158A8D62] Starting WebSocket server on port 7400
device:resources:minitouch 4940 [ACE2158A8D62] Installing "D:\Projects\stf\node_modules\minitouch-prebuilt\prebuilt\
abi-v7a\bin\minitouch" as "/data/local/tmp/minitouch"
s { mode: 33279, size: 30224, mtime: 2017-09-06T12:55:32.000Z }
device:plugins:data 4940 [ACE2158A8D62] Unable to find device data { serial: 'ACE2158A8D62',
atform: 'Android',
nufacturer: 'HUAWEI',
erator: ',',
del: ' G510-0010',
rsion: '4.1.1',
i: 'armeabi-v7a',
k: '16',
oduct: 'G510-0010',
splay:
 id: 0,
 width: 480,
 height: 854,
 xdpi: 160.42,
 ydpi: 159.5,
 size: 6.13,
 density: 1.5,
 fps: 60,
 secure: false,
 rotation: 0,
 url: 'ws://192.13.24.88:7400' },
one: { imei: '866872012794553', network: 'UNKNOWN' } }
device:plugins:touch 4940 [ACE2158A8D62] Touch origin is top left
device:plugins:touch 4940 [ACE2158A8D62] Requesting touch consumer to start
device:plugins:touch 4940 [ACE2158A8D62] Launching screen service
device:plugins:touch 4940 [ACE2158A8D62] Connecting to minitouch service
device:plugins:touch 4940 [ACE2158A8D62] minitouch says: "libevdev error in fix_invalid_absinfo: BUG: Device "ts_tes
put" has invalid ABS_MT_TRACKING_ID rangeNote: device /dev/input/event5 was outscored by /dev/input/event0 (2000 >=
)"
device:plugins:touch 4940 [ACE2158A8D62] minitouch says: "Type A touch device synaptics (479x853 with 6 contacts) de
ed on /dev/input/event0 (score 2000)"
device:plugins:touch 4940 [ACE2158A8D62] Reading minitouch banner
device:plugins:touch 4940 [ACE2158A8D62] minitouch says: "Connection established"
``` Thank you!  Hi there!

Recently we have connected S8+ to the STF service. 
The problem is: despite screen's orientation is set to portrait view (within device's settings, on STF web page, and using adb command), cursor on the screen moves like orientation is set to landscape:
when (on vertically oriented device) I move mouse up, cursor goes left, when I move mouse left, cursor goes down.
Moreover, this is the only device that displayes cursor when being used via STF web page.

So, it'll be great if you help me with resolving this issue.

Thank you for your attention.
![1](https://user-images.githubusercontent.com/18280686/30033003-543bcebc-91a1-11e7-87cf-18fbcafea44b.jpg)
 Mmmmmm... very useful answer, thanks)  For the latest version of STF(3.1), the package.json shows bluebird is 2.10.1:

        **"bluebird": "^2.10.1",**
        "adbkit-apkreader": "^2.1.2"

In the modlue of "adbkit-apkreader 2.1.2", it shows bluebird has been upgraded to 3.4.7:

          "dependencies": {
              **"bluebird": "^3.4.7",**
              "debug": "~0.7.4",
              "yauzl": "^2.7.0"
          },

So after deploying the STF v3.1, the problem was encountered when trying to install APK package:
        
        ERR/storage:plugins:apk 13930 [*] Unable to read manifest of "4f92bf05-283e-40d9-850e-d80eca3deec2" 
       **TypeError: Promise.fromCallback is not a function**
          at ApkReader._open (/Users/song/work/stf/node_modules/adbkit-apkreader/lib/apkreader.js:24:22)
          at ApkReader.usingFileStream (/Users/song/work/stf/node_modules/adbkit-apkreader/lib/apkreader.js:66:19)
         at ApkReader.usingFile (/Users/song/work/stf/node_modules/adbkit-apkreader/lib/apkreader.js:34:19)
         at ApkReader.readManifest (/Users/song/work/stf/node_modules/adbkit-apkreader/lib/apkreader.js:102:19)
         at /Users/song/work/stf/lib/units/storage/plugins/apk/task/manifest.js:5:19
         From previous event:
            at module.exports (/Users/song/work/stf/lib/units/storage/plugins/apk/task/manifest.js:4:36)
            at runCallback (timers.js:672:20)
            at tryOnImmediate (timers.js:645:5)
            at processImmediate [as _immediateCallback] (timers.js:617:5)
            ... ...

Seems the function of "fromCallback is introduced in 3.x version of bluebird, so STF modules which still depends on bluebird 2.x can not work.

Also I attempted to upgrad bluebird to 3.x for STF 3.1, but still hit the problem in lifecycle related function:

     resolver.promise.cancellable is not a function ...

It's because [Cancellation](http://bluebirdjs.com/docs/api/cancellation.html) has been redesigned for bluebird 3.x. The symptom is that the program gets stuck with the message: "INF/util:lifecycle 15277 [*] Winding down for graceful exit"


 Yes, I tried to use 'npm install' and 'npm link' to install the dependencies, also tried to upgrade bluebird manually with the command "npm install bluebird@3.4.7" Initially the directory `node_modules/adbkit-apkreader/node_modules/bluebird/ was not existed.  I issued command `npm install bluebird@3.4.7` to install bluebird v3 manually. Now thing goes well and I can install apk through STF UI. 
Thanks!

BTW,  is there any plan to upgrade  bluebird or  use native Promise interface in STF itself? It might be a env problem. I did following steps in my dev env on Macbook:
   1. Merge the code of v3.1.0 with my customized code based on 2.1
   2. Issue the command "cnpm install" (cnpm is using private npm registry from taobao.com)
   3. Open web page of STF and encounter the problem caused by incompatible bluebird version
   4. try to issue the command "npm install" to update modules using official npm registry, the problem still occurs, the dir `node_modules/adbkit-apkreader/node_modules/bluebird/package.json` can't be located 
   5. issue the command "cd node_modules/adbkit-apkreader/&&cnpm install bluebird@3.4.7" to install bluebird v3 for apkreader manually.  Then the problem resolved.
  Hello,

First of all, thanks for your good work.

We have a small problem: It is continuously tries to connect an emulator which does not exist. 

> NF/provider 16748 [*] Lost device "emulator-5564" (offline)
INF/provider 16748 [*] Found device "emulator-5564" (offline)
INF/provider 16748 [*] Registered device "emulator-5564"
INF/reaper 16747 [reaper001] Device "emulator-5564" is present
INF/provider 16748 [*] Lost device "emulator-5564" (offline)
INF/provider 16748 [*] Found device "emulator-5564" (offline)
INF/reaper 16747 [reaper001] Device "emulator-5564" is present
INF/provider 16748 [*] Registered device "emulator-5564"
INF/provider 16748 [*] Lost device "emulator-5564" (offline)
INF/provider 16748 [*] Found device "emulator-5564" (offline)
INF/reaper 16747 [reaper001] Device "emulator-5564" is present
INF/provider 16748 [*] Registered device "emulator-5564"
INF/provider 16748 [*] Lost device "emulator-5564" (offline)
INF/provider 16748 [*] Found device "emulator-5564" (offline)
INF/reaper 16747 [reaper001] Device "emulator-5564" is present
INF/provider 16748 [*] Registered device "emulator-5564"

..... loops like that...

I tried to remove this device from rethinkdb but it did not change anything.

$ adb devices -l
List of devices attached
f069fef20351a313       device usb:2174976X product:gts28vewifixx model:SM_T713 device:gts28vewifi
52036d10ec4ea3f9       device usb:2166784X product:j7xeltetur model:SM_J710FQ device:j7xelte

$ stf doctor
INF/cli:doctor 16808 [*] OS Arch: x64
INF/cli:doctor 16808 [*] OS Platform: darwin
INF/cli:doctor 16808 [*] OS Platform: 16.7.0
INF/cli:doctor 16808 [*] Using Node 8.4.0
INF/cli:doctor 16808 [*] Using ZeroMQ 4.2.2
INF/cli:doctor 16808 [*] Using RethinkDB 2.3.6
INF/cli:doctor 16808 [*] Using GraphicsMagick 1.3.26
INF/cli:doctor 16808 [*] Using ProtoBuf 3.4.0
INF/cli:doctor 16808 [*] Using ADB 1.0.39  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
I use the latest version of STF

**What is the issue or idea you have?**
All works well except empty window (no visible file system) on "file explorer" menu with mobiles from SDK 25, for instance : SONY G8141 7.1.1 and Google Pixel 7.1.2

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
CB512EDDM1             device usb:1-1.3.4.3 product:G8141 model:G8141 device:G8141
FA6A90303673           device usb:1-1.3.4.3 product:sailfish model:Pixel device:sailfish

**Please provide the steps to reproduce the issue.**
1. take the control of the considered device
2. click on the "File explorer" menu
3. see the empty window (no visible file system)

**What is the expected behavior?**
see the file system

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
no output in the log file

**Please run `stf doctor` and paste the output here.**
# on docker container : App role
$ stf doctor
INF/cli:doctor 6 [*] OS Arch: x64
INF/cli:doctor 6 [*] OS Platform: linux
INF/cli:doctor 6 [*] OS Platform: 3.16.0-4-amd64
INF/cli:doctor 6 [*] Using Node 6.11.2
INF/cli:doctor 6 [*] Using ZeroMQ 4.1.4
INF/cli:doctor 6 [*] Using GraphicsMagick 1.3.23
ERR/cli:doctor 6 [*] RethinkDB is not installed (`rethinkdb` is missing)
ERR/cli:doctor 6 [*] ProtoBuf is not installed (`protoc` is missing)
ERR/cli:doctor 6 [*] ADB is not installed (`adb` is missing)

# on docker container : Provider role
/app $ stf doctor
INF/cli:doctor 7 [*] OS Arch: arm
INF/cli:doctor 7 [*] OS Platform: linux
INF/cli:doctor 7 [*] OS Platform: 4.4.50-v7+
INF/cli:doctor 7 [*] Using Node 6.11.2
INF/cli:doctor 7 [*] Using ZeroMQ 4.1.5
ERR/cli:doctor 7 [*] RethinkDB is not installed (`rethinkdb` is missing)
ERR/cli:doctor 7 [*] ADB is not installed (`adb` is missing)
INF/cli:doctor 7 [*] Using GraphicsMagick 1.3.25
INF/cli:doctor 7 [*] Using ProtoBuf 3.1.0
 same issue with firefox (49.5.0) and chrome (60.0.3112.101) and safari (10.1.2) and IE (11), it seems the SDK 25 is the origin of this issue because all works well with lower SDK The same problem was also hit on my 7.x  devices. The default view of file explorer with filepath "/"  is empty indeed, but when specify more exact  filepath like "/sdcard", the file list can be displayed.   INF/device:plugins:identity 20013 [7c79daca7d24] Solving identity
INF/device:plugins:solo 20013 [7c79daca7d24] Subscribing to permanent channel "Y1mg3qyc94+AnXsb2nyAhVdwumg="
INF/device:plugins:screen:stream 20013 [7c79daca7d24] Starting WebSocket server on port NaN
FTL/device 20013 [7c79daca7d24] Setup had an error RangeError: "port" argument must be >= 0 and < 65536
FTL/util:lifecycle 20013 [7c79daca7d24] Shutting down due to fatal error
INF/provider 3572 [*] Cleaning up device worker "7c79daca7d24"
ERR/provider 3572 [*] Device worker "7c79daca7d24" died with code 1
INF/provider 3572 [*] Restarting device worker "7c79daca7d24"
INF/device:support:push 20087 [7c79daca7d24] Sending output to "tcp://127.0.0.1:7116"
INF/device 20087 [7c79daca7d24] Preparing device
INF/device:support:sub 20087 [7c79daca7d24] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 20087 [7c79daca7d24] Subscribing to permanent channel "*ALL"
INF/device:support:properties 20087 [7c79daca7d24] Loading properties
INF/device:support:sdk 20087 [7c79daca7d24] Supports SDK 23
INF/device:support:abi 20087 [7c79daca7d24] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:minicap 20087 [7c79daca7d24] Installing "/home/wscn/Sites/ups/stf/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 20087 [7c79daca7d24] Installing "/home/wscn/Sites/ups/stf/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/lib/android-23/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 20087 [7c79daca7d24] Checking whether we need to install STFService
INF/device:resources:service 20087 [7c79daca7d24] Running version check
INF/device:resources:service 20087 [7c79daca7d24] STFService up to date
INF/device:plugins:service 20087 [7c79daca7d24] Launching agent
INF/provider 3572 [*] Providing 12 of 18 device(s); waiting for "80fef2267d24", "7c79daca7d24", "7bc7d4147d24", "837caaf37d24", "74dcea477d24", "758fea877d24"
INF/device:plugins:service 20087 [7c79daca7d24] Launching service
INF/device:plugins:service 20087 [7c79daca7d24] Agent says: "Listening on @stfagent"
INF/device:plugins:service 20087 [7c79daca7d24] Agent says: "InputClient started"



so shoud i do BASIC_AUTH_USERNAME=s BASIC_AUTH_PASSWORD=s stf local --port 57501 --websocket-port 57502 --provider-min-port 57503 --provider-max-port 57550 --auth-options '["--use-basic-auth"]' 1>./log/stf.log 2>&1 &


so this is my set I also meet same problem, this may be the reason: your configuration '--provider-min-port 57503 --provider-max-port 57550' can only support (57550-57503+1)/4 = 12 devices, because every device will use 4 ports, when you try connect 13th device, there is not enough port to use. so increase the 
 provider port range can resolve it  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**Is there a way to find out how many different users accessed a device(connected to particular STF instance) per day and for how much time it was used?**
 Thanks @sorccu.   Hi Team,

I have successfully configured STF in my MAC mini and able to access it remotely, however when i access it remotely it is asking only the username and email id. I do not see any authentication.

Could you please some one guide me how to give access to the devices using authentication, it would be great if you can point me to some examples.

Thanks in advance
RajendraC  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
While using SCREEN_JPEG_QUALITY variable STF boot process stops on 
INF/db 17225 [*] Connecting to 127.0.0.1:28015
(pressumably DB connection)

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
N/A, devices do not load.

**Please provide the steps to reproduce the issue.**
1. Start STF with ie. 
./stf local screen-jpeg-quality 40 
or 
./launcher local --public-ip 192.168.1.83 STF_LOCAL_SCREEN_JPEG_QUALITY 40


**What is the expected behavior?**
screen_jpeg_quality variable should be set to 40 and STF should boot

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
Nope, no errors. If an instance was running without the variable, devices will load, but they will not show anything on screen, and after a short while will be kicked out
INF/reaper 17201 [reaper001] Reaping device "ce011711a418990e01" due to heartbeat timeout
INF/reaper 17201 [reaper001] Reaping device "a285daa5" due to heartbeat timeout
INF/reaper 17201 [reaper001] Reaping device "LGV700db999815" due to heartbeat timeout
INF/reaper 17201 [reaper001] Reaping device "cd1753ee" due to heartbeat timeout
INF/reaper 17201 [reaper001] Reaping device "e7572a5c" due to heartbeat timeout

**Workaround**
I simply edited out stf/lib/cli/provider/index.js and stf/lib/cli/device/index.js files adding proper values.

**Attachment**
Loading with and without the variable.
![2017-08-27_19-50-47](https://user-images.githubusercontent.com/10826482/29752574-11298326-8b61-11e7-99bf-039558a2e8a5.gif)

  stf-processor can not start ,  flowing
![image](https://user-images.githubusercontent.com/31344510/29717563-338dc9e8-89e2-11e7-8d35-ac15e9cd6ab7.png)
logs  ， flowing
![image](https://user-images.githubusercontent.com/31344510/29717492-f1f14f96-89e1-11e7-92ac-306942d4b29f.png)
command ， flowing
![image](https://user-images.githubusercontent.com/31344510/29717595-52518f90-89e2-11e7-99e5-658823cc23c2.png)
![image](https://user-images.githubusercontent.com/31344510/29717626-6262101c-89e2-11e7-87f3-4c574da3cf3d.png)
![image](https://user-images.githubusercontent.com/31344510/29717642-6fdeb7fe-89e2-11e7-8597-e316bd622f70.png)

everything i have try，but it not success ，please help me，thank you

 @sorccu 
thank you your replay
i have a problem about  “SECRET=YOUR_SESSION_SECRET_HERE”，What value should I assign to it？is it the same as "AUTHKEY"，or I'm defining myself？  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**Whenever I click on a web link to a device for ex:  http://x.x.x.x:7100/auth/mock/#!%2Fcontrol%2Fxxxxxxxx it asks me for Name and Email Id and once I enter I am taken to Device list page rather that that particular device control screen. Am I using wrong link to access device or is it a bug?** 

  **Option for connecting devices via adb connect from STF**
Hi,
I would like to connect some AndroidTVs and FireTVs to STF, but Im missing option to connect  device just via IP address. Do you plan to add this option?
Or if you can point me to the right module, I can try to add it.

Thank you in advance!
 Ok Thanks!   CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/transupp.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdatadst-tj.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdatasrc-tj.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/simd/jsimd_x86_64.o
  LIBTOOL-STATIC Release/libjpeg-turbo.a
libtool: unrecognized option `-static'
libtool: Try `libtool --help' for more information.
make: *** [Release/libjpeg-turbo.a] Error 1
gyp ERR! build error
gyp ERR! stack Error: `make` failed with exit code: 2
gyp ERR! stack     at ChildProcess.onExit (/Users/stf/node_modules/node-gyp/lib/build.js:258:23)
gyp ERR! stack     at emitTwo (events.js:106:13)
gyp ERR! stack     at ChildProcess.emit (events.js:191:7)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
gyp ERR! System Darwin 16.7.0
gyp ERR! command "/usr/local/bin/node" "/Users/stf/node_modules/node-gyp/bin/node-gyp.js" "build" "--fallback-to-build" "--module=/Users/stf/node_modules/jpeg-turbo/lib/binding/node-v48-darwin-x64/jpegturbo.node" "--module_name=jpegturbo" "--module_path=/Users/stf/node_modules/jpeg-turbo/lib/binding/node-v48-darwin-x64

------------
$ which libtool
/usr/local/bin/libtool

libtool --version
libtool (GNU libtool) 2.4.2
Written by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996

Copyright (C) 2011 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. First I had the homebrew libtool installed, which does not accept the `-static` parameter.

```
brew unlink libtool
Unlinking /usr/local/Cellar/libtool/2.4.6_1... 20 symlinks removed
```

Next I had an auto-generated `libtool` at my `/usr/local/bin/libtool`

```
$ which libtool
/usr/local/bin/libtool

$ rm -rf /usr/local/bin/libtool
$ which libtool
/usr/bin/libtool
```

Compiling `node-sass` now works correctly.  I read to this: https://github.com/openstf/stf#recommended-hardware

But I'm not sure we have information about maximum device connected to that recommended hardware.

Please help me to confirm that.
Thank @sorccu so much!
 Thank you for your answer!  brew upgrade zmq
Error: zmq 4.2.2 already installed
$ ./bin/stf doctor
INF/cli:doctor 3046 [*] OS Arch: x64
INF/cli:doctor 3046 [*] OS Platform: darwin
INF/cli:doctor 3046 [*] OS Platform: 16.7.0
INF/cli:doctor 3046 [*] Using Node 6.9.4
ERR/cli:doctor 3046 [*] Unexpected error checking ZeroMQ: Error: Module version mismatch. Expected 48, got 47.
INF/cli:doctor 3046 [*] Using RethinkDB 2.3.6
INF/cli:doctor 3046 [*] Using GraphicsMagick 1.3.25
INF/cli:doctor 3046 [*] Using ProtoBuf 3.2.0
INF/cli:doctor 3046 [*] Using ADB 1.0.39 I do not know what is wrong thx,   Hi,

just looking for an information. In https://github.com/openstf/stf#recommended-hardware You recommend UDB HUB:

http://plugable.com/products/usb2-hub7bc

But, that was long time ago. You still think its the best option? And using p.e. 

http://plugable.com/products/usb3-hub10c2/

its a risk in terms of reliability?

Thanks Thx a lot for reply.

I'll acquire http://plugable.com/products/usb2-hub7bc then.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  Hi, 
I'm trying to customize the STF to our internal needs, and I need to fetch more details about device and show it in device detail.. But I can't figure out, wherefrom the STF is getting the informations like OS, SDK, Platform, HW details? Do I need to customize the mobile app STF, so it will send those informations, or can it be done from STF app without altering mobile app codes?  'adb shell getprop' is what I'm looking for, but I can't find it in STF codes anywhere to modify it to my needs Ok, thanks for you help.. Anyway I was not able to figure out, how to alter the adb shell command to return Knox SDK version.. 
This is the command I want to use `adb shell getprop net.knox.shareddevice.version` Yep, thats what I thought, just wanted to be sure, there is no easy way to do it 👍  Thanks a lot..  I I find that auth-url, websocket-url, and --app-url useless in STF, the browser knows which domain it visit STF from, if we give a fixed domain , accessing the **same** STF from **two** domains is very difficult, I think we can just give /auth/mock/ instead of https://stf.example.org/auth/mock/  **What is the issue or idea you have?**
USB devices randomly disconnecting themselves

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
No matter the devices, it was working well on 3-4 devices, then suddenly when I plugged two more it started to constantly restart - even unplugging the other ones does not fix the issue

**Please provide the steps to reproduce the issue.**
1. Plug 3-4 devices
2. Start STF
3. Plug two more

**What is the expected behavior?**
They should work

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
https://pastebin.com/fj02PxEy

**Please run `stf doctor` and paste the output here.**
N/A, using docker, and while doing that it throws errors that are unrelated (like "adb is missing" while I'm able to fully use the devices)

![chrome_2017-08-17_13-02-20](https://user-images.githubusercontent.com/10826482/29409579-30f853c4-834d-11e7-86e3-1bfd7f219ff8.png)
![chrome_2017-08-17_13-02-09](https://user-images.githubusercontent.com/10826482/29409578-30f7c364-834d-11e7-813b-e916f88bda7b.png)
 I bought hardware specifically following the README. G4560 (so newest gen CPU) and B250M motherboard, along with SSD and 8gb of rams. Also top-end usb hubs, active, powered from power outlet. http://www.tp-link.com.pl/products/details/cat-5688_UH700.html - UH700 TP Link, you can't even get a more expensive one in here. Also, I've been playing with STF a year or two ago, and it worked up to 10 devices on mac (!), so should work here too I guess?

One more thing - I'm still waiting for the StarTech usb controller, but I think 6 devices should not restart themselves @sorccu big thanks for this support that you didn't even had to provide - I have a few of those hubs already unfortunately (they did work with mac up to 12 devices), so for now I'll just plug less devices per hub and then import the pluggable from US.

Thanks! Sure, but who has the resources to test out all the USB Hubs and usb extension cards out there? ;) You guys (or just you?) did a great job handpicking two best options for both hubs and extension cards. 

My StarTech PCIe card should arrive next week, and I just ordered the pluggable usb 2.0 hub, so hopefully it'll sort out at least those problems I face now.

Thanks! Just in case someone has similiar issue - I was making a research what's wrong with UH700/720. Turns out, for some reason, in some cases, it tends to restart every 30 seconds (rough estimate of how often my devices were kicked off stf):

https://ubuntuforums.org/showthread.php?t=2201564

Removing extension cord should help. Also, it's basically 4 port device with... another hub plugged into one of its ports. Nice engineering TP-Link ;) 

One more thing: It fixed itself (disconnecting) when I connected the hub to 2.0 port in front of the PC panel rather than 3.0 port.  One (really) last tip, that could help someone - I wasn't able to fix the 3.0 ports, BUT, after turning off ALL USB options in bios and, using powertop, in tunables, selecting autosupsend as "bad" resolved the issue completely. Even with the mentioned hubs, I was able to connect 24 devices (3x7 + 3 ports) and everything is super stable.
I have no idea how I managed to get to this point, because no one mentioned fiddling with that option, but it helped me. 
![2017-08-21_00-49-53](https://user-images.githubusercontent.com/10826482/29499140-b5606574-860a-11e7-9a57-a364c6f58eca.png)
 @sorccu sure, that's why I'm setting up the proper USB controller and using the pluggable hub, which is much more capable, for more power consuming devices (like tablets and bigger phones). I've left this info here also in case someone will have similiar problem - so you can always reroute him (or he can find this in google or STF issues listing)  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
I have set up stf and connect to devices successfully.  But on the device control page: the landscape icon is not working for me. 

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
Right now I have tried 3 devices, nexus4, galaxy s4, galaxy s5, the landscape not work for all of them

**Please provide the steps to reproduce the issue.**
Select one device on the devices list, then on detail page click on landscape icon. Device is still portrait.

**What is the expected behavior?**
Device screen should change to Landscape.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
No error shows up. or on browser debug panel, nothing shows up.

**Please run `stf doctor` and paste the output here.**
 Hi sorccu,

thank you for your quit comment.  but it's not working for me. any idea about it? 

**stf doctor** result: 
INF/cli:doctor 35364 [*] OS Arch: x64
INF/cli:doctor 35364 [*] OS Platform: darwin
INF/cli:doctor 35364 [*] OS Platform: 14.5.0
INF/cli:doctor 35364 [*] Using Node 6.10.1
INF/cli:doctor 35364 [*] Using ZeroMQ 4.2.2
INF/cli:doctor 35364 [*] Using RethinkDB 2.3.6
INF/cli:doctor 35364 [*] Using GraphicsMagick 1.3.26
INF/cli:doctor 35364 [*] Using ADB 1.0.39
INF/cli:doctor 35364 [*] Using ProtoBuf 3.3.2  I tried this two: 
> stf local --public-ip 10.2.21.145  --allow-remote --lock-rotation;
> stf local --lock-rotation

 It fixed today. I really don't know what's wrong. Yesterday I tried various browsers and update my node version, but didn't work.   Anyway, really appreciate your help, sorccu.  I think I know what could be the issue here - I had similiar situation, thinking what could be wron, in the end it turned out... S8 is not supporting landscape mode on home screen. I noticed that when I opened the browser and the rotation suddenly changed.

Hope that helps someone with similiar problem :)   Hello,
I am trying to automatically extract coordinates of all user actions (e.g., tap or swipe) on a OpenSTF device.

For actions which are manually triggered by a user on OpenSTF device, I can extract these coordinates by slightly modifying the code in stf/lib/units/device/plugins/touch/index.js. Specifically, I can extract the coordinates once the device screen is touched from TouchConsumer.prototype.touchDown = function(point) {...} function.

However, my approach does not work for actions which are automatically triggered by Appium test scripts (like the ones in STF appium example : https://github.com/openstf/stf-appium-example). I suspect that the reason is because after getting the remote ADB URL from OpenSTF, Appium calls "adb connect" to directly control the selected device so it doesn't use any component of OpenSTF, except the minicap for doing a kind of "streaming". Am I right?

If I am wrong, could you please let me know whether I can retrieve coordinates of actions triggered by Appium test scripts from somewhere else in OpenSTF code base or not? I have taken a look into the adbkit module (https://github.com/openstf/adbkit) but have not found any solution. Many thanks.  Hi guys, since I have upgraded to the latest version some devices are stuck in preparing mode and other two devices appear as "disconnected" even when I can list them in adb
![screen shot 2017-08-16 at 08 39 53](https://user-images.githubusercontent.com/632140/29350415-cef1ed8c-825e-11e7-9312-fae636bb433f.png)

adb devices -l 
df50c2e6               device usb:343150592X product:hltexx model:SM_N9005 device:hlte
341abad4               device usb:343158784X product:kltexx model:SM_G900F device:klte
FA619WM01162           device usb:343163136X product:htc_europe model:HTC_One_M8 device:htc_m8
988637333547315955     device usb:343163648X product:heroltexx model:SM_G930F device:herolte
CB5A2C10HQ             device usb:343163392X product:E6853 model:E6853 device:E6853
LGH87077af27a0         device usb:343080960X product:lucye_global_com model:LG_H870 device:lucye
ENU7N15B14006014       device usb:343154688X product:angler model:Nexus_6P device:angler

stf doctor
INF/cli:doctor 36272 [*] OS Arch: x64
INF/cli:doctor 36272 [*] OS Platform: darwin
INF/cli:doctor 36272 [*] OS Platform: 16.6.0
INF/cli:doctor 36272 [*] Using Node 8.1.2
INF/cli:doctor 36272 [*] Using ZeroMQ 4.2.2
INF/cli:doctor 36272 [*] Using RethinkDB 2.3.5
INF/cli:doctor 36272 [*] Using ADB 1.0.39
INF/cli:doctor 36272 [*] Using GraphicsMagick 1.3.25
INF/cli:doctor 36272 [*] Using ProtoBuf 3.3.0
 Ok. I guess this is what you are looking for. I will try to uninstall the package with adb or factory reset the devices to see if that fixes the issue

```
FTL/device 36990 [988637333547315955] Setup had an error Error: /data/local/tmp/STFService.apk could not be installed [INSTALL_FAILED_INSUFFICIENT_STORAGE]
    at /usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/command/host-transport/install.js:28:23
    at runCallback (timers.js:800:20)
    at tryOnImmediate (timers.js:762:5)
    at processImmediate [as _immediateCallback] (timers.js:733:5)
FTL/util:lifecycle 36990 [988637333547315955] Shutting down due to fatal error
INF/provider 36968 [*] Cleaning up device worker "988637333547315955"
ERR/provider 36968 [*] Device worker "988637333547315955" died with code 1
INF/provider 36968 [*] Restarting device worker "988637333547315955"
FTL/device 36991 [CB5A2C10HQ] Setup had an error Error: /data/local/tmp/STFService.apk could not be installed [INSTALL_FAILED_INSUFFICIENT_STORAGE: Package couldn't be installed in /data/app/jp.co.cyberagent.stf-1: Creating application package jp.co.cyberagent.stf failed]
    at /usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/command/host-transport/install.js:28:23
    at runCallback (timers.js:800:20)
    at tryOnImmediate (timers.js:762:5)
    at processImmediate [as _immediateCallback] (timers.js:733:5)
```
 No, disk is not full. 13.31 GB free in fact :) In my case, some devices keep in preparation status are due to stf service can't be started directly, on some devices, we should start activity first then start the service by issuing:

      adb shell am start -n jp.co.cyberagent.stf/.IdentityActivity   
      adb shell am startservice  -n jp.co.cyberagent.stf/.Service
 On some devices of Meizu, we can't start a service before activating the activity ...  I'm sure they have the auto start setting but it 's actually not working for STF service. Now I hit the problem only on devices of Meizu. i got the same problem on a "Lava Iris 870"
Starting the service manually solved it for me as well  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Unable to make an initial STF run

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
I was able to run it on MacOSX previously.

**Please provide the steps to reproduce the issue.**
Installed it on Stretch debian

**What is the expected behavior?**
Should start the stf

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
INF/storage:temp 21122 [*] Listening on port 7102
/usr/bin/nodejs ../lib/cli app

Opcje:
  -h, --help           Show help.                                      [boolean]
  -V, --version        Show version.                                   [boolean]
  --auth-url, -a       URL to the auth unit.            [ciąg znaków] [wymagany]
  --port, -p           The port to bind to.            [liczba] [domyślny: 7105]
  --secret, -s         The secret to use for auth JSON Web Tokens. Anyone who
                       knows this token can freely enter the system if they
                       want, so keep it safe.           [ciąg znaków] [wymagany]
  --ssid, -i           The name of the session ID cookie.
                                                [ciąg znaków] [domyślny: "ssid"]
  --user-profile-url   URL to an external user profile page.       [ciąg znaków]
  --websocket-url, -w  URL to the websocket unit.       [ciąg znaków] [wymagany]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_APP_` (e.g. `STF_APP_AUTH_URL`).

"rootDirectory" not specified or is invalid
FTL/cli:local 21055 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/home/rabus/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 21055 [*] Shutting down all child processes


**Please run `stf doctor` and paste the output here.**
INF/cli:doctor 21043 [*] OS Arch: x64
INF/cli:doctor 21043 [*] OS Platform: linux
INF/cli:doctor 21043 [*] OS Platform: 4.9.0-3-amd64
INF/cli:doctor 21043 [*] Using Node 6.11.2
INF/cli:doctor 21043 [*] Using ZeroMQ 4.1.2
INF/cli:doctor 21043 [*] Using RethinkDB 2.3.5~0stretch
INF/cli:doctor 21043 [*] Using GraphicsMagick 1.3.25
INF/cli:doctor 21043 [*] Using ProtoBuf 3.3.2
INF/cli:doctor 21043 [*] Using ADB 1.0.36
 I've never resolved this issue myself, even after trying with:
Debian 7,8,9 and Ubuntu 14.04 and 16.04.

But was able to set it up via docker. So I'll close the ticket - but in case someone runs into such a problem like I did, I recommend trying with Docker. It took me like 30 seconds instead of 1 full day of trying. i ran into this same issue on ubuntu 17.04 using the 'nodeenv' utility to download & setup the node/npm environment. this happened with both the latest stable (8.4.0) and latest lts (6.11.2) node.
to debug, i ran each command individually until i found the one that output the error that included at the bottom:
`Each option can be be overwritten with an environment variable by converting the option to uppercase, replacing dashes with underscores and prefixing it with STF_APP_ (e.g. STF_APP_AUTH_URL)." `
this turned out to be the 'stf app' command, e.g: 
`./node_modules/stf/bin/stf app --user-profile-url http://localhost --websocket-url websocket://localhost --auth-url http://localhost`
running that failed with the same error message about `"rootDirectory" not specified or is invalid` which actually comes from the markdownserver npm module.
anyhow, the ENOENT i noticed in the strace was this:
`[pid 22147] stat("/home/matt/devel/nexus/openstf_nodeenv/node_modules/stf/node_modules/stf-wiki", 0x3c8ea9931d0) = -1 ENOENT (No such file or directory)`
i guess the search path for the module wasn't right. i just worked around it by making a symlink like so:
`(openstf_nodeenv)matt@aquos:~/devel/nexus/openstf_nodeenv/node_modules/stf$ ls -l node_modules`
`lrwxrwxrwx 1 matt matt 2 Aug 30 00:46 node_modules -> ..`
everything started up fine after making the symlink. hope this saves somebody else an hour, lol.
 hmm, haven't tried nvm. i want to say i went with nodeenv because it's in the ubuntu repos and i prefer to use a repo/.deb if possible. i might check it out anyways, though.
i did just now test executing it from different paths, e.g. bin/stf and stf/bin/stf, but it still failed to start with the same error message.
btw, this thing is really pretty cool :) another quick note. that little recursive symlink breaks other stuff, like 'npm ls'. fails with `npm ERR! Maximum call stack size exceeded`. so, runtime of openstf isn't affected negatively, but doing other stuff with npm appears to be. hope this saves someone else another 10 minutes, lol. This error happens with `yarn`, installing the global module with yarn. 
Throws:

>Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
STF_APP_ (e.g. STF_APP_AUTH_URL). Same for me using yarn 1.6.0 and trying to run "stf local"

```
2018-04-17T00:28:00.131Z INF/storage:temp 776 [*] Listening on port 7102
2018-04-17T00:28:00.138Z INF/reaper 741 [reaper001] Device "ZY224DVHBW" is present
cli app

Options:
  -h, --help           Show help.                                      [boolean]
  -V, --version        Show version.                                   [boolean]
  --auth-url, -a       URL to the auth unit.                 [string] [required]
  --port, -p           The port to bind to.             [number] [default: 7105]
  --secret, -s         The secret to use for auth JSON Web Tokens. Anyone who
                       knows this token can freely enter the system if they
                       want, so keep it safe.                [string] [required]
  --ssid, -i           The name of the session ID cookie.
                                                      [string] [default: "ssid"]
  --user-profile-url   URL to an external user profile page.            [string]
  --websocket-url, -w  URL to the websocket unit.            [string] [required]

Each option can be be overwritten with an environment variable by converting the
option to uppercase, replacing dashes with underscores and prefixing it with
`STF_APP_` (e.g. `STF_APP_AUTH_URL`).

"rootDirectory" not specified or is invalid
2018-04-17T00:28:00.366Z FTL/cli:local 710 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/share/.config/yarn/global/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:126:13)
    at ChildProcess.emit (events.js:214:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:198:12)
2018-04-17T00:28:00.366Z INF/cli:local 710 [*] Shutting down all child processes
```  **What is the issue or idea you have?**
Version 3.0.0 is not released to docker hub, latest update was about a month ago: https://hub.docker.com/r/openstf/stf/ while on GitHub releases page or npm there is v 3.0.0 published 5 days ago.

**Please provide the steps to reproduce the issue.**
Go to https://hub.docker.com/r/openstf/stf/tags/

**What is the expected behavior?**
Version 3.0.0 is available on docker hub.  Hi, 
I getting this error even though i have started `rethinkdb, it starts successfully: 

```
Running rethinkdb 2.3.6 (CLANG 8.0.0 (clang-800.0.42.1))...
Running on Darwin 15.6.0 x86_64
Loading data from directory /Users/pp/rethinkdb_data
warn: Cache size does not leave much memory for server and query overhead (available memory: 267 MB).
warn: Cache size is very low and may impact performance.
Listening for intracluster connections on port 29015
Listening for client driver connections on port 28015
Listening for administrative HTTP connections on port 8080
Listening on cluster addresses: 127.0.0.1, ::1
Listening on driver addresses: 127.0.0.1, ::1
Listening on http addresses: 127.0.0.1, ::1
To fully expose RethinkDB on the network, bind to all addresses by running rethinkdb with the `--bind all` command line option.
Server ready, "pp_szg" 9b1ad1fc-ff31-4441-95e1-ef0dc4b434c0
```
This is what i get when starting the stf, i use the `stf local`  or `stf local --public-ip <COMPUTER IP>` i get this: 

```
$ Stf local
INF/util:procutil 6260 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli migrate"
INF/db 6261 [*] Connecting to 127.0.0.1:28015
INF/db 6261 [*] Unable to connect to 127.0.0.1:28015
FTL/db 6261 [*] No hosts left to try
FTL/util:lifecycle 6261 [*] Shutting down due to fatal error

/usr/local/lib/node_modules/stf/node_modules/bluebird/js/main/promise.js:680
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
```

I have tried uninstalling the rethinkdb and stf; no luck. I have read this this issue as this parson having similar issue [#458](https://github.com/openstf/stf/issues/458) but this person had it in different ports whereas mine is the same one `28015`. I am running one MAC OS X EL Capitan

Any help would be appreciated, let me know if like any information. Thanks. Just update : I have created another user on the same mac and  started all the services and it works. Can I know what is the issue or mistake I am doing?   ryOnImmediate (timers.js:645:5)
    at processImmediate [as _immediateCallback] (timers.js:617:5)
FTL/util:lifecycle 11076 [A02AECPB2E3T4] Shutting down due to fatal error
INF/provider 10924 [*] Cleaning up device worker "A02AECPB2E3T4"
# **ERR/provider 10924 [*] Device worker "A02AECPB2E3T4" died with code 1**
INF/provider 10924 [*] Restarting device worker "A02AECPB2E3T4" FTL/device 14370 [A02AECPB2E3T4] Setup had an error Error: Service had an error: "Error: Not found; no service started."
    at /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/lib/units/device/plugins/service.js:101:23
From previous event:
    at /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/lib/units/device/plugins/service.js:76:14
    at runCallback (timers.js:672:20)
    at tryOnImmediate (timers.js:645:5)
    at processImmediate [as _immediateCallback] (timers.js:617:5)
FTL/util:lifecycle 14370 [A02AECPB2E3T4] Shutting down due to fatal error
INF/provider 12986 [*] Cleaning up device worker "A02AECPB2E3T4"
ERR/provider 12986 [*] Device worker "A02AECPB2E3T4" died with code 1



Do you know YunOS？The error on YunOS by Alibaba. I found a solution.The error on YunOS by Alibaba,Use the following steps:

adb uninstall jp.co.cyberagent.stf 
adb install d:/xxx/STFService.apk 
adb shell am start -n jp.co.cyberagent.stf/.IdentityActivity
adb shell am startservice  -n jp.co.cyberagent.stf/.Service  ERROR in ./res/app/app.js
Module not found: Error: Cannot resolve module 'angular-route' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app
 @ ./res/app/app.js 3:2-26

ERROR in ./res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-route' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/auth/mock/scripts
 @ ./res/auth/mock/scripts/entry.js 5:2-26

ERROR in ./res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-route' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/auth/ldap/scripts
 @ ./res/auth/ldap/scripts/entry.js 5:2-26

ERROR in ./res/app/app.js
Module not found: Error: Cannot resolve module 'angular-touch' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app
 @ ./res/app/app.js 4:2-26

ERROR in ./res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-touch' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/auth/mock/scripts
 @ ./res/auth/mock/scripts/entry.js 6:2-26

ERROR in ./res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-touch' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/auth/ldap/scripts
 @ ./res/auth/ldap/scripts/entry.js 6:2-26

ERROR in ./res/web_modules/gettext/index.js
Module not found: Error: Cannot resolve module 'angular-gettext' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/gettext
 @ ./res/web_modules/gettext/index.js 1:0-26

ERROR in ./res/web_modules/nine-bootstrap/index.js
Module not found: Error: Cannot resolve module 'bootstrap/dist/css/bootstrap.css' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/nine-bootstrap
 @ ./res/web_modules/nine-bootstrap/index.js 1:0-43

ERROR in ./res/web_modules/nine-bootstrap/index.js
Module not found: Error: Cannot resolve module 'components-font-awesome/css/font-awesome.css' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/nine-bootstrap
 @ ./res/web_modules/nine-bootstrap/index.js 5:0-55

ERROR in ./res/web_modules/nine-bootstrap/index.js
Module not found: Error: Cannot resolve module 'font-lato-2-subset' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/nine-bootstrap
 @ ./res/web_modules/nine-bootstrap/index.js 7:0-29

ERROR in ./res/web_modules/angular-hotkeys/index.js
Module not found: Error: Cannot resolve module 'angular-hotkeys/build/hotkeys.css' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/angular-hotkeys
 @ ./res/web_modules/angular-hotkeys/index.js 1:0-44

ERROR in ./res/web_modules/angular-hotkeys/index.js
Module not found: Error: Cannot resolve module 'angular-hotkeys/build/hotkeys.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/angular-hotkeys
 @ ./res/web_modules/angular-hotkeys/index.js 3:0-43

ERROR in ./res/web_modules/ui-bootstrap/index.js
Module not found: Error: Cannot resolve module 'angular-bootstrap/ui-bootstrap-tpls' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/ui-bootstrap
 @ ./res/web_modules/ui-bootstrap/index.js 1:0-53

ERROR in ./res/web_modules/angular-borderlayout/index.js
Module not found: Error: Cannot resolve module 'angular-borderlayout/src/borderLayout.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/angular-borderlayout
 @ ./res/web_modules/angular-borderlayout/index.js 1:0-51

ERROR in ./res/web_modules/angular-borderlayout/index.js
Module not found: Error: Cannot resolve module 'angular-borderlayout/src/borderLayout.css' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/angular-borderlayout
 @ ./res/web_modules/angular-borderlayout/index.js 2:0-52

ERROR in ./res/web_modules/angular-xeditable/index.js
Module not found: Error: Cannot resolve module 'angular-xeditable/dist/js/xeditable.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/angular-xeditable
 @ ./res/web_modules/angular-xeditable/index.js 1:0-49

ERROR in ./res/web_modules/angular-xeditable/index.js
Module not found: Error: Cannot resolve module 'angular-xeditable/dist/css/xeditable.css' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/angular-xeditable
 @ ./res/web_modules/angular-xeditable/index.js 2:0-51

ERROR in ./res/app/components/stf/device/device-service.js
Module not found: Error: Cannot resolve module 'oboe' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/device
 @ ./res/app/components/stf/device/device-service.js 1:11-26

ERROR in ./res/app/control-panes/dashboard/clipboard/index.js
Module not found: Error: Cannot resolve module 'angular-elastic' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/control-panes/dashboard/clipboard
 @ ./res/app/control-panes/dashboard/clipboard/index.js 3:0-26

ERROR in ./res/app/components/stf/common-ui/notifications/index.js
Module not found: Error: Cannot resolve module 'angular-animate' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/common-ui/notifications
 @ ./res/app/components/stf/common-ui/notifications/index.js 1:0-26

ERROR in ./res/app/components/stf/common-ui/table/index.js
Module not found: Error: Cannot resolve module 'ng-table/dist/ng-table' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/common-ui/table
 @ ./res/app/components/stf/common-ui/table/index.js 2:0-40

ERROR in ./res/app/components/stf/common-ui/enable-autofill/index.js
Module not found: Error: Cannot resolve module 'angular-cookies' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/common-ui/enable-autofill
 @ ./res/app/components/stf/common-ui/enable-autofill/index.js 1:0-26

ERROR in ./res/web_modules/ng-context-menu/index.js
Module not found: Error: Cannot resolve module 'ng-context-menu/dist/ng-context-menu' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/ng-context-menu
 @ ./res/web_modules/ng-context-menu/index.js 1:0-47

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/rect.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 3:0-29

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/packer.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 4:0-31

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/item.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 5:0-29

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/packery.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 6:14-46

ERROR in ./res/app/settings/general/local/index.js
Module not found: Error: Cannot resolve module 'angular-bootstrap/ui-bootstrap-tpls' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/settings/general/local
 @ ./res/app/settings/general/local/index.js 1:0-28

ERROR in ./res/web_modules/ng-file-upload/index.js
Module not found: Error: Cannot resolve module 'ng-file-upload/angular-file-upload-shim' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/ng-file-upload
 @ ./res/web_modules/ng-file-upload/index.js 1:0-50

ERROR in ./res/web_modules/ng-file-upload/index.js
Module not found: Error: Cannot resolve module 'ng-file-upload/angular-file-upload' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/ng-file-upload
 @ ./res/web_modules/ng-file-upload/index.js 2:0-45

ERROR in ./res/app/components/stf/logcat/logcat-service.js
Module not found: Error: Cannot resolve module 'underscore.string/index' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/logcat
 @ ./res/app/components/stf/logcat/logcat-service.js 2:9-37

ERROR in ./res/web_modules/angular-growl/index.js
Module not found: Error: Cannot resolve module 'angular-growl-v2/build/angular-growl.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/angular-growl
 @ ./res/web_modules/angular-growl/index.js 1:0-50

ERROR in ./res/app/components/stf/common-ui/modals/fatal-message/index.js
Module not found: Error: Cannot resolve module 'angular-route' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/common-ui/modals/fatal-message
 @ ./res/app/components/stf/common-ui/modals/fatal-message/index.js 1:0-24

ERROR in ./res/web_modules/angular-ladda/index.js
Module not found: Error: Cannot resolve module 'angular-ladda/src/angular-ladda' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/angular-ladda
 @ ./res/web_modules/angular-ladda/index.js 3:0-42

ERROR in ./res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'jquery' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/epoch
 @ ./res/web_modules/epoch/index.js 1:0-17

ERROR in ./res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'd3' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/epoch
 @ ./res/web_modules/epoch/index.js 3:0-13

ERROR in ./res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'epoch/dist/css/epoch.min.css' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/epoch
 @ ./res/web_modules/epoch/index.js 4:0-39

ERROR in ./res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'epoch/dist/js/epoch.min.js' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/epoch
 @ ./res/web_modules/epoch/index.js 5:0-37

ERROR in ./res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'ng-epoch' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/web_modules/epoch
 @ ./res/web_modules/epoch/index.js 6:0-19

ERROR in ./res/app/components/stf/angular-draggabilly/index.js
Module not found: Error: Cannot resolve module 'draggabilly' in /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/res/app/components/stf/angular-draggabilly
 @ ./res/app/components/stf/angular-draggabilly/index.js 1:18-40
ERR/middleware:webpack 3979 [*] Bundle has errors
INF/webpack:config 3979 [*] Build progress 100% (complete) I'm having a similar issue, have you discovered the source of the problem?  INF/util:doctor 28786 [*] Local RethinkDB server 2.3.6~0vivid
/usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/node_modules/semver/semver.js:293
     throw new TypeError('Invalid Version: ' + version);
     ^

TypeError: Invalid Version: 2.3.6~0vivid
    at new SemVer (/usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/node_modules/semver/semver.js:293:12)
    at Range.test (/usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/node_modules/semver/semver.js:1099:15)
    at Function.satisfies (/usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/node_modules/semver/semver.js:1148:16)
    at unsupportedVersion (/usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/lib/util/doctor.js:95:7
    at /usr/local/node-v6.11.0-linux-x64/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:195:7)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at maybeClose (internal/child_process.js:891:16)
    at Socket.<anonymous> (internal/child_process.js:342:11)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at Pipe._handle.close [as _onclose] (net.js:497:12) for help  **What is the issue or idea you have?**
stf cannot connect to the port RethinkDB is on.  
stf is cloned, built and linked according to the instructions.

**Please provide the steps to reproduce the issue.**
`stf local --public-ip ***.***.***.***`
**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
```
stf local --public-ip ***.***.***.***
INF/util:procutil 3549 [*] Forking "/home/*****/stf/lib/cli migrate"
INF/db 3555 [*] Connecting to 127.0.0.1:28015
FTL/db 3555 [*] Could not connect to 127.0.0.1:28015, operation timed out.
FTL/util:lifecycle 3555 [*] Shutting down due to fatal error

/home/*****/stf/node_modules/bluebird/js/main/promise.js:680
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/home/*****/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
```

**Please run `stf doctor` and paste the output here.**
```
stf doctor
INF/cli:doctor 3639 [*] OS Arch: x64
INF/cli:doctor 3639 [*] OS Platform: linux
INF/cli:doctor 3639 [*] OS Platform: 4.4.0-78-generic
INF/cli:doctor 3639 [*] Using Node 6.11.2
INF/cli:doctor 3639 [*] Using ZeroMQ 4.1.2
INF/cli:doctor 3639 [*] Using RethinkDB 2.3.6~0xenial
INF/cli:doctor 3639 [*] Using GraphicsMagick 1.3.23
INF/cli:doctor 3639 [*] Using ADB 1.0.39
ERR/cli:doctor 3639 [*] ProtoBuf version cannot be detected
```

**Output from `netstat`:**
```
sudo netstat -tulpn | grep rethinkdb
tcp        0      0 127.0.1.1:28015         0.0.0.0:*               LISTEN      3224/rethinkdb  
tcp        0      0 127.0.0.1:28015         0.0.0.0:*               LISTEN      3224/rethinkdb  
tcp        0      0 127.0.1.1:8080          0.0.0.0:*               LISTEN      3224/rethinkdb  
tcp        0      0 127.0.0.1:8080          0.0.0.0:*               LISTEN      3224/rethinkdb  
tcp        0      0 127.0.1.1:29015         0.0.0.0:*               LISTEN      3224/rethinkdb  
tcp        0      0 127.0.0.1:29015         0.0.0.0:*               LISTEN      3224/rethinkdb  
tcp6       0      0 ::1:28015               :::*                    LISTEN      3224/rethinkdb  
tcp6       0      0 ::1:8080                :::*                    LISTEN      3224/rethinkdb  
tcp6       0      0 ::1:29015               :::*                    LISTEN      3224/rethinkdb  
``` I had a quick look in the source, and it asked for `protoc`, so I ran `protoc --version` and this is the output:
```
protoc --version
libprotoc 3.2.0
``` The error is gone, and I had ~~another error~~ fixed it and it runs now, weird. For the future people, I had a fresh install of rethinkdb from apt, and maybe it's the test connection I tried with the Python driver for RethinkDB that 'fixed' it. Or maybe it's just the new SSH connection.

Thanks for the help (and the great app), you can close it now.  Hello,
I successfully setup OpenSTF on a machine following the installation guide at https://github.com/openstf/stf. I can use OpenSTF on this machine by accessing 127.0.0.1:7100 using mock authentication. However, when I try to access the device test farm from another machine on the same network (by typing IP_ADDRESS:7100 where IP_ADDRESS is the address of the machine on which OpenSTF has been installed), I get the error message "This site can't be reached" and on the URL bar of the web browser I see this URL "localhost:7100/auth/mock".
I would like to get some suggestion on configuring OpenSTF so it is accessible from other machines on the same network.
Thanks,
Thuan

 Oh, my bad. It works now. Thank you very much for your prompt reply.  Hi Team,

I have installed all the  pre requisites as mentioned the documents, however when i run the 'stf local' to start the stf server from terminal i am getting the below error

**NOTE :** When i type stf doctor , i see nothing in the terminal window.


NF/reaper 24112 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/poorxy 24121 [*] Listening on port 7100

events.js:72
        throw er; // Unhandled 'error' event
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:901:11)
    at Server._listen2 (net.js:1039:14)
    at listen (net.js:1061:10)
    at Server.listen (net.js:1127:5)
    at module.exports (/usr/local/lib/node_modules/stf/lib/units/poorxy/index.js:67:10)
    at Command.program.command.description.option.option.option.option.option.option.action.require.port (/usr/local/lib/node_modules/stf/lib/cli.js:637:30)
    at Command.listener (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:300:8)
    at Command.EventEmitter.emit (events.js:98:17)
    at Command.parseArgs (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:635:12)
    at Command.parse (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:457:21)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:1266:9)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
FTL/cli:local 24106 [*] Child process had an error ExitError: Exit code "8"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.EventEmitter.emit (events.js:98:17)

Thanks
RajendraC Thanks for the quick reply Sorccu, actual problem was my airdrop server was running on the localhost 7100 port, I have forcefully closed Airserver from activity monitor, then my STF is running like a charm

Regards,
RajendraC Yes, sorccu, 
I would like to be in touch with you for the goal i am trying for using STF, I have my appium+Selenium(automation tools) automated scripts are developed and stored it my desktop, every time i am running those scripts on physical devices by connecting through USB cable. Now i would like to make a local cloud of  all my devices and would like to access those devices over the localhost to run my automated tests, 

Any help in this regard would highly help to achieve my goal

Thanks in Advance,
RajendraC Thats fine, I will post if any issues come across

Thanks,
Rajendra  First of all, thank you for your great software.
It has been a really great source of help, and I'm looking for an option to install the same APK and run the same test on a group of selected devices from the STF panel. Is there a way to do this?

Thanks in advance.
 Ok, Thank You.

Now I've been trying to use STF API to install an APK on several devices simultaneously,  but unsuccessfully. Is there any kind of tutorial for this? 

I've tried using the examples with curl:

curl -H "Authorization: Bearer YOUR-TOKEN-HERE" https://stf.example.org/api/v1/user

but I get this:

curl: (6) Could not resolve host: stf.example.org

Thanks in advance  **What is the issue or idea you have?**
I know you don't support any question apart from the scope.
I want to understand how do you get the serial and port information after running the provider, are these a kind of environment variable, I am trying to make it as a pod in the k8s.
Since there is no direct way to provide `--screen-ws-url-pattern "wss://stf.example.org/d/%i/<%= serial %>/<%= publicPort %>/"` apart from environment variable, I don't see any environment variable exposed for `serial` and `publicPort`.

Also, Since I am using an ingress to bind all the services, I am still a bit confused with provider being being a part of ingress.

Any suggestion will be appreciated, Thanks! @sorccu @vbanthia Any suggestion here guys? @sorccu
I currently have 2 issues:
- If I hard code the serial number for provider, then only it gets registered and starts to provide, but fails at the websocket connection.`failed: Error during WebSocket handshake: Unexpected response code: 400`, I still have an operable greyed out screen.
- If I give the provider any other name apart from serial number of device - it just gets filtered out. And this happens only in the case of creating it as a replication controller in k8s If I make provider  as a daemon service on the machine, it provides correctly - 'That's why I am trying to understand, how I can get this in k8s'  I hava cloned the stf.git and deployed the stf by command ```docker build -t stf:0.0.1 .```in th stf git directory.
When I deploy and build successfully , then I run it by the command ```docker run -it stf:0.0.1```.
However , it shows the error message:
> docker run -it stf:0.0.1
> /usr/bin/env: 'node\r': No such file or directory

It can't be executed successfully. 
Could you help solving the problem?
Thx. I have soveld this problem. because the file stf is dos filefomat.
Solution:
install dos2unix , and insert the command ```dos2unix /app/bin/stf && \ ``` before ```cd /app && \```  Hello there!

**What is the issue or idea you have?**
Recently we bought a Mac Mini and I migrated STF from our Mac to the Mac Mini. Everything's working well, but there's this issue that I don't know why happens.

The problem is that sometimes when I plug/unplug a phone, it seems like openstf's devices all unplugged and they restart connecting again.


**Please provide the steps to reproduce the issue.**
With STF running, just plug/unplug some devices and it will eventually happening.


**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

NF/provider 14788 [*] Providing all 14 of 16 device(s); ignoring "CB5A1XN5M8", "0f680bfc"
IMP/device:plugins:service 25307 [04d86162a2438995] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25307 [04d86162a2438995] Launching service
IMP/device:plugins:service 25307 [04d86162a2438995] Service connection ended, attempting to relaunch
INF/device:plugins:service 25307 [04d86162a2438995] Launching service
INF/provider 14788 [*] Lost device "04d86162a2438995" (device)
INF/provider 14788 [*] Shutting down device worker "04d86162a2438995"
INF/provider 14788 [*] Cleaning up device worker "04d86162a2438995"
INF/provider 14788 [*] Gracefully killing device worker "04d86162a2438995"
WRN/device:plugins:touch 25307 [04d86162a2438995] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25307 [04d86162a2438995] Disconnecting from minitouch service
FTL/util:lifecycle 25307 [04d86162a2438995] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25307 [04d86162a2438995] Shutting down due to fatal error
INF/provider 14788 [*] Device worker "04d86162a2438995" has retired
IMP/device:plugins:service 25298 [5B17000411] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25298 [5B17000411] Launching service
IMP/device:plugins:service 25294 [ZX1D22B4MV] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25294 [ZX1D22B4MV] Launching service
IMP/device:plugins:service 25298 [5B17000411] Service connection ended, attempting to relaunch
INF/device:plugins:service 25298 [5B17000411] Launching service
IMP/device:plugins:service 25294 [ZX1D22B4MV] Service connection ended, attempting to relaunch
WRN/device:plugins:touch 25298 [5B17000411] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:service 25294 [ZX1D22B4MV] Launching service
INF/device:plugins:touch 25298 [5B17000411] Disconnecting from minitouch service
WRN/device:plugins:touch 25294 [ZX1D22B4MV] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25294 [ZX1D22B4MV] Disconnecting from minitouch service
IMP/device:plugins:service 25295 [RB042046] Agent connection ended, attempting to relaunch
IMP/device:plugins:service 25300 [0e32a002f1645052] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25295 [RB042046] Launching service
IMP/device:plugins:service 25302 [aa9443f6] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25300 [0e32a002f1645052] Launching service
INF/device:plugins:service 25302 [aa9443f6] Launching service
IMP/device:plugins:service 25303 [FC047636] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25303 [FC047636] Launching service
IMP/device:plugins:service 25302 [aa9443f6] Service connection ended, attempting to relaunch
INF/device:plugins:service 25302 [aa9443f6] Launching service
IMP/device:plugins:service 25295 [RB042046] Service connection ended, attempting to relaunch
INF/device:plugins:service 25295 [RB042046] Launching service
IMP/device:plugins:service 25300 [0e32a002f164IMP/device:plugins:service 25299 [d6656b6a] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25299 [d6656b6a] Launching service
IMP/device:plugins:service 25299 [d6656b6a] Service connection ended, attempting to relaunch
INF/device:plugins:service 25299 [d6656b6a] Launching service
IMP/device:plugins:service 25308 [CB5A2AGTZ3] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25308 [CB5A2AGTZ3] Launching service
WRN/device:plugins:touch 25299 [d6656b6a] Shell keeping minitouch running ended unexpectedly
IMP/device:plugins:service 25308 [CB5A2AGTZ3] Service connection ended, attempting to relaunch
INF/device:plugins:service 25308 [CB5A2AGTZ3] Launching service
INF/device:plugins:touch 25299 [d6656b6a] Disconnecting from minitouch service
WRN/device:plugins:touch 25308 [CB5A2AGTZ3] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25308 [CB5A2AGTZ3] Disconnecting from minitouch service
5052] Service connection ended, attempting to relaunch
IMP/device:plugins:service 25305 [06157df6612b5c22] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25305 [06157df6612b5c22] Launching service
INF/device:plugins:service 25300 [0e32a002f1645052] Launching service
IMP/device:plugins:service 25305 [06157df6612b5c22] Service connection ended, attempting to relaunch
INFWRN/device:plugins:touch 25295 [RB042046] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25295 [RB042046] Disconnecting from minitouch service
IMP/device:plugins:service 25297 [a3a14ab9] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25297 [a3a14ab9] Launching service
IMP/device:plugins:service 25301 [565347b5] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25301 [565347b5] Launching service
IMP/device:plugins:service 25306 [013e689795773670] Agent connection ended, attempting to relaunch
INF/device:plugins:service 25306 [013e689795773670] Launching service
IMP/device:plugins:service 25297 [a3a14ab9] Service connection ended, attempting to relaunch
IMP/device:plugins:service 25301 [565347b5] Service connection ended, attempting to relaunch
INF/device:plugins:service 25301 [565347b5] Launching service
IMPINF/device:plugins:service 25297 [a3a14ab9] Launching service
/device:plugins:service 25306 [013e689795773670] Service connection ended, attempting to relaunch
WRN/device:plugins:touch 25297 [a3a14ab9] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:service 25306 [013e689795773670] Launching service
9m/device:plugins:service 25305 [06157df6612b5c22] Launching service
IMP/device:plugins:service 25296 [52006836bede3287] Agent connection ended, attempting to relaunch
INF/device:plugins:touch 25297 [a3a14ab9] Disconnecting from minitouch service
INF/device:plugins:service 25296 [52006836bede3287] Launching service
WRN/device:plugins:touch 25305 [06157df6612b5c22] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25305 [06157df6612b5c22] Disconnecting from minitouch service
IMP/device:plugins:service 25296 [52006836bede3287] Service connection ended, attempting to relaunch
IMP/device:plugins:service 25303 [FC047636] Service connection ended, attempting to relaunch
INF/device:plugins:service 25303 [FC047636] LaunchinWRN/device:plugins:touch 25306 [013e689795773670] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25306 [013e689795773670] Disconnecting from minitouch service
WRN/device:plugins:touch 25300 [0e32a002f1645052] Shell keeping minitouch running ended unexpectedly
g service
INF/device:plugins:touch 25300 [0e32a002f1645052] Disconnecting from minitouch service
WRN/device:plugins:touch 25303 [FC047636] Shell keeping minitouch running ended unexpectedly
WRN/device:plugins:touch 25302 [aa9443f6] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25302 [aa9443f6] Disconnecting from minitouch service
INF/device:plugins:touch 25303 [FC047636] Disconnecting from minitouch service
INF/device:plugins:service 25296 [52006836bede3287] Launching service
FTL/util:lifecycle 25302 [aa9443f6] Forward shell ended; we shall share its fate
WRN/device:plugins:touch 25296 [52006836bede3287] Shell keeping minitouch running ended unexpectedly
FTL/util:lifecycle 25305 [06157df6612b5c22] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25302 [aa9443f6] Shutting down due to fatal error
FTL/util:lifecycle 25305 [06157df6612b5c22] Shutting down due to fatal error
INF/device:plugins:touch 25296 [52006836bede3287] Disconnecting from minitouch service
WRN/device:plugins:touch 25301 [565347b5] Shell keeping minitouch running ended unexpectedly
FTL/util:lifecycle 25295 [RB042046] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25295 [RB042046] Shutting down due to fatal error
INF/device:plugins:touch 25301 [565347b5] Disconnecting from minitouch service
FTL/util:lifecycle 25296 [52006836bede3287] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25296 [52006836bede3287] Shutting down due to fatal error
FTL/util:lifecycle 25301 [565347b5] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25301 [565347b5] Shutting down due to fatal error
INF/provider 14788 [*] Device "CB5A2AGTZ3" is now "offline" (was "device")
INF/provider 14788 [*] Device "013e689795773670" is now "offline" (was "device")
INF/provider 14788 [*] Device "06157df6612b5c22" is now "offline" (was "device")
FTL/util:lifecycle 25308 [CB5A2AGTZ3] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25308 [CB5A2AGTZ3] Shutting down due to fatal error
FTL/util:lifecycle 25297 [a3a14ab9] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25294 [ZX1D22B4MV] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25294 [ZX1D22B4MV] Shutting down due to fatal error
FTL/util:lifecycle 25297 [a3a14ab9] Shutting down due to fatal error
FTL/util:lifecycle 25298 [5B17000411] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25298 [5B17000411] Shutting down due to fatal error
INF/provider 14788 [*] Device "aa9443f6" is now "offline" (was "device")
INF/provider 14788 [*] Device "d6656b6a" is now "offline" (was "device")
INF/provider 14788 [*] Device "FC047636" is now "offline" (was "device")
INF/provider 14788 [*] Device "a3a14ab9" is now "offline" (was "device")
INF/provider 14788 [*] Device "565347b5" is now "offline" (was "device")
INF/provider 14788 [*] Device "52006836bede3287" is now "offline" (was "device")
INF/provider 14788 [*] Device "0e32a002f1645052" is now "offline" (was "device")
INF/provider 14788 [*] Device "RB042046" is now "offline" (was "device")
INF/provider 14788 [*] Device "ZX1D22B4MV" is now "offline" (was "device")
INF/provider 14788 [*] Lost device "5B17000411" (device)
INF/provider 14788 [*] Shutting down device worker "5B17000411"
INF/provider 14788 [*] Lost device "0f680bfc" (offline)
INF/provider 14788 [*] Lost device "CB5A1XN5M8" (offline)
INF/provider 14788 [*] Lost device "ZX1D22B4MV" (offline)
INF/provider 14788 [*] Shutting down device worker "ZX1D22B4MV"
INF/provider 14788 [*] Cleaning up device worker "aa9443f6"
INF/provider 14788 [*] Cleaning up device worker "06157df6612b5c22"
FTL/util:lifecycle 25299 [d6656b6a] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25299 [d6656b6a] Shutting down due to fatal error
FTL/util:lifecycle 25303 [FC047636] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25306 [013e689795773670] Forward shell ended; we shall share its fate
FTL/util:lifecycle 25303 [FC047636] Shutting down due to fatal error
FTL/util:lifecycle 25306 [013e689795773670] Shutting down due to fatal error
INF/provider 14788 [*] Cleaning up device worker "5B17000411"
INF/provider 14788 [*] Cleaning up device worker "ZX1D22B4MV"
INF/provider 14788 [*] Lost device "0e32a002f1645052" (offline)
FTL/util:lifecycle 25300 [0e32a002f1645052] Forward shell ended; we shall share its fate
INF/provider 14788 [*] Shutting down device worker "0e32a002f1645052"
FTL/util:lifecycle 25300 [0e32a002f1645052] Shutting down due to fatal error
INF/provider 14788 [*] Lost device "RB042046" (offline)
INF/provider 14788 [*] Shutting down device worker "RB042046"
INF/provider 14788 [*] Lost device "FC047636" (offline)
INF/provider 14788 [*] Shutting down device worker "FC047636"
INF/provider 14788 [*] Lost device "aa9443f6" (offline)
INF/provider 14788 [*] Shutting down device worker "aa9443f6"
INF/provider 14788 [*] Lost device "d6656b6a" (offline)
INF/provider 14788 [*] Shutting down device worker "d6656b6a"
INF/provider 14788 [*] Lost device "CB5A2AGTZ3" (offline)
INF/provider 14788 [*] Shutting down device worker "CB5A2AGTZ3"
INF/provider 14788 [*] Lost device "06157df6612b5c22" (offline)
INF/provider 14788 [*] Shutting down device worker "06157df6612b5c22"
INF/provider 14788 [*] Lost device "52006836bede3287" (offline)
INF/provider 14788 [*] Shutting down device worker "52006836bede3287"
INF/provider 14788 [*] Lost device "013e689795773670" (offline)
INF/provider 14788 [*] Shutting down device worker "013e689795773670"
INF/provider 14788 [*] Lost device "a3a14ab9" (offline)
INF/provider 14788 [*] Shutting down device worker "a3a14ab9"
INF/provider 14788 [*] Lost device "565347b5" (offline)
INF/provider 14788 [*] Shutting down device worker "565347b5"
INF/provider 14788 [*] Cleaning up device worker "RB042046"
INF/provider 14788 [*] Cleaning up device worker "52006836bede3287"
INF/provider 14788 [*] Cleaning up device worker "a3a14ab9"
INF/provider 14788 [*] Cleaning up device worker "565347b5"
INF/provider 14788 [*] Cleaning up device worker "CB5A2AGTZ3"
INF/provider 14788 [*] Cleaning up device worker "d6656b6a"
INF/provider 14788 [*] Cleaning up device worker "013e689795773670"
INF/provider 14788 [*] Cleaning up device worker "FC047636"
INF/provider 14788 [*] Gracefully killing device worker "5B17000411"
INF/provider 14788 [*] Gracefully killing device worker "ZX1D22B4MV"
INF/provider 14788 [*] Cleaning up device worker "0e32a002f1645052"
INF/provider 14788 [*] Gracefully killing device worker "0e32a002f1645052"
INF/provider 14788 [*] Found device "ZX1D22B4MV" (offline)
INF/provider 14788 [*] Found device "RB042046" (offline)
INF/reaper 14787 [reaper001] Device "ZX1D22B4MV" is present
INF/provider 14788 [*] Registered device "ZX1D22B4MV"
INF/provider 14788 [*] Device "ZX1D22B4MV" is now "unauthorized" (was "offline")
INF/provider 14788 [*] Device "ZX1D22B4MV" is now "device" (was "unauthorized")
INF/reaper 14787 [reaper001] Device "RB042046" is present
INF/provider 14788 [*] Registered device "RB042046"
INF/provider 14788 [*] Device "RB042046" is now "device" (was "offline")
INF/provider 14788 [*] Found device "52006836bede3287" (offline)
INF/provider 14788 [*] Found device "0f680bfc" (offline)
INF/provider 14788 [*] Found device "06157df6612b5c22" (offline)
INF/provider 14788 [*] Found device "0e32a002f1645052" (offline)
INF/provider 14788 [*] Found device "a3a14ab9" (offline)
INF/provider 14788 [*] Found device "565347b5" (offline)
INF/provider 14788 [*] Found device "d6656b6a" (offline)
INF/provider 14788 [*] Found device "5B17000411" (offline)
INF/provider 14788 [*] Found device "04d86162a2438995" (offline)
INF/provider 14788 [*] Found device "CB5A1XN5M8" (offline)
INF/provider 14788 [*] Found device "FC047636" (offline)
INF/reaper 14787 [reaper001] Device "52006836bede3287" is present
INF/provider 14788 [*] Registered device `"52006836bede3287"


**Please run `stf doctor` and paste the output here.**

INF/util:doctor 25376 [*] OS Arch: x64
INF/util:doctor 25376 [*] OS Platform: darwin
INF/util:doctor 25376 [*] OS Platform: 16.4.0
INF/util:doctor 25376 [*] Using Node 8.2.1
INF/util:doctor 25376 [*] Using RethinkDB client 2.3.3
INF/util:doctor 25376 [*] Using ZeroMQ 4.2.2
INF/util:doctor 25376 [*] GraphicsMagick 1.3.26
INF/util:doctor 25376 [*] Local ADB 1.0.39
Installed as /usr/local/bin/adb

/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 1.0.39
Installed as /usr/local/bin/adb

    at new SemVer (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:1100:15)
    at Function.satisfies (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:1149:16)
    at unsupportedVersion (/usr/local/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /usr/local/lib/node_modules/stf/lib/util/doctor.js:143:7
    at /usr/local/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:262:7)
    at emitTwo (events.js:125:13)
    at ChildProcess.emit (events.js:213:7)
    at maybeClose (internal/child_process.js:921:16)
    at Socket.stream.socket.on (internal/child_process.js:348:11)
    at emitOne (events.js:115:13)
    at Socket.emit (events.js:210:7)
    at Pipe._handle.close [as _onclose] (net.js:549:12)
 Thanks for the reply @sorccu 
I will see if I can get a linux!  NF/util:doctor 17002 [*] OS Arch: x64
INF/util:doctor 17002 [*] OS Platform: darwin
INF/util:doctor 17002 [*] OS Platform: 15.6.0
INF/util:doctor 17002 [*] Using Node 5.9.1
INF/util:doctor 17002 [*] Using RethinkDB client 2.3.3
INF/util:doctor 17002 [*] Using ZeroMQ 4.1.4
INF/util:doctor 17002 [*] Local ADB 1.0.39
Installed as /Users/harvey/Desktop/Harvey/android-sdk-macosx/platform-tools/adb

/Users/harvey/.nvm/versions/node/v5.9.1/lib/node_modules/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 1.0.39
Installed as /Users/harvey/Desktop/Harvey/android-sdk-macosx/platform-tools/adb

    at new SemVer (/Users/harvey/.nvm/versions/node/v5.9.1/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/Users/harvey/.nvm/versions/node/v5.9.1/lib/node_modules/stf/node_modules/semver/semver.js:1100:15)
    at Function.satisfies (/Users/harvey/.nvm/versions/node/v5.9.1/lib/node_modules/stf/node_modules/semver/semver.js:1149:16)
    at unsupportedVersion (/Users/harvey/.nvm/versions/node/v5.9.1/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /Users/harvey/.nvm/versions/node/v5.9.1/lib/node_modules/stf/lib/util/doctor.js:143:7
    at /Users/harvey/.nvm/versions/node/v5.9.1/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:193:7)
    at emitTwo (events.js:100:13)
    at ChildProcess.emit (events.js:185:7)
    at maybeClose (internal/child_process.js:850:16)
    at Socket.<anonymous> (internal/child_process.js:323:11)
    at emitOne (events.js:90:13)
    at Socket.emit (events.js:182:7)
    at Pipe._onclose (net.js:477:12)  https://vbanthia.github.io/angular-swagger-ui/


<img width="500" alt="smartphone_test_farm_api" src="https://user-images.githubusercontent.com/8136032/28580291-02b5aee0-719a-11e7-8740-43cd9a8c9179.png">
 I attempt to load lib/units/api/swagger/api_v1.yml  with [swagger editor](https://github.com/swagger-api/swagger-editor), everything goes well. Which swagger parser did you use? This error has occurred in document page. 
https://github.com/openstf/stf/blob/master/doc/API.md

<img width="984" alt="stf_api_md_at_master_ _openstf_stf" src="https://user-images.githubusercontent.com/8136032/28768636-5d59af54-7613-11e7-922e-743cf9f3f219.png">  When I work on Huawei P9 lite, it gets occassionally wiped after I get disconnected from device for inactivity (I guess it's becouse of inactivity).. It gets wiped to the state when I start using the device..
Is this some kind of secure feature in development, or is this a bug?

I will attach logs after it happens again Yep, that's exactly what I mean Ok thanks, didn't know about this feature.. It works just on some devices.. On Samsung Galaxy devices this does not work
Anyway thanks for clear this out.. 👍   **What is the issue or idea you have?**
I want to have multiple providers in the same machine, filtering the devices that connect to each provider by USB port, that is, if some device gets connected to a range of ports, it will be served by provider X.

In the "Deployment" documentation one can find the following:
"_Note that you cannot have more than one provider unit running on the same host, as they would compete over which one gets to control the devices. In the future we might add a negotiation protocol to allow for relatively seamless upgrades._"

My question is, in order to prevent which provider gets control over the devices, a configuration file could be used in order to force a certain provider to access only the intended range of ports.

This would allow for different devices to show in frontend with different tags, ultimately allowing for finer control over them.

 I got confused, `Usage: provider [options] [serial...]` this serial is related to the device, and not the USB port, right?
We should have a service that gets the serial numbers of the devices connected to the ports we need and then send these serial numbers to the provider at start-up. something along those lines?  To deal with the issue 'bower ESUDO         Cannot be run with sudo', add '--allow-root' in package.json file.  Hello,
I followed this tutorial (https://gist.github.com/yasuyk/bbaa28568c497d95ff92566efc4ecc3c) and successfully installed openstf (STF version 2.0.0) on a machine running Ubuntu 14.04 64-bit. It works very well -- I can login to the system and interact with my real device.

Since I want to modify the STF a bit, I have tried to build it from source by skipping the 7th step in the tutorial and running "sudo npm install" and "sudo npm link" from STF source folder; however I face the following issues
1. If I compile the newest version of STF from source, there are some compilation errors which seem to be relevant to the NPM version (my NPM version is 1.3.10) 
2. I think the first problem is because the newest version of STF is v3.0.0 while the installed dependencies are for STF v2.0.0 so I tried to checkout the commit for STF 2.0.0 (5a2af57fc5aafeedcbc5e6e215fdd0d609e4cf84). Using this revision, I compiled the code successfully without any errors. However, when I run "stf local" and try to access the front-end at 127.0.0.1:7100, I got a blank page -- no login screen. I checked the STF output and saw several errors while building app and web_modules (as attached).
[stf_output_error.txt](https://github.com/openstf/stf/files/1159464/stf_output_error.txt)

I also tried to run "stf doctor" and following is the output. It seems that the Node version is too old.

INF/util:doctor 8173 [*] OS Arch: x64
INF/util:doctor 8173 [*] OS Platform: linux
INF/util:doctor 8173 [*] OS Platform: 4.4.0-31-generic
INF/util:doctor 8173 [*] Using Node 0.10.25
ERR/util:doctor 8173 [*] Current Node version is not supported, it has to be >= 4.2
INF/util:doctor 8173 [*] Using RethinkDB client 2.3.3
INF/util:doctor 8173 [*] Using ZeroMQ 4.1.2
INF/util:doctor 8173 [*] Local ADB 1.0.31
INF/util:doctor 8173 [*] Local RethinkDB server 2.3.6~0trusty

/home/ubuntu/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
          ^
TypeError: Invalid Version: 2.3.6~0trusty
    at new SemVer (/home/ubuntu/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/home/ubuntu/stf/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/home/ubuntu/stf/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/home/ubuntu/stf/lib/util/doctor.js:13:15)
    at /home/ubuntu/stf/lib/util/doctor.js:95:7
    at /home/ubuntu/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:635:7)
    at ChildProcess.EventEmitter.emit (events.js:98:17)
    at maybeClose (child_process.js:743:16)
    at Socket.<anonymous> (child_process.js:956:11)
    at Socket.EventEmitter.emit (events.js:95:17)
    at Pipe.close (net.js:466:12)

Have you faced similar issues and successfully resolved them? Your suggestion would be really appreciated.
Thanks,
Thuan Thanks for your prompt reply. I have tried to setup newest version of OpenSTF on another machine running Ubuntu 16.04 and faced similar issues. Following is the output of "stf doctor" and attached file is the error log when I run "stf local".

INF/cli:doctor 7328 [*] OS Arch: x64
INF/cli:doctor 7328 [*] OS Platform: linux
INF/cli:doctor 7328 [*] OS Platform: 4.8.0-36-generic
INF/cli:doctor 7328 [*] Using Node 6.11.0
INF/cli:doctor 7328 [*] Using ZeroMQ 4.1.4
INF/cli:doctor 7328 [*] Using RethinkDB 2.3.6~0xenial
INF/cli:doctor 7328 [*] Using GraphicsMagick 1.3.23
INF/cli:doctor 7328 [*] Using ProtoBuf 3.2.0
ERR/cli:doctor 7328 [*] ADB version cannot be detected
Regarding the issue with ADB version, my ADB version is 1.0.39. I don't know why stf doctor cannot detect it.
[error_log_stf2.3.0.txt](https://github.com/openstf/stf/files/1161215/error_log_stf2.3.0.txt)

 PS. If I install STF using npm (by running "sudo npm install -g stf"), I get this error while starting stf local

Cannot find module './../../../webpack.config'
FTL/cli:local 9298 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)

If I install webpack by running "sudo npm install webpack", I get the following warnings and the problem of missing webpack.config is still unresolved.

npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@^1.0.0 (node_modules/chokidar/node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.2: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})
npm WARN enoent ENOENT: no such file or directory, open '/home/ubuntu/package.json'
npm WARN ubuntu No description
npm WARN ubuntu No repository field.
npm WARN ubuntu No README data
npm WARN ubuntu No license field.
 Now, it works :) I think it did not work because bower and gulp were not there. After installing the two packages and run 2 commands "npm install" (without sudo, and without -g) and "sudo npm link" the system works well.  hi, how to turn down the frame rate of capture screen?  Hi All,

I am getting websocket exception  while running the docker image while selecting allow remote and public ip option 

but when  i run the image without these options like public-ip  , I am able to run STF successfully without any exception 

I have gone through other similar  issue on github , the solution mentioned was that the "configuration was wrong " if the configuration is wrong how is it possible to connect to the device without using public -ip option

Also in some issues it was mentioned that the websocket should also connect to 7100 port , but in the cases  where STF was working successfully(without public -ip options). websocket was connected to 7110 port only.

I am trying to figure out in the repository , where exactly this connection is being established  . Please help me out with this issue 

Thanks and Regards, Please find the steps along with the Logs 

executed command :1
bharatjoshi$ docker run -d --privileged --net host -v /dev/bus/usb:/dev/bus/usb --name abdb sorccu/adb

Logs
337488050e200c435235c91aa2b5cf47a3e99f25bbc25e0e9ae103d628d48377

executed command :2 
docker run --net host --name some-rethink -v "/c/STF/RethinkDB:/data" rethinkdb

Logs: 
Recursively removing directory /data/rethinkdb_data/tmp
Initializing directory /data/rethinkdb_data
Running rethinkdb 2.3.5~0jessie (GCC 4.9.2)...
Running on Linux 4.4.66-boot2docker x86_64
Loading data from directory /data/rethinkdb_data
Listening for intracluster connections on port 29015
Listening for client driver connections on port 28015
Listening for administrative HTTP connections on port 8080
Listening on cluster addresses: 127.0.0.1, 172.17.0.1, 10.0.2.15, 192.168.99.100, ::1, fe80::a00:27ff:fe35:af5d%4, fe80::a00:27ff:feba:fff5%3
Listening on driver addresses: 127.0.0.1, 172.17.0.1, 10.0.2.15, 192.168.99.100, ::1, fe80::a00:27ff:fe35:af5d%4, fe80::a00:27ff:feba:fff5%3
Listening on http addresses: 127.0.0.1, 172.17.0.1, 10.0.2.15, 192.168.99.100, ::1, fe80::a00:27ff:fe35:af5d%4, fe80::a00:27ff:feba:fff5%3
Server ready, "default_l8r" d75a238c-d201-4729-a71b-863223204d0f

executed Command: 3
docker run --net host openstf/stf:latest stf local --allow-remote --public-ip 10.83.12.78

Logs: INF/util:procutil 1 [*] Forking "/app/lib/cli migrate"
INF/db 10 [*] Connecting to 127.0.0.1:28015
INF/db:setup 10 [*] Database "stf" created
INF/db:setup 10 [*] Table "users" created
INF/db:setup 10 [*] Table "accessTokens" created
INF/db:setup 10 [*] Table "vncauth" created
INF/db:setup 10 [*] Table "devices" created
INF/db:setup 10 [*] Table "logs" created
INF/db:setup 10 [*] Index "users"."adbKeys" created
INF/db:setup 10 [*] Index "accessTokens"."email" created
INF/db:setup 10 [*] Index "vncauth"."response" created
INF/db:setup 10 [*] Index "vncauth"."responsePerDevice" created
INF/db:setup 10 [*] Index "devices"."owner" created
INF/db:setup 10 [*] Index "devices"."present" created
INF/db:setup 10 [*] Waiting for index "users"."adbKeys"
INF/db:setup 10 [*] Waiting for index "accessTokens"."email"
INF/db:setup 10 [*] Waiting for index "vncauth"."response"
INF/db:setup 10 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 10 [*] Waiting for index "devices"."owner"
INF/db:setup 10 [*] Waiting for index "devices"."present"
INF/db:setup 10 [*] Index "devices"."providerChannel" created
INF/db:setup 10 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 10 [*] Index "users"."adbKeys" is ready
INF/db:setup 10 [*] Index "accessTokens"."email" is ready
INF/db:setup 10 [*] Index "vncauth"."response" is ready
INF/db:setup 10 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 10 [*] Index "devices"."owner" is ready
INF/db:setup 10 [*] Index "devices"."present" is ready
INF/db:setup 10 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 1 [*] Forking "/app/lib/cli triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 1 [*] Forking "/app/lib/cli triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 1 [*] Forking "/app/lib/cli processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 1 [*] Forking "/app/lib/cli processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 1 [*] Forking "/app/lib/cli reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 1 [*] Forking "/app/lib/cli provider --name default --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip 10.83.12.78 --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800 --allow-remote"
INF/util:procutil 1 [*] Forking "/app/lib/cli auth-mock --port 7120 --secret kute kittykat --app-url http://10.83.12.78:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli app --port 7105 --secret kute kittykat --auth-url http://10.83.12.78:7100/auth/mock/ --websocket-url http://10.83.12.78:7110/"
INF/util:procutil 1 [*] Forking "/app/lib/cli api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 1 [*] Forking "/app/lib/cli websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-temp --port 7102"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
INF/triproxy 17 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 16 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 17 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 17 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/triproxy 16 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 16 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/db 23 [*] Connecting to 127.0.0.1:28015
INF/db 29 [*] Connecting to 127.0.0.1:28015
INF/processor 29 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 29 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/processor 23 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 23 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/reaper 35 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 35 [reaper001] Reaping devices with no heartbeat
INF/db 35 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 35 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 35 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/poorxy 79 [*] Listening on port 7100
INF/provider 36 [*] Subscribing to permanent channel "//wsYk8jSVO5Np5Ia/TKew=="
INF/provider 36 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 36 [*] Receiving input from "tcp://127.0.0.1:7114"
INF/provider 36 [*] Tracking devices
INF/auth-mock 42 [*] Listening on port 7120
INF/storage:temp 66 [*] Listening on port 7102
INF/storage:plugins:image 72 [*] Listening on port 7103
INF/websocket 60 [*] Subscribing to permanent channel "*ALL"
INF/websocket 60 [*] Listening on port 7110
INF/db 60 [*] Connecting to 127.0.0.1:28015
INF/websocket 60 [*] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 60 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/storage:plugins:apk 78 [*] Listening on port 7104
INF/app 53 [*] Using pre-built resources
INF/app 53 [*] Listening on port 7105
INF/db 53 [*] Connecting to 127.0.0.1:28015
INF/api 54 [*] Subscribing to permanent channel "*ALL"
INF/api 54 [*] Listening on port 7106
INF/api 54 [*] Sending output to "tcp://127.0.0.1:7113"
INF/api 54 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/db 54 [*] Connecting to 127.0.0.1:28015
INF/provider 36 [*] Found device "2bd2eca7" (offline)
INF/provider 36 [*] Registered device "2bd2eca7"
INF/reaper 35 [reaper001] Device "2bd2eca7" is present
INF/provider 36 [*] Device "2bd2eca7" is now "device" (was "offline")
INF/device:support:push 120 [2bd2eca7] Sending output to "tcp://127.0.0.1:7116"
INF/device 120 [2bd2eca7] Preparing device
INF/device:support:sub 120 [2bd2eca7] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 120 [2bd2eca7] Subscribing to permanent channel "*ALL"
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/provider 36 [*] Providing 0 of 1 device(s); waiting for "2bd2eca7"
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:adb 120 [2bd2eca7] Waiting for boot to complete
INF/device:support:properties 120 [2bd2eca7] Loading properties
INF/device:support:sdk 120 [2bd2eca7] Supports SDK 22
INF/device:support:abi 120 [2bd2eca7] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:minicap 120 [2bd2eca7] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 120 [2bd2eca7] Installing "/app/node_modules/minicap-prebuilt/prebuilt/armeabi-v7a/lib/android-22/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 120 [2bd2eca7] Checking whether we need to install STFService
INF/device:resources:service 120 [2bd2eca7] Running version check
INF/device:resources:service 120 [2bd2eca7] STFService up to date
INF/device:plugins:service 120 [2bd2eca7] Launching agent
INF/provider 36 [*] Providing 0 of 1 device(s); waiting for "2bd2eca7"
INF/device:plugins:service 120 [2bd2eca7] Launching service
INF/device:plugins:service 120 [2bd2eca7] Agent says: "Listening on @stfagent"
INF/device:plugins:service 120 [2bd2eca7] Agent says: "InputClient started"
INF/device:plugins:display 120 [2bd2eca7] Reading display info
INF/device:plugins:phone 120 [2bd2eca7] Fetching phone info
INF/device:plugins:identity 120 [2bd2eca7] Solving identity
INF/device:plugins:solo 120 [2bd2eca7] Subscribing to permanent channel "jMSB9mdwadB/o0mgJ1E4fgzDn6E="
INF/device:plugins:screen:stream 120 [2bd2eca7] Starting WebSocket server on port 7400
INF/device:resources:minitouch 120 [2bd2eca7] Installing "/app/node_modules/minitouch-prebuilt/prebuilt/armeabi-v7a/bin/minitouch" as "/data/local/tmp/minitouch"
WRN/device:plugins:data 120 [2bd2eca7] Unable to find device data { serial: '2bd2eca7',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: ',',
  model: 'SM-E700H',
  version: '5.1.1',
  abi: 'armeabi-v7a',
  sdk: '22',
  product: 'e73gxx',
  display: 
   { id: 0,
     width: 720,
     height: 1280,
     xdpi: 268.9410095214844,
     ydpi: 266.4909973144531,
     fps: 60,
     density: 2,
     rotation: 0,
     secure: true,
     size: 5.498873422694838,
     url: 'ws://10.83.12.78:7400' },
  phone: { imei: '358185060538227', network: 'UNKNOWN' } }
INF/device:plugins:touch 120 [2bd2eca7] Touch origin is top left
INF/device:plugins:touch 120 [2bd2eca7] Requesting touch consumer to start
INF/device:plugins:touch 120 [2bd2eca7] Launching screen service
INF/device:plugins:touch 120 [2bd2eca7] Connecting to minitouch service
INF/device:plugins:touch 120 [2bd2eca7] minitouch says: "WARNING: linker: /data/local/tmp/minitouch: unused DT entry: type 0x6ffffffe arg 0x8c8"
INF/device:plugins:touch 120 [2bd2eca7] minitouch says: "WARNING: linker: /data/local/tmp/minitouch: unused DT entry: type 0x6fffffff arg 0x1"
INF/device:plugins:touch 120 [2bd2eca7] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 120 [2bd2eca7] minitouch says: "Type B touch device sec_touchscreen (720x1280 with 10 contacts) detected on /dev/input/event2 (score 2109)"
INF/device:plugins:touch 120 [2bd2eca7] Reading minitouch banner
INF/device:plugins:touch 120 [2bd2eca7] minitouch says: "Connection established"
INF/device:plugins:vnc 120 [2bd2eca7] Starting VNC server on port 7402
INF/device:plugins:browser 120 [2bd2eca7] Loading browser list
INF/device:plugins:browser 120 [2bd2eca7] Updating browser list
INF/device:plugins:mute 120 [2bd2eca7] Will not mute master volume during use
INF/device:resources:minirev 120 [2bd2eca7] Installing "/app/vendor/minirev/armeabi-v7a/minirev" as "/data/local/tmp/minirev"
INF/device:plugins:forward 120 [2bd2eca7] Launching reverse port forwarding service
INF/device:plugins:forward 120 [2bd2eca7] Connecting to reverse port forwarding service
INF/device:plugins:connect 120 [2bd2eca7] Listening on port 7401
INF/device 120 [2bd2eca7] Fully operational
INF/provider 36 [*] Providing all 1 device(s)


Note: The device is detected by STF , but I am get the web socket exception as mentioned below

1.6b7e5cc….chunk.js:51665 WebSocket connection to 'ws://10.83.12.78:7110/socket.io/?uip=%3A%3Affff%3A127.0.0.1&EIO=3&transport=websocket' failed: Error in connection establishment: net::ERR_CONNECTION_REFUSED

Please help me to resolve the issue Hi ,

I have added the logs and the commands

On 17-Jul-2017 19:35, "Simo Kinnunen" <notifications@github.com<mailto:notifications@github.com>> wrote:

While I agree that "your configuration is wrong" is vague, we simply don't have time to help with general configuration issues unless you provide all the necessary details by yourself. It takes a lot of time if we have to ask for those one by one.

For example, when you created this issue, you decided to remove the issue template. So now I would have to spend a few minutes asking you to provide those details instead of being able to help you directly. In this case, it would have been particularly useful if you had provided the exact commands you used, and the full output of those commands. Otherwise you're sort of expecting me or someone else to simply keep trying various random combinations, which is a huge waste of time.

Please try to proactively provide as much detail as possible. It increases the chances of someone willing to look into your issue.

—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/649#issuecomment-315765018>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AHeUJa3k60LX7ehNAN1_jr6o3_QXEU9iks5sO2mzgaJpZM4OZ_YL>.
 I have got the workaround to the websocket issue 

Solution: We need to add the port which is appearing in the websocket exception to the  Port forwarding rules of the vm used 

It will  start working . Closing this issue now 

  1. Although it's a bit repetitive, I think the independent serial parameter tells the reader that entry contains serial.
2. Just remove useless parameter "url“.  When I connected mobile devices into STF from Windows system, some emulator devices were joined unintentionally, so I added a new option "-exclude regex" in provider to exclude devices whose serials match the specified regex pattern like "^emulator.*".

Another benefit for the feature is that we can prevent multiple local devices from joining STF provider. Thanks. I would be very happy to join the Slack and become a `formal` contributor. Email sent. Thanks.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

I am running this 2 commands inside Docker terminal to Setup STP 

docker run --name some-rethink -v "C:/STF/RethinkDB/data" -p 28015:28015 rethinkdb
docker run --link some-rethink:rethinkdb -p 7100:7100 openstf/stf:latest stf local


first Command run successfully and generates logs as below 
$ docker run --name some-rethink -v "C:/STF/RethinkDB/data" -p 28015:28015 reth
inkdb
Unable to find image 'rethinkdb:latest' locally
latest: Pulling from library/rethinkdb
9f0706ba7422: Pull complete
13cff7bd7d5f: Pull complete
2f7f87e28358: Pull complete
4f5c608387ab: Pull complete
0168e87b5569: Pull complete
Digest: sha256:e752a5624ab4c0724d1c2c5201e09c8d88de290bafd85f026ddb53cc21a31717
Status: Downloaded newer image for rethinkdb:latest
Recursively removing directory /data/rethinkdb_data/tmp
Initializing directory /data/rethinkdb_data
Running rethinkdb 2.3.5~0jessie (GCC 4.9.2)...
Running on Linux 4.4.59-boot2docker x86_64
Loading data from directory /data/rethinkdb_data
warn: Cache size does not leave much memory for server and query overhead (avail
able memory: 785 MB).
warn: Cache size is very low and may impact performance.
Listening for intracluster connections on port 29015
Listening for client driver connections on port 28015
Listening for administrative HTTP connections on port 8080
Listening on cluster addresses: 127.0.0.1, 172.17.0.2
Listening on driver addresses: 127.0.0.1, 172.17.0.2
Listening on http addresses: 127.0.0.1, 172.17.0.2
Server ready, "0772e140b102_j2j" 9174cf42-c618-40eb-8dac-fc76c80fe826
warn: Some RethinkDB data on this server has been placed into swap memory. This
may impact performance.

2nd Command generates following logs 
Unable to find image 'openstf/stf:latest' locally
latest: Pulling from openstf/stf
75c416ea735c: Pull complete
c6ff40b6d658: Pull complete
a7050fc1f338: Pull complete
f0ffb5cf6ba9: Pull complete
be232718519c: Pull complete
a8a00db89a00: Pull complete
eefd4bde42f3: Pull complete
cd3668a0e1bf: Pull complete
223d989df2e2: Pull complete
fa36956c56f3: Pull complete
Digest: sha256:8f2588bf654323198d2344774d247044044611b102490fd71d18c1324f5c697d
Status: Downloaded newer image for openstf/stf:latest
INF/util:procutil 1 [*] Forking "/app/lib/cli migrate"
INF/db 10 [*] Connecting to 172.17.0.2:28015
INF/db:setup 10 [*] Database "stf" created
INF/db:setup 10 [*] Table "users" created
INF/db:setup 10 [*] Index "users"."adbKeys" created
INF/db:setup 10 [*] Waiting for index "users"."adbKeys"
INF/db:setup 10 [*] Index "users"."adbKeys" is ready
INF/db:setup 10 [*] Table "vncauth" created
INF/db:setup 10 [*] Index "vncauth"."response" created
INF/db:setup 10 [*] Waiting for index "vncauth"."response"
INF/db:setup 10 [*] Table "accessTokens" created
INF/db:setup 10 [*] Table "logs" created
INF/db:setup 10 [*] Table "devices" created
INF/db:setup 10 [*] Index "vncauth"."responsePerDevice" created
INF/db:setup 10 [*] Index "accessTokens"."email" created
INF/db:setup 10 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 10 [*] Waiting for index "accessTokens"."email"
INF/db:setup 10 [*] Index "devices"."owner" created
INF/db:setup 10 [*] Waiting for index "devices"."owner"
INF/db:setup 10 [*] Index "devices"."present" created
INF/db:setup 10 [*] Waiting for index "devices"."present"
INF/db:setup 10 [*] Index "devices"."providerChannel" created
INF/db:setup 10 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 10 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 10 [*] Index "accessTokens"."email" is ready
INF/db:setup 10 [*] Index "devices"."owner" is ready
INF/db:setup 10 [*] Index "vncauth"."response" is ready
INF/db:setup 10 [*] Index "devices"."present" is ready
INF/db:setup 10 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 1 [*] Forking "/app/lib/cli triproxy app001 --bind-pub tcp://1
27.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:711
3"
INF/util:procutil 1 [*] Forking "/app/lib/cli triproxy dev001 --bind-pub tcp://1
27.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:711
6"
INF/util:procutil 1 [*] Forking "/app/lib/cli processor proc001 --connect-app-de
aler tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 1 [*] Forking "/app/lib/cli processor proc002 --connect-app-de
aler tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 1 [*] Forking "/app/lib/cli reaper reaper001 --connect-push tc
p://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 1 [*] Forking "/app/lib/cli provider --name 280c78dcf572 --min
-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp
://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http:/
/localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800
"
INF/util:procutil 1 [*] Forking "/app/lib/cli auth-mock --port 7120 --secret kut
e kittykat --app-url http://localhost:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli app --port 7105 --secret kute kitt
ykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhos
t:7110/"
INF/util:procutil 1 [*] Forking "/app/lib/cli api --port 7106 --secret kute kitt
ykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 1 [*] Forking "/app/lib/cli websocket --port 7110 --secret kut
e kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:71
11 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-temp --port 7102"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-plugin-image --port 7103 -
-storage-url http://localhost:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-plugin-apk --port 7104 --s
torage-url http://localhost:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli poorxy --port 7100 --app-url http:
//localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7
106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/
 --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http
://localhost:7104/"
INF/triproxy 16 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 16 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 17 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 16 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/triproxy 17 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 17 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/poorxy 89 [*] Listening on port 7100
INF/reaper 40 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 40 [reaper001] Reaping devices with no heartbeat
INF/db 29 [*] Connecting to 172.17.0.2:28015
INF/db 23 [*] Connecting to 172.17.0.2:28015
INF/db 40 [reaper001] Connecting to 172.17.0.2:28015
INF/reaper 40 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 40 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/processor 29 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 29 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/processor 23 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 23 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/storage:plugins:image 77 [*] Listening on port 7103
INF/auth-mock 47 [*] Listening on port 7120
INF/storage:plugins:apk 83 [*] Listening on port 7104
INF/storage:temp 76 [*] Listening on port 7102
INF/provider 41 [*] Subscribing to permanent channel "VJyocYsmRCKaB7cY+XWrGQ=="
INF/provider 41 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 41 [*] Receiving input from "tcp://127.0.0.1:7114"
Unhandled rejection Error: spawn adb ENOENT
    at exports._errnoException (util.js:1018:11)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:193:32)
    at onErrorNT (internal/child_process.js:367:16)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
INF/app 58 [*] Using pre-built resources
INF/app 58 [*] Listening on port 7105
INF/db 58 [*] Connecting to 172.17.0.2:28015
INF/websocket 65 [*] Subscribing to permanent channel "*ALL"
INF/websocket 65 [*] Listening on port 7110
INF/db 65 [*] Connecting to 172.17.0.2:28015
INF/websocket 65 [*] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 65 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/api 59 [*] Subscribing to permanent channel "*ALL"
INF/api 59 [*] Listening on port 7106
INF/api 59 [*] Sending output to "tcp://127.0.0.1:7113"
INF/api 59 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/db 59 [*] Connecting to 172.17.0.2:28015


**Please run `stf doctor` and paste the output here.**
when I run stf doctor , I get following exception 

Error: Cannot find module 'C:\UserlibPath\AppData\Roaming\npm\node_modules\st
f\bin\stf'
    at Function.Module._resolveFilename (module.js:469:15)
    at Function.Module._load (module.js:417:25)
    at Module.runMain (module.js:604:10)
    at run (bootstrap_node.js:394:7)
    at startup (bootstrap_node.js:149:9)
    at bootstrap_node.js:509:3


Please help me to resolve this issue  Hi  ,

I have tried to run adb container seperately by  using this command
docker run -d --privileged -v /dev/bus/usb:/dev/bus/usb --name abdb sorccu/adb

still I an getting the same exception


$ docker run --link some-rethink:rethinkdb -p 7100:7100 openstf/stf:latest stf
local
Unable to find image 'openstf/stf:latest' locally
latest: Pulling from openstf/stf
75c416ea735c: Pull complete
c6ff40b6d658: Pull complete
a7050fc1f338: Pull complete
f0ffb5cf6ba9: Pull complete
be232718519c: Pull complete
a8a00db89a00: Pull complete
eefd4bde42f3: Pull complete
cd3668a0e1bf: Pull complete
223d989df2e2: Pull complete
fa36956c56f3: Pull complete
Digest: sha256:8f2588bf654323198d2344774d247044044611b102490fd71d18c1324f5c697d
Status: Downloaded newer image for openstf/stf:latest
INF/util:procutil 1 [*] Forking "/app/lib/cli migrate"
INF/db 10 [*] Connecting to 172.17.0.3:28015<http://172.17.0.3:28015>
INF/db:setup 10 [*] Database "stf" already exists
INF/db:setup 10 [*] Table "users" already exists
INF/db:setup 10 [*] Table "accessTokens" already exists
INF/db:setup 10 [*] Table "vncauth" already exists
INF/db:setup 10 [*] Table "devices" already exists
INF/db:setup 10 [*] Table "logs" already exists
INF/db:setup 10 [*] Index "users"."adbKeys" already exists
INF/db:setup 10 [*] Index "accessTokens"."email" already exists
INF/db:setup 10 [*] Index "vncauth"."response" already exists
INF/db:setup 10 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 10 [*] Waiting for index "users"."adbKeys"
INF/db:setup 10 [*] Waiting for index "accessTokens"."email"
INF/db:setup 10 [*] Waiting for index "vncauth"."response"
INF/db:setup 10 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 10 [*] Index "devices"."owner" already exists
INF/db:setup 10 [*] Index "devices"."present" already exists
INF/db:setup 10 [*] Index "devices"."providerChannel" already exists
INF/db:setup 10 [*] Index "users"."adbKeys" is ready
INF/db:setup 10 [*] Index "accessTokens"."email" is ready
INF/db:setup 10 [*] Waiting for index "devices"."owner"
INF/db:setup 10 [*] Waiting for index "devices"."present"
INF/db:setup 10 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 10 [*] Index "vncauth"."response" is ready
INF/db:setup 10 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 10 [*] Index "devices"."owner" is ready
INF/db:setup 10 [*] Index "devices"."present" is ready
INF/db:setup 10 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 1 [*] Forking "/app/lib/cli triproxy app001 --bind-pub tcp://1
27.0.0.1:7111<http://27.0.0.1:7111> --bind-dealer tcp://127.0.0.1:7112<http://127.0.0.1:7112> --bind-pull tcp://127.0.0.1:711<http://127.0.0.1:711>
3"
INF/util:procutil 1 [*] Forking "/app/lib/cli triproxy dev001 --bind-pub tcp://1
27.0.0.1:7114<http://27.0.0.1:7114> --bind-dealer tcp://127.0.0.1:7115<http://127.0.0.1:7115> --bind-pull tcp://127.0.0.1:711<http://127.0.0.1:711>
6"
INF/util:procutil 1 [*] Forking "/app/lib/cli processor proc001 --connect-app-de
aler tcp://127.0.0.1:7112<http://127.0.0.1:7112> --connect-dev-dealer tcp://127.0.0.1:7115<http://127.0.0.1:7115>"
INF/util:procutil 1 [*] Forking "/app/lib/cli processor proc002 --connect-app-de
aler tcp://127.0.0.1:7112<http://127.0.0.1:7112> --connect-dev-dealer tcp://127.0.0.1:7115<http://127.0.0.1:7115>"
INF/util:procutil 1 [*] Forking "/app/lib/cli reaper reaper001 --connect-push tc
p://127.0.0.1:7116<http://127.0.0.1:7116> --connect-sub tcp://127.0.0.1:7111<http://127.0.0.1:7111>"
INF/util:procutil 1 [*] Forking "/app/lib/cli provider --name 2f30d2f4a13b --min
-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114<http://127.0.0.1:7114> --connect-push tcp
://127.0.0.1:7116<http://127.0.0.1:7116> --group-timeout 900 --public-ip localhost --storage-url http:/
/localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800
"
INF/util:procutil 1 [*] Forking "/app/lib/cli auth-mock --port 7120 --secret kut
e kittykat --app-url http://localhost:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli app --port 7105 --secret kute kitt
ykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhos
t:7110/"
INF/util:procutil 1 [*] Forking "/app/lib/cli api --port 7106 --secret kute kitt
ykat --connect-push tcp://127.0.0.1:7113<http://127.0.0.1:7113> --connect-sub tcp://127.0.0.1:7111<http://127.0.0.1:7111>"
INF/util:procutil 1 [*] Forking "/app/lib/cli websocket --port 7110 --secret kut
e kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:71<http://127.0.0.1:71>
11 --connect-push tcp://127.0.0.1:7113<http://127.0.0.1:7113>"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-temp --port 7102"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-plugin-image --port 7103 -
-storage-url http://localhost:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli storage-plugin-apk --port 7104 --s
torage-url http://localhost:7100/"
INF/util:procutil 1 [*] Forking "/app/lib/cli poorxy --port 7100 --app-url http:
//localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7
106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/
 --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http
://localhost:7104/"
INF/triproxy 16 [app001] PUB socket bound on tcp://127.0.0.1:7111<http://127.0.0.1:7111>
INF/triproxy 16 [app001] DEALER socket bound on tcp://127.0.0.1:7112<http://127.0.0.1:7112>
INF/triproxy 22 [dev001] PUB socket bound on tcp://127.0.0.1:7114<http://127.0.0.1:7114>
INF/triproxy 16 [app001] PULL socket bound on tcp://127.0.0.1:7113<http://127.0.0.1:7113>
INF/triproxy 22 [dev001] DEALER socket bound on tcp://127.0.0.1:7115<http://127.0.0.1:7115>
INF/triproxy 22 [dev001] PULL socket bound on tcp://127.0.0.1:7116<http://127.0.0.1:7116>
INF/poorxy 84 [*] Listening on port 7100
INF/reaper 35 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 35 [reaper001] Reaping devices with no heartbeat
INF/db 23 [*] Connecting to 172.17.0.3:28015<http://172.17.0.3:28015>
INF/db 35 [reaper001] Connecting to 172.17.0.3:28015<http://172.17.0.3:28015>
INF/db 29 [*] Connecting to 172.17.0.3:28015<http://172.17.0.3:28015>
INF/reaper 35 [reaper001] Receiving input from "tcp://127.0.0.1:7111<http://127.0.0.1:7111>"
INF/reaper 35 [reaper001] Sending output to "tcp://127.0.0.1:7116<http://127.0.0.1:7116>"
INF/processor 23 [proc001] App dealer connected to "tcp://127.0.0.1:7112<http://127.0.0.1:7112>"
INF/processor 23 [proc001] Device dealer connected to "tcp://127.0.0.1:7115<http://127.0.0.1:7115>"
INF/processor 29 [proc002] App dealer connected to "tcp://127.0.0.1:7112<http://127.0.0.1:7112>"
INF/processor 29 [proc002] Device dealer connected to "tcp://127.0.0.1:7115<http://127.0.0.1:7115>"
INF/storage:plugins:image 77 [*] Listening on port 7103
INF/auth-mock 47 [*] Listening on port 7120
INF/storage:plugins:apk 83 [*] Listening on port 7104
INF/storage:temp 71 [*] Listening on port 7102
INF/provider 36 [*] Subscribing to permanent channel "EjJpPvuITGamvu7Atz+y/w=="
INF/provider 36 [*] Sending output to "tcp://127.0.0.1:7116<http://127.0.0.1:7116>"
INF/provider 36 [*] Receiving input from "tcp://127.0.0.1:7114<http://127.0.0.1:7114>"
Unhandled rejection Error: spawn adb ENOENT
    at exports._errnoException (util.js:1018:11)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:193:32)
    at onErrorNT (internal/child_process.js:367:16)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
    at process._tickCallback (internal/process/next_tick.js:104:9)
INF/app 53 [*] Using pre-built resources
INF/app 53 [*] Listening on port 7105
INF/db 53 [*] Connecting to 172.17.0.3:28015<http://172.17.0.3:28015>
INF/websocket 70 [*] Subscribing to permanent channel "*ALL"
INF/websocket 70 [*] Listening on port 7110
INF/db 70 [*] Connecting to 172.17.0.3:28015<http://172.17.0.3:28015>
INF/websocket 70 [*] Sending output to "tcp://127.0.0.1:7113<http://127.0.0.1:7113>"
INF/websocket 70 [*] Receiving input from "tcp://127.0.0.1:7111<http://127.0.0.1:7111>"
INF/api 59 [*] Subscribing to permanent channel "*ALL"
INF/api 59 [*] Listening on port 7106
INF/api 59 [*] Sending output to "tcp://127.0.0.1:7113<http://127.0.0.1:7113>"
INF/api 59 [*] Receiving input from "tcp://127.0.0.1:7111<http://127.0.0.1:7111>"
INF/db 59 [*] Connecting to 172.17.0.3:28015<http://172.17.0.3:28015>


On Mon, Jul 10, 2017 at 11:41 AM, Simo Kinnunen <notifications@github.com<mailto:notifications@github.com>> wrote:

Closed #644<https://github.com/openstf/stf/issues/644>.

—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/644#event-1156187353>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AHeUJT9CCCW4zW4tRZwLwy24867-1RRfks5sMcCfgaJpZM4OSXIT>.



I am still getting the error even after running the adb docker image seperately  hi,
I am trying to deploy stf but all containers are UP except the containers which are trying to connect to 127.0.0.1:28015 are exited. All those are showing this error(please see the attached image)

 ```
INF/db 1 [*] Connecting to 127.0.0.1:28015
INF/db 1 [*] Unable to connect to 127.0.0.1:28015
FTL/db 1 [*] No hosts left to try
FTL/util:lifecycle 1 [*] Shutting down due to fatal error
```
result of ``` sudo docker ps -a ```

![docker_ps1](https://user-images.githubusercontent.com/20282504/28657382-81338974-72c4-11e7-9873-84636fa21026.png)
the shell script that I am using to automate the deployment is [https://github.com/thinkhy/deploy-stf-docker/blob/master/deploy_stf.sh](url) 

The browser screenshot witch error in console is 
![chrome_console2](https://user-images.githubusercontent.com/20282504/28657447-d90dafbc-72c4-11e7-880f-6d420aa55376.png)
![firefox_console2](https://user-images.githubusercontent.com/20282504/28657458-e26e0534-72c4-11e7-9b21-ce526be3bff0.png)

any help will be much appreciated. I am close to deployment. Not able to figure out how to resolve this issue.

Thanks in advance.
 @rahul0698 I also have the same problem. Do you have a solution to this problem? Thank you  When i try to use API for authentication using NODE.js, i get this.

    accessTokenAuth: Swagger.ApiKeyAuthorization('Authorization', 'Bearer ' + AUTH_TOKEN, 'header')
                             ^

TypeError: Swagger.ApiKeyAuthorization is not a function
    at Object.<anonymous> (/home/kartik/STestFarm/stf/test.js:11:30)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.runMain (module.js:604:10)
    at run (bootstrap_node.js:389:7)
    at startup (bootstrap_node.js:149:9)
    at bootstrap_node.js:504:3
 Got it. Thanks  Tried rethinkdb in local and docker env. No messages are coming in logs table

Steps: Start stf ( by following https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md) and stf-log-rethinkdb.service 
Also tried stf local and stf log-rethinkdb --connect-sub tcp://127.0.0.1:7150

Expected: logs should come to rethinkdb

no error or warning in stf local output

stf doctor output:
```log
INF/cli:doctor 62523 [*] OS Arch: x64
INF/cli:doctor 62523 [*] OS Platform: darwin
INF/cli:doctor 62523 [*] OS Platform: 16.6.0
INF/cli:doctor 62523 [*] Using Node 7.10.0
INF/cli:doctor 62523 [*] Using ZeroMQ 4.2.2
INF/cli:doctor 62523 [*] Using GraphicsMagick 1.3.25
INF/cli:doctor 62523 [*] Using ADB 1.0.39
INF/cli:doctor 62523 [*] Using ProtoBuf 3.3.0
INF/cli:doctor 62523 [*] Using RethinkDB 2.3.5
```
 Unit output is there but log level seems to have problem. (refer last line in blow logs). in older code, log level is defined / honored correctly  (e.g. INF/log-db 1 [*] Listening for **USAGE (or higher)** level log messages)
Current log: 
``` log
Jul 05 09:50:23 localhost systemd[1]: Started STF RethinkDB log recorder.
Jul 05 09:50:24 localhost docker[2427]: INF/log-db 1 [*] Subscribing to permanent channel "*ALL"
Jul 05 09:50:24 localhost docker[2427]: INF/log-db 1 [*] Listening for undefined (or higher) level log messages
```
 Working with port 7111 (on local) and priority from 1 to 7. Port 7150 didn't work on local setup.  For people that come across this via google or something in the future, see this issue for information on connecting virtual devices to STF: https://github.com/openstf/stf/issues/453#issuecomment-256832772  I modify some code, and then build docker image myself.
when I run sudo docker build -t stf . , some problems happen.
![2017-07-03 11 23 33](https://user-images.githubusercontent.com/27947461/27777052-14baa060-5fe2-11e7-9437-eec1ad29d5f3.png)

  Support Android 7.0 +? I was run it by Docker, the images from Docker.io is latest? yes.i think so.
![image](https://user-images.githubusercontent.com/4550421/27771361-b8469a4e-5f7f-11e7-8cb8-e0a0d56a523e.png)
![image](https://user-images.githubusercontent.com/4550421/27771392-2da65270-5f80-11e7-90dc-7057eed566fe.png)

But now,my run the STF just like that,how can i connect the  Android 7.0 device without Root use the USB? ![image](https://user-images.githubusercontent.com/4550421/27771899-a3067e6e-5f8a-11e7-9a1d-b214b9c133e7.png)
ok，i make a mistakes。Now I can run it。Thanks a lot.
the last question：Will support  Apple devices  later?
 ok~  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 But why I don't see the minicap and minitouch floder In vendor at master branch?It doesn't matter? Ok，Thanks for your answer!  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 thanks ，this problem is slove . npm use " --unsafe-perm" can slove  Thanks a lot.That saved my night.  when useing webstorm debug stf, have an error, can't start.

webstorm debug config:
![image](https://user-images.githubusercontent.com/14192308/27624139-0352d0dc-5c12-11e7-8bb4-8c1ff05dcc48.png)

error：
![image](https://user-images.githubusercontent.com/14192308/27624183-29bdec7a-5c12-11e7-9c92-28ce518f959e.png)
`Unable to open devtools socket: address already in use
Unable to open devtools socket: Unknown system error 0`

![image](https://user-images.githubusercontent.com/14192308/27624204-44b7c92e-5c12-11e7-8759-1b3198905457.png)

other mode no problem. no matter perform `stf local` or webstorm the run mode .
  Hi,
The question can be a bit confusing, sorry for that. But the problem is when i run openstf on any browser then it is still using the hardware(microphone,camera,etc) of the physical device connected with server not of my device on which i am running openstf. Now please tell me how to access the hardware of the device on which i am running openstf?

 So there are not any plugin's for that? Is there any way by which i can make it on my own?
 So sweet of you, thanks  As subject, devices at "automation" status can't be listed in static order. 

Seems it's due to the status of "automation"  missed in compare function in `res/app/device-list/column/device-column-service.js` .

```javascript
      compare: (function() {
         var order = {
           using: 10
          , available: 20
          , busy: 30
          , ready: 40
          , preparing: 50
          , unauthorized: 60
          , offline: 70
          , present: 80
          , absent: 90
        }
```  I am able to connect Kindle(FireOS) in STF but when i select the device the device display is broken in STF. 
With Android devices its working fine.
Is there anything i am missing ? Please help me with the solution?
  Hi,

I'm trying to install an apk to my device connected to STF.
However, when I have STF running and do "adb install -r <filename>",
I get disconnected from STF when I get "* daemon started successfully *"

My guess is that by trying to install a file to device, I'm killing the adb server connection, which is also killing my STF connection.
Is there anyway to solve this?  Hi,

When I'm trying to run **stf local**, the error is  "Identifier 'options' has already been declared" and "Child process had an error ExitError : Exit code "1" at ChildProcess.<anonymous>" with procutil.js.

When I'm trying **stf doctor** I've got an invalid version from semver of "Invalid Version : 2.3.5~0 jessie"

Does someone have the same error ? How can I fix it ? Should I remove everything and start all over again ?

 the master branch of stf ?  I tried using docker to start STF

docker run -d --name stf --net host openstf/stf stf local --public-ip 192.168.255.130
![bxt rc58ah2xh5 swo a](https://user-images.githubusercontent.com/25145380/27326823-29fc9c4c-55df-11e7-81a6-db4935a26a9a.png)

There was an error accessing the 192.168.255.130:7100
HTTP ERROR 503
Would you please help me with this problem?
  I have two server, both mac mini. server A run stf local --public-ip x.x.x.x --allow-remote 
server B has 2 phones linked to it, and run 
stf provider --connect-sub tcp:// x.x.x.x:7250  --connect-push tcp:// x.x.x.x:7270  --storage-url http:// x.x.x.x:7100  --public-ip  x.x.x.x --min-port=35000  --max-port=40000  --heartbeat-interval 20000
but B result is：
INF/provider 10745 [*] Subscribing to permanent channel "qnSu3UvKTmeZsyf9XXld5g=="
INF/provider 10745 [*] Sending output to "tcp://x.x.x.x:7270"
INF/provider 10745 [*] Receiving input from "tcp://x.x.x.x:7250"
INF/provider 10745 [*] Tracking devices
INF/provider 10748 [*] Found device "ENU7N15B12014604" (device)
INF/provider 10748 [*] Found device "69edb8c0" (device)
INF/provider 10748 [*] Providing all 0 of 2 device(s); ignoring "ENU7N15B12014604", "69edb8c0"

why？
 so do you mean - tcp:// x.x.x.x:7250 or  tcp:// x.x.x.x:7270 dosn't reply .
should I appoint the sub/push port for server B 
  Hi,
Is there any command like:
    
     sudo apt purge openstf

to uninstall openstf from Ubuntu 16.04 or how can i uninstall openstf from ubuntu completely? 
 I have done it by using the following command: 

               curl -s https://gist.githubusercontent.com/MiteshShah/62cd0923b9068a927dae/raw/STF | sudo bash
Nothing else i have used to install it.  Here is the script:

#!/bin/bash

# Error handling
function OwnError()
{
	echo -e "[ `date` ] $(tput setaf 1)$@$(tput sgr0)"
	exit $2
}

# Repository for rethinkdb
echo "Setup Repository For Rethinkdb, Please Wait..."
source /etc/lsb-release \
&& echo "deb http://download.rethinkdb.com/apt $DISTRIB_CODENAME main" > /etc/apt/sources.list.d/rethinkdb.list \
&& wget -qO- http://download.rethinkdb.com/apt/pubkey.gpg | sudo apt-key add - \
|| OwnError "Unable to setup rethinkdb repository, exit status = " $?

# Install wget and curl
echo "Executing: apt-get update, Please wait..."
apt-get update \
|| OwnError "Unable to execute apt-get update command, exit status = " $?

echo "Installing required packages, Please wait..."
apt-get -y install wget curl git rethinkdb android-tools-adb python autoconf automake libtool build-essential ninja-build libzmq3-dev libprotobuf-dev git graphicsmagick \
|| OwnError "Unable to install required packages, exit status = " $?

echo "Donwloading Node.js, Please Wait..."
cd /tmp && \
wget -c https://nodejs.org/dist/v0.12.7/node-v0.12.7.tar.gz \
|| OwnError "Unable to download Node.js, exit status = " $?

echo "Installing Node.js, Please Wait..."
tar xzf node-v*.tar.gz && \
rm node-v*.tar.gz && \
cd node-v* && \
export CXX="g++ -Wno-unused-local-typedefs" && \
./configure --ninja && \
make && \
make install && \
rm -rf /tmp/node-v* && \
cd /tmp && \
/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js install \
|| OwnError "Unable to install Node.js, exit status = " $?

echo "Installing Bower, Please Wait..."
npm install -g bower \
|| OwnError "Unable to install Bower, exit status = " $?

echo "Installing ZeroMQ, Please wait..."
cd /opt
wget http://download.zeromq.org/zeromq-4.1.2.tar.gz \
&& tar -zxvf zeromq-4.1.2.tar.gz \
&& cd zeromq-4.1.2 \
&& ./configure --without-libsodium \
&& make \
&& make install \
|| OwnError "Unable to install ZeroMQ, exit status = " $?

echo "Setup Protocol Buffers, Please wait..."
cd /opt \
&& git clone https://github.com/google/protobuf.git \
&& cd protobuf \
&& ./autogen.sh \
&& ./configure \
&& make \
&& make install \
|| OwnError "Unable to Setup Protocol Buffers, exit status = " $?

echo "Installing STF, Please wait..."
npm install -g stf \
|| OwnError "Unable to Installing STF, exit status = " $?
view raw Done :)  There is a similar issue with Samsung SM-G350: #533.
I'll try to force full size as suggested in: https://github.com/openstf/stf/issues/623#issuecomment-308672907 and post a result.  Hi,
 I am currently using stf on localhost but i want to use stf on external network too, from the issues i have  found that stf can be deployed to real servers by following the tutorial from Deployment.md but first thing is **i don't have any actual server right now so can i deploy it again on my linux machine behaving like a server and the second thing is a bit straight forward video tutorial of deploying stf on real servers would be best.**  I've worked out a Shell script to automate the procedure of deployment. Hope this would be helpful.

```shell
#!/usr/bin/env bash
#######################################################################################
# file:    deploy_stf.sh
# brief:   deploy components of stf with docker
# creator: thinkhy
# date:    2017-04-20
# usage:   ./deploy_stf.sh  Note: run it as ROOT user
# changes: 
#    1. 2017-04-20 init  @thinkhy
#    2. 2017-04-26 add systemd unit  @thinkhy
#    3. 2017-05-04 install adb on host machine @thinkhy
# 
#######################################################################################

check_return_code() {
  if [ $? -ne 0 ]; then
    echo "Failed to run last step!" 	
    return 1
  fi
   
  return 0
}

assert_run_ok() {
  if [ $? -ne 0 ]; then
    echo "Failed to run last step!" 	
    exit 1
  fi
   
  return 0
}

prepare() {
  echo "setup environment ..."


  # Given advantages of performance and stability, we run adb server and rethinkdb 
  # on host(physical) machine rather than on docker containers, so need to
  #  install package of android-tools-adb first [ thinkhy 2017-05-04 ]

  # install adb
  apt-get install -y android-tools-adb


  apt-get install -y docker.io
  assert_run_ok

  docker pull openstf/stf 
  assert_run_ok

  docker pull sorccu/adb 
  assert_run_ok

  docker pull rethinkdb 
  assert_run_ok

  docker pull openstf/ambassador 
  assert_run_ok

  docker pull nginx
  assert_run_ok

  cp -rf systemd.unit/adbd.service /etc/systemd/system 
  assert_run_ok

  echo 1>"env.ok"

}

if [ ! -e env.ok ]; then
  prepare
fi

# start local adb server
echo "start adb server"
adb start-server

# start rethinkdb
echo "start docker container: rethinkdb"
docker run -d --name rethinkdb -v /srv/rethinkdb:/data --net host rethinkdb rethinkdb --bind all --cache-size 8192 --http-port 8090
check_return_code

# start nginx, note: generate nginx.conf first
echo "start docker container: nginx"
docker run -d -v $(pwd)/nginx.conf:/etc/nginx/nginx.conf:ro --name nginx --net host nginx nginx
check_return_code

# create tables 
echo "start docker container: stf-migrate"
docker run -d --name stf-migrate --net host openstf/stf stf migrate
check_return_code

# create storage components 
echo "start docker container: storage-plugin-apk-3300"
docker run -d --name storage-plugin-apk-3300 -p 3300:3000 --dns __DNS_ADDRESS__  openstf/stf stf storage-plugin-apk  --port 3000 --storage-url http://__IP_ADDRESS__/
check_return_code

echo "start docker container: storage-plugin-image-3400"
docker run -d --name storage-plugin-image-3400 -p 3400:3000 --dns __DNS_ADDRESS__  openstf/stf stf storage-plugin-image  --port 3000 --storage-url http://__IP_ADDRESS__/
check_return_code  

echo "start docker container: storage-temp-3500"
docker run -d --name storage-temp-3500 -v /mnt/storage:/data -p 3500:3000 --dns __DNS_ADDRESS__  openstf/stf stf storage-temp  --port 3000 --save-dir /data
check_return_code

# tri-proxy
echo "start docker container: triproxy-app"
docker run -d --name triproxy-app --net host openstf/stf stf triproxy app --bind-pub "tcp://*:7150" --bind-dealer "tcp://*:7160" --bind-pull "tcp://*:7170"
check_return_code

echo "start docker container: triproxy-dev"
docker run -d --name triproxy-dev --net host openstf/stf stf triproxy dev --bind-pub "tcp://*:7250" --bind-dealer "tcp://*:7260" --bind-pull "tcp://*:7270"
check_return_code

# auth
echo "start docker container: stf-auth-3200"
 docker run -d --name stf-auth-3200 -e "SECRET=YOUR_SESSION_SECRET_HERE" -p 3200:3000 --dns __DNS_ADDRESS__ openstf/stf stf auth-mock --port 3000 --app-url http://__IP_ADDRESS__/
check_return_code

# api 
echo "start docker container: stf-api"
docker run -d --name stf-api --net host -e "SECRET=YOUR_SESSION_SECRET_HERE"  openstf/stf stf api --port 3700 --connect-sub tcp://__IP_ADDRESS__:7150  --connect-push tcp://__IP_ADDRESS__:7170
check_return_code

# stf APP
echo "start docker container: stf-app-3100"
docker run -d --name stf-app-3100 --net host -e "SECRET=YOUR_SESSION_SECRET_HERE" -p 3100:3000 openstf/stf stf app --port 3100 --auth-url http://__IP_ADDRESS__/auth/mock/ --websocket-url http://__IP_ADDRESS__/
check_return_code


# processor
echo "start docker container: stf-processor"
docker run -d --name stf-processor --net host openstf/stf stf processor stf-processor.service --connect-app-dealer tcp://__IP_ADDRESS__:7160 --connect-dev-dealer tcp://__IP_ADDRESS__:7260
check_return_code

# websocket
echo "start docker container: websocket"
docker run -d --name websocket -e "SECRET=YOUR_SESSION_SECRET_HERE" --net host openstf/stf stf websocket --port 3600 --storage-url http://__IP_ADDRESS__/ --connect-sub tcp://__IP_ADDRESS__:7150 --connect-push tcp://__IP_ADDRESS__:7170
check_return_code

# reaper
echo "start docker container: reaper"
docker run -d --name reaper --net host openstf/stf stf reaper dev --connect-push tcp://__IP_ADDRESS__:7270 --connect-sub tcp://__IP_ADDRESS__:7150 --heartbeat-timeout 30000
check_return_code

# provider
echo "start docker container: provider-__HOSTNAME__"
docker run -d --name provider1 --net host openstf/stf stf provider --name "provider-__HOSTNAME__" --connect-sub tcp://__IP_ADDRESS__:7250 --connect-push tcp://__IP_ADDRESS__:7270 --storage-url http://__IP_ADDRESS__ --public-ip __IP_ADDRESS__ --min-port=15000 --max-port=25000 --heartbeat-interval 20000 --screen-ws-url-pattern "ws://__IP_ADDRESS__/d/floor4/<%= serial %>/<%= publicPort %>/"
check_return_code
```
 Hi,
Thanks for the response but while running the following command:
 
    cp -rf systemd.unit/adbd.service /etc/systemd/system

i have met with the following error:

   cp: cannot stat 'systemd.unit/adbd.service': No such file or directory

I have tried looking in the following directory **system** but there was no systemd.unit file.
   
 me too having the same error while running the shell script.

cannot stat 'systemd.unit/adbd.service': No such file or directory
 OK. I missed the file of adbd.service below  ......

[Unit]
Description=Android Debug Bridge daemon

```shell
[Service]
#TimeoutStartSec=1min
Restart=always
RestartSec=2s
Type=forking
User=root
ExecStartPre=/usr/bin/adb kill-server
ExecStart=/usr/bin/adb start-server
ExecStop=/usr/bin/adb kill-server
```

 hi,
I am running the shell script some of the containers are running but some containers are missing when i am running ```sudo docker ps``` but they are running in background. 
```
start adb server
start docker container: rethinkdb
db09335f3e4f0a4f793c93bcfbf8ac77a54854a4a94f7a03f839760004871e66
start docker container: nginx
/home/tft/Desktop/stf
ef85734fc6d12437ef663bd0f59d964b926a0b359cda263d86e93c165f74cb63
docker: Error response from daemon: containerd: container not started.
Failed to run last step!
start docker container: stf-migrate
43320a6dfa9c8b7cc7891583692dd7542bd58863d2217c6e9ee6a073a188c368
start docker container: storage-plugin-apk-3300
873fdb099ac1610c6f704891f937cb5b73433ee9c98fb6199c9e177a98e10b29
start docker container: storage-plugin-image-3400
607a7e7f6bc09b206a8a6535e939e9516a65798f19aac233baa1a1bd7e4abd76
start docker container: storage-temp-3500
584a37cf09f8c20831f4fe9304f9d96ae8b2536025133673c2cae7d9cdf6f667
start docker container: triproxy-app
ca5fc57ea1729e0fe8c19c4af90b181b0c57bffd203b1636d1cd9e5dec94bb72
start docker container: triproxy-dev
169a79a0de9c2e1c4dc25fe3f0213f47497a6358a1c7413573cac371843d4444
start docker container: stf-auth-3200
53c4e6b46dd0cd259c9a753b11a5f430f9b0ef0ed000095c059e18abdf714e08
start docker container: stf-api
b65750b4be188939914c32dcfd2bad1c459c274bc4d5dd23766aa87cd30a8ef5
start docker container: stf-app-3100
6415b056adef0342a94a82818b9346456197419fde584545195aeb85b0620738
start docker container: stf-processor
2e09f8daee3db117781c1f3e3399111327ed969608d1043377fb664f11b2cb7a
start docker container: websocket
4a3f822bdd714830158ea56443fc9b42c797b1bda5bcb71a09124887a0790e43
start docker container: reaper
bd700cca1d8fad4a69adb648c1ae451ee6c480d2b8a20b0faabae51b768b1441
start docker container: provider-__HOSTNAME__
5023e4749cb696050bdedbd088fd4c423f8286c5958a5950604d87efc8987f3c
```
I think that nginx.conf file is having some issue. Can you please help. 
Thanks in advance ```
cp -rf systemd.unit/adbd.service /etc/systemd/system 
  assert_run_ok
```
this was showing an error so I have to remove it as it is simply copying the adbd.service file so I made my adbd.service file in etc/systemd/system. after that when I ran my .sh file it is showing error in creating a container for nginx. I had replaced the nginx.conf file in etc/nginx/nginx.conf as per the DEPLOYMENT.md. I can connect to rethinkdb WebUI on port 8080 and when I ran 192.168.104.183:3200 it is redirecting to auth/mock but it is not able to load entry.js and commonentry.js when I look in the chrome debug tool. Not able to figure out the issue. Please guide. 
after running the .sh file, the console was mentioned in the previous comment
Thanks in advance. @rahul0698 and @suvansh-dev I've created a new repo for automation deployment of stf with docker.
Please try and feedback.

https://github.com/thinkhy/deploy-stf-docker
 hello,
Those who are having the problem in deploying stf to a real server, can now deploy with one click by the shell script written by @thinkhy. You can clone the repo [https://github.com/thinkhy/deploy-stf-docker](url) and then you just need to run the script. 

After running the script if you encounter problem like not able to connect to 127.0.0.1:28015, it may be due to initially installed rethinkdb locally on your machine. So deploy it on a freshly installed Linux machine and just pull the repo and run the script without installing other dependencies and you are good to go. 
Thanks! It's my pleasure. @rahul0698 Thanks for sharing your experience and solution. With the script I get a blank page at localhost:3200/auth/mock.
Do I need to change something?
I tried to look into the stf logfiles but i dont know how I can find it inside the docker container. And isnt the rethinkdb-proxy-28015.service required?
Thank You for the nice skript anyways! @xell66 you can check log of docker container using the command "docker logs CONTAINER_ID" Hi i have the same error that @xell66 and I check log of docket container (stf-auth-3200) and i see this:

`INF/auth-mock 1 [*] Listening on port 3000`

please help
 This log shows your stf is running well ...  @terminalone  OK. I will enhance my scripts. @thinkhy Thank you very much for your script, I run STF successfully in Virtualbox , but there is a problem that I can't access app through the browser on host, I have forwarded rethindb port (8090) and app port (3100) on vitrualbox, and I can get the DB page through 127.0.0.1:8090 on host browser.  but I can't access app (auth/mock) page  through 127.0.0.1:3100. I've tried many manyways, such as ngrok and deploy via docker,  but none of them can work. 

My problem is very similar to this: https://github.com/openstf/stf/issues/700

Thank you very very much !   Hi,

I'm running some Android automation with Appium remotely using openstf.
One problem I am having is, when I try to disconnect all network (eg, go to airplane mode),
I realized that openstf will also disconnect.

Does anyone know a way I can get my device to have no network, but have openstf connected?

Thanks. I am able to use STF in airplane mode.
But when I go from Non-airplane mode -> Airplane mode, STF connection also disconnects.
If it is not a STF issue, maybe it's a Appium issue.
I'm using Appium Driver to disconnect from all networks, and maybe STF also disconnects because of how Appium executes this.

Has anyone tried using Appium and disconnecting from all networks? Are you running the Appium tests on the same machine that hosts STF? I had STF online while running some Appium tests of my own (not related), and at some points STF decided to disconnect as well, I think there might be some kind of conflict between both servers when they're up.  
 **Plus even if you could** means there is a possibility?What if i remove the drop down list of all devices and the devices section from the UI? You are right changing the url will show whole of the stuff. If you want to implement this properly, it would require to implement first an user-specific permissions system. ok thanks but what after that? After having a permissions system, assigning which user can see which device should be doable from the database at least. This will take effort and we don't have plans to do this right now, but contributions are welcome. ok sir, i will try to do this, if you found anything else that can help me to achieve this then please comment over here. Thanks! One thing more what kind of user-specific permission system i should make, please provide a brief summary like **how should i start? In which language and how can i connect that with the existing code?** 
I am currently using **stf local** to access it on the web browser.  Hi, I'd like to use LDAP filter option.
This PR add the `ldap-search-filter` option for `auth-ldap`.  


The documentation of `parseFilter` is http://ldapjs.org/filters.html @sorccu Thank you for your comment!
I have fixed some bugs and tested both simple and complex filter.
 Great, when this feature will be available in the master branch ? Thanks !  Hello,

I'm using openSTF to run automated tests for my android app.
I was wondering if it is possible to have adb commands within my automation code to run them remotely in STF.
For example, I want to run adb logcat for every test failures.
I can connect adb remotely, but I was wondering if I can run adb remotely within the automation code.

Thanks! It's not really a job for STF, but you can get logcat while testing on
devices connected through STF.

While connected through STF, devices behave almost as though they are
attached to your PC.

Getting logcat during tests is a job for your testing framework.
I get the most out of instrumentation tests using the [Spoon runner](
http://square.github.io/spoon/)

I hope this answers your query

On Tue, Jun 13, 2017, 21:13 Moon Seop <notifications@github.com> wrote:

> Hello,
>
> I'm using openSTF to run automated tests for my android app.
> I was wondering if it is possible to have adb commands within my
> automation code to run them remotely in STF.
> For example, I want to run adb logcat for every test failures.
> I can connect adb remotely, but I was wondering if I can run adb remotely
> within the automation code.
>
> Thanks!
>
> —
> You are receiving this because you are subscribed to this thread.
> Reply to this email directly, view it on GitHub
> <https://github.com/openstf/stf/issues/618>, or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AA68gh3PDcuYPcWLcqQo1_vD_WOCjPHRks5sDtFXgaJpZM4N43gK>
> .
>
 You can extend device component. I've implemented a similar function to send all the logcat entries to Graylog based on ElasticSearch.  This is booking feature with new architecture. retry work for #101 .
#101 is too much behind. So now I'm coding from scratch.
I'll make divided PR for this as follow later.
- device plugin
- reserve unit
- booking ui

If you have better way for this work, please instruct me.
ex: make feature branch on your organizer repository. then I'll make PR for it.
 Is this booking feature under development or available from now ? I forked the master branch but I don't see the booking feature available through the UI, what branch I have to fork ? sorry the booking-renew thanks.. Sorry again it does not change anything with this branch (booking-renew), I don't see the booking feature available through the UI, I don't see any additional parameters available while launching STF, so please tell me what is the way to activate this feature ? https://github.com/hogehoge-banana/stf/pull/3
I made sub task on my personal repository.  There exists an incompatibility problem as the shell command "ps comm" is invalid in some devices such as Google Pixel.

Below is the output when I issued "ps com" in Pixel:

 sailfish:/ $ ps com
 bad pid 'com'
 sailfish:/ $ echo $?
 1

So I replaced "ps comm" with "ps" which is workable for all the Android device. I wrote following shell script to do perf test

     cnt=1
     while read sn device; do
        echo "device ${cnt}"
        echo "---------------------"
        echo "ps com.android.mms: \
          $((time adb -s ${sn} shell 'ps com.android.mms >/dev/null')  2>&1     \
          |awk '/real/ {print $2}')"
        echo "ps: $((time adb -s ${sn} shell 'ps >/dev/null')  2>&1  |awk '/real/ {print $2}')"
        echo -e "\n"
        let "cnt=$cnt+1"
     done < <(adb devices |grep device|sed -e '1d' -e '/^\s*$/d')


I have performed the perf test for several times. The results show that the perf difference  between "ps" and "ps comm" is not significant(<10%).


device 1
---------------------
ps com.android.mms: 0m0.122s
ps: 0m0.100s


device 2
---------------------
ps com.android.mms: 0m0.093s
ps: 0m0.086s


device 3
---------------------
ps com.android.mms: 0m0.094s
ps: 0m0.099s


device 4
---------------------
ps com.android.mms: 0m0.093s
ps: 0m0.097s


device 5
---------------------
ps com.android.mms: 0m0.098s
ps: 0m0.095s


device 6
---------------------
ps com.android.mms: 0m0.093s
ps: 0m0.098s


device 7
---------------------
ps com.android.mms: 0m0.091s
ps: 0m0.097s


device 8
---------------------
ps com.android.mms: 0m0.103s
ps: 0m0.105s


device 9
---------------------
ps com.android.mms: 0m0.095s
ps: 0m0.094s


device 10
---------------------
ps com.android.mms: 0m0.093s
ps: 0m0.095s


device 11
---------------------
ps com.android.mms: 0m0.090s
ps: 0m0.095s


device 12
---------------------
ps com.android.mms: 0m0.090s
ps: 0m0.096s


device 13
---------------------
ps com.android.mms: 0m0.087s
ps: 0m0.094s


device 14
---------------------
ps com.android.mms: 0m0.093s
ps: 0m0.094s


device 15
---------------------
ps com.android.mms: 0m0.092s
ps: 0m0.095s


device 16
---------------------
ps com.android.mms: 0m0.095s
ps: 0m0.095s


device 17
---------------------
ps com.android.mms: 0m0.092s
ps: 0m0.095s


device 18
---------------------
ps com.android.mms: 0m0.092s
ps: 0m0.094s


device 19
---------------------
ps com.android.mms: 0m0.095s
ps: 0m0.095s


device 20
---------------------
ps com.android.mms: 0m0.086s
ps: 0m0.091s


device 21
---------------------
ps com.android.mms: 0m0.092s
ps: 0m0.095s


device 22
---------------------
ps com.android.mms: 0m0.082s
ps: 0m0.091s
 Sure,  I'm a SDET,  testing some mobile APPs and creating some automation tools.  Seems we intended to filter header line in the output of "ps comm",  it's supposed to initialize flag variable "header" to true. I found it when reviewed code in the component of "device" in order to add a device plugin for testing.

Actually in the function of "listPidsByComm" in devutil.js, there still exists an incompatibility problem as the shell command "ps comm" is invalid in some devices such as Google Pixel. 
Below is the output when I issued "ps com" in Pixel:

     1|sailfish:/ $ ps com
     bad pid 'com'
     1|sailfish:/ $ echo $?
     1

So I suggest to replace "ps comm" with "ps" which is workable for all the Android device. 
 Pixel is not common in China neither, someone sent me this device from US.
OK, I'll create a new patch which only replace "ps comm" with "ps" in listPidsByComm.  Any updates on this issue? How can I donate a device? Also, what is the cheapest device that I can use with this software?  linux:192.168.31.202     with stf ,android sdk
windows:192.168.31.135     without stf, have adbkit and android sdk

devices are connect to windows

1.start stf in linux `stf local --public-ip 192.168.31.202 --allow-remote`
2.windows run `adb -a -P 5037 fork-server server`
3.linux run`stf provider --name mikezhoudeMac-mini.local --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 20000 --public-ip 192.168.31.202 --storage-url http://localhost:7100/ --adb-host 192.168.31.135 --adb-port 5037 --vnc-initial-size 600x800 --allow-remote	`

then i can see my remote device on the web page,but i want to see my devices in my adb.
when i run `adb devices`,i can see the devices like `whitiancai@whitiancai-OptiPlex-3046:~/IdeaProjects/AutoMobile$ adb devices
List of devices attached
4d00f618684d5051        device
`

i try to run `adb connect 192.168.31.202:7401`,and it doesn't work.when i run the cmd again, an error happened.
`FTL/device:plugins:touch 11369 [SODMDIQ499999999] Touch consumer had an error Error: Failed more than 3 times in 10000ms
    at TouchConsumer._failLimitExceeded (/home/whitiancai/stf/stf-master/lib/units/device/plugins/touch/index.js:230:26)
    at FailCounter.emit (/home/whitiancai/stf/stf-master/node_modules/_eventemitter3@1.2.0@eventemitter3/index.js:117:35)
    at FailCounter.inc (/home/whitiancai/stf/stf-master/lib/util/failcounter.js:29:10)
    at TouchConsumer._socketEnded (/home/whitiancai/stf/stf-master/lib/units/device/plugins/touch/index.js:217:24)
    at RiskyStream.emit (/home/whitiancai/stf/stf-master/node_modules/_eventemitter3@1.2.0@eventemitter3/index.js:115:35)
    at RiskyStream.<anonymous> (/home/whitiancai/stf/stf-master/lib/util/riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:974:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/util:lifecycle 11369 [SODMDIQ499999999] Shutting down due to fatal error
INF/provider 11355 [*] Cleaning up device worker "SODMDIQ499999999"
ERR/provider 11355 [*] Device worker "SODMDIQ499999999" died with code 1`


what should i do? Did you add public key in stf web page when issue "adb connect ..." ? 

  you mean the key in the setting web page?How to add ?Can you show me a complete adb code
 The panel will be poped out automatically when you issue the "adb connect ..." for the first time. what panel?I see a device "192.168.31.135:7401" in my device list,but it will be offline in a few seconds.  Lastest release used.

All works well except the below issue:

When a device is under control through the GUI, if I download a file using the 'File Explorer' window (i.e. picture in sdcard/DCIM/Camera), then the mobile screen freeze so that it becomes impossible to interact with it, until I globally refresh the brower window.
 I used the docker hub images <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Lastest release used, I use your official docker image available from docker hub.

All work well except the below issue:

When a device is under control through the GUI, if I download a file using the 'File Explorer' window (i.e. picture in sdcard/DCIM/...), then the mobile screen freezes so that it becomes impossible to interact with it, until I globally refresh the browser window.

Note I detected this issue from many months but as it was not blocking I did not spend time to report it, now I have time so I post it.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
all devices are concerned, I have 18 devices in my test platform : sony, samsung, huawei, htc, lg, 

root@debian:/home/debian# adb devices -l
List of devices attached
BH906ZJG56             device usb:1-2 product:F5121 model:F5121 device:F5121


**Please provide the steps to reproduce the issue.**
1/ take the control of a device
2/ take a picture using the camera
3/ go to the file explorer view
4/ select for download this picture in sdcard/DCIM/...
5/ at this time it is no more possible to interact with the device through the GUI, for example the device screen is like frozen

Then, I have to refresh the STF window of my internet browser to get back the control of the device.

**What is the expected behavior?**
I should be able to continue to interact normally with the device through the GUI, without the need to refresh globally STF window of my internet browser

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
yes, the minicap service is stopped when the download action is fired:

`Jun  7 14:28:01 debian docker[1635]: INF/device:plugins:filesystem 120 [BH906ZJG56] Retrieving file "/sdcard/DCIM/100ANDRO/DSC_0001.JPG"
Jun  7 14:28:05 debian docker[1635]: INF/storage:temp 67 [*] Uploaded "DSC_0001.JPG" to "/tmp/upload_b8f3ec5a4855edb22d0795185d858214"
Jun  7 14:28:05 debian docker[1635]: INF/device:support:storage 120 [BH906ZJG56] Uploaded to "/s/blob/43b9004f-c0dd-4f39-9fec-6c6071deb6c1/DSC_0001.JPG"
Jun  7 14:28:05 debian docker[1635]: INF/device:plugins:screen:stream 120 [BH906ZJG56] Requesting frame producer to stop
Jun  7 14:28:05 debian docker[1635]: INF/device:plugins:screen:stream 120 [BH906ZJG56] Disconnecting from minicap service
Jun  7 14:28:05 debian docker[1635]: INF/device:plugins:screen:stream 120 [BH906ZJG56] Stopping minicap service
Jun  7 14:28:05 debian docker[1635]: INF/device:plugins:screen:stream 120 [BH906ZJG56] Sending SIGTERM to minicap
Jun  7 14:28:05 debian docker[1635]: INF/device:plugins:screen:stream 120 [BH906ZJG56] minicap says: "INFO: (jni/minicap/minicap.cpp:197) Received SIGTERM, stopping"
Jun  7 14:28:05 debian docker[1635]: INF/device:plugins:screen:stream 120 [BH906ZJG56] minicap says: "INFO: (jni/minicap/minicap.cpp:516) Closing client connection"
Jun  7 14:28:05 debian docker[1635]: INF/device:plugins:screen:stream 120 [BH906ZJG56] minicap says: "INFO: (external/MY_minicap/src/minicap_23.cpp:284) Destroying virtual display"
`

**Please run `stf doctor` and paste the output here.**
```
root@debian:/home/debian# docker exec -t -i 87329623209c stf doctor
INF/util:doctor 148 [*] OS Arch: x64
INF/util:doctor 148 [*] OS Platform: linux
INF/util:doctor 148 [*] OS Platform: 3.16.0-4-amd64
INF/util:doctor 148 [*] Using Node 6.9.5
INF/util:doctor 148 [*] Using RethinkDB client 2.3.3
INF/util:doctor 148 [*] Using ZeroMQ 4.1.4
WRN/util:doctor 148 [*] Executable was not found
WRN/util:doctor 148 [*] Executable was not found
WRN/util:doctor 148 [*] Executable was not found
INF/util:doctor 148 [*] GraphicsMagick 1.3.23
```

 I hit the same problem for several times. I'll  post device info and log when the problem reoccur.  Hi,
I verified your #186 fix works well with Chrome and Safari but with Firefox (version 54.0 64 bit) this issue remains !  The only solution I found is to delete the corresponding cookies..
Is it possible to have a 'logout' button ?   Please, do you have some samples illustrating the using of this feature ?
 I talk about the 'Automation' tab in the GUI ? The appium example uses the RESTful API to connect to the device, and then runs the test, I experimented that yet and it is great, but I don't see where the 'Automation' window of the device under control is used in this use case, this is why I asked the question. In this 'Automation' window, there is the 'Store account' box with "Sign-in" button etc. but I don't know what it means ? I agree with you, so what means 'Automation' window and how to use it ? Thanks.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
i have to run the 'adb connect 192.168.31.202:8088' twice that i can see the remote device after i run 'adb devices',and the connect will occur an error in a few secends

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
it is not only happen on a specific device,i can control the remote device well before i run 'adb connect 192.168.31.202:8088'. 

**Please provide the steps to reproduce the issue.**
linux ip 192.168.31.202 ,windows ip 192.168.31.135
1.linux run 'stf local --public-ip 192.168.31.202 --allow-remote'
2.windows run 'adb -a -P 5037 fork-server server'
3.linux run 'stf provider --name mikezhoudeMac-mini.local --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 20000 --public-ip 192.168.31.202 --storage-url http://localhost:7100/ --adb-host 192.168.31.135 --adb-port 5037 --vnc-initial-size 600x800 --allow-remote	'

(i can see the remote device now)

4.see the remote debug cmd in device control page,and  linux run the cmd( 'adb connect 192.168.31.202:7401')
return 'connected to 192.168.31.202:7401'
log:
whitiancai@whitiancai-OptiPlex-3046:~$ adb connect 192.168.31.202:7401
connected to 192.168.31.202:7401

but i can't see any device when i run 'adb devices',and i run the step 4 again and now i can see the remote device
log:
whitiancai@whitiancai-OptiPlex-3046:~$ adb devices
List of devices attached
192.168.31.202:7401	device

5.linux run 'adb logcat',after a few secends the error happened.

**What is the expected behavior?**
the remote device connection will keep alive when i run 'adb connect 192.168.31.202:7401',so i can do something i want 

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
this is the log:
INF/device:plugins:touch 15481 [SODMDIQ499999999] Reading minitouch banner
INF/device:plugins:touch 15481 [SODMDIQ499999999] minitouch says: "Connection established"
WRN/device:plugins:touch 15481 [SODMDIQ499999999] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 15481 [SODMDIQ499999999] Disconnecting from minitouch service
INF/device:plugins:touch 15481 [SODMDIQ499999999] Stopping minitouch service
INF/device:plugins:touch 15481 [SODMDIQ499999999] Launching screen service
INF/device:plugins:touch 15481 [SODMDIQ499999999] Connecting to minitouch service
INF/device:plugins:touch 15481 [SODMDIQ499999999] Reading minitouch banner
INF/device:plugins:touch 15481 [SODMDIQ499999999] minitouch says: "Note: device /dev/input/event4 was outscored by /dev/input/event3 (2100 >= 2000)"
INF/device:plugins:touch 15481 [SODMDIQ499999999] minitouch says: "Type B touch device atmel_mxt_ts_T100_touchscreen (1023x1023 with 10 contacts) detected on /dev/input/event3 (score 2100)"
INF/device:plugins:touch 15481 [SODMDIQ499999999] minitouch says: "Connection established"
WRN/device:plugins:touch 15481 [SODMDIQ499999999] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 15481 [SODMDIQ499999999] Disconnecting from minitouch service
INF/device:plugins:touch 15481 [SODMDIQ499999999] Stopping minitouch service
INF/device:plugins:touch 15481 [SODMDIQ499999999] Launching screen service
INF/device:plugins:touch 15481 [SODMDIQ499999999] Connecting to minitouch service
INF/device:plugins:touch 15481 [SODMDIQ499999999] minitouch says: "Note: device /dev/input/event4 was outscored by /dev/input/event3 (2100 >= 2000)"
INF/device:plugins:touch 15481 [SODMDIQ499999999] minitouch says: "Type B touch device atmel_mxt_ts_T100_touchscreen (1023x1023 with 10 contacts) detected on /dev/input/event3 (score 2100)"
INF/device:plugins:touch 15481 [SODMDIQ499999999] Reading minitouch banner
INF/device:plugins:touch 15481 [SODMDIQ499999999] minitouch says: "Connection established"
WRN/device:plugins:touch 15481 [SODMDIQ499999999] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 15481 [SODMDIQ499999999] Disconnecting from minitouch service
FTL/device:plugins:touch 15481 [SODMDIQ499999999] Touch consumer had an error Error: Failed more than 3 times in 10000ms
    at TouchConsumer._failLimitExceeded (/home/whitiancai/stf/stf-master/lib/units/device/plugins/touch/index.js:230:26)
    at FailCounter.emit (/home/whitiancai/stf/stf-master/node_modules/_eventemitter3@1.2.0@eventemitter3/index.js:117:35)
    at FailCounter.inc (/home/whitiancai/stf/stf-master/lib/util/failcounter.js:29:10)
    at TouchConsumer._outputEnded (/home/whitiancai/stf/stf-master/lib/units/device/plugins/touch/index.js:223:24)
    at RiskyStream.emit (/home/whitiancai/stf/stf-master/node_modules/_eventemitter3@1.2.0@eventemitter3/index.js:115:35)
    at RiskyStream.<anonymous> (/home/whitiancai/stf/stf-master/lib/util/riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:974:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/util:lifecycle 15481 [SODMDIQ499999999] Shutting down due to fatal error
INF/provider 15473 [*] Cleaning up device worker "SODMDIQ499999999"
ERR/provider 15473 [*] Device worker "SODMDIQ499999999" died with code 1
INF/provider 15473 [*] Restarting device worker "SODMDIQ499999999"
**Please run `stf doctor` and paste the output here.**
whitiancai@whitiancai-OptiPlex-3046:~$ stf doctor
INF/cli:doctor 16229 [*] OS Arch: x64
INF/cli:doctor 16229 [*] OS Platform: linux
INF/cli:doctor 16229 [*] OS Platform: 4.4.0-75-generic
INF/cli:doctor 16229 [*] Using Node 6.10.0
INF/cli:doctor 16229 [*] Using ZeroMQ 4.2.1
INF/cli:doctor 16229 [*] Using RethinkDB 2.3.5~0trusty
INF/cli:doctor 16229 [*] Using ADB 1.0.39
INF/cli:doctor 16229 [*] Using GraphicsMagick 1.3.25
INF/cli:doctor 16229 [*] Using ProtoBuf 3.3.0

 I am sure i can both see and control the device before i run 'adb connect 192.168.31.202:7041',and it happened on all my devices(tow GALAXY_S4 and one XIAOMI NOTE2) ,not only one deivce.I also restart the stf ,linux pc and windows pc.

Here is the other log when the error occured
INF/triproxy 15333 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 15333 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 15333 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/triproxy 15339 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 15339 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 15339 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/db 15340 [*] Connecting to 127.0.0.1:28015
INF/processor 15340 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 15340 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/poorxy 15406 [*] Listening on port 7100
INF/reaper 15352 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 15352 [reaper001] Reaping devices with no heartbeat
INF/db 15346 [*] Connecting to 127.0.0.1:28015
INF/db 15352 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 15352 [reaper001] 1Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 15352 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/processor 15346 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 15346 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/provider 15358 [*] Subscribing to permanent channel "iH0FfHpzR1WQW0jeRoqlHw=="
INF/provider 15358 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 15358 [*] Receiving input from "tcp://127.0.0.1:7114"
INF/provider 15358 [*] Tracking devices
INF/storage:plugins:image 15394 [*] Listening on port 7103
INF/storage:plugins:apk 15400 [*] Listening on port 7104
INF/auth-mock 15364 [*] Listening on port 7120
INF/storage:temp 15388 [*] Listening on port 7102
INF/app 15370 [*] Using pre-built resources
INF/app 15370 [*] Listening on port 7105
INF/db 15370 [*] Connecting to 127.0.0.1:28015
INF/websocket 15382 [*] Subscribing to permanent channel "*ALL"
INF/websocket 15382 [*] Listening on port 7110
INF/db 15382 [*] Connecting to 127.0.0.1:28015
INF/websocket 15382 [*] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 15382 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/api 15376 [*] Subscribing to permanent channel "*ALL"
INF/api 15376 [*] Listening on port 7106
INF/api 15376 [*] Sending output to "tcp://127.0.0.1:7113"
INF/api 15376 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/db 15376 [*] Connecting to 127.0.0.1:28015
INF/reaper 15352 [reaper001] Device "SODMDIQ499999999" is present
INF/util:datautil 15382 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 15376 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 15376 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 15376 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 15376 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
INF/provider 15358 [*] Found device "192.168.31.202:7401" (offline)
INF/reaper 15352 [reaper001] Device "192.168.31.202:7401" is present
INF/provider 15358 [*] Registered device "192.168.31.202:7401"
INF/provider 15358 [*] Lost device "192.168.31.202:7401" (offline)
INF/provider 15358 [*] Providing all 0 device(s)
INF/provider 15358 [*] Found device "192.168.31.202:7401" (offline)
INF/reaper 15352 [reaper001] Device "192.168.31.202:7401" is present
INF/provider 15358 [*] Registered device "192.168.31.202:7401"
INF/provider 15358 [*] Device "192.168.31.202:7401" is now "device" (was "offline")
INF/device:support:push 15539 [192.168.31.202:7401] Sending output to "tcp://127.0.0.1:7116"
INF/device 15539 [192.168.31.202:7401] Preparing device
INF/device:support:sub 15539 [192.168.31.202:7401] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 15539 [192.168.31.202:7401] Subscribing to permanent channel "*ALL"
INF/device:support:properties 15539 [192.168.31.202:7401] Loading properties
INF/device:support:sdk 15539 [192.168.31.202:7401] Supports SDK 21
INF/device:support:abi 15539 [192.168.31.202:7401] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:minicap 15539 [192.168.31.202:7401] Installing "/home/whitiancai/stf/stf-master/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 15539 [192.168.31.202:7401] Installing "/home/whitiancai/stf/stf-master/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/lib/android-21/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 15539 [192.168.31.202:7401] Checking whether we need to install STFService
INF/device:resources:service 15539 [192.168.31.202:7401] Running version check
INF/device:resources:service 15539 [192.168.31.202:7401] STFService up to date
INF/device:plugins:service 15539 [192.168.31.202:7401] Launching agent
INF/device:plugins:service 15539 [192.168.31.202:7401] Agent says: "Listening on @stfagent"
INF/device:plugins:service 15539 [192.168.31.202:7401] Agent says: "InputClient started"
INF/device:plugins:service 15539 [192.168.31.202:7401] Launching service
INF/device:plugins:display 15539 [192.168.31.202:7401] Reading display info
INF/device:plugins:phone 15539 [192.168.31.202:7401] Fetching phone info
INF/device:plugins:identity 15539 [192.168.31.202:7401] Solving identity
INF/device:plugins:solo 15539 [192.168.31.202:7401] Subscribing to permanent channel "M3FzTf00pMzxIZuaKcoE5TbzkzA="
INF/device:plugins:screen:stream 15539 [192.168.31.202:7401] Starting WebSocket server on port 7400
FTL/device 15539 [192.168.31.202:7401] Setup had an error Error: listen EADDRINUSE 0.0.0.0:7400
    at Object.exports._errnoException (util.js:1022:11)
    at exports._exceptionWithHostPort (util.js:1045:20)
    at Server._listen2 (net.js:1259:14)
    at listen (net.js:1295:10)
    at net.js:1405:9
    at _combinedTickCallback (internal/process/next_tick.js:77:11)
From previous event:
    at Promise._captureStackTrace (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.11.0@bluebird/js/main/debuggability.js:90:23)
    at Promise._resolveFromResolver (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.11.0@bluebird/js/main/promise.js:480:10)
    at new Promise (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.11.0@bluebird/js/main/promise.js:71:37)
    at createServer (/home/whitiancai/stf/stf-master/lib/units/device/plugins/screen/stream.js:431:14)
    at /home/whitiancai/stf/stf-master/lib/units/device/plugins/screen/stream.js:449:12
    at SerialSyrup.ParallelSyrup.invoke (/home/whitiancai/stf/stf-master/node_modules/_stf-syrup@1.0.0@stf-syrup/lib/parallel.js:54:24)
    at /home/whitiancai/stf/stf-master/node_modules/_stf-syrup@1.0.0@stf-syrup/lib/serial.js:43:33
    at tryCatch1 (/home/whitiancai/stf/stf-master/node_modules/_bluebird@1.1.1@bluebird/js/main/util.js:63:19)
    at Promise$_callHandler [as _callHandler] (/home/whitiancai/stf/stf-master/node_modules/_bluebird@1.1.1@bluebird/js/main/promise.js:708:13)
    at Promise$_settlePromiseFromHandler [as _settlePromiseFromHandler] (/home/whitiancai/stf/stf-master/node_modules/_bluebird@1.1.1@bluebird/js/main/promise.js:724:18)
    at Promise$_settlePromiseAt [as _settlePromiseAt] (/home/whitiancai/stf/stf-master/node_modules/_bluebird@1.1.1@bluebird/js/main/promise.js:896:14)
    at Promise$_fulfillPromises [as _fulfillPromises] (/home/whitiancai/stf/stf-master/node_modules/_bluebird@1.1.1@bluebird/js/main/promise.js:1041:14)
    at Async$_consumeFunctionBuffer [as _consumeFunctionBuffer] (/home/whitiancai/stf/stf-master/node_modules/_bluebird@1.1.1@bluebird/js/main/async.js:74:12)
    at Async$consumeFunctionBuffer (/home/whitiancai/stf/stf-master/node_modules/_bluebird@1.1.1@bluebird/js/main/async.js:37:14)
    at _combinedTickCallback (internal/process/next_tick.js:67:7)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/util:lifecycle 15539 [192.168.31.202:7401] Shutting down due to fatal error
INF/provider 15358 [*] Cleaning up device worker "192.168.31.202:7401"
ERR/provider 15358 [*] Device worker "192.168.31.202:7401" died with code 1
INF/provider 15358 [*] Restarting device worker "192.168.31.202:7401"
INF/device:support:push 15554 [192.168.31.202:7401] Sending output to "tcp://127.0.0.1:7116"
INF/device 15554 [192.168.31.202:7401] Preparing device
INF/device:support:sub 15554 [192.168.31.202:7401] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 15554 [192.168.31.202:7401] Subscribing to permanent channel "*ALL"
INF/device:support:properties 15554 [192.168.31.202:7401] Loading properties
INF/provider 15358 [*] Providing 0 of 1 device(s); waiting for "192.168.31.202:7401"
INF/device:support:sdk 15554 [192.168.31.202:7401] Supports SDK 21
INF/device:support:abi 15554 [192.168.31.202:7401] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:minicap 15554 [192.168.31.202:7401] Installing "/home/whitiancai/stf/stf-master/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 15554 [192.168.31.202:7401] Installing "/home/whitiancai/stf/stf-master/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/lib/android-21/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 15554 [192.168.31.202:7401] Checking whether we need to install STFService
INF/device:resources:service 15554 [192.168.31.202:7401] Running version check
INF/device:resources:service 15554 [192.168.31.202:7401] STFService up to date
INF/device:plugins:service 15554 [192.168.31.202:7401] Launching agent
INF/device:plugins:service 15554 [192.168.31.202:7401] Agent says: "Listening on @stfagent"
INF/device:plugins:service 15554 [192.168.31.202:7401] Launching service
INF/device:plugins:service 15554 [192.168.31.202:7401] Agent says: "InputClient started"
INF/device:plugins:display 15554 [192.168.31.202:7401] Reading display info
INF/device:plugins:phone 15554 [192.168.31.202:7401] Fetching phone info
INF/device:plugins:identity 15554 [192.168.31.202:7401] Solving identity
INF/device:plugins:solo 15554 [192.168.31.202:7401] Subscribing to permanent channel "M3FzTf00pMzxIZuaKcoE5TbzkzA="
INF/device:plugins:screen:stream 15554 [192.168.31.202:7401] Starting WebSocket server on port 7404
INF/provider 15358 [*] Providing 0 of 1 device(s); waiting for "192.168.31.202:7401"
INF/provider 15358 [*] Lost device "192.168.31.202:7401" (device)
IMP/device:plugins:service 15554 [192.168.31.202:7401] Agent connection ended, attempting to relaunch
INF/device:plugins:service 15554 [192.168.31.202:7401] Launching service
IMP/device:plugins:service 15554 [192.168.31.202:7401] Service connection ended, attempting to relaunch
INF/device:plugins:service 15554 [192.168.31.202:7401] Launching service
FTL/device:plugins:service 15554 [192.168.31.202:7401] Agent connection could not be relaunched FailError: Failure: 'device '192.168.31.202:7401' not found'
    at /home/whitiancai/stf/stf-master/node_modules/_adbkit@2.9.2@adbkit/lib/adb/parser.js:183:29
    at tryCatcher (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.9.34@bluebird/js/main/util.js:26:23)
    at Promise._settlePromiseFromHandler (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.9.34@bluebird/js/main/promise.js:503:31)
    at Promise._settlePromiseAt (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.9.34@bluebird/js/main/promise.js:577:18)
    at Async._drainQueue (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.9.34@bluebird/js/main/async.js:128:12)
    at Async._drainQueues (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.9.34@bluebird/js/main/async.js:133:10)
    at Immediate.Async.drainQueues (/home/whitiancai/stf/stf-master/node_modules/_bluebird@2.9.34@bluebird/js/main/async.js:15:14)
    at runCallback (timers.js:651:20)
    at tryOnImmediate (timers.js:624:5)
    at processImmediate [as _immediateCallback] (timers.js:596:5)
FTL/util:lifecycle 15554 [192.168.31.202:7401] Shutting down due to fatal error
INF/provider 15358 [*] Shutting down device worker "192.168.31.202:7401"
INF/provider 15358 [*] Cleaning up device worker "192.168.31.202:7401"
INF/provider 15358 [*] Gracefully killing device worker "192.168.31.202:7401"
INF/provider 15358 [*] Device worker "192.168.31.202:7401" has retired
INF/provider 15358 [*] Providing all 0 device(s)
INF/util:datautil 15382 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 15376 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 15376 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 15376 [*] Device database does not have an entry for "SODMDIQ499999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
 no, i need add the remote device without stf to my stf. i have two `provider` but one is for the localhost and another one is for another pc ,when i run 'stf provider --name mikezhoudeMac-mini.local --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 20000 --public-ip 192.168.31.202 --storage-url http://localhost:7100/ --adb-host 192.168.31.135 --adb-port 5037 --vnc-initial-size 600x800 --allow-remote	',the second `provider` start for the windows pc ,i can see and control the remote device which from the windows.And then i run 'adb connect 192.168.31.202:7401' twice,you means i register the remote device in my first `provider` in `stf local`?And two `provider` both control the device,so the error happened?
But if i not start the second `provider`,i can't see and control the remote devices.how can i do?please tell me what's the right way to see,control and debug the remote device with the remote pc  not have STF    Hi,  an other issue.  
I use STF to execute monkey, set 10 hours, and collect logs at the same time. But 2.5 hours later, the execution was interrupted. What's the reason, please? I visit the devices by STF, at Shell, enter the Monkey command: "ADB shell monkey -p com.huajiao.camera -s -v -v -v 1000 --throttle 500 --pct-touch 10 --pct-motion 10 --pct-trackball 10 --pct-nav 10 --pct-majornav 10 --pct-syskeys 1 --pct-appswitch 1 --pct-anyevent 1 --ignore-crashes --ignore-security-exceptions --kill-process-after-error --monitor-native-crashes 100000"

At the same time, locally connect the device, enter under the CMD: "ADB -s 99.33.77.10:11193 logcat -v time >D:/toushijing.txt" to collect the log
Two hours later, the execution was interrupted

Thank you for your help we did as below: Could you shed some light on this problem?
we've specified group-timeout when start stf provider using docker container.

/usr/bin/docker run --rm \
  --name %p-%i \
  --net host   \
  openstf/stf  \
  stf provider \
    --name "%H/%i"                              \
    --connect-sub tcp://server:7250  \
    --connect-push tcp://server:7270 \
    --storage-url http://server      \
    --public-ip server                 \
    --min-port=11000 \
    --max-port=12000 \
    --heartbeat-interval 20000 \
    --group-timeout 36000
    --screen-ws-url-pattern "ws://server/d/floor4/<%= serial %>/<%= publicPort %>/"



Is this the correct operation? Hi,We have set the correct parameters

sysctl -w net.ipv4.tcp_keepalive_intvl=75
sysctl -w net.ipv4.tcp_keepalive_probes=9
sysctl -w net.ipv4.tcp_keepalive_time=75000
sysctl -p

The problem has been solved

Thank you for your help  Hi, I have some problems with Jenkins job garbled output.  
Set Jenkins encoding uft-8 ,before installing stf plugin,the encoding of output is normal.  
After installing stf plugin, It has trouble with the console.

before installing stf plugin





After installing stf plugin






  fixed a typo in apk storage plugin  As subject, suggest to open the timeout value as a command argument rather than hard coding it, so users can specify survival time for temp storage(apk/image/log ...) With the feature, timeout value can be set to longer, which will be usable in many scenarios:
     1. share a screenshot link to other colleagues
     2. cache apk files and save time to upload the same apk file
     3. store log files for later diagnosis(we use STF as internal test platform and store logcat to filesys after each testing)   The device requires sim card in the device.
If doesn't, **Install via USB** (needed for installing STFService.apk) and **USB debugging (Security settings)** (needed for running minitouch) can't on. MIUI 8.5.1.0 Yes , perhaps the os is different in China. Any update on this matter ? 
Same issue here. I need sim card inside the phone to install/dev apps on the phone too. 
I have unpacked new Redmi Note 5A with android 7.1.2 N2G47H (2017-12-01) and MUIU 9.2.1.0 NDFMIEK and the issue persist . 
In android studio INSTALL_FAILED_USER_RESTRICTED, which implies the admin app has not permitted such operation. And in Xiaomi phone it is part of MIUI as I recall.
 You're right. There is nothing you can add to this matter. I have researched about it a bit more and this is really an issue of MIUI 8+. They have added verification on chinese servers and gather unique id (UUID) of the phone on unlock of unknown souce apk. This  UUID is generated from sim card secure element and thus you need a sim card indeed. Foremost thanks for really fast answer 😉 So for anybody else reading this, you need any sim card inside. There is no need for sim card to be active on cellular. On the other hand internet connection is required too.   I want to develop stf just like 'node-debug app.js', but 'node-debug ./bin/stf local' always output 'address in used'.
Would you mind tell me a way to debug stf ? 
Would you mind just give an example like 'node --inspect' or more clearly cli that I can debug
  @vbanthia 
I took a stab at https://github.com/openstf/stf/issues/594

Appears to address the issue.  I read the STF source Code.
In triproxy/index.js, I know it publish  message  to all  subscribers. But, how the subscriber get the message owned by it .
For example, when I tap device A on the STF website,  triproxy  publish 'tap' to all devices. Device A and device B both subscribe 'tap' infomation. however, device A handle it , device not handle it . how STF do this?
Thanks.I don't know if you can understand me. My English is not very well.
 Ok.
New question.I can understand the unique channel. I read ZeroMQ. The Pub/Sub example is as follow:

- Publisher  pubber.js

```js
// pubber.js
var zmq = require('zeromq')
  , sock = zmq.socket('pub');

sock.bindSync('tcp://127.0.0.1:3000');
console.log('Publisher bound to port 3000');

setInterval(function(){
  console.log('sending a multipart message envelope');
  sock.send(['kitty cats', 'meow!']);
}, 500);
```

- Subscriber  subber.js

```js
// subber.js
var zmq = require('zeromq')
  , sock = zmq.socket('sub');

sock.connect('tcp://127.0.0.1:3000');
sock.subscribe('kitty cats');
console.log('Subscriber connected to port 3000');

sock.on('message', function(topic, message) {
  console.log('received a message related to:', topic, 'containing message:', message);
});
```
In the  subber.js,  `sock.subscribe('kitty cats');` the subscriber  subscribes the channel named kitty cats. However,  in  `/stf/lib/units/device/support/sub.js`,  which I think every device has it own sub socket by this file,does not has the similar code .The publisher send data through the special channel , however,the subscriber doesn't subscribe the special channel. Is something  I missed?
  I need use android device without screen - tests some device. In my case Odrino C2. I think the same problem will by with Raspberry Pi, Banana Pi, Orange Pi, LattePanda etc.

When I start OpenSTF, minitouch doesn't work. Dosen't see any touchscreen and stops working.

Following I have the STF log.

> [32mINF[39m/device:plugins:service 9382 [192.168.102.20:5555] Launching agent
> [32mINF[39m/device:plugins:service 9382 [192.168.102.20:5555] Agent says: "Listening on @stfagent"
> [32mINF[39m/device:plugins:service 9382 [192.168.102.20:5555] Launching service
> [32mINF[39m/device:plugins:service 9382 [192.168.102.20:5555] Agent says: "InputClient started"
> [32mINF[39m/device:plugins:display 9382 [192.168.102.20:5555] Reading display info
> [32mINF[39m/provider 9311 [*] Providing 0 of 1 device(s); waiting for "192.168.102.20:5555"
> [32mINF[39m/device:plugins:phone 9382 [192.168.102.20:5555] Fetching phone info
> [32mINF[39m/device:plugins:identity 9382 [192.168.102.20:5555] Solving identity
> [32mINF[39m/device:plugins:solo 9382 [192.168.102.20:5555] Subscribing to permanent channel "c74jdStqmG+oGQiuHsVFN5JbloI="
> [32mINF[39m/device:plugins:screen:stream 9382 [192.168.102.20:5555] Starting WebSocket server on port 7400
> [33mWRN[39m/device:plugins:data 9382 [192.168.102.20:5555] Unable to find device data { serial: '192.168.102.20:5555',
>   platform: 'Android',
>   manufacturer: 'HARDKERNEL CO., LTD.',
>   operator: null,
>   model: 'C2',
>   version: '6.0.1',
>   abi: 'armeabi-v7a',
>   sdk: '23',
>   product: 'odroidc2',
>   display: 
>    { id: 0,
>      width: 800,
>      height: 480,
>      xdpi: 160,
>      ydpi: 160.42100524902344,
>      fps: 60.000003814697266,
>      density: 1,
>      rotation: 0,
>      secure: true,
>      size: 5.8269051128633444,
>      url: 'ws://192.168.102.10:7400' },
>   phone: { network: 'UNKNOWN' } }
> [32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] Touch origin is top left
> [32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] Requesting touch consumer to start
> [32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] Launching screen service
> [32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] Connecting to minitouch service
> [32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
> [32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
> [32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
> **[32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] minitouch says: "Unable to find a suitable touch device"**
> **[33mWRN[39m/device:plugins:touch 9382 [192.168.102.20:5555] Shell keeping minitouch running ended unexpectedly**
> **[32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] Disconnecting from minitouch service**
> **[32mINF[39m/device:plugins:touch 9382 [192.168.102.20:5555] Stopping minitouch service**

When I connect touchscreen (even if they doesn't works) everything works:

> root@OpenSTF:~# shell dumpsys input
> INPUT MANAGER (dumpsys input)
> 
> Input Manager State:
> 
>   Interactive: true
>   System UI Visibility: 0x400
>   Pointer Speed: 0
>   Pointer Gestures Enabled: true
>   Show Touches: true
> 
> Event Hub State:
>   BuiltInKeyboardId: -2
>   Devices:
>     -1: Virtual
>       Classes: 0x40000023
>       Path: <virtual>
> 
> 	.............
> 
>8: RPI_TOUCH By ZH851
>    Classes: 0x00000014
>    Path: /dev/input/event6
>    Descriptor: 9287fe304329fd54909b5ad18b1e6a777db80b26
>    Location: usb-dwc2_b-1.1/input0
>    ControllerNumber: 0
>    UniqueId: 
>    Identifier: bus=0x0003, vendor=0x0eef, product=0x0005, version=0x0200
>    KeyLayoutFile: 
>    KeyCharacterMapFile: 
>    ConfigurationFile: /system/usr/idc/Vendor_0eef_Product_0005.idc
>    HaveKeyboardLayoutOverlay: false
> 
> Input Reader State:
>   Device -1: Virtual
>     Generation: 2
> 
> 	.............
> 	
>   Device 8: RPI_TOUCH By ZH851
>     Generation: 25
>     IsExternal: false
>     HasMic:     false
>     Sources: 0x0000d002
>     KeyboardType: 0
>     Motion Ranges:
>       X: source=0x0000d002, min=0.000, max=799.000, flat=0.000, fuzz=0.000, resolution=0.000
>       Y: source=0x0000d002, min=0.000, max=479.000, flat=0.000, fuzz=0.000, resolution=0.000
>       PRESSURE: source=0x0000d002, min=0.000, max=1.000, flat=0.000, fuzz=0.000, resolution=0.000
>     Touch Input Mapper:
>       Parameters:
>         GestureMode: spots
>         DeviceType: touchScreen
>         AssociatedDisplay: hasAssociatedDisplay=true, isExternal=false
>         OrientationAware: true
>       Raw Touch Axes:
>         X: min=0, max=800, flat=0, fuzz=0, resolution=0
>         Y: min=0, max=480, flat=0, fuzz=0, resolution=0
>         Pressure: unknown range
>         TouchMajor: unknown range
>         TouchMinor: unknown range
>         ToolMajor: unknown range
>         ToolMinor: unknown range
>         Orientation: unknown range
>         Distance: unknown range
>         TiltX: unknown range
>         TiltY: unknown range
>         TrackingId: min=0, max=65535, flat=0, fuzz=0, resolution=0
>         Slot: min=0, max=4, flat=0, fuzz=0, resolution=0
>       Calibration:
>         touch.size.calibration: none
>         touch.pressure.calibration: none
>         touch.orientation.calibration: none
>         touch.distance.calibration: none
>         touch.coverage.calibration: none
>       Affine Transformation:
>         X scale: 1.000
>         X ymix: 0.000
>         X offset: 0.000
>         Y xmix: 0.000
>         Y scale: 1.000
>         Y offset: 0.000
>       Viewport: displayId=0, orientation=0, logicalFrame=[0, 0, 800, 480], physicalFrame=[0, 0, 800, 480], deviceSize=[800, 480]
>       SurfaceWidth: 800px
>       SurfaceHeight: 480px
>       SurfaceLeft: 0
>       SurfaceTop: 0
>       SurfaceOrientation: 0
>       Translation and Scaling Factors:
>         XTranslate: 0.000
>         YTranslate: 0.000
>         XScale: 0.999
>         YScale: 0.998
>         XPrecision: 1.001
>         YPrecision: 1.002
>         GeometricScale: 0.998
>         PressureScale: 0.000
>         SizeScale: 0.000
>         OrientationScale: 0.000
>         DistanceScale: 0.000
>         HaveTilt: false
>         TiltXCenter: 0.000
>         TiltXScale: 0.000
>         TiltYCenter: 0.000
>         TiltYScale: 0.000
>       Last Raw Button State: 0x00000000
>       Last Raw Touch: pointerCount=0
>       Last Cooked Button State: 0x00000000
>       Last Cooked Touch: pointerCount=0
>       Stylus Fusion:
>         ExternalStylusConnected: true
>         External Stylus ID: -1
>         External Stylus Data Timeout: 9223372036854775807
>       External Stylus State:
>         When: 9223372036854775807
>         Pressure: 0.000000
>         Button State: 0x00000000
>         Tool Type: 0
>   Configuration:
>     ExcludedDeviceNames: []
>     VirtualKeyQuietTime: 0.0ms
>     PointerVelocityControlParameters: scale=1.000, lowThreshold=500.000, highThreshold=3000.000, acceleration=3.000
>     WheelVelocityControlParameters: scale=1.000, lowThreshold=15.000, highThreshold=50.000, acceleration=4.000
>     PointerGesture:
>       Enabled: true
>       QuietInterval: 100.0ms
>       DragMinSwitchSpeed: 50.0px/s
>       TapInterval: 150.0ms
>       TapDragInterval: 300.0ms
>       TapSlop: 20.0px
>       MultitouchSettleInterval: 100.0ms
>       MultitouchMinDistance: 15.0px
>       SwipeTransitionAngleCosine: 0.3
>       SwipeMaxWidthRatio: 0.2
>       MovementSpeedRatio: 0.8
>       ZoomSpeedRatio: 0.3
> Input Dispatcher State:
>   DispatchEnabled: 1
>   DispatchFrozen: 0



 
> 
> [32mINF[39m/device:plugins:service 9534 [192.168.102.20:5555] Launching agent
> [32mINF[39m/device:plugins:service 9534 [192.168.102.20:5555] Agent says: "Listening on @stfagent"
> [32mINF[39m/device:plugins:service 9534 [192.168.102.20:5555] Launching service
> [32mINF[39m/device:plugins:service 9534 [192.168.102.20:5555] Agent says: "InputClient started"
> [32mINF[39m/device:plugins:display 9534 [192.168.102.20:5555] Reading display info
> [32mINF[39m/device:plugins:phone 9534 [192.168.102.20:5555] Fetching phone info
> [32mINF[39m/provider 9463 [*] Providing 0 of 1 device(s); waiting for "192.168.102.20:5555"
> [32mINF[39m/device:plugins:identity 9534 [192.168.102.20:5555] Solving identity
> [32mINF[39m/device:plugins:solo 9534 [192.168.102.20:5555] Subscribing to permanent channel "c74jdStqmG+oGQiuHsVFN5JbloI="
> [32mINF[39m/device:plugins:screen:stream 9534 [192.168.102.20:5555] Starting WebSocket server on port 7400
> [33mWRN[39m/device:plugins:data 9534 [192.168.102.20:5555] Unable to find device data { serial: '192.168.102.20:5555',
>   platform: 'Android',
>   manufacturer: 'HARDKERNEL CO., LTD.',
>   operator: null,
>   model: 'C2',
>   version: '6.0.1',
>   abi: 'armeabi-v7a',
>   sdk: '23',
>   product: 'odroidc2',
>   display: 
>    { id: 0,
>      width: 800,
>      height: 480,
>      xdpi: 160,
>      ydpi: 160.42100524902344,
>      fps: 60.000003814697266,
>      density: 1,
>      rotation: 0,
>      secure: true,
>      size: 5.8269051128633444,
>      url: 'ws://192.168.102.10:7400' },
>   phone: { network: 'UNKNOWN' } }
> [32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] Touch origin is top left
> [32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] Requesting touch consumer to start
> [32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] Launching screen service
> [32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] Connecting to minitouch service
> [32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] minitouch says: "Note: device /dev/input/mouse2 is not supported by libevdev"
> [32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
> [32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
> [32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
> **[32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] minitouch says: "Type B touch device RPI_TOUCH By ZH851 (800x480 with 5 contacts) detected on /dev/input/event6 (score 1100)"**
> **[32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] Reading minitouch banner**
> **[32mINF[39m/device:plugins:touch 9534 [192.168.102.20:5555] minitouch says: "Connection established"**
> [32mINF[39m/device:plugins:vnc 9534 [192.168.102.20:5555] Starting VNC server on port 7402
> [32mINF[39m/device:plugins:browser 9534 [192.168.102.20:5555] Loading browser list
> [32mINF[39m/device:plugins:browser 9534 [192.168.102.20:5555] Updating browser list
> [32mINF[39m/device:plugins:mute 9534 [192.168.102.20:5555] Will not mute master volume during use
> [32mINF[39m/device:plugins:forward 9534 [192.168.102.20:5555] Launching reverse port forwarding service
> [32mINF[39m/device:plugins:forward 9534 [192.168.102.20:5555] Connecting to reverse port forwarding service
> [32mINF[39m/device:plugins:connect 9534 [192.168.102.20:5555] Listening on port 7401
> [32mINF[39m/device 9534 [192.168.102.20:5555] Fully operational
> [32mINF[39m/provider 9463 [*] Providing all 1 device(s)
 

I plant use more then 100 devices and I can't use 100 touchscreens. I think about virtual touchscreen, but I don't have any idea how to do it. Any idea ? I use Git repository: https://github.com/LoCorVin/minitouch.git

**root@OpenSTF:~/git/minitouch#** adb connect 192.168.102.20:5555
connected to 192.168.102.20:5555

**root@OpenSTF:~/git/minitouch#** ./run.sh
\+ /home/user/Android/Sdk/ndk-bundle/ndk-build
[arm64-v8a] Compile        : minitouch-common <= minitouch.c
[arm64-v8a] StaticLibrary  : libminitouch-common.a
[arm64-v8a] Compile        : evdev <= libevdev.c
[arm64-v8a] Compile        : evdev <= libevdev-names.c
[arm64-v8a] StaticLibrary  : libevdev.a
[arm64-v8a] Executable     : minitouch
[arm64-v8a] Install        : minitouch => libs/arm64-v8a/minitouch
[arm64-v8a] Executable     : minitouch-nopie
[arm64-v8a] Install        : minitouch-nopie => libs/arm64-v8a/minitouch-nopie
[x86_64] Compile        : minitouch-common <= minitouch.c
[x86_64] StaticLibrary  : libminitouch-common.a
[x86_64] Compile        : evdev <= libevdev.c
[x86_64] Compile        : evdev <= libevdev-names.c
[x86_64] StaticLibrary  : libevdev.a
[x86_64] Executable     : minitouch
[x86_64] Install        : minitouch => libs/x86_64/minitouch
[x86_64] Executable     : minitouch-nopie
[x86_64] Install        : minitouch-nopie => libs/x86_64/minitouch-nopie
[mips64] Compile        : minitouch-common <= minitouch.c
[mips64] StaticLibrary  : libminitouch-common.a
[mips64] Compile        : evdev <= libevdev.c
[mips64] Compile        : evdev <= libevdev-names.c
[mips64] StaticLibrary  : libevdev.a
[mips64] Executable     : minitouch
[mips64] Install        : minitouch => libs/mips64/minitouch
[mips64] Executable     : minitouch-nopie
[mips64] Install        : minitouch-nopie => libs/mips64/minitouch-nopie
[armeabi-v7a] Compile thumb  : minitouch-common <= minitouch.c
[armeabi-v7a] StaticLibrary  : libminitouch-common.a
[armeabi-v7a] Compile thumb  : evdev <= libevdev.c
[armeabi-v7a] Compile thumb  : evdev <= libevdev-names.c
[armeabi-v7a] StaticLibrary  : libevdev.a
[armeabi-v7a] Executable     : minitouch
[armeabi-v7a] Install        : minitouch => libs/armeabi-v7a/minitouch
[armeabi-v7a] Executable     : minitouch-nopie
[armeabi-v7a] Install        : minitouch-nopie => libs/armeabi-v7a/minitouch-nopie
[armeabi] Compile thumb  : minitouch-common <= minitouch.c
[armeabi] StaticLibrary  : libminitouch-common.a
[armeabi] Compile thumb  : evdev <= libevdev.c
[armeabi] Compile thumb  : evdev <= libevdev-names.c
[armeabi] StaticLibrary  : libevdev.a
[armeabi] Executable     : minitouch
[armeabi] Install        : minitouch => libs/armeabi/minitouch
[armeabi] Executable     : minitouch-nopie
[armeabi] Install        : minitouch-nopie => libs/armeabi/minitouch-nopie
[x86] Compile        : minitouch-common <= minitouch.c
[x86] StaticLibrary  : libminitouch-common.a
[x86] Compile        : evdev <= libevdev.c
[x86] Compile        : evdev <= libevdev-names.c
[x86] StaticLibrary  : libevdev.a
[x86] Executable     : minitouch
[x86] Install        : minitouch => libs/x86/minitouch
[x86] Executable     : minitouch-nopie
[x86] Install        : minitouch-nopie => libs/x86/minitouch-nopie
[mips] Compile        : minitouch-common <= minitouch.c
[mips] StaticLibrary  : libminitouch-common.a
[mips] Compile        : evdev <= libevdev.c
[mips] Compile        : evdev <= libevdev-names.c
[mips] StaticLibrary  : libevdev.a
[mips] Executable     : minitouch
[mips] Install        : minitouch => libs/mips/minitouch
[mips] Executable     : minitouch-nopie
[mips] Install        : minitouch-nopie => libs/mips/minitouch-nopie
\+\+ adb shell getprop ro.product.cpu.abi
\+\+ tr -d '\r'
\+ abi=armeabi-v7a
\+\+ adb shell getprop ro.build.version.sdk
\+\+ tr -d '\r'
\+ sdk=23
\+ (( 23 >= 16 ))
\+ bin=minitouch
\+ adb push libs/armeabi-v7a/minitouch /data/local/tmp/
430 KB/s (34320 bytes in 0.077s)
\+ adb shell /data/local/tmp/minitouch
**Note: device /dev/input/mice is not supported by libevdev
Note: device /dev/input/mouse1 is not supported by libevdev
Note: device /dev/input/mouse0 is not supported by libevdev
Unable to find a suitable touch device**
root@OpenSTF:~/git/minitouch#

Didn't help :(

Any ideas ? What can I do more ?  @d0c3ntOS Hello, have you found any solution? I fell into similar issue... I have a similar problem on ODROID C2 when trying to connect to it. I can get Minicap to stream on one device, but not OpenSTF. Is there a way to disable the  minitouch feature? I have already tried to comment code here 'https://github.com/openstf/stf/blob/badb3ed3be5d1b5cf889ad61244c3ca1a4fc6de5/lib/units/device/index.js#L31', but unfortunately it did not help..  @	d0c3ntOS 

I also encountered the same problem with you.
My device does not have a touch screen.
error is Unable to find a suitable touch device。
I have already solved。
Find out the device's initialization code and modify it.

 @xingkong130 , what part of the device initialization code did you modify, and on what device, and android version?  Hi,

I am trying to set up an STF-Server using your Deployment-doc. I can log in, but there are no devices shown. Doesn't matter which device I try to connect. In addition after some time the screen on the stf-dashboard shows "Disconnected"

stf local works just fine.

Following I have the stf-providers log.

> INF/device:plugins:touch 25 [03157df3694e4d1f] Touch origin is top left
INF/device:plugins:touch 25 [03157df3694e4d1f] Requesting touch consumer to start
INF/device:plugins:touch 25 [03157df3694e4d1f] Launching screen service
INF/device:plugins:touch 25 [03157df3694e4d1f] Connecting to minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Reading minitouch banner
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "Type B touch device sec_touchscreen (4095x4095 with 10 contacts) detected on /dev/input/event1 (score 2100)"
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "binding socket: Address already in use"
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "Unable to start server on minitouch"
WRN/device:plugins:touch 25 [03157df3694e4d1f] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25 [03157df3694e4d1f] Disconnecting from minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Stopping minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Launching screen service
INF/device:plugins:touch 25 [03157df3694e4d1f] Connecting to minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Reading minitouch banner
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "Type B touch device sec_touchscreen (4095x4095 with 10 contacts) detected on /dev/input/event1 (score 2100)"
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "binding socket: Address already in use"
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "Unable to start server on minitouch"
WRN/device:plugins:touch 25 [03157df3694e4d1f] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25 [03157df3694e4d1f] Disconnecting from minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Stopping minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Launching screen service
INF/device:plugins:touch 25 [03157df3694e4d1f] Connecting to minitouch service
INF/provider 1 [*] Providing 0 of 1 device(s); waiting for INF/device:plugins:touch 25 [03157df3694e4d1f] Touch origin is top left
INF/device:plugins:touch 25 [03157df3694e4d1f] Requesting touch consumer to start
INF/device:plugins:touch 25 [03157df3694e4d1f] Launching screen service
INF/device:plugins:touch 25 [03157df3694e4d1f] Connecting to minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Reading minitouch banner
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "Type B touch device sec_touchscreen (4095x4095 with 10 contacts) detected on /dev/input/event1 (score 2100)"
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "binding socket: Address already in use"
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "Unable to start server on minitouch"
WRN/device:plugins:touch 25 [03157df3694e4d1f] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25 [03157df3694e4d1f] Disconnecting from minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Stopping minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Launching screen service
INF/device:plugins:touch 25 [03157df3694e4d1f] Connecting to minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Reading minitouch banner
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "Type B touch device sec_touchscreen (4095x4095 with 10 contacts) detected on /dev/input/event1 (score 2100)"
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "binding socket: Address already in use"
INF/device:plugins:touch 25 [03157df3694e4d1f] minitouch says: "Unable to start server on minitouch"
WRN/device:plugins:touch 25 [03157df3694e4d1f] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 25 [03157df3694e4d1f] Disconnecting from minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Stopping minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Launching screen service
INF/device:plugins:touch 25 [03157df3694e4d1f] Connecting to minitouch service
INF/provider 1 [*] Providing 0 of 1 device(s); waiting for "03157df3694e4d1f"
INF/device:plugins:touch 25 [03157df3694e4d1f] Disconnecting from minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Stopping minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Ending minitouch I/O as a last resort
FTL/device 25 [03157df3694e4d1f] Setup had an error TimeoutError: operation timed out
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)
FTL/util:lifecycle 25 [03157df3694e4d1f] Shutting down due to fatal error
INF/provider 1 [*] Cleaning up device worker "03157df3694e4d1f"
ERR/provider 1 [*] Device worker "03157df3694e4d1f" died with code 1
INF/provider 1 [*] Restarting device worker "03157df3694e4d1f"
INF/device:support:push 37 [03157df3694e4d1f] Sending output to "tcp://172.17.0.1:7270"
INF/device 37 [03157df3694e4d1f] Preparing device
INF/device:support:sub 37 [03157df3694e4d1f] Receiving input from "tcp://172.17.0.1:7250"
INF/device:support:sub 37 [03157df3694e4d1f] Subscribing to permanent channel "*ALL"
INF/provider 1 [*] Providing 0 of 1 device(s); waiting for "03157df3694e4d1f"
"03157df3694e4d1f"
INF/device:plugins:touch 25 [03157df3694e4d1f] Disconnecting from minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Stopping minitouch service
INF/device:plugins:touch 25 [03157df3694e4d1f] Ending minitouch I/O as a last resort
FTL/device 25 [03157df3694e4d1f] Setup had an error TimeoutError: operation timed out
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)
FTL/util:lifecycle 25 [03157df3694e4d1f] Shutting down due to fatal error
INF/provider 1 [*] Cleaning up device worker "03157df3694e4d1f"
ERR/provider 1 [*] Device worker "03157df3694e4d1f" died with code 1
INF/provider 1 [*] Restarting device worker "03157df3694e4d1f"
INF/device:support:push 37 [03157df3694e4d1f] Sending output to "tcp://172.17.0.1:7270"
INF/device 37 [03157df3694e4d1f] Preparing device
INF/device:support:sub 37 [03157df3694e4d1f] Receiving input from "tcp://172.17.0.1:7250"
INF/device:support:sub 37 [03157df3694e4d1f] Subscribing to permanent channel "*ALL"
INF/provider 1 [*] Providing 0 of 1 device(s); waiting for "03157df3694e4d1f"

What might be the problem here? Ok, sorry for removing the template. The devices in question are a Samsung A5, Samsung S6 and Sony Z1c.

I realized I've been running two instances of the provider.

Now I still cannot see my devices in the dashboard, though the provider says it is there:

> INF/provider 1 [*] Subscribing to permanent channel "IZHDwa0WR36+wRjTY+xEOw=="
INF/provider 1 [*] Sending output to "tcp://172.17.0.1:7270"
INF/provider 1 [*] Receiving input from "tcp://172.17.0.1:7250"
INF/provider 1 [*] Tracking devices
INF/provider 1 [*] Found device "03157df3694e4d1f" (offline)
INF/provider 1 [*] Registered device "03157df3694e4d1f"
INF/provider 1 [*] Providing all 0 of 1 device(s); ignoring "03157df3694e4d1f"
INF/provider 1 [*] Lost device "03157df3694e4d1f" (offline)
INF/provider 1 [*] Found device "03157df3694e4d1f" (offline)
INF/provider 1 [*] Registered device "03157df3694e4d1f"
INF/provider 1 [*] Providing all 0 of 1 device(s); ignoring "03157df3694e4d1f"
INF/provider 1 [*] Lost device "03157df3694e4d1f" (offline)
INF/provider 1 [*] Found device "03157df3694e4d1f" (offline)
INF/provider 1 [*] Registered device "03157df3694e4d1f"
INF/provider 1 [*] Device "03157df3694e4d1f" is now "device" (was "offline")
INF/device:support:push 14 [03157df3694e4d1f] Sending output to "tcp://172.17.0.1:7270"
INF/device 14 [03157df3694e4d1f] Preparing device
INF/device:support:sub 14 [03157df3694e4d1f] Receiving input from "tcp://172.17.0.1:7250"
INF/device:support:sub 14 [03157df3694e4d1f] Subscribing to permanent channel "*ALL"
INF/device:support:properties 14 [03157df3694e4d1f] Loading properties
INF/device:support:sdk 14 [03157df3694e4d1f] Supports SDK 23
INF/device:support:abi 14 [03157df3694e4d1f] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:minicap 14 [03157df3694e4d1f] Installing "/app/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/bin/minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 14 [03157df3694e4d1f] Installing "/app/node_modules/minicap-prebuilt/prebuilt/arm64-v8a/lib/android-23/minicap.so" as "/data/local/tmp/minicap.so"
INF/device:resources:service 14 [03157df3694e4d1f] Checking whether we need to install STFService
INF/device:resources:service 14 [03157df3694e4d1f] Running version check
INF/device:resources:service 14 [03157df3694e4d1f] STFService up to date
INF/device:plugins:service 14 [03157df3694e4d1f] Launching agent
INF/device:plugins:service 14 [03157df3694e4d1f] Agent says: "Listening on @stfagent"
INF/device:plugins:service 14 [03157df3694e4d1f] Launching service
INF/device:plugins:service 14 [03157df3694e4d1f] Agent says: "InputClient started"

The reapers logs say:

> stf@stf-1:~$ sudo docker logs stf-reaper
INF/reaper 1 [dev] Subscribing to permanent channel "*ALL"
INF/reaper 1 [dev] Reaping devices with no heartbeat
INF/db 1 [dev] Connecting to 172.17.0.6:28015
INF/reaper 1 [dev] Receiving input from "tcp://172.17.0.1:7150"
INF/reaper 1 [dev] Sending output to "tcp://172.17.0.1:7270"
INF/reaper 1 [dev] Device "03157df3694e4d1f" is present
INF/reaper 1 [dev] Reaping device "03157df3694e4d1f" due to heartbeat timeout
INF/reaper 1 [dev] Device "03157df3694e4d1f" is present
INF/reaper 1 [dev] Device "03157df3694e4d1f" is present
  I have experienced this error many times, it caused the websocket to exit, what's reason for this?

INF/util:datautil 1 [*] Device database does not have an entry for "123456789ABCD" (model "R7t"/"R7t"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 1 [*] Device database does not have an entry for "123456789ABCD" (model "R7t"/"R7t"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 1 [*] Device database does not have an entry for "123456789ABCD" (model "R7t"/"R7t"). This is not an error, it only means that we don't have data for it yet.
INF/util:datautil 1 [*] Device database does not have an entry for "123456789ABCD" (model "R7t"/"R7t"). This is not an error, it only means that we don't have data for it yet.
buffer.js:11
    super(arg1, arg2, arg3);
    ^

RangeError: Maximum call stack size exceeded
    at Buffer.Uint8Array (native)
    at FastBuffer (buffer.js:11:5)
    at Buffer.slice (buffer.js:811:10)
    at fromString (buffer.js:204:21)
    at Function.Buffer.from (buffer.js:99:12)
    at new Buffer (buffer.js:80:17)
    at Sender.frameAndSend (/app/node_modules/engine.io/node_modules/ws/lib/Sender.js:166:14)
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:126:12
    at Sender.applyExtensions (/app/node_modules/engine.io/node_modules/ws/lib/Sender.js:287:5)
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:120:10
    at Sender.flush (/app/node_modules/engine.io/node_modules/ws/lib/Sender.js:268:3)
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:270:10
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:127:7
    at Sender.applyExtensions (/app/node_modules/engine.io/node_modules/ws/lib/Sender.js:287:5)
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:120:10
    at Sender.flush (/app/node_modules/engine.io/node_modules/ws/lib/Sender.js:268:3)
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:270:10
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:127:7
    at Sender.applyExtensions (/app/node_modules/engine.io/node_modules/ws/lib/Sender.js:287:5)
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:120:10
    at Sender.flush (/app/node_modules/engine.io/node_modules/ws/lib/Sender.js:268:3)
    at /app/node_modules/engine.io/node_modules/ws/lib/Sender.js:270:10 when stf run several days or several weeks, this error occurs, I know it is there for information purposes, but it does lead the websocket exited many times, I guess there is a buffer to small, I don't know which one. @sorccuI, I finally found this is a bug in older versions of websocket, It's just a coincidence when it appear together with datautil's log, is there any plan to upgrade websocket to a newer version? This is the origin bug of websocket, https://github.com/websockets/ws/issues/758 Yeah, I had upgrade socket.io to 2.0.2 which depends on engine.io@3.1.0, and engine.io@3.1.0 depends on ws@2.3.1, It worked fine for several days, but I'm not sure if there will be problems a few weeks later.  I am successfully running stf local and stf local --public-ip commands to view and control my android devices using a raspberry pi. What I plan to do is have such multiple Raspberry Pis connected to a central server such that now I can access all my devices from anywhere and not just my local IP. I have checked the Deployment.md files. However can I use multiple Providers and still connect to STF such that post login I can view all the *x* number of devices connected over *n* number of Raspberry Pis. What I intend to achieve is have multiple such Raspberry Pis sitting at different locations which connect to a central server for access from anywhere. Can this really be achieved using the STF Deployment strategy? This would work where I have all my android devices connected to a single Raspberry Pi. What if I have a single android device connected to each Raspberry Pi and now I want to access them centrally? What all services should I be deploying on the Raspberry Pi and what should I be running on the server?  I modify control-device.js 

      var deviceControlArray = new Array()
      if (deviceControlArray.length == 0)
      {
        var devices = "";
        devices = oboe('/api/v1/devices')
        devices.node('devices[*]', function(device) {
         if (device.present)
          {
            deviceControlArray.push(device.channel)
          }
       })
     }

to get all devices
then modify sendOneWay method

      function sendOneWay(action, data) {
        deviceControlArray.forEach(function(channel)
        {
            socket.emit(action, channel, data)
          
        })
    }

now, I plug 2 devices on pc. When I touch/move device A on screen，device B on screen and real devices all move. But when I touch/move real device A, just device A on screen move, device B does not move. what do I modify to move all devices when I move real device?
thanks very much!  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
The STF api [docs](https://github.com/openstf/stf/blob/master/doc/API.md) refer to v2 of swagger-js.  `npm i swagger-js` installs v3 of swagger-js and has breaking changes.  The swagger-js migration [document](https://github.com/swagger-api/swagger-js/blob/master/docs/MIGRATION_2_X.md) helps, but I ran into an issue that may require changes to STF's Swagger spec (& implementation?).

The STF Swagger Spec does not explicitly set `content-type` for empty POST requests.   Invoking swagger-js omits the `content-type` header for the operations where the device serial number serializes into the path. 

`client.apis.user.remoteConnectUserDeviceBySerial( { 'serial': '1234' })` 
becomes a POST against `/user/devices/1234/remoteConnect` with no body or content-type

On STF api service, the `content-type` is inferred as `application/octet-stream`, which does not conform to the swagger spec, and the request fails.   Can reproduce from swagger-js or from curl commands

swagger-js should (IMHO) follow the spec.  If the global `content-type` is specified in the `consumes` array of the swagger [spec](https://raw.githubusercontent.com/openstf/stf/master/lib/units/api/swagger/api_v1_generated.json) then swagger should use it [swagger-js issue 1022](https://github.com/swagger-api/swagger-js/issues/1022).  

That said the STF Swagger Spec (/implementation?) should be more precise and allow empty POST bodies where appropriate.  This would conform to RFC and fix the issue.


**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

n/a

**Please provide the steps to reproduce the issue.**
Using curl, reserve the device, and send remoteConnect with no content-type specified
```
curl -X POST --header "Content-Type: application/json" --data '{"serial":"SERIAL"}' -H "Authorization: Bearer BEARER_TOKEN " http://ENDPOINT:7100/api/v1/user/devices

{"success":true,"description":"Device successfully added"}

curl -X POST  -H "Authorization: Bearer BEARER_TOKEN " http://ENDPOINT:7100/api/v1/user/devices/SERIAL/remoteConnect

{"message":"Validation errors","errors":[{"code":"INVALID_CONTENT_TYPE","message":"Invalid Content-Type (application/octet-stream).  These are supported: application/json","path":[]}]}

```

It works if the content-type header is specified (erroneously as there is no content):
```
curl -X POST --header "Content-Type: application/json" -H "Authorization: Bearer BEARER_TOKEN" http: //ENDPOINT:7100/api/v1/user/devices/SERIAL/remoteConnect

{"success":true,"remoteConnectUrl":"ENDPOINT:7461"}
```

Swagger v3 does not expose the ability to explicitly set `content-type` on a per-request basis. 


**What is the expected behavior?**

Per [S.O. on RFC-7231](http://stackoverflow.com/a/28652339) when there is no content-type provided `application/octet-stream` may be inferred.    The STF Swagger spec should be updated to allow empty POST / default content-type

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

n/a

**Please run `stf doctor` and paste the output here.**

assuming unrelated failures:
```
CI:~ ciuser$ stf doctor
INF/util:doctor 21707 [*] OS Arch: x64
INF/util:doctor 21707 [*] OS Platform: darwin
INF/util:doctor 21707 [*] OS Platform: 16.5.0
INF/util:doctor 21707 [*] Using Node 6.10.2
INF/util:doctor 21707 [*] Using RethinkDB client 2.3.3
INF/util:doctor 21707 [*] Using ZeroMQ 4.2.2
INF/util:doctor 21707 [*] GraphicsMagick 1.3.25
INF/util:doctor 21707 [*] Local RethinkDB server 2.3.5
INF/util:doctor 21707 [*] Local ADB 1.0.39
Installed as /usr/local/Cellar/android-sdk/24.4.1_1/platform-tools/adb

/Users/ciuser/.nvm/versions/node/v6.10.2/lib/node_modules/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 1.0.39
Installed as /usr/local/Cellar/android-sdk/24.4.1_1/platform-tools/adb

    at new SemVer (/Users/ciuser/.nvm/versions/node/v6.10.2/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/Users/ciuser/.nvm/versions/node/v6.10.2/lib/node_modules/stf/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/Users/ciuser/.nvm/versions/node/v6.10.2/lib/node_modules/stf/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/Users/ciuser/.nvm/versions/node/v6.10.2/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /Users/ciuser/.nvm/versions/node/v6.10.2/lib/node_modules/stf/lib/util/doctor.js:143:7
    at /Users/ciuser/.nvm/versions/node/v6.10.2/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:195:7)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at maybeClose (internal/child_process.js:886:16)
    at Socket.<anonymous> (internal/child_process.js:342:11)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at Pipe._handle.close [as _onclose] (net.js:501:12)
``` Will fix this next weekend. Thanks for reporting.  Hi, I've already installed the swagger-client@3.1.1 but I want to change to the older version. I'm pretty new at this, how can i do it? Thanks a lot in advance  Recents/app switch key added to improve interacting with devices which don't display navigation bar (like HTC 10). 👍     <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

Setting AUTHKEY in rethinkDB using the command mentioned in Deployment document throws error

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**
1. Start rethinkDB 2.3
2. go to localhost:8080
3. Enter command `r.db('rethinkdb').table('cluster_config').get('auth').update({auth_key: '12345'})`
Error message as shown below will be thrown 

```

{
"deleted": 0 ,
"errors": 1 ,
"first_error":  "It's illegal to delete rows from the `rethinkdb.cluster_config` table." ,
"inserted": 0 ,
"replaced": 0 ,
"skipped": 0 ,
"unchanged": 0
}
```

**What is the expected behavior?**

AUTHKEY should be set

Based on [this issue here](https://github.com/GoRethink/gorethink/issues/302) it looks like they updated the feature and it's not longer available
**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 Hi, I've encountered this error as well.
The docs are a bit outdated on this topic.

I've created a pull request for a doc update [here]
(https://github.com/openstf/stf/pull/526)  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Setup had an error Error: Local socket "localabstract:stfagent" should be unused

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
This issue happens on two of my android device.

**What is the expected behavior?**
I want to control my android device on the webpage and then, i got an pop-up window: "Disconnected".
but the device status is "use".

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
INF/provider 8868 [*] Restarting device worker "8da3b45"
INF/device:plugins:service 8697 [8da3b45] Agent says: "InputClient closing"
INF/device:support:push 31614 [8da3b45] Sending output to "tcp://127.0.0.1:7116"
INF/device 31614 [8da3b45] Preparing device
INF/device:support:sub 31614 [8da3b45] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 31614 [8da3b45] Subscribing to permanent channel "*ALL"
INF/device:support:properties 31614 [8da3b45] Loading properties
INF/device:support:abi 31614 [8da3b45] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:service 31614 [8da3b45] Checking whether we need to install STFService
INF/device:resources:service 31614 [8da3b45] Running version check
INF/device:resources:service 31614 [8da3b45] STFService up to date
INF/device:plugins:service 31614 [8da3b45] Launching agent
INF/device:plugins:service 8697 [8da3b45] Agent says: "InputClient started"
FTL/device 31614 [8da3b45] Setup had an error Error: Local socket "localabstract:stfagent" should be unused
    at /usr/local/lib/node_modules/stf/lib/util/devutil.js:16:13
    at tryCatcher (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Promise._settlePromiseFromHandler (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:503:31)
    at Promise._settlePromiseAt (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:577:18)
    at Async._drainQueue (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:128:12)
    at Async._drainQueues (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:133:10)
    at Immediate.Async.drainQueues (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:15:14)
    at runCallback (timers.js:666:20)
    at tryOnImmediate (timers.js:639:5)
    at processImmediate [as _immediateCallback] (timers.js:611:5)
FTL/util:lifecycle 31614 [8da3b45] Shutting down due to fatal error
INF/provider 8868 [*] Cleaning up device worker "8da3b45"
ERR/provider 8868 [*] Device worker "8da3b45" died with code 1

**Please run `stf doctor` and paste the output here.**
INF/util:doctor 2041 [*] OS Arch: x64
INF/util:doctor 2041 [*] OS Platform: linux
INF/util:doctor 2041 [*] OS Platform: 4.4.0-47-generic
INF/util:doctor 2041 [*] Using Node 6.10.2
INF/util:doctor 2041 [*] Using RethinkDB client 2.3.3
INF/util:doctor 2041 [*] Using ZeroMQ 4.1.2
INF/util:doctor 2041 [*] Local ADB 1.0.36

INF/util:doctor 2041 [*] Local RethinkDB server 2.3.5~0trusty
/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 2.3.5~0trusty
    at new SemVer (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/usr/local/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /usr/local/lib/node_modules/stf/lib/util/doctor.js:95:7
    at /usr/local/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:195:7)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at maybeClose (internal/child_process.js:886:16)
    at Socket.<anonymous> (internal/child_process.js:342:11)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at Pipe._handle.close [as _onclose] (net.js:501:12)
 Thank you for answering me so quickly！！
But I can't find another STF process is running... terrible question..
 Yes, I'm using --allow-remote option, but I'm not adding any device to STF with 'adb connect',
maybe another process is using adb? I will check it.. After reboot PC, STF is OK now...   I installed UBUNTU16.0.4 on a virtual machine.
Nodejs -v 6.10.2
npm -v 3.10.10

Zeromq  I have installed，but there is still a problem。Would you mind helping me find the problem?
I thank you very much。

stf local
/usr/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/compiled/6.10.2/linux/x64/zmq.node
    at bindings (/usr/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.require (module.js:497:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.require (module.js:497:17)


 Reinstall zmq  and remove the node_modules at stf path. Do "npm install && npm" link again @0x88l  I'm sorry to reply you so late, I've tried this method.
I reinstall the ZMQ, deleted node_modules. do npm install && npm again.

zmq -v 4.1.4

liuchang@ubuntu:/usr/local/lib$ sudo rm -rf node_modules/

npm install && npm
npm WARN yes@3.10.10 No repository field.

Usage: npm <command>

where <command> is one of:
    access, adduser, bin, bugs, c, cache, completion, config,
    ddp, dedupe, deprecate, dist-tag, docs, edit, explore, get,
    help, help-search, i, init, install, install-test, it, link,
    list, ln, login, logout, ls, outdated, owner, pack, ping,
    prefix, prune, publish, rb, rebuild, repo, restart, root,
    run, run-script, s, se, search, set, shrinkwrap, star,
    stars, start, stop, t, tag, team, test, tst, un, uninstall,
    unpublish, unstar, up, update, v, version, view, whoami

npm <cmd> -h     quick help on <cmd>
npm -l           display full usage info
npm help <term>  search for help on <term>
npm help npm     involved overview

Specify configs in the ini-formatted file:
    /home/liuchang/.npmrc
or on the command line via: npm <command> --key value
Config info can be viewed via: npm help config

npm@3.10.10 /usr/lib/node_modules/npm

stf doctor
/usr/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/compiled/6.10.2/linux/x64/zmq.node
    at bindings (/usr/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.require (module.js:497:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.require (module.js:497:17)

Forgive me for not having experience, I really can not find a problem






 @sorccu 
liuchang@ubuntu:~$ nvm install 7.9.0
bash: [: 000000000700000000090000000000: integer expression expected
######################################################################## 100.0%
Checksums empty
Now using node v7.9.0
liuchang@ubuntu:~$ node -v
v7.9.0
liuchang@ubuntu:~$ npm -v
4.2.0
liuchang@ubuntu:~$ stf doctor
/usr/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/lib/node_modules/stf/node_modules/zmq/compiled/7.9.0/linux/x64/zmq.node
    at bindings (/usr/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)

 Follow these instructions properly. May helps, 

https://l4digital.com/wp-content/uploads/2016/11/Build-an-Android-Test-Farm-with-OpenSTF.pdf
 @vbanthia 
Thank you. It would be nice if  could solve this. For someone else with this problem using Arch Linux, [here](https://gist.github.com/franciscocpg/05d01d525aff5f34765f94121e1dc8b6) is some instructions that may help.  Where is the phone manufacturer of country?I never hear the brand. Hello everyone.

I searched for information and found that the user interface does not looks
like android and there are mentions of KaiOS created by KaiOS Technologies
Inc https://www.linkedin.com/company-beta/13291989/?pathWildcard=13291989

I think that KaiOS is based on Firefox OS

Maybe the output of this commands helps to identify the OS version

adb shell getprop
or
adb shell cat /system/build.prop

I hope it helps.
regards


2017-04-28 6:54 GMT-03:00 0x88l <notifications@github.com>:

> Where is the phone manufacturer?I never hear the brand.
>
> —
> You are receiving this because you are subscribed to this thread.
> Reply to this email directly, view it on GitHub
> <https://github.com/openstf/stf/issues/587#issuecomment-297958258>, or mute
> the thread
> <https://github.com/notifications/unsubscribe-auth/AAwpgdfCShdybVoX0Y8lTxP3OmkxsQ9uks5r0bdtgaJpZM4NJrKt>
> .
>
 Perfect!, it only remains to know if it is a FirefoxOS

I do not know anything about FirefoxOS, it is based on some data that I
found on the internet.

adb shell ls /data/b2g/mozilla/*.default/prefs.js

or running the ps version of b2g

adb shell b2g-ps




2017-04-28 10:11 GMT-03:00 Simo Kinnunen <notifications@github.com>:

> Thanks, that's good info. Looks like you're right, the props do mention
> KaiOS.
>
> [DEVICE_PROVISIONED]: [1]
> [audio.dolby.ds2.enabled]: [true]
> [audio.offload.buffer.size.kb]: [64]
> [audio.offload.gapless.enabled]: [true]
> [audio.offload.min.duration.secs]: [30]
> [audio.offload.video]: [true]
> [bluetooth.isEnabled]: [false]
> [cameradaemon.SaveMemAtBoot]: [1]
> [cdma.prl.version]: [55061]
> [config.disable_atlas]: [true]
> [dalvik.vm.dex2oat-Xms]: [64m]
> [dalvik.vm.dex2oat-Xmx]: [512m]
> [dalvik.vm.heapgrowthlimit]: [128m]
> [dalvik.vm.heapmaxfree]: [8m]
> [dalvik.vm.heapminfree]: [6m]
> [dalvik.vm.heapsize]: [256m]
> [dalvik.vm.heapstartsize]: [8m]
> [dalvik.vm.heaptargetutilization]: [0.75]
> [dalvik.vm.image-dex2oat-Xms]: [64m]
> [dalvik.vm.image-dex2oat-Xmx]: [64m]
> [dalvik.vm.isa.arm.features]: [default]
> [dalvik.vm.isa.arm.variant]: [cortex-a7]
> [dalvik.vm.stack-trace-file]: [/data/anr/traces.txt]
> [dalvik.vm.zygotemaxfailedboots]: [5]
> [debug.atrace.tags.enableflags]: [0]
> [debug.composition.type]: [gpu]
> [debug.egl.hw]: [1]
> [debug.hwc.dynThreshold]: [2.5]
> [debug.mdpcomp.logs]: [0]
> [debug.sf.hw]: [1]
> [debug.sf.hwc.canUseABC]: [0]
> [debug.sf.swaprect]: [0]
> [default.HwV.value]: [03]
> [dev.jrdcom.cu.ref]: [4044T-2ARXUS1-R1]
> [dev.pm.dyn_samplingrate]: [1]
> [dev.tct.handset.ref]: [SAA61U0AA10C]
> [diag.reset_handler]: [true]
> [diag_get_daemon.status]: [YES]
> [gsm.version.baseband]: [MPSS.JO.1.0.c5.1-00024-M8909EA]
> [gsm.version.ril-impl]: [Qualcomm RIL 1.0]
> [hw.sf.app_buff_count]: [3]
> [init.svc.adbd]: [running]
> [init.svc.atfwd]: [running]
> [init.svc.audiod]: [running]
> [init.svc.b2g]: [running]
> [init.svc.bms-sh]: [stopped]
> [init.svc.cnd]: [running]
> [init.svc.config-zram]: [stopped]
> [init.svc.config_bluetooth]: [stopped]
> [init.svc.debuggerd]: [running]
> [init.svc.diag_get_daemon]: [running]
> [init.svc.fakeappops]: [running]
> [init.svc.fidodaemon]: [running]
> [init.svc.flash_recovery]: [stopped]
> [init.svc.gatekeeperd]: [running]
> [init.svc.gonksched]: [running]
> [init.svc.imsdatadaemon]: [running]
> [init.svc.imsstarter]: [stopped]
> [init.svc.irsc_util]: [stopped]
> [init.svc.jrddmesgservice]: [stopped]
> [init.svc.jrdgeckologsvc]: [stopped]
> [init.svc.jrdlogcatservice]: [stopped]
> [init.svc.jrdqxdmservice]: [stopped]
> [init.svc.jrdtcpdpservice]: [stopped]
> [init.svc.keystore]: [running]
> [init.svc.loc_launcher]: [running]
> [init.svc.md_check]: [stopped]
> [init.svc.media]: [running]
> [init.svc.mverproxy]: [stopped]
> [init.svc.netd]: [running]
> [init.svc.netmgrd]: [running]
> [init.svc.nvdiag_daemon]: [running]
> [init.svc.per_mgr]: [running]
> [init.svc.perfd]: [running]
> [init.svc.play_music]: [stopped]
> [init.svc.ptt_socket_app]: [running]
> [init.svc.qcamerasvr]: [running]
> [init.svc.qcom-c_core-sh]: [stopped]
> [init.svc.qcom-c_main-sh]: [stopped]
> [init.svc.qcom-debug]: [stopped]
> [init.svc.qcom-post-boot]: [stopped]
> [init.svc.qcom-sh]: [stopped]
> [init.svc.qcom-usb-sh]: [stopped]
> [init.svc.qcomsysd]: [running]
> [init.svc.qmuxd]: [running]
> [init.svc.qseecomd]: [running]
> [init.svc.qti]: [running]
> [init.svc.qti-testscripts]: [stopped]
> [init.svc.ril-daemon]: [running]
> [init.svc.rmt_storage]: [running]
> [init.svc.root_check]: [running]
> [init.svc.servicemanager]: [running]
> [init.svc.slate_diag]: [running]
> [init.svc.tct_diag]: [running]
> [init.svc.tctd]: [running]
> [init.svc.tftp_server]: [running]
> [init.svc.thermal-engine]: [running]
> [init.svc.time_daemon]: [running]
> [init.svc.trace_util]: [stopped]
> [init.svc.ueventd]: [running]
> [init.svc.vm_bms]: [running]
> [init.svc.vold]: [running]
> [init.svc.wcnss-service]: [running]
> [init.svc.wpa_supplicant]: [running]
> [keyguard.no_require_sim]: [true]
> [media.aac_51_output_enabled]: [true]
> [media.stagefright.enable-aac]: [true]
> [media.stagefright.enable-fma2dp]: [true]
> [media.stagefright.enable-http]: [true]
> [media.stagefright.enable-player]: [true]
> [media.stagefright.enable-qcp]: [true]
> [media.stagefright.enable-scan]: [true]
> [media.stagefright.use-awesome]: [false]
> [mm.enable.qcom_parser]: [262143]
> [mmp.enable.3g2]: [true]
> [net.bt.name]: [Android]
> [net.change]: [net.dnschange]
> [net.dns1]: [REDACTED]
> [net.dns2]: [REDACTED]
> [net.dns3]: [REDACTED]
> [net.dns4]: [REDACTED
> [net.dnschange]: [148]
> [net.rmnet_data0.dns1]: [REDACTED]
> [net.rmnet_data0.dns2]: [REDACTED]
> [net.rmnet_data0.gw]: [REDACTED]
> [net.rmnet_data1.dns1]: []
> [net.rmnet_data1.dns2]: []
> [net.rmnet_data1.gw]: []
> [net.tcp.buffersize.default]: [4096,87380,524288,4096,16384,110208]
> [net.tcp.buffersize.edge]: [4093,26280,35040,4096,16384,35040]
> [net.tcp.buffersize.evdo]: [4094,87380,524288,4096,16384,262144]
> [net.tcp.buffersize.gprs]: [4092,8760,11680,4096,8760,11680]
> [net.tcp.buffersize.hsdpa]: [4094,87380,1220608,4096,16384,1220608]
> [net.tcp.buffersize.hspa]: [4094,87380,1220608,4096,16384,1220608]
> [net.tcp.buffersize.hspap]: [4094,87380,1220608,4096,16384,1220608]
> [net.tcp.buffersize.hsupa]: [4094,87380,1220608,4096,16384,1220608]
> [net.tcp.buffersize.lte]: [2097152,4194304,8388608,262144,524288,1048576]
> [net.tcp.buffersize.umts]: [4094,87380,110208,4096,16384,110208]
> [net.tcp.buffersize.wifi]: [524288,2097152,4194304,262144,524288,1048576]
> [net.tcp.default_init_rwnd]: [60]
> [nvdiag_daemon.status]: [running]
> [oma.data.keep]: [0]
> [oma.service.is_busy]: [0]
> [oma.uicc.write]: [ok]
> [persist.audio.fluence.speaker]: [false]
> [persist.audio.fluence.voicecall]: [true]
> [persist.audio.fluence.voicerec]: [false]
> [persist.camera.longshot.stages]: [1]
> [persist.chameleon.package.path]: [/carrier/chameleon.zip]
> [persist.cne.feature]: [4]
> [persist.data.mode]: [concurrent]
> [persist.data.netmgrd.qos.enable]: [true]
> [persist.debug.wfd.enable]: [0]
> [persist.demo.hdmirotationlock]: [false]
> [persist.device.first.startup]: [1]
> [persist.env.fastdorm.enabled]: [true]
> [persist.gps.qc_nlp_in_use]: [1]
> [persist.hiddenMenu.update]: [false]
> [persist.hwc.enable_vds]: [1]
> [persist.ims.regitered]: [0]
> [persist.isptcrb]: [false]
> [persist.loc.nlp_name]: [com.qualcomm.location]
> [persist.mm.sta.enable]: [1]
> [persist.qcril.datacall.miperror]: [0]
> [persist.radio.adb_log_on]: [0]
> [persist.radio.airplane_mode_on]: [0]
> [persist.radio.apm_sim_not_pwdn]: [1]
> [persist.radio.custom_ecc]: [0]
> [persist.radio.data_no_toggle]: [1]
> [persist.radio.eons.enabled]: [false]
> [persist.radio.nitz_lons_0_0]: [Sprint]
> [persist.radio.nitz_lons_1_0]: []
> [persist.radio.nitz_lons_2_0]: []
> [persist.radio.nitz_lons_3_0]: []
> [persist.radio.nitz_plmn_0]: [310 120]
> [persist.radio.nitz_sons_0_0]: [SPRINT]
> [persist.radio.nitz_sons_1_0]: []
> [persist.radio.nitz_sons_2_0]: []
> [persist.radio.nitz_sons_3_0]: []
> [persist.radio.ril_payload_on]: [0]
> [persist.radio.sglte_target]: [0]
> [persist.radio.sib16_support]: [1]
> [persist.radio.snapshot_enabled]: [0]
> [persist.rild.nitz_long_ons_0]: []
> [persist.rild.nitz_long_ons_1]: []
> [persist.rild.nitz_long_ons_2]: []
> [persist.rild.nitz_long_ons_3]: []
> [persist.rild.nitz_plmn]: []
> [persist.rild.nitz_short_ons_0]: []
> [persist.rild.nitz_short_ons_1]: []
> [persist.rild.nitz_short_ons_2]: []
> [persist.rild.nitz_short_ons_3]: []
> [persist.su_flag]: [1]
> [persist.sys.bootAnimation]: [SPRINT]
> [persist.sys.dalvik.vm.lib.2]: [libart]
> [persist.sys.jrddmesg.enable]: [0]
> [persist.sys.jrdgeckolog.enable]: [0]
> [persist.sys.jrdlogcat.enable]: [0]
> [persist.sys.jrdqxdm.enable]: [0]
> [persist.sys.jrdtcpdump.enable]: [0]
> [persist.sys.silent]: [1]
> [persist.sys.synaptics_dsx.qhd]: [false]
> [persist.sys.timezone]: [UTC+07:00]
> [persist.sys.usb.config]: [default,serial_smd,serial_tty,adb]
> [persist.sys.usb.config.extra]: [none]
> [persist.timed.enable]: [true]
> [persist.tuning.qdcm]: [1]
> [prop.switch.app]: [true]
> [rec.playback.conc.disabled]: [true]
> [ril.ecclist]: [911,112,*911,#911]
> [ril.qcril_pre_init_lock_held]: [0]
> [ril.subscription.types]: [NV,RUIM]
> [rild.libargs]: [-d /dev/smd0]
> [rild.libpath]: [/system/vendor/lib/libril-qc-qmi-1.so]
> [ro.adb.secure]: [0]
> [ro.alarm_boot]: [false]
> [ro.allow.mock.location]: [0]
> [ro.am.reschedule_service]: [true]
> [ro.assisted_gps_enabled]: [1]
> [ro.baseband]: [msm]
> [ro.bluetooth.dun]: [true]
> [ro.bluetooth.hfp.ver]: [1.7]
> [ro.bluetooth.sap]: [true]
> [ro.bluetooth_pair_name]: [Alcatel GO FLIP]
> [ro.board.platform]: [msm8909]
> [ro.boot.BOARD_ID]: [011]
> [ro.boot.baseband]: [msm]
> [ro.boot.bootdevice]: [7824900.sdhci]
> [ro.boot.bootloader]: [LWA5C0C0BR00]
> [ro.boot.console]: [ttyHSL0]
> [ro.boot.emmc]: [true]
> [ro.boot.hardware]: [qcom]
> [ro.boot.panelname]: []
> [ro.boot.serialno]: [dd3d9acd]
> [ro.boot.wifi.countrycode]: [US]
> [ro.bootimage.build.date]: [2017年 01月 19日 星期四 14:03:35 CST]
> [ro.bootimage.build.date.utc]: [1484805815]
> [ro.bootimage.build.fingerprint]: [KaiOS/gflip2/gflip2:6.0.1/MMB29M/566:user/dev-keys]
> [ro.bootloader]: [LWA5C0C0BR00]
> [ro.bootmode]: [unknown]
> [ro.build.characteristics]: [default]
> [ro.build.date]: [Thu Jan 19 15:36:29 CST 2017]
> [ro.build.date.utc]: [1484811389]
> [ro.build.description]: [gflip2-user 6.0.1 MMB29M eng.zxliu.20170119.153557 test-keys]
> [ro.build.display.id]: [MMB29M test-keys]
> [ro.build.fingerprint]: [KaiOS/gflip2/gflip2:6.0.1/MMB29M/zxliu01191536:user/test-keys]
> [ro.build.flavor]: [gflip2-user]
> [ro.build.host]: [aclgcl-ubnt150]
> [ro.build.id]: [MMB29M]
> [ro.build.product]: [gflip2]
> [ro.build.tags]: [test-keys]
> [ro.build.type]: [user]
> [ro.build.user]: [zxliu]
> [ro.build.version.all_codenames]: [REL]
> [ro.build.version.base_os]: []
> [ro.build.version.codename]: [REL]
> [ro.build.version.incremental]: [eng.zxliu.20170119.153557]
> [ro.build.version.preview_sdk]: [0]
> [ro.build.version.release]: [6.0.1]
> [ro.build.version.sdk]: [23]
> [ro.build.version.security_patch]: [xxxx-xx-xx]
> [ro.carrier]: [unknown]
> [ro.cdma.home.operator.alpha]: [Sprint]
> [ro.cdma.home.operator.numeric]: [310120]
> [ro.com.android.dataroaming]: [true]
> [ro.config.alarm_alert]: [Alarm_Classic.ogg]
> [ro.config.low_ram]: [true]
> [ro.config.max_starting_bg]: [8]
> [ro.config.notification_sound]: [pixiedust.ogg]
> [ro.config.ringtone]: [Ring_Synth_04.ogg]
> [ro.config.zram]: [true]
> [ro.core_ctl_max_cpu]: [4]
> [ro.core_ctl_min_cpu]: [2]
> [ro.crypto.state]: [unencrypted]
> [ro.cutoff_voltage_mv]: [3200]
> [ro.dalvik.vm.native.bridge]: [0]
> [ro.debuggable]: [0]
> [ro.def.software.svn]: [V05]
> [ro.display.colorfill]: [1]
> [ro.emmc_size]: [4GB]
> [ro.first_power_on.time]: [2016.12.01 00:00]
> [ro.fm.transmitter]: [false]
> [ro.frp.pst]: [/dev/block/bootdevice/by-name/config]
> [ro.gps.agps_provider]: [1]
> [ro.hardware]: [qcom]
> [ro.home.operator.carrierid]: [SPRINT]
> [ro.hwui.text_large_cache_height]: [2048]
> [ro.kaios.display.ext_fb_dev]: [fb2]
> [ro.kaios.flipstatus]: [/sys/go_flip_key/lib_value]
> [ro.lean]: [true]
> [ro.model_name_in_UA]: [ALCATEL4044T]
> [ro.moz.bluetooth.backend]: [bluetoothd]
> [ro.moz.devinputjack]: [1]
> [ro.moz.fm.noAnalog]: [true]
> [ro.moz.nfc.enabled]: [false]
> [ro.moz.ril.emergency_by_default]: [true]
> [ro.moz.wifi.p2p_supported]: [0]
> [ro.opengles.version]: [196608]
> [ro.operator.name]: [SPR]
> [ro.product.board]: [msm8909]
> [ro.product.brand]: [TCL_SPR]
> [ro.product.cpu.abi]: [armeabi-v7a]
> [ro.product.cpu.abi2]: [armeabi]
> [ro.product.cpu.abilist]: [armeabi-v7a,armeabi]
> [ro.product.cpu.abilist32]: [armeabi-v7a,armeabi]
> [ro.product.cpu.abilist64]: []
> [ro.product.device]: [gflip2]
> [ro.product.imei]: [REDACTED]
> [ro.product.locale]: [en-US]
> [ro.product.manufacturer]: [unknown]
> [ro.product.meid]: [REDACTED]
> [ro.product.model]: [Alcatel GO FLIP]
> [ro.product.name]: [gflip2]
> [ro.qc.sdk.audio.fluencetype]: [fluence]
> [ro.qc.sdk.audio.ssr]: [false]
> [ro.qcom.screencolor]: [1]
> [ro.qualcomm.bluetooth.ftp]: [true]
> [ro.qualcomm.bluetooth.hfp]: [true]
> [ro.qualcomm.bluetooth.hsp]: [true]
> [ro.qualcomm.bluetooth.map]: [true]
> [ro.qualcomm.bluetooth.nap]: [true]
> [ro.qualcomm.bluetooth.opp]: [true]
> [ro.qualcomm.bluetooth.pbap]: [true]
> [ro.qualcomm.bt.hci_transport]: [smd]
> [ro.qualcomm.cabl]: [2]
> [ro.revision]: [0]
> [ro.ril.svdo]: [false]
> [ro.ril.svlte1x]: [false]
> [ro.secure]: [1]
> [ro.serialno]: [REDACTED]
> [ro.sf.lcd_density]: [320]
> [ro.sys.fw.bg_apps_limit]: [16]
> [ro.sys.fw.bservice_age]: [5000]
> [ro.sys.fw.bservice_enable]: [true]
> [ro.sys.fw.bservice_limit]: [5]
> [ro.sys.fw.empty_app_percent]: [50]
> [ro.sys.fw.trim_cache_percent]: [100]
> [ro.sys.fw.trim_empty_percent]: [100]
> [ro.sys.fw.trim_enable_memory]: [1073741824]
> [ro.sys.fw.use_trim_settings]: [true]
> [ro.sys.umsdirtyratio]: [20]
> [ro.sys.usb.default.config]: [diag,serial_smd,rmnet_qti_bam,adb]
> [ro.tct.btaddr]: [REDACTED]
> [ro.tct.wifimac]: [REDACTED]
> [ro.telephony.call_ring.multiple]: [false]
> [ro.telephony.default_network]: [10]
> [ro.tethering.ipv6]: [0]
> [ro.use_data_netmgrd]: [true]
> [ro.vendor.extension_library]: [libqti-perfd-client.so]
> [ro.volte.enabled]: [false]
> [ro.wifi.channels]: []
> [ro.zygote]: [zygote32]
> [ro_def_device_type]: [Feature Phone]
> [ro_def_hardware_version]: [03]
> [security.perf_harden]: [1]
> [selinux.reload_policy]: [1]
> [service.qti.ims.enabled]: [1]
> [service.slate_diag.enable]: [1]
> [spam.enable]: [false]
> [sys.audio.init]: [true]
> [sys.boot_completed]: [1]
> [sys.hwc.gpu_perf_mode]: [1]
> [sys.keymaster.loaded]: [true]
> [sys.listeners.registered]: [true]
> [sys.usb.config]: [mtp,adb]
> [sys.usb.configfs]: [0]
> [sys.usb.ffs.ready]: [1]
> [sys.usb.rps_mask]: [4]
> [sys.usb.state]: [mtp,adb]
> [telephony.lteOnCdmaDevice]: [1]
> [tunnel.audio.encode]: [false]
> [uicc.need.reset]: [false]
> [use.voice.path.for.pcm.voip]: [true]
> [voice.playback.conc.disabled]: [true]
> [voice.record.conc.disabled]: [true]
> [voice.voip.conc.disabled]: [true]
> [vold.has_adoptable]: [1]
> [vold.post_fs_data_done]: [1]
> [wifi.interface]: [wlan0]
> [wlan.driver.ath]: [0]
> [wlan.driver.config]: [/data/misc/wifi/WCNSS_qcom_cfg.ini]
> [wlan.driver.status]: [ok]
>
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/openstf/stf/issues/587#issuecomment-297993724>, or mute
> the thread
> <https://github.com/notifications/unsubscribe-auth/AAwpgR5VCHIM_c51ZvfvbbLLbfHTNgOOks5r0eWOgaJpZM4NJrKt>
> .
>
 Great!. Mystery solved. :)

A pleasure to help you.
regards

2017-04-28 10:52 GMT-03:00 Simo Kinnunen <notifications@github.com>:

> Good call, b2g-ps works! The other one gives permission denied. Seems like
> it's Firefox OS.
>
>
> On Fri, Apr 28, 2017 at 10:40 PM, David <notifications@github.com> wrote:
>
> > Perfect!, it only remains to know if it is a FirefoxOS
> >
> > I do not know anything about FirefoxOS, it is based on some data that I
> > found on the internet.
> >
> > adb shell ls /data/b2g/mozilla/*.default/prefs.js
> >
> > or running the ps version of b2g
> >
> > adb shell b2g-ps
> >
> >
> >
> >
> > 2017-04-28 10:11 GMT-03:00 Simo Kinnunen <notifications@github.com>:
> >
> > > Thanks, that's good info. Looks like you're right, the props do mention
> > > KaiOS.
> > >
> > > [DEVICE_PROVISIONED]: [1]
> > > [audio.dolby.ds2.enabled]: [true]
> > > [audio.offload.buffer.size.kb]: [64]
> > > [audio.offload.gapless.enabled]: [true]
> > > [audio.offload.min.duration.secs]: [30]
> > > [audio.offload.video]: [true]
> > > [bluetooth.isEnabled]: [false]
> > > [cameradaemon.SaveMemAtBoot]: [1]
> > > [cdma.prl.version]: [55061]
> > > [config.disable_atlas]: [true]
> > > [dalvik.vm.dex2oat-Xms]: [64m]
> > > [dalvik.vm.dex2oat-Xmx]: [512m]
> > > [dalvik.vm.heapgrowthlimit]: [128m]
> > > [dalvik.vm.heapmaxfree]: [8m]
> > > [dalvik.vm.heapminfree]: [6m]
> > > [dalvik.vm.heapsize]: [256m]
> > > [dalvik.vm.heapstartsize]: [8m]
> > > [dalvik.vm.heaptargetutilization]: [0.75]
> > > [dalvik.vm.image-dex2oat-Xms]: [64m]
> > > [dalvik.vm.image-dex2oat-Xmx]: [64m]
> > > [dalvik.vm.isa.arm.features]: [default]
> > > [dalvik.vm.isa.arm.variant]: [cortex-a7]
> > > [dalvik.vm.stack-trace-file]: [/data/anr/traces.txt]
> > > [dalvik.vm.zygotemaxfailedboots]: [5]
> > > [debug.atrace.tags.enableflags]: [0]
> > > [debug.composition.type]: [gpu]
> > > [debug.egl.hw]: [1]
> > > [debug.hwc.dynThreshold]: [2.5]
> > > [debug.mdpcomp.logs]: [0]
> > > [debug.sf.hw]: [1]
> > > [debug.sf.hwc.canUseABC]: [0]
> > > [debug.sf.swaprect]: [0]
> > > [default.HwV.value]: [03]
> > > [dev.jrdcom.cu.ref]: [4044T-2ARXUS1-R1]
> > > [dev.pm.dyn_samplingrate]: [1]
> > > [dev.tct.handset.ref]: [SAA61U0AA10C]
> > > [diag.reset_handler]: [true]
> > > [diag_get_daemon.status]: [YES]
> > > [gsm.version.baseband]: [MPSS.JO.1.0.c5.1-00024-M8909EA]
> > > [gsm.version.ril-impl]: [Qualcomm RIL 1.0]
> > > [hw.sf.app_buff_count]: [3]
> > > [init.svc.adbd]: [running]
> > > [init.svc.atfwd]: [running]
> > > [init.svc.audiod]: [running]
> > > [init.svc.b2g]: [running]
> > > [init.svc.bms-sh]: [stopped]
> > > [init.svc.cnd]: [running]
> > > [init.svc.config-zram]: [stopped]
> > > [init.svc.config_bluetooth]: [stopped]
> > > [init.svc.debuggerd]: [running]
> > > [init.svc.diag_get_daemon]: [running]
> > > [init.svc.fakeappops]: [running]
> > > [init.svc.fidodaemon]: [running]
> > > [init.svc.flash_recovery]: [stopped]
> > > [init.svc.gatekeeperd]: [running]
> > > [init.svc.gonksched]: [running]
> > > [init.svc.imsdatadaemon]: [running]
> > > [init.svc.imsstarter]: [stopped]
> > > [init.svc.irsc_util]: [stopped]
> > > [init.svc.jrddmesgservice]: [stopped]
> > > [init.svc.jrdgeckologsvc]: [stopped]
> > > [init.svc.jrdlogcatservice]: [stopped]
> > > [init.svc.jrdqxdmservice]: [stopped]
> > > [init.svc.jrdtcpdpservice]: [stopped]
> > > [init.svc.keystore]: [running]
> > > [init.svc.loc_launcher]: [running]
> > > [init.svc.md_check]: [stopped]
> > > [init.svc.media]: [running]
> > > [init.svc.mverproxy]: [stopped]
> > > [init.svc.netd]: [running]
> > > [init.svc.netmgrd]: [running]
> > > [init.svc.nvdiag_daemon]: [running]
> > > [init.svc.per_mgr]: [running]
> > > [init.svc.perfd]: [running]
> > > [init.svc.play_music]: [stopped]
> > > [init.svc.ptt_socket_app]: [running]
> > > [init.svc.qcamerasvr]: [running]
> > > [init.svc.qcom-c_core-sh]: [stopped]
> > > [init.svc.qcom-c_main-sh]: [stopped]
> > > [init.svc.qcom-debug]: [stopped]
> > > [init.svc.qcom-post-boot]: [stopped]
> > > [init.svc.qcom-sh]: [stopped]
> > > [init.svc.qcom-usb-sh]: [stopped]
> > > [init.svc.qcomsysd]: [running]
> > > [init.svc.qmuxd]: [running]
> > > [init.svc.qseecomd]: [running]
> > > [init.svc.qti]: [running]
> > > [init.svc.qti-testscripts]: [stopped]
> > > [init.svc.ril-daemon]: [running]
> > > [init.svc.rmt_storage]: [running]
> > > [init.svc.root_check]: [running]
> > > [init.svc.servicemanager]: [running]
> > > [init.svc.slate_diag]: [running]
> > > [init.svc.tct_diag]: [running]
> > > [init.svc.tctd]: [running]
> > > [init.svc.tftp_server]: [running]
> > > [init.svc.thermal-engine]: [running]
> > > [init.svc.time_daemon]: [running]
> > > [init.svc.trace_util]: [stopped]
> > > [init.svc.ueventd]: [running]
> > > [init.svc.vm_bms]: [running]
> > > [init.svc.vold]: [running]
> > > [init.svc.wcnss-service]: [running]
> > > [init.svc.wpa_supplicant]: [running]
> > > [keyguard.no_require_sim]: [true]
> > > [media.aac_51_output_enabled]: [true]
> > > [media.stagefright.enable-aac]: [true]
> > > [media.stagefright.enable-fma2dp]: [true]
> > > [media.stagefright.enable-http]: [true]
> > > [media.stagefright.enable-player]: [true]
> > > [media.stagefright.enable-qcp]: [true]
> > > [media.stagefright.enable-scan]: [true]
> > > [media.stagefright.use-awesome]: [false]
> > > [mm.enable.qcom_parser]: [262143]
> > > [mmp.enable.3g2]: [true]
> > > [net.bt.name]: [Android]
> > > [net.change]: [net.dnschange]
> > > [net.dns1]: [REDACTED]
> > > [net.dns2]: [REDACTED]
> > > [net.dns3]: [REDACTED]
> > > [net.dns4]: [REDACTED
> > > [net.dnschange]: [148]
> > > [net.rmnet_data0.dns1]: [REDACTED]
> > > [net.rmnet_data0.dns2]: [REDACTED]
> > > [net.rmnet_data0.gw]: [REDACTED]
> > > [net.rmnet_data1.dns1]: []
> > > [net.rmnet_data1.dns2]: []
> > > [net.rmnet_data1.gw]: []
> > > [net.tcp.buffersize.default]: [4096,87380,524288,4096,16384,110208]
> > > [net.tcp.buffersize.edge]: [4093,26280,35040,4096,16384,35040]
> > > [net.tcp.buffersize.evdo]: [4094,87380,524288,4096,16384,262144]
> > > [net.tcp.buffersize.gprs]: [4092,8760,11680,4096,8760,11680]
> > > [net.tcp.buffersize.hsdpa]: [4094,87380,1220608,4096,16384,1220608]
> > > [net.tcp.buffersize.hspa]: [4094,87380,1220608,4096,16384,1220608]
> > > [net.tcp.buffersize.hspap]: [4094,87380,1220608,4096,16384,1220608]
> > > [net.tcp.buffersize.hsupa]: [4094,87380,1220608,4096,16384,1220608]
> > > [net.tcp.buffersize.lte]: [2097152,4194304,8388608,
> > 262144,524288,1048576]
> > > [net.tcp.buffersize.umts]: [4094,87380,110208,4096,16384,110208]
> > > [net.tcp.buffersize.wifi]: [524288,2097152,4194304,
> > 262144,524288,1048576]
> > > [net.tcp.default_init_rwnd]: [60]
> > > [nvdiag_daemon.status]: [running]
> > > [oma.data.keep]: [0]
> > > [oma.service.is_busy]: [0]
> > > [oma.uicc.write]: [ok]
> > > [persist.audio.fluence.speaker]: [false]
> > > [persist.audio.fluence.voicecall]: [true]
> > > [persist.audio.fluence.voicerec]: [false]
> > > [persist.camera.longshot.stages]: [1]
> > > [persist.chameleon.package.path]: [/carrier/chameleon.zip]
> > > [persist.cne.feature]: [4]
> > > [persist.data.mode]: [concurrent]
> > > [persist.data.netmgrd.qos.enable]: [true]
> > > [persist.debug.wfd.enable]: [0]
> > > [persist.demo.hdmirotationlock]: [false]
> > > [persist.device.first.startup]: [1]
> > > [persist.env.fastdorm.enabled]: [true]
> > > [persist.gps.qc_nlp_in_use]: [1]
> > > [persist.hiddenMenu.update]: [false]
> > > [persist.hwc.enable_vds]: [1]
> > > [persist.ims.regitered]: [0]
> > > [persist.isptcrb]: [false]
> > > [persist.loc.nlp_name]: [com.qualcomm.location]
> > > [persist.mm.sta.enable]: [1]
> > > [persist.qcril.datacall.miperror]: [0]
> > > [persist.radio.adb_log_on]: [0]
> > > [persist.radio.airplane_mode_on]: [0]
> > > [persist.radio.apm_sim_not_pwdn]: [1]
> > > [persist.radio.custom_ecc]: [0]
> > > [persist.radio.data_no_toggle]: [1]
> > > [persist.radio.eons.enabled]: [false]
> > > [persist.radio.nitz_lons_0_0]: [Sprint]
> > > [persist.radio.nitz_lons_1_0]: []
> > > [persist.radio.nitz_lons_2_0]: []
> > > [persist.radio.nitz_lons_3_0]: []
> > > [persist.radio.nitz_plmn_0]: [310 120]
> > > [persist.radio.nitz_sons_0_0]: [SPRINT]
> > > [persist.radio.nitz_sons_1_0]: []
> > > [persist.radio.nitz_sons_2_0]: []
> > > [persist.radio.nitz_sons_3_0]: []
> > > [persist.radio.ril_payload_on]: [0]
> > > [persist.radio.sglte_target]: [0]
> > > [persist.radio.sib16_support]: [1]
> > > [persist.radio.snapshot_enabled]: [0]
> > > [persist.rild.nitz_long_ons_0]: []
> > > [persist.rild.nitz_long_ons_1]: []
> > > [persist.rild.nitz_long_ons_2]: []
> > > [persist.rild.nitz_long_ons_3]: []
> > > [persist.rild.nitz_plmn]: []
> > > [persist.rild.nitz_short_ons_0]: []
> > > [persist.rild.nitz_short_ons_1]: []
> > > [persist.rild.nitz_short_ons_2]: []
> > > [persist.rild.nitz_short_ons_3]: []
> > > [persist.su_flag]: [1]
> > > [persist.sys.bootAnimation]: [SPRINT]
> > > [persist.sys.dalvik.vm.lib.2]: [libart]
> > > [persist.sys.jrddmesg.enable]: [0]
> > > [persist.sys.jrdgeckolog.enable]: [0]
> > > [persist.sys.jrdlogcat.enable]: [0]
> > > [persist.sys.jrdqxdm.enable]: [0]
> > > [persist.sys.jrdtcpdump.enable]: [0]
> > > [persist.sys.silent]: [1]
> > > [persist.sys.synaptics_dsx.qhd]: [false]
> > > [persist.sys.timezone]: [UTC+07:00]
> > > [persist.sys.usb.config]: [default,serial_smd,serial_tty,adb]
> > > [persist.sys.usb.config.extra]: [none]
> > > [persist.timed.enable]: [true]
> > > [persist.tuning.qdcm]: [1]
> > > [prop.switch.app]: [true]
> > > [rec.playback.conc.disabled]: [true]
> > > [ril.ecclist]: [911,112,*911,#911]
> > > [ril.qcril_pre_init_lock_held]: [0]
> > > [ril.subscription.types]: [NV,RUIM]
> > > [rild.libargs]: [-d /dev/smd0]
> > > [rild.libpath]: [/system/vendor/lib/libril-qc-qmi-1.so]
> > > [ro.adb.secure]: [0]
> > > [ro.alarm_boot]: [false]
> > > [ro.allow.mock.location]: [0]
> > > [ro.am.reschedule_service]: [true]
> > > [ro.assisted_gps_enabled]: [1]
> > > [ro.baseband]: [msm]
> > > [ro.bluetooth.dun]: [true]
> > > [ro.bluetooth.hfp.ver]: [1.7]
> > > [ro.bluetooth.sap]: [true]
> > > [ro.bluetooth_pair_name]: [Alcatel GO FLIP]
> > > [ro.board.platform]: [msm8909]
> > > [ro.boot.BOARD_ID]: [011]
> > > [ro.boot.baseband]: [msm]
> > > [ro.boot.bootdevice]: [7824900.sdhci]
> > > [ro.boot.bootloader]: [LWA5C0C0BR00]
> > > [ro.boot.console]: [ttyHSL0]
> > > [ro.boot.emmc]: [true]
> > > [ro.boot.hardware]: [qcom]
> > > [ro.boot.panelname]: []
> > > [ro.boot.serialno]: [dd3d9acd]
> > > [ro.boot.wifi.countrycode]: [US]
> > > [ro.bootimage.build.date]: [2017年 01月 19日 星期四 14:03:35 CST]
> > > [ro.bootimage.build.date.utc]: [1484805815]
> > > [ro.bootimage.build.fingerprint]: [KaiOS/gflip2/gflip2:6.0.1/
> > MMB29M/566:user/dev-keys]
> > > [ro.bootloader]: [LWA5C0C0BR00]
> > > [ro.bootmode]: [unknown]
> > > [ro.build.characteristics]: [default]
> > > [ro.build.date]: [Thu Jan 19 15:36:29 CST 2017]
> > > [ro.build.date.utc]: [1484811389]
> > > [ro.build.description]: [gflip2-user 6.0.1 MMB29M
> > eng.zxliu.20170119.153557 test-keys]
> > > [ro.build.display.id]: [MMB29M test-keys]
> > > [ro.build.fingerprint]: [KaiOS/gflip2/gflip2:6.0.1/
> > MMB29M/zxliu01191536:user/test-keys]
> > > [ro.build.flavor]: [gflip2-user]
> > > [ro.build.host]: [aclgcl-ubnt150]
> > > [ro.build.id]: [MMB29M]
> > > [ro.build.product]: [gflip2]
> > > [ro.build.tags]: [test-keys]
> > > [ro.build.type]: [user]
> > > [ro.build.user]: [zxliu]
> > > [ro.build.version.all_codenames]: [REL]
> > > [ro.build.version.base_os]: []
> > > [ro.build.version.codename]: [REL]
> > > [ro.build.version.incremental]: [eng.zxliu.20170119.153557]
> > > [ro.build.version.preview_sdk]: [0]
> > > [ro.build.version.release]: [6.0.1]
> > > [ro.build.version.sdk]: [23]
> > > [ro.build.version.security_patch]: [xxxx-xx-xx]
> > > [ro.carrier]: [unknown]
> > > [ro.cdma.home.operator.alpha]: [Sprint]
> > > [ro.cdma.home.operator.numeric]: [310120]
> > > [ro.com.android.dataroaming]: [true]
> > > [ro.config.alarm_alert]: [Alarm_Classic.ogg]
> > > [ro.config.low_ram]: [true]
> > > [ro.config.max_starting_bg]: [8]
> > > [ro.config.notification_sound]: [pixiedust.ogg]
> > > [ro.config.ringtone]: [Ring_Synth_04.ogg]
> > > [ro.config.zram]: [true]
> > > [ro.core_ctl_max_cpu]: [4]
> > > [ro.core_ctl_min_cpu]: [2]
> > > [ro.crypto.state]: [unencrypted]
> > > [ro.cutoff_voltage_mv]: [3200]
> > > [ro.dalvik.vm.native.bridge]: [0]
> > > [ro.debuggable]: [0]
> > > [ro.def.software.svn]: [V05]
> > > [ro.display.colorfill]: [1]
> > > [ro.emmc_size]: [4GB]
> > > [ro.first_power_on.time]: [2016.12.01 00:00]
> > > [ro.fm.transmitter]: [false]
> > > [ro.frp.pst]: [/dev/block/bootdevice/by-name/config]
> > > [ro.gps.agps_provider]: [1]
> > > [ro.hardware]: [qcom]
> > > [ro.home.operator.carrierid]: [SPRINT]
> > > [ro.hwui.text_large_cache_height]: [2048]
> > > [ro.kaios.display.ext_fb_dev]: [fb2]
> > > [ro.kaios.flipstatus]: [/sys/go_flip_key/lib_value]
> > > [ro.lean]: [true]
> > > [ro.model_name_in_UA]: [ALCATEL4044T]
> > > [ro.moz.bluetooth.backend]: [bluetoothd]
> > > [ro.moz.devinputjack]: [1]
> > > [ro.moz.fm.noAnalog]: [true]
> > > [ro.moz.nfc.enabled]: [false]
> > > [ro.moz.ril.emergency_by_default]: [true]
> > > [ro.moz.wifi.p2p_supported]: [0]
> > > [ro.opengles.version]: [196608]
> > > [ro.operator.name]: [SPR]
> > > [ro.product.board]: [msm8909]
> > > [ro.product.brand]: [TCL_SPR]
> > > [ro.product.cpu.abi]: [armeabi-v7a]
> > > [ro.product.cpu.abi2]: [armeabi]
> > > [ro.product.cpu.abilist]: [armeabi-v7a,armeabi]
> > > [ro.product.cpu.abilist32]: [armeabi-v7a,armeabi]
> > > [ro.product.cpu.abilist64]: []
> > > [ro.product.device]: [gflip2]
> > > [ro.product.imei]: [REDACTED]
> > > [ro.product.locale]: [en-US]
> > > [ro.product.manufacturer]: [unknown]
> > > [ro.product.meid]: [REDACTED]
> > > [ro.product.model]: [Alcatel GO FLIP]
> > > [ro.product.name]: [gflip2]
> > > [ro.qc.sdk.audio.fluencetype]: [fluence]
> > > [ro.qc.sdk.audio.ssr]: [false]
> > > [ro.qcom.screencolor]: [1]
> > > [ro.qualcomm.bluetooth.ftp]: [true]
> > > [ro.qualcomm.bluetooth.hfp]: [true]
> > > [ro.qualcomm.bluetooth.hsp]: [true]
> > > [ro.qualcomm.bluetooth.map]: [true]
> > > [ro.qualcomm.bluetooth.nap]: [true]
> > > [ro.qualcomm.bluetooth.opp]: [true]
> > > [ro.qualcomm.bluetooth.pbap]: [true]
> > > [ro.qualcomm.bt.hci_transport]: [smd]
> > > [ro.qualcomm.cabl]: [2]
> > > [ro.revision]: [0]
> > > [ro.ril.svdo]: [false]
> > > [ro.ril.svlte1x]: [false]
> > > [ro.secure]: [1]
> > > [ro.serialno]: [REDACTED]
> > > [ro.sf.lcd_density]: [320]
> > > [ro.sys.fw.bg_apps_limit]: [16]
> > > [ro.sys.fw.bservice_age]: [5000]
> > > [ro.sys.fw.bservice_enable]: [true]
> > > [ro.sys.fw.bservice_limit]: [5]
> > > [ro.sys.fw.empty_app_percent]: [50]
> > > [ro.sys.fw.trim_cache_percent]: [100]
> > > [ro.sys.fw.trim_empty_percent]: [100]
> > > [ro.sys.fw.trim_enable_memory]: [1073741824]
> > > [ro.sys.fw.use_trim_settings]: [true]
> > > [ro.sys.umsdirtyratio]: [20]
> > > [ro.sys.usb.default.config]: [diag,serial_smd,rmnet_qti_bam,adb]
> > > [ro.tct.btaddr]: [REDACTED]
> > > [ro.tct.wifimac]: [REDACTED]
> > > [ro.telephony.call_ring.multiple]: [false]
> > > [ro.telephony.default_network]: [10]
> > > [ro.tethering.ipv6]: [0]
> > > [ro.use_data_netmgrd]: [true]
> > > [ro.vendor.extension_library]: [libqti-perfd-client.so]
> > > [ro.volte.enabled]: [false]
> > > [ro.wifi.channels]: []
> > > [ro.zygote]: [zygote32]
> > > [ro_def_device_type]: [Feature Phone]
> > > [ro_def_hardware_version]: [03]
> > > [security.perf_harden]: [1]
> > > [selinux.reload_policy]: [1]
> > > [service.qti.ims.enabled]: [1]
> > > [service.slate_diag.enable]: [1]
> > > [spam.enable]: [false]
> > > [sys.audio.init]: [true]
> > > [sys.boot_completed]: [1]
> > > [sys.hwc.gpu_perf_mode]: [1]
> > > [sys.keymaster.loaded]: [true]
> > > [sys.listeners.registered]: [true]
> > > [sys.usb.config]: [mtp,adb]
> > > [sys.usb.configfs]: [0]
> > > [sys.usb.ffs.ready]: [1]
> > > [sys.usb.rps_mask]: [4]
> > > [sys.usb.state]: [mtp,adb]
> > > [telephony.lteOnCdmaDevice]: [1]
> > > [tunnel.audio.encode]: [false]
> > > [uicc.need.reset]: [false]
> > > [use.voice.path.for.pcm.voip]: [true]
> > > [voice.playback.conc.disabled]: [true]
> > > [voice.record.conc.disabled]: [true]
> > > [voice.voip.conc.disabled]: [true]
> > > [vold.has_adoptable]: [1]
> > > [vold.post_fs_data_done]: [1]
> > > [wifi.interface]: [wlan0]
> > > [wlan.driver.ath]: [0]
> > > [wlan.driver.config]: [/data/misc/wifi/WCNSS_qcom_cfg.ini]
> > > [wlan.driver.status]: [ok]
> > >
> > > —
> > > You are receiving this because you commented.
> > > Reply to this email directly, view it on GitHub
> > > <https://github.com/openstf/stf/issues/587#issuecomment-297993724>, or
> > mute
> > > the thread
> > > <https://github.com/notifications/unsubscribe-auth/AAwpgR5VCHIM_
> > c51ZvfvbbLLbfHTNgOOks5r0eWOgaJpZM4NJrKt>
> >
> > > .
> > >
> >
> > —
> > You are receiving this because you authored the thread.
> > Reply to this email directly, view it on GitHub
> > <https://github.com/openstf/stf/issues/587#issuecomment-298000383>, or
> mute
> > the thread
> > <https://github.com/notifications/unsubscribe-auth/AAB-_a_
> JCUeqb5dB76vTVKQLfEOR7_pjks5r0ewwgaJpZM4NJrKt>
> > .
> >
>
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/openstf/stf/issues/587#issuecomment-298003350>, or mute
> the thread
> <https://github.com/notifications/unsubscribe-auth/AAwpgZ1cXKOnu9XwOIUQoasoIhlZ7jdFks5r0e8EgaJpZM4NJrKt>
> .
>
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

What is the issue or idea you have?
I am trying to get Cell Info (CID, LAC ,TAC ,RAC) & Signal Strength showing in Dashboard under Network

**Please provide the steps to reproduce the issue.**
I did try to modify the monitoring java files under STFService, by adding `onCellInfoChanged(List<CellInfo> cellInfo)` & `onSignalStrengthsChanged(SignalStrength signalStrength)` methods under PhoneStateListener. 

I haven't added the changes to wire & writer yet, instead I am reporting the log as info and checking logcat but nothing is getting triggered. is this a known issue by any chance ? 



 Here  are nobody worked for you.Solved problem by yourself.  I am not expecting anybody to work for me ! I asked the question after spending hours trying to get it working.  This is code for **PhoneStateMonitor.java**, I am expecting Cell Changed is logged every time cell data is changed.  




`package jp.co.cyberagent.stf.monitor;

import android.content.Context;
import android.telephony.PhoneStateListener;
import android.telephony.ServiceState;
import android.telephony.TelephonyManager;
import android.telephony.CellInfo;
import android.util.Log;

import java.util.List;

import jp.co.cyberagent.stf.io.MessageWritable;
import jp.co.cyberagent.stf.proto.Wire;

public class PhoneStateMonitor extends AbstractMonitor {
    private static final String TAG = "STFPhoneStateMonitor";

    private ServiceState state = null;

    public PhoneStateMonitor(Context context, MessageWritable writer) {
        super(context, writer);
    }

    @Override
    public void run() {
        Log.i(TAG, "Monitor starting");

        TelephonyManager tm = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);

        PhoneStateListener listener = new PhoneStateListener() {
            @Override
            public void onServiceStateChanged(ServiceState newState) {
                state = newState;
                report(writer, state);
            }

            @Override
            public void onCellInfoChanged(List<CellInfo> cellInfo) {
                Log.i(TAG, "Cell changed");
            }

        };

        tm.listen(listener, PhoneStateListener.LISTEN_SERVICE_STATE | PhoneStateListener.LISTEN_CELL_INFO);

        try {
            synchronized (this) {
                while (!isInterrupted()) {
                    wait();
                }
            }
        }
        catch (InterruptedException e) {
            // Okay
        }
        catch (Exception e) {
            e.printStackTrace();
        }
        finally {
            Log.i(TAG, "Monitor stopping");

            tm.listen(listener, PhoneStateListener.LISTEN_NONE);
        }
    }

    @Override
    public void peek(MessageWritable writer) {
        if (state != null) {
            report(writer, state);
        }
    }

    private void report(MessageWritable writer, ServiceState state) {
        Log.i(TAG, String.format("Phone state is %s; %s; %s",
                stateLabel(state.getState()),
                state.getIsManualSelection() ? "manual" : "automatic",
                state.getOperatorAlphaLong() == null ? "no operator" : "operator " + state.getOperatorAlphaLong()
        ));

        Wire.PhoneStateEvent.Builder message = Wire.PhoneStateEvent.newBuilder()
                .setState(stateLabel(state.getState()))
                .setManual(state.getIsManualSelection());

        if (state.getOperatorAlphaLong() != null) {
            message.setOperator(state.getOperatorAlphaLong());
        }

        writer.write(Wire.Envelope.newBuilder()
                .setType(Wire.MessageType.EVENT_PHONE_STATE)
                .setMessage(message.build().toByteString())
                .build());
    }

    private String stateLabel(int state) {
        switch (state) {
            case ServiceState.STATE_EMERGENCY_ONLY:
                return "emergency_only";
            case ServiceState.STATE_IN_SERVICE:
                return "in_service";
            case ServiceState.STATE_OUT_OF_SERVICE:
                return "out_of_service";
            case ServiceState.STATE_POWER_OFF:
                return "power_off";
            default:
                return "unknown_" + state;
        }
    }
}
`  Cause one stf server can't connet too many phones or it may be done for some other reasons, I need more than one stf servers for our project.  If I run 2 stf servers like http://1.1.1.1:7100 and http://2.2.2.2:7100 , both of them are connected with some phones. 1.1.1.1 with phone A and B, 2.2.2.2 with phone C and D.
Question 1:
How can I see all the phones A , B ,C and D on one website (1.1.1.1)
Question 2:
If Question 1 was sovled , how can I operate phone A, D can do the same operation.
Thank you very much.  Hello there!

I getting erros during apk instalation by interface..
I'm using the last version of the branch master.

When I try, I get the interface message: `Processing... (100%)`
<img width="493" alt="screen shot 2017-04-25 at 12 12 37 pm" src="https://cloud.githubusercontent.com/assets/124299/25393142/15fe2c42-29b1-11e7-902a-27cbfebf6775.png">


And the follow output:
```
storage:plugins:apk 70330 [*] Unable to read manifest of "b13c02f0-273b-43d3-9cf1-65064faf76f9" Error: end of central directory record signature not found
    at /Users/jaspion/workspace/stf/node_modules/yauzl/index.js:183:14
    at /Users/jaspion/workspace/stf/node_modules/yauzl/index.js:618:5
    at /Users/jaspion/workspace/stf/node_modules/fd-slicer/index.js:32:7
    at FSReqWrap.wrapper [as oncomplete] (fs.js:603:17)
```
I tried with 3 differentes apks and 3 differents devices.
```
$ stf doctor
INF/util:doctor 70494 [*] OS Arch: x64
INF/util:doctor 70494 [*] OS Platform: darwin
INF/util:doctor 70494 [*] OS Platform: 15.4.0
INF/util:doctor 70494 [*] Using Node 7.5.0
INF/util:doctor 70494 [*] Using RethinkDB client 2.3.3
INF/util:doctor 70494 [*] Using ZeroMQ 4.2.2
WRN/util:doctor 70494 [*] Executable was not found
INF/util:doctor 70494 [*] GraphicsMagick 1.3.25
INF/util:doctor 70494 [*] ProtoBuf 3.2.0
ERR/util:doctor 70494 [*] Current ProtoBuf version is not supported, it has to be ~2
INF/util:doctor 70494 [*] Local RethinkDB server 2.3.5
``` What is the name of apk?  When I read and test by myself, devices must connect to stf server by wire for adb connect. can I use wifi instead of connect to stf server? If I can't , can I modify stf code?how? I got it, thanks a lot  Hi @sorccu , thanks for your great works!  After read the deployment.md and the core topology, I just confused how message transmit between ZMQ's end-points, especially DEALER and DEALER.
Could you give a example in actual scene to explain it?
Sorry for my poor english, thank you again!
![zmq](https://cloud.githubusercontent.com/assets/15082338/25273300/d1af05a2-26bd-11e7-8a11-87e4ebf5db3b.png)
 That's ok, thanks all the same : )  root@wzl-virtual-machine:~/node-v6.10.2-linux-x64/lib/node_modules/stf/bin# ./stf doctor
/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/compiled/6.10.2/linux/x64/zmq.node
    at bindings (/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.require (module.js:497:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.require (module.js:497:17)
 @sorccu 
yes installed problem：
root@wzl-virtual-machine:~# npm install zmq

> zmq@2.15.3 install /root/node_modules/zmq
> node-gyp rebuild

sh: 1: node-gyp: Permission denied
npm WARN enoent ENOENT: no such file or directory, open '/root/package.json'
npm WARN root No description
npm WARN root No repository field.
npm WARN root No README data
npm WARN root No license field.
npm ERR! Linux 4.2.0-16-generic
npm ERR! argv "/root/node-v6.10.2-linux-x64/bin/node" "/usr/local/bin/npm" "install" "zmq"
npm ERR! node v6.10.2
npm ERR! npm  v3.10.10
npm ERR! file sh
npm ERR! code ELIFECYCLE
npm ERR! errno ENOENT
npm ERR! syscall spawn

npm ERR! zmq@2.15.3 install: `node-gyp rebuild`
npm ERR! spawn ENOENT
npm ERR! 
npm ERR! Failed at the zmq@2.15.3 install script 'node-gyp rebuild'.
npm ERR! Make sure you have the latest version of node.js and npm installed.
npm ERR! If you do, this is most likely a problem with the zmq package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get information on how to open an issue for this project with:
npm ERR!     npm bugs zmq
npm ERR! Or if that isn't available, you can get their info via:
npm ERR!     npm owner ls zmq
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /root/npm-debug.log oh 
wzl@wzl-virtual-machine:/root$ sudo npm install zmq
[sudo] wzl 的密码： 

> zmq@2.15.3 install /root/node_modules/zmq
> node-gyp rebuild

sh: 1: node-gyp: Permission denied
npm WARN enoent ENOENT: no such file or directory, open '/root/package.json'
npm WARN root No description
npm WARN root No repository field.
npm WARN root No README data
npm WARN root No license field.
npm ERR! Linux 4.2.0-16-generic
npm ERR! argv "/root/node-v6.10.2-linux-x64/bin/node" "/usr/local/bin/npm" "install" "zmq"
npm ERR! node v6.10.2
npm ERR! npm  v3.10.10
npm ERR! file sh
npm ERR! code ELIFECYCLE
npm ERR! errno ENOENT
npm ERR! syscall spawn

npm ERR! zmq@2.15.3 install: `node-gyp rebuild`
npm ERR! spawn ENOENT
npm ERR! 
npm ERR! Failed at the zmq@2.15.3 install script 'node-gyp rebuild'.
npm ERR! Make sure you have the latest version of node.js and npm installed.
npm ERR! If you do, this is most likely a problem with the zmq package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get information on how to open an issue for this project with:
npm ERR!     npm bugs zmq
npm ERR! Or if that isn't available, you can get their info via:
npm ERR!     npm owner ls zmq
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /root/npm-debug.log
 stf@wzl-virtual-machine:/root$ npm install zmq

> zmq@2.15.3 install /root/node_modules/zmq
> node-gyp rebuild

make: Entering directory '/root/node_modules/zmq/build'
  CXX(target) Release/obj.target/zmq/binding.o
../binding.cc:28:17: fatal error: zmq.h: 没有那个文件或目录
compilation terminated.
zmq.target.mk:94: recipe for target 'Release/obj.target/zmq/binding.o' failed
make: *** [Release/obj.target/zmq/binding.o] Error 1
make: Leaving directory '/root/node_modules/zmq/build'
gyp ERR! build error 
gyp ERR! stack Error: `make` failed with exit code: 2
gyp ERR! stack     at ChildProcess.onExit (/root/node-v6.10.2-linux-x64/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:276:23)
gyp ERR! stack     at emitTwo (events.js:106:13)
gyp ERR! stack     at ChildProcess.emit (events.js:191:7)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
gyp ERR! System Linux 4.2.0-16-generic
gyp ERR! command "/root/node-v6.10.2-linux-x64/bin/node" "/root/node-v6.10.2-linux-x64/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "rebuild"
gyp ERR! cwd /root/node_modules/zmq
gyp ERR! node -v v6.10.2
gyp ERR! node-gyp -v v3.4.0
gyp ERR! not ok 
npm WARN enoent ENOENT: no such file or directory, open '/root/package.json'
npm WARN root No description
npm WARN root No repository field.
npm WARN root No README data
npm WARN root No license field.
npm ERR! Linux 4.2.0-16-generic
npm ERR! argv "/root/node-v6.10.2-linux-x64/bin/node" "/usr/local/bin/npm" "install" "zmq"
npm ERR! node v6.10.2
npm ERR! npm  v3.10.10
npm ERR! code ELIFECYCLE

npm ERR! zmq@2.15.3 install: `node-gyp rebuild`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the zmq@2.15.3 install script 'node-gyp rebuild'.
npm ERR! Make sure you have the latest version of node.js and npm installed.
npm ERR! If you do, this is most likely a problem with the zmq package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get information on how to open an issue for this project with:
npm ERR!     npm bugs zmq
npm ERR! Or if that isn't available, you can get their info via:
npm ERR!     npm owner ls zmq
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /root/npm-debug.log
 # thank u now problem：
stf@wzl-virtual-machine:/root/node-v6.10.2-linux-x64/lib/node_modules/stf/bin$ ./stf doctor
INF/util:doctor 15869 [*] OS Arch: x64
INF/util:doctor 15869 [*] OS Platform: linux
INF/util:doctor 15869 [*] OS Platform: 4.2.0-16-generic
INF/util:doctor 15869 [*] Using Node 6.10.2
INF/util:doctor 15869 [*] Using RethinkDB client 2.3.3
INF/util:doctor 15869 [*] Using ZeroMQ 4.1.6
WRN/util:doctor 15869 [*] Executable was not found
INF/util:doctor 15869 [*] Local ADB 1.0.31
INF/util:doctor 15869 [*] GraphicsMagick 1.3.21
INF/util:doctor 15869 [*] Local RethinkDB server 2.3.5~0wily
/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 2.3.5~0wily
    at new SemVer (/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/root/node-v6.10.2-linux-x64/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /root/node-v6.10.2-linux-x64/lib/node_modules/stf/lib/util/doctor.js:95:7
    at /root/node-v6.10.2-linux-x64/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:195:7)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at maybeClose (internal/child_process.js:886:16)
    at Socket.<anonymous> (internal/child_process.js:342:11)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at Pipe._handle.close [as _onclose] (net.js:501:12)
 thank you   # npm-debug.log:
64933 info lifecycle basic-auth@1.1.0~install: basic-auth@1.1.0
64934 silly lifecycle basic-auth@1.1.0~install: no script for install, continuing
64935 silly install bufferutil@1.3.0 /root/node-v6.10.2-linux-x64/lib/node_modules/.staging/bufferutil-08da6e97
64936 info lifecycle bufferutil@1.3.0~install: bufferutil@1.3.0
64937 verbose lifecycle bufferutil@1.3.0~install: unsafe-perm in lifecycle false
64938 verbose lifecycle bufferutil@1.3.0~install: PATH: /root/node-v6.10.2-linux-x64/lib/node_modules/npm/bin/node-gyp-bin:/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/bufferutil/node_modules/.bin:/root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/.bin:/root/node-v6.10.2-linux-x64/lib/node_modules/.bin:/root/node-v6.10.2-linux-x64/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/root/android-sdk-linux/tools:/root/android-sdk-linux/platform-tools:/root/root/android-sdk-linux/tools:/root/root/android-sdk-linux/platform-tools:/usr/local/protobuf/bin/
64939 verbose lifecycle bufferutil@1.3.0~install: CWD: /root/node-v6.10.2-linux-x64/lib/node_modules/stf/node_modules/bufferutil
64940 silly lifecycle bufferutil@1.3.0~install: Args: [ '-c', 'node-gyp rebuild' ]
64941 info lifecycle bufferutil@1.3.0~install: Failed to exec install script
64942 verbose unlock done using /root/.npm/_locks/staging-5e8af678fb34472d.lock for /root/node-v6.10.2-linux-x64/lib/node_modules/.staging
64943 silly rollbackFailedOptional Starting
64944 silly rollbackFailedOptional Finishing
64945 silly runTopLevelLifecycles Finishing
64946 silly install printInstalled
64947 warn optional SKIPPING OPTIONAL DEPENDENCY: dtrace-provider@0.8.1 (node_modules/stf/node_modules/bunyan/node_modules/dtrace-provider):
64948 warn optional SKIPPING OPTIONAL DEPENDENCY: dtrace-provider@0.8.1 install: `node scripts/install.js`
64948 warn optional SKIPPING OPTIONAL DEPENDENCY: spawn ENOENT
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY:
64949 verbose optional Failed at the dtrace-provider@0.8.1 install script 'node scripts/install.js'.
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY: Make sure you have the latest version of node.js and npm installed.
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY: If you do, this is most likely a problem with the dtrace-provider package,
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY: not with npm itself.
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY: Tell the author that this fails on your system:
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY:     node scripts/install.js
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY: You can get information on how to open an issue for this project with:
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY:     npm bugs dtrace-provider
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY: Or if that isn't available, you can get their info via:
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY:     npm owner ls dtrace-provider
64949 verbose optional SKIPPING OPTIONAL DEPENDENCY: There is likely additional logging output above.
64950 warn optional SKIPPING OPTIONAL DEPENDENCY: dtrace-provider@0.7.1 (node_modules/stf/node_modules/dtrace-provider):
64951 warn optional SKIPPING OPTIONAL DEPENDENCY: dtrace-provider@0.7.1 install: `node scripts/install.js`
64951 warn optional SKIPPING OPTIONAL DEPENDENCY: spawn ENOENT
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY:
64952 verbose optional Failed at the dtrace-provider@0.7.1 install script 'node scripts/install.js'.
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY: Make sure you have the latest version of node.js and npm installed.
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY: If you do, this is most likely a problem with the dtrace-provider package,
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY: not with npm itself.
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY: Tell the author that this fails on your system:
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY:     node scripts/install.js
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY: You can get information on how to open an issue for this project with:
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY:     npm bugs dtrace-provider
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY: Or if that isn't available, you can get their info via:
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY:     npm owner ls dtrace-provider
64952 verbose optional SKIPPING OPTIONAL DEPENDENCY: There is likely additional logging output above.
64953 verbose stack Error: bufferutil@1.3.0 install: `node-gyp rebuild`
64953 verbose stack spawn ENOENT
64953 verbose stack     at ChildProcess.<anonymous> (/root/node-v6.10.2-linux-x64/lib/node_modules/npm/lib/utils/spawn.js:33:16)
64953 verbose stack     at emitTwo (events.js:106:13)
64953 verbose stack     at ChildProcess.emit (events.js:191:7)
64953 verbose stack     at maybeClose (internal/child_process.js:886:16)
64953 verbose stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:226:5)
64954 verbose pkgid bufferutil@1.3.0
64955 verbose cwd /root
64956 error Linux 4.2.0-16-generic
64957 error argv "/root/node-v6.10.2-linux-x64/bin/node" "/usr/local/bin/npm" "install" "-g" "stf"
64958 error node v6.10.2
64959 error npm  v3.10.10
64960 error file sh
64961 error code ELIFECYCLE
64962 error errno ENOENT
64963 error syscall spawn
64964 error bufferutil@1.3.0 install: `node-gyp rebuild`
64964 error spawn ENOENT
64965 error Failed at the bufferutil@1.3.0 install script 'node-gyp rebuild'.
64965 error Make sure you have the latest version of node.js and npm installed.
64965 error If you do, this is most likely a problem with the bufferutil package,
64965 error not with npm itself.
64965 error Tell the author that this fails on your system:
64965 error     node-gyp rebuild
64965 error You can get information on how to open an issue for this project with:
64965 error     npm bugs bufferutil
64965 error Or if that isn't available, you can get their info via:
64965 error     npm owner ls bufferutil
64965 error There is likely additional logging output above.
64966 verbose exit [ 1, true ] thank you . The problem has been solved  I'm trying to connect a device using 'adb connect' with the device.display.url value <"ws://ip:port"> but the device doesn't appear in the list. Then I tried to connect using the Remote Debug URL and it works. Shouldn't it be the same value in both cases?
![devicedisplayurl](https://cloud.githubusercontent.com/assets/599132/25147758/fbb846d6-244e-11e7-8a3e-f3fc51e53295.png)
![remotedebug](https://cloud.githubusercontent.com/assets/599132/25147771/0462ec78-244f-11e7-8158-d37cd9393c06.png)

  When I Installing “STF”，Wrong

STEP1:   nodejs,Adb,rethinkdb,GM,zeroMQ,Bower,libsodium,protobuf,pkg-config,yasm    OK!
STEP2:   git clone https://github.com/openstf/stf.git
STEP3:   npm install, in this step WRONG


LOG stop HERE:
npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@^1.0.0 (node_modules/chokidar/node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.1: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})




 ALL LOG:

Inspiron-7420:~/Stftest/stf$ npm install
npm WARN deprecated minimatch@2.0.10: Please update to minimatch 3.0.2 or higher to avoid a RegExp DoS issue
npm WARN deprecated minimatch@0.2.14: Please update to minimatch 3.0.2 or higher to avoid a RegExp DoS issue
npm WARN deprecated graceful-fs@1.2.3: graceful-fs v3.0.0 and before will fail on node releases >= v7.0. Please update to graceful-fs@^4.0.0 as soon as possible. Use 'npm ls graceful-fs' to find it in the tree.
npm WARN deprecated minimatch@0.3.0: Please update to minimatch 3.0.2 or higher to avoid a RegExp DoS issue
npm WARN deprecated jade@1.11.0: Jade has been renamed to pug, please install the latest version of pug instead of jade
npm WARN deprecated transformers@2.1.0: Deprecated, use jstransformer
npm WARN prefer global marked@0.3.6 should be installed with -g
npm WARN prefer global jsonlint@1.6.2 should be installed with -g
npm WARN prefer global node-gyp@3.6.0 should be installed with -g

> dtrace-provider@0.8.1 install /home/wangpengfei/Stftest/stf/node_modules/bunyan/node_modules/dtrace-provider
> node scripts/install.js


> dtrace-provider@0.7.1 install /home/wangpengfei/Stftest/stf/node_modules/dtrace-provider
> node scripts/install.js


> phantomjs-prebuilt@2.1.14 install /home/wangpengfei/Stftest/stf/node_modules/phantomjs-prebuilt
> node install.js

PhantomJS not found on PATH
Download already available at /tmp/phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2
Verified checksum of previously downloaded file
Extracting tar contents (via spawned process)
Removing /home/wangpengfei/Stftest/stf/node_modules/phantomjs-prebuilt/lib/phantom
Copying extracted folder /tmp/phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2-extract-1492502299390/phantomjs-2.1.1-linux-x86_64 -> /home/wangpengfei/Stftest/stf/node_modules/phantomjs-prebuilt/lib/phantom
Writing location.js file
Done. Phantomjs binary available at /home/wangpengfei/Stftest/stf/node_modules/phantomjs-prebuilt/lib/phantom/bin/phantomjs

> bufferutil@1.3.0 install /home/wangpengfei/Stftest/stf/node_modules/bufferutil
> node-gyp rebuild

make: Entering directory '/home/wangpengfei/Stftest/stf/node_modules/bufferutil/build'
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
  SOLINK_MODULE(target) Release/obj.target/bufferutil.node
  COPY Release/bufferutil.node
make: Leaving directory '/home/wangpengfei/Stftest/stf/node_modules/bufferutil/build'

> jpeg-turbo@0.4.0 install /home/wangpengfei/Stftest/stf/node_modules/jpeg-turbo
> node-pre-gyp install --fallback-to-build

make: Entering directory '/home/wangpengfei/Stftest/stf/node_modules/jpeg-turbo/build'
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_0 Release/obj/gen/jfdctflt-sse-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_1 Release/obj/gen/jccolor-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_2 Release/obj/gen/jcgray-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_3 Release/obj/gen/jcsample-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_4 Release/obj/gen/jdcolor-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_5 Release/obj/gen/jdmerge-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_6 Release/obj/gen/jdsample-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_7 Release/obj/gen/jfdctfst-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_8 Release/obj/gen/jfdctint-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_9 Release/obj/gen/jidctflt-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_10 Release/obj/gen/jidctfst-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_11 Release/obj/gen/jidctint-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_12 Release/obj/gen/jidctred-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_13 Release/obj/gen/jquantf-sse2-64.o
  RULE deps_libjpeg_turbo_gyp_jpeg_turbo_target_assemble_14 Release/obj/gen/jquanti-sse2-64.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcapimin.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcapistd.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jccoefct.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jccolor.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcdctmgr.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jchuff.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcinit.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcmainct.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcmarker.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcmaster.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcomapi.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcparam.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcphuff.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcprepct.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcsample.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jctrans.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdapimin.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdapistd.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdatadst.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdatasrc.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdcoefct.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdcolor.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jddctmgr.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdhuff.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdinput.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdmainct.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdmarker.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdmaster.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdmerge.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdphuff.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdpostct.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdsample.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdtrans.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jerror.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jfdctflt.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jfdctfst.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jfdctint.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jidctflt.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jidctfst.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jidctint.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jidctred.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jquant1.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jquant2.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jutils.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jmemmgr.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jmemnobs.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jaricom.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jcarith.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdarith.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/turbojpeg.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/transupp.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdatadst-tj.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/jdatasrc-tj.o
  CC(target) Release/obj.target/jpeg-turbo/deps/libjpeg-turbo/simd/jsimd_x86_64.o
  AR(target) Release/obj.target/deps/libjpeg-turbo.a
  COPY Release/libjpeg-turbo.a
  CXX(target) Release/obj.target/jpegturbo/src/buffersize.o
In file included from ../src/buffersize.cc:1:0:
../src/exports.h:14:12: warning: ‘DEFAULT_QUALITY’ defined but not used [-Wunused-variable]
 static int DEFAULT_QUALITY = 80;
            ^
  CXX(target) Release/obj.target/jpegturbo/src/compress.o
  CXX(target) Release/obj.target/jpegturbo/src/decompress.o
In file included from ../src/decompress.cc:1:0:
../src/exports.h:14:12: warning: ‘DEFAULT_QUALITY’ defined but not used [-Wunused-variable]
 static int DEFAULT_QUALITY = 80;
            ^
../src/exports.h:15:12: warning: ‘DEFAULT_SUBSAMPLING’ defined but not used [-Wunused-variable]
 static int DEFAULT_SUBSAMPLING = TJSAMP_420;
            ^
  CXX(target) Release/obj.target/jpegturbo/src/exports.o
In file included from ../src/exports.cc:1:0:
../src/exports.h:14:12: warning: ‘DEFAULT_QUALITY’ defined but not used [-Wunused-variable]
 static int DEFAULT_QUALITY = 80;
            ^
../src/exports.h:15:12: warning: ‘DEFAULT_SUBSAMPLING’ defined but not used [-Wunused-variable]
 static int DEFAULT_SUBSAMPLING = TJSAMP_420;
            ^
  SOLINK_MODULE(target) Release/obj.target/jpegturbo.node
  COPY Release/jpegturbo.node
  COPY /home/wangpengfei/Stftest/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node
  TOUCH Release/obj.target/action_after_build.stamp
make: Leaving directory '/home/wangpengfei/Stftest/stf/node_modules/jpeg-turbo/build'

> node-sass@3.13.1 install /home/wangpengfei/Stftest/stf/node_modules/node-sass
> node scripts/install.js

Downloading binary from https://github.com/sass/node-sass/releases/download/v3.13.1/linux-x64-51_binding.node
Download complete..] - :
Binary saved to /home/wangpengfei/Stftest/stf/node_modules/node-sass/vendor/linux-x64-51/binding.node
Caching binary to /home/wangpengfei/.npm/node-sass/3.13.1/linux-x64-51_binding.node

> utf-8-validate@1.2.2 install /home/wangpengfei/Stftest/stf/node_modules/utf-8-validate
> node-gyp rebuild

make: Entering directory '/home/wangpengfei/Stftest/stf/node_modules/utf-8-validate/build'
  CXX(target) Release/obj.target/validation/src/validation.o
  SOLINK_MODULE(target) Release/obj.target/validation.node
  COPY Release/validation.node
make: Leaving directory '/home/wangpengfei/Stftest/stf/node_modules/utf-8-validate/build'

> zmq@2.15.3 install /home/wangpengfei/Stftest/stf/node_modules/zmq
> node-gyp rebuild

make: Entering directory '/home/wangpengfei/Stftest/stf/node_modules/zmq/build'
  CXX(target) Release/obj.target/zmq/binding.o
  SOLINK_MODULE(target) Release/obj.target/zmq.node
  COPY Release/zmq.node
make: Leaving directory '/home/wangpengfei/Stftest/stf/node_modules/zmq/build'

> node-sass@3.13.1 postinstall /home/wangpengfei/Stftest/stf/node_modules/node-sass
> node scripts/build.js

Binary found at /home/wangpengfei/Stftest/stf/node_modules/node-sass/vendor/linux-x64-51/binding.node
Testing binary
Binary is fine

> stf@2.3.0 prepublish /home/wangpengfei/Stftest/stf
> bower install && not-in-install && gulp build || in-install

stf@2.3.0 /home/wangpengfei/Stftest/stf
├─┬ @slack/client@3.9.0 
│ ├── bluebird@3.5.0 
│ ├─┬ https-proxy-agent@1.0.0 
│ │ └─┬ agent-base@2.0.1 
│ │   └── semver@5.0.3 
│ ├── inherits@2.0.3 
│ ├── pkginfo@0.4.0 
│ ├── retry@0.9.0 
│ ├── url-join@0.0.1 
│ └─┬ winston@2.3.1 
│   ├── async@1.0.0 
│   ├── colors@1.0.3 
│   ├── cycle@1.0.3 
│   ├── eyes@0.1.8 
│   └── stack-trace@0.0.9 
├─┬ adbkit@2.9.0 
│ ├── adbkit-logcat@1.1.0 
│ ├── bluebird@2.9.34 
│ ├─┬ commander@2.9.0 
│ │ └── graceful-readlink@1.0.1 
│ ├── node-forge@0.6.49 
│ └── split@0.3.3 
├─┬ adbkit-apkreader@2.1.1 
│ ├── bluebird@3.5.0 
│ ├── debug@0.7.4 
│ └─┬ yauzl@2.7.0 
│   ├── buffer-crc32@0.2.13 
│   └─┬ fd-slicer@1.0.1 
│     └── pend@1.2.0 
├─┬ adbkit-monkey@1.0.1 
│ └── async@0.2.10 
├── async@2.3.0 
├─┬ aws-sdk@2.41.0 
│ ├─┬ buffer@4.9.1 
│ │ ├── base64-js@1.2.0 
│ │ ├── ieee754@1.1.8 
│ │ └── isarray@1.0.0 
│ ├── crypto-browserify@1.0.9 
│ ├── jmespath@0.15.0 
│ ├── querystring@0.2.0 
│ ├── sax@1.2.1 
│ ├─┬ url@0.10.3 
│ │ └── punycode@1.3.2 
│ ├── xml2js@0.4.17 
│ └── xmlbuilder@4.2.1 
├── basic-auth@1.1.0 
├── bluebird@2.11.0 
├─┬ body-parser@1.17.1 
│ ├── bytes@2.4.0 
│ ├── content-type@1.0.2 
│ ├── debug@2.6.1 
│ ├── depd@1.1.0 
│ ├── http-errors@1.6.1 
│ ├── iconv-lite@0.4.15 
│ ├─┬ on-finished@2.3.0 
│ │ └── ee-first@1.1.1 
│ ├── qs@6.4.0 
│ ├─┬ raw-body@2.2.0 
│ │ └── unpipe@1.0.0 
│ └─┬ type-is@1.6.15 
│   └── media-typer@0.3.0 
├── bower@1.8.0 
├─┬ bufferutil@1.3.0 
│ ├── bindings@1.2.1 
│ └── nan@2.4.0 
├─┬ chai@3.5.0 
│ ├── assertion-error@1.0.2 
│ ├─┬ deep-eql@0.1.3 
│ │ └── type-detect@0.1.1 
│ └── type-detect@1.0.0 
├─┬ chalk@1.1.3 
│ ├── ansi-styles@2.2.1 
│ ├── escape-string-regexp@1.0.5 
│ ├─┬ has-ansi@2.0.0 
│ │ └── ansi-regex@2.1.1 
│ ├── strip-ansi@3.0.1 
│ └── supports-color@2.0.0 
├─┬ compression@1.6.2 
│ ├─┬ accepts@1.3.3 
│ │ └── negotiator@0.6.1 
│ ├── bytes@2.3.0 
│ ├─┬ compressible@2.0.10 
│ │ └── mime-db@1.27.0 
│ ├─┬ debug@2.2.0 
│ │ └── ms@0.7.1 
│ ├── on-headers@1.0.1 
│ └── vary@1.1.1 
├─┬ cookie-session@2.0.0-beta.1 
│ ├─┬ cookies@0.7.0 
│ │ └── keygrip@1.0.1 
│ └── debug@2.6.1 
├─┬ css-loader@0.23.1 
│ ├─┬ css-selector-tokenizer@0.5.4 
│ │ └── cssesc@0.1.0 
│ ├─┬ cssnano@3.10.0 
│ │ ├─┬ autoprefixer@6.7.7 
│ │ │ ├─┬ browserslist@1.7.7 
│ │ │ │ └── electron-to-chromium@1.3.3 
│ │ │ ├── caniuse-db@1.0.30000655 
│ │ │ ├── normalize-range@0.1.2 
│ │ │ └── num2fraction@1.2.2 
│ │ ├── defined@1.0.0 
│ │ ├─┬ has@1.0.1 
│ │ │ └── function-bind@1.1.0 
│ │ ├─┬ postcss-calc@5.3.1 
│ │ │ ├── postcss-message-helpers@2.0.0 
│ │ │ └─┬ reduce-css-calc@1.3.0 
│ │ │   ├── math-expression-evaluator@1.2.16 
│ │ │   └── reduce-function-call@1.0.2 
│ │ ├─┬ postcss-colormin@2.2.2 
│ │ │ └─┬ colormin@1.1.2 
│ │ │   ├─┬ color@0.11.4 
│ │ │   │ ├─┬ color-convert@1.9.0 
│ │ │   │ │ └── color-name@1.1.2 
│ │ │   │ └── color-string@0.3.0 
│ │ │   └── css-color-names@0.0.4 
│ │ ├── postcss-convert-values@2.6.1 
│ │ ├── postcss-discard-comments@2.0.4 
│ │ ├── postcss-discard-duplicates@2.1.0 
│ │ ├── postcss-discard-empty@2.1.0 
│ │ ├── postcss-discard-overridden@0.1.1 
│ │ ├─┬ postcss-discard-unused@2.2.3 
│ │ │ └── uniqs@2.0.0 
│ │ ├─┬ postcss-filter-plugins@2.0.2 
│ │ │ └─┬ uniqid@4.1.1 
│ │ │   └── macaddress@0.2.8 
│ │ ├── postcss-merge-idents@2.1.7 
│ │ ├── postcss-merge-longhand@2.0.2 
│ │ ├─┬ postcss-merge-rules@2.1.2 
│ │ │ ├─┬ caniuse-api@1.6.1 
│ │ │ │ ├── lodash.memoize@4.1.2 
│ │ │ │ └── lodash.uniq@4.5.0 
│ │ │ ├─┬ postcss-selector-parser@2.2.3 
│ │ │ │ ├── flatten@1.0.2 
│ │ │ │ ├── indexes-of@1.0.1 
│ │ │ │ └── uniq@1.0.1 
│ │ │ └── vendors@1.0.1 
│ │ ├── postcss-minify-font-values@1.0.5 
│ │ ├── postcss-minify-gradients@1.0.5 
│ │ ├─┬ postcss-minify-params@1.2.2 
│ │ │ └── alphanum-sort@1.0.2 
│ │ ├── postcss-minify-selectors@2.1.1 
│ │ ├── postcss-normalize-charset@1.1.1 
│ │ ├─┬ postcss-normalize-url@3.0.8 
│ │ │ ├── is-absolute-url@2.1.0 
│ │ │ └─┬ normalize-url@1.9.1 
│ │ │   ├── prepend-http@1.0.4 
│ │ │   ├─┬ query-string@4.3.3 
│ │ │   │ └── strict-uri-encode@1.1.0 
│ │ │   └─┬ sort-keys@1.1.2 
│ │ │     └── is-plain-obj@1.1.0 
│ │ ├── postcss-ordered-values@2.2.3 
│ │ ├── postcss-reduce-idents@2.4.0 
│ │ ├── postcss-reduce-initial@1.0.1 
│ │ ├── postcss-reduce-transforms@1.0.4 
│ │ ├─┬ postcss-svgo@2.1.6 
│ │ │ ├─┬ is-svg@2.1.0 
│ │ │ │ └── html-comment-regex@1.1.1 
│ │ │ └─┬ svgo@0.7.2 
│ │ │   ├── coa@1.0.1 
│ │ │   ├── colors@1.1.2 
│ │ │   ├─┬ csso@2.3.2 
│ │ │   │ ├── clap@1.1.3 
│ │ │   │ └── source-map@0.5.6 
│ │ │   ├─┬ js-yaml@3.7.0 
│ │ │   │ └── esprima@2.7.3 
│ │ │   └── whet.extend@0.9.9 
│ │ ├── postcss-unique-selectors@2.0.2 
│ │ ├── postcss-value-parser@3.3.0 
│ │ └── postcss-zindex@2.2.0 
│ ├─┬ loader-utils@0.2.17 
│ │ ├── big.js@3.1.3 
│ │ ├── emojis-list@2.1.0 
│ │ └── json5@0.5.1 
│ ├─┬ lodash.camelcase@3.0.1 
│ │ └─┬ lodash._createcompounder@3.0.0 
│ │   ├── lodash.deburr@3.2.0 
│ │   └── lodash.words@3.2.0 
│ ├── object-assign@4.1.1 
│ ├─┬ postcss@5.2.17 
│ │ ├── js-base64@2.1.9 
│ │ ├── source-map@0.5.6 
│ │ └── supports-color@3.2.3 
│ ├── postcss-modules-extract-imports@1.0.1 
│ ├─┬ postcss-modules-local-by-default@1.1.1 
│ │ └─┬ css-selector-tokenizer@0.6.0 
│ │   └─┬ regexpu-core@1.0.0 
│ │     ├── regenerate@1.3.2 
│ │     ├── regjsgen@0.2.0 
│ │     └─┬ regjsparser@0.1.5 
│ │       └── jsesc@0.5.0 
│ ├─┬ postcss-modules-scope@1.0.2 
│ │ └── css-selector-tokenizer@0.6.0 
│ ├─┬ postcss-modules-values@1.2.2 
│ │ └── icss-replace-symbols@1.0.2 
│ └── source-list-map@0.1.8 
├─┬ csurf@1.9.0 
│ ├── cookie@0.3.1 
│ ├── cookie-signature@1.0.6 
│ ├─┬ csrf@3.0.6 
│ │ ├── rndm@1.2.0 
│ │ ├── tsscmp@1.0.5 
│ │ └─┬ uid-safe@2.1.4 
│ │   └── random-bytes@1.0.0 
│ └─┬ http-errors@1.5.1 
│   └── setprototypeof@1.0.2 
├─┬ debug@2.6.3 
│ └── ms@0.7.2 
├─┬ del@2.2.2 
│ ├─┬ globby@5.0.0 
│ │ ├── array-union@1.0.2 
│ │ ├── arrify@1.0.1 
│ │ └── glob@7.1.1 
│ ├── is-path-cwd@1.0.0 
│ ├─┬ is-path-in-cwd@1.0.0 
│ │ └── is-path-inside@1.0.0 
│ ├── pify@2.3.0 
│ ├─┬ pinkie-promise@2.0.1 
│ │ └── pinkie@2.0.4 
│ └─┬ rimraf@2.4.5 
│   └── glob@6.0.4 
├─┬ eslint@3.19.0 
│ ├─┬ babel-code-frame@6.22.0 
│ │ └── js-tokens@3.0.1 
│ ├─┬ concat-stream@1.6.0 
│ │ ├─┬ readable-stream@2.2.9 
│ │ │ └── string_decoder@1.0.0 
│ │ └── typedarray@0.0.6 
│ ├── doctrine@2.0.0 
│ ├─┬ escope@3.6.0 
│ │ ├─┬ es6-map@0.1.5 
│ │ │ ├── d@1.0.0 
│ │ │ ├── es5-ext@0.10.15 
│ │ │ ├── es6-iterator@2.0.1 
│ │ │ ├── es6-set@0.1.5 
│ │ │ ├── es6-symbol@3.1.1 
│ │ │ └── event-emitter@0.3.5 
│ │ ├── es6-weak-map@2.0.2 
│ │ └─┬ esrecurse@4.1.0 
│ │   └── estraverse@4.1.1 
│ ├─┬ espree@3.4.1 
│ │ ├── acorn@5.0.3 
│ │ └── acorn-jsx@3.0.1 
│ ├── esquery@1.0.0 
│ ├── estraverse@4.2.0 
│ ├── esutils@2.0.2 
│ ├─┬ file-entry-cache@2.0.0 
│ │ └─┬ flat-cache@1.2.2 
│ │   ├── circular-json@0.3.1 
│ │   └── write@0.2.1 
│ ├─┬ glob@7.1.1 
│ │ ├── fs.realpath@1.0.0 
│ │ └── inflight@1.0.6 
│ ├── globals@9.17.0 
│ ├── ignore@3.2.7 
│ ├── imurmurhash@0.1.4 
│ ├─┬ inquirer@0.12.0 
│ │ ├── ansi-escapes@1.4.0 
│ │ ├─┬ cli-cursor@1.0.2 
│ │ │ └─┬ restore-cursor@1.0.1 
│ │ │   ├── exit-hook@1.1.1 
│ │ │   └── onetime@1.1.0 
│ │ ├── cli-width@2.1.0 
│ │ ├── figures@1.7.0 
│ │ ├─┬ readline2@1.0.1 
│ │ │ └── mute-stream@0.0.5 
│ │ ├── run-async@0.1.0 
│ │ └── rx-lite@3.1.2 
│ ├─┬ is-my-json-valid@2.16.0 
│ │ ├── generate-function@2.0.0 
│ │ ├─┬ generate-object-property@1.2.0 
│ │ │ └── is-property@1.0.2 
│ │ ├── jsonpointer@4.0.1 
│ │ └── xtend@4.0.1 
│ ├─┬ is-resolvable@1.0.0 
│ │ └── tryit@1.0.3 
│ ├─┬ js-yaml@3.8.3 
│ │ ├─┬ argparse@1.0.9 
│ │ │ └── sprintf-js@1.0.3 
│ │ └── esprima@3.1.3 
│ ├─┬ json-stable-stringify@1.0.1 
│ │ └── jsonify@0.0.0 
│ ├─┬ levn@0.3.0 
│ │ ├── prelude-ls@1.1.2 
│ │ └── type-check@0.3.2 
│ ├─┬ mkdirp@0.5.1 
│ │ └── minimist@0.0.8 
│ ├── natural-compare@1.4.0 
│ ├─┬ optionator@0.8.2 
│ │ ├── deep-is@0.1.3 
│ │ ├── fast-levenshtein@2.0.6 
│ │ └── wordwrap@1.0.0 
│ ├── path-is-inside@1.0.2 
│ ├── pluralize@1.2.1 
│ ├── progress@1.1.8 
│ ├─┬ require-uncached@1.0.3 
│ │ ├─┬ caller-path@0.1.0 
│ │ │ └── callsites@0.2.0 
│ │ └── resolve-from@1.0.1 
│ ├─┬ shelljs@0.7.7 
│ │ ├── glob@7.1.1 
│ │ └── rechoir@0.6.2 
│ ├── strip-bom@3.0.0 
│ ├── strip-json-comments@2.0.1 
│ ├─┬ table@3.8.3 
│ │ ├─┬ ajv@4.11.7 
│ │ │ └── co@4.6.0 
│ │ ├── ajv-keywords@1.5.1 
│ │ ├── slice-ansi@0.0.4 
│ │ └─┬ string-width@2.0.0 
│ │   └── is-fullwidth-code-point@2.0.0 
│ ├── text-table@0.2.0 
│ └─┬ user-home@2.0.0 
│   └── os-homedir@1.0.2 
├─┬ event-stream@3.3.4 
│ ├── duplexer@0.1.1 
│ ├── from@0.1.7 
│ ├── map-stream@0.1.0 
│ ├── pause-stream@0.0.11 
│ ├── split@0.3.3 
│ ├── stream-combiner@0.0.4 
│ └── through@2.3.8 
├── eventemitter3@1.2.0 
├─┬ exports-loader@0.6.4 
│ ├─┬ loader-utils@1.1.0 
│ │ └── json5@0.5.1 
│ └── source-map@0.5.6 
├─┬ express@4.15.2 
│ ├── array-flatten@1.1.1 
│ ├── content-disposition@0.5.2 
│ ├── debug@2.6.1 
│ ├── encodeurl@1.0.1 
│ ├── escape-html@1.0.3 
│ ├── etag@1.8.0 
│ ├── finalhandler@1.0.1 
│ ├── fresh@0.5.0 
│ ├── merge-descriptors@1.0.1 
│ ├── methods@1.1.2 
│ ├── parseurl@1.3.1 
│ ├── path-to-regexp@0.1.7 
│ ├── range-parser@1.2.0 
│ ├─┬ send@0.15.1 
│ │ ├── debug@2.6.1 
│ │ └── destroy@1.0.4 
│ ├── setprototypeof@1.0.3 
│ ├── statuses@1.3.1 
│ └── utils-merge@1.0.0 
├─┬ express-validator@2.21.0 
│ ├── bluebird@3.4.7 
│ ├── lodash@4.16.6 
│ └── validator@5.7.0 
├─┬ extract-text-webpack-plugin@1.0.1 
│ ├── async@1.5.2 
│ └─┬ webpack-sources@0.1.5 
│   └── source-map@0.5.6 
├── file-loader@0.9.0 
├── formidable@1.1.1 
├─┬ gm@1.23.0 
│ ├── array-parallel@0.1.3 
│ ├── array-series@0.1.5 
│ ├─┬ cross-spawn@4.0.2 
│ │ └─┬ lru-cache@4.0.2 
│ │   ├── pseudomap@1.0.2 
│ │   └── yallist@2.1.2 
│ └─┬ debug@2.2.0 
│   └── ms@0.7.1 
├─┬ gulp@3.9.1 
│ ├── archy@1.0.0 
│ ├── deprecated@0.0.1 
│ ├── interpret@1.0.2 
│ ├─┬ liftoff@2.3.0 
│ │ ├─┬ findup-sync@0.4.3 
│ │ │ ├─┬ detect-file@0.1.0 
│ │ │ │ └── fs-exists-sync@0.1.0 
│ │ │ └─┬ resolve-dir@0.1.1 
│ │ │   └─┬ global-modules@0.2.3 
│ │ │     ├─┬ global-prefix@0.1.5 
│ │ │     │ └─┬ homedir-polyfill@1.0.1 
│ │ │     │   └── parse-passwd@1.0.0 
│ │ │     └── is-windows@0.2.0 
│ │ ├─┬ fined@1.0.2 
│ │ │ ├── expand-tilde@1.2.2 
│ │ │ ├── lodash.assignwith@4.2.0 
│ │ │ ├── lodash.isempty@4.4.0 
│ │ │ ├── lodash.pick@4.4.0 
│ │ │ └─┬ parse-filepath@1.0.1 
│ │ │   ├─┬ is-absolute@0.2.6 
│ │ │   │ └─┬ is-relative@0.2.1 
│ │ │   │   └─┬ is-unc-path@0.1.2 
│ │ │   │     └── unc-path-regex@0.1.2 
│ │ │   ├── map-cache@0.2.2 
│ │ │   └─┬ path-root@0.1.1 
│ │ │     └── path-root-regex@0.1.2 
│ │ ├── flagged-respawn@0.3.2 
│ │ ├── lodash.isplainobject@4.0.6 
│ │ ├── lodash.mapvalues@4.6.0 
│ │ └─┬ resolve@1.3.2 
│ │   └── path-parse@1.0.5 
│ ├── minimist@1.2.0 
│ ├─┬ orchestrator@0.3.8 
│ │ ├─┬ end-of-stream@0.1.5 
│ │ │ └── once@1.3.3 
│ │ ├── sequencify@0.0.7 
│ │ └── stream-consume@0.1.0 
│ ├── pretty-hrtime@1.0.3 
│ ├── semver@4.3.6 
│ ├── tildify@1.2.0 
│ ├─┬ v8flags@2.0.12 
│ │ └── user-home@1.1.1 
│ └─┬ vinyl-fs@0.3.14 
│   ├── defaults@1.0.3 
│   ├─┬ glob-stream@3.1.18 
│   │ ├── glob@4.5.3 
│   │ ├─┬ glob2base@0.0.12 
│   │ │ └── find-index@0.1.1 
│   │ ├── minimatch@2.0.10 
│   │ ├── ordered-read-streams@0.1.0 
│   │ ├─┬ through2@0.6.5 
│   │ │ └─┬ readable-stream@1.0.34 
│   │ │   └── isarray@0.0.1 
│   │ └── unique-stream@1.0.0 
│   ├─┬ glob-watcher@0.0.6 
│   │ └─┬ gaze@0.5.2 
│   │   └─┬ globule@0.1.0 
│   │     ├─┬ glob@3.1.21 
│   │     │ ├── graceful-fs@1.2.3 
│   │     │ └── inherits@1.0.2 
│   │     ├── lodash@1.0.2 
│   │     └─┬ minimatch@0.2.14 
│   │       └── lru-cache@2.7.3 
│   ├─┬ graceful-fs@3.0.11 
│   │ └── natives@1.1.0 
│   ├─┬ strip-bom@1.0.0 
│   │ ├── first-chunk-stream@1.0.0 
│   │ └── is-utf8@0.2.1 
│   ├─┬ through2@0.6.5 
│   │ └─┬ readable-stream@1.0.34 
│   │   └── isarray@0.0.1 
│   └─┬ vinyl@0.4.6 
│     └── clone@0.2.0 
├─┬ gulp-angular-gettext@2.2.0 
│ ├─┬ angular-gettext-tools@2.3.4 
│ │ ├── babylon@6.16.1 
│ │ ├── binary-search@1.3.2 
│ │ ├─┬ cheerio@0.19.0 
│ │ │ ├─┬ css-select@1.0.0 
│ │ │ │ ├── boolbase@1.0.0 
│ │ │ │ ├── css-what@1.0.0 
│ │ │ │ ├── domutils@1.4.3 
│ │ │ │ └── nth-check@1.0.1 
│ │ │ ├─┬ dom-serializer@0.1.0 
│ │ │ │ └── domelementtype@1.1.3 
│ │ │ ├── entities@1.1.1 
│ │ │ ├─┬ htmlparser2@3.8.3 
│ │ │ │ ├── domelementtype@1.3.0 
│ │ │ │ ├── domhandler@2.3.0 
│ │ │ │ ├── domutils@1.5.1 
│ │ │ │ └── entities@1.0.0 
│ │ │ └── lodash@3.10.1 
│ │ ├── pofile@1.0.7 
│ │ ├── typescript@2.0.10 
│ │ └─┬ typescript-eslint-parser@1.0.3 
│ │   └─┬ lodash.unescape@4.0.0 
│ │     └── lodash.tostring@4.1.4 
│ ├── lodash.isstring@4.0.1 
│ └─┬ through2@2.0.3 
│   └─┬ readable-stream@2.2.9 
│     └── string_decoder@1.0.0 
├─┬ gulp-eslint@3.0.1 
│ └─┬ bufferstreams@1.1.1 
│   └─┬ readable-stream@2.2.9 
│     └── string_decoder@1.0.0 
├─┬ gulp-jsonlint@1.2.0 
│ ├─┬ gulp-util@3.0.7 
│ │ ├── dateformat@1.0.12 
│ │ ├── minimist@1.2.0 
│ │ └── object-assign@3.0.0 
│ └─┬ jsonlint@1.6.2 
│   ├── JSV@4.0.2 
│   └─┬ nomnom@1.8.1 
│     └─┬ chalk@0.4.0 
│       ├── ansi-styles@1.0.0 
│       ├── has-color@0.1.7 
│       └── strip-ansi@0.1.1 
├─┬ gulp-protractor@3.0.0 
│ ├── async@1.5.2 
│ └─┬ dargs@4.1.0 
│   └── number-is-nan@1.0.1 
├── gulp-pug@3.3.0 
├─┬ gulp-run@1.7.1 
│ ├── lodash.defaults@4.2.0 
│ ├─┬ lodash.template@4.4.0 
│ │ └── lodash.templatesettings@4.1.0 
│ └─┬ vinyl@0.4.6 
│   ├── clone@0.2.0 
│   └── clone-stats@0.0.1 
├─┬ gulp-util@3.0.8 
│ ├── array-differ@1.0.0 
│ ├── array-uniq@1.0.3 
│ ├── beeper@1.1.1 
│ ├── dateformat@2.0.0 
│ ├─┬ fancy-log@1.3.0 
│ │ └── time-stamp@1.0.1 
│ ├─┬ gulplog@1.0.0 
│ │ └── glogg@1.0.0 
│ ├─┬ has-gulplog@0.1.0 
│ │ └── sparkles@1.0.0 
│ ├── lodash._reescape@3.0.0 
│ ├── lodash._reevaluate@3.0.0 
│ ├── lodash._reinterpolate@3.0.0 
│ ├─┬ lodash.template@3.6.2 
│ │ ├── lodash._basecopy@3.0.1 
│ │ ├── lodash._basetostring@3.0.1 
│ │ ├── lodash._basevalues@3.0.0 
│ │ ├── lodash._isiterateecall@3.0.9 
│ │ ├─┬ lodash.escape@3.2.0 
│ │ │ └── lodash._root@3.0.1 
│ │ ├─┬ lodash.keys@3.1.2 
│ │ │ ├── lodash._getnative@3.9.1 
│ │ │ ├── lodash.isarguments@3.1.0 
│ │ │ └── lodash.isarray@3.0.4 
│ │ ├── lodash.restparam@3.6.1 
│ │ └── lodash.templatesettings@3.1.1 
│ ├── minimist@1.2.0 
│ ├─┬ multipipe@0.1.2 
│ │ └─┬ duplexer2@0.0.2 
│ │   └─┬ readable-stream@1.1.14 
│ │     └── isarray@0.0.1 
│ ├── object-assign@3.0.0 
│ ├── replace-ext@0.0.1 
│ └── vinyl@0.5.3 
├─┬ hipchatter@0.3.2 
│ ├── async@0.2.10 
│ └── needle@1.6.0 
├─┬ html-loader@0.4.5 
│ ├─┬ es6-templates@0.2.3 
│ │ └─┬ recast@0.11.23 
│ │   ├── ast-types@0.9.6 
│ │   ├── esprima@3.1.3 
│ │   └── source-map@0.5.6 
│ ├── fastparse@1.1.1 
│ ├─┬ html-minifier@3.4.3 
│ │ ├─┬ camel-case@3.0.0 
│ │ │ ├─┬ no-case@2.3.1 
│ │ │ │ └── lower-case@1.1.4 
│ │ │ └── upper-case@1.1.3 
│ │ ├─┬ clean-css@4.0.12 
│ │ │ └── source-map@0.5.6 
│ │ ├── he@1.1.1 
│ │ ├─┬ ncname@1.0.0 
│ │ │ └── xml-char-classes@1.0.0 
│ │ ├── param-case@2.1.1 
│ │ ├── relateurl@0.2.7 
│ │ └─┬ uglify-js@2.8.22 
│ │   ├── source-map@0.5.6 
│ │   └── yargs@3.10.0 
│ └─┬ loader-utils@1.1.0 
│   └── json5@0.5.1 
├─┬ http-proxy@1.16.2 
│ └── requires-port@1.0.0 
├─┬ imports-loader@0.6.5 
│ └─┬ source-map@0.1.43 
│   └── amdefine@1.0.1 
├── in-publish@2.0.0 
├── jasmine-core@2.5.2 
├─┬ jasmine-reporters@2.2.1 
│ └── xmldom@0.1.27 
├─┬ jpeg-turbo@0.4.0 
│ └─┬ node-pre-gyp@0.6.19 
│   ├─┬ mkdirp@0.5.1 
│   │ └── minimist@0.0.8 
│   ├─┬ nopt@3.0.6 
│   │ └── abbrev@1.0.7 
│   ├─┬ npmlog@2.0.0 
│   │ ├── ansi@0.3.0 
│   │ ├─┬ are-we-there-yet@1.0.5 
│   │ │ ├── delegates@0.1.0 
│   │ │ └─┬ readable-stream@2.0.5 
│   │ │   ├── core-util-is@1.0.2 
│   │ │   ├── inherits@2.0.1 
│   │ │   ├── isarray@0.0.1 
│   │ │   ├── process-nextick-args@1.0.6 
│   │ │   ├── string_decoder@0.10.31 
│   │ │   └── util-deprecate@1.0.2 
│   │ └─┬ gauge@1.2.2 
│   │   ├── has-unicode@1.0.1 
│   │   ├─┬ lodash.pad@3.1.1 
│   │   │ ├── lodash._basetostring@3.0.1 
│   │   │ └─┬ lodash._createpadding@3.6.1 
│   │   │   └── lodash.repeat@3.0.1 
│   │   ├─┬ lodash.padleft@3.1.1 
│   │   │ ├── lodash._basetostring@3.0.1 
│   │   │ └─┬ lodash._createpadding@3.6.1 
│   │   │   └── lodash.repeat@3.0.1 
│   │   └─┬ lodash.padright@3.1.1 
│   │     ├── lodash._basetostring@3.0.1 
│   │     └─┬ lodash._createpadding@3.6.1 
│   │       └── lodash.repeat@3.0.1 
│   ├─┬ rc@1.1.6 
│   │ ├── deep-extend@0.4.0 
│   │ ├── ini@1.3.4 
│   │ ├── minimist@1.2.0 
│   │ └── strip-json-comments@1.0.4 
│   ├─┬ request@2.67.0 
│   │ ├── aws-sign2@0.6.0 
│   │ ├─┬ bl@1.0.0 
│   │ │ └─┬ readable-stream@2.0.5 
│   │ │   ├── core-util-is@1.0.2 
│   │ │   ├── inherits@2.0.1 
│   │ │   ├── isarray@0.0.1 
│   │ │   ├── process-nextick-args@1.0.6 
│   │ │   ├── string_decoder@0.10.31 
│   │ │   └── util-deprecate@1.0.2 
│   │ ├── caseless@0.11.0 
│   │ ├─┬ combined-stream@1.0.5 
│   │ │ └── delayed-stream@1.0.0 
│   │ ├── extend@3.0.0 
│   │ ├── forever-agent@0.6.1 
│   │ ├─┬ form-data@1.0.0-rc3 
│   │ │ └── async@1.5.1 
│   │ ├─┬ har-validator@2.0.3 
│   │ │ ├─┬ chalk@1.1.1 
│   │ │ │ ├── ansi-styles@2.1.0 
│   │ │ │ ├── escape-string-regexp@1.0.4 
│   │ │ │ ├─┬ has-ansi@2.0.0 
│   │ │ │ │ └── ansi-regex@2.0.0 
│   │ │ │ ├─┬ strip-ansi@3.0.0 
│   │ │ │ │ └── ansi-regex@2.0.0 
│   │ │ │ └── supports-color@2.0.0 
│   │ │ ├─┬ commander@2.9.0 
│   │ │ │ └── graceful-readlink@1.0.1 
│   │ │ ├─┬ is-my-json-valid@2.12.3 
│   │ │ │ ├── generate-function@2.0.0 
│   │ │ │ ├─┬ generate-object-property@1.2.0 
│   │ │ │ │ └── is-property@1.0.2 
│   │ │ │ ├── jsonpointer@2.0.0 
│   │ │ │ └── xtend@4.0.1 
│   │ │ └─┬ pinkie-promise@2.0.0 
│   │ │   └── pinkie@2.0.1 
│   │ ├─┬ hawk@3.1.2 
│   │ │ ├── boom@2.10.1 
│   │ │ ├── cryptiles@2.0.5 
│   │ │ ├── hoek@2.16.3 
│   │ │ └── sntp@1.0.9 
│   │ ├─┬ http-signature@1.1.0 
│   │ │ ├── assert-plus@0.1.5 
│   │ │ ├─┬ jsprim@1.2.2 
│   │ │ │ ├── extsprintf@1.0.2 
│   │ │ │ ├── json-schema@0.2.2 
│   │ │ │ └── verror@1.3.6 
│   │ │ └─┬ sshpk@1.7.2 
│   │ │   ├── asn1@0.2.3 
│   │ │   ├── assert-plus@0.2.0 
│   │ │   ├─┬ dashdash@1.11.0 
│   │ │   │ └── assert-plus@0.1.5 
│   │ │   ├── ecc-jsbn@0.1.1 
│   │ │   ├── jodid25519@1.0.2 
│   │ │   ├── jsbn@0.1.0 
│   │ │   └── tweetnacl@0.13.2 
│   │ ├── is-typedarray@1.0.0 
│   │ ├── isstream@0.1.2 
│   │ ├── json-stringify-safe@5.0.1 
│   │ ├─┬ mime-types@2.1.9 
│   │ │ └── mime-db@1.21.0 
│   │ ├── node-uuid@1.4.7 
│   │ ├── oauth-sign@0.8.0 
│   │ ├── qs@5.2.0 
│   │ ├── stringstream@0.0.5 
│   │ ├── tough-cookie@2.2.1 
│   │ └── tunnel-agent@0.4.2 
│   ├─┬ rimraf@2.5.0 
│   │ └─┬ glob@6.0.3 
│   │   ├─┬ inflight@1.0.4 
│   │   │ └── wrappy@1.0.1 
│   │   ├── inherits@2.0.1 
│   │   ├─┬ minimatch@3.0.0 
│   │   │ └─┬ brace-expansion@1.1.2 
│   │   │   ├── balanced-match@0.3.0 
│   │   │   └── concat-map@0.0.1 
│   │   ├─┬ once@1.3.3 
│   │   │ └── wrappy@1.0.1 
│   │   └── path-is-absolute@1.0.0 
│   ├── semver@5.1.0 
│   ├─┬ tar@2.2.1 
│   │ ├── block-stream@0.0.8 
│   │ ├─┬ fstream@1.0.8 
│   │ │ └── graceful-fs@4.1.2 
│   │ └── inherits@2.0.1 
│   └─┬ tar-pack@3.1.2 
│     ├── debug@0.7.4 
│     ├─┬ fstream@1.0.8 
│     │ ├── graceful-fs@4.1.2 
│     │ └── inherits@2.0.1 
│     ├─┬ fstream-ignore@1.0.3 
│     │ ├── inherits@2.0.1 
│     │ └─┬ minimatch@3.0.0 
│     │   └─┬ brace-expansion@1.1.2 
│     │     ├── balanced-match@0.3.0 
│     │     └── concat-map@0.0.1 
│     ├── once@1.1.1 
│     ├─┬ readable-stream@2.0.5 
│     │ ├── core-util-is@1.0.2 
│     │ ├── inherits@2.0.1 
│     │ ├── isarray@0.0.1 
│     │ ├── process-nextick-args@1.0.6 
│     │ ├── string_decoder@0.10.31 
│     │ └── util-deprecate@1.0.2 
│     ├─┬ rimraf@2.4.5 
│     │ └─┬ glob@6.0.3 
│     │   ├─┬ inflight@1.0.4 
│     │   │ └── wrappy@1.0.1 
│     │   ├── inherits@2.0.1 
│     │   ├─┬ minimatch@3.0.0 
│     │   │ └─┬ brace-expansion@1.1.2 
│     │   │   ├── balanced-match@0.3.0 
│     │   │   └── concat-map@0.0.1 
│     │   ├─┬ once@1.3.3 
│     │   │ └── wrappy@1.0.1 
│     │   └── path-is-absolute@1.0.0 
│     └── uid-number@0.0.3 
├── json-loader@0.5.4 
├─┬ jws@3.1.4 
│ ├── base64url@2.0.0 
│ ├─┬ jwa@1.1.5 
│ │ ├── buffer-equal-constant-time@1.0.1 
│ │ └── ecdsa-sig-formatter@1.0.9 
│ └── safe-buffer@5.0.1 
├─┬ karma@1.6.0 
│ ├── bluebird@3.5.0 
│ ├─┬ chokidar@1.6.1 
│ │ ├── anymatch@1.3.0 
│ │ ├── async-each@1.0.1 
│ │ ├── glob-parent@2.0.0 
│ │ ├─┬ is-binary-path@1.0.1 
│ │ │ └── binary-extensions@1.8.0 
│ │ ├─┬ is-glob@2.0.1 
│ │ │ └── is-extglob@1.0.0 
│ │ └─┬ readdirp@2.1.0 
│ │   ├─┬ readable-stream@2.2.9 
│ │   │ └── string_decoder@1.0.0 
│ │   └── set-immediate-shim@1.0.1 
│ ├── colors@1.1.2 
│ ├── combine-lists@1.0.1 
│ ├─┬ connect@3.6.0 
│ │ ├── debug@2.6.1 
│ │ └── finalhandler@1.0.0 
│ ├── core-js@2.4.1 
│ ├── di@0.0.1 
│ ├─┬ dom-serialize@2.2.1 
│ │ ├── custom-event@1.0.1 
│ │ ├── ent@2.2.0 
│ │ └── void-elements@2.0.1 
│ ├─┬ expand-braces@0.1.2 
│ │ ├── array-slice@0.2.3 
│ │ ├── array-unique@0.2.1 
│ │ └─┬ braces@0.1.5 
│ │   └─┬ expand-range@0.1.1 
│ │     ├── is-number@0.1.1 
│ │     └── repeat-string@0.2.2 
│ ├── glob@7.1.1 
│ ├── graceful-fs@4.1.11 
│ ├── isbinaryfile@3.0.2 
│ ├── lodash@3.10.1 
│ ├─┬ log4js@0.6.38 
│ │ ├─┬ readable-stream@1.0.34 
│ │ │ └── isarray@0.0.1 
│ │ └── semver@4.3.6 
│ ├─┬ optimist@0.6.1 
│ │ └── wordwrap@0.0.2 
│ ├── qjobs@1.1.5 
│ ├── rimraf@2.6.1 
│ ├─┬ socket.io@1.7.3 
│ │ ├── debug@2.3.3 
│ │ ├─┬ engine.io@1.8.3 
│ │ │ ├── base64id@1.0.0 
│ │ │ ├─┬ engine.io-parser@1.3.2 
│ │ │ │ ├── after@0.8.2 
│ │ │ │ ├── base64-arraybuffer@0.1.5 
│ │ │ │ └── wtf-8@1.0.0 
│ │ │ └── ws@1.1.2 
│ │ ├── object-assign@4.1.0 
│ │ ├── socket.io-adapter@0.5.0 
│ │ ├─┬ socket.io-client@1.7.3 
│ │ │ ├── component-emitter@1.2.1 
│ │ │ ├─┬ engine.io-client@1.8.3 
│ │ │ │ ├── component-emitter@1.2.1 
│ │ │ │ ├── parsejson@0.0.3 
│ │ │ │ ├── parseqs@0.0.5 
│ │ │ │ └── xmlhttprequest-ssl@1.5.3 
│ │ │ └── parseuri@0.0.5 
│ │ └─┬ socket.io-parser@2.3.1 
│ │   ├─┬ debug@2.2.0 
│ │   │ └── ms@0.7.1 
│ │   ├── isarray@0.0.1 
│ │   └── json3@3.3.2 
│ ├── source-map@0.5.6 
│ ├── tmp@0.0.31 
│ └─┬ useragent@2.1.13 
│   ├── lru-cache@2.2.4 
│   └── tmp@0.0.24 
├─┬ karma-chrome-launcher@1.0.1 
│ ├─┬ fs-access@1.0.1 
│ │ └── null-check@1.0.0 
│ └─┬ which@1.2.14 
│   └── isexe@2.0.0 
├── karma-firefox-launcher@1.0.1 
├── karma-ie-launcher@1.0.0 
├── karma-jasmine@1.1.0 
├─┬ karma-junit-reporter@1.2.0 
│ ├── path-is-absolute@1.0.1 
│ └── xmlbuilder@8.2.2 
├── karma-opera-launcher@1.0.0 
├── karma-phantomjs-launcher@1.0.4 
├── karma-safari-launcher@1.0.0 
├─┬ karma-webpack@1.8.1 
│ ├── async@0.9.2 
│ ├── lodash@3.10.1 
│ ├── source-map@0.1.43 
│ └─┬ webpack-dev-middleware@1.10.1 
│   └─┬ memory-fs@0.4.1 
│     └─┬ readable-stream@2.2.9 
│       └── string_decoder@1.0.0 
├─┬ ldapjs@1.0.1 
│ ├── asn1@0.2.3 
│ ├── assert-plus@1.0.0 
│ ├─┬ backoff@2.5.0 
│ │ └── precond@0.2.3 
│ ├─┬ bunyan@1.8.10 
│ │ ├── dtrace-provider@0.8.1 
│ │ ├── moment@2.18.1 
│ │ ├─┬ mv@2.1.1 
│ │ │ └── ncp@2.0.0 
│ │ └── safe-json-stringify@1.0.4 
│ ├─┬ dashdash@1.14.1 
│ │ └── assert-plus@1.0.0 
│ ├── dtrace-provider@0.7.1 
│ ├─┬ ldap-filter@0.2.2 
│ │ └── assert-plus@0.1.5 
│ ├─┬ once@1.4.0 
│ │ └── wrappy@1.0.2 
│ ├─┬ vasync@1.6.4 
│ │ └─┬ verror@1.6.0 
│ │   └── extsprintf@1.2.0 
│ └─┬ verror@1.9.0 
│   ├── core-util-is@1.0.2 
│   └── extsprintf@1.3.0 
├─┬ less@2.7.2 
│ ├─┬ errno@0.1.4 
│ │ └── prr@0.0.0 
│ ├── image-size@0.5.1 
│ ├─┬ promise@7.1.1 
│ │ └── asap@2.0.5 
│ └── source-map@0.5.6 
├── less-loader@2.2.3 
├── lodash@4.17.4 
├─┬ markdown-serve@0.3.3 
│ ├── highlight.js@8.2.0 
│ ├─┬ js-yaml@3.2.7 
│ │ └── esprima@2.0.0 
│ ├── lodash@2.4.2 
│ └── marked@0.3.6 
├─┬ memory-fs@0.3.0 
│ └─┬ readable-stream@2.2.9 
│   ├── buffer-shims@1.0.0 
│   ├── process-nextick-args@1.0.7 
│   ├── string_decoder@1.0.0 
│   └── util-deprecate@1.0.2 
├── mime@1.3.4 
├── minicap-prebuilt@1.4.0 
├─┬ minimatch@3.0.3 
│ └─┬ brace-expansion@1.1.7 
│   ├── balanced-match@0.4.2 
│   └── concat-map@0.0.1 
├── my-local-ip@1.0.0 
├─┬ node-libs-browser@1.1.1 
│ ├── assert@1.4.1 
│ ├─┬ browserify-zlib@0.1.4 
│ │ └── pako@0.2.9 
│ ├─┬ console-browserify@1.1.0 
│ │ └── date-now@0.1.4 
│ ├── constants-browserify@1.0.0 
│ ├─┬ crypto-browserify@3.11.0 
│ │ ├─┬ browserify-cipher@1.0.0 
│ │ │ ├─┬ browserify-aes@1.0.6 
│ │ │ │ └── buffer-xor@1.0.3 
│ │ │ ├─┬ browserify-des@1.0.0 
│ │ │ │ └── des.js@1.0.0 
│ │ │ └── evp_bytestokey@1.0.0 
│ │ ├─┬ browserify-sign@4.0.4 
│ │ │ ├── bn.js@4.11.6 
│ │ │ ├── browserify-rsa@4.0.1 
│ │ │ ├─┬ elliptic@6.4.0 
│ │ │ │ ├── brorand@1.1.0 
│ │ │ │ ├── hash.js@1.0.3 
│ │ │ │ ├── hmac-drbg@1.0.1 
│ │ │ │ ├── minimalistic-assert@1.0.0 
│ │ │ │ └── minimalistic-crypto-utils@1.0.1 
│ │ │ └─┬ parse-asn1@5.1.0 
│ │ │   └── asn1.js@4.9.1 
│ │ ├── create-ecdh@4.0.0 
│ │ ├─┬ create-hash@1.1.2 
│ │ │ ├── cipher-base@1.0.3 
│ │ │ ├── ripemd160@1.0.1 
│ │ │ └── sha.js@2.4.8 
│ │ ├── create-hmac@1.1.4 
│ │ ├─┬ diffie-hellman@5.0.2 
│ │ │ └── miller-rabin@4.0.0 
│ │ ├── pbkdf2@3.0.9 
│ │ ├── public-encrypt@4.0.0 
│ │ └── randombytes@2.0.3 
│ ├── domain-browser@1.1.7 
│ ├── events@1.1.1 
│ ├── https-browserify@0.0.1 
│ ├── os-browserify@0.2.1 
│ ├── path-browserify@0.0.0 
│ ├── process@0.11.9 
│ ├── punycode@1.4.1 
│ ├── querystring-es3@0.2.1 
│ ├─┬ readable-stream@2.2.9 
│ │ └── string_decoder@1.0.0 
│ ├─┬ stream-browserify@2.0.1 
│ │ └─┬ readable-stream@2.2.9 
│ │   └── string_decoder@1.0.0 
│ ├─┬ stream-http@2.7.0 
│ │ ├── builtin-status-codes@3.0.0 
│ │ ├─┬ readable-stream@2.2.9 
│ │ │ └── string_decoder@1.0.0 
│ │ └── to-arraybuffer@1.0.1 
│ ├── string_decoder@0.10.31 
│ ├── timers-browserify@1.4.2 
│ ├── tty-browserify@0.0.0 
│ ├─┬ url@0.11.0 
│ │ └── punycode@1.3.2 
│ ├─┬ util@0.10.3 
│ │ └── inherits@2.0.1 
│ └── vm-browserify@0.0.4 
├─┬ node-sass@3.13.1 
│ ├── async-foreach@0.1.3 
│ ├── cross-spawn@3.0.1 
│ ├─┬ gaze@1.1.2 
│ │ └─┬ globule@1.1.0 
│ │   └── lodash@4.16.6 
│ ├── get-stdin@4.0.1 
│ ├── glob@7.1.1 
│ ├── lodash.assign@4.2.0 
│ ├── lodash.clonedeep@4.5.0 
│ ├─┬ meow@3.7.0 
│ │ ├─┬ camelcase-keys@2.1.0 
│ │ │ └── camelcase@2.1.1 
│ │ ├─┬ loud-rejection@1.6.0 
│ │ │ ├─┬ currently-unhandled@0.4.1 
│ │ │ │ └── array-find-index@1.0.2 
│ │ │ └── signal-exit@3.0.2 
│ │ ├── map-obj@1.0.1 
│ │ ├── minimist@1.2.0 
│ │ ├─┬ normalize-package-data@2.3.6 
│ │ │ ├── hosted-git-info@2.4.2 
│ │ │ ├─┬ is-builtin-module@1.0.0 
│ │ │ │ └── builtin-modules@1.1.1 
│ │ │ └─┬ validate-npm-package-license@3.0.1 
│ │ │   ├─┬ spdx-correct@1.0.2 
│ │ │   │ └── spdx-license-ids@1.2.2 
│ │ │   └── spdx-expression-parse@1.0.4 
│ │ ├─┬ redent@1.0.0 
│ │ │ ├─┬ indent-string@2.1.0 
│ │ │ │ └─┬ repeating@2.0.1 
│ │ │ │   └── is-finite@1.0.2 
│ │ │ └── strip-indent@1.0.1 
│ │ └── trim-newlines@1.0.0 
│ ├─┬ node-gyp@3.6.0 
│ │ ├── fstream@1.0.11 
│ │ ├── glob@7.1.1 
│ │ ├─┬ nopt@3.0.6 
│ │ │ └── abbrev@1.1.0 
│ │ ├── osenv@0.1.4 
│ │ └─┬ tar@2.2.1 
│ │   └── block-stream@0.0.9 
│ ├─┬ npmlog@4.0.2 
│ │ ├─┬ are-we-there-yet@1.1.2 
│ │ │ └── delegates@1.0.0 
│ │ ├── console-control-strings@1.1.0 
│ │ └─┬ gauge@2.7.3 
│ │   ├── aproba@1.1.1 
│ │   ├── has-unicode@2.0.1 
│ │   └── wide-align@1.1.0 
│ └─┬ sass-graph@2.1.2 
│   ├── glob@7.1.1 
│   └─┬ yargs@4.8.1 
│     ├── cliui@3.2.0 
│     ├── window-size@0.2.0 
│     └─┬ yargs-parser@2.4.1 
│       └── camelcase@3.0.0 
├── openid@2.0.6 
├─┬ passport@0.3.2 
│ ├── passport-strategy@1.0.0 
│ └── pause@0.0.1 
├─┬ passport-oauth2@1.4.0 
│ ├── oauth@0.9.15 
│ └── uid2@0.0.3 
├─┬ passport-saml@0.15.0 
│ ├── q@1.1.2 
│ ├─┬ xml-crypto@0.8.5 
│ │ ├── xmldom@0.1.19 
│ │ └── xpath.js@1.0.7 
│ ├─┬ xml-encryption@0.7.4 
│ │ ├── async@0.2.10 
│ │ ├── ejs@0.8.8 
│ │ ├── node-forge@0.2.24 
│ │ └── xpath@0.0.5 
│ └─┬ xmlbuilder@2.5.2 
│   └── lodash@3.2.0 
├─┬ phantomjs-prebuilt@2.1.14 
│ ├── es6-promise@4.0.5 
│ ├─┬ extract-zip@1.5.0 
│ │ ├─┬ concat-stream@1.5.0 
│ │ │ └── readable-stream@2.0.6 
│ │ ├── debug@0.7.4 
│ │ ├── mkdirp@0.5.0 
│ │ └── yauzl@2.4.1 
│ ├─┬ fs-extra@1.0.0 
│ │ ├── jsonfile@2.4.0 
│ │ └── klaw@1.3.1 
│ ├─┬ hasha@2.2.0 
│ │ └── is-stream@1.1.0 
│ ├── kew@0.7.0 
│ └─┬ request@2.79.0 
│   ├── caseless@0.11.0 
│   ├── har-validator@2.0.6 
│   ├── qs@6.3.2 
│   └── tunnel-agent@0.4.3 
├── please-update-dependencies@2.0.0 
├─┬ protobufjs@3.8.2 
│ ├─┬ ascli@0.3.0 
│ │ ├── colour@0.7.1 
│ │ └── optjs@3.2.2 
│ └─┬ bytebuffer@3.5.5 
│   ├── bufferview@1.0.1 
│   └── long@2.4.0 
├─┬ protractor@4.0.14 
│ ├── @types/jasmine@2.5.47 
│ ├── @types/node@6.0.69 
│ ├── @types/q@0.0.32 
│ ├── @types/selenium-webdriver@2.53.37 
│ ├── adm-zip@0.4.7 
│ ├── glob@7.1.1 
│ ├─┬ jasmine@2.4.1 
│ │ ├── exit@0.1.2 
│ │ ├─┬ glob@3.2.11 
│ │ │ └─┬ minimatch@0.3.0 
│ │ │   ├── lru-cache@2.7.3 
│ │ │   └── sigmund@1.0.1 
│ │ └── jasmine-core@2.4.1 
│ ├── jasminewd2@0.0.10 
│ ├── q@1.4.1 
│ ├── saucelabs@1.3.0 
│ ├─┬ selenium-webdriver@2.53.3 
│ │ ├── adm-zip@0.4.4 
│ │ └─┬ xml2js@0.4.4 
│ │   └── sax@0.6.1 
│ ├─┬ source-map-support@0.4.14 
│ │ └── source-map@0.5.6 
│ └─┬ webdriver-manager@10.3.0 
│   ├── ini@1.3.4 
│   ├── minimist@1.2.0 
│   └── rimraf@2.6.1 
├─┬ protractor-html-screenshot-reporter@0.0.21 
│ ├── mkdirp@0.3.5 
│ └── underscore@1.6.0 
├─┬ proxy-addr@1.1.4 
│ ├── forwarded@0.1.0 
│ └── ipaddr.js@1.3.0 
├─┬ pug@2.0.0-beta9 
│ ├─┬ pug-code-gen@1.1.1 
│ │ ├─┬ constantinople@3.1.0 
│ │ │ └── is-expression@2.1.0 
│ │ ├── doctypes@1.1.0 
│ │ ├── js-stringify@1.0.2 
│ │ ├── pug-attrs@2.0.2 
│ │ └── pug-error@1.3.2 
│ ├─┬ pug-filters@2.1.2 
│ │ ├─┬ clean-css@3.4.25 
│ │ │ └── commander@2.8.1 
│ │ ├─┬ jstransformer@1.0.0 
│ │ │ └── is-promise@2.1.0 
│ │ └── pug-walk@1.1.2 
│ ├─┬ pug-lexer@2.3.2 
│ │ ├─┬ character-parser@2.2.0 
│ │ │ └── is-regex@1.0.4 
│ │ └─┬ is-expression@3.0.0 
│ │   └── acorn@4.0.11 
│ ├── pug-linker@2.0.3 
│ ├── pug-load@2.0.6 
│ ├─┬ pug-parser@2.0.2 
│ │ └── token-stream@0.0.1 
│ ├── pug-runtime@2.0.3 
│ └── pug-strip-comments@1.0.2 
├── raw-loader@0.5.1 
├─┬ request@2.81.0 
│ ├── aws-sign2@0.6.0 
│ ├── aws4@1.6.0 
│ ├── caseless@0.12.0 
│ ├─┬ combined-stream@1.0.5 
│ │ └── delayed-stream@1.0.0 
│ ├── extend@3.0.0 
│ ├── forever-agent@0.6.1 
│ ├─┬ form-data@2.1.4 
│ │ └── asynckit@0.4.0 
│ ├─┬ har-validator@4.2.1 
│ │ └── har-schema@1.0.5 
│ ├─┬ hawk@3.1.3 
│ │ ├── boom@2.10.1 
│ │ ├── cryptiles@2.0.5 
│ │ ├── hoek@2.16.3 
│ │ └── sntp@1.0.9 
│ ├─┬ http-signature@1.1.1 
│ │ ├── assert-plus@0.2.0 
│ │ ├─┬ jsprim@1.4.0 
│ │ │ ├── assert-plus@1.0.0 
│ │ │ ├── extsprintf@1.0.2 
│ │ │ ├── json-schema@0.2.3 
│ │ │ └── verror@1.3.6 
│ │ └─┬ sshpk@1.13.0 
│ │   ├── assert-plus@1.0.0 
│ │   ├── bcrypt-pbkdf@1.0.1 
│ │   ├── ecc-jsbn@0.1.1 
│ │   ├─┬ getpass@0.1.6 
│ │   │ └── assert-plus@1.0.0 
│ │   ├── jodid25519@1.0.2 
│ │   ├── jsbn@0.1.1 
│ │   └── tweetnacl@0.14.5 
│ ├── is-typedarray@1.0.0 
│ ├── isstream@0.1.2 
│ ├── json-stringify-safe@5.0.1 
│ ├── mime-types@2.1.15 
│ ├── oauth-sign@0.8.2 
│ ├── performance-now@0.2.0 
│ ├── stringstream@0.0.5 
│ ├── tough-cookie@2.3.2 
│ └── tunnel-agent@0.6.0 
├─┬ request-progress@2.0.1 
│ └── throttleit@1.0.0 
├── rethinkdb@2.3.3 
├── sass-loader@4.1.1 
├── script-loader@0.7.0 
├── semver@5.3.0 
├─┬ serve-favicon@2.4.2 
│ └── ms@1.0.0 
├── serve-static@1.12.1 
├─┬ sinon@1.17.7 
│ ├── formatio@1.1.1 
│ ├── lolex@1.3.2 
│ └── samsam@1.1.2 
├── sinon-chai@2.9.0 
├─┬ socket.io@1.4.8 
│ ├─┬ debug@2.2.0 
│ │ └── ms@0.7.1 
│ ├─┬ engine.io@1.6.11 
│ │ ├─┬ accepts@1.1.4 
│ │ │ ├─┬ mime-types@2.0.14 
│ │ │ │ └── mime-db@1.12.0 
│ │ │ └── negotiator@0.4.9 
│ │ ├── base64id@0.1.0 
│ │ ├─┬ debug@2.2.0 
│ │ │ └── ms@0.7.1 
│ │ ├─┬ engine.io-parser@1.2.4 
│ │ │ ├── after@0.8.1 
│ │ │ ├── arraybuffer.slice@0.0.6 
│ │ │ ├── base64-arraybuffer@0.1.2 
│ │ │ ├── blob@0.0.4 
│ │ │ ├─┬ has-binary@0.1.6 
│ │ │ │ └── isarray@0.0.1 
│ │ │ └── utf8@2.1.0 
│ │ └── ws@1.1.0 
│ ├─┬ has-binary@0.1.7 
│ │ └── isarray@0.0.1 
│ ├─┬ socket.io-adapter@0.4.0 
│ │ ├─┬ debug@2.2.0 
│ │ │ └── ms@0.7.1 
│ │ └─┬ socket.io-parser@2.2.2 
│ │   ├── debug@0.7.4 
│ │   ├── isarray@0.0.1 
│ │   └── json3@3.2.6 
│ └─┬ socket.io-parser@2.2.6 
│   ├── benchmark@1.0.0 
│   ├── component-emitter@1.1.2 
│   ├─┬ debug@2.2.0 
│   │ └── ms@0.7.1 
│   ├── isarray@0.0.1 
│   └── json3@3.3.2 
├─┬ socket.io-client@1.4.8 
│ ├── backo2@1.0.2 
│ ├── component-bind@1.0.0 
│ ├── component-emitter@1.2.0 
│ ├─┬ debug@2.2.0 
│ │ └── ms@0.7.1 
│ ├─┬ engine.io-client@1.6.11 
│ │ ├── component-inherit@0.0.3 
│ │ ├─┬ debug@2.2.0 
│ │ │ └── ms@0.7.1 
│ │ ├── has-cors@1.1.0 
│ │ ├── parsejson@0.0.1 
│ │ ├── parseqs@0.0.2 
│ │ ├── ws@1.0.1 
│ │ ├── xmlhttprequest-ssl@1.5.1 
│ │ └── yeast@0.1.2 
│ ├── indexof@0.0.1 
│ ├── object-component@0.0.3 
│ ├─┬ parseuri@0.0.4 
│ │ └─┬ better-assert@1.0.2 
│ │   └── callsite@1.0.0 
│ └── to-array@0.1.4 
├── split@1.0.0 
├── stf-appstore-db@1.0.0 
├── stf-browser-db@1.0.2 
├── stf-device-db@1.2.0 
├─┬ stf-syrup@1.0.0 
│ ├── bluebird@1.1.1 
│ └── lodash@2.4.2 
├── stf-wiki@1.0.0 
├─┬ style-loader@0.13.2 
│ └─┬ loader-utils@1.1.0 
│   └── json5@0.5.1 
├─┬ swagger-express-mw@0.7.0 
│ └─┬ swagger-node-runner@0.7.3 
│   ├─┬ bagpipes@0.1.0 
│   │ ├── jspath@0.3.4 
│   │ ├── lodash@3.10.1 
│   │ ├─┬ machinepack-http@2.4.0 
│   │ │ ├── lodash@3.10.1 
│   │ │ ├─┬ machine@10.4.0 
│   │ │ │ ├── convert-to-ecmascript-compatible-varname@0.1.5 
│   │ │ │ ├── lodash@3.10.1 
│   │ │ │ ├── object-hash@0.3.0 
│   │ │ │ ├─┬ rttc@7.4.0 
│   │ │ │ │ └── lodash@3.10.1 
│   │ │ │ └─┬ switchback@2.0.2 
│   │ │ │   └── lodash@3.10.1 
│   │ │ └─┬ machinepack-urls@4.1.0 
│   │ │   ├── lodash@3.10.1 
│   │ │   └─┬ machine@9.1.2 
│   │ │     ├── rttc@4.5.2 
│   │ │     └─┬ switchback@1.1.3 
│   │ │       └── lodash@2.4.2 
│   │ ├── mustache@2.3.0 
│   │ └── pipeworks@1.3.1 
│   ├─┬ config@1.25.1 
│   │ └── json5@0.4.0 
│   ├── cors@2.8.3 
│   ├─┬ js-yaml@3.8.3 
│   │ └── esprima@3.1.3 
│   ├── lodash@3.10.1 
│   ├─┬ multer@1.3.0 
│   │ ├── append-field@0.1.0 
│   │ ├─┬ busboy@0.2.14 
│   │ │ └─┬ dicer@0.2.5 
│   │ │   └── streamsearch@0.1.2 
│   │ └── object-assign@3.0.0 
│   └─┬ sway@1.0.0 
│     ├─┬ js-yaml@3.8.3 
│     │ └── esprima@3.1.3 
│     ├─┬ json-refs@2.1.6 
│     │ ├─┬ js-yaml@3.8.3 
│     │ │ └── esprima@3.1.3 
│     │ ├─┬ path-loader@1.0.2 
│     │ │ └─┬ superagent@3.5.2 
│     │ │   ├── component-emitter@1.2.1 
│     │ │   ├── cookiejar@2.1.1 
│     │ │   └─┬ readable-stream@2.2.9 
│     │ │     └── string_decoder@1.0.0 
│     │ ├── slash@1.0.0 
│     │ └── uri-js@2.1.1 
│     ├─┬ json-schema-faker@0.2.16 
│     │ ├── chance@1.0.6 
│     │ ├─┬ deref@0.6.4 
│     │ │ └── deep-extend@0.4.1 
│     │ ├── faker@3.1.0 
│     │ └─┬ randexp@0.4.5 
│     │   ├── discontinuous-range@1.0.0 
│     │   └── ret@0.1.14 
│     ├── native-promise-only@0.8.1 
│     ├─┬ path-to-regexp@1.7.0 
│     │ └── isarray@0.0.1 
│     ├── swagger-methods@1.0.0 
│     ├── swagger-schema-official@2.0.0-bab6bed 
│     └─┬ z-schema@3.18.2 
│       ├── lodash.get@4.4.2 
│       ├── lodash.isequal@4.5.0 
│       └── validator@6.3.0 
├─┬ temp@0.8.3 
│ ├── os-tmpdir@1.0.2 
│ └── rimraf@2.2.8 
├─┬ template-html-loader@0.0.3 
│ └── consolidate@0.10.0 
├─┬ then-jade@2.4.3 
│ ├─┬ barrage@1.1.0 
│ │ └─┬ promise@6.1.0 
│ │   └── asap@1.0.0 
│ ├─┬ jade@1.11.0 
│ │ ├── character-parser@1.2.1 
│ │ ├── commander@2.6.0 
│ │ ├─┬ constantinople@3.0.2 
│ │ │ └── acorn@2.7.0 
│ │ ├─┬ jstransformer@0.0.2 
│ │ │ └─┬ promise@6.1.0 
│ │ │   └── asap@1.0.0 
│ │ ├─┬ transformers@2.1.0 
│ │ │ ├─┬ css@1.0.8 
│ │ │ │ ├── css-parse@1.0.4 
│ │ │ │ └── css-stringify@1.0.5 
│ │ │ ├─┬ promise@2.0.0 
│ │ │ │ └── is-promise@1.0.1 
│ │ │ └─┬ uglify-js@2.2.5 
│ │ │   ├── optimist@0.3.7 
│ │ │   └── source-map@0.1.43 
│ │ └─┬ with@4.0.3 
│ │   ├── acorn@1.2.2 
│ │   └── acorn-globals@1.0.9 
│ ├─┬ regenerator@0.8.46 
│ │ ├─┬ commoner@0.10.8 
│ │ │ ├─┬ detective@4.5.0 
│ │ │ │ └── acorn@4.0.11 
│ │ │ └── glob@5.0.15 
│ │ ├─┬ defs@1.1.1 
│ │ │ ├─┬ alter@0.2.0 
│ │ │ │ └── stable@0.1.6 
│ │ │ ├── ast-traverse@0.1.1 
│ │ │ ├── breakable@1.0.0 
│ │ │ ├── esprima-fb@15001.1001.0-dev-harmony-fb 
│ │ │ ├── simple-fmt@0.1.0 
│ │ │ ├── simple-is@0.2.0 
│ │ │ ├── stringmap@0.2.2 
│ │ │ ├── stringset@0.2.1 
│ │ │ ├── tryor@0.1.2 
│ │ │ └─┬ yargs@3.27.0 
│ │ │   └── window-size@0.1.4 
│ │ ├── esprima-fb@15001.1001.0-dev-harmony-fb 
│ │ ├── private@0.1.7 
│ │ └─┬ recast@0.10.33 
│ │   ├── ast-types@0.8.12 
│ │   └── source-map@0.5.6 
│ ├── regenerator-runtime@0.9.6 
│ ├── then-yield@0.0.1 
│ └─┬ with@5.1.1 
│   └─┬ acorn-globals@3.1.0 
│     └── acorn@4.0.11 
├── transliteration@1.5.3 
├── url-join@1.1.0 
├─┬ url-loader@0.5.8 
│ └─┬ loader-utils@1.1.0 
│   └── json5@0.5.1 
├── utf-8-validate@1.2.2 
├── uuid@3.0.1 
├─┬ webpack@1.15.0 
│ ├── acorn@3.3.0 
│ ├── async@1.5.2 
│ ├── clone@1.0.2 
│ ├─┬ enhanced-resolve@0.9.1 
│ │ └── memory-fs@0.2.0 
│ ├── interpret@0.6.6 
│ ├─┬ node-libs-browser@0.7.0 
│ │ ├─┬ crypto-browserify@3.3.0 
│ │ │ ├── browserify-aes@0.4.0 
│ │ │ ├── pbkdf2-compat@2.0.1 
│ │ │ ├── ripemd160@0.2.0 
│ │ │ └── sha.js@2.2.6 
│ │ ├─┬ readable-stream@2.2.9 
│ │ │ └── string_decoder@1.0.0 
│ │ ├─┬ timers-browserify@2.0.2 
│ │ │ └── setimmediate@1.0.5 
│ │ └─┬ url@0.11.0 
│ │   └── punycode@1.3.2 
│ ├─┬ supports-color@3.2.3 
│ │ └── has-flag@1.0.0 
│ ├── tapable@0.1.10 
│ ├─┬ uglify-js@2.7.5 
│ │ ├── async@0.2.10 
│ │ ├── source-map@0.5.6 
│ │ ├── uglify-to-browserify@1.0.2 
│ │ └─┬ yargs@3.10.0 
│ │   ├── camelcase@1.2.1 
│ │   ├─┬ cliui@2.1.0 
│ │   │ ├─┬ center-align@0.1.3 
│ │   │ │ ├─┬ align-text@0.1.4 
│ │   │ │ │ ├── longest@1.0.1 
│ │   │ │ │ └── repeat-string@1.6.1 
│ │   │ │ └── lazy-cache@1.0.4 
│ │   │ └── right-align@0.1.3 
│ │   └── window-size@0.1.0 
│ ├─┬ watchpack@0.2.9 
│ │ └── async@0.9.2 
│ └─┬ webpack-core@0.6.9 
│   └── source-map@0.4.4 
├─┬ webpack-dev-server@1.16.3 
│ ├── connect-history-api-fallback@1.3.0 
│ ├─┬ http-proxy-middleware@0.17.4 
│ │ ├─┬ is-glob@3.1.0 
│ │ │ └── is-extglob@2.1.1 
│ │ └─┬ micromatch@2.3.11 
│ │   ├─┬ arr-diff@2.0.0 
│ │   │ └── arr-flatten@1.0.3 
│ │   ├─┬ braces@1.8.5 
│ │   │ ├─┬ expand-range@1.8.2 
│ │   │ │ └─┬ fill-range@2.2.3 
│ │   │ │   ├── is-number@2.1.0 
│ │   │ │   ├── isobject@2.1.0 
│ │   │ │   └── randomatic@1.1.6 
│ │   │ ├── preserve@0.2.0 
│ │   │ └── repeat-element@1.1.2 
│ │   ├─┬ expand-brackets@0.1.5 
│ │   │ └── is-posix-bracket@0.1.1 
│ │   ├── extglob@0.3.2 
│ │   ├── filename-regex@2.0.0 
│ │   ├─┬ kind-of@3.1.0 
│ │   │ └── is-buffer@1.1.5 
│ │   ├─┬ normalize-path@2.1.1 
│ │   │ └── remove-trailing-separator@1.0.1 
│ │   ├─┬ object.omit@2.0.1 
│ │   │ ├─┬ for-own@0.1.5 
│ │   │ │ └── for-in@1.0.2 
│ │   │ └── is-extendable@0.1.1 
│ │   ├─┬ parse-glob@3.0.4 
│ │   │ ├── glob-base@0.3.0 
│ │   │ └── is-dotfile@1.0.2 
│ │   └─┬ regex-cache@0.4.3 
│ │     ├── is-equal-shallow@0.1.3 
│ │     └── is-primitive@2.0.0 
│ ├── open@0.0.5 
│ ├─┬ serve-index@1.8.0 
│ │ ├── batch@0.5.3 
│ │ ├─┬ debug@2.2.0 
│ │ │ └── ms@0.7.1 
│ │ └─┬ http-errors@1.5.1 
│ │   └── setprototypeof@1.0.2 
│ ├─┬ sockjs@0.3.18 
│ │ ├─┬ faye-websocket@0.10.0 
│ │ │ └─┬ websocket-driver@0.6.5 
│ │ │   └── websocket-extensions@0.1.1 
│ │ └── uuid@2.0.3 
│ ├─┬ sockjs-client@1.1.2 
│ │ ├─┬ eventsource@0.1.6 
│ │ │ └─┬ original@1.0.0 
│ │ │   └── url-parse@1.0.5 
│ │ ├── faye-websocket@0.11.1 
│ │ ├── json3@3.3.2 
│ │ └─┬ url-parse@1.1.8 
│ │   └── querystringify@0.0.4 
│ ├── stream-cache@0.0.2 
│ └── supports-color@3.2.3 
├─┬ ws@1.1.4 
│ ├── options@0.0.6 
│ └── ultron@1.0.2 
├─┬ yargs@6.6.0 
│ ├── camelcase@3.0.0 
│ ├─┬ cliui@3.2.0 
│ │ └── wrap-ansi@2.1.0 
│ ├── decamelize@1.2.0 
│ ├── get-caller-file@1.0.2 
│ ├─┬ os-locale@1.4.0 
│ │ └─┬ lcid@1.0.0 
│ │   └── invert-kv@1.0.0 
│ ├─┬ read-pkg-up@1.0.1 
│ │ ├─┬ find-up@1.1.2 
│ │ │ └── path-exists@2.1.0 
│ │ └─┬ read-pkg@1.1.0 
│ │   ├─┬ load-json-file@1.1.0 
│ │   │ ├─┬ parse-json@2.2.0 
│ │   │ │ └─┬ error-ex@1.3.1 
│ │   │ │   └── is-arrayish@0.2.1 
│ │   │ └── strip-bom@2.0.0 
│ │   └── path-type@1.1.0 
│ ├── require-directory@2.1.1 
│ ├── require-main-filename@1.0.1 
│ ├── set-blocking@2.0.0 
│ ├─┬ string-width@1.0.2 
│ │ ├── code-point-at@1.1.0 
│ │ └── is-fullwidth-code-point@1.0.0 
│ ├── which-module@1.0.0 
│ ├── y18n@3.2.1 
│ └─┬ yargs-parser@4.2.1 
│   └── camelcase@3.0.0 
└─┬ zmq@2.15.3 
  └── nan@2.3.5 

npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@^1.0.0 (node_modules/chokidar/node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.1: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})

 Thanks,Is there someting about STF to read? Postings ,books ,whatever. this is the error  coming when i am running the command : $ sudo npm install -g stf

i have already installed all the requirements .... via homebrew , running node version - v7.9.0, npm version 4.2.0;


/usr/bin/stf -> /usr/lib/node_modules/stf/bin/stf

> dtrace-provider@0.8.1 install /usr/lib/node_modules/stf/node_modules/bunyan/node_modules/dtrace-provider
> node scripts/install.js


> dtrace-provider@0.7.1 install /usr/lib/node_modules/stf/node_modules/dtrace-provider
> node scripts/install.js


> bufferutil@1.3.0 install /usr/lib/node_modules/stf/node_modules/bufferutil
> node-gyp rebuild

gyp WARN EACCES user "root" does not have permission to access the dev dir "/home/tft/.node-gyp/7.9.0"
gyp WARN EACCES attempting to reinstall using temporary dev dir "/usr/lib/node_modules/stf/node_modules/bufferutil/.node-gyp"
make: Entering directory '/usr/lib/node_modules/stf/node_modules/bufferutil/build'
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
  SOLINK_MODULE(target) Release/obj.target/bufferutil.node
  COPY Release/bufferutil.node
make: Leaving directory '/usr/lib/node_modules/stf/node_modules/bufferutil/build'

> jpeg-turbo@0.4.0 install /usr/lib/node_modules/stf/node_modules/jpeg-turbo
> node-pre-gyp install --fallback-to-build

gyp WARN EACCES user "root" does not have permission to access the dev dir "/home/tft/.node-gyp/7.9.0"
gyp WARN EACCES attempting to reinstall using temporary dev dir "/usr/lib/node_modules/stf/node_modules/jpeg-turbo/.node-gyp"
make: Entering directory '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/build'
make: *** No rule to make target '../.node-gyp/7.9.0/include/node/common.gypi', needed by 'Makefile'.  Stop.
make: Leaving directory '/usr/lib/node_modules/stf/node_modules/jpeg-turbo/build'
gyp ERR! build error 
gyp ERR! stack Error: `make` failed with exit code: 2
gyp ERR! stack     at ChildProcess.onExit (/usr/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:276:23)
gyp ERR! stack     at emitTwo (events.js:106:13)
gyp ERR! stack     at ChildProcess.emit (events.js:194:7)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
gyp ERR! System Linux 4.4.0-72-generic
gyp ERR! command "/usr/bin/nodejs" "/usr/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "build" "--fallback-to-build" "--module=/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node" "--module_name=jpegturbo" "--module_path=/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64"
gyp ERR! cwd /usr/lib/node_modules/stf/node_modules/jpeg-turbo
gyp ERR! node -v v7.9.0
gyp ERR! node-gyp -v v3.5.0
gyp ERR! not ok 
node-pre-gyp ERR! build error 
node-pre-gyp ERR! stack Error: Failed to execute '/usr/bin/nodejs /usr/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js build --fallback-to-build --module=/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node --module_name=jpegturbo --module_path=/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64' (1)
node-pre-gyp ERR! stack     at ChildProcess.<anonymous> (/usr/lib/node_modules/stf/node_modules/jpeg-turbo/node_modules/node-pre-gyp/lib/util/compile.js:83:29)
node-pre-gyp ERR! stack     at emitTwo (events.js:106:13)
node-pre-gyp ERR! stack     at ChildProcess.emit (events.js:194:7)
node-pre-gyp ERR! stack     at maybeClose (internal/child_process.js:899:16)
node-pre-gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:226:5)
node-pre-gyp ERR! System Linux 4.4.0-72-generic
node-pre-gyp ERR! command "/usr/bin/nodejs" "/usr/lib/node_modules/stf/node_modules/jpeg-turbo/node_modules/.bin/node-pre-gyp" "install" "--fallback-to-build"
node-pre-gyp ERR! cwd /usr/lib/node_modules/stf/node_modules/jpeg-turbo
node-pre-gyp ERR! node -v v7.9.0
node-pre-gyp ERR! node-pre-gyp -v v0.6.19
node-pre-gyp ERR! not ok 
Failed to execute '/usr/bin/nodejs /usr/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js build --fallback-to-build --module=/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64/jpegturbo.node --module_name=jpegturbo --module_path=/usr/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v51-linux-x64' (1)
/usr/lib
`-- (empty)

npm ERR! Linux 4.4.0-72-generic
npm ERR! argv "/usr/bin/nodejs" "/usr/bin/npm" "install" "-g" "stf"
npm ERR! node v7.9.0
npm ERR! npm  v4.2.0
npm ERR! code ELIFECYCLE
npm ERR! errno 1

npm ERR! jpeg-turbo@0.4.0 install: `node-pre-gyp install --fallback-to-build`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the jpeg-turbo@0.4.0 install script 'node-pre-gyp install --fallback-to-build'.
npm ERR! Make sure you have the latest version of node.js and npm installed.
npm ERR! If you do, this is most likely a problem with the jpeg-turbo package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-pre-gyp install --fallback-to-build
npm ERR! You can get information on how to open an issue for this project with:
npm ERR!     npm bugs jpeg-turbo
npm ERR! Or if that isn't available, you can get their info via:
npm ERR!     npm owner ls jpeg-turbo
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /home/tft/.npm/_logs/2017-04-21T04_53_04_576Z-debug.log
 this is what i am getting when i don't use root.

npm WARN deprecated node-uuid@1.4.8: Use uuid module instead
npm WARN checkPermissions Missing write access to /usr/lib/node_modules
/usr/lib
`-- stf@2.3.0 
  +-- @slack/client@3.9.0 
  | +-- async@1.5.2 
  | +-- bluebird@3.5.0 
  | +-- https-proxy-agent@1.0.0 
  | | `-- agent-base@2.0.1 
  | |   `-- semver@5.0.3 
  | +-- inherits@2.0.3 
  | +-- pkginfo@0.4.0 
  | +-- retry@0.9.0 
  | +-- url-join@0.0.1 
  | `-- winston@2.3.1 
  |   +-- async@1.0.0 
  |   +-- colors@1.0.3 
  |   +-- cycle@1.0.3 
  |   +-- eyes@0.1.8 
  |   `-- stack-trace@0.0.9 
  +-- adbkit@2.9.0 
  | +-- adbkit-logcat@1.1.0 
  | +-- bluebird@2.9.34 
  | +-- node-forge@0.6.49 
  | `-- split@0.3.3 
  +-- adbkit-apkreader@1.0.0 
  | +-- adm-zip@0.4.7 
  | `-- debug@0.7.4 
  +-- adbkit-monkey@1.0.1 
  | `-- async@0.2.10 
  +-- aws-sdk@2.44.0 
  | +-- buffer@4.9.1 
  | | +-- base64-js@1.2.0 
  | | +-- ieee754@1.1.8 
  | | `-- isarray@1.0.0 
  | +-- crypto-browserify@1.0.9 
  | +-- jmespath@0.15.0 
  | +-- querystring@0.2.0 
  | +-- sax@1.2.1 
  | +-- url@0.10.3 
  | | `-- punycode@1.3.2 
  | +-- uuid@3.0.1 
  | +-- xml2js@0.4.17 
  | `-- xmlbuilder@4.2.1 
  +-- basic-auth@1.1.0 
  +-- bluebird@2.11.0 
  +-- body-parser@1.17.1 
  | +-- bytes@2.4.0 
  | +-- content-type@1.0.2 
  | +-- debug@2.6.1 
  | | `-- ms@0.7.2 
  | +-- depd@1.1.0 
  | +-- http-errors@1.6.1 
  | +-- iconv-lite@0.4.15 
  | +-- on-finished@2.3.0 
  | | `-- ee-first@1.1.1 
  | +-- qs@6.4.0 
  | +-- raw-body@2.2.0 
  | | `-- unpipe@1.0.0 
  | `-- type-is@1.6.15 
  |   `-- media-typer@0.3.0 
  +-- bufferutil@1.3.0 
  | +-- bindings@1.2.1 
  | `-- nan@2.4.0 
  +-- chalk@1.1.3 
  | +-- ansi-styles@2.2.1 
  | +-- escape-string-regexp@1.0.5 
  | +-- has-ansi@2.0.0 
  | | `-- ansi-regex@2.1.1 
  | +-- strip-ansi@3.0.1 
  | `-- supports-color@2.0.0 
  +-- commander@2.9.0 
  | `-- graceful-readlink@1.0.1 
  +-- compression@1.6.2 
  | +-- accepts@1.3.3 
  | | `-- negotiator@0.6.1 
  | +-- bytes@2.3.0 
  | +-- compressible@2.0.10 
  | | `-- mime-db@1.27.0 
  | +-- debug@2.2.0 
  | | `-- ms@0.7.1 
  | +-- on-headers@1.0.1 
  | `-- vary@1.1.1 
  +-- cookie-session@2.0.0-beta.1 
  | +-- cookies@0.7.0 
  | | `-- keygrip@1.0.1 
  | `-- debug@2.6.1 
  |   `-- ms@0.7.2 
  +-- csurf@1.9.0 
  | +-- cookie@0.3.1 
  | +-- cookie-signature@1.0.6 
  | +-- csrf@3.0.6 
  | | +-- rndm@1.2.0 
  | | +-- tsscmp@1.0.5 
  | | `-- uid-safe@2.1.4 
  | |   `-- random-bytes@1.0.0 
  | `-- http-errors@1.5.1 
  |   `-- setprototypeof@1.0.2 
  +-- debug@2.6.4 
  | `-- ms@0.7.3 
  +-- eventemitter3@1.2.0 
  +-- express@4.15.2 
  | +-- array-flatten@1.1.1 
  | +-- content-disposition@0.5.2 
  | +-- debug@2.6.1 
  | | `-- ms@0.7.2 
  | +-- encodeurl@1.0.1 
  | +-- escape-html@1.0.3 
  | +-- etag@1.8.0 
  | +-- finalhandler@1.0.1 
  | | `-- debug@2.6.3 
  | |   `-- ms@0.7.2 
  | +-- fresh@0.5.0 
  | +-- merge-descriptors@1.0.1 
  | +-- methods@1.1.2 
  | +-- parseurl@1.3.1 
  | +-- path-to-regexp@0.1.7 
  | +-- range-parser@1.2.0 
  | +-- send@0.15.1 
  | | +-- debug@2.6.1 
  | | +-- destroy@1.0.4 
  | | `-- ms@0.7.2 
  | +-- setprototypeof@1.0.3 
  | +-- statuses@1.3.1 
  | `-- utils-merge@1.0.0 
  +-- express-validator@2.21.0 
  | +-- bluebird@3.4.7 
  | +-- lodash@4.16.6 
  | `-- validator@5.7.0 
  +-- formidable@1.1.1 
  +-- gm@1.23.0 
  | +-- array-parallel@0.1.3 
  | +-- array-series@0.1.5 
  | +-- cross-spawn@4.0.2 
  | | +-- lru-cache@4.0.2 
  | | | +-- pseudomap@1.0.2 
  | | | `-- yallist@2.1.2 
  | | `-- which@1.2.14 
  | |   `-- isexe@2.0.0 
  | `-- debug@2.2.0 
  |   `-- ms@0.7.1 
  +-- hipchatter@0.3.2 
  | +-- async@0.2.10 
  | `-- needle@1.6.0 
  +-- http-proxy@1.16.2 
  | `-- requires-port@1.0.0 
  +-- in-publish@2.0.0 
  +-- jpeg-turbo@0.4.0 
  | `-- node-pre-gyp@0.6.19 
  |   +-- mkdirp@0.5.1 
  |   | `-- minimist@0.0.8 
  |   +-- nopt@3.0.6 
  |   | `-- abbrev@1.0.7 
  |   +-- npmlog@2.0.0 
  |   | +-- ansi@0.3.0 
  |   | +-- are-we-there-yet@1.0.5 
  |   | | +-- delegates@0.1.0 
  |   | | `-- readable-stream@2.0.5 
  |   | |   +-- core-util-is@1.0.2 
  |   | |   +-- inherits@2.0.1 
  |   | |   +-- isarray@0.0.1 
  |   | |   +-- process-nextick-args@1.0.6 
  |   | |   +-- string_decoder@0.10.31 
  |   | |   `-- util-deprecate@1.0.2 
  |   | `-- gauge@1.2.2 
  |   |   +-- has-unicode@1.0.1 
  |   |   +-- lodash.pad@3.1.1 
  |   |   | +-- lodash._basetostring@3.0.1 
  |   |   | `-- lodash._createpadding@3.6.1 
  |   |   |   `-- lodash.repeat@3.0.1 
  |   |   +-- lodash.padleft@3.1.1 
  |   |   | +-- lodash._basetostring@3.0.1 
  |   |   | `-- lodash._createpadding@3.6.1 
  |   |   |   `-- lodash.repeat@3.0.1 
  |   |   `-- lodash.padright@3.1.1 
  |   |     +-- lodash._basetostring@3.0.1 
  |   |     `-- lodash._createpadding@3.6.1 
  |   |       `-- lodash.repeat@3.0.1 
  |   +-- rc@1.1.6 
  |   | +-- deep-extend@0.4.0 
  |   | +-- ini@1.3.4 
  |   | +-- minimist@1.2.0 
  |   | `-- strip-json-comments@1.0.4 
  |   +-- request@2.67.0 
  |   | +-- aws-sign2@0.6.0 
  |   | +-- bl@1.0.0 
  |   | | `-- readable-stream@2.0.5 
  |   | |   +-- core-util-is@1.0.2 
  |   | |   +-- inherits@2.0.1 
  |   | |   +-- isarray@0.0.1 
  |   | |   +-- process-nextick-args@1.0.6 
  |   | |   +-- string_decoder@0.10.31 
  |   | |   `-- util-deprecate@1.0.2 
  |   | +-- caseless@0.11.0 
  |   | +-- combined-stream@1.0.5 
  |   | | `-- delayed-stream@1.0.0 
  |   | +-- extend@3.0.0 
  |   | +-- forever-agent@0.6.1 
  |   | +-- form-data@1.0.0-rc3 
  |   | | `-- async@1.5.1 
  |   | +-- har-validator@2.0.3 
  |   | | +-- chalk@1.1.1 
  |   | | | +-- ansi-styles@2.1.0 
  |   | | | +-- escape-string-regexp@1.0.4 
  |   | | | +-- has-ansi@2.0.0 
  |   | | | | `-- ansi-regex@2.0.0 
  |   | | | +-- strip-ansi@3.0.0 
  |   | | | | `-- ansi-regex@2.0.0 
  |   | | | `-- supports-color@2.0.0 
  |   | | +-- commander@2.9.0 
  |   | | | `-- graceful-readlink@1.0.1 
  |   | | +-- is-my-json-valid@2.12.3 
  |   | | | +-- generate-function@2.0.0 
  |   | | | +-- generate-object-property@1.2.0 
  |   | | | | `-- is-property@1.0.2 
  |   | | | +-- jsonpointer@2.0.0 
  |   | | | `-- xtend@4.0.1 
  |   | | `-- pinkie-promise@2.0.0 
  |   | |   `-- pinkie@2.0.1 
  |   | +-- hawk@3.1.2 
  |   | | +-- boom@2.10.1 
  |   | | +-- cryptiles@2.0.5 
  |   | | +-- hoek@2.16.3 
  |   | | `-- sntp@1.0.9 
  |   | +-- http-signature@1.1.0 
  |   | | +-- assert-plus@0.1.5 
  |   | | +-- jsprim@1.2.2 
  |   | | | +-- extsprintf@1.0.2 
  |   | | | +-- json-schema@0.2.2 
  |   | | | `-- verror@1.3.6 
  |   | | `-- sshpk@1.7.2 
  |   | |   +-- asn1@0.2.3 
  |   | |   +-- assert-plus@0.2.0 
  |   | |   +-- dashdash@1.11.0 
  |   | |   | `-- assert-plus@0.1.5 
  |   | |   +-- ecc-jsbn@0.1.1 
  |   | |   +-- jodid25519@1.0.2 
  |   | |   +-- jsbn@0.1.0 
  |   | |   `-- tweetnacl@0.13.2 
  |   | +-- is-typedarray@1.0.0 
  |   | +-- isstream@0.1.2 
  |   | +-- json-stringify-safe@5.0.1 
  |   | +-- mime-types@2.1.9 
  |   | | `-- mime-db@1.21.0 
  |   | +-- node-uuid@1.4.7 
  |   | +-- oauth-sign@0.8.0 
  |   | +-- qs@5.2.0 
  |   | +-- stringstream@0.0.5 
  |   | +-- tough-cookie@2.2.1 
  |   | `-- tunnel-agent@0.4.2 
  |   +-- rimraf@2.5.0 
  |   | `-- glob@6.0.3 
  |   |   +-- inflight@1.0.4 
  |   |   | `-- wrappy@1.0.1 
  |   |   +-- inherits@2.0.1 
  |   |   +-- minimatch@3.0.0 
  |   |   | `-- brace-expansion@1.1.2 
  |   |   |   +-- balanced-match@0.3.0 
  |   |   |   `-- concat-map@0.0.1 
  |   |   +-- once@1.3.3 
  |   |   | `-- wrappy@1.0.1 
  |   |   `-- path-is-absolute@1.0.0 
  |   +-- semver@5.1.0 
  |   +-- tar@2.2.1 
  |   | +-- block-stream@0.0.8 
  |   | +-- fstream@1.0.8 
  |   | | `-- graceful-fs@4.1.2 
  |   | `-- inherits@2.0.1 
  |   `-- tar-pack@3.1.2 
  |     +-- debug@0.7.4 
  |     +-- fstream@1.0.8 
  |     | +-- graceful-fs@4.1.2 
  |     | `-- inherits@2.0.1 
  |     +-- fstream-ignore@1.0.3 
  |     | +-- inherits@2.0.1 
  |     | `-- minimatch@3.0.0 
  |     |   `-- brace-expansion@1.1.2 
  |     |     +-- balanced-match@0.3.0 
  |     |     `-- concat-map@0.0.1 
  |     +-- once@1.1.1 
  |     +-- readable-stream@2.0.5 
  |     | +-- core-util-is@1.0.2 
  |     | +-- inherits@2.0.1 
  |     | +-- isarray@0.0.1 
  |     | +-- process-nextick-args@1.0.6 
  |     | +-- string_decoder@0.10.31 
  |     | `-- util-deprecate@1.0.2 
  |     +-- rimraf@2.4.5 
  |     | `-- glob@6.0.3 
  |     |   +-- inflight@1.0.4 
  |     |   | `-- wrappy@1.0.1 
  |     |   +-- inherits@2.0.1 
  |     |   +-- minimatch@3.0.0 
  |     |   | `-- brace-expansion@1.1.2 
  |     |   |   +-- balanced-match@0.3.0 
  |     |   |   `-- concat-map@0.0.1 
  |     |   +-- once@1.3.3 
  |     |   | `-- wrappy@1.0.1 
  |     |   `-- path-is-absolute@1.0.0 
  |     `-- uid-number@0.0.3 
  +-- jws@3.1.4 
  | +-- base64url@2.0.0 
  | +-- jwa@1.1.5 
  | | +-- buffer-equal-constant-time@1.0.1 
  | | `-- ecdsa-sig-formatter@1.0.9 
  | `-- safe-buffer@5.0.1 
  +-- ldapjs@1.0.1 
  | +-- asn1@0.2.3 
  | +-- assert-plus@1.0.0 
  | +-- backoff@2.5.0 
  | | `-- precond@0.2.3 
  | +-- bunyan@1.8.10 
  | | +-- dtrace-provider@0.8.1 
  | | +-- moment@2.18.1 
  | | +-- mv@2.1.1 
  | | | +-- ncp@2.0.0 
  | | | `-- rimraf@2.4.5 
  | | |   `-- glob@6.0.4 
  | | |     +-- inflight@1.0.6 
  | | |     `-- path-is-absolute@1.0.1 
  | | `-- safe-json-stringify@1.0.4 
  | +-- dashdash@1.14.1 
  | | `-- assert-plus@1.0.0 
  | +-- dtrace-provider@0.7.1 
  | +-- ldap-filter@0.2.2 
  | | `-- assert-plus@0.1.5 
  | +-- once@1.4.0 
  | | `-- wrappy@1.0.2 
  | +-- vasync@1.6.4 
  | | `-- verror@1.6.0 
  | |   `-- extsprintf@1.2.0 
  | `-- verror@1.9.0 
  |   +-- core-util-is@1.0.2 
  |   `-- extsprintf@1.3.0 
  +-- lodash@4.17.4 
  +-- markdown-serve@0.3.3 
  | +-- highlight.js@8.2.0 
  | +-- js-yaml@3.2.7 
  | | +-- argparse@1.0.9 
  | | | `-- sprintf-js@1.0.3 
  | | `-- esprima@2.0.0 
  | +-- lodash@2.4.2 
  | +-- marked@0.3.6 
  | `-- mkdirp@0.5.1 
  |   `-- minimist@0.0.8 
  +-- mime@1.3.4 
  +-- minicap-prebuilt@1.4.0 
  +-- minimatch@3.0.3 
  | `-- brace-expansion@1.1.7 
  |   +-- balanced-match@0.4.2 
  |   `-- concat-map@0.0.1 
  +-- my-local-ip@1.0.0 
  +-- node-uuid@1.4.8 
  +-- openid@2.0.6 
  +-- passport@0.3.2 
  | +-- passport-strategy@1.0.0 
  | `-- pause@0.0.1 
  +-- passport-oauth2@1.4.0 
  | +-- oauth@0.9.15 
  | `-- uid2@0.0.3 
  +-- passport-saml@0.15.0 
  | +-- q@1.1.2 
  | +-- xml-crypto@0.8.5 
  | | +-- xmldom@0.1.19 
  | | `-- xpath.js@1.0.7 
  | +-- xml-encryption@0.7.4 
  | | +-- async@0.2.10 
  | | +-- ejs@0.8.8 
  | | +-- node-forge@0.2.24 
  | | `-- xpath@0.0.5 
  | +-- xmlbuilder@2.5.2 
  | | `-- lodash@3.2.0 
  | `-- xmldom@0.1.27 
  +-- protobufjs@3.8.2 
  | +-- ascli@0.3.0 
  | | +-- colour@0.7.1 
  | | `-- optjs@3.2.2 
  | `-- bytebuffer@3.5.5 
  |   +-- bufferview@1.0.1 
  |   `-- long@2.4.0 
  +-- proxy-addr@1.1.4 
  | +-- forwarded@0.1.0 
  | `-- ipaddr.js@1.3.0 
  +-- pug@2.0.0-beta9 
  | +-- pug-code-gen@1.1.1 
  | | +-- constantinople@3.1.0 
  | | | +-- acorn@3.3.0 
  | | | `-- is-expression@2.1.0 
  | | +-- doctypes@1.1.0 
  | | +-- js-stringify@1.0.2 
  | | +-- pug-attrs@2.0.2 
  | | +-- pug-error@1.3.2 
  | | +-- void-elements@2.0.1 
  | | `-- with@5.1.1 
  | |   `-- acorn-globals@3.1.0 
  | |     `-- acorn@4.0.11 
  | +-- pug-filters@2.1.2 
  | | +-- clean-css@3.4.25 
  | | | +-- commander@2.8.1 
  | | | `-- source-map@0.4.4 
  | | |   `-- amdefine@1.0.1 
  | | +-- jstransformer@1.0.0 
  | | | +-- is-promise@2.1.0 
  | | | `-- promise@7.1.1 
  | | |   `-- asap@2.0.5 
  | | +-- pug-walk@1.1.2 
  | | +-- resolve@1.3.3 
  | | | `-- path-parse@1.0.5 
  | | `-- uglify-js@2.8.22 
  | |   +-- source-map@0.5.6 
  | |   +-- uglify-to-browserify@1.0.2 
  | |   `-- yargs@3.10.0 
  | |     +-- camelcase@1.2.1 
  | |     +-- cliui@2.1.0 
  | |     | +-- center-align@0.1.3 
  | |     | | +-- align-text@0.1.4 
  | |     | | | +-- kind-of@3.1.0 
  | |     | | | | `-- is-buffer@1.1.5 
  | |     | | | +-- longest@1.0.1 
  | |     | | | `-- repeat-string@1.6.1 
  | |     | | `-- lazy-cache@1.0.4 
  | |     | +-- right-align@0.1.3 
  | |     | `-- wordwrap@0.0.2 
  | |     `-- window-size@0.1.0 
  | +-- pug-lexer@2.3.2 
  | | +-- character-parser@2.2.0 
  | | | `-- is-regex@1.0.4 
  | | |   `-- has@1.0.1 
  | | |     `-- function-bind@1.1.0 
  | | `-- is-expression@3.0.0 
  | |   `-- acorn@4.0.11 
  | +-- pug-linker@2.0.3 
  | +-- pug-load@2.0.6 
  | | `-- object-assign@4.1.1 
  | +-- pug-parser@2.0.2 
  | | `-- token-stream@0.0.1 
  | +-- pug-runtime@2.0.3 
  | `-- pug-strip-comments@1.0.2 
  +-- request@2.81.0 
  | +-- aws-sign2@0.6.0 
  | +-- aws4@1.6.0 
  | +-- caseless@0.12.0 
  | +-- combined-stream@1.0.5 
  | | `-- delayed-stream@1.0.0 
  | +-- extend@3.0.0 
  | +-- forever-agent@0.6.1 
  | +-- form-data@2.1.4 
  | | `-- asynckit@0.4.0 
  | +-- har-validator@4.2.1 
  | | +-- ajv@4.11.7 
  | | | +-- co@4.6.0 
  | | | `-- json-stable-stringify@1.0.1 
  | | |   `-- jsonify@0.0.0 
  | | `-- har-schema@1.0.5 
  | +-- hawk@3.1.3 
  | | +-- boom@2.10.1 
  | | +-- cryptiles@2.0.5 
  | | +-- hoek@2.16.3 
  | | `-- sntp@1.0.9 
  | +-- http-signature@1.1.1 
  | | +-- assert-plus@0.2.0 
  | | +-- jsprim@1.4.0 
  | | | +-- assert-plus@1.0.0 
  | | | +-- extsprintf@1.0.2 
  | | | +-- json-schema@0.2.3 
  | | | `-- verror@1.3.6 
  | | `-- sshpk@1.13.0 
  | |   +-- assert-plus@1.0.0 
  | |   +-- bcrypt-pbkdf@1.0.1 
  | |   +-- ecc-jsbn@0.1.1 
  | |   +-- getpass@0.1.6 
  | |   | `-- assert-plus@1.0.0 
  | |   +-- jodid25519@1.0.2 
  | |   +-- jsbn@0.1.1 
  | |   `-- tweetnacl@0.14.5 
  | +-- is-typedarray@1.0.0 
  | +-- isstream@0.1.2 
  | +-- json-stringify-safe@5.0.1 
  | +-- mime-types@2.1.15 
  | +-- oauth-sign@0.8.2 
  | +-- performance-now@0.2.0 
  | +-- stringstream@0.0.5 
  | +-- tough-cookie@2.3.2 
  | | `-- punycode@1.4.1 
  | +-- tunnel-agent@0.6.0 
  | `-- uuid@3.0.1 
  +-- request-progress@2.0.1 
  | `-- throttleit@1.0.0 
  +-- rethinkdb@2.3.3 
  +-- semver@5.3.0 
  +-- serve-favicon@2.4.2 
  | `-- ms@1.0.0 
  +-- serve-static@1.12.1 
  +-- socket.io@1.4.8 
  | +-- debug@2.2.0 
  | | `-- ms@0.7.1 
  | +-- engine.io@1.6.11 
  | | +-- accepts@1.1.4 
  | | | +-- mime-types@2.0.14 
  | | | | `-- mime-db@1.12.0 
  | | | `-- negotiator@0.4.9 
  | | +-- base64id@0.1.0 
  | | +-- debug@2.2.0 
  | | | `-- ms@0.7.1 
  | | +-- engine.io-parser@1.2.4 
  | | | +-- after@0.8.1 
  | | | +-- arraybuffer.slice@0.0.6 
  | | | +-- base64-arraybuffer@0.1.2 
  | | | +-- blob@0.0.4 
  | | | +-- has-binary@0.1.6 
  | | | | `-- isarray@0.0.1 
  | | | `-- utf8@2.1.0 
  | | `-- ws@1.1.0 
  | +-- has-binary@0.1.7 
  | | `-- isarray@0.0.1 
  | +-- socket.io-adapter@0.4.0 
  | | +-- debug@2.2.0 
  | | | `-- ms@0.7.1 
  | | `-- socket.io-parser@2.2.2 
  | |   +-- debug@0.7.4 
  | |   +-- isarray@0.0.1 
  | |   `-- json3@3.2.6 
  | +-- socket.io-client@1.4.8 
  | | +-- backo2@1.0.2 
  | | +-- component-bind@1.0.0 
  | | +-- component-emitter@1.2.0 
  | | +-- debug@2.2.0 
  | | | `-- ms@0.7.1 
  | | +-- engine.io-client@1.6.11 
  | | | +-- component-inherit@0.0.3 
  | | | +-- debug@2.2.0 
  | | | | `-- ms@0.7.1 
  | | | +-- has-cors@1.1.0 
  | | | +-- parsejson@0.0.1 
  | | | +-- parseqs@0.0.2 
  | | | +-- ws@1.0.1 
  | | | +-- xmlhttprequest-ssl@1.5.1 
  | | | `-- yeast@0.1.2 
  | | +-- indexof@0.0.1 
  | | +-- object-component@0.0.3 
  | | +-- parseuri@0.0.4 
  | | | `-- better-assert@1.0.2 
  | | |   `-- callsite@1.0.0 
  | | `-- to-array@0.1.4 
  | `-- socket.io-parser@2.2.6 
  |   +-- benchmark@1.0.0 
  |   +-- component-emitter@1.1.2 
  |   +-- debug@2.2.0 
  |   | `-- ms@0.7.1 
  |   +-- isarray@0.0.1 
  |   `-- json3@3.3.2 
  +-- split@1.0.0 
  | `-- through@2.3.8 
  +-- stf-appstore-db@1.0.0 
  +-- stf-browser-db@1.0.2 
  +-- stf-device-db@1.2.0 
  +-- stf-syrup@1.0.0 
  | +-- bluebird@1.1.1 
  | `-- lodash@2.4.2 
  +-- stf-wiki@1.0.0 
  +-- swagger-express-mw@0.7.0 
  | `-- swagger-node-runner@0.7.3 
  |   +-- bagpipes@0.1.0 
  |   | +-- jspath@0.3.4 
  |   | +-- lodash@3.10.1 
  |   | +-- machinepack-http@2.4.0 
  |   | | +-- lodash@3.10.1 
  |   | | +-- machine@10.4.0 
  |   | | | +-- convert-to-ecmascript-compatible-varname@0.1.5 
  |   | | | +-- lodash@3.10.1 
  |   | | | +-- object-hash@0.3.0 
  |   | | | +-- rttc@7.4.0 
  |   | | | | `-- lodash@3.10.1 
  |   | | | `-- switchback@2.0.2 
  |   | | |   `-- lodash@3.10.1 
  |   | | `-- machinepack-urls@4.1.0 
  |   | |   +-- lodash@3.10.1 
  |   | |   `-- machine@9.1.2 
  |   | |     +-- rttc@4.5.2 
  |   | |     `-- switchback@1.1.3 
  |   | |       `-- lodash@2.4.2 
  |   | +-- mustache@2.3.0 
  |   | `-- pipeworks@1.3.1 
  |   +-- config@1.25.1 
  |   | `-- json5@0.4.0 
  |   +-- cors@2.8.3 
  |   +-- js-yaml@3.8.3 
  |   | `-- esprima@3.1.3 
  |   +-- lodash@3.10.1 
  |   +-- multer@1.3.0 
  |   | +-- append-field@0.1.0 
  |   | +-- busboy@0.2.14 
  |   | | +-- dicer@0.2.5 
  |   | | | `-- streamsearch@0.1.2 
  |   | | `-- readable-stream@1.1.14 
  |   | |   +-- isarray@0.0.1 
  |   | |   `-- string_decoder@0.10.31 
  |   | +-- concat-stream@1.6.0 
  |   | | +-- readable-stream@2.2.9 
  |   | | | +-- buffer-shims@1.0.0 
  |   | | | +-- process-nextick-args@1.0.7 
  |   | | | +-- string_decoder@1.0.0 
  |   | | | `-- util-deprecate@1.0.2 
  |   | | `-- typedarray@0.0.6 
  |   | +-- object-assign@3.0.0 
  |   | `-- xtend@4.0.1 
  |   `-- sway@1.0.0 
  |     +-- js-base64@2.1.9 
  |     +-- js-yaml@3.8.3 
  |     | `-- esprima@3.1.3 
  |     +-- json-refs@2.1.6 
  |     | +-- js-yaml@3.8.3 
  |     | | `-- esprima@3.1.3 
  |     | +-- path-loader@1.0.2 
  |     | | `-- superagent@3.5.2 
  |     | |   +-- component-emitter@1.2.1 
  |     | |   +-- cookiejar@2.1.1 
  |     | |   `-- readable-stream@2.2.9 
  |     | |     `-- string_decoder@1.0.0 
  |     | +-- slash@1.0.0 
  |     | `-- uri-js@2.1.1 
  |     +-- json-schema-faker@0.2.16 
  |     | +-- chance@1.0.6 
  |     | +-- deref@0.6.4 
  |     | | `-- deep-extend@0.4.1 
  |     | +-- faker@3.1.0 
  |     | `-- randexp@0.4.5 
  |     |   +-- discontinuous-range@1.0.0 
  |     |   `-- ret@0.1.14 
  |     +-- native-promise-only@0.8.1 
  |     +-- path-to-regexp@1.7.0 
  |     | `-- isarray@0.0.1 
  |     +-- swagger-methods@1.0.0 
  |     +-- swagger-schema-official@2.0.0-bab6bed 
  |     `-- z-schema@3.18.2 
  |       +-- lodash.get@4.4.2 
  |       +-- lodash.isequal@4.5.0 
  |       `-- validator@6.3.0 
  +-- temp@0.8.3 
  | +-- os-tmpdir@1.0.2 
  | `-- rimraf@2.2.8 
  +-- transliteration@1.5.3 
  | `-- yargs@6.6.0 
  |   +-- camelcase@3.0.0 
  |   +-- cliui@3.2.0 
  |   | `-- wrap-ansi@2.1.0 
  |   +-- decamelize@1.2.0 
  |   +-- get-caller-file@1.0.2 
  |   +-- os-locale@1.4.0 
  |   | `-- lcid@1.0.0 
  |   |   `-- invert-kv@1.0.0 
  |   +-- read-pkg-up@1.0.1 
  |   | +-- find-up@1.1.2 
  |   | | +-- path-exists@2.1.0 
  |   | | `-- pinkie-promise@2.0.1 
  |   | |   `-- pinkie@2.0.4 
  |   | `-- read-pkg@1.1.0 
  |   |   +-- load-json-file@1.1.0 
  |   |   | +-- graceful-fs@4.1.11 
  |   |   | +-- parse-json@2.2.0 
  |   |   | | `-- error-ex@1.3.1 
  |   |   | |   `-- is-arrayish@0.2.1 
  |   |   | +-- pify@2.3.0 
  |   |   | `-- strip-bom@2.0.0 
  |   |   |   `-- is-utf8@0.2.1 
  |   |   +-- normalize-package-data@2.3.8 
  |   |   | +-- hosted-git-info@2.4.2 
  |   |   | +-- is-builtin-module@1.0.0 
  |   |   | | `-- builtin-modules@1.1.1 
  |   |   | `-- validate-npm-package-license@3.0.1 
  |   |   |   +-- spdx-correct@1.0.2 
  |   |   |   | `-- spdx-license-ids@1.2.2 
  |   |   |   `-- spdx-expression-parse@1.0.4 
  |   |   `-- path-type@1.1.0 
  |   +-- require-directory@2.1.1 
  |   +-- require-main-filename@1.0.1 
  |   +-- set-blocking@2.0.0 
  |   +-- string-width@1.0.2 
  |   | +-- code-point-at@1.1.0 
  |   | `-- is-fullwidth-code-point@1.0.0 
  |   |   `-- number-is-nan@1.0.1 
  |   +-- which-module@1.0.0 
  |   +-- y18n@3.2.1 
  |   `-- yargs-parser@4.2.1 
  |     `-- camelcase@3.0.0 
  +-- url-join@1.1.0 
  +-- utf-8-validate@1.2.2 
  +-- ws@1.1.4 
  | +-- options@0.0.6 
  | `-- ultron@1.0.2 
  `-- zmq@2.15.3 
    `-- nan@2.3.5 

npm ERR! Linux 4.4.0-72-generic
npm ERR! argv "/usr/bin/nodejs" "/usr/bin/npm" "install" "-g" "stf"
npm ERR! node v7.9.0
npm ERR! npm  v4.2.0
npm ERR! path /usr/lib/node_modules
npm ERR! code EACCES
npm ERR! errno -13
npm ERR! syscall access

npm ERR! Error: EACCES: permission denied, access '/usr/lib/node_modules'
npm ERR!  { Error: EACCES: permission denied, access '/usr/lib/node_modules'
npm ERR!   errno: -13,
npm ERR!   code: 'EACCES',
npm ERR!   syscall: 'access',
npm ERR!   path: '/usr/lib/node_modules' }
npm ERR! 
npm ERR! Please try running this command again as root/Administrator.

npm ERR! Please include the following file with any support request:
npm ERR!     /home/tft/.npm/_logs/2017-04-21T05_34_12_660Z-debug.log
    <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
In development environment, autoreload didn't work

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**
1. git clone https://github.com/openstf/stf.git
2. npm inatall
3. npm link
4. stf local
5. modify/add stf frontend codes
eg. 
res/app/components/xxx/xxx-service.js
res/app/xxx/index.js
res/app/xxx/xxx-controller.js
res/app/xxx/xxx.pug


**What is the expected behavior?**
auto reload stf server.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
no message

**Please run `stf doctor` and paste the output here.**
```
INF/util:doctor 61099 [*] OS Arch: x64
INF/util:doctor 61099 [*] OS Platform: darwin
INF/util:doctor 61099 [*] OS Platform: 15.6.0
INF/util:doctor 61099 [*] Using Node 6.10.2
INF/util:doctor 61099 [*] Using RethinkDB client 2.3.3
INF/util:doctor 61099 [*] Using ZeroMQ 4.2.0
WRN/util:doctor 61099 [*] Executable was not found
INF/util:doctor 61099 [*] GraphicsMagick 1.3.25
INF/util:doctor 61099 [*] Local ADB 1.0.36

INF/util:doctor 61099 [*] Local RethinkDB server 2.3.5
``` Thanks, It's working.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
When I using "App Upload" a APK to my test phone, Faild.
Err Log as follow:

INF/storage:temp 2091 [*] Uploaded "aqybfq.apk" to "/tmp/upload_7c0e32f0c313b7cd0cb92d4a361a3b51"
ERR/storage:plugins:apk 2101 [*] Unable to read manifest of "38fa7aaa-164b-4b2c-b5c5-440e6e9709d7" Error: Invalid or unsupported zip format. No END header found
    at new ApkReader (/usr/local/lib/node_modules/stf/node_modules/adbkit-apkreader/lib/apkreader.js:27:17)
    at Function.ApkReader.readFile (/usr/local/lib/node_modules/stf/node_modules/adbkit-apkreader/lib/apkreader.js:16:14)
    at /usr/local/lib/node_modules/stf/lib/units/storage/plugins/apk/task/manifest.js:9:30
    at process._tickCallback (node.js:355:11)

Thanks for your reply Thanks, I SOLVE the problem.
Yesterday,I change some codes to fix  "screemshot" picture not show.  Now I change back ,"App Upload" FIXED, but "screemshot" not  show  back ......
I will try to fix it ,thanks for your reply  First,Thanks for your great Tools! My English not so good...

I change some codes in /stf/res/app/menu/menu.jade, 
Then input "gulp clean && gulp build "  but faild ....
It show  " No gulpfile found".
What show I do to make the changed STF work? 



 Thanks!  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 Possible, but very very hard. A work arround is to install STF on a virtualization system like Virtual Box for instance !  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
I have pulled latest code and I am getting error when running STF locally. 
and also rethinkdb is started in another terminal.

Node version is **7.8.0**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
List of devices attached
06157df68947b219       device usb:336592896X product:zerofltexx model:SM_G920F device:zeroflte
**Please provide the steps to reproduce the issue.**
Run $stf local
Run $rethinkdb

**What is the expected behavior?**
STF should start locally

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

> MM5003604:~ skumar$ stf local
> module.js:472
>     throw err;
>     ^
> 
> Error: Cannot find module 'please-update-dependencies'
>     at Function.Module._resolveFilename (module.js:470:15)
>     at Function.Module._load (module.js:418:25)
>     at Module.require (module.js:498:17)
>     at require (internal/module.js:20:19)
>     at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli/please.js:1:63)
>     at Module._compile (module.js:571:32)
>     at Object.Module._extensions..js (module.js:580:10)
>     at Module.load (module.js:488:32)
>     at tryModuleLoad (module.js:447:12)
>     at Function.Module._load (module.js:439:3)
> 

**Please run `stf doctor` and paste the output here.**

> skumar$ stf doctor
> module.js:472
>     throw err;
>     ^
> 
> Error: Cannot find module 'please-update-dependencies'
>     at Function.Module._resolveFilename (module.js:470:15)
>     at Function.Module._load (module.js:418:25)
>     at Module.require (module.js:498:17)
>     at require (internal/module.js:20:19)
>     at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli/please.js:1:63)
>     at Module._compile (module.js:571:32)
>     at Object.Module._extensions..js (module.js:580:10)
>     at Module.load (module.js:488:32)
>     at tryModuleLoad (module.js:447:12)
>     at Function.Module._load (module.js:439:3)
 I am not sure what i have done right now but i am getting error when I run this 

> MM5003604:~ skumar$ npm install
> 
> > uiautomator-client@1.1.9 install /Users/skumar/node_modules/uiautomator-client
> > node ./scripts/build.js
> 
> JAVA_HOME is set to /Library/Java/JavaVirtualMachines/jdk1.8.0_66.jdk/Contents/Home
> The android command is no longer available.
> For manual SDK and AVD management, please use Android Studio.
> For command-line tools, use tools/bin/sdkmanager and tools/bin/avdmanager
> /Users/skumar/node_modules/uiautomator-client/scripts/build.js:177
>       throw e;
>       ^
> 
> Error: setup failed
>     at ChildProcess.createProcess.on.code (/Users/skumar/node_modules/uiautomator-client/scripts/build.js:133:16)
>     at emitTwo (events.js:106:13)
>     at ChildProcess.emit (events.js:194:7)
>     at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
> npm WARN enoent ENOENT: no such file or directory, open '/Users/skumar/package.json'
> npm WARN skumar No description
> npm WARN skumar No repository field.
> npm WARN skumar No README data
> npm WARN skumar No license field.
> npm WARN optional SKIPPING OPTIONAL DEPENDENCY: uiautomator-client@1.1.9 (node_modules/uiautomator-client):
> npm WARN optional SKIPPING OPTIONAL DEPENDENCY: uiautomator-client@1.1.9 install: `node ./scripts/build.js`
> npm WARN optional SKIPPING OPTIONAL DEPENDENCY: Exit status 1
 Sorry, Can you reckon something here ..

> MM5003604:git skumar$ npm install -g stf
> npm WARN deprecated node-uuid@1.4.8: Use uuid module instead
> npm ERR! path /usr/local/lib/node_modules/stf
> npm ERR! code EISGIT
> npm ERR! git /usr/local/lib/node_modules/stf: Appears to be a git repo or submodule.
> npm ERR! git     /usr/local/lib/node_modules/stf
> npm ERR! git Refusing to remove it. Update manually,
> npm ERR! git or move it out of the way first.
> 
> npm ERR! A complete log of this run can be found in:
> npm ERR!     /Users/skumar/.npm/_logs/2017-04-11T16_05_19_363Z-debug.log @sorccu 
Much Appreciated for help! apologies for bothering.

Cheers
SK  I noticed that while running openstf, I can directly connect to a device's websocket address to stream the screen. Is the same thing possible with touch interactions?

I know I can directly use minitouch, but it feels a bit too "low-level" if using it through openstf is exposed. Thanks for the super fast response 😄! I'll give that a try and see if I'm better off just using minitouch.  stf local output : 

```
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 2885 [*] Connecting to 127.0.0.1:28015
INF/db:setup 2885 [*] Database "stf" already exists
INF/db:setup 2885 [*] Table "users" already exists
INF/db:setup 2885 [*] Table "accessTokens" already exists
INF/db:setup 2885 [*] Table "vncauth" already exists
INF/db:setup 2885 [*] Table "devices" already exists
INF/db:setup 2885 [*] Table "logs" already exists
INF/db:setup 2885 [*] Index "users"."adbKeys" already exists
INF/db:setup 2885 [*] Waiting for index "users"."adbKeys"
INF/db:setup 2885 [*] Index "accessTokens"."email" already exists
INF/db:setup 2885 [*] Index "vncauth"."response" already exists
INF/db:setup 2885 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 2885 [*] Index "devices"."owner" already exists
INF/db:setup 2885 [*] Index "devices"."present" already exists
INF/db:setup 2885 [*] Index "devices"."providerChannel" already exists
INF/db:setup 2885 [*] Waiting for index "accessTokens"."email"
INF/db:setup 2885 [*] Waiting for index "vncauth"."response"
INF/db:setup 2885 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 2885 [*] Waiting for index "devices"."owner"
INF/db:setup 2885 [*] Waiting for index "devices"."present"
INF/db:setup 2885 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 2885 [*] Index "users"."adbKeys" is ready
INF/db:setup 2885 [*] Index "accessTokens"."email" is ready
INF/db:setup 2885 [*] Index "vncauth"."response" is ready
INF/db:setup 2885 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 2885 [*] Index "devices"."owner" is ready
INF/db:setup 2885 [*] Index "devices"."present" is ready
INF/db:setup 2885 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js provider --name android --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-temp --port 7102"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 2879 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: libzmq.so.5.1.3: cannot open shared object file: No such file or directory
    at Object.Module._extensions..node (module.js:598:18)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: libzmq.so.5.1.3: cannot open shared object file: No such file or directory
    at Object.Module._extensions..node (module.js:598:18)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
FTL/cli:local 2879 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:192:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 2879 [*] Shutting down all child processes
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: libzmq.so.5.1.3: cannot open shared object file: No such file or directory
    at Object.Module._extensions..node (module.js:598:18)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: libzmq.so.5.1.3: cannot open shared object file: No such file or directory
    at Object.Module._extensions..node (module.js:598:18)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: libzmq.so.5.1.3: cannot open shared object file: No such file or directory
    at Object.Module._extensions..node (module.js:598:18)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
```
stf doctor output  : 

```
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: libzmq.so.5.1.3: cannot open shared object file: No such file or directory
    at Object.Module._extensions..node (module.js:598:18)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
```


 @sorccu I have aldready read it and install it if you want i can prove it ```
root@android:/home/android# ldconfig -p | grep zmq
	libzmq.so.4 (libc6,x86-64) => /usr/local/lib/libzmq.so.4
	libzmq.so (libc6,x86-64) => /usr/local/lib/libzmq.so
```
I use this script for the install zeromq 
https://gist.github.com/cdjhlee/b8e3c927a01b0948b42d

can you check ?   <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
Using 2.3.0 of STF. Running in docker deployment. Followed the documentation present https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md

**What is the issue or idea you have?**
When i hit the screenshot, i get the following error on console. The nginx is returning back a 301 for the screenshot upload request. All the other functionalities of being able to remote connect into a device and other options on STF works well.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
Happens for all devices.

**Please provide the steps to reproduce the issue.**
Nothing happens when trying to take screenshot

**What is the expected behavior?**
Expecting the screenshot to be captured.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
Here is the console output
1.3937bea….chunk.js:73467 Unhandled rejection TransactionError: Upload to "http://devicefarm.hikeapp.com/s/upload/image" failed: HTTP 301
    at readQueue (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:72404:30)
    at PendingTransactionResult.done (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:72432:8)
    at Socket.doneListener (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:72338:18)
    at Socket.Emitter.emit (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:53323:21)
    at Socket.onevent (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:53037:11)
    at Socket.onpacket (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:52995:13)
    at Manager.<anonymous> (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:53429:16)
    at Manager.Emitter.emit (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:53323:21)
    at Manager.ondecoded (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:48405:9)
    at Decoder.<anonymous> (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:53429:16)
    at Decoder.Emitter.emit (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:47868:21)
    at Decoder.add (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:46125:13)
    at Manager.ondata (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:48395:17)
    at Socket.<anonymous> (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:53429:16)
    at Socket.Emitter.emit (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:47868:21)
    at Socket.onPacket (http://devicefarm.hikeapp.com/static/app/build/1.3937bea4eb327ffa6730.chunk.js:49100:15)

**Please run `stf doctor` and paste the output here.**
 https://github.com/openstf/stf/issues/548#issuecomment-282198766 @sorccu i am not using https on my setup and i am only using http. 

@vbanthia the issue you have related to is about upload throwing 5XX error. In my case it is 301. Some redirection to the backend from nginx is not working.  Remote Debugging is not working.

Hello!
When I try to execute "adb connect 10.70.xx.xx:7577" after checking address and port on the Remote debug tab connecting device, then it always run successfully with response like "connected to 10.70.xx.xx:7577".
but I cannot find the device in the result of "adb devices". This happens only on small part of PCs including mine.

Also, my adb key can not be added in STF Web with "pbcopy < ~/.android/adbkey.pub".
~/.android/adbkey.pub file is a little different on my pc from one on another pc which works well.
If you look into my file, there is 0x00 between key and name, whereas there is only white space there in successful others' file.
Though I tried to recreate new adbkey file after deleting old adbkey file and run adb, 0x00 was included in the reulst again.

I am wondering if my issue has something to do with it.
If it is not in the case, what can I do to run adb connect?

My STF version is 2.3.0 and my adb key is same as below.
Please feel free to contact me if you need more information to figure out the cause.

I download android sdk from [tools_r25.2.3-macosx.zip](https://dl.google.com/android/repository/tools_r25.2.3-macosx.zip)

~~~
seongyeol@hehe platform-tools$ adb version
Android Debug Bridge version 1.0.39
Revision 5943271ace17-android

seongyeol@hehe platform-tools$ cat ~/.android/adbkey.pub
QAAAAHmXahk33YYcP0PF3CO5PZy338eRriVN75Oaprctcrb/IHuq9RuOMqo9kJZ2AJHw6CSPUFv2OdviODVMZixo/o0QPsCANhYOMHcE4raoQKV+i9/bwlBMTvkX01sqdI2Uic1rfekPcPc2QhCayj1PZVgU+AUpQKY25f4BOTLjEaCh51Q5A73VTb5MNPDnkIA6VyxLRkciX0tGpfqLqURgRaBQ1+qJFhL4P1qaB9YepYjXfEJ0Xj16w0RKpl4dw4fMCF4HmkkSPUXFzgngOtxhUxp8mk0ldaVWMxkwtkwlj8nG/ikgmTFdHRLH32pv4FaoD73K2l/on1YsDHgRoFfYeilMGyW7Cy3dv0ct5y46JeYqWtvnh6tIF3+wEmDd+vrw98JXhz77Gig7FnUG7lp/hbwVLLkR8NcNKogJfOxCVQFAzjinzpf9PyXkrqzeq5GNxdbwmMMdUu/E1ZfXzoMdpmv1cOp0W5TJ3KW+fpR0QrvEAZgyVMUVXtzDEMxCIu/cd+DFlV5VIefKI/Hxfc3uJ4R2ZqJrwkH+82LCem2Nm7TnrHm0ywT29j+y/uXJ+LJTHXRJaR+5DxrvfGceIWA0hqlOic5J1X0aBfnna1D+k/gTyBkwjgfJL00SeAJ8u0u4wmxvAkPN2e46Lw3lSMp5xcR4+4l3BYqvB0zhiuNlclbUEEHgjQEAAQA= seongyeol@hehe.local

seongyeol@hehe platform-tools$ xxd ~/.android/adbkey.pub 
00000000: 5141 4141 4148 6d58 6168 6b33 3359 5963  QAAAAHmXahk33YYc
00000010: 5030 5046 3343 4f35 505a 7933 3338 6552  P0PF3CO5PZy338eR
00000020: 7269 564e 3735 4f61 7072 6374 6372 622f  riVN75Oaprctcrb/
00000030: 4948 7571 3952 754f 4d71 6f39 6b4a 5a32  IHuq9RuOMqo9kJZ2
00000040: 414a 4877 3643 5350 5546 7632 4f64 7669  AJHw6CSPUFv2Odvi
00000050: 4f44 564d 5a69 786f 2f6f 3051 5073 4341  ODVMZixo/o0QPsCA
00000060: 4e68 594f 4d48 6345 3472 616f 514b 562b  NhYOMHcE4raoQKV+
00000070: 6939 2f62 776c 424d 5476 6b58 3031 7371  i9/bwlBMTvkX01sq
00000080: 6449 3255 6963 3172 6665 6b50 6350 6332  dI2Uic1rfekPcPc2
00000090: 5168 4361 796a 3150 5a56 6755 2b41 5570  QhCayj1PZVgU+AUp
000000a0: 514b 5932 3566 3442 4f54 4c6a 4561 4368  QKY25f4BOTLjEaCh
000000b0: 3531 5135 4137 3356 5462 354d 4e50 446e  51Q5A73VTb5MNPDn
000000c0: 6b49 4136 5679 784c 526b 6369 5830 7447  kIA6VyxLRkciX0tG
000000d0: 7066 714c 7155 5267 5261 4251 312b 714a  pfqLqURgRaBQ1+qJ
000000e0: 4668 4c34 5031 7161 4239 5965 7059 6a58  FhL4P1qaB9YepYjX
000000f0: 6645 4a30 586a 3136 7730 524b 706c 3464  fEJ0Xj16w0RKpl4d
00000100: 7734 664d 4346 3448 6d6b 6b53 5055 5846  w4fMCF4HmkkSPUXF
00000110: 7a67 6e67 4f74 7868 5578 7038 6d6b 306c  zgngOtxhUxp8mk0l
00000120: 6461 5657 4d78 6b77 746b 776c 6a38 6e47  daVWMxkwtkwlj8nG
00000130: 2f69 6b67 6d54 4664 4852 4c48 3332 7076  /ikgmTFdHRLH32pv
00000140: 3446 616f 4437 334b 326c 2f6f 6e31 5973  4FaoD73K2l/on1Ys
00000150: 4448 6752 6f46 6659 6569 6c4d 4779 5737  DHgRoFfYeilMGyW7
00000160: 4379 3364 7630 6374 3579 3436 4a65 5971  Cy3dv0ct5y46JeYq
00000170: 5774 766e 6836 7449 4633 2b77 456d 4464  Wtvnh6tIF3+wEmDd
00000180: 2b76 7277 3938 4a58 687a 3737 4769 6737  +vrw98JXhz77Gig7
00000190: 466e 5547 376c 702f 6862 7756 4c4c 6b52  FnUG7lp/hbwVLLkR
000001a0: 384e 634e 4b6f 674a 664f 7843 5651 4641  8NcNKogJfOxCVQFA
000001b0: 7a6a 696e 7a70 6639 5079 586b 7271 7a65  zjinzpf9PyXkrqze
000001c0: 7135 474e 7864 6277 6d4d 4d64 5575 2f45  q5GNxdbwmMMdUu/E
000001d0: 315a 6658 7a6f 4d64 706d 7631 634f 7030  1ZfXzoMdpmv1cOp0
000001e0: 5735 544a 334b 572b 6670 5230 5172 7645  W5TJ3KW+fpR0QrvE
000001f0: 415a 6779 564d 5556 5874 7a44 454d 7843  AZgyVMUVXtzDEMxC
00000200: 4975 2f63 642b 4446 6c56 3556 4965 664b  Iu/cd+DFlV5VIefK
00000210: 492f 4878 6663 3375 4a34 5232 5a71 4a72  I/Hxfc3uJ4R2ZqJr
00000220: 776b 482b 3832 4c43 656d 324e 6d37 546e  wkH+82LCem2Nm7Tn
00000230: 7248 6d30 7977 5432 396a 2b79 2f75 584a  rHm0ywT29j+y/uXJ
00000240: 2b4c 4a54 4858 524a 6152 2b35 4478 7276  +LJTHXRJaR+5Dxrv
00000250: 6647 6365 4957 4130 6871 6c4f 6963 354a  fGceIWA0hqlOic5J
00000260: 3158 3061 4266 6e6e 6131 442b 6b2f 6754  1X0aBfnna1D+k/gT
00000270: 7942 6b77 6a67 664a 4c30 3053 6541 4a38  yBkwjgfJL00SeAJ8
00000280: 7530 7534 776d 7876 416b 504e 3265 3436  u0u4wmxvAkPN2e46
00000290: 4c77 336c 534d 7035 7863 5234 2b34 6c33  Lw3lSMp5xcR4+4l3
000002a0: 4259 7176 4230 7a68 6975 4e6c 636c 6255  BYqvB0zhiuNlclbU
000002b0: 4545 4867 6a51 4541 4151 413d 0020 7365  EEHgjQEAAQA=. se
000002c0: 6f6e 6779 656f 6c40 6865 6865 2e6c 6f63  ongyeol@hehe.loc
000002d0: 616c                                     al
~~~

stf doctor
~~~
STF:~ stf$ stf doctor
INF/util:doctor 885 [*] OS Arch: x64
INF/util:doctor 885 [*] OS Platform: darwin
INF/util:doctor 885 [*] OS Platform: 16.4.0
INF/util:doctor 885 [*] Using Node 4.2.6
INF/util:doctor 885 [*] Using RethinkDB client 2.3.3
INF/util:doctor 885 [*] Using ZeroMQ 4.2.0
INF/util:doctor 885 [*] GraphicsMagick 1.3.25
INF/util:doctor 885 [*] Local ADB 1.0.36

INF/util:doctor 885 [*] ProtoBuf 3.1.0
ERR/util:doctor 885 [*] Current ProtoBuf version is not supported, it has to be ~2
INF/util:doctor 885 [*] Local RethinkDB server 2.3.5
~~~

STF local message When adding my adb key in STF web.
~~~
Unhandled rejection Error: Unrecognizable public key format
    at /Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/auth.js:69:23
    at tryCatcher (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Promise._resolveFromResolver (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:476:31)
    at new Promise (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:69:37)
    at Function.Auth.parsePublicKey (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/auth.js:62:12)
    at Object.module.exports.parsePublicKey (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/util.js:12:15)
    at Socket.<anonymous> (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/lib/units/websocket/index.js:370:30)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at Socket.onevent (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/lib/socket.js:335:8)
    at Socket.onpacket (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/lib/socket.js:295:12)
    at Client.ondecoded (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/lib/client.js:193:14)
    at Decoder.Emitter.emit (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/node_modules/socket.io-parser/node_modules/component-emitter/index.js:134:20)
    at Decoder.add (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/node_modules/socket.io-parser/index.js:247:12)
    at Client.ondata (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/lib/client.js:175:18)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at Socket.onPacket (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/node_modules/engine.io/lib/socket.js:101:14)
    at emitOne (events.js:77:13)
    at WebSocket.emit (events.js:169:7)
    at WebSocket.Transport.onPacket (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/node_modules/engine.io/lib/transport.js:104:8)
    at WebSocket.Transport.onData (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/socket.io/node_modules/engine.io/lib/transport.js:115:8)
~~~

STF local message when adb connect
~~~
INF/device:plugins:connect 770 [ZPSOWSNN99999999] New remote ADB connection from ::ffff:10.70.9.105
FTL/util:lifecycle 770 [ZPSOWSNN99999999] Remote ADB had an error Error: Unrecognizable public key format
    at /Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/auth.js:69:23
    at tryCatcher (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Promise._resolveFromResolver (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:476:31)
    at new Promise (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:69:37)
    at Function.Auth.parsePublicKey (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/auth.js:62:12)
    at Socket._handleAuthPacket (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/tcpusb/socket.js:165:21)
    at /Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/tcpusb/socket.js:109:26
    at tryCatcher (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Function.Promise.attempt.Promise.try (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/method.js:31:24)
    at Socket._handle (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/tcpusb/socket.js:95:26)
    at emitOne (events.js:77:13)
    at PacketReader.emit (events.js:169:7)
    at PacketReader._tryRead (/Users/stf/.nvm/versions/node/v4.2.6/lib/node_modules/stf/node_modules/adbkit/lib/adb/tcpusb/packetreader.js:45:16)
    at emitNone (events.js:67:13)
    at Socket.emit (events.js:166:7)
    at emitReadable_ (_stream_readable.js:411:10)
    at emitReadable (_stream_readable.js:405:7)
    at readableAddChunk (_stream_readable.js:157:11)
    at Socket.Readable.push (_stream_readable.js:110:10)
    at TCP.onread (net.js:523:20)
FTL/util:lifecycle 770 [ZPSOWSNN99999999] Shutting down due to fatal error
INF/provider 656 [*] Cleaning up device worker "ZPSOWSNN99999999"
ERR/provider 656 [*] Device worker "ZPSOWSNN99999999" died with code 1
INF/provider 656 [*] Restarting device worker "ZPSOWSNN99999999"
INF/device:support:push 814 [ZPSOWSNN99999999] Sending output to "tcp://127.0.0.1:7116"
INF/device 814 [ZPSOWSNN99999999] Preparing device
INF/device:support:sub 814 [ZPSOWSNN99999999] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 814 [ZPSOWSNN99999999] Subscribing to permanent channel "*ALL"
INF/device:support:properties 814 [ZPSOWSNN99999999] Loading properties
INF/device:support:abi 814 [ZPSOWSNN99999999] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:service 814 [ZPSOWSNN99999999] Checking whether we need to install STFService
INF/device:resources:service 814 [ZPSOWSNN99999999] Running version check
INF/device:resources:service 814 [ZPSOWSNN99999999] STFService up to date
INF/device:plugins:service 814 [ZPSOWSNN99999999] Launching agent
INF/device:plugins:service 814 [ZPSOWSNN99999999] Agent says: "Listening on @stfagent"
INF/device:plugins:service 814 [ZPSOWSNN99999999] Launching service
INF/device:plugins:service 814 [ZPSOWSNN99999999] Agent says: "InputClient started"
INF/device:plugins:display 814 [ZPSOWSNN99999999] Reading display info
INF/device:plugins:phone 814 [ZPSOWSNN99999999] Fetching phone info
INF/device:plugins:identity 814 [ZPSOWSNN99999999] Solving identity
INF/device:plugins:solo 814 [ZPSOWSNN99999999] Subscribing to permanent channel "MPVUuHr7L8sjcruJU/zmMrLSlUU="
INF/device:plugins:screen:stream 814 [ZPSOWSNN99999999] Starting WebSocket server on port 7612
WRN/device:plugins:data 814 [ZPSOWSNN99999999] Unable to find device data { serial: 'ZPSOWSNN99999999',
  platform: 'Android',
  manufacturer: 'XIAOMI',
  operator: null,
  model: 'Redmi Note 2',
  version: '5.0.2',
  abi: 'arm64-v8a',
  sdk: '21',
  product: 'hermes',
  display:
   { id: 0,
     width: 1080,
     height: 1920,
     xdpi: 403.4110107421875,
     ydpi: 403.0409851074219,
     fps: 60.10000228881836,
     density: 3,
     rotation: 0,
     secure: true,
     size: 5.464510452525597,
     url: 'ws://10.70.2.100:7612' },
  phone: { imei: '867515020845722', network: 'UNKNOWN' } }
INF/device:plugins:touch 814 [ZPSOWSNN99999999] Touch origin is top left
INF/device:plugins:touch 814 [ZPSOWSNN99999999] Requesting touch consumer to start
INF/device:plugins:touch 814 [ZPSOWSNN99999999] Launching screen service
INF/device:plugins:touch 814 [ZPSOWSNN99999999] Connecting to minitouch service
INF/device:plugins:touch 814 [ZPSOWSNN99999999] minitouch says: "Type B touch device mtk-tpd (1080x1920 with 10 contacts) detected on /dev/input/event3 (score 2100)"
INF/device:plugins:touch 814 [ZPSOWSNN99999999] minitouch says: "Connection established"
INF/device:plugins:touch 814 [ZPSOWSNN99999999] Reading minitouch banner
INF/device:plugins:vnc 814 [ZPSOWSNN99999999] Starting VNC server on port 7614
INF/device:plugins:browser 814 [ZPSOWSNN99999999] Loading browser list
INF/device:plugins:browser 814 [ZPSOWSNN99999999] Updating browser list
WRN/device:plugins:browser 814 [ZPSOWSNN99999999] Unmapped browser "com.cleanmaster.mguard"
INF/device:plugins:mute 814 [ZPSOWSNN99999999] Will not mute master volume during use
INF/device:plugins:forward 814 [ZPSOWSNN99999999] Launching reverse port forwarding service
INF/device:plugins:forward 814 [ZPSOWSNN99999999] Connecting to reverse port forwarding service
INF/device:plugins:connect 814 [ZPSOWSNN99999999] Listening on port 7613
INF/device 814 [ZPSOWSNN99999999] Fully operational
INF/util:datautil 660 [*] Device database does not have an entry for "ZPSOWSNN99999999" (model "Redmi Note 2"/"hermes"). This is not an error, it only means that we don't have data for it yet.
~~~ Remote debugging is working well on my pc after removing the invalid characters from my public key. Thanks @sorccu  Hi @sorccu 

It looks we can see the same observation `Unhandled rejection Error: Unrecognizable public key format`. Can you please check our two adb keys:
```
QAAAABf2FZ5ZXqe3kod40MBeTMnCe/2azZs4Ar6Z17iItjkXTdx42uwgrmtqIXYvR9sNLT7L4XJlaZAdOZn2EWdrOFN2EJpIPP4Y/Q0MZuIB/kN4JWklk8AHprNNVXMc3K/KhnGuI4G2LqnswpfZcA9z54YX3eNRgQXl2E7sjQehq2KHVr7CkmehdJgLlmUjI27E4yV/UY+gw41LFq51xX5QUeV+tDte3Pe8nTbO+dkoc/SiQk+O6TnoVbo+Y25Q+Njs/f9sErHhS2Db+YI1Hhih4XSGPJT+7lSW/pO0ji0o6mo5ohjry8k+VvdZDKlfqzj1MtonhUarjhW7Uiq6CeFTnk+uUcy5Z9ri/F1tshxB1RDjRs+HdqDjo8u/BZyz/JA46TnhKRfOL5oo7NawUieqyFdNkN5r01GJ994+FqhBgFj01eACBealrQQlnPGD4jy4I9QI8uldo0feHKIgMaY0oZP69kVrFsVL2A93BWWcuI9/luelORntIReImtOLSSriQJHqHNoojGyddH82rJnOY9UzEyuNAXVasin+U2bAkEVLQ7umlLKUUP7Hl/GKrE8FFjNb3I3xSOKfcwE7eEYRpWycz+4t55zaPtjj0S1rWSkTVBvkmJOKFv5L4iE+5A4j3KdPeR5TJlXaiRXwPZeIjdU8cSol1GwZz3bHFccGA6nID3k+MwEAAQA= unknown@unknown
```
```
QAAAAE8HjXFRUGh4RbmhtDH6RuO45Kpaq9dFPi3DXzoY50+pUl0eRokYa/6iMw9jenU6pYYmld9ERo3iaJF/ICw/SxTuE/PQRL6wLRnyoUWiULvOW4CvIypbYgKvqtZb20+bj21s176SmU2WjWw1Yrg5hxcyyN4Kwp3Qteymxl+GACTV6SJldc7vFdCOJcvSHEcCiWBHwnjgzn1itH7C78e8RbMI5dBk7dSU8ODhvOaT9KtE0vkiLYrrXv0/VpUs2B81CFthXkt5JrBTVxAlcLtv6ZIz6ZhHhQY/6ldnQLX1FEu7QMOznPTsR6Xl99UnHC0+RDWygMRjqdE2QwFS+z+fzTY6FCm7gKyq3gVOe2vcfXSGbLELSOuNyM7WPzbeLqp+4ap/+A2FyqeGs5n14JJAhznuQ5u3z/UorM00UKtoR7mOVqhdlZaLM1m63Tykx+YvnbXsXHK61OO4dfbzcnIOmwJWu4/iiBo7e3tVFZ6xv29zWUtz0bZ/3xZm4s28CMsIPcbF2YYtKKY3CDQUYPznmD7LnbLpvzCTpzUpy2w7I4tRBrFPa6I63eMtNGWBWhhOFCPNgINDxae/XSPzMA6N4D6k9dJfT/BJmV/a/tPekV1jybpfZMmYv5qrwmChO0+hBtSz9eeYi+VGZevDyMbAPq0f+yUJx85zMRmUUWOocvjBdYeGDgEAAQA=  @unknown
```

We are using latest stf@2.3.0 and adbkit@2.10.0. Yes, I am 100% sure about it. We are hosting stf in docker and I just tried `npm ls --depth | grep adbkit` in docker container. Then it says:
```
+-- adbkit@2.10.0
| +-- adbkit-logcat@1.1.0
+-- adbkit-apkreader@2.1.1
+-- adbkit-monkey@1.0.1
```  **What is the issue or idea you have?**

I changed in rethinkdb the model of all devices in the database so that the name of the phone displayed is clear (some devices had weird model names), but the moment I disconnected a device and connected it again, this value resets to the previous one that confuses people.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

Happens in all devices

**Please provide the steps to reproduce the issue.**

1. Connect a phone to OpenSTF
2. Connect to the rethinkdb admin
3. Make a query to change the model name of the device connected in step 1
4. Refresh and check that the model name changed succesfully
5. Disconnect the device
6. Connect the device

**What is the expected behavior?**

Model name changed in step 3 doesn't change when disconnecting and connecting
 Thanks for the quick reply!

Is there anyway I can change these values so that they stay permanently in the db? (Or any workaround that would just let users see quickly which device is which by their known name without knowledge of device model) My workaround is: create a script to update model name in rethinkdb, and add it to cronjob to run every 5 minutes :)  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
Hi, I'm using the latest version of STF - 2.3.0. 
**What is the issue or idea you have?**
Devices are properly connected and detected by computer but STF is not detecting them. Note that on the same machine with an older STF version, this used to work fine. This issue started occurring only in this newer version 2.3.0

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
When I run adb devices, list of devices is showing blank.

**Please provide the steps to reproduce the issue.**
Connect the devices to computer, notice the computer has properly detected the devices

**What is the expected behavior?**
STF should also properly detect the attached devices.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
![stf-local](https://cloud.githubusercontent.com/assets/26623893/24245799/5ebb81ae-0fea-11e7-8266-a27760859ad4.png)

**Please run `stf doctor` and paste the output here.**
![stf-doctor](https://cloud.githubusercontent.com/assets/26623893/24245576/7f8a067c-0fe9-11e7-96ac-97ec07157573.png)
 My bad, I'm closing this issue. Actually those attached devices' USB debugging setting was not enabled, because of which the adb devices was resulting blank. 

STF is working great. Thank you. closing per above comment  Hi 
    I wonder if stf can Sync Operation on several devices ? For example, I'm operating one devices, other devices do the same operations. Thanks ~  Android O source code already release: 
https://android.googlesource.com/platform/external/selinux/+/android-o-preview-1 Developer Preview 2 released. https://android.googlesource.com/platform/external/selinux/+/android-o-preview-2  The news said that Android O Preview 3 released. Wish that STF could support this release. ^^ Thank you very much for your investigation. I browse this page every day and expect a good news. It's too hard for me to solve this issue by myself - :'( Dear Simo, is it possible to provide a limited edition of STFService.apk to support Android O Developer  Preview 3? ありがとうございます. um...not work on o preview .... looking forward it ..... Developer Preview 3 released. https://android.googlesource.com/platform/external/selinux/+/android-o-preview-3 https://android.googlesource.com/platform/external/selinux/+/o-preview-4,  it's almost the final official release. I got the final official image of Android O and flush it into my Pixel. There are two problems til now:

  1. In STFService.apk/app/src/main/java/jp/co/cyberagent/stf/monitor/RotationMonitor.java
      * This line  `report(writer, wm.getRotation());`  ==> wm is invalid, so the invocation of wm.getRotation() will cause connection stopping and stf device component attempt to restart service recursively until timeout.
         * Work around is to comment out the line of  `addMonitor(new RotationMonitor(this, writers));` in STFService.apk/app/src/main/java/jp/co/cyberagent/stf/Service.java   

  2. minicap doesn't work for Andriod O, it's a known [issue](https://github.com/openstf/minicap/issues/67)  
      * minicap error: "ERROR: (external/MY_minicap/src/minicap_26.cpp:281: errno: None) Unable to find neither AOSP nor O Developer Preview 1 BufferQueue::createBufferQueue"

Anyway, I'll try my best to resolve the problem of minicap on Android O
  **Environment:**

- STF Version 2.3.0
- Running in Docker Container after your deployment.md
- Serveral Android Phones, Tablets and Smartwatches connected to the different device hosts in different locations
- Wiko Lenny 3 (Android 6.0) with activated USB Debugging

**What is the issue or idea you have?**

STF Service App was automatically installed on the device.
The STF Service doesn't start on the Wiko Lenny 3.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

Yes, it happes only to Wiko LENNY 3.

0123456789ABCDEF       device product:V3702AN model:LENNY3 device:V3702AN

**Please provide the steps to reproduce the issue.**

Check if any old version of the STF Services is installed on the phone. If there are any old versions than uninstall them.
Plug the phone to device host with the USB Debugging enabled on the phone
--> STF Services doesn't start on phone. The phone is not listed in the STF web front end.

**What is the expected behavior?**

After plugging the phone to the device host.
The STF Services get installed and are started automatically by the device host.
Afterwards the Smartphone is listed on the STF web front end.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

Logs of the Device host:

FTL/util:lifecycle 10282 [0123456789ABCDEF] Shutting down due to fatal error
INF/provider 1 [*] Cleaning up device worker "0123456789ABCDEF"
ERR/provider 1 [*] Device worker "0123456789ABCDEF" died with code 1
INF/provider 1 [*] Restarting device worker "0123456789ABCDEF"
INF/device:support:push 10294 [0123456789ABCDEF] Sending output to "tcp://devside.stf-server.iavgroup.local:7270"
INF/device 10294 [0123456789ABCDEF] Preparing device
INF/device:support:sub 10294 [0123456789ABCDEF] Receiving input from "tcp://devside.stf-server.iavgroup.local:7250"
INF/device:support:sub 10294 [0123456789ABCDEF] Subscribing to permanent channel "*ALL"
INF/device:support:properties 10294 [0123456789ABCDEF] Loading properties
INF/device:support:abi 10294 [0123456789ABCDEF] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 10294 [0123456789ABCDEF] Checking whether we need to install STFService
INF/device:resources:service 10294 [0123456789ABCDEF] Running version check
INF/device:resources:service 10294 [0123456789ABCDEF] STFService up to date
INF/device:plugins:service 10294 [0123456789ABCDEF] Launching agent
INF/device:plugins:service 10294 [0123456789ABCDEF] Launching service
INF/device:plugins:service 10294 [0123456789ABCDEF] Agent says: "Listening on @stfagent"
INF/device:plugins:service 10294 [0123456789ABCDEF] Agent says: "InputClient started"
FTL/device 10294 [0123456789ABCDEF] Setup had an error Error: Service had an error: "Error: Not found; no service started."
    at /app/lib/units/device/plugins/service.js:101:23
From previous event:
    at /app/lib/units/device/plugins/service.js:76:14
    at runCallback (timers.js:637:20)
    at tryOnImmediate (timers.js:610:5)
    at processImmediate [as _immediateCallback] (timers.js:582:5)
FTL/util:lifecycle 10294 [0123456789ABCDEF] Shutting down due to fatal error
INF/provider 1 [*] Cleaning up device worker "0123456789ABCDEF"
ERR/provider 1 [*] Device worker "0123456789ABCDEF" died with code 1
INF/provider 1 [*] Restarting device worker "0123456789ABCDEF"
INF/device:support:push 10306 [0123456789ABCDEF] Sending output to "tcp://devside.stf-server.iavgroup.local:7270"
INF/device 10306 [0123456789ABCDEF] Preparing device
INF/device:support:sub 10306 [0123456789ABCDEF] Receiving input from "tcp://devside.stf-server.iavgroup.local:7250"
INF/device:support:sub 10306 [0123456789ABCDEF] Subscribing to permanent channel "*ALL"
INF/device:support:properties 10306 [0123456789ABCDEF] Loading properties
INF/device:support:abi 10306 [0123456789ABCDEF] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 10306 [0123456789ABCDEF] Checking whether we need to install STFService
INF/device:resources:service 10306 [0123456789ABCDEF] Running version check
INF/device:resources:service 10306 [0123456789ABCDEF] STFService up to date
INF/device:plugins:service 10306 [0123456789ABCDEF] Launching agent
INF/device:plugins:service 10306 [0123456789ABCDEF] Agent says: "Listening on @stfagent"
INF/device:plugins:service 10306 [0123456789ABCDEF] Launching service
INF/device:plugins:service 10306 [0123456789ABCDEF] Agent says: "InputClient started"
FTL/device 10306 [0123456789ABCDEF] Setup had an error Error: Service had an error: "Error: Not found; no service started."
    at /app/lib/units/device/plugins/service.js:101:23
From previous event:
    at /app/lib/units/device/plugins/service.js:76:14
    at runCallback (timers.js:637:20)
    at tryOnImmediate (timers.js:610:5)
    at processImmediate [as _immediateCallback] (timers.js:582:5)
FTL/util:lifecycle 10306 [0123456789ABCDEF] Shutting down due to fatal error
INF/provider 1 [*] Cleaning up device worker "0123456789ABCDEF"
ERR/provider 1 [*] Device worker "0123456789ABCDEF" died with code 1
INF/provider 1 [*] Restarting device worker "0123456789ABCDEF"
INF/device:support:push 10318 [0123456789ABCDEF] Sending output to "tcp://devside.stf-server.iavgroup.local:7270"
INF/device 10318 [0123456789ABCDEF] Preparing device
INF/device:support:sub 10318 [0123456789ABCDEF] Receiving input from "tcp://devside.stf-server.iavgroup.local:7250"
INF/device:support:sub 10318 [0123456789ABCDEF] Subscribing to permanent channel "*ALL"
INF/device:support:properties 10318 [0123456789ABCDEF] Loading properties
INF/device:support:abi 10318 [0123456789ABCDEF] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 10318 [0123456789ABCDEF] Checking whether we need to install STFService
INF/device:resources:service 10318 [0123456789ABCDEF] Running version check
INF/device:resources:service 10318 [0123456789ABCDEF] STFService up to date
INF/device:plugins:service 10318 [0123456789ABCDEF] Launching agent
INF/device:plugins:service 10318 [0123456789ABCDEF] Agent says: "Listening on @stfagent"
INF/device:plugins:service 10318 [0123456789ABCDEF] Launching service
INF/device:plugins:service 10318 [0123456789ABCDEF] Agent says: "InputClient started"
FTL/device 10318 [0123456789ABCDEF] Setup had an error Error: Service had an error: "Error: Not found; no service started."
    at /app/lib/units/device/plugins/service.js:101:23
From previous event:
    at /app/lib/units/device/plugins/service.js:76:14
    at runCallback (timers.js:637:20)
    at tryOnImmediate (timers.js:610:5)
    at processImmediate [as _immediateCallback] (timers.js:582:5)
FTL/util:lifecycle 10318 [0123456789ABCDEF] Shutting down due to fatal error


The Log is repeating. The installation wents through fine but the service doesn't start.

**Please run `stf doctor` and paste the output here.**

Should I run the stf doctor on the device host?

Thank you for your help!

Kind regards 

Felix Hahn I can't find any similar settings on the Wiko phone. I will look into the topic after my holiday. I will be back next week on monday.

Thank you for your fast response @sorccu Sorry, the mistake was on our side.
To use the Wiko Lenny 3 with STF you must deactivate the 360 Security app (is installed by default by Wiko) and allow STF Services in Protected Apps.

For deactivating Wiko 360 Security App: 

Settings -> Apps -> 360 Security -> than deactivate App

![wikolenny3_360security](https://cloud.githubusercontent.com/assets/9655106/24393444/695611ea-1398-11e7-8278-deae2ce8f28e.jpg)

Allowing STF Service App in Protected App:

Settings -> Protected Apps -> Set the slider for STF Services on active

![lenny3_0123456789abcdef](https://cloud.githubusercontent.com/assets/9655106/24393216/85fa6ebe-1397-11e7-827e-b4c2abacf4ac.jpg)

After you did these settings the Wiko Lenny 3 runs fine with STF :).

 Thank you for the advice. We already noticed this behaviour with several cheap phones from smaller manufacturers. This is a problem for us. Because from what I know the only way to set this serial number is to root the phone and this is no option for us. Am I right? Thank you :). The Proxy is a good idea. When there is time we will look into it. I will talk to Benjamin who did already the Appium Connector for us. 

Thanks again :).  Hello, @sorccu I installed newly STF code,but i found the screenshots doesn't work.can ypu help me ?
![image](https://cloud.githubusercontent.com/assets/24601692/24089954/0b27147e-0d77-11e7-99e4-f7c06fffa1a1.png)


 modify lib/unit/storage/temp.js
copy another  app.get('/s/blog/:id/:name'......） @0x88l Sorry, according to what you said, I did not find temp.js in lib/unit/storage/temp.js,What can be done in detail?thx  is the stf has any tools support to type text from keyword of pc？just like minicap can support screen stream. what's built-in?you mean is the adb shell input?but it's not support unicode，can i just use STFService.apk。  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Hi there, STF is a great tool but I'm wondering if possible to configure the screen capture module (minicap?) for lower color depths. The thing is, one single device can eat up to 10-15 mbit/s bandwidth, even more if has HD screen - for debugging, you might not want to have full color palette (24-32bit) but instead, optimized bandwidth and reduced memory/cache usage may be a reasonable decision. What do you think? Is it already available maybe?

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
Any

**Please provide the steps to reproduce the issue.**
N/A

**What is the expected behavior?**
N/A

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
N/A

**Please run `stf doctor` and paste the output here.**-
N/A
 Where I can find the option in configuration in master branch?
Thanks!  why code of storage-temp/index.js is require('../../units/storage/s3') and code of storage-s3/index.js is require('../../units/storage/temp')?Is there anything wrong?
 yes,i get it ,thank you!  The following error log was printed when some apk was install.

```
Unable to read manifest of "29c0dd77-a972-450a-9522-e5acc308c934" RangeError: index out of range
    at checkOffset (buffer.js:506:11)
    at Buffer.readInt32LE (buffer.js:659:5)
    at BinaryXmlParser.readS32 (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/lib/apkreader/parser/binaryxml.js:105:25)
    at BinaryXmlParser.readXmlAttribute (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/lib/apkreader/parser/binaryxml.js:411:20)
    at BinaryXmlParser.readXmlElementStart (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/lib/apkreader/parser/binaryxml.js:389:35)
    at BinaryXmlParser.parse (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/lib/apkreader/parser/binaryxml.js:486:18)
    at ManifestParser.parse (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/lib/apkreader/parser/manifest.js:140:33)
    at /home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/lib/apkreader.js:103:44
    at tryCatcher (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/node_modules/bluebird/js/release/util.js:16:23)
    at Promise._settlePromiseFromHandler (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/node_modules/bluebird/js/release/promise.js:512:31)
    at Promise._settlePromise (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/node_modules/bluebird/js/release/promise.js:569:18)
    at Promise._settlePromise0 (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/node_modules/bluebird/js/release/promise.js:614:10)
    at Promise._settlePromises (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/node_modules/bluebird/js/release/promise.js:693:18)
    at Async._drainQueue (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/node_modules/bluebird/js/release/async.js:133:16)
    at Async._drainQueues (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/node_modules/bluebird/js/release/async.js:143:10)
    at Immediate.Async.drainQueues [as _onImmediate] (/home1/irteam/deploy/mtest2/node_modules/adbkit-apkreader/node_modules/bluebird/js/release/async.js:17:14)
    at processImmediate [as _immediateCallback] (timers.js:367:17)
```
 I did send to mail to _[edited out]_.  I am sure i am using the latest version of STF
my issue is that devices(oppo R819T,Lenovo S890,huaweiT8951) have some errors as follows:
# oppo # R819T:
STF screen is not synchronized with the phone screen, after a while and the same,
## adb devices -l:  ` 6LQSCQSWKFNJPBTC       device usb:1-3.4.3 product:OPPO89T_13015 model:R819T device:R819T`  
## STF output:
`MP/device:plugins:group 11010 [6LQSCQSWKFNJPBTC] Now owned by "a@a.com"
INF/device:plugins:group 11010 [6LQSCQSWKFNJPBTC] Subscribing to group channel "CrAIyvSBSryaoQbOzasmoQ=="
INF/util:datautil 10960 [*] Device database does not have an entry for "6LQSCQSWKFNJPBTC" (model "R819T"/"OPPO89T_13015"). This is not an error, it only means that we don't have data for it yet.
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Setting frame producer projection to 390x521
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Requesting frame producer to start
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Launching screen service
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "PID: 4123"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: Using projection 720x1280@293x521/0"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:239) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:242) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:249) Creating virtual display"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:255) Creating CPU consumer"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:261) Creating buffer queue"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:267) Creating frame waiter"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:271) Publishing virtual display"
IMP/device:plugins:connect 11010 [6LQSCQSWKFNJPBTC] Remote Connect Started for device "6LQSCQSWKFNJPBTC" at "localhost:7401"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 2766852 bytes for JPG encoder"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Connecting to minicap service
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Reading minicap banner
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
Unhandled rejection TimeoutError: operation timed out
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)
From previous event:
    at EventEmitter.plugin.acquireWakeLock (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/units/device/plugins/service.js:455:10)
    at EventEmitter.<anonymous> (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/units/device/plugins/group.js:103:15)
    at emitOne (events.js:96:13)
    at EventEmitter.emit (events.js:189:7)
    at /home/mat/myfolder/project/STF/1stfTest/stf-master/lib/units/device/plugins/group.js:64:18
From previous event:
    at EventEmitter.plugin.join (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/units/device/plugins/group.js:42:15)
    at /home/mat/myfolder/project/STF/1stfTest/stf-master/lib/units/device/plugins/group.js:117:27
    at runCallback (timers.js:651:20)
    at tryOnImmediate (timers.js:624:5)
    at processImmediate [as _immediateCallback] (timers.js:596:5)
From previous event:
    at Router.<anonymous> (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/units/device/plugins/group.js:116:12)
    at Router.emit (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/eventemitter3/index.js:118:35)
    at Router.<anonymous> (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/wire/router.js:36:12)
    at emitTwo (events.js:106:13)
    at exports.Socket.emit (events.js:192:7)
    at exports.Socket.Socket._flushRead (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/zmq/lib/index.js:638:15)
    at exports.Socket.Socket._flushReads (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/zmq/lib/index.js:676:23)
    at Object._zmq.onReadReady (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/zmq/lib/index.js:297:10)
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Requesting frame producer to stop
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Disconnecting from minicap service
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Stopping minicap service
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Sending SIGTERM to minicap
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (jni/minicap/minicap.cpp:197) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (jni/minicap/minicap.cpp:516) Closing client connection"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:286) Destroying virtual display"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Keeping 390x521 as current frame producer projection
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Requesting frame producer to start
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Launching screen service
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "PID: 4163"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: Using projection 720x1280@293x521/0"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:239) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:242) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:249) Creating virtual display"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:255) Creating CPU consumer"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:261) Creating buffer queue"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:267) Creating frame waiter"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:271) Publishing virtual display"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Connecting to minicap service
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 2766852 bytes for JPG encoder"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
INF/device:plugins:screen:stream 11010 [6LQSCQSWKFNJPBTC] Reading minicap banner`


# Lenovo S890 and huaweiT8951:
STF screen is gray, after a while the pop-up window shows someone stole your device.
I debug the code,find that device/screen/stream.js--> _ensureState function-->_connectService-->new RiskyStream,the stream is ended unexpectedEnd
## adb devices -l:`0123456789ABCDEF       device usb:1-3.4.3`
## STF output:
`INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Setting frame producer projection to 390x521
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Requesting frame producer to start
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Launching screen service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "PID: 7506"
IMP/device:plugins:connect 11288 [0123456789ABCDEF] Remote Connect Started for device "0123456789ABCDEF" at "localhost:7405"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: Using projection 480x854@293x521/0"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 1246212 bytes for JPG encoder"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Connecting to minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Reading minicap banner
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
WRN/device:plugins:screen:stream 11288 [0123456789ABCDEF] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Disconnecting from minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Stopping minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Launching screen service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "PID: 7510"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: Using projection 480x854@293x521/0"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 1246212 bytes for JPG encoder"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Connecting to minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Reading minicap banner
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
WRN/device:plugins:screen:stream 11288 [0123456789ABCDEF] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Disconnecting from minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Stopping minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Launching screen service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "PID: 7564"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: Using projection 480x854@293x521/0"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 1246212 bytes for JPG encoder"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Connecting to minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Reading minicap banner
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
WRN/device:plugins:screen:stream 11288 [0123456789ABCDEF] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Disconnecting from minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Stopping minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Launching screen service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "PID: 7582"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: Using projection 480x854@293x521/0"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 1246212 bytes for JPG encoder"
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Connecting to minicap service
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Reading minicap banner
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
WRN/device:plugins:screen:stream 11288 [0123456789ABCDEF] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 11288 [0123456789ABCDEF] Disconnecting from minicap service
FTL/device:plugins:screen:stream 11288 [0123456789ABCDEF] Frame producer had an error Error: Failed more than 3 times in 10000ms
    at FrameProducer._failLimitExceeded (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/units/device/plugins/screen/stream.js:222:26)
    at FailCounter.emit (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/eventemitter3/index.js:117:35)
    at FailCounter.inc (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/util/failcounter.js:29:10)
    at FrameProducer._outputEnded (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/units/device/plugins/screen/stream.js:215:24)
    at RiskyStream.emit (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/eventemitter3/index.js:115:35)
    at RiskyStream.<anonymous> (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/util/riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:186:7)
    at endReadableNT (_stream_readable.js:974:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/util:lifecycle 11288 [0123456789ABCDEF] Shutting down due to fatal error
INF/provider 10937 [*] Cleaning up device worker "0123456789ABCDEF"
ERR/provider 10937 [*] Device worker "0123456789ABCDEF" died with code 1
INF/provider 10937 [*] Restarting device worker "0123456789ABCDEF"
INF/device:support:push 11346 [0123456789ABCDEF] Sending output to "tcp://127.0.0.1:7116"
INF/device 11346 [0123456789ABCDEF] Preparing device`

# stf doctor:
`INF/util:doctor 11668 [*] OS Arch: x64
INF/util:doctor 11668 [*] OS Platform: linux
INF/util:doctor 11668 [*] OS Platform: 4.4.0-64-generic
INF/util:doctor 11668 [*] Using Node 7.6.0
INF/util:doctor 11668 [*] Using RethinkDB client 2.3.3
INF/util:doctor 11668 [*] Using ZeroMQ 4.1.5
INF/util:doctor 11668 [*] Local ADB 1.0.32

INF/util:doctor 11668 [*] ProtoBuf 2.6.1
INF/util:doctor 11668 [*] GraphicsMagick 1.3.23
INF/util:doctor 11668 [*] Local RethinkDB server 2.3.5~0xenial
/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 2.3.5~0xenial
    at new SemVer (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/semver/semver.js:293:11)
    at Range.test (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/home/mat/myfolder/project/STF/1stfTest/stf-master/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/home/mat/myfolder/project/STF/1stfTest/stf-master/lib/util/doctor.js:13:15)
    at /home/mat/myfolder/project/STF/1stfTest/stf-master/lib/util/doctor.js:95:7
    at /home/mat/myfolder/project/STF/1stfTest/stf-master/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:202:7)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:192:7)
    at maybeClose (internal/child_process.js:890:16)
    at Socket.<anonymous> (internal/child_process.js:334:11)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:189:7)
    at Pipe._handle.close [as _onclose] (net.js:501:12)`

I am very sorry for my poor english.
I really hope to get your help.
Thank you very much Thank you very much for your quick reply.
There is also a problem, some phones open camera, the STF screen is black, turn off the camera, the STF screen is normal, what might be the reason?
About that three devices ,If you have time and would like to study and solve the problem, I will donate and express the parcel to you,as long as you give me the address.
Thank you very much for your open source spirit, to the vast number of programmers to bring a lot of Gospel  I've made some serious strides in my understanding of docker but I am having one last problem with the final connection. 

uname -a 
`Linux odroidxu4 4.9.11-odroidxu4 #12 SMP PREEMPT Thu Feb 23 22:10:22 CET 2017 armv7l GNU/Linux`

docker run openstf/stf-armv7l stf doctor
```
INF/util:doctor 1 [*] OS Arch: arm
INF/util:doctor 1 [*] OS Platform: linux
INF/util:doctor 1 [*] OS Platform: 4.9.11-odroidxu4
INF/util:doctor 1 [*] Using Node 6.9.1
INF/util:doctor 1 [*] Using RethinkDB client 2.3.3
INF/util:doctor 1 [*] Using ZeroMQ 4.1.4
WRN/util:doctor 1 [*] Executable was not found
WRN/util:doctor 1 [*] Executable was not found
INF/util:doctor 1 [*] GraphicsMagick 1.3.25
INF/util:doctor 1 [*] ProtoBuf 2.6.1
```

rethinkdb --bind all
```
root@odroidxu4:~# rethinkdb --bind all
Running rethinkdb 2.3.0 (GCC 4.9.2)...
Running on Linux 4.9.11-odroidxu4 armv7l
Loading data from directory /root/rethinkdb_data
Listening for intracluster connections on port 29015
Listening for client driver connections on port 28015
Listening for administrative HTTP connections on port 8080
Listening on cluster addresses: 127.0.0.1, 172.17.42.1, 192.168.0.8, ::1, 2601:602:8500:31b0::6, 2601:602:8500:31b0:7edd:90ff:fead:6a3a, fe80::5484:7aff:fefe:9799%4, fe80::7edd:90ff:fead:6a3a%3
Listening on driver addresses: 127.0.0.1, 172.17.42.1, 192.168.0.8, ::1, 2601:602:8500:31b0::6, 2601:602:8500:31b0:7edd:90ff:fead:6a3a, fe80::5484:7aff:fefe:9799%4, fe80::7edd:90ff:fead:6a3a%3
Listening on http addresses: 127.0.0.1, 172.17.42.1, 192.168.0.8, ::1, 2601:602:8500:31b0::6, 2601:602:8500:31b0:7edd:90ff:fead:6a3a, fe80::5484:7aff:fefe:9799%4, fe80::7edd:90ff:fead:6a3a%3
Server ready, "odroidxu4_j4s" 3d65cd30-5265-4078-a388-4490db6ce35b
```

docker run openstf/stf-armv7l stf local --public-ip 192.168.0.8:7100
```INF/triproxy 17 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 17 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 17 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/triproxy 18 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 18 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 18 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/reaper 21 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 21 [reaper001] Reaping devices with no heartbeat
INF/db 21 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 21 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 21 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/db 21 [reaper001] Unable to connect to 127.0.0.1:28015
FTL/db 21 [reaper001] No hosts left to try
FTL/util:lifecycle 21 [reaper001] Shutting down due to fatal error
FTL/cli:local 1 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/app/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 1 [*] Shutting down all child processes
INF/util:lifecycle 17 [app001] Winding down for graceful exit
INF/util:lifecycle 18 [dev001] Winding down for graceful exit
```

Now it says it's unable to connect to `127.0.0.1:28015` but rethink says its listening on `port 28015`

Am I missing something? 

I've been reading other issues that have "no hosts left to try" and it's usually because rethink isn't running - but I can actually connect to it using a separate computer and `http://192.168.0.8:8080 `. So it would appear (at least to me), that it is up and working.

Also thank you for being around and answering questions, I know you must have better things to do than to help someone with their odroid testing cluster. 
 

  I now need to secondary development of STF, see the source code and found that the front-end procedures using Webpack package. Would like to ask you, in the project how to make their own changes in the JS source code effective? Ok, thanks, it seems that you are using the Webpack & Glup mode, to achieve on-demand loading and modular. Yes, I will always be concerned about this project. Wish good ~ @sorccu   I have an idea, that maybe the user can listen the audio inside the phone maybe awesome.
So, did you have tried this? http://stackoverflow.com/questions/15125139/android-get-device-overall-audio-output-in-pcm

I have tried this method, but the audio's quality is too low, can't heard clearly. Perhaps the native lib corresponds to the java be better. you might feed the device audio via host-PC's mic.

I believe there is a node to capture mic audio and stream it to the client browser.  stf local 

error  information

INF/util:procutil 28322 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/6.10.0/linux/x64/zmq.node
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.require (module.js:497:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.require (module.js:497:17)
FTL/cli:local 28322 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 28322 [*] Shutting down all child processes
 try npm install zmq again  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
screen capture and apk drag install FAIL
NOTE: I just restarted all services, so it seems it pulled the latest images and issues came out.  Before that, STF has been running for quite a long time (2-3 months) without above issues.  So, I'm not sure if it's caused by any upgrade? 
PS. I didn't change anything (.service files), just stop all services then start them.

Please help troubleshooting what the problem could be.  Thank you so much!

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
ALL devices

**Please provide the steps to reproduce the issue.**
use one device, click screenshot button, or drag an apk to install

**What is the expected behavior?**
screen capture/apk drag install PASS

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
It's in production env, with docker deployment. logs as below
```
IMP/device:plugins:connect 27 [7N2RDQ1472011083] Remote Connect Started for device "7N2RDQ1472011083" at "10.241.54.16:15013"
INF/device:plugins:screen:capture 27 [7N2RDQ1472011083] Capturing screenshot
ERR/device:support:storage 27 [7N2RDQ1472011083] Upload to "http://10.241.54.16/s/upload/image" failed: HTTP 502
ERR/device:plugins:screen:capture 27 [7N2RDQ1472011083] Screen capture failed Error: Upload to "http://10.241.54.16/s/upload/image" failed: HTTP 502
    at Request._callback (/app/lib/units/device/support/storage.js:29:27)
    at Request.self.callback (/app/node_modules/request/request.js:186:22)
    at emitTwo (events.js:106:13)
    at Request.emit (events.js:191:7)
    at Request.<anonymous> (/app/node_modules/request/request.js:1081:10)
    at emitOne (events.js:96:13)
    at Request.emit (events.js:188:7)
    at IncomingMessage.<anonymous> (/app/node_modules/request/request.js:1001:12)
    at IncomingMessage.g (events.js:291:16)
    at emitNone (events.js:91:20)
    at IncomingMessage.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:974:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
```

**Please run `stf doctor` and paste the output here.**
 Thank you so much, @vbanthia !!
My problem is EXACTLY same as what you pointed out, after granting write permission of the directory, it works perfect now.  aaron@STF:/usr/local/lib/node_modules/stf$ stf local
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 3056 [*] Connecting to 127.0.0.1:28015
INF/db:setup 3056 [*] Database "stf" already exists
INF/db:setup 3056 [*] Table "users" already exists
INF/db:setup 3056 [*] Table "accessTokens" already exists
INF/db:setup 3056 [*] Table "vncauth" already exists
INF/db:setup 3056 [*] Table "devices" already exists
INF/db:setup 3056 [*] Table "logs" already exists
INF/db:setup 3056 [*] Table "reservation" already exists
INF/db:setup 3056 [*] Table "useInfor" already exists
INF/db:setup 3056 [*] Index "users"."adbKeys" already exists
INF/db:setup 3056 [*] Waiting for index "users"."adbKeys"
INF/db:setup 3056 [*] Index "accessTokens"."email" already exists
INF/db:setup 3056 [*] Index "vncauth"."response" already exists
INF/db:setup 3056 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 3056 [*] Index "devices"."owner" already exists
INF/db:setup 3056 [*] Index "devices"."present" already exists
INF/db:setup 3056 [*] Index "devices"."providerChannel" already exists
INF/db:setup 3056 [*] Index "reservation"."userEmail" already exists
INF/db:setup 3056 [*] Index "reservation"."status" already exists
INF/db:setup 3056 [*] Index "reservation"."loginName" already exists
INF/db:setup 3056 [*] Index "reservation"."userGroup" already exists
INF/db:setup 3056 [*] Index "reservation"."manufacturer" already exists
INF/db:setup 3056 [*] Index "reservation"."model" already exists
INF/db:setup 3056 [*] Waiting for index "accessTokens"."email"
INF/db:setup 3056 [*] Waiting for index "vncauth"."response"
INF/db:setup 3056 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 3056 [*] Waiting for index "devices"."owner"
INF/db:setup 3056 [*] Waiting for index "devices"."present"
INF/db:setup 3056 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 3056 [*] Waiting for index "reservation"."userEmail"
INF/db:setup 3056 [*] Waiting for index "reservation"."status"
INF/db:setup 3056 [*] Waiting for index "reservation"."loginName"
INF/db:setup 3056 [*] Waiting for index "reservation"."userGroup"
INF/db:setup 3056 [*] Waiting for index "reservation"."manufacturer"
INF/db:setup 3056 [*] Waiting for index "reservation"."model"
INF/db:setup 3056 [*] Index "users"."adbKeys" is ready
INF/db:setup 3056 [*] Index "accessTokens"."email" is ready
INF/db:setup 3056 [*] Index "devices"."owner" is ready
INF/db:setup 3056 [*] Index "devices"."present" is ready
INF/db:setup 3056 [*] Index "devices"."providerChannel" is ready
INF/db:setup 3056 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 3056 [*] Index "vncauth"."response" is ready
INF/db:setup 3056 [*] Index "reservation"."userEmail" is ready
INF/db:setup 3056 [*] Index "reservation"."status" is ready
INF/db:setup 3056 [*] Index "reservation"."loginName" is ready
INF/db:setup 3056 [*] Index "reservation"."userGroup" is ready
INF/db:setup 3056 [*] Index "reservation"."manufacturer" is ready
INF/db:setup 3056 [*] Index "reservation"."model" is ready
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js provider --name STF --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-temp --port 7102"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 3050 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
INF/triproxy 3063 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 3062 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 3063 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 3063 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/triproxy 3062 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 3062 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/reaper 3066 [reaper001] Subscribing to permanent channel "*ALL"
INF/reaper 3066 [reaper001] Reaping devices with no heartbeat
INF/db 3066 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 3066 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 3066 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/db 3064 [proc001] Connecting to 127.0.0.1:28015
INF/processor 3064 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 3064 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/db 3065 [proc002] Connecting to 127.0.0.1:28015
INF/processor 3065 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 3065 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/provider 3067 [*] Subscribing to permanent channel "q1Y6AOjySmCd7iMwHdqO2g=="
INF/provider 3067 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 3067 [*] Receiving input from "tcp://127.0.0.1:7114"
INF/poorxy 3074 [*] Listening on port 7100
INF/provider 3067 [*] Tracking devices
INF/storage:plugins:image 3072 [*] Listening on port 7103
INF/auth-mock 3068 [*] Listening on port 7120
INF/storage:temp 3071 [*] Listening on port 7102
INF/storage:plugins:apk 3073 [*] Listening on port 7104
INF/websocket 3070 [*] Subscribing to permanent channel "*ALL"
INF/websocket 3070 [*] Listening on port 7110
INF/db 3070 [*] Connecting to 127.0.0.1:28015
INF/websocket 3070 [*] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 3070 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/app 3069 [*] Using pre-built resources
INF/app 3069 [*] Listening on port 7105
INF/db 3069 [*] Connecting to 127.0.0.1:28015
login submit:hehm4
ITCode Interface Data:
{ expand: 'attributes',
  link: 
   { href: 'http://itcode.lefile.cn/crowd/rest/usermanagement/latest/user?username=hehm4',
     rel: 'self' },
  name: 'hehm4',
  password: 
   { link: 
      { href: 'http://itcode.lefile.cn/crowd/rest/usermanagement/latest/user/password?username=hehm4',
        rel: 'edit' } },
  key: '1409027:a9f475ef29547d46a1580edda718fd2f',
  active: true,
  attributes: 
   { attributes: [],
     link: 
      { href: 'http://itcode.lefile.cn/crowd/rest/usermanagement/latest/user/attribute?username=hehm4',
        rel: 'self' } },
  'first-name': 'HongMei',
  'last-name': 'He',
  'display-name': 'Hongmei HM4 He',
  email: 'hehm4@lenovo.com' }
eyJhbGciOiJIUzI1NiIsImV4cCI6MTQ4NzgxNzM0MDk3MH0.eyJlbWFpbCI6ImhlaG00QGxlbm92by5jb20iLCJuYW1lIjoiaGVobTQifQ.WGXalocn1RaiqWs1H1pPXOKdwiFFV1QBlZ-Qsvjmt1I
INF/util:datautil 3069 [*] Device database does not have an entry for "255f5068" (model "undefined"/"undefined"). This is not an error, it only means that we don't have data for it yet.
 Seems his ZUK Z1 device not works fine.

Referes to #436  OK , Let me see，Thanks a lot!



zhule117@163.com
 
发件人： WillPang
发送时间： 2017-02-23 16:15
收件人： openstf/stf
抄送： hehm4; Author
主题： Re: [openstf/stf] 求大神赐教，zuk z1的机子，Thanks！！！ (#547)
Seems his ZUK Z1 device not works fine.
Referes to #436
—
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub, or mute the thread.
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

In labs, I have a full deployment configuration with one machine hosting a STF server and another machine hosting a STF provider, clients and STF machines share the same network without firewall and all work fine !

Nevertheless, in my target deployment all these machines will not be in the same place, and it seems to be sure that a VPN connection will be required between the STF server and the STF provider. In such assumption, even if this VPN connection works well, clients will no be able to reach the provider to remote debug the phones, except if they are part of this VPN, isn't it ? Do you have experimented such architecture or do you have some recommendations about that ?

So, to progress in labs I established a simple VPN connection between the STF server and the STF provider machines, like this:
```
(provider: vpn server) # openvpn --dev tun1 --ifconfig 10.4.0.1 10.4.0.2
(server: vpn client)   # openvpn --remote @provider --dev tun1 --ifconfig 10.4.0.2 10.4.0.1
```
After what, I started the STF server and the STF provider services using the previous tunneling information, all work well through the GUI
- file explorer
- shell
- app upload
- remote debug url (ex: adb connect 10.4.0.1:15009 run from the STF server of course)
- ...

EXCEPT the phone screen appears as blank, so it is impossible to interact with the phone through its screen !

When I click on the "Use" button for a device, I don't see any network traffic on the VPN except the traffic on the ports 7250 and 7270

Here is an extract of the relating nginx configuration:
```
    location ~ "^/d/10.4.0.1/([^/]+)/(?<port>[0-9]{5})/$" {
      proxy_pass http://10.4.0.1:$port/;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_set_header X-Forwarded-For $remote_addr;
      proxy_set_header X-Real-IP $remote_addr;
    }
```

And the web console in Chrome:

<img width="1164" alt="capture d ecran 2017-02-22 a 14 53 27" src="https://cloud.githubusercontent.com/assets/22766602/23214396/d838cde0-f90e-11e6-987f-d12db00fcdc6.png">





 I found a work around but I don't know if it is the correct solution : at STF provider side I changed the "screen-ws-url-pattern" parameter value in the corresponding systemd configuration file, replacing the VPN IP address of the STF server by its public IP address, and all work fine now !

But is it a correct solution ?  I tried instead at STF server side to modify the nginx configuration file doing the opposite modification, that is replacing the public IP address by the VPN one at websocket section, but it does not work !
 Is it possible to have an answer to my intial question : knowing that in fulll deployment architecture a client has an ADB direct access to the STF provider, and with the assumption that a VPN is required between the STF server and the STF provider, and so between the client and the STF provider for ADB traffic, do you have some recommendations about network configuration to deploy ?
Thanks. Yes I imagined to do that work, thank you very much to confirm that :-) Regarding the work around I used to get screen displayed through a VPN, that is specifying at provider side the public IP address of the server into the "screen-ws-url-pattern" parameter, I made a network trace and it seems the provider never establishes a connection to the server using this public IP address, so I suppose the "screen-ws-url-pattern" information is transmitted to the server through the VPN to be processed at server side, may you confirm that to me please ? 

If it is well the case so it is satisfactory for me because the VPN principle would be not violated by a websocket flow which would bypass the VPN.

Nevertheless, don't you think it would be more logical to specify into the "screen-ws-url-pattern" parameter only the IP addresses of the interfaces used by the provider and the server to communicate ?
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

When I try to launch a STF local server on a listening port < 1024 (ex: 80) instead the default 7100 one, an error occurs, seel the below log.

Is it an error or simply a limitation ?

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
févr. 22 10:11:00 debian docker[5944]: INF/util:procutil 1 [*] Forking "/app/lib/cli poorxy --port 80 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
févr. 22 10:11:03 debian docker[5944]: INF/triproxy 17 [dev001] PUB socket bound on tcp://127.0.0.1:7114
févr. 22 10:11:03 debian docker[5944]: INF/triproxy 16 [app001] PUB socket bound on tcp://127.0.0.1:7111
févr. 22 10:11:03 debian docker[5944]: INF/triproxy 17 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
févr. 22 10:11:03 debian docker[5944]: INF/triproxy 16 [app001] DEALER socket bound on tcp://127.0.0.1:7112
févr. 22 10:11:03 debian docker[5944]: INF/triproxy 17 [dev001] PULL socket bound on tcp://127.0.0.1:7116
févr. 22 10:11:03 debian docker[5944]: INF/triproxy 16 [app001] PULL socket bound on tcp://127.0.0.1:7113
févr. 22 10:11:04 debian docker[5944]: INF/poorxy 84 [*] Listening on port 80
févr. 22 10:11:04 debian docker[5944]: events.js:160
févr. 22 10:11:04 debian docker[5944]: throw er; // Unhandled 'error' event
févr. 22 10:11:04 debian docker[5944]: ^
févr. 22 10:11:04 debian docker[5944]: Error: listen EACCES 0.0.0.0:80
févr. 22 10:11:04 debian docker[5944]: at Object.exports._errnoException (util.js:1026:11)
févr. 22 10:11:04 debian docker[5944]: at exports._exceptionWithHostPort (util.js:1049:20)
févr. 22 10:11:04 debian docker[5944]: at Server._listen2 (net.js:1244:19)
févr. 22 10:11:04 debian docker[5944]: at listen (net.js:1293:10)
févr. 22 10:11:04 debian docker[5944]: at Server.listen (net.js:1389:5)
févr. 22 10:11:04 debian docker[5944]: at module.exports (/app/lib/units/poorxy/index.js:67:10)
févr. 22 10:11:04 debian docker[5944]: at Object.module.exports.handler (/app/lib/cli/poorxy/index.js:60:39)
févr. 22 10:11:04 debian docker[5944]: at Object.self.runCommand (/app/node_modules/yargs/lib/command.js:170:22)
févr. 22 10:11:04 debian docker[5944]: at parseArgs (/app/node_modules/yargs/yargs.js:920:28)
févr. 22 10:11:04 debian docker[5944]: at Object.get [as argv] (/app/node_modules/yargs/yargs.js:860:16)
févr. 22 10:11:04 debian docker[5944]: at Object.<anonymous> (/app/lib/cli/index.js:40:3)
févr. 22 10:11:04 debian docker[5944]: at Module._compile (module.js:570:32)
févr. 22 10:11:04 debian docker[5944]: at Object.Module._extensions..js (module.js:579:10)
févr. 22 10:11:04 debian docker[5944]: at Module.load (module.js:487:32)
févr. 22 10:11:04 debian docker[5944]: at tryModuleLoad (module.js:446:12)
févr. 22 10:11:04 debian docker[5944]: at Function.Module._load (module.js:438:3)
févr. 22 10:11:04 debian docker[5944]: FTL/cli:local 1 [*] Child process had an error ExitError: Exit code "1"
févr. 22 10:11:04 debian docker[5944]: at ChildProcess.<anonymous> (/app/lib/util/procutil.js:49:23)
févr. 22 10:11:04 debian docker[5944]: at emitTwo (events.js:106:13)
févr. 22 10:11:04 debian docker[5944]: at ChildProcess.emit (events.js:191:7)
févr. 22 10:11:04 debian docker[5944]: at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
févr. 22 10:11:04 debian docker[5944]: INF/cli:local 1 [*] Shutting down all child processes
févr. 22 10:11:04 debian docker[5944]: INF/util:lifecycle 16 [app001] Winding down for graceful exit
févr. 22 10:11:04 debian docker[5944]: INF/util:lifecycle 17 [dev001] Winding down for graceful exit
 port mapping does not work because I use the "--net host" parameter in the docker run command, is there another way (i.e. except the full deployment) ? it works fine, thank you very much !  Don't know how the password is getting displayed whenever we access some devices. If we access browser it comes in url section. This looks like _adb shell input text <password>._ 

Please find the video in pptx. 
[ldap_video_Presentation.pptx](https://github.com/openstf/stf/files/782375/ldap_video_Presentation.pptx)

We have cluster setup and inside auth service we kept the LDAP user password same get's displayed to user who use the device. Please need a solution for this.

Steps to reproduce : 
1. click on device 
2. launch with browser and type the password 



![ldap_password_discovers](https://cloud.githubusercontent.com/assets/17309586/23053305/6d8a1bf0-f4a6-11e6-860a-33bb8a187906.png)
 Is there any way to stop this as it only reads the value from password field? I am using my credential for LDAP auth and same using for login in stf :) @tadesushilgithub What browser are you using?

We might just add an `autocomplete="off"` to the input field [here](https://github.com/openstf/stf/blob/master/res/app/components/stf/screen/screen.pug#L16)

However it looks like new Chrome versions are ignoring it, so we will need to do cross-browser testing before doing it. Unfortunately its one of those places that its not possible to do automated testing.
http://stackoverflow.com/questions/15738259/disabling-chrome-autofill Thanks @gunta I am using Mozilla Firefox 51.0.1.  The Firefox password autofill can be incredibly aggressive, filling in any `<input type="password">` in the page, and even filling the preceding field (if there is one) with your username.  One workaround may be to insert the field with `type="text"` and then (almost immediately) change the type to `password` in JS, though I'm not sure how that would affect the cross-browser and non-Latin issues referred to above.  It might be worth testing, though, if you haven't yet found a better solution for this issue. Issue confirmed on Google Chrome 63.0.3239.84.

Apart from the autocomplete popup being really annoying, the fact that the password autocomplete inserts a saved password to the application with on wrong click is a serious problem for me.

As we use STF on a company domain, all the other company system's login details are offered. Using a password field for this is a very bad idea, but if you must, `autocomplete="new-password"` is how you can turn it off on newer browsers: https://developer.mozilla.org/en-US/docs/Web/Security/Securing_your_site/Turning_off_form_autocompletion#The_autocomplete_attribute_and_login_fields So when you focus a password field, the browser automatically switches to a latin keyboard layout for you.
This is a convenient feature, sure. But if you want to type a comment in English right here, you have to switch to a latin layout, no? Why can't you do the same in STF?
IMHO not having our passwords exposed like that is more important than automatically switching to a latin keyboard if someone happens to be using an IME. We fixed this by monkeypatching stf's js code on startup:

Put this into the systemd config of stf-app
```
ExecStartPost=/usr/local/bin/stfinputhack.sh %p-%i
```

And save this as /usr/local/bin/stfinputhack:

```
#!/bin/sh
sleep 10
/usr/bin/docker exec --user 0 "$1" sh -c 'cd /app/res/build && for file in *.js; do perl -pi -e "s|type=\\\\\"password\\\\\"([^>]*?)(\\\$root\.screenFocus\\\\\")|type=\\\\\"text\\\\\"\1\2|" "$file";done'
```

I also tried type="tel", type="url" and type="email", but none of those autoswitched like type="password". So I'm sorry, but the perfect solution you're looking for doesn't seem to exist, at least not in browsers that don't support ime-mode. `new-password` might also be problematic because the browser might show some ui to generate a new password, or it might save the new password into its password manager.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
If I build stf locally after cloning from github, I cannot connect devices, the following error keeps appearing upon device connect and the stf is not available via browser:

INF/device:resources:minicap 8632 [WUJ01J5TB9] Installing "minicap.so" as "/data/local/tmp/minicap.so"
   (here comes the funny part)
FTL/device 8632 [WUJ01J5TB9] Setup had an error TypeError: Cannot read property 'S_IXUSR' of undefined
    at /var/www/openstf/lib/units/device/resources/minicap.js:91:46
    at processImmediate [as _immediateCallback] (timers.js:383:17)
FTL/util:lifecycle 8632 [WUJ01J5TB9] Shutting down due to fatal error

If I install openstf as a global npm module, it works like a charm - but with local instance, no luck. I've seen some minicap-related issues, but not like this typeerror: cannot read property... so I opened a new issue ticket. 

**Does it only happen on a specific device? Please run adb devices -l and paste the corresponding row.**
I've tried with Sony, Samsung and HTC (Android 4.2, 5.0) as well as different linuxes (ubuntu 14,16, x32-x64, mint, debian), same results. 

Output of adb devices -l is:
List of devices attached
WUJ01J5TB9             device usb:1-2 product:E2105 model:E2105 device:E2105

**Please provide the steps to reproduce the issue.**
apt-get install yasm libzmq3-dbg libzmq3-dev libzmq3 rethinkdb (obviously if a library was missing from ubuntu repos I installed them manually)
(npm install -g stf --unsafe-perm --verbose)
cd /var/www/
git clone https://github.com/openstf/stf.git openstf
cd openstf
npm install -g bower
npm install
bower install --allow-root
rethinkdb
stf local
 + as long as devices are not connected, everything works fine. When I connect a device (either before or after launching stf) the errors start appearing.

**What is the expected behavior?**
No minicap-errors to show up and to be able to load stf device page and connect actually even with my local build, not only as an npm global package

**Do you see errors or warnings in the stf local output? If so, please paste them or the full log here.**
More of the code:
INF/middleware:webpack 8407 [*] Bundle is now valid
INF/webpack:config 8407 [*] Build progress 100% (complete)
INF/device:support:push 8632 [WUJ01J5TB9] Sending output to "tcp://127.0.0.1:7116"
INF/device 8632 [WUJ01J5TB9] Preparing device
INF/device:support:sub 8632 [WUJ01J5TB9] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 8632 [WUJ01J5TB9] Subscribing to permanent channel "*ALL"
INF/device:support:properties 8632 [WUJ01J5TB9] Loading properties
INF/device:support:abi 8632 [WUJ01J5TB9] Supports ABIs armeabi-v7a, armeabi
INF/provider 8397 [*] Providing 0 of 1 device(s); waiting for "WUJ01J5TB9"
INF/device:resources:minicap 8632 [WUJ01J5TB9] Installing "minicap" as "/data/local/tmp/minicap"
INF/device:resources:minicap 8632 [WUJ01J5TB9] Installing "minicap.so" as "/data/local/tmp/minicap.so"
   (here comes the funny part)
FTL/device 8632 [WUJ01J5TB9] Setup had an error TypeError: Cannot read property 'S_IXUSR' of undefined
    at /var/www/openstf/lib/units/device/resources/minicap.js:91:46
    at processImmediate [as _immediateCallback] (timers.js:383:17)
FTL/util:lifecycle 8632 [WUJ01J5TB9] Shutting down due to fatal error
INF/provider 8397 [*] Cleaning up device worker "WUJ01J5TB9"
ERR/provider 8397 [*] Device worker "WUJ01J5TB9" died with code 1
INF/provider 8397 [*] Restarting device worker "WUJ01J5TB9"

**Please run stf doctor and paste the output here.**
INF/util:doctor 3561 [*] OS Arch: x64
INF/util:doctor 3561 [*] OS Platform: linux
INF/util:doctor 3561 [*] OS Platform: 4.4.0-31-generic
INF/util:doctor 3561 [*] Using Node 4.2.6
INF/util:doctor 3561 [*] Using RethinkDB client 2.3.3
INF/util:doctor 3561 [*] Using ZeroMQ 4.1.4
WRN/util:doctor 3561 [*] Executable was not found
WRN/util:doctor 3561 [*] Executable was not found
INF/util:doctor 3561 [*] Local ADB 1.0.32

INF/util:doctor 3561 [*] Local RethinkDB server 2.3.5~0xenial
/var/www/openstf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 2.3.5~0xenial
    at new SemVer (/var/www/openstf/node_modules/semver/semver.js:293:11)
    at Range.test (/var/www/openstf/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/var/www/openstf/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/var/www/openstf/lib/util/doctor.js:13:15)
    at /var/www/openstf/lib/util/doctor.js:95:7
    at /var/www/openstf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:204:7)
    at emitTwo (events.js:87:13)
    at ChildProcess.emit (events.js:172:7)
    at maybeClose (internal/child_process.js:821:16)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:211:5)
 what a silly mistake i did not notice.. thanks for your help. good job guys  I used the adbkit as a adb proxy. But I came with a problem when I am debugging a app. 
![screenshot_2017-02-14-16-27-00](https://cloud.githubusercontent.com/assets/12730220/22920988/cc80d250-f2d2-11e6-99c8-6f1bb16f115d.png)

It not happened every time.


 The ide is android studio 2.2.3. The eclipse does not have this problem. I am confused.  This PR adds ability to specify domain of authorized email addresses.
If option is not set then behavior is not changed and any (excluding missing) email address is authorized.

In case of not authorized domain (including missing email address) simple error message is shown.

This theoretically also fixes bug with infinite redirect loop in case of missing email address in response from OAuth provider. At least with Google, unconditional redirect to `/auth/oauth/` used to cause such loop, not sure if email can be missing despite `email` scope is requested and if infinite loop was also applicable to other providers.  Hello, I have a phone with a broken touchscreen, to the point where the driver doesn't recognize it, so minitouch doesn't have anything to use.

The device is a Xiaomi Redmi 2. Is there a way to go around that?

```
INF/device:plugins:touch 7220 [33dcccfe] Connecting to minitouch service
INF/device:plugins:touch 7220 [33dcccfe] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 7220 [33dcccfe] minitouch says: "Unable to find a suitable touch device"
``` Would this: https://github.com/vi/virtual_touchscreen work?

On Sun, Feb 12, 2017, 03:34 Simo Kinnunen <notifications@github.com> wrote:

> Currently no, but if you need to access the device (perhaps to get
> something out of it), you can use an OTG adapter and an actual mouse. Or
> perhaps the 'input' command from adb.
> On Sun, Feb 12, 2017 at 8:04 Tomáš Martykán <notifications@github.com>
> wrote:
>
> > Hello, I have a phone with a broken touchscreen, to the point where the
> > driver doesn't recognize it, so minitouch doesn't have anything to use.
> >
> > The device is a Xiaomi Redmi 2. Is there a way to go around that?
> >
> > INF/device:plugins:touch 7220 [33dcccfe] Connecting to minitouch service
> > INF/device:plugins:touch 7220 [33dcccfe] minitouch says: "Note: device
> /dev/input/mice is not supported by libevdev"
> > INF/device:plugins:touch 7220 [33dcccfe] minitouch says: "Unable to find
> a suitable touch device"
> >
> > —
> > You are receiving this because you are subscribed to this thread.
> > Reply to this email directly, view it on GitHub
> > <https://github.com/openstf/stf/issues/537>, or mute the thread
> > <
> https://github.com/notifications/unsubscribe-auth/AAB-_dlhPbt5Jo1pJzZl45B6We4H-ZYgks5rbj6UgaJpZM4L-VAJ
> >
> > .
> >
>
> —
> You are receiving this because you authored the thread.
> Reply to this email directly, view it on GitHub
> <https://github.com/openstf/stf/issues/537#issuecomment-279192041>, or mute
> the thread
> <https://github.com/notifications/unsubscribe-auth/AIbLFSqbNmLWsFuukebOeXxqJZlOFm6lks5rbm-7gaJpZM4L-VAJ>
> .
>
  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
Error in connecting stf remotely.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
SHXXXXXXX    device usb:336592896X product:htc_europe model:HTC_One_M8 device:htc_m8

**Please provide the steps to reproduce the issue.**
Run stf remotely ,
stf local --public-ip <your_internal_network_ip_here>
i.e. (stf local remoteIP localIP)


**What is the expected behavior?**
Should connect to remote address 
https://X.X.X.X:7100

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
skumar$ **stf local 10.1.X.X 10.1.X.X**
INF/util:procutil 64270 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 64271 [*] Connecting to 127.0.0.1:28015
INF/db 64271 [*] Unable to connect to 127.0.0.1:28015
FTL/db 64271 [*] No hosts left to try
FTL/util:lifecycle 64271 [*] Shutting down due to fatal error

/usr/local/lib/node_modules/stf/node_modules/bluebird/js/main/promise.js:680
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:204:12)

**Please run `stf doctor` and paste the output here.**
INF/util:doctor 64478 [*] OS Arch: x64
INF/util:doctor 64478 [*] OS Platform: darwin
INF/util:doctor 64478 [*] OS Platform: 15.6.0
INF/util:doctor 64478 [*] Using Node 6.3.1
INF/util:doctor 64478 [*] Using RethinkDB client 2.3.3
INF/util:doctor 64478 [*] Using ZeroMQ 4.2.1
INF/util:doctor 64478 [*] GraphicsMagick 1.3.25
INF/util:doctor 64478 [*] Local ADB 1.0.36

INF/util:doctor 64478 [*] ProtoBuf 3.2.0
ERR/util:doctor 64478 [*] Current ProtoBuf version is not supported, it has to be ~2
INF/util:doctor 64478 [*] Local RethinkDB server 2.3.5

 @vbanthia 

Perfect mate.
Spot on working now.

Do you know can we run appium Automation scripts on this devices ?

 Hello @vbanthia
effectively the example that you show us is perfect.

My question is I can send the execution from another computer that is in the same network, when I launch the command DEVICE_SERIAL = XXXXXX ./scripts/run_integration_test.sh, I'm doing it from a windows and the STF I have it in a MAC  **DB is not initialized when running stf local first time**

> FTL/reaper 12089 [reaper001] Unable to load initial state { ReqlOpFailedError: Database `stf` does not exist in:
> r.table("devices").getAll(true, {"index": "present"})
> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>     at ReqlOpFailedError.ReqlError [as constructor] (/stf/node_modules/rethinkdb/errors.js:23:13)
>     at ReqlOpFailedError.ReqlRuntimeError [as constructor] (/stf/node_modules/rethinkdb/errors.js:90:51)
>     at ReqlOpFailedError.ReqlAvailabilityError [as constructor] (/stf/node_modules/rethinkdb/errors.js:167:56)
>     at new ReqlOpFailedError (/stf/node_modules/rethinkdb/errors.js:178:52)
>     at mkErr (/stf/node_modules/rethinkdb/util.js:177:10)
>     at TcpConnection.Connection._processResponse (/stf/node_modules/rethinkdb/net.js:152:16)
>     at TcpConnection.Connection._data (/stf/node_modules/rethinkdb/net.js:122:12)
>     at Socket.<anonymous> (/stf/node_modules/rethinkdb/net.js:683:32)
>     at emitOne (events.js:96:13)
>     at Socket.emit (events.js:188:7)
>     at readableAddChunk (_stream_readable.js:176:18)
>     at Socket.Readable.push (_stream_readable.js:134:10)
>     at TCP.onread (net.js:548:20)
> From previous event:
>     at GetAll.TermBase.run (/stf/node_modules/rethinkdb/ast.js:135:12)
>     at /stf/lib/db/index.js:129:14
>     at runCallback (timers.js:637:20)
>     at tryOnImmediate (timers.js:610:5)
>     at processImmediate [as _immediateCallback] (timers.js:582:5)
> From previous event:
>     at db.run (/stf/lib/db/index.js:128:23)
>     at dbapi.loadPresentDevices (/stf/lib/db/api.js:401:13)
>     at loadInitialState (/stf/lib/units/reaper/index.js:83:18)
>     at module.exports (/stf/lib/units/reaper/index.js:125:3)
>     at Object.module.exports.handler (/stf/lib/cli/reaper/index.js:42:39)
>     at Object.self.runCommand (/stf/node_modules/yargs/lib/command.js:170:22)
>     at parseArgs (/stf/node_modules/yargs/yargs.js:920:28)
>     at Object.get [as argv] (/stf/node_modules/yargs/yargs.js:860:16)
>     at Object.<anonymous> (/stf/lib/cli/index.js:40:3)
>     at Module._compile (module.js:570:32)
>     at Object.Module._extensions..js (module.js:579:10)
>     at Module.load (module.js:487:32)
>     at tryModuleLoad (module.js:446:12)
>     at Function.Module._load (module.js:438:3)
>     at Module.runMain (module.js:604:10)
>     at run (bootstrap_node.js:394:7)
>     at startup (bootstrap_node.js:149:9)
>     at bootstrap_node.js:509:3
>   name: 'ReqlOpFailedError',
>   msg: 'Database `stf` does not exist.',
>   frames: [],
>   message: 'Database `stf` does not exist in:\nr.table("devices").getAll(true, {"index": "present"})\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^' }
> FTL/util:lifecycle 12089 [reaper001] Shutting down due to fatal error
> FTL/cli:local 12083 [*] Child process had an error ExitError: Exit code "1"
>     at ChildProcess.<anonymous> (/stf/lib/util/procutil.js:49:23)
>     at emitTwo (events.js:106:13)
>     at ChildProcess.emit (events.js:191:7)
>     at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
> INF/cli:local 12083 [*] Shutting down all child processes


last line of lib/cli/local/index.js
```javascript
  return procutil.fork(__filename, ['migrate'])
    .done(run)
```
should be 
```javascript
return procutil.fork(path.resolve(__dirname, '..'), ['migrate']).done(run)
```  STF version - 2.3.0 (latest) - Docker
STF version - 2.0.1
Debian - Jessie

Deployment on single machine.

**What is the issue or idea you have?**
Hey,
EACH device will be ignored by provider service. 

```INF/provider 1 [*] Subscribing to permanent channel "NMTZ2IqATEWH19zK+hCkdQ=="
INF/provider 1 [*] Sending output to "tcp://qadevicefarm.de:7270"
INF/provider 1 [*] Receiving input from "tcp://qadevicefarm.de:7250"
INF/provider 1 [*] Tracking devices
INF/provider 1 [*] Found device "47900b6e9dd21100" (device)`
INF/provider 1 [*] Providing all 0 of 3 device(s); ignoring "47900b6e9dd21100", "47900b6e9dd21100", "47900b6e9dd21100"
```

No STFService.apk will be installed on the device.
The setup is almost the same like in the DEPLOYMENT description. The stf-triproxy-dev.service is running.

I also did the setup on another machine with the same result.

In front of the machine where STF is running, an apache is installed, which provides the host name and forwards https access. Therefor I had to adapt the nginx.conf to get rid of mixed content.

But now I'm at my wit's end.

Do I need to configure IPs in the services and let nginx handle all hostname related stuff?
Or do I also have to provide full hostname in the service files?

Thank you for your help.
Martin 

 Sorccu!! It is working now!! Changed the domain name to the correct IP.

Thank you for your support!!

(Due to privacy considerations I changed the original domain to a not working one) I have the same problem?? Where I change it the domain for ip??

Thanks  **What is the issue or idea you have?**
There are artifacts on screen preview like on attached picture.

**Does it only happen on a specific device?**
Yes. Samsung Galaxy SM-G350
`product:cs02xx model:SM_G350 device:cs02`

**Please provide the steps to reproduce the issue.**
Start using the device.

**What is the expected behavior?**
There is a clean preview visible.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
Not using local but docker containers, however here are the logs:
```
INF/util:datautil 1 [*] Device database does not have an entry for "42036070e2309100" (model "SM-G350"/"cs02xx"). This is not an error, it only means that we don't have data for it yet.
<stripped> - - [07/Feb/2017:21:50:39 +0000] "GET /api/v1/devices/42036070e2309100 HTTP/1.1" 200 1478 "https://stf.<stripped>/" "<stripped>"
<stripped> - - [07/Feb/2017:21:50:39 +0000] "GET /api/v1/user/devices HTTP/1.1" 304 0 "https://stf.<stripped>/" "<stripped>"
IMP/device:plugins:group 145 [42036070e2309100] Now owned by "<stripped>"
INF/device:plugins:group 145 [42036070e2309100] Subscribing to group channel "<stripped>"
INF/util:datautil 1 [*] Device database does not have an entry for "42036070e2309100" (model "SM-G350"/"cs02xx"). This is not an error, it only means that we don't have data for it yet.
<stripped> - - [07/Feb/2017:21:50:40 +0000] "GET /api/v1/devices/42036070e2309100 HTTP/1.1" 200 1588 "https://stf.<stripped>/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36"
INF/device:plugins:screen:stream 145 [42036070e2309100] Keeping 574x946 as current frame producer projection
INF/device:plugins:screen:stream 145 [42036070e2309100] Requesting frame producer to start
INF/device:plugins:screen:stream 145 [42036070e2309100] Launching screen service
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "PID: 14290"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: Using projection 480x800@480x800/0"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:239) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:242) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:249) Creating virtual display"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:255) Creating CPU consumer"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:261) Creating buffer queue"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:267) Creating frame waiter"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:271) Publishing virtual display"
INF/device:plugins:screen:stream 145 [42036070e2309100] Connecting to minicap service
IMP/device:plugins:connect 145 [42036070e2309100] Remote Connect Started for device "42036070e2309100" at "<stripped>:15045"
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 1154052 bytes for JPG encoder"
INF/device:plugins:screen:stream 145 [42036070e2309100] Reading minicap banner
INF/device:plugins:screen:stream 145 [42036070e2309100] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
```

**Please run `stf doctor` and paste the output here.**
```
$ docker exec -ti stf-app-3100 /bin/sh
$ stf doctor
INF/util:doctor 25 [*] OS Arch: x64
INF/util:doctor 25 [*] OS Platform: linux
INF/util:doctor 25 [*] OS Platform: 4.9.7-gentoo
INF/util:doctor 25 [*] Using Node 6.9.1
INF/util:doctor 25 [*] Using RethinkDB client 2.3.3
INF/util:doctor 25 [*] Using ZeroMQ 4.1.4
WRN/util:doctor 25 [*] Executable was not found
WRN/util:doctor 25 [*] Executable was not found
WRN/util:doctor 25 [*] Executable was not found
INF/util:doctor 25 [*] GraphicsMagick 1.3.23
```

![image](https://cloud.githubusercontent.com/assets/3340954/22713154/94ba3df2-ed87-11e6-9718-c6df1378ffdf.png)
  I only use a mobile phone and data cable connection is successful, the details of the phone can be seen, but not the projection image. What shall I do? Please help me, thank you.
![qq 20170206164633](https://cloud.githubusercontent.com/assets/16865038/22640234/b10a7a9a-ec8c-11e6-9634-e628bf3ae4a9.jpg)
 Firewall and anti-virus software are closed, the display is connected successfully, no error data. Connection is often interrupted, see other replies, is the reason for the MAC system?
![1](https://cloud.githubusercontent.com/assets/16865038/22641851/65f95326-ec93-11e6-9fed-299fcb81caee.png)
![2](https://cloud.githubusercontent.com/assets/16865038/22641869/77e86496-ec93-11e6-8cce-3028db5937fe.jpg)
![3](https://cloud.githubusercontent.com/assets/16865038/22641902/94898634-ec93-11e6-9b01-9d165a3d382e.png)


  Thanks  sorccu: I'm using a virtual machine, I don't find a solution to the document, WebSocket: the error is given 
![4](https://cloud.githubusercontent.com/assets/16865038/22675803/c57d5aec-ed22-11e6-9567-90b26674d3dc.jpg)
  * Version
```shell
[root@localhost ~]# npm install -g stf
npm WARN deprecated node-uuid@1.4.7: use uuid module instead
/mnt/data/node-v7.5.0/bin/stf -> /mnt/data/node-v7.5.0/lib/node_modules/stf/bin/stf
/mnt/data/node-v7.5.0/lib
└── stf@2.3.0 
```
* Error
```shell
[root@localhost bin]# stf local
path.js:1142
          cwd = process.cwd();
                        ^

Error: ENOENT: no such file or directory, uv_cwd
    at Object.resolve (path.js:1142:25)
    at Function.Module._resolveLookupPaths (module.js:391:17)
    at Function.Module._resolveFilename (module.js:461:31)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/mnt/data/node-v7.5.0/lib/node_modules/stf/bin/stf:2:1)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
[root@localhost bin]# 
[root@localhost bin]# stf doctor
path.js:1142
          cwd = process.cwd();
                        ^

Error: ENOENT: no such file or directory, uv_cwd
    at Object.resolve (path.js:1142:25)
    at Function.Module._resolveLookupPaths (module.js:391:17)
    at Function.Module._resolveFilename (module.js:461:31)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/mnt/data/node-v7.5.0/lib/node_modules/stf/bin/stf:2:1)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
```

who can help me ?   The os: centos  7 x64
Node version : v7.5.0  this is a binary .  i will try build it from source to test the problem later .
 reinstall nodejs from source ,and stf.  
run `stf local ` ,take some  error log:
```shell
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 19092 [*] Connecting to 127.0.0.1:28015
INF/db:setup 19092 [*] Database "stf" already exists
INF/db:setup 19092 [*] Table "users" already exists
INF/db:setup 19092 [*] Table "accessTokens" already exists
INF/db:setup 19092 [*] Table "vncauth" already exists
INF/db:setup 19092 [*] Table "devices" already exists
INF/db:setup 19092 [*] Table "logs" already exists
INF/db:setup 19092 [*] Index "users"."adbKeys" already exists
INF/db:setup 19092 [*] Waiting for index "users"."adbKeys"
INF/db:setup 19092 [*] Index "accessTokens"."email" already exists
INF/db:setup 19092 [*] Waiting for index "accessTokens"."email"
INF/db:setup 19092 [*] Index "vncauth"."response" already exists
INF/db:setup 19092 [*] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 19092 [*] Index "devices"."owner" already exists
INF/db:setup 19092 [*] Index "devices"."present" already exists
INF/db:setup 19092 [*] Index "devices"."providerChannel" already exists
INF/db:setup 19092 [*] Index "users"."adbKeys" is ready
INF/db:setup 19092 [*] Waiting for index "vncauth"."response"
INF/db:setup 19092 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 19092 [*] Waiting for index "devices"."owner"
INF/db:setup 19092 [*] Waiting for index "devices"."present"
INF/db:setup 19092 [*] Waiting for index "devices"."providerChannel"
INF/db:setup 19092 [*] Index "accessTokens"."email" is ready
INF/db:setup 19092 [*] Index "vncauth"."response" is ready
INF/db:setup 19092 [*] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 19092 [*] Index "devices"."owner" is ready
INF/db:setup 19092 [*] Index "devices"."present" is ready
INF/db:setup 19092 [*] Index "devices"."providerChannel" is ready
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js provider --name localhost.localdomain --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/7.5.0/linux/x64/zmq.node
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/7.5.0/linux/x64/zmq.node
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-temp --port 7102"
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/7.5.0/linux/x64/zmq.node
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/7.5.0/linux/x64/zmq.node
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 19086 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
FTL/cli:local 19086 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:192:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 19086 [*] Shutting down all child processes
/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/7.5.0/linux/x64/zmq.node
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
```  There are a few docker containers that run android emulator inside of them. The one below in particular you can expose your adb connection to the host machine. Just curious if anyone has attempted this or if it would even work with openstf?

https://hub.docker.com/r/tracer0tong/android-emulator/~/dockerfile/
 Interesting. I can get the emulator screen to appear and fully interact the STF controls when gpu in ON. With gpu off, it unfortunately does not work. I was running a generic_x86_64 on SDK 23 on my local OSX machine, not in a container.

emulator -avd EM1 -no-window -gpu on  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

Except the below issue, all works fine.

I used the latest image and I met the same issue than #100 , in a similar configuration, I mean with a stf-provider in one machine (linux) and the other services in another machine (linux), both located on the same network. 

I read answer at #104, and then I set -e "ZMQ_TCP_KEEPALIVE=1" and -e "ZMQ_TCP_KEEPALIVE_IDLE=30000" when launching services through docker, for instance stf-triproxy-dev.service:
```
....
[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  --net host \
  -e "ZMQ_TCP_KEEPALIVE=1" \
  -e "ZMQ_TCP_KEEPALIVE_IDLE=30000" \
  openstf/stf:lastest \
  stf triproxy dev \
    --bind-pub "tcp://*:7250" \
    --bind-dealer "tcp://*:7260" \
    --bind-pull "tcp://*:7270"
ExecStop=-/usr/bin/docker stop -t 10 %p
....
```


but it seems it does not change anything I mean after a while I get totally blank screen after click the use button on device.

My questions are:
- the value for ZMQ timer must be specified in seconds or milliseconds ?
- what are the precise services I have to set ZMQ variables ?

Thanks.


 No I have 5 devices and the issue is the same for all.
When all services are on the same machine I have no issue.
Before to set ZMQ variables I tried to set net.ipv4.tcp_keepalive_time=30 on the host before to launch services and with the '--net host' option I verified that connecting to the container with bash there was the same value, but I met also the same issue.
For information on device side, I used the openstf/atf-armv7l image because the host is raspberry PI.
May you help me please because it is very blocking for me ?
May you also answer to my questions please ?
Thanks. Great ! It works fine now !
Thanks From your point of view you what is the good value ?
Thanks

De : Simo Kinnunen [mailto:notifications@github.com]
Envoyé : jeudi 26 janvier 2017 08:25
À : openstf/stf
Cc : BARBARON Denis IMT/OLPS; State change
Objet : Re: [openstf/stf] ZMQ_TCP_KEEPALIVE usage ? (#528)


I updated those old comments that had the weird value of 30000. You had to read the issue all the way till the end to see that the values were actually supposed to be in seconds. Also, not sure if 300 seconds is even a good value or not.

—
You are receiving this because you modified the open/close state.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/528#issuecomment-275323415>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkCudEo1SwiNnvLNt52ZLLX9cM6AGqks5rWEpCgaJpZM4Ltk_7>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 That’s right !
Thanks.

De : Simo Kinnunen [mailto:notifications@github.com]
Envoyé : jeudi 26 janvier 2017 08:29
À : openstf/stf
Cc : BARBARON Denis IMT/OLPS; State change
Objet : Re: [openstf/stf] ZMQ_TCP_KEEPALIVE usage ? (#528)

I just told you, I have no idea. Depends on your network.

On Thu, Jan 26, 2017 at 4:27 PM, denis99999 <notifications@github.com<mailto:notifications@github.com>>
wrote:

> From your point of view you what is the good value ?
> Thanks
>
> De : Simo Kinnunen [mailto:notifications@github.com]
> Envoyé : jeudi 26 janvier 2017 08:25
> À : openstf/stf
> Cc : BARBARON Denis IMT/OLPS; State change
> Objet : Re: [openstf/stf] ZMQ_TCP_KEEPALIVE usage ? (#528)
>
>
> I updated those old comments that had the weird value of 30000. You had to
> read the issue all the way till the end to see that the values were
> actually supposed to be in seconds. Also, not sure if 300 seconds is even a
> good value or not.
>
> —
> You are receiving this because you modified the open/close state.
> Reply to this email directly, view it on GitHub<https://github.com/
<https://github.com/%0b>> openstf/stf/issues/528#issuecomment-275323415>, or mute the thread<
> https://github.com/notifications/unsubscribe-auth/
> AVtkCudEo1SwiNnvLNt52ZLLX9cM6AGqks5rWEpCgaJpZM4Ltk_7>.
>
> ____________________________________________________________
> _____________________________________________________________
>
> Ce message et ses pieces jointes peuvent contenir des informations
> confidentielles ou privilegiees et ne doivent donc
> pas etre diffuses, exploites ou copies sans autorisation. Si vous avez
> recu ce message par erreur, veuillez le signaler
> a l'expediteur et le detruire ainsi que les pieces jointes. Les messages
> electroniques etant susceptibles d'alteration,
> Orange decline toute responsabilite si ce message a ete altere, deforme ou
> falsifie. Merci.
>
> This message and its attachments may contain confidential or privileged
> information that may be protected by law;
> they should not be distributed, used or copied without authorisation.
> If you have received this email in error, please notify the sender and
> delete this message and its attachments.
> As emails may be altered, Orange is not liable for messages that have been
> modified, changed or falsified.
> Thank you.
>
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/openstf/stf/issues/528#issuecomment-275323741>, or mute
> the thread
> <https://github.com/notifications/unsubscribe-auth/AAB-_RwGWTu_-qf8XUE_7JD5bdE4vd-pks5rWErpgaJpZM4Ltk_7>
> .
>


—
You are receiving this because you modified the open/close state.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/528#issuecomment-275323863>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkCsKLRcVaVaIcQH5BOjEDkh3r5t0Mks5rWEs3gaJpZM4Ltk_7>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 Hello,

Thank you very much for tour answer.

De : Vishal Banthia [mailto:notifications@github.com]
Envoyé : jeudi 26 janvier 2017 16:40
À : openstf/stf
Cc : BARBARON Denis IMT/OLPS; State change
Objet : Re: [openstf/stf] ZMQ_TCP_KEEPALIVE usage ? (#528)


@sorccu<https://github.com/sorccu>

I updated those old comments that had the weird value of 30000. You had to read the issue all the way till the end to see that the values were actually supposed to be in seconds. Also, not sure if 300 seconds is even a good value or not.

I think timeout unit depends on host OS. For MacOS it is ms & for linux it is seconds. I tested it with MacOS first that is why it was in ms before but later all the issues were on linux system that is why in seconds later.

Also, 300 seconds is working fine with all the past issues, so I think it is okay.

—
You are receiving this because you modified the open/close state.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/528#issuecomment-275420625>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkCrV7O2EdRWlsjGuDQh5MoA3vAPBXks5rWL5igaJpZM4Ltk_7>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

  I´ve been faced an EventEmitter memory leak problem/bug

Error:
(node) warning: possible EventEmitter memory leak detected. 11 end listeners added. Use emitter.setMaxListeners() to increase limit.
Trace
at Socket.addListener (events.js:239:17)
at Socket.Readable.on (_stream_readable.js:680:33)
at Parser.readBytes (/stf/node_modules/adbkit/lib/adb/parser.js:126:17)
at Parser.readAscii (/stf/node_modules/adbkit/lib/adb/parser.js:89:17)
at /stf/node_modules/adbkit/lib/adb/sync.js:249:29
at Sync._readData (/stf/node_modules/adbkit/lib/adb/sync.js:269:14)
at Sync.pull (/stf/node_modules/adbkit/lib/adb/sync.js:138:17)
at ProcStat.update (/stf/node_modules/adbkit/lib/adb/proc/stat.js:40:33)
at null._repeat (/stf/node_modules/adbkit/lib/adb/proc/stat.js:27:22)
at wrapper [as _onTimeout] (timers.js:275:11)
at Timer.listOnTimeout (timers.js:92:15)
(node) warning: possible EventEmitter memory leak detected. 11 end listeners added. Use emitter.setMaxListeners() to increase limit.
Trace
at Socket.addListener (events.js:239:17)
at Socket.Readable.on (_stream_readable.js:680:33)
at Parser.readBytes (/stf/node_modules/adbkit/lib/adb/parser.js:126:17)
at Parser.readAscii (/stf/node_modules/adbkit/lib/adb/parser.js:89:17)
at /stf/node_modules/adbkit/lib/adb/sync.js:249:29
at Sync._readData (/stf/node_modules/adbkit/lib/adb/sync.js:269:14)
at Sync.pull (/stf/node_modules/adbkit/lib/adb/sync.js:138:17)
at MemStat.update (/stf/node_modules/adbkit/lib/adb/proc/meminfo.js:52:33)
at null._repeat (/stf/node_modules/adbkit/lib/adb/proc/meminfo.js:39:22)
at wrapper [as _onTimeout] (timers.js:275:11)
at Timer.listOnTimeout (timers.js:92:15)

 After a quick research i figured out that this turns out be a bug in nodejs core documented here:
https://github.com/joyent/node/issues/5108

Does anyone have a workaround for this leak problem?

Thank you all  I create a translating to Portuguese, can you merge?

Thanks @gunta can you help me?  Hi,
I've been trying to set up a server with stf for some time now. My problem is that all the services fail because they cannot connect to rethinkDB. The reason for this might be the following:
in Deployment.md you state that after starting rethinkDB one should open the webinterface and run this command:

`r.db('rethinkdb').table('cluster_config').get('auth').update({auth_key: 'newkey'})`

In my case this always throws following error:

> 
{

    "deleted": 0 ,
    "errors": 1 ,
    "first_error": "It's illegal to delete rows from the `rethinkdb.cluster_config` table." ,
    "inserted": 0 ,
    "replaced": 0 ,
    "skipped": 0 ,
    "unchanged": 0

}
<

In my opinion this is the reason why nothing works, but I may be wrong on this one.

Thanks for your help. You can try setting up the password on the first run of your rethink server.
`rethinkdb --initial-password yourBrandNewKey`

Or you can try this in the console instead:
`r.db('rethinkdb').table('users').get('admin').update({password:'yourBrandNewKey'})` and it seemd to do the trick but I'm not sure if the 2 commands do the same thing. So the solution I've found that seems to work is as @mirceanis suggested:

`r.db('rethinkdb').table('users').get('admin').update({password:'yourBrandNewKey'})`

It seems that you can enter whatever password you want there. At least now all of my services can connect to rethinkDB.

Thank you guys.  **What is the issue or idea you have?**
I've been able to access my devices remotely with different machines that are in the same network. Now I want to do the same from a different network but I'm unable even though I have created a redirection in the router.

Could you please give me some indications on what should be done? I'd be really grateful to you.

Thanks!
Victor Everything's working now, was making a noob mistake with the IPs  Will you please tell me how you did that? @viktors89 Can tell me how? I am trying to do the samething? any guide would be appreciated!Thanks   QualiTests-Mac-mini-2:stf03012017 qualitest$ sudo npm install -g stf
npm WARN prepublish-on-install As of npm@5, `prepublish` scripts will run only for `npm publish`.
npm WARN prepublish-on-install (In npm@4 and previous versions, it also runs for `npm install`.)
npm WARN prepublish-on-install See the deprecation note in `npm help scripts` for more information.
npm WARN lifecycle stf@2.3.0~prepublish: cannot run in wd %s %s (wd=%s) stf@2.3.0 bower install && not-in-install && gulp build || in-install /Users/qualitest/Desktop/stf03012017/stf
/usr/local/bin/stf -> /usr/local/lib/node_modules/stf/bin/stf

> dtrace-provider@0.8.0 install /usr/local/lib/node_modules/stf/node_modules/bunyan/node_modules/dtrace-provider
> node scripts/install.js


> dtrace-provider@0.7.1 install /usr/local/lib/node_modules/stf/node_modules/dtrace-provider
> node scripts/install.js


> bufferutil@1.3.0 install /usr/local/lib/node_modules/stf/node_modules/bufferutil
> node-gyp rebuild

gyp WARN EACCES user "root" does not have permission to access the dev dir "/Users/qualitest/.node-gyp/6.9.2"
gyp WARN EACCES attempting to reinstall using temporary dev dir "/usr/local/lib/node_modules/stf/node_modules/bufferutil/.node-gyp"
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
  SOLINK_MODULE(target) Release/bufferutil.node

> jpeg-turbo@0.4.0 install /usr/local/lib/node_modules/stf/node_modules/jpeg-turbo
> node-pre-gyp install --fallback-to-build

gyp WARN EACCES user "root" does not have permission to access the dev dir "/Users/qualitest/.node-gyp/6.9.2"
gyp WARN EACCES attempting to reinstall using temporary dev dir "/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/.node-gyp"
make: *** No rule to make target `../.node-gyp/6.9.2/include/node/common.gypi', needed by `Makefile'.  Stop.
gyp ERR! build error 
gyp ERR! stack Error: `make` failed with exit code: 2
gyp ERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:276:23)
gyp ERR! stack     at emitTwo (events.js:106:13)
gyp ERR! stack     at ChildProcess.emit (events.js:191:7)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
gyp ERR! System Darwin 16.3.0
gyp ERR! command "/usr/local/bin/node" "/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "build" "--fallback-to-build" "--module=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-darwin-x64/jpegturbo.node" "--module_name=jpegturbo" "--module_path=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-darwin-x64"
gyp ERR! cwd /usr/local/lib/node_modules/stf/node_modules/jpeg-turbo
gyp ERR! node -v v6.9.2
gyp ERR! node-gyp -v v3.4.0
gyp ERR! not ok 
node-pre-gyp ERR! build error 
node-pre-gyp ERR! stack Error: Failed to execute '/usr/local/bin/node /usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js build --fallback-to-build --module=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-darwin-x64/jpegturbo.node --module_name=jpegturbo --module_path=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-darwin-x64' (1)
node-pre-gyp ERR! stack     at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/node_modules/node-pre-gyp/lib/util/compile.js:83:29)
node-pre-gyp ERR! stack     at emitTwo (events.js:106:13)
node-pre-gyp ERR! stack     at ChildProcess.emit (events.js:191:7)
node-pre-gyp ERR! stack     at maybeClose (internal/child_process.js:877:16)
node-pre-gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:226:5)
node-pre-gyp ERR! System Darwin 16.3.0
node-pre-gyp ERR! command "/usr/local/bin/node" "/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/node_modules/.bin/node-pre-gyp" "install" "--fallback-to-build"
node-pre-gyp ERR! cwd /usr/local/lib/node_modules/stf/node_modules/jpeg-turbo
node-pre-gyp ERR! node -v v6.9.2
node-pre-gyp ERR! node-pre-gyp -v v0.6.19
node-pre-gyp ERR! not ok 
Failed to execute '/usr/local/bin/node /usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js build --fallback-to-build --module=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-darwin-x64/jpegturbo.node --module_name=jpegturbo --module_path=/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v48-darwin-x64' (1)
/usr/local/lib
└── (empty)

npm ERR! Darwin 16.3.0
npm ERR! argv "/usr/local/bin/node" "/usr/local/bin/npm" "install" "-g" "stf"
npm ERR! node v6.9.2
npm ERR! npm  v4.0.5
npm ERR! code ELIFECYCLE

npm ERR! jpeg-turbo@0.4.0 install: `node-pre-gyp install --fallback-to-build`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the jpeg-turbo@0.4.0 install script 'node-pre-gyp install --fallback-to-build'.
npm ERR! Make sure you have the latest version of node.js and npm installed.
npm ERR! If you do, this is most likely a problem with the jpeg-turbo package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-pre-gyp install --fallback-to-build
npm ERR! You can get information on how to open an issue for this project with:
npm ERR!     npm bugs jpeg-turbo
npm ERR! Or if that isn't available, you can get their info via:
npm ERR!     npm owner ls jpeg-turbo
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /Users/qualitest/Desktop/stf03012017/npm-debug.log
QualiTests-Mac-mini-2:stf03012017 qualitest$ node -v
v6.9.2
QualiTests-Mac-mini-2:stf03012017 qualitest$  Ok but I tried without using sudo, still i'm getting warnings and errors. In terminal 1 : All requirements had been installed and i'm getting stuck in Installation part npm install -g stf and not able to proceed further for building and running part. In terminal 2 : i'm running rethinkdb. 
So please do help.  hello，everybody，due to the server can only connect 9 usb,which leads to our STF platform can only connect 9 mobiles,   i am confused about this issue, do you have any solutions about this? 
My system is  Ubuntu 16.04 LTS 
greatful Usb-hub need to access external power  or will be disconnect. @ sorccu，hello,i'm trying to use 'stf provider --name "provider-windows_3" --connect-sub tcp://10.100.72.195:7250  --connect-push tcp://10.100.72.195:7270  --storage-url http://10.100.72.195  --public-ip 10.100.72.195 --min-port=30001  --max-port=35000',but error.
![image](https://cloud.githubusercontent.com/assets/24601692/21844135/7b10b6d4-d828-11e6-8730-4f15904a7a10.png)
can you tell me why??? @sorccu good morning,sorccu,can you tell me how to use 'stf provider''s commands?How do you write inside of the parameters？ I solved the problem by disabling USB3.0 in BIOS. My workstation is a DELL plex, os is Ubuntu 16.04.  tiger@ubuntu:/usr/lib/node_modules/stf$ sudo stf local
module.js:471
    throw err;
    ^

Error: Cannot find module 'commander'
    at Function.Module._resolveFilename (module.js:469:15)
    at Function.Module._load (module.js:417:25)
    at Module.require (module.js:497:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/cli.js:4:15)
    at Module._compile (module.js:570:32)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)

I'm running rethinkdb in terminal 1 and trying to run stf local in terminal 2. When i run stf local i'm getting this error. Also i updated node.js  and npm, but still i'm getting this error. Please help.
  Is it possible to restrict access to a specif group on STF when using LDAP?

In my company I added a group to manage who will have access to STF.

First I run STF without selecting the group and that works and I'm able to authenticate

`stf local --auth-type ldap --auth-options '["--ldap-url","$URL","--ldap-search-dn","DC=inner_dc,DC=inner_dc,DC=com","--ldap-bind-credentials","$PASS", "--ldap-bind-dn","CN=user_stf,OU=inner_ou,OU=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-search-field", "sAMAccountName"]'`

When I change the command to restrict a specific group I get a message of "authentication failed for user xxxxx"

`stf local --auth-type ldap --auth-options '["--ldap-url","$URL","--ldap-search-dn","CN=specific_group,OU=inner_ou,OU=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-bind-credentials","$PASS", "--ldap-bind-dn","CN=user_stf,OU=inner_ou,OU=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-search-field", "sAMAccountName"]'`

How can I grant access to STF for a specific group?
 relevant to #714  Hi, any advanced about stf login ldap as member group??

Thanks.  when we execute the command
rethinkdb 

we are getting the above error.
what do  we need to do to proceed further?  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
 README means??
 Sorry sorccu it was by mistake , Can you please help us sorccu? sorry it  was by mistake.
instead of google we typed here.
Can you plz help us?  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

**Please provide the steps to reproduce the issue.**

**What is the expected behavior?**

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

**Please run `stf doctor` and paste the output here.**
  I can only see a list under devices menu.
Can I see the all the real time screen instead?

Anyone knows, thanks Ok!  RT stf就是用adb来连接的  I have installed all requirements for stf and run npm install normally. but when I run stf local command, the error messages is threw. 
FTL/reaper 690 [reaper001] Unable to load initial state { ReqlOpFailedError: Database `stf` does not exist in:
r.table("devices").getAll(true, {"index": "present"})
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    at ReqlOpFailedError.ReqlError [as constructor] (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/errors.js:23:13)
    at ReqlOpFailedError.ReqlRuntimeError [as constructor] (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/errors.js:90:51)
    at ReqlOpFailedError.ReqlAvailabilityError [as constructor] (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/errors.js:167:56)
    at new ReqlOpFailedError (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/errors.js:178:52)
    at mkErr (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/util.js:177:10)
    at TcpConnection.Connection._processResponse (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/net.js:152:16)
    at TcpConnection.Connection._data (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/net.js:122:12)
    at Socket.<anonymous> (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/net.js:689:32)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at readableAddChunk (_stream_readable.js:176:18)
    at Socket.Readable.push (_stream_readable.js:134:10)
    at TCP.onread (net.js:551:20)
From previous event:
    at Function.TermBase.run (/Users/zhangwl/work/stf-master/node_modules/rethinkdb/ast.js:135:12)
    at /Users/zhangwl/work/stf-master/lib/db/index.js:110:14
    at runCallback (timers.js:651:20)
    at tryOnImmediate (timers.js:624:5)
    at processImmediate [as _immediateCallback] (timers.js:596:5)
From previous event:
    at Object.db.run (/Users/zhangwl/work/stf-master/lib/db/index.js:109:23)
    at Object.dbapi.loadPresentDevices (/Users/zhangwl/work/stf-master/lib/db/api.js:333:13)
    at loadInitialState (/Users/zhangwl/work/stf-master/lib/units/reaper/index.js:80:18)
    at module.exports (/Users/zhangwl/work/stf-master/lib/units/reaper/index.js:122:3)
    at Object.module.exports.handler (/Users/zhangwl/work/stf-master/lib/cli/reaper/index.js:42:39)
    at Object.self.runCommand (/Users/zhangwl/work/stf-master/node_modules/yargs/lib/command.js:169:22)
    at parseArgs (/Users/zhangwl/work/stf-master/node_modules/yargs/yargs.js:869:28)
    at Object.get [as argv] (/Users/zhangwl/work/stf-master/node_modules/yargs/yargs.js:809:16)
    at Object.<anonymous> (/Users/zhangwl/work/stf-master/lib/cli/index.js:40:3)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.runMain (module.js:605:10)
    at run (bootstrap_node.js:420:7)
    at startup (bootstrap_node.js:139:9)
    at bootstrap_node.js:535:3
  name: 'ReqlOpFailedError',
  msg: 'Database `stf` does not exist.',
  frames: [],
  message: 'Database `stf` does not exist in:\nr.table("devices").getAll(true, {"index": "present"})\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^' }
FTL/util:lifecycle 690 [reaper001] Shutting down due to fatal error
FTL/cli:local 684 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/Users/zhangwl/work/stf-master/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 684 [*] Shutting down all child processes
INF/util:lifecycle 686 [app001] Winding down for graceful exit
INF/util:lifecycle 687 [dev001] Winding down for graceful exit
INF/util:lifecycle 688 [proc001] Winding down for graceful exit
INF/util:lifecycle 689 [proc002] Winding down for graceful exit
WRN/db 688 [proc001] Connection closed
INF/db 688 [proc001] Connecting to 127.0.0.1:28015
WRN/db 689 [proc002] Connection closed
INF/db 689 [proc002] Connecting to 127.0.0.1:28015 at the first time when I run stf local ,the error message is the stf database does not exist , so i create stf database in rethinkdb manually, then the message is  Database stf does not exist in:
r.table("devices").getAll(true, {"index": "present"}) Database have not created.Maybe is a bug in version 2.3.0. @0x88l , where can I find scripts to create stf database in rethinkdb manually. I can't sure if it is a bug in version 2.3.0.

 Version 2.3.0 has update many files.I know there is a  problem.However,I do not have detailed access.
 @vbanthia Thank you kind sir! I was having the same error as described above and your pro-tip fixed the problem for me. @vbanthia Thanks, it‘s work for me ： ） It works for me after changing the last line of lib/cli/local/index.js
```javascript
  return procutil.fork(__filename, ['migrate'])
    .done(run)
```
to
```javascript
return procutil.fork(path.resolve(__dirname, '..'), ['migrate']).done(run)
```  When I connect to Amazon Fire (2015) device, the screen is distorted. However, when I capture screenshot, it looks fine.

Here is the picture of my session.

![openstf session with screenshot](https://cloud.githubusercontent.com/assets/8355118/21463972/c93f72ca-c926-11e6-97d3-0815435532ef.png)


```
:: adb devices -l
List of devices attached
G0K0H40453640FB1       device usb:1-1 product:full_ford model:KFFOWI device:ford


:: stf doctor
INF/util:doctor 7392 [*] OS Arch: x64
INF/util:doctor 7392 [*] OS Platform: darwin
INF/util:doctor 7392 [*] OS Platform: 15.6.0
INF/util:doctor 7392 [*] Using Node 6.4.0
INF/util:doctor 7392 [*] Using RethinkDB client 2.3.3
INF/util:doctor 7392 [*] Using ZeroMQ 4.1.6
INF/util:doctor 7392 [*] GraphicsMagick 1.3.25
INF/util:doctor 7392 [*] ProtoBuf 3.1.0
ERR/util:doctor 7392 [*] Current ProtoBuf version is not supported, it has to be ~2
INF/util:doctor 7392 [*] Local ADB 1.0.32

INF/util:doctor 7392 [*] Local RethinkDB server 2.3.5
```

 I've got exactly the same thing happening on a Lenovo Tab3 Essential.  It seems to be related to rotation; if I physically rotate the device so that it goes into portrait mode, the live image appears fine, and I can then lock the orientation and it'll be fine until the orientation gets unlocked again.  Attempting to rotate the device in STF seems to unlock the orientation though, resulting in the image becoming garbled again - so it can only really be used when locked in portrait orientation.

I wonder if this is related to the Tab3 Essential allowing full 360 degree rotation (i.e. you can have it portrait but upside down, or landscape with the "top" of the device either pointed to the left or the right); does your Fire device allow full rotation too, @shivshankark? Interesting I noticed the same issue on AWS device farm seems like they are using STF.  * translations are inconsistent: e.g. "access tokens" got different translations. "app" got no translation and translations to "应用“
* incorrect translation: e.g. "keys" should not be "按键". I found that old translation was correct, it was "密钥" in zh_hans.json
* weird translations: e.g. "ADB keys" translated to "安卓调试桥的密钥". Acronyms should not be translated. I'm the translator. The translation maybe unable to meet everyone's standards.
You can modify the code to your version. 
The path: /res/common/lang/translations/stf.zh_CN.json It's not about the taste. It's correctness, accuracy, consistency and common translation standards.
I would make a PR when I have time.  I find some phones even  'nexus 5x' ,'huawei honor 6' , 'lenovo' can't export logcat.
I have used cmd 'adb logcat -B' to export logcat.
Compared the normal devices ,I found something wrong with the err devices.
The err devices  output the first line have some garbled like this.
![image](https://cloud.githubusercontent.com/assets/18346467/21413905/c0716f00-c835-11e6-8239-7bf996ab03d6.png)

It that caused the logcat can't export ?


 Yes You means to upload the logcat file? I have used to adb-kit to write a test code to locate the problem.But adb.openlogcat can't read this nexus phone' logcat.It doesn't work too.Maybe something special like this  kinds of phone.
The code :

```
var adbkit = require('adbkit')
//var Promise = require('bluebird')
var adb = adbkit.createClient({host:'127.0.0.1', port:5037})
adb.Keycode = adbkit.Keycode
var serial = 'D8YDU16115003258'
//var serial='012e8e2764d6bccc'

adb.openLogcat(serial,{
      clear: true
    })
      .then(function (logcat) {
        function entryListener(entry){
          console.log(entry)   //      nexus  entry nothing
        }
        logcat.on('entry', entryListener)
        logcat.on('error',function (err) {
         console.log('entry error')
         console.error(err)

        })
    })
``` @sorccu 
I have found the problem.Because some phones do not have command(logcat -c).It occured permission denied.Do  you have a better idea to solve it?
Like this:
![image](https://cloud.githubusercontent.com/assets/18346467/21474188/b8737db0-cb56-11e6-9c93-0511f1cc2acc.png)

  Hi all,
well I'm beginner, and I'd like to know, whether was used anyone Designer patterns on development of STF, I'm learning the source code, to understand how things happens there, but it's quite hard to understand them. Do you have any help to developers? STF it's a hard project to study without a apprenticeship direction.  Hi, mates!
Have you tested or recommend any other micro USB cable model different from those described in the "Recommended Hardware"section? I'm not having technical issues with the _monoprice_ cables, but it would be nice if I could find another seller.
Thanks!  when the same user is logged in two different sessions, the socket is shared... it should be two different sockets!
 Thank you for the quick answer. I´ll work on a decent workaround to this issue. and if we got to a possible interesting solution we´ll share it  Hi,

I have cloned the repo from here. It is pointing to master branch.

I followed the below steps to build and run stf.

> First, fetch all NPM and Bower modules:
> 
> `npm install`
> You may also wish to link the module so that you'll be able to access the stf command directly from the command line:
> 
> `npm link`

After this I started stf with the below command.

`stf local --public-ip <<my ip>>`

From my local machine, i am able to access stf and the devices. When my colleague tried launching via IP, she was able to launch. However when she clicked on `Use` for one of the devices, the device section was blank and grey. Then it moved back to device detail page and showed that devices are disconnected.

However, I was able to see the devices all this while.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

I do not see any error message in the log.

**Please run `stf doctor` and paste the output here.**

INF/util:doctor 67561 [*] OS Arch: x64
INF/util:doctor 67561 [*] OS Platform: darwin
INF/util:doctor 67561 [*] OS Platform: 16.1.0
INF/util:doctor 67561 [*] Using Node 6.3.0
INF/util:doctor 67561 [*] Using RethinkDB client 2.3.3
INF/util:doctor 67561 [*] Using ZeroMQ 4.1.5
INF/util:doctor 67561 [*] GraphicsMagick 1.3.24
INF/util:doctor 67561 [*] ProtoBuf 2.6.1
INF/util:doctor 67561 [*] Local ADB 1.0.32

INF/util:doctor 67561 [*] Local RethinkDB server 2.3.4

Please help!  @sorccu Can you please help me with this? Hello,
Did you check it is not simply a Firewall issue because it seems to be ? @denis99999 yes this was a firewall issue.   I am trying to setup oAuth login with office 365 for STF.

```
stf local --auth-type oauth2 \
  --auth-options '[ 
    "--oauth-authorization-url", "https://login.windows.net/common/oauth2/authorize?resource=https%3A%2F%2Fgraph.microsoft.com",
    "--oauth-token-url", "https://login.windows.net/common/oauth2/token",
    "--oauth-userinfo-url", "**<What should be here?>**",
    "--oauth-client-id", "<my-client-id>",
    "--oauth-client-secret", "<my-secret>",
    "--oauth-callback-url", "https://stf.example.org/auth/oauth/callback",
    "--oauth-scope", "openid email"
  ]'
```

Wanted to understand what should be the _--oauth-userinfo-url_ ?

Please help. @sorccu Thanks I was able to set it up. However, getting this error in the logs

`WRN/auth-oauth2 8996 [*] Missing email in profile`

This is because the response doesn't contain the email field. 

I am trying the modify the code and building locally now. Is there any other way? I solved the `Missing email` issue by locally modifying the code and building it. 

This is the change i did.

- Under `lib/units/oauth2/`
- Modified `index.js` router method `app.get(
    '/auth/oauth/callback'
  , function(req, res)`

- Added the below block.

```
      else if (req.user.unique_name) {
        res.redirect(urlutil.addParams(options.appUrl, {
          jwt: jwtutil.encode({
            payload: {
              email: req.user.unique_name
            , name: req.user.unique_name.split('@', 1).join('')
            }
          , secret: options.secret
          , header: {
              exp: Date.now() + 24 * 3600
            }
          })
        }))
      }
```

Then it worked!  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**

When I control some  virtualkey android devices (doesn't have physical key), the menu button cannot work in stf.  I click menu button in stf ,but android device has no response.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

5LM0216804001013       device product:NXT-AL10 model:HUAWEI_NXT_AL10 device:HWNXT
   

**Please provide the steps to reproduce the issue.**
1、connect a android devices (has virtualkey)
2、click menu button in stf

**What is the expected behavior?**
  menu button will work


**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
no

**Please run `stf doctor` and paste the output here.**
   Menu,home ,back key are present on the device. 
And Home and back key can work well. But menu key cannot work.  Oppo A37 after installing apk restuns an err.
![image](https://cloud.githubusercontent.com/assets/18346467/20913258/1645cba6-bbb1-11e6-95b5-4b6cc129231f.png)


But, 
1.install was success
2.mainifest get fail
3.server err log:
ERR/device:plugins:install 27083 [IN89MNGI99999999] Installation of package "com.boyaa.chinesechess.ky" failed Error: Activity class {com.boyaa.chinesechess.ky/com.boyaa.chinesechess.ky.Game} does not exist.
    at /var/stf/node_modules/adbkit/lib/adb/command/host-transport/startactivity.js:57:21
    at tryCatcher (/var/stf/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Promise._settlePromiseFromHandler (/var/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:503:31)
    at Promise._settlePromiseAt (/var/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:577:18)
    at Async._drainQueue (/var/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:128:12)
    at Async._drainQueues (/var/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:133:10)
    at Immediate.Async.drainQueues [as _onImmediate] (/var/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:15:14)
    at tryOnImmediate (timers.js:534:15)
    at processImmediate [as _immediateCallback] (timers.js:514:5)

 Other device is ok,Only oppo A37. I have found the in the file 'lib/units/devices/plugins/install.js'.
The code  :
sendProgress('installing_app', guesstimate)
          return promiseutil.periodicNotify(
              adb.installRemote(options.serial, apk)  
//  oppo os return status success , but it still installing. When start activity that  oppo OS  can't find the activity. 
                .timeout(60000 * 5)
......

I set timeout 10s to solve the bug. Maybe you have another better way.
The modify coed:

          sendProgress('installing_app', guesstimate)
          return promiseutil.periodicNotify(
              adb.installRemote(options.serial, apk)
                .timeout(60000 * 5)
                .catch(function(err) {
                  switch (err.code) {
                  case 'INSTALL_PARSE_FAILED_INCONSISTENT_CERTIFICATES':
                  case 'INSTALL_FAILED_VERSION_DOWNGRADE':
                    log.info(
                      'Uninstalling "%s" first due to inconsistent certificates'
                    , pkg
                    )
                    return adb.uninstall(options.serial, pkg)
                      .timeout(15000)
                      .then(function() {
                        return adb.installRemote(options.serial, apk)
                          .timeout(60000 * 5)
                      })
                  default:
                    return Promise.reject(err)
                  }
                })
            , 250
            )
            .progressed(function() {
              guesstimate = Math.min(
                end
              , guesstimate + 1.5 * (end - guesstimate) / (end - start)
              )
              sendProgress('installing_app', guesstimate)
            })
        }).then(function () {
          return new Promise(function (resolve, reject) {
            setTimeout(function () {
              //after install really finish,like oppo os
              resolve('')
            }, 1000*10)
          })
        }))//here add .then()




  there is the pictures which can demostrate what have done. <img src="http://ww1.sinaimg.cn/mw690/a5e2541bgw1fafycurub8j21kw0vywwx.jpg"/> <img src="http://ww1.sinaimg.cn/mw690/a5e2541bgw1fafycu3csnj21kw0vy1bi.jpg"/>

as you can see, I rebuild the "Devices" tab content to many canvas so I can watch every devices screen change real-time. so I met the performance issue. cpu 100% and memory 100%.

my solutions:
1. I create a angular directive which contain just one canvas. then i get the screen data from many node process( i have read the code , when a device plugin the a new process was created and a port was distributed).  then i use canvas drawimage function to draw the each blob data at it right position.  it seem has some good effect. memory consumption has down。

2.another solution is that restrict the amount of websocket information transmission。 i setInterval in each node process( the file is stf/lib/units/device/plugins/screen/stream.js ) to control it send frame data every 1000ms.

3. divide into pages. limit  maximum 18 devices send data at each 1s

but there also some problem:
1. send data each 1s make it seem not smooth in browser. but if i send data more faster there are so many request .  chrome not work well.

do you have some advice. i really need a more efficient solution

  yeah. I now, thank you. I already worried about the performance when i get the product demand. if it's a C/S architecture not a B/S architecture or using some efficient language like c/java, may be it's more fast. this project seems not suit for this scenario. I have't forgot to minify the scale of the screen to 250*300. it made some help Interesting. Definitely not easy but not impossible neither.

So where did you found the biggest bottleneck right now? 
Canvas drawing / Network / Etc?

If the problem happens to be in client side / canvas drawing you could try drawing in a big single canvas. I suspect browsers are not optimised to have so many canvas drawing at the same time. I found two bottleneck.
1. Canvas drawing.  although i draw in a big single canvas. but there are so many drawImage function call. now one page max 18 devices. my core-i3 cpu show 60%-70%. if i put more device in one page.  it can expand 100%.
2. Network. one page max 18 devices means 18 websocket requests to handle in one seconds. if chrome can't handle all.  the screen in browser is slower than actual devices.  For example, if i open a second chronograph， it need more than 1s in chrome change from 53s to 54s ok. i also try use node-canvas to merge all imgs into one big img, then send to client. at it reduce the num of request and client's drawimage call.  it solved client performance issue. but node server has more consumption. it's not a good idea. may be this idea can help you For canvas drawing in this case the biggest bottleneck inside `drawImage` should be JPEG decompressing (and uploading to the GPU).

It might be worth investigating to do the image mixing on server side, it will add a lag for sure but it will make client side not eat so much CPU. Definitely doing the image mixing on a separate unit / server (and not with node.js but with something fast like https://github.com/jcupitt/libvips) might be better.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

**What is the issue or idea you have?**
invalid csrf token error when login stf web page (it works good until I update stf to latest version)

**Please provide the steps to reproduce the issue.**
run rethinkdb
run stf 
run stf local --public-ip 192.168.1.196
login to webpage by http://192.168.1.196:7100
input user name and email, click login

**What is the expected behavior?**
should login succesfully

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
ForbiddenError: invalid csrf token
    at csrf (/usr/lib/node_modules/stf/node_modules/csurf/index.js:112:19)
    at Layer.handle [as handle_request] (/usr/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/usr/lib/node_modules/stf/node_modules/express/lib/router/index.js:312:13)
    at /usr/lib/node_modules/stf/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/usr/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
    at next (/usr/lib/node_modules/stf/node_modules/express/lib/router/index.js:271:10)
    at /usr/lib/node_modules/stf/node_modules/body-parser/lib/read.js:129:5
    at invokeCallback (/usr/lib/node_modules/stf/node_modules/body-parser/node_modules/raw-body/index.js:262:16)
    at done (/usr/lib/node_modules/stf/node_modules/body-parser/node_modules/raw-body/index.js:251:7)
    at IncomingMessage.onEnd (/usr/lib/node_modules/stf/node_modules/body-parser/node_modules/raw-body/index.js:307:7)
    at emitNone (events.js:67:13)
    at IncomingMessage.emit (events.js:166:7)
    at endReadableNT (_stream_readable.js:921:12)
    at nextTickCallbackWith2Args (node.js:442:9)
    at process._tickCallback (node.js:356:17)

**Please run `stf doctor` and paste the output here.**
alex@alex-All-Series:~$ stf doctor
INF/util:doctor 1111 [*] OS Arch: x64
INF/util:doctor 1111 [*] OS Platform: linux
INF/util:doctor 1111 [*] OS Platform: 4.4.0-47-generic
INF/util:doctor 1111 [*] Using Node 4.5.0
INF/util:doctor 1111 [*] Using RethinkDB client 2.3.3
INF/util:doctor 1111 [*] Using ZeroMQ 4.1.4
WRN/util:doctor 1111 [*] Executable was not found
INF/util:doctor 1111 [*] Local ADB 1.0.32
INF/util:doctor 1111 [*] Local RethinkDB server 2.3.5~0xenial
/usr/lib/node_modules/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 2.3.5~0xenial
    at new SemVer (/usr/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/usr/lib/node_modules/stf/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/usr/lib/node_modules/stf/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/usr/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /usr/lib/node_modules/stf/lib/util/doctor.js:95:7
    at /usr/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:204:7)
    at emitTwo (events.js:87:13)
    at ChildProcess.emit (events.js:172:7)
    at maybeClose (internal/child_process.js:829:16)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:211:5) Any progress/resolution here?  @gupiao I was not using the SESSION SECRET environment variables. Used them and function was restored. I think you can close this one.  Hi Guys,

Is it possible to use the stream of screen from minicap or from openstf from an other webpage ? I want to embed the screen in one tv dashboard we have.

Thank you for your help.

Rgds.
 Cool. I will try this. Thanks for the update. I will try the node.js example in the repo.  <Not a bug>

Is it possible to take touch events from one phone and mirror it across other phones? It might sound crazy but would be so usefull? 
 Oops sorry about that. 

Thanks for the quick reply.  
Firstly, thanks for you guys create this great tool。as you can see, I met this problem you have listed:
> unsufficient USB host controller resources

as you describe, I run 'stf local' on ubuntu16.04 and plugin maximum 9 usb devices, if go on to plugin more, then i get this error. I know that i can extend the scale by deploy on server, but own demand is that plugin 30 nexus5 in one host computer.


I can't find disable usb3.0(or xhci) options in my bios, so I bought a PCIE extension card like <a href="https://item.jd.com/1004542.html">this</a>. so can you explain why we need usb extension card to solve this problem , i am so curious。 

  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
We are consuming remote device id as android device id after doing adb connect. It works for some test then it get disconnected. 

**What is the issue or idea you have?**
- Device is getting disconnected frequently.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
- It's not about specific device.

**Please provide the steps to reproduce the issue.**
Steps:
1- open stf 
2- adb connect  **x.x.x.x:xxxx** (Remote debug)
3- adb devices (this get listed)
4- We ran automated test which took 7 hours to complete some test suites take 15 hr to complete
5- Did multiple run facing error : device not found
6- adb devices (no entry found under this)

**What is the expected behavior?**
- This should not get disconnected. Is it wireless adb? Is this not reliable?

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
Not sure I am user of stf

**Please run `stf doctor` and paste the output here.**
 @vbanthia Is this web session timeout? or adb timeout? Because I ran automated test cases for 4 hr 42 min that time device was alive. But adb disconnect is sporadic. let me check while reserving device if I configure maximum timeout how it helps? @vbanthia getting exception {"message":"Unexpected token '","body":"'{serial:c8ee0c840836f31a,timeout:86400}
'","status":400} @vbanthia  Can I override the timeout while reserving the device? 

Please find below request : 

curl -X POST --header "Content-Type:application/json" --data '{"serial":"c8ee0c840836f31a","timeout":"86400"}' -H "Authorization: Bearer MY_TOKEN" http://stfurl/api/v1/user/devices thanks @vbanthia is above request correct to reserve device?  @vbanthia is timeout in millsec?  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
### My context
- **latest openstf image from docker hub build last day**
- debian jessie 3.16.0-4-amd64
- full deployment (DEPLOYMENT.md) with one machine running all services except provider service running on another machine (ARM one: openstf/stf-armv7l image)
- see other configuration details in my previous issue #479

### What the issue
- when I connect to the login page, I enter my login/passwd (i.e. mock authentification), then an empty page is returned !!!
- note this issue appear with or without SSL configuration
- note this issue didn't appear in the previous build

### Work around 
- I switched to the previous release v2.3.0 in which this issue doesn't appear
 Hi @sorccu,
I made 4 screenshots, see joined files, I hope it will be sufficient for you to investigate about this issue, I'm waiting for further instructions
<img width="1440" alt="capture d ecran 2016-11-24 a 15 05 59" src="https://cloud.githubusercontent.com/assets/22766602/20601759/79ef079a-b25a-11e6-9bcc-b27b882eefd3.png">
<img width="1197" alt="capture d ecran 2016-11-24 a 15 09 04" src="https://cloud.githubusercontent.com/assets/22766602/20601760/7a02c262-b25a-11e6-9d6d-0372914c2a3d.png">
<img width="1205" alt="capture d ecran 2016-11-24 a 15 10 06" src="https://cloud.githubusercontent.com/assets/22766602/20601761/7a1eb03a-b25a-11e6-9525-baf65f6ce71a.png">
<img width="1203" alt="capture d ecran 2016-11-24 a 15 10 25" src="https://cloud.githubusercontent.com/assets/22766602/20601762/7a223688-b25a-11e6-9f35-eadcbaa8b9f7.png">



 I saw a new release was build this night, so I updated but I have always the same issue, do you have any news about that ?

Note in v2.3.0 this issue doesn't appear so it is not a configuration issue, isn't it ? To simplify my configuration, I made a full deployment on a single machine, but it doesn't change anything.

 I checked 4 hours ago with latest docker image and it was not resolved. It's great it works fine now, thank you very much  @vbanthia !!!  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->
### My context
- debian jessie 3.16.0-4-amd64
- STF local has worked fine !
- I am trying to migrate to the full deployment (DEPLOYMENT.md) with one machine running all services except provider service running on another machine

### What works fine 
- all services are started correctly
- all devices on the provider machine are well detected and signaled to the main machine for registration in the rethinkdb database : I well verified through the "data explorer" the database was populated checking for instance all present devices
- so it seems internal communication between all services works well !

### What the issue
- when I connect to the login page, I enter my login/passwd (i.e. mock authentification), then I validate and STF returns me to the login page, so that I never go further. Looking the logs I saw I was well authenticated but a "304 Not Modified" was returned ! 

### What I made 
- I tried to switch from the "STF rethinkdb.service" to the old "LSB rethinkdb.service" I used with the STF local version but it didn't change anything
- I tried to switch the nginx configuration from https to http, so without ssl, but it didn't change anything
- I read the #76 issue but I have no loopback address in my systemd service files, I also tried to replace the "location /auth/ ... " section by the "location /auth/mock/ ..." section, but it didn't change anything
- I feel this is a problem on my nginx configuration but I don't know what !!!

### My configuration
on the main machine:
- one public interface : 10.194.124.248
- one private interface : 192.168.29.56
- Systemd services : rethinkdb.service, rethinkdb-proxy-28015.service, stf-api@3700.service, stf-app@3100.service, stf-auth@3200.service, stf-processor@proc1.service, stf-processor@proc2.service, stf-reaper.service, stf-storage-plugin-apk@3300.service, stf-storage-plugin-image@3400.service, stf-storage-temp@3500.service, stf-triproxy-app.service, stf-triproxy-dev.service, stf-websocket@3600.service, nginx.service

on the provider machine:
- one public interface : 10.194.128.171
- Systemd services : stf-provider@floor1.service, + adb (1.0.36 version)

no FW between the two machine, so that all is open

some service contents:
- **rethinkdb-proxy-28015.service**

```
Description=RethinkDB proxy/28015
After=docker.service rethinkdb.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/ambassador:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -p 28015 \
  -e RETHINKDB_PORT_28015_TCP=tcp://192.168.29.56:28015 \
  openstf/ambassador:latest
ExecStop=-/usr/bin/docker stop -t 10 %p
```

- **stf-app@3100.service**

```
[Unit]
Description=STF app
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --link rethinkdb-proxy-28015:rethinkdb \
  -e "SECRET=Kute Kittykat" \
  -p %i:3000 \
  openstf/stf:latest \
  stf app --port 3000 \
    --auth-url https://10.194.124.248/auth/mock/ \
    --websocket-url wss://10.194.124.248/
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```

- **stf-auth@3200.service**

```
[Unit]
Description=STF mock auth
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  -e "SECRET=Kute KittyKat" \
  -p %i:3000 \
  openstf/stf:latest \
  stf auth-mock --port 3000 \
    --app-url https://10.194.124.248/
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```

-  **stf-websocket@3600.service**

```
[Unit]
Description=STF websocket
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --link rethinkdb-proxy-28015:rethinkdb \
  -e "SECRET=Kute KittyKat" \
  -p %i:3000 \
  openstf/stf:latest \
  stf websocket --port 3000 \
    --storage-url https://10.194.124.248/ \
    --connect-sub tcp://192.168.29.56:7150 \
    --connect-push tcp://192.168.29.56:7170
ExecStop=/usr/bin/docker stop -t 10 %p-%i
```

- **stf-provider@floor1.service**

```
[Unit]
Description=STF provider
After=network.target

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf-armv7l:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --net host \
  openstf/stf-armv7l:latest \
  stf provider \
    --name "%H/%i" \
    --connect-sub tcp://10.194.124.248:7250 \
    --connect-push tcp://10.194.124.248:7270 \
    --storage-url https://10.194.124.248/ \
    --public-ip 10.194.128.171 \
    --min-port=15000 \
    --max-port=25000 \
    --heartbeat-interval 10000 \
    --screen-ws-url-pattern "wss://10.194.124.248/d/%i/<%= serial %>/<%= publicPort %>/"
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```

- **nginx.service**

```
[Unit]
Description=STF nginx public load balancer
After=docker.service
Requires=docker.service
ConditionPathExists=/srv/ssl/nginx.crt
ConditionPathExists=/srv/ssl/nginx.key
ConditionPathExists=/srv/ssl/dhparam.pem
ConditionPathExists=/srv/nginx/nginx.conf

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull nginx:1.7.10
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  --net host \
  -v /srv/ssl/nginx.crt:/etc/nginx/ssl/cert.pem:ro \
  -v /srv/ssl/nginx.key:/etc/nginx/ssl/cert.key:ro \
  -v /srv/ssl/dhparam.pem:/etc/nginx/ssl/dhparam.pem:ro \
  -v /srv/nginx/nginx.conf:/etc/nginx/nginx.conf:ro \
  nginx:1.7.10 \
  nginx
ExecStop=/usr/bin/docker stop -t 2 %p
```

- **nginx.conf**

```
daemon off;
worker_processes 4;

events {
  worker_connections 1024;
}

http {
  upstream stf_app {
    server 192.168.29.56:3100 max_fails=0;
  }

  upstream stf_auth {
    server 192.168.29.56:3200 max_fails=0;
  }

  upstream stf_storage_apk {
    server 192.168.29.56:3300 max_fails=0;
  }

  upstream stf_storage_image {
    server 192.168.29.56:3400 max_fails=0;
  }

  upstream stf_storage {
    server 192.168.29.56:3500 max_fails=0;
  }

  upstream stf_websocket {
    server 192.168.29.56:3600 max_fails=0;
  }

  upstream stf_api {
    server 192.168.29.56:3700 max_fails=0;
  }

  types {
    application/javascript  js;
    image/gif               gif;
    image/jpeg              jpg;
    text/css                css;
    text/html               html;
  }

  map $http_upgrade $connection_upgrade {
    default  upgrade;
    ''       close;
  }

  server {
    listen 80;
    server_name 10.194.124.248;
    return 301 https://$server_name$request_uri;
  }

  server {
    listen 443 ssl;
    server_name 10.194.124.248;
    keepalive_timeout 70;
    root /dev/null;

    # https://mozilla.github.io/server-side-tls/ssl-config-generator/
    ssl_certificate /etc/nginx/ssl/cert.pem;
    ssl_certificate_key /etc/nginx/ssl/cert.key;
    ssl_session_timeout 5m;
    ssl_session_cache shared:SSL:10m;
    ssl_dhparam /etc/nginx/ssl/dhparam.pem;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA';
    ssl_prefer_server_ciphers on;

    #add_header Strict-Transport-Security max-age=15768000;

    #ssl_stapling on;
    #ssl_stapling_verify on;
    #ssl_trusted_certificate /etc/nginx/ssl/cert.pem;

    resolver 8.8.4.4 8.8.8.8 valid=300s;
    resolver_timeout 10s;

    # Handle stf-provider@floor1.service
    location ~ "^/d/floor1/([^/]+)/(?<port>[0-9]{5})/$" {
      proxy_pass http://10.194.128.171:$port/;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_set_header X-Forwarded-For $remote_addr;
      proxy_set_header X-Real-IP $remote_addr;
    }

    location /auth/ {
      proxy_pass http://stf_auth/auth/;
    }

    location /api/ {
      proxy_pass http://stf_api/api/;
    }

    location /s/image/ {
      proxy_pass http://stf_storage_image;
    }

    location /s/apk/ {
      proxy_pass http://stf_storage_apk;
    }

    location /s/ {
      client_max_body_size 1024m;
      client_body_buffer_size 128k;
      proxy_pass http://stf_storage;
    }

    location /socket.io/ {
      proxy_pass http://stf_websocket;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Real-IP $http_x_real_ip;
    }

    location / {
      proxy_pass http://stf_app;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Real-IP $http_x_real_ip;
    }
  }
}
```
 Hi Sorccu,

Thank you very much it works fine now !!! But it is a little shame for me not to have seen this error lol

In fact, **it doesn't work fine with _the latest version_ build this day, it seems there is a regression** because when I logged I have only a blanck screen, and the logs return a "304" ! Did you have the same conclusion ?

So, waiting for the bug fix I made a rollback to the v2.3.0 version which seems to work fine.

In addition, where is the place to ask for new openstf features ? For instance, the main feature I would like to have is a reservation system enabling users to reserve smartphones for a time slot, is it planned in the roadmap ?

Denis. Thanks @gunta but is this PR always active because it seems the author left this project, do you plan to continue this work ?

Denis.  <!-- *Before creating an issue please make sure you are using the latest version of STF.* -->

Running 2.3.0 with stf local on an ubuntu 16.10 machine

**What is the issue or idea you have?**

The user is able to use the device through the web interface, but adb connect does nothing. It says you are connected to the device, but then running 'adb devices' comes up empty. Killing/restarting adb, stf, rethinkdb, or the system does not help.

Re-adding the key through the UI also doesn't help, the 'add' dialog goes away but it doesn't add the key/change anything.

The only workaround/fix I have found so far is to remove the adb keypair of the user on their machine, restart adb so it generates a new one. Then the browser shows a dialog to add the new adb key, and from then on it works fine.

Note that when a user with this bug does 'adb connect', the logs in the terminal on the server do show a new successful connection.

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**

Doesn't seem to be related to devices, it happens randomly.

**Please provide the steps to reproduce the issue.**

Happens at random and rarely, had it on both windows and macos machines.

**What is the expected behavior?**

adb connect actually showing the device after in adb devices.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**

No errors Interesting...however, these cases all happened on machines other than the PC that is running STF, and the adb keys were not copied/shared intentionally anywhere. I see how re-adding the key wasn't helping because of this limitation, but why did it initially happen?

Basically, if we're not actually trying to use the same keys on multiple PCs, do you see why this problem could arise? And how we can avoid it? Ah, so if a user forgot his/her login credentials and made a new login with new username but old adb keys, this issue would happen? So once we use active directory accounts and users can't just change their logins, this will stop happening?

That clears up everything, thank you very much! While some error message or feedback would be great to have in these cases, I consider this mystery solved and you may feel free to close the issue.  INF/device:plugins:touch 4553 [7d068e69] Launching screen service
INF/device:plugins:touch 4553 [7d068e69] Connecting to minitouch service
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "open: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event8 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event7 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event6 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/mouse2 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event3 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/mouse0 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event1 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event0 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/mice for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event5 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event4 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/mouse1 for inspectionopen: Permission denied"
INF/device:plugins:touch 4553 [7d068e69] minitouch says: "Unable to open device /dev/input/event2 for inspectionUnable to find a suitable touch device"
WRN/device:plugins:touch 4553 [7d068e69] Shell keeping minitouch running ended unexpectedly adb shell getevent -ilp:
could not open /dev/input/event8, Permission denied
could not open /dev/input/event7, Permission denied
could not open /dev/input/event6, Permission denied
could not open /dev/input/mouse2, Permission denied
could not open /dev/input/event3, Permission denied
could not open /dev/input/mouse0, Permission denied
could not open /dev/input/event1, Permission denied
could not open /dev/input/event0, Permission denied
could not open /dev/input/mice, Permission denied
could not open /dev/input/event5, Permission denied
could not open /dev/input/event4, Permission denied
could not open /dev/input/mouse1, Permission denied
could not open /dev/input/event2, Permission denied
===================================================
adb devices -l:
List of devices attached
7d068e69               device usb:1-1 product:gemini model:MI_5 device:gemini Yes. the MIUI version is :MIUI 8.1 | Stable 8.1.3.0(MAACNDI)
I have another XIAOMI 5,  version is: MIUI 7.3, it works well.
 Thank you for your help. I will flush 8.0 then try again. Maybe they've locked it  if 8.0 can run well on the same device, and I will post the result later. Yes. I used my MI account then enabled the setting "USB debugging (Security settings)", The device works well.     Thanks for your help.

![image](https://cloud.githubusercontent.com/assets/5362161/20514608/e84fa350-b0c7-11e6-8c79-c5105ee40c61.png)
 ha, MI is awesome Hey there , 
       I have the same issues , my MI 5s does't have the setting "USB debugging (Security settings)",MIUI Version : 8.0.18 

      adb devices -l : 
           129d5a98               device usb:336592896X product:capricorn model:MI_5s device:capricorn Updating MIUI V8.2.2.0.MAGCNDL , not sure it's have the setting...touch you later

updated to  MIUI V8.2.2.0.MAGCNDL and work fine ,thx~ In the initial versions V8.0 i added a MI accouunt, but it didn't show the option, the I update the MIUI Version to V8.2, it appears. I think this issue needs to be reopened. It doesn't work correctly even on my MI phone. I get the following error
```
[15:39:43] sudheeshsinganamalla:~ $ adb shell getevent -ilp
could not open /dev/input/event13, Permission denied
could not open /dev/input/event12, Permission denied
could not open /dev/input/event11, Permission denied
could not open /dev/input/event10, Permission denied
could not open /dev/input/event9, Permission denied
could not open /dev/input/event8, Permission denied
could not open /dev/input/event7, Permission denied
could not open /dev/input/event4, Permission denied
could not open /dev/input/mouse0, Permission denied
could not open /dev/input/event2, Permission denied
could not open /dev/input/event1, Permission denied
could not open /dev/input/mice, Permission denied
could not open /dev/input/event5, Permission denied
could not open /dev/input/event6, Permission denied
could not open /dev/input/event3, Permission denied
could not open /dev/input/event0, Permission denied
```

and on `stf` I receive the following information

```
FTL/device 45168 [5d89bf39] Setup had an error Error: Failed more than 3 times in 10000ms
    at TouchConsumer._failLimitExceeded (/Users/sudheeshsinganamalla/Documents/GameAutomators/stf/lib/units/device/plugins/touch/index.js:230:26)
    at FailCounter.emit (/Users/sudheeshsinganamalla/Documents/GameAutomators/stf/node_modules/eventemitter3/index.js:117:35)
    at FailCounter.inc (/Users/sudheeshsinganamalla/Documents/GameAutomators/stf/lib/util/failcounter.js:29:10)
    at TouchConsumer._outputEnded (/Users/sudheeshsinganamalla/Documents/GameAutomators/stf/lib/units/device/plugins/touch/index.js:223:24)
    at RiskyStream.emit (/Users/sudheeshsinganamalla/Documents/GameAutomators/stf/node_modules/eventemitter3/index.js:115:35)
    at RiskyStream.<anonymous> (/Users/sudheeshsinganamalla/Documents/GameAutomators/stf/lib/util/riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:188:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:80:11)
From previous event:
    at startConsumer (/Users/sudheeshsinganamalla/Documents/GameAutomators/stf/lib/units/device/plugins/touch/index.js:511:14)
    at /Users/sudheeshsinganamalla/Documents/GameAutomators/stf/lib/units/device/plugins/touch/index.js:526:12
    at SerialSyrup.ParallelSyrup.invoke (/Users/sudheeshsinganamalla/Documents/GameAutomators/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /Users/sudheeshsinganamalla/Documents/GameAutomators/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at _combinedTickCallback (internal/process/next_tick.js:73:7)
    at process._tickCallback (internal/process/next_tick.js:104:9)

INF/device:plugins:touch 45174 [5d89bf39] minitouch says: "Unable to open device /dev/input/event10 for inspectionopen: Permission denied"
INF/device:plugins:touch 45174 [5d89bf39] minitouch says: "Unable to open device /dev/input/event9 for inspectionopen: Permission denied"
INF/device:plugins:touch 45174 [5d89bf39] minitouch says: "Unable to open device /dev/input/event8 for inspectionopen: Permission denied"
INF/device:plugins:touch 45174 [5d89bf39] minitouch says: "Unable to open device /dev/input/event7 for inspectionopen: Permission denied"
INF/device:plugins:touch 45174 [5d89bf39] minitouch says: "Unable to open device /dev/input/event4 for inspectionopen: Permission denied"
INF/device:plugins:touch 45174 [5d89bf39] minitouch says: "Unable to open device /dev/input/mouse0 for inspectionopen: Permission denied"
``` @sorccu Yes, i've an MI account already registered on the phone and `adb devices` shows up the device name. It works perfectly fine with a Moto G phone.

<img width="1440" alt="screen shot 2017-03-31 at 3 53 10 pm" src="https://cloud.githubusercontent.com/assets/4545925/24546748/4feb0460-162a-11e7-84bc-686e479fc5ca.png">

<img width="1440" alt="screen shot 2017-03-31 at 3 53 03 pm" src="https://cloud.githubusercontent.com/assets/4545925/24546750/53d5c9fc-162a-11e7-9212-c53114844174.png">
 @sorccu Yes I received 3 warning screens holding up each screen for 5 seconds before the Next button is activated and it didn't show up. I just disconnected the cable and reconnected it and it seems to be working totally fine. 😄 Thank you !

Also is there an API for just using the `<device-screen>` on a seperate webpage ? I am also trying to get this working on Windows to contribute to `openstf` and facing a few issues with `libjpeg-turbo`  Hello,

We are running STF on Ubuntu 16.4, inside the docker.
It's a local run.

We are trying to connect more than 8 devices and it stop showing to us.
ADB devices:
List of devices attached
84B7N16804001148	device
4dfc4c8d3d785005	device
dd183316	device
a211579a	device
4df194c26c0b8f09	device
LGH850da459a86	device
F5AZCY05E419	device
df58b11703329c01	device

The other devices are not displayed, and it's a random device, depending on what we connect first.

Is this an Ubuntu problem or STF?
 so how strong suppose to be my PC to run more devices?
we use now:
i5-4590, 16G, with SSD

Or can you give us recommendation on server specs to run more devices?
 ok, tnx  Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/7.1.0/darwin/x64/zmq.node
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:573:32)
    at Object.Module._extensions..js (module.js:582:10)
    at Module.load (module.js:490:32)
    at tryModuleLoad (module.js:449:12)
    at Function.Module._load (module.js:441:3)
    at Module.require (module.js:500:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:573:32)
    at Object.Module._extensions..js (module.js:582:10)
    at Module.load (module.js:490:32)
    at tryModuleLoad (module.js:449:12)
    at Function.Module._load (module.js:441:3)
    at Module.require (module.js:500:17)
FTL/cli:local 11980 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 11980 [*] Shutting down all child processes
  Model: SAMSUNG-SM-N910A
OS	Android
Version	5.1.1
SDK	22
ABI	armeabi-v7a
Health	Good
Connected	Yes
Airplane Mode	No
Using Fallback	No
Roaming	No
Type	WIFI
Density	XXXHDPI
FPS	60
Browser - Chrome
OSX - El Capitan
----
After 5-10 seconds of using the UI, it disconnects. Reconnection works but the issue just loops.
Remaining idle, it does not disconnect and is fine.
Thank you.
 Here is the log:
```
INF/device:plugins:screen:stream 19449 [1627d05a] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
WRN/device:plugins:screen:stream 19449 [1627d05a] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 19449 [1627d05a] Disconnecting from minicap service
FTL/device:plugins:screen:stream 19449 [1627d05a] Frame producer had an error Error: Failed more than 3 times in 10000ms
    at FrameProducer._failLimitExceeded (/Users/my.username/.nvm/versions/node/v5.0.0/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:220:26)
    at FailCounter.emit (/Users/my.username/.nvm/versions/node/v5.0.0/lib/node_modules/stf/node_modules/eventemitter3/index.js:73:35)
    at FailCounter.inc (/Users/my.username/.nvm/versions/node/v5.0.0/lib/node_modules/stf/lib/util/failcounter.js:29:10)
    at FrameProducer._outputEnded (/Users/my.username/.nvm/versions/node/v5.0.0/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:213:24)
    at RiskyStream.emit (/Users/my.username/.nvm/versions/node/v5.0.0/lib/node_modules/stf/node_modules/eventemitter3/index.js:71:35)
    at RiskyStream.<anonymous> (/Users/my.username/.nvm/versions/node/v5.0.0/lib/node_modules/stf/lib/util/riskystream.js:14:12)
    at emitNone (events.js:72:20)
    at Socket.emit (events.js:166:7)
    at endReadableNT (_stream_readable.js:905:12)
    at doNTCallback2 (node.js:450:9)
    at process._tickCallback (node.js:364:17)
FTL/util:lifecycle 19449 [1627d05a] Shutting down due to fatal error
INF/provider 13279 [*] Cleaning up device worker "1627d05a"
ERR/provider 13279 [*] Device worker "1627d05a" died with code 1
INF/provider 13279 [*] Restarting device worker "1627d05a"
```
 You are right. I was wayyyy off the latest version.  Hi
The use of Bare Metal to install coreos, STF deployment of stand-alone normal, and clustering, "adb devices" can see the equipment, but STF does not display mobile phone. View **provider log** shows "**Filtered out device** ..."

$ sudo docker exec b714d3de2123 stf doctor
INF/util:doctor 10 [*] OS Arch: x64
INF/util:doctor 10 [*] OS Platform: linux
INF/util:doctor 10 [*] OS Platform: 4.7.3-coreos-r2
INF/util:doctor 10 [*] Using Node 6.9.1
INF/util:doctor 10 [*] Using RethinkDB client 2.3.3
INF/util:doctor 10 [*] Using ZeroMQ 4.1.4
WRN/util:doctor 10 [*] Executable was not found
WRN/util:doctor 10 [*] Executable was not found
WRN/util:doctor 10 [*] Executable was not found
INF/util:doctor 10 [*] GraphicsMagick 1.3.23


Look forward to your help!
  Hi ,
I Setup Stp as mentioned in Github, but when i connect my android device locally and open the url in browser -> Sign in  -> Connect to the android this appears:
<img width="1436" alt="screenshot 2016-11-14 15 05 35" src="https://cloud.githubusercontent.com/assets/5002269/20260550/2d76b250-aa80-11e6-9009-a6c6549e6489.png">
In Console this gets printed:
INF/util:datautil 1703 [*] Device database does not have an entry for "ZY222XRRBT" (model "XT1562"/"lux_retasia_ds"). This is not an error, it only means that we don't have data for it yet. @sorccu  You are right 
Error:
WebSocket connection to 'ws://localhost:7400/' failed: Error in connection establishment: net::ERR_CONNECTION_REFUSED
Please help to resolve this error.
 It appears that you may have your system misconfigured.   According to that error, you are trying to get the screen data from "localhost" instead of your server.   Unless you are testing on the machine you are running OpenSTF on, this won't work.

So, a couple of things to check.  First, in your nginx.conf, make sure that everything references the IP address of the server, and not "localhost".  (This includes the portion that defines the address of the provider service.)    Next, if you are starting it with systemd, make sure that you use the IP address of the server in all of the systemd configuration files.   Also, make sure that nginx is set up to serve the websocket data on port 7400.

The other thing that jumps out at me is that the URL above is "ws://localhost:7400".   If you followed the instructions on the web site, you should have been configured to use HTTPS.   The "ws://" portion tells the browser *NOT* to use an SSL connection to the server.   So, you want to make sure that, if the server is running on HTTPS, that you use "wss://" instead.

(Note : I am not a developer, just a fellow user trying to help out. ;) I met the same problem and succefully solved it. The probable reason is that you give a incorrect --screen-ws-url-pattern when starting the provider. this url is used for the web browser to get the device screen infos and show them on the web browser. need more infos to help you. Did you deploy openSTF in local mode or production mode？  Was able to setup STF using docker. But the devices connected to it are not being listed in the UI. Its showing an error window saying, 'Disconnected'. This is to setup stf locally. Also the operating system is windows 10.
This issue happens with all the devices we connected.
# adb devices -l
List of devices attached
192.168.1.24:5555      device product:YUPHORIA model:YU5010 device:YUPHORIA

'stf doctor' gave the following output:-
# stf doctor
INF/util:doctor 208 [*] OS Arch: x64
INF/util:doctor 208 [*] OS Platform: linux
INF/util:doctor 208 [*] OS Platform: 4.4.27-moby
INF/util:doctor 208 [*] Using Node 6.3.0
INF/util:doctor 208 [*] Using RethinkDB client 2.3.2
INF/util:doctor 208 [*] Using ZeroMQ 4.1.4
WRN/util:doctor 208 [*] Executable was not found
WRN/util:doctor 208 [*] Executable was not found
INF/util:doctor 208 [*] GraphicsMagick 1.3.23
INF/util:doctor 208 [*] Local ADB 1.0.32_
 Thanks sorccu. It was giving the following error:-
WebSocket connection to 'ws://10.185.1.34:7110/socket.io/?uip=%3A%3Affff%3A127.0.0.1&EIO=3&transport=websocket' failed: WebSocket is closed before the connection is established.

I removed the ip and ran stf again. Its still giving the error:-
1.43c0029….chunk.js:50606 WebSocket connection to 'ws://localhost:7110/socket.io/?uip=%3A%3Affff%3A127.0.0.1&EIO=3&transport=websocket' failed: Error in connection establishment: net::ERR_CONNECTION_REFUSED.

Could you please help?
 I had ran the following command to run stf:-
docker run  --privileged -itd --name stfpublic --link think_db:rethinkdb -p 7100:7100 -v /dev/bus/usb:/dev/bus/usb chuross/stf-adb stf local

I had used the dockerfile available in docker hub. Do I need to setup STF as mentioned in deployment guide? I am new to docker and I have no idea how to begin. :(
 I tried setting up STF as mentioned in deployment.md. I do not have any server where I can deploy it. What I did was created 2 virtual machines(Ubuntu) and set 2 different static ips for them. Created unit files as mentioned and started all the services. Tried accessing STF in browser using one of the ip(given in app-url). 
 Did not show any error but nothing got displayed.
  I'm new to these and not sure where I went wrong. Could you please help.  Hi,

I have installed stf on OS X 10.11.5, there's a problem while I pluged an phone,
The stf log print that it has found my devices, 
INF/provider 514 [*] Found device "03b5ee5ef0b59a18" (device)
and for a while follows as
INF/provider 514 [*] Providing all 0 of 1 device(s); ignoring "03b5ee5ef0b59a18"
And I can't see any device on the website
I have tried 3 different phones, and it appears the same result.

How can I solve this?  STF serivce can't run in SUMSUNG S6. STFservice haven't an ativity,and SUMSUNG OS is forbidden to this service.
The adb devicelist  is this:
0216026890651005       device product:zenltezc model:SM_G9280 device:zenltechn

errlog:
2016-11-09 11:47:30 INF/device:plugins:touch 30422 [3067e654] Launching screen service
2016-11-09 11:47:30 INF/device:plugins:touch 30422 [3067e654] Connecting to minitouch service
2016-11-09 11:47:30 INF/device:plugins:service 30437 [0216026890651005] Launching service
2016-11-09 11:47:30 INF/device:plugins:service 30437 [0216026890651005] Agent says: "Listening on @stfagent"
2016-11-09 11:47:30 INF/device:plugins:service 30437 [0216026890651005] Agent says: "InputClient started"
2016-11-09 11:47:31 INF/device:plugins:touch 30422 [3067e654] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
2016-11-09 11:47:31 FTL/device 30437 [0216026890651005] Setup had an error Error: Service had an error: "Error: Not found; no service started."
    at /var/stf/lib/units/device/plugins/service.js:101:23
From previous event:
    at /var/stf/lib/units/device/plugins/service.js:76:14
    at tryOnImmediate (timers.js:534:15)
    at processImmediate [as _immediateCallback] (timers.js:514:5)
2016-11-09 11:47:31 FTL/util:lifecycle 30437 [0216026890651005] Shutting down due to fatal error
2016-11-09 11:47:31 INF/provider 28442 [*] Cleaning up device worker "0216026890651005"
 I have upload the OS  and open 'OEM lock' where at Develop mode. But I don't know why or whether is this way to make it work.
 Hello, menu key can work in your sumsung device ?
Menu key cannot work in sumsung  s6 edge SM-G9250.   **What is the issue or idea you have?**
Touch event is performed at unexpected point on [LG V10](http://www.gsmarena.com/lg_v10-7606.php) device.

![](https://trello-attachments.s3.amazonaws.com/5821c82446dab358624dda27/5821c87125cfbc3a3c03e573/879e184e012639fa2a50f297408799f1/lg-v10-wrong-touch.gif)

There is an un-match resolution value between device data `1440x2560` and minitouch `1439x2719` in [log messages](https://gist.github.com/ledinhphuong/457a04cc24ffbcae86cd3a335a96e54b)

**Does it only happen on a specific device? Please run `adb devices -l` and paste the corresponding row.**
```bash
LGF600Lxxxxxxxx device usb:336855040X product:pplus_lgu_kr model:LG_F600L device:pplus
```

**Please provide the steps to reproduce the issue.**
* Run `rethinkdb --bind all`
* Run `stf local`
* Launch LG V10 device
* Install [Touch Screen Test](https://play.google.com/store/apps/details?id=jp.rallwell.siriuth.touchscreentest) (or similar) and launch it
* Touch (on STF's canvas)

**What is the expected behavior?**
It should perform at correct touched point.

**Do you see errors or warnings in the `stf local` output? If so, please paste them or the full log here.**
N/A

**Please run `stf doctor` and paste the output here.**
```bash
INF/util:doctor 94999 [*] OS Arch: x64
INF/util:doctor 94999 [*] OS Platform: darwin
INF/util:doctor 94999 [*] OS Platform: 15.6.0
INF/util:doctor 94999 [*] Using Node 6.9.1
INF/util:doctor 94999 [*] Using RethinkDB client 2.3.3
INF/util:doctor 94999 [*] Using ZeroMQ 4.1.5
INF/util:doctor 94999 [*] GraphicsMagick 1.3.25
INF/util:doctor 94999 [*] Local ADB 1.0.36

INF/util:doctor 94999 [*] ProtoBuf 3.1.0
ERR/util:doctor 94999 [*] Current ProtoBuf version is not supported, it has to be ~2
INF/util:doctor 94999 [*] Local RethinkDB server 2.3.5
```

Feel free to contact with me. Thanks I have same problem with LG V20 (H990). Not sure if is cheaper but the same issue occurs on LG-K500n (X screen).

![lgk500n](https://user-images.githubusercontent.com/3340954/31390877-5b067fd0-add5-11e7-9d9f-0637e89d1cda.gif)
 > it seems that there's an area above the usual menu bar that's part of the touch screen, yet operates as a separate tiny display for icons. It seems like the coordinates are off by just about the height of the icon area.

It is true for LG X screen, there is an tiny LCD above the normal one. By default it displays status bar icons when main screen is off and owner's name when it is on.
And the offset seems to be equal to a height of a tiny screen.
So correcting touched point coordinate by the height of that screen can fix this issue.

> It would be great if you guys could ask your respective companies to donate to the project to cover the costs.

I can't make such donation but can try to implement some fix.

On that device, display height reported by [Display#getRealSize()](https://developer.android.com/reference/android/view/Display.html) is smaller than [Motion range](https://developer.android.com/reference/android/view/InputDevice.html#getMotionRange(int)) for AXIS_Y. While on device w/o additional screen they are equal. Maybe that can be starting point. Both input device and screen resolutions and can be obtained via API, so it seems to be possible to use them. Any advice, where is the right place in the code to add that offset?
I can try to figure out how to calculate it and make a PR fixing this issue. I meant `figure out how to calculate it` rather than hardcoding. ```WINDOW MANAGER LAST ANR (dumpsys window lastanr)
  <no ANR has occurred since boot>

WINDOW MANAGER POLICY STATE (dumpsys window policy)
    mSafeMode=false mSystemReady=true mSystemBooted=true
    mLidState=-1 mLidOpenRotation=-1 mCameraLensCoverState=-1 mHdmiPlugged=false
    mLastSystemUiFlags=0x1608600 mResettingSystemUiFlags=0x0 mForceClearedSystemUiFlags=0x0
    mWakeGestureEnabledSetting=true
    mSupportAutoRotation=true
    mUiMode=1 mDockMode=0 mCarDockRotation=-1 mDeskDockRotation=-1
    mUserRotationMode=0 mUserRotation=0 mAllowAllRotations=0
    mCurrentAppOrientation=5
    mCarDockEnablesAccelerometer=true mDeskDockEnablesAccelerometer=true
    mLidKeyboardAccessibility=0 mLidNavigationAccessibility=0 mLidControlsSleep=false
    mShortPressOnPowerBehavior=1 mLongPressOnPowerBehavior=1
    mDoublePressOnPowerBehavior=0 mTriplePressOnPowerBehavior=0
    mHasSoftInput=true
    mAwake=true
    mScreenOnEarly=true mScreenOnFully=true
    mKeyguardDrawComplete=true mWindowManagerDrawComplete=true
    mOrientationSensorEnabled=true
    mOverscanScreen=(0,0) 720x1280
    mRestrictedOverscanScreen=(0,0) 720x1184
    mUnrestrictedScreen=(0,0) 720x1280
    mRestrictedScreen=(0,0) 720x1184
    mStableFullscreen=(0,0)-(720,1184)
    mStable=(0,48)-(720,1184)
    mSystem=(0,0)-(720,1280)
    mCur=(0,48)-(720,1184)
    mContent=(0,48)-(720,1184)
    mVoiceContent=(0,48)-(720,1184)
    mDock=(0,48)-(720,1184)
    mDockLayer=268435456 mStatusBarLayer=161010
    mShowingLockscreen=true mShowingDream=false mDreamingLockscreen=true mDreamingSleepToken=null
    mStatusBar=Window{b78ce30 u0 StatusBar} isStatusBarKeyguard=true
    mNavigationBar=Window{d766f06 u0 NavigationBar}
    mFocusedWindow=Window{b78ce30 u0 StatusBar}
    mTopFullscreenOpaqueWindowState=Window{8f89a30 u0 com.lge.launcher3/com.lge.launcher3.LauncherExtension}
    mTopFullscreenOpaqueOrDimmingWindowState=Window{8f89a30 u0 com.lge.launcher3/com.lge.launcher3.LauncherExtension}
    mTopIsFullscreen=false mHideLockScreen=false
    mForceStatusBar=false mForceStatusBarFromKeyguard=true
    mDismissKeyguard=0 mWinDismissingKeyguard=null mHomePressed=false
    mAllowLockscreenWhenOn=false mLockScreenTimeout=120000 mLockScreenTimerActive=false
    mEndcallBehavior=2 mIncallPowerBehavior=1 mLongPressOnHomeBehavior=2
    mLandscapeRotation=1 mSeascapeRotation=3
    mPortraitRotation=0 mUpsideDownRotation=2
    mDemoHdmiRotation=1 mDemoHdmiRotationLock=false
    mUndockedHdmiRotation=-1
    mKeyMapping.size=0
    BarController.StatusBar
      mState=WINDOW_STATE_SHOWING
      mTransientBar=TRANSIENT_BAR_NONE
    BarController.NavigationBar
      mState=WINDOW_STATE_HIDDEN
      mTransientBar=TRANSIENT_BAR_NONE
    PolicyControl.sImmersiveStatusFilter=null
    PolicyControl.sImmersiveNavigationFilter=null
    PolicyControl.sImmersivePreconfirmationsFilter=null
    WakeGestureListener
      mTriggerRequested=false
      mSensor=null
    WindowOrientationListener
      mEnabled=true
      mCurrentRotation=0
      mSensorType=@0
      mSensor={Sensor name="LGE 3-axis Accelerometer", vendor="STMicroelectronics", version=1, type=1, maxRange=78.4532, resolution=0.0, power=0.033, minDelay=10000}
      mRate=2
      AccelSensorJudge
        mProposedRotation=-1
        mPredictedRotation=-1
        mLastFilteredX=-0.14915289
        mLastFilteredY=-0.17744154
        mLastFilteredZ=9.7459955
        mLastFilteredTimestampNanos=734680207344490 (13.105729ms ago)
        mTiltHistory={last: 89.0}
        mFlat=true
        mSwinging=false
        mAccelerating=false
        mOverhead=false
        mTouched=false
        mTiltToleranceConfig=[[-25, 70], [-25, 65], [-25, 60], [-25, 65]]
    KeyguardServiceDelegate
      showing=true
      showingAndNotOccluded=false
      inputRestricted=true
      occluded=false
      secure=false
      dreaming=false
      systemIsReady=true
      deviceHasKeyguard=true
      enabled=false
      offReason=3
      currentUser=0
      bootCompleted=true
      screenState=2
      interactiveState=2
      KeyguardStateMonitor
        mIsShowing=true
        mSimSecure=false
        mInputRestricted=true
        mCurrentUserId=0
     mMenuLongPressEnabled=true
     mRecentKeyLongpressEnabled=true
     mRearSideKeyEnable =false
     mHWMenuKeyDB =0
     sSupporLightSensor=true
     mVolumeKeyShortcutStatus=1
     mVolumeKeyUpDownComboEnabled=false
     sVolumeUpKeyShortcutAction=2
     sVolumeDownKeyShortcutAction=1
     mVolumeKeyLongPressEnabled=true
     mVolumeKeyDoublePressEnabled=true
     mSimSwitchingKey=false
     mFourthKeySharing=false
     mAccelSensorNotSupported=false
     mSupportQuickMemo=true
     mQuickMemoInstalled=true
     mHotKeyCustomizing=false
     mHotKeyLongPressEnabled=false
     mHotKeyMode=0
     mHomeKeyExceptionInECMMode=false
         mScreenOffKey=true
     sKeyExceptionWinState=Window{8f89a30 u0 com.lge.launcher3/com.lge.launcher3.LauncherExtension}
     sPowerKeyScreenOnInCalling=true
     mHWKeyControlMode=false
     mRestartActionConfigEnabled=false
     mPowerVolumeDownReset=true
     mSupportForcedPowerOff=false
     mDualWindowKeyStatus=0
     mDualWindowByBackLongPressed=false

WINDOW MANAGER ANIMATOR STATE (dumpsys window animator)
    DisplayContentsAnimator #0:
      Window #0: WindowStateAnimator{a388439 com.android.systemui.ImageWallpaper}
      Window #1: WindowStateAnimator{f6fda7e com.android.settings/com.android.settings.applications.InstalledAppDetails}
      Window #2: WindowStateAnimator{2a69bdf com.android.settings/com.android.settings.SubSettings}
      Window #3: WindowStateAnimator{1e8802c com.android.settings/com.lge.settings.easy.EasySettings}
      Window #4: WindowStateAnimator{5142af5 com.android.settings/com.android.settings.Settings$ManageApplicationsActivity}
      Window #5: WindowStateAnimator{d2b208a com.ohmibod.remote2/com.ohmibod.remote2.PlayActivity}
      Window #6: WindowStateAnimator{40316fb com.ohmibod.remote2/com.ohmibod.remote2.MainActivity}
      Window #7: WindowStateAnimator{7737318 com.android.systemui/com.android.systemui.recents.RecentsActivity}
      Window #8: WindowStateAnimator{5c98171 com.lge.launcher3/com.lge.launcher3.LauncherExtension}
      Window #9: WindowStateAnimator{aa2bb56 InputMethod}
      Window #10: WindowStateAnimator{6e227d7 AssistPreviewPanel}
      Window #11: WindowStateAnimator{db8a8c4 ClipTray}
      Window #12: WindowStateAnimator{6a3c3ad CliptrayCue}
      Window #13: WindowStateAnimator{e2736e2 SecondScreen_StatusBar_com.android.systemui (0)}
      Window #14: WindowStateAnimator{e376a73 KeyguardScrim}
      Window #15: WindowStateAnimator{7f98d30 SecondScreen_Base_com.lge.signboard (0)}
      Window #16: WindowStateAnimator{165eda9 SecondScreen_System_com.lge.signboard (0)}
      Window #17: WindowStateAnimator{85df2e SurfaceView}
      Window #18: WindowStateAnimator{e943acf StatusBar}
      Window #19: WindowStateAnimator{a224c5c NavigationBar}


    mBulkUpdateParams=0x8 ORIENTATION_CHANGE_COMPLETE

WINDOW MANAGER SESSIONS (dumpsys window sessions)
  Session Session{18d8d22 906:u0a10125}:
    mNumWindow=2 mClientDead=false mSurfaceSession=android.view.SurfaceSession@f06bb65
  Session Session{2cf7056 4465:u0a10033}:
    mNumWindow=1 mClientDead=false mSurfaceSession=android.view.SurfaceSession@814c03a
  Session Session{325dc41 4253:u0a10025}:
    mNumWindow=1 mClientDead=false mSurfaceSession=android.view.SurfaceSession@a43b4eb
  Session Session{3523da1 1659:1000}:
    mNumWindow=1 mClientDead=false mSurfaceSession=android.view.SurfaceSession@8b5d248
  Session Session{44cc373 13259:1000}:
    mNumWindow=4 mClientDead=false mSurfaceSession=android.view.SurfaceSession@72ca8e1
  Session Session{53fa0ad 3610:u0a10040}:
    mNumWindow=7 mClientDead=false mSurfaceSession=android.view.SurfaceSession@87ea606
  Session Session{a2f0b84 4404:1001}:
    mNumWindow=0 mClientDead=false mSurfaceSession=android.view.SurfaceSession@326b4c7
  Session Session{bca7e8a 3616:1000}:
    mNumWindow=2 mClientDead=false mSurfaceSession=android.view.SurfaceSession@b79caf4
  Session Session{e1a8528 4292:1000}:
    mNumWindow=2 mClientDead=false mSurfaceSession=android.view.SurfaceSession@b69f21d


WINDOW MANAGER DISPLAY CONTENTS (dumpsys window displays)
  Display: mDisplayId=0
    init=720x1360 320dpi cur=720x1280 app=720x1184 rng=720x672-1104x1056
    deferred=false layoutNeeded=false
  mStacks[1]0
    mStackId=0
    mDeferDetach=false
    {taskId=60 appTokens=[AppWindowToken{1029184 token=Token{e733b97 ActivityRecord{9c0c616 u0 com.android.systemui/.recents.RecentsActivity t60}}}] mdr=false}
    {taskId=55 appTokens=[AppWindowToken{769d636 token=Token{1e2bbd1 ActivityRecord{55d9af8 u0 com.lge.launcher3/.LauncherExtension t55}}}] mdr=false}
  mStacks[0]11
    mStackId=11
    mDeferDetach=false
    {taskId=146 appTokens=[AppWindowToken{6b909da token=Token{265aaf7 ActivityRecord{103d6f6 u0 com.android.settings/.Settings$ManageApplicationsActivity t146}}}, AppWindowToken{337f383 token=Token{1befa32 ActivityRecord{2a13fe7 u0 com.android.settings/.applications.InstalledAppDetails t146}}}, AppWindowToken{bef7992 token=Token{d0da31d ActivityRecord{d899ff4 u0 com.android.settings/.SubSettings t146}}}] mdr=false}
    {taskId=149 appTokens=[AppWindowToken{8957f27 token=Token{bf04f28 ActivityRecord{ed8994b u0 com.android.settings/com.lge.settings.easy.EasySettings t149}}}, AppWindowToken{9c35839 token=Token{7b6c800 ActivityRecord{92c8e83 u0 com.android.settings/.Settings$ManageApplicationsActivity t149}}}] mdr=false}
    {taskId=150 appTokens=[AppWindowToken{1164d1d token=Token{302b1f4 ActivityRecord{736d7c7 u0 com.android.vending/com.google.android.finsky.activities.MainActivity t150}}}] mdr=false}
    {taskId=152 appTokens=[AppWindowToken{521d2ff token=Token{41712a0 ActivityRecord{d4adfa3 u0 com.ohmibod.remote2/.PlayActivity t152}}}, AppWindowToken{3ecef01 token=Token{e10dce8 ActivityRecord{78fc60b u0 com.ohmibod.remote2/.MainActivity t152}}}] mdr=false}

  Application tokens in top down Z order:
  mStackId=0
    mTaskId=55
    Activity #0 AppWindowToken{769d636 token=Token{1e2bbd1 ActivityRecord{55d9af8 u0 com.lge.launcher3/.LauncherExtension t55}}}:
      windows=[Window{8f89a30 u0 com.lge.launcher3/com.lge.launcher3.LauncherExtension}]
      windowType=2 hidden=false hasVisible=true
      app=true voiceInteraction=false
      allAppWindows=[Window{8f89a30 u0 com.lge.launcher3/com.lge.launcher3.LauncherExtension}]
      task={taskId=55 appTokens=[AppWindowToken{769d636 token=Token{1e2bbd1 ActivityRecord{55d9af8 u0 com.lge.launcher3/.LauncherExtension t55}}}] mdr=false}
       appFullscreen=true requestedOrientation=5
      hiddenRequested=false clientHidden=false willBeHidden=false reportedDrawn=true reportedVisible=true
      numInterestingWindows=1 numDrawnWindows=1 inPendingTransaction=false allDrawn=true (animator=true)
      startingData=null removed=false firstWindowDrawn=true mIsExiting=false
    mTaskId=60
    Activity #0 AppWindowToken{1029184 token=Token{e733b97 ActivityRecord{9c0c616 u0 com.android.systemui/.recents.RecentsActivity t60}}}:
      windows=[Window{6f63b4 u0 com.android.systemui/com.android.systemui.recents.RecentsActivity}]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      allAppWindows=[Window{6f63b4 u0 com.android.systemui/com.android.systemui.recents.RecentsActivity}]
      task={taskId=60 appTokens=[AppWindowToken{1029184 token=Token{e733b97 ActivityRecord{9c0c616 u0 com.android.systemui/.recents.RecentsActivity t60}}}] mdr=false}
       appFullscreen=true requestedOrientation=3
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=1 numDrawnWindows=1 inPendingTransaction=false allDrawn=true (animator=true)
      startingData=com.android.server.wm.StartingData@19faedb removed=false firstWindowDrawn=true mIsExiting=false
  mStackId=11
    mTaskId=152
    Activity #1 AppWindowToken{3ecef01 token=Token{e10dce8 ActivityRecord{78fc60b u0 com.ohmibod.remote2/.MainActivity t152}}}:
      windows=[Window{a8eb83 u0 com.ohmibod.remote2/com.ohmibod.remote2.MainActivity}]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      allAppWindows=[Window{a8eb83 u0 com.ohmibod.remote2/com.ohmibod.remote2.MainActivity}]
      task={taskId=152 appTokens=[AppWindowToken{521d2ff token=Token{41712a0 ActivityRecord{d4adfa3 u0 com.ohmibod.remote2/.PlayActivity t152}}}, AppWindowToken{3ecef01 token=Token{e10dce8 ActivityRecord{78fc60b u0 com.ohmibod.remote2/.MainActivity t152}}}] mdr=false}
       appFullscreen=true requestedOrientation=1
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=2 numDrawnWindows=2 inPendingTransaction=false allDrawn=true (animator=true)
      startingData=null removed=false firstWindowDrawn=true mIsExiting=false
    Activity #0 AppWindowToken{521d2ff token=Token{41712a0 ActivityRecord{d4adfa3 u0 com.ohmibod.remote2/.PlayActivity t152}}}:
      windows=[Window{8880fc9 u0 com.ohmibod.remote2/com.ohmibod.remote2.PlayActivity}]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      allAppWindows=[Window{8880fc9 u0 com.ohmibod.remote2/com.ohmibod.remote2.PlayActivity}]
      task={taskId=152 appTokens=[AppWindowToken{521d2ff token=Token{41712a0 ActivityRecord{d4adfa3 u0 com.ohmibod.remote2/.PlayActivity t152}}}, AppWindowToken{3ecef01 token=Token{e10dce8 ActivityRecord{78fc60b u0 com.ohmibod.remote2/.MainActivity t152}}}] mdr=false}
       appFullscreen=true requestedOrientation=1
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=2 numDrawnWindows=2 inPendingTransaction=false allDrawn=true (animator=true)
      startingData=null removed=false firstWindowDrawn=true mIsExiting=false
    mTaskId=150
    Activity #0 AppWindowToken{1164d1d token=Token{302b1f4 ActivityRecord{736d7c7 u0 com.android.vending/com.google.android.finsky.activities.MainActivity t150}}}:
      windows=[]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      task={taskId=150 appTokens=[AppWindowToken{1164d1d token=Token{302b1f4 ActivityRecord{736d7c7 u0 com.android.vending/com.google.android.finsky.activities.MainActivity t150}}}] mdr=false}
       appFullscreen=true requestedOrientation=-1
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=1 numDrawnWindows=1 inPendingTransaction=false allDrawn=true (animator=true)
    mTaskId=149
    Activity #1 AppWindowToken{9c35839 token=Token{7b6c800 ActivityRecord{92c8e83 u0 com.android.settings/.Settings$ManageApplicationsActivity t149}}}:
      windows=[Window{6bb305c u0 com.android.settings/com.android.settings.Settings$ManageApplicationsActivity}]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      allAppWindows=[Window{6bb305c u0 com.android.settings/com.android.settings.Settings$ManageApplicationsActivity}]
      task={taskId=149 appTokens=[AppWindowToken{8957f27 token=Token{bf04f28 ActivityRecord{ed8994b u0 com.android.settings/com.lge.settings.easy.EasySettings t149}}}, AppWindowToken{9c35839 token=Token{7b6c800 ActivityRecord{92c8e83 u0 com.android.settings/.Settings$ManageApplicationsActivity t149}}}] mdr=false}
       appFullscreen=true requestedOrientation=-1
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=1 numDrawnWindows=1 inPendingTransaction=false allDrawn=true (animator=true)
      startingData=null removed=false firstWindowDrawn=true mIsExiting=false
    Activity #0 AppWindowToken{8957f27 token=Token{bf04f28 ActivityRecord{ed8994b u0 com.android.settings/com.lge.settings.easy.EasySettings t149}}}:
      windows=[Window{8fd83e9 u0 com.android.settings/com.lge.settings.easy.EasySettings}]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      allAppWindows=[Window{8fd83e9 u0 com.android.settings/com.lge.settings.easy.EasySettings}]
      task={taskId=149 appTokens=[AppWindowToken{8957f27 token=Token{bf04f28 ActivityRecord{ed8994b u0 com.android.settings/com.lge.settings.easy.EasySettings t149}}}, AppWindowToken{9c35839 token=Token{7b6c800 ActivityRecord{92c8e83 u0 com.android.settings/.Settings$ManageApplicationsActivity t149}}}] mdr=false}
       appFullscreen=true requestedOrientation=-1
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=2 numDrawnWindows=2 inPendingTransaction=false allDrawn=true (animator=true)
      startingData=null removed=false firstWindowDrawn=true mIsExiting=false
    mTaskId=146
    Activity #2 AppWindowToken{bef7992 token=Token{d0da31d ActivityRecord{d899ff4 u0 com.android.settings/.SubSettings t146}}}:
      windows=[Window{8977589 u0 com.android.settings/com.android.settings.SubSettings}]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      allAppWindows=[Window{8977589 u0 com.android.settings/com.android.settings.SubSettings}]
      task={taskId=146 appTokens=[AppWindowToken{6b909da token=Token{265aaf7 ActivityRecord{103d6f6 u0 com.android.settings/.Settings$ManageApplicationsActivity t146}}}, AppWindowToken{337f383 token=Token{1befa32 ActivityRecord{2a13fe7 u0 com.android.settings/.applications.InstalledAppDetails t146}}}, AppWindowToken{bef7992 token=Token{d0da31d ActivityRecord{d899ff4 u0 com.android.settings/.SubSettings t146}}}] mdr=false}
       appFullscreen=true requestedOrientation=-1
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=2 numDrawnWindows=2 inPendingTransaction=false allDrawn=true (animator=true)
      startingData=null removed=false firstWindowDrawn=true mIsExiting=false
    Activity #1 AppWindowToken{337f383 token=Token{1befa32 ActivityRecord{2a13fe7 u0 com.android.settings/.applications.InstalledAppDetails t146}}}:
      windows=[Window{32623cf u0 com.android.settings/com.android.settings.applications.InstalledAppDetails}]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      allAppWindows=[Window{32623cf u0 com.android.settings/com.android.settings.applications.InstalledAppDetails}]
      task={taskId=146 appTokens=[AppWindowToken{6b909da token=Token{265aaf7 ActivityRecord{103d6f6 u0 com.android.settings/.Settings$ManageApplicationsActivity t146}}}, AppWindowToken{337f383 token=Token{1befa32 ActivityRecord{2a13fe7 u0 com.android.settings/.applications.InstalledAppDetails t146}}}, AppWindowToken{bef7992 token=Token{d0da31d ActivityRecord{d899ff4 u0 com.android.settings/.SubSettings t146}}}] mdr=false}
       appFullscreen=true requestedOrientation=-1
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=1 numDrawnWindows=1 inPendingTransaction=false allDrawn=true (animator=true)
      startingData=null removed=false firstWindowDrawn=true mIsExiting=false
    Activity #0 AppWindowToken{6b909da token=Token{265aaf7 ActivityRecord{103d6f6 u0 com.android.settings/.Settings$ManageApplicationsActivity t146}}}:
      windows=[]
      windowType=2 hidden=true hasVisible=true
      app=true voiceInteraction=false
      task={taskId=146 appTokens=[AppWindowToken{6b909da token=Token{265aaf7 ActivityRecord{103d6f6 u0 com.android.settings/.Settings$ManageApplicationsActivity t146}}}, AppWindowToken{337f383 token=Token{1befa32 ActivityRecord{2a13fe7 u0 com.android.settings/.applications.InstalledAppDetails t146}}}, AppWindowToken{bef7992 token=Token{d0da31d ActivityRecord{d899ff4 u0 com.android.settings/.SubSettings t146}}}] mdr=false}
       appFullscreen=true requestedOrientation=-1
      hiddenRequested=true clientHidden=true willBeHidden=false reportedDrawn=false reportedVisible=false
      numInterestingWindows=0 numDrawnWindows=0 inPendingTransaction=false allDrawn=true (animator=true)



WINDOW MANAGER TOKENS (dumpsys window tokens)
  All tokens:
  WindowToken{a65d78 null}
  AppWindowToken{3ecef01 token=Token{e10dce8 ActivityRecord{78fc60b u0 com.ohmibod.remote2/.MainActivity t152}}}
  AppWindowToken{bef7992 token=Token{d0da31d ActivityRecord{d899ff4 u0 com.android.settings/.SubSettings t146}}}
  AppWindowToken{6b909da token=Token{265aaf7 ActivityRecord{103d6f6 u0 com.android.settings/.Settings$ManageApplicationsActivity t146}}}
  AppWindowToken{769d636 token=Token{1e2bbd1 ActivityRecord{55d9af8 u0 com.lge.launcher3/.LauncherExtension t55}}}
  WindowToken{a208c51 android.os.Binder@a4f60da}
  AppWindowToken{521d2ff token=Token{41712a0 ActivityRecord{d4adfa3 u0 com.ohmibod.remote2/.PlayActivity t152}}}
  AppWindowToken{8957f27 token=Token{bf04f28 ActivityRecord{ed8994b u0 com.android.settings/com.lge.settings.easy.EasySettings t149}}}
  AppWindowToken{9c35839 token=Token{7b6c800 ActivityRecord{92c8e83 u0 com.android.settings/.Settings$ManageApplicationsActivity t149}}}
  AppWindowToken{1029184 token=Token{e733b97 ActivityRecord{9c0c616 u0 com.android.systemui/.recents.RecentsActivity t60}}}
  AppWindowToken{1164d1d token=Token{302b1f4 ActivityRecord{736d7c7 u0 com.android.vending/com.google.android.finsky.activities.MainActivity t150}}}
  AppWindowToken{337f383 token=Token{1befa32 ActivityRecord{2a13fe7 u0 com.android.settings/.applications.InstalledAppDetails t146}}}
  WindowToken{2429cb6 android.os.Binder@96af31b}
  WindowToken{ce05db7 android.os.BinderProxy@9170f73}

  Wallpaper tokens:
  Wallpaper #0 WindowToken{2429cb6 android.os.Binder@96af31b}

WINDOW MANAGER WINDOWS (dumpsys window windows)
  Window #19 Window{d766f06 u0 NavigationBar}:
    mDisplayId=0 stackId=0 mSession=Session{53fa0ad 3610:u0a10040} mClient=android.os.BinderProxy@371f5e1
    mOwnerUid=10040 mShowToOwnerOnly=false package=com.android.systemui appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#20 ty=2019 fl=#21840068 fmt=-3 clr=0x1}
    Requested w=720 h=96 mLayoutSeq=6957
    mHasSurface=false mShownFrame=[0.0,1184.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{a224c5c NavigationBar}:
      mAnimating=false mLocalAnimating=false mAnimationIsEntrance=true mAnimation=null
  Window #18 Window{b78ce30 u0 StatusBar}:
    mDisplayId=0 stackId=0 mSession=Session{53fa0ad 3610:u0a10040} mClient=android.os.BinderProxy@9170f73
    mOwnerUid=10040 mShowToOwnerOnly=false package=com.android.systemui appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) gr=#30 sim=#10 ty=2000 fl=#81860060 pfl=0x400 fmt=-3 or=5 vsysui=0x1600600 if=0x4 userActivityTimeout=10000 clr=0x1}
    Requested w=720 h=48 mLayoutSeq=6974
    mHasSurface=true mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=true
    WindowStateAnimator{e943acf StatusBar}:
      mAnimating=false mLocalAnimating=false mAnimationIsEntrance=true mAnimation=null
      Surface: shown=true layer=161010 alpha=1.0 rect=(0.0,0.0) 720.0 x 1280.0
    mLastFreezeDuration=+2d13h21m29s428ms
  Window #17 Window{a9fd924 u0 SurfaceView}:
    mDisplayId=0 stackId=0 mSession=Session{53fa0ad 3610:u0a10040} mClient=android.os.BinderProxy@4fc64f3
    mOwnerUid=10040 mShowToOwnerOnly=true package=null appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(720x1280) gr=#800033 ty=1001 fl=#4218 pfl=0x40 fmt=-3 clr=0x1}
    Requested w=720 h=1280 mLayoutSeq=6974
    mAttachedWindow=Window{b78ce30 u0 StatusBar} mLayoutAttached=true
    mHasSurface=true mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=true
    WindowStateAnimator{85df2e SurfaceView}:
      Surface: shown=true layer=161005 alpha=1.0 rect=(0.0,0.0) 720.0 x 1280.0
    mLastFreezeDuration=+1h52m3s855ms
  Window #16 Window{9c16423 u0 SecondScreen_System_com.lge.signboard (0)}:
    mDisplayId=0 stackId=0 mSession=Session{bca7e8a 3616:1000} mClient=android.os.BinderProxy@3fb4952
    mOwnerUid=1000 mShowToOwnerOnly=true package=com.lge.signboard appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) gr=#11 sim=#20 ty=3004 fl=#1840008 wanim=0x1030383 clr=0x1}
    Requested w=720 h=80 mLayoutSeq=6935
    mHasSurface=false mShownFrame=[0.0,-80.0][720.0,0.0] isReadyForDisplay()=false
    WindowStateAnimator{165eda9 SecondScreen_System_com.lge.signboard (0)}:
  Window #15 Window{6d9f956 u0 SecondScreen_Base_com.lge.signboard (0)}:
    mDisplayId=0 stackId=0 mSession=Session{bca7e8a 3616:1000} mClient=android.os.BinderProxy@b7ef771
    mOwnerUid=1000 mShowToOwnerOnly=true package=com.lge.signboard appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) gr=#11 sim=#20 ty=3001 fl=#1840008 wanim=0x1030383 clr=0x1 statusbarl=true}
    Requested w=720 h=80 mLayoutSeq=6974
    mHasSurface=true mShownFrame=[0.0,-80.0][720.0,0.0] isReadyForDisplay()=true
    WindowStateAnimator{7f98d30 SecondScreen_Base_com.lge.signboard (0)}:
      Surface: shown=true layer=141005 alpha=1.0 rect=(0.0,-80.0) 720.0 x 80.0
    mLastFreezeDuration=+143ms
  Window #14 Window{d08f6b4 u0 KeyguardScrim}:
    mDisplayId=0 stackId=0 mSession=Session{3523da1 1659:1000} mClient=android.view.ViewRootImplAO$WEx@b8c3787
    mOwnerUid=1000 mShowToOwnerOnly=false package=android appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#10 ty=2029 fl=#1110900 pfl=0x1 fmt=-3 or=5 vsysui=0x3610000 clr=0x1}
    Requested w=720 h=1184 mLayoutSeq=35
    mHasSurface=false mShownFrame=[0.0,0.0][720.0,1184.0] isReadyForDisplay()=false
    WindowStateAnimator{e376a73 KeyguardScrim}:
  Window #13 Window{e35b98b u0 SecondScreen_StatusBar_com.android.systemui (0)}:
    mDisplayId=0 stackId=0 mSession=Session{53fa0ad 3610:u0a10040} mClient=android.os.BinderProxy@86f735a
    mOwnerUid=10040 mShowToOwnerOnly=false package=com.android.systemui appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) gr=#11 sim=#20 ty=3002 fl=#1840008 wanim=0x103045b clr=0x1 statusbarl=true}
    Requested w=720 h=80 mLayoutSeq=6974
    mHasSurface=true mShownFrame=[0.0,-80.0][720.0,0.0] isReadyForDisplay()=true
    WindowStateAnimator{e2736e2 SecondScreen_StatusBar_com.android.systemui (0)}:
      Surface: shown=true layer=131000 alpha=1.0 rect=(0.0,-80.0) 720.0 x 80.0
    mLastFreezeDuration=+289ms
  Window #12 Window{94c7335 u0 CliptrayCue}:
    mDisplayId=0 stackId=0 mSession=Session{e1a8528 4292:1000} mClient=android.os.BinderProxy@cafc16c
    mOwnerUid=1000 mShowToOwnerOnly=false package=com.lge.systemservice appop=NONE
    mAttrs=WM.LayoutParams{(0,580)(37x114) gr=#55 sim=#30 ty=2008 fl=#1040228 fmt=1 clr=0x1}
    Requested w=0 h=0 mLayoutSeq=4638
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][0.0,0.0] isReadyForDisplay()=false
    WindowStateAnimator{6a3c3ad CliptrayCue}:
      mShownAlpha=0.0 mAlpha=1.0 mLastAlpha=0.0
  Window #11 Window{597917d u0 ClipTray}:
    mDisplayId=0 stackId=0 mSession=Session{e1a8528 4292:1000} mClient=android.os.BinderProxy@d26cbd4
    mOwnerUid=1000 mShowToOwnerOnly=false package=com.lge.systemservice appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(720x580) gr=#53 sim=#30 ty=2008 fl=#1040228 fmt=1 wanim=0x7f0a0001 clr=0x1}
    Requested w=0 h=0 mLayoutSeq=4636
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][0.0,0.0] isReadyForDisplay()=false
    WindowStateAnimator{db8a8c4 ClipTray}:
      mShownAlpha=0.0 mAlpha=1.0 mLastAlpha=0.0
  Window #10 Window{e1e5c63 u0 AssistPreviewPanel}:
    mDisplayId=0 stackId=0 mSession=Session{53fa0ad 3610:u0a10040} mClient=android.os.BinderProxy@acbfa92
    mOwnerUid=10040 mShowToOwnerOnly=true package=com.android.systemui appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillx500) gr=#800053 sim=#31 ty=2033 fl=#1000118 fmt=-3 vsysui=0x700 clr=0x1}
    Requested w=0 h=0 mLayoutSeq=4645
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][0.0,0.0] isReadyForDisplay()=false
    WindowStateAnimator{6e227d7 AssistPreviewPanel}:
      mShownAlpha=0.0 mAlpha=1.0 mLastAlpha=0.0
  Window #9 Window{a459dd4 u0 InputMethod}:
    mDisplayId=0 stackId=0 mSession=Session{325dc41 4253:u0a10025} mClient=android.os.BinderProxy@8048727
    mOwnerUid=10025 mShowToOwnerOnly=true package=com.lge.ime appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxwrap) gr=#50 sim=#20 ty=2011 fl=#1800108 pfl=0x10000 fmt=-2 wanim=0x1030056 vsysui=0x300 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1151 mLayoutSeq=6890
    mIsImWindow=true mIsWallpaper=false mIsFloatingLayer=true mWallpaperVisible=false
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,129.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{aa2bb56 InputMethod}:
      mShownAlpha=1.0 mAlpha=1.0 mLastAlpha=0.0
  Window #8 Window{8f89a30 u0 com.lge.launcher3/com.lge.launcher3.LauncherExtension}:
    mDisplayId=0 stackId=0 mSession=Session{2cf7056 4465:u0a10033} mClient=android.os.BinderProxy@8c68b73
    mOwnerUid=10033 mShowToOwnerOnly=true package=com.lge.launcher3 appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#120 ty=1 fl=#81910100 fmt=-3 wanim=0x103045b vsysui=0x700 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1280 mLayoutSeq=6974
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=true mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{5c98171 com.lge.launcher3/com.lge.launcher3.LauncherExtension}:
      Surface: shown=false layer=21040 alpha=1.0 rect=(0.0,0.0) 720.0 x 1280.0
    mWallpaperX=0.0 mWallpaperY=0.5
    mWallpaperXStep=0.33333334 mWallpaperYStep=1.0
  Window #7 Window{6f63b4 u0 com.android.systemui/com.android.systemui.recents.RecentsActivity}:
    mDisplayId=0 stackId=0 mSession=Session{53fa0ad 3610:u0a10040} mClient=android.os.BinderProxy@e043887
    mOwnerUid=10040 mShowToOwnerOnly=true package=com.android.systemui appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#120 ty=1 fl=#81910100 fmt=-2 wanim=0x7f0f0005 vsysui=0x700 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1280 mLayoutSeq=5926
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{7737318 com.android.systemui/com.android.systemui.recents.RecentsActivity}:
  Window #6 Window{a8eb83 u0 com.ohmibod.remote2/com.ohmibod.remote2.MainActivity}:
    mDisplayId=0 stackId=11 mSession=Session{18d8d22 906:u0a10125} mClient=android.os.BinderProxy@af8d232
    mOwnerUid=10125 mShowToOwnerOnly=true package=com.ohmibod.remote2 appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#23 ty=1 fl=#81810580 wanim=0x103045b vsysui=0x700 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1280 mLayoutSeq=6936
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{40316fb com.ohmibod.remote2/com.ohmibod.remote2.MainActivity}:
      mShownAlpha=1.0 mAlpha=1.0 mLastAlpha=0.0
  Window #5 Window{8880fc9 u0 com.ohmibod.remote2/com.ohmibod.remote2.PlayActivity}:
    mDisplayId=0 stackId=11 mSession=Session{18d8d22 906:u0a10125} mClient=android.os.BinderProxy@6e463d0
    mOwnerUid=10125 mShowToOwnerOnly=true package=com.ohmibod.remote2 appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#120 ty=1 fl=#81810500 wanim=0x103045b vsysui=0x600 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1184 mLayoutSeq=6841
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{d2b208a com.ohmibod.remote2/com.ohmibod.remote2.PlayActivity}:
      mShownAlpha=1.0 mAlpha=1.0 mLastAlpha=0.7
  Window #4 Window{6bb305c u0 com.android.settings/com.android.settings.Settings$ManageApplicationsActivity}:
    mDisplayId=0 stackId=11 mSession=Session{44cc373 13259:1000} mClient=android.os.BinderProxy@4322ecf
    mOwnerUid=1000 mShowToOwnerOnly=true package=com.android.settings appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#20 ty=1 fl=#81810100 wanim=0x103045b vsysui=0x2600 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1280 mLayoutSeq=6759
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{5142af5 com.android.settings/com.android.settings.Settings$ManageApplicationsActivity}:
      mShownAlpha=1.0 mAlpha=1.0 mLastAlpha=0.0
  Window #3 Window{8fd83e9 u0 com.android.settings/com.lge.settings.easy.EasySettings}:
    mDisplayId=0 stackId=11 mSession=Session{44cc373 13259:1000} mClient=android.os.BinderProxy@1f49470
    mOwnerUid=1000 mShowToOwnerOnly=true package=com.android.settings appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#20 ty=1 fl=#81810100 wanim=0x103045b vsysui=0x2600 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1184 mLayoutSeq=6699
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{1e8802c com.android.settings/com.lge.settings.easy.EasySettings}:
      mShownAlpha=1.0 mAlpha=1.0 mLastAlpha=0.7
  Window #2 Window{8977589 u0 com.android.settings/com.android.settings.SubSettings}:
    mDisplayId=0 stackId=11 mSession=Session{44cc373 13259:1000} mClient=android.os.BinderProxy@71ec890
    mOwnerUid=1000 mShowToOwnerOnly=true package=com.android.settings appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#20 ty=1 fl=#81810100 wanim=0x103045b vsysui=0x2600 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1280 mLayoutSeq=5952
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{2a69bdf com.android.settings/com.android.settings.SubSettings}:
      mShownAlpha=1.0 mAlpha=1.0 mLastAlpha=0.0
  Window #1 Window{32623cf u0 com.android.settings/com.android.settings.applications.InstalledAppDetails}:
    mDisplayId=0 stackId=11 mSession=Session{44cc373 13259:1000} mClient=android.os.BinderProxy@ff9cc2e
    mOwnerUid=1000 mShowToOwnerOnly=true package=com.android.settings appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(fillxfill) sim=#20 ty=1 fl=#81810100 wanim=0x103045b vsysui=0x2600 needsMenuKey=2 clr=0x1}
    Requested w=720 h=1184 mLayoutSeq=5935
    mPolicyVisibility=false mPolicyVisibilityAfterAnim=false mAppOpVisibility=true mAttachedHidden=false
    mHasSurface=false mShownFrame=[0.0,0.0][720.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{f6fda7e com.android.settings/com.android.settings.applications.InstalledAppDetails}:
      mShownAlpha=1.0 mAlpha=1.0 mLastAlpha=0.7
  Window #0 Window{82eaa2a u0 com.android.systemui.ImageWallpaper}:
    mDisplayId=0 stackId=0 mSession=Session{53fa0ad 3610:u0a10040} mClient=android.os.BinderProxy@16f5715
    mOwnerUid=10040 mShowToOwnerOnly=true package=com.android.systemui appop=NONE
    mAttrs=WM.LayoutParams{(0,0)(1440x1280) gr=#800033 ty=2013 fl=#318 fmt=2 wanim=0x10302ea clr=0x1}
    Requested w=1440 h=1280 mLayoutSeq=6952
    mIsImWindow=false mIsWallpaper=true mIsFloatingLayer=true mWallpaperVisible=false
    mHasSurface=true mShownFrame=[0.0,0.0][1440.0,1280.0] isReadyForDisplay()=false
    WindowStateAnimator{a388439 com.android.systemui.ImageWallpaper}:
      Surface: shown=false layer=21000 alpha=1.0 rect=(0.0,0.0) 1440.0 x 1280.0
    mLastFreezeDuration=+18m17s363ms
    mWallpaperX=0.0 mWallpaperY=0.5
    mWallpaperXStep=0.33333334 mWallpaperYStep=1.0

  mCurConfiguration={1.0 ?mcc?mnc en_US ldltr sw360dp w360dp h528dp 320dpi nrml port finger -keyb/v/h -nav/h s.8 fontTypeIndex0 forceEmbolden0}
  mHasPermanentDpad=false
  mCurrentFocus=Window{b78ce30 u0 StatusBar}
  mFocusedApp=AppWindowToken{769d636 token=Token{1e2bbd1 ActivityRecord{55d9af8 u0 com.lge.launcher3/.LauncherExtension t55}}}
  mInputMethodTarget=Window{a8eb83 u0 com.ohmibod.remote2/com.ohmibod.remote2.MainActivity}
  mInTouchMode=true mLayoutSeq=6974
  mLastDisplayFreezeDuration=+405ms due to Window{b78ce30 u0 StatusBar}```  I have a Asus ZenFone 2 Laser and i need connect to STF, but when i try this i see this error:

INF/device:resources:service 47275 [FBAZB601V860] Running version check
INF/device:resources:service 47275 [FBAZB601V860] STFService up to date
INF/device:plugins:service 47275 [FBAZB601V860] Launching agent
INF/provider 47234 [*] Providing 0 of 1 device(s); waiting for "FBAZB601V860"
INF/device:plugins:service 47275 [FBAZB601V860] Agent says: "Listening on port 1090"
INF/device:plugins:service 47275 [FBAZB601V860] Launching service
INF/device:plugins:service 47275 [FBAZB601V860] Agent says: "InputClient started"
FTL/device 47275 [FBAZB601V860] Setup had an error Error: Service had an error: "Error: Not found; no service started."
    at /usr/local/lib/node_modules/stf/lib/units/device/plugins/service.js:101:23
From previous event:
    at /usr/local/lib/node_modules/stf/lib/units/device/plugins/service.js:76:14
    at runCallback (timers.js:637:20)
    at tryOnImmediate (timers.js:610:5)
    at processImmediate [as _immediateCallback] (timers.js:582:5)
FTL/util:lifecycle 47275 [FBAZB601V860] Shutting down due to fatal error
INF/provider 47234 [*] Cleaning up device worker "FBAZB601V860"
ERR/provider 47234 [*] Device worker "FBAZB601V860" died with code 1
INF/provider 47234 [*] Restarting device worker "FBAZB601V860"
INF/device:support:push 47287 [FBAZB601V860] Sending output to "tcp://127.0.0.1:7116"
INF/device 47287 [FBAZB601V860] Preparing device
INF/device:support:sub 47287 [FBAZB601V860] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 47287 [FBAZB601V860] Subscribing to permanent channel "*ALL"
INF/device:support:properties 47287 [FBAZB601V860] Loading properties
INF/device:support:abi 47287 [FBAZB601V860] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:service 47287 [FBAZB601V860] Checking whether we need to install STFService
INF/device:resources:service 47287 [FBAZB601V860] Running version check
INF/device:resources:service 47287 [FBAZB601V860] STFService up to date
INF/device:plugins:service 47287 [FBAZB601V860] Launching agent
INF/device:plugins:service 47287 [FBAZB601V860] Launching service
INF/device:plugins:service 47287 [FBAZB601V860] Agent says: "Listening on port 1090"
INF/device:plugins:service 47287 [FBAZB601V860] Agent says: "InputClient started"
FTL/device 47287 [FBAZB601V860] Setup had an error Error: Service had an error: "Error: Not found; no service started."
    at /usr/local/lib/node_modules/stf/lib/units/device/plugins/service.js:101:23
From previous event:
    at /usr/local/lib/node_modules/stf/lib/units/device/plugins/service.js:76:14
    at runCallback (timers.js:637:20)
    at tryOnImmediate (timers.js:610:5)
    at processImmediate [as _immediateCallback] (timers.js:582:5)
FTL/util:lifecycle 47287 [FBAZB601V860] Shutting down due to fatal error
INF/provider 47234 [*] Cleaning up device worker "FBAZB601V860"
ERR/provider 47234 [*] Device worker "FBAZB601V860" died with code 1
INF/provider 47234 [*] Restarting device worker "FBAZB601V860"
INF/device:support:push 47299 [FBAZB601V860] Sending output to "tcp://127.0.0.1:7116"
INF/device 47299 [FBAZB601V860] Preparing device
INF/device:support:sub 47299 [FBAZB601V860] Receiving input from "tcp://127.0.0.1:7114"


Thanks I am having similar issue as well. Did you find out a solution? It's working now. I force stopped AsusBoost. I will update if I find any other culprits. Thank you.  
![imagebroken](https://cloud.githubusercontent.com/assets/5802333/20028055/f5e0ba5e-a361-11e6-98bc-b68cf224cb71.png)
![shootscreen](https://cloud.githubusercontent.com/assets/5802333/20028056/f9d903b4-a361-11e6-9d6f-3f4103834dfa.png)



android@ubuntu:~$ stf doctor
INF/util:doctor 6287 [*] OS Arch: x64
INF/util:doctor 6287 [*] OS Platform: linux
INF/util:doctor 6287 [*] OS Platform: 3.13.0-101-generic
INF/util:doctor 6287 [*] Using Node 5.0.0
INF/util:doctor 6287 [*] Using RethinkDB client 2.3.3
INF/util:doctor 6287 [*] Using ZeroMQ 4.1.5
INF/util:doctor 6287 [*] Local ADB 1.0.31
INF/util:doctor 6287 [*] ProtoBuf 3.1.0
ERR/util:doctor 6287 [*] Current ProtoBuf version is not supported, it has to be ~2
INF/util:doctor 6287 [*] GraphicsMagick 1.3.25
INF/util:doctor 6287 [*] Local RethinkDB server 2.3.5~0precise
/usr/local/lib/node_modules/.stf_npminstall/node_modules/.5.3.0@semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 2.3.5~0precise
    at new SemVer (/usr/local/lib/node_modules/.stf_npminstall/node_modules/.5.3.0@semver/semver.js:293:11)
    at Range.test (/usr/local/lib/node_modules/.stf_npminstall/node_modules/.5.3.0@semver/semver.js:1036:15)
    at Function.satisfies (/usr/local/lib/node_modules/.stf_npminstall/node_modules/.5.3.0@semver/semver.js:1085:16)
    at unsupportedVersion (/usr/local/lib/node_modules/.stf_npminstall/node_modules/.2.1.0@stf/lib/util/doctor.js:13:15)
    at /usr/local/lib/node_modules/.stf_npminstall/node_modules/.2.1.0@stf/lib/util/doctor.js:95:7
    at /usr/local/lib/node_modules/.stf_npminstall/node_modules/.2.1.0@stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:194:7)
    at emitTwo (events.js:87:13)
    at ChildProcess.emit (events.js:172:7)
    at maybeClose (internal/child_process.js:818:16)
    at Socket.<anonymous> (internal/child_process.js:319:11)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at Pipe._onclose (net.js:469:12)
android@ubuntu:~$ 
 @onlinesen  Hello, I also have this problem. Do you have resolved it?  No, the issue is not resolved. 

 

发件人: xiaobeiying [mailto:notifications@github.com] 
发送时间: 2017年2月22日 10:53
收件人: openstf/stf
抄送: onlinesen; Mention
主题: Re: [openstf/stf] [Screen shot] The image is broken when use screenshot (#460)

 

@onlinesen <https://github.com/onlinesen>  Hello, I also have this problem. Do you have resolved it?

—
You are receiving this because you were mentioned.
Reply to this email directly, view it <https://github.com/openstf/stf/issues/460#issuecomment-281553251>  on GitHub, or mute <https://github.com/notifications/unsubscribe-auth/AFiJXRwDwhJyFm96CDhucuc4E9_kEDVbks5re6MegaJpZM4KqLul>  the thread.  <https://github.com/notifications/beacon/AFiJXbON3pYvm680rgftAvhBs6gtBj1lks5re6MegaJpZM4KqLul.gif> 

 When running 'stf doctor', it shows
 _ERR/util:doctor 11404 [*] Current ProtoBuf version is not supported, it has to be ~2_
But the _protoc --version_ prints 
_libprotoc 3.2.0_
Maybe we should use the proper protobuf version to make the screenshot feature work.
 Mostly looks like the stream argument which we pass to plugin.store(line 15) for image storage:
lib/units/device/support/storage.js 
is bad.
The body looks:
{"stats":{"bytesTransferred":0},"_readableState":{"objectMode":false,"highWaterMark":16384,"buffer":{"head":null,"tail":null,"length":0},"length":0,"pipes":null,"pipesCount":0,"flowing":null,"ended":false,"endEmitted":false,"reading":false,"sync":false,"needReadable":true,"emittedReadable":false,"readableListening":false,"resumeScheduled":false,"defaultEncoding":"utf8","ranOut":false,"awaitDrain":0,"readingMore":false,"decoder":null,"encoding":null},"readable":true,"domain":null,"_events":{"end":[null,null]},"_eventsCount":3,"_writableState":{"objectMode":false,"highWaterMark":16384,"needDrain":false,"ending":false,"ended":false,"finished":false,"decodeStrings":true,"defaultEncoding":"utf8","length":0,"writing":false,"corked":0,"sync":true,"bufferProcessing":false,"writecb":null,"writelen":0,"bufferedRequest":null,"lastBufferedRequest":null,"pendingcb":0,"prefinished":false,"errorEmitted":false,"bufferedRequestCount":0,"corkedRequestsFree":{"next":null,"entry":null}},"writable":true,"allowHalfOpen":true,"_transformState":{"needTransform":false,"transforming":false,"writecb":null,"writechunk":null,"writeencoding":null}}

but the tmp stored data located on machine in tmp folder looks okay. So that exclude issue with protobuf.

Also mostly looks like the image stored in as blob is correct one. I missed one thing. My bad. The screenshot will work after we use this import.
var gm = require('gm').subClass({imageMagick: true})
I created pull request with my changes, which fix described over here issue.
https://github.com/openstf/stf/pull/738
Those changes works for me and I have that it will work for you @onlinesen, @xiaobeiying , @kennethzhu  too. I'm crossing my fingers :) .
 I missed, my changes need to have installed imagemagick on stf server machine  Hi:
I ran the STF in localhost, someone else(not same with my ip) accessed my STF website. I tried  get his IP address  by 'req.connection.remoteAddress', but the value is always '127.0.0.1'. Why and how to solve the problem.
English is not my first language.Thank you . Thank you very much. I troubled by this issue for 3 hours.Thank you again
 @yulishuta How do make my STF Public? Can tell me how please. I have tried port forwarding on my router but it redirects top local ip (192.168.1.9:7100) but I want make publicly Accessible. any help would be appreciated. I have also tried to NGrok still the same.   ```
➜  / stf local —allow-remote                         
INF/util:procutil 8185 [*] Forking "/usr/local/lib/node_modules/.stf_npminstall/node_modules/.2.1.0@stf/lib/cli.js migrate"
INF/db 8186 [*] Connecting to 127.0.0.1:28015
INF/db 8186 [*] Unable to connect to 127.0.0.1:28015
FTL/db 8186 [*] No hosts left to try
FTL/util:lifecycle 8186 [*] Shutting down due to fatal error

/usr/local/lib/node_modules/.stf_npminstall/node_modules/.2.11.0@bluebird/js/main/promise.js:680
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/.stf_npminstall/node_modules/.2.1.0@stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:100:13)
    at ChildProcess.emit (events.js:185:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)

```

Is this what is the problem ? @sorccu    Rethinkdb has started successfully

```

➜  / sudo rethinkdb --port-offset 1                  
Running rethinkdb 2.3.5 (CLANG 7.3.0 (clang-703.0.31))...
Running on Darwin 16.0.0 x86_64
Loading data from directory /rethinkdb_data
warn: Cache size does not leave much memory for server and query overhead (available memory: 595 MB).
warn: Cache size is very low and may impact performance.
Listening for intracluster connections on port 29016
Listening for client driver connections on port 28016
Listening for administrative HTTP connections on port 8081
Listening on cluster addresses: 127.0.0.1, ::1
Listening on driver addresses: 127.0.0.1, ::1
Listening on http addresses: 127.0.0.1, ::1
To fully expose RethinkDB on the network, bind to all addresses by running rethinkdb with the `--bind all` command line option.
Server ready, "ACA80F71_ipt_aol_com_sg2" cce7c577-0f19-454e-b
```
 @sorccu  Thank you, i can
  In file "stf/lib/units/provider/index.js"

      var register = new Promise(function(resolve) {
        // Tell others we found a device
        push.send([
          wireutil.global
        , wireutil.envelope(new wire.DeviceIntroductionMessage(
            device.id
          , wireutil.toDeviceStatus(device.type)
          , new wire.ProviderMessage(
              solo
            , options.name
            )
          ))
        ])

        privateTracker.once('register', resolve)
      })


During my debugging process, i found the  'register' event never be triggered.

How about use 
'''
resolve() 
'''
to replace the line 
'''
privateTracker.once('register', resolve)
'''

 @sorccu  
But 'change' and 'remove' event always works and can be triggered. 
I didn't seek out the root cause why register process can't be invoked.  :(
Could you give some suggestions for trouble shooting.
 After remove & install  again the stf package.
All things work fine on node v6.9.0 runtime~~~
Maybe some of the dependencies have been installed incorrectly.
  Here i paste the output messages derived from terminal, i have tried several times, still can't recoginize the android device connected to my desktop.
I have tried installing STFService APK manually and launch the service instance. It didn't work also.
By typing 'adb devices' command, the device status seems good, and with 'adb shell' i can access the device from my desktop~

Host OS: Ubuntu 12.04 64bit
Device: android 4.4.2
Node (on nvm): v6.9.0

$stf local
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js migrate"
INF/db 1677 [] Connecting to 127.0.0.1:28015
INF/db:setup 1677 [] Database "stf" already exists
INF/db:setup 1677 [] Table "users" already exists
INF/db:setup 1677 [] Table "accessTokens" already exists
INF/db:setup 1677 [] Table "vncauth" already exists
INF/db:setup 1677 [] Table "devices" already exists
INF/db:setup 1677 [] Table "logs" already exists
INF/db:setup 1677 [] Index "users"."adbKeys" already exists
INF/db:setup 1677 [] Index "accessTokens"."email" already exists
INF/db:setup 1677 [] Index "vncauth"."response" already exists
INF/db:setup 1677 [] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 1677 [] Index "devices"."owner" already exists
INF/db:setup 1677 [] Index "devices"."present" already exists
INF/db:setup 1677 [] Index "devices"."providerChannel" already exists
INF/db:setup 1677 [] Waiting for index "users"."adbKeys"
INF/db:setup 1677 [] Waiting for index "accessTokens"."email"
INF/db:setup 1677 [] Waiting for index "vncauth"."response"
INF/db:setup 1677 [] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 1677 [] Waiting for index "devices"."owner"
INF/db:setup 1677 [] Waiting for index "devices"."present"
INF/db:setup 1677 [] Waiting for index "devices"."providerChannel"
INF/db:setup 1677 [] Index "users"."adbKeys" is ready
INF/db:setup 1677 [] Index "accessTokens"."email" is ready
INF/db:setup 1677 [] Index "vncauth"."response" is ready
INF/db:setup 1677 [] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 1677 [] Index "devices"."owner" is ready
INF/db:setup 1677 [] Index "devices"."present" is ready
INF/db:setup 1677 [] Index "devices"."providerChannel" is ready
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull 
tcp://127.0.0.1:7113"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js provider --name liuchengtao-pc --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js storage-temp --port 7102"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 1671 [] Forking "/home/liuchengtao/.nvm/versions/node/v6.9.0/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
INF/triproxy 1684 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 1684 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 1684 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/triproxy 1683 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 1683 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 1683 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/db 1690 [proc001] Connecting to 127.0.0.1:28015
INF/processor 1690 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 1690 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/poorxy 1756 [] Listening on port 7100
INF/reaper 1703 [reaper001] Subscribing to permanent channel "ALL"
INF/reaper 1703 [reaper001] Reaping devices with no heartbeat
INF/db 1703 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 1703 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 1703 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/auth-mock 1709 [] Listening on port 7120
INF/db 1696 [proc002] Connecting to 127.0.0.1:28015
INF/processor 1696 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 1696 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/storage:plugins:apk 1750 [] Listening on port 7104
INF/storage:plugins:image 1744 [] Listening on port 7103
INF/provider 1708 [] Subscribing to permanent channel "tR+jxuaUQz2Qvqtte+6oWA=="
INF/provider 1708 [] Sending output to "tcp://127.0.0.1:7116"
INF/provider 1708 [] Receiving input from "tcp://127.0.0.1:7114"
INF/provider 1708 [] Tracking devices
INF/provider 1708 [] Found device "e11b1658" (device)
INF/app 1720 [] Using pre-built resources
INF/storage:temp 1738 [] Listening on port 7102
INF/app 1720 [] Listening on port 7105
INF/db 1720 [] Connecting to 127.0.0.1:28015
INF/websocket 1732 [] Subscribing to permanent channel "ALL"
INF/websocket 1732 [] Listening on port 7110
INF/db 1732 [] Connecting to 127.0.0.1:28015
INF/websocket 1732 [] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 1732 [] Receiving input from "tcp://127.0.0.1:7111"
INF/api 1726 [] Subscribing to permanent channel "ALL"
INF/api 1726 [] Listening on port 7106
INF/api 1726 [] Sending output to "tcp://127.0.0.1:7113"
INF/api 1726 [] Receiving input from "tcp://127.0.0.1:7111"
INF/db 1726 [*] Connecting to 127.0.0.1:28015

INF/provider 1708 [*] Providing all 0 of 1 device(s); ignoring "e11b1658" @sorccu  thanks a lot for clarification. I will have a try on upgraded Ubuntu system.
 @sorccu 

File an new issue for details that i thought may be the root cause
  i pull openstf.stf docker images to local computer,
have a error when i  run stf local command

Unhandled rejection Error: spawn adb ENOENT
    at exports._errnoException (util.js:1026:11)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:193:32)
    at onErrorNT (internal/child_process.js:359:16)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)

but i  not have root priority to install adb 
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Launching stf (locally), then launching 2 virtual devices. The first one loads up fine, and the second one gets to the boot screen then crashes with the following:

```
INF/device:support:sub 90008 [emulator-5556] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 90008 [emulator-5556] Subscribing to permanent channel "*ALL"
FTL/device 90008 [emulator-5556] Setup had an error PrematureEOFError: Premature end of stream, needed 1 more bytes
    at Socket.<anonymous> (/Users/chl/.nvm/versions/node/v6.1.0/lib/node_modules/stf/node_modules/adbkit/lib/adb/parser.js:118:32)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:926:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/util:lifecycle 90008 [emulator-5556] Shutting down due to fatal error
```
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->

Both boot and are available in STF
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->

I'm using pretty much the same values for both AVDs, except for the name. This could potentially be an issue?
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
1. Launch STF locally
2. Launch a virtual android device, wait for it to boot and connect to STF
3. Launch a second virtual android device, wait for it to boot, it will crash.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->

N/A
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 

Using `stf local`
OSX 10.11
Below are the AVD `.ini` details:

Test.ini:

```
avd.ini.encoding=UTF-8
path=/Users/chl/.android/avd/Test.avd
path.rel=avd/Test.avd
target=android-23
```

config.ini:

```
avd.ini.encoding=UTF-8
abi.type=x86_64
disk.dataPartition.size=200M
hw.accelerometer=yes
hw.audioInput=yes
hw.battery=yes
hw.camera.back=none
hw.camera.front=none
hw.cpu.arch=x86_64
hw.dPad=no
hw.device.hash2=MD5:6930e145748b87e87d3f40cabd140a41
hw.device.manufacturer=Google
hw.device.name=Nexus 4
hw.gps=yes
hw.gpu.enabled=yes
hw.keyboard=yes
hw.lcd.density=320
hw.mainKeys=no
hw.ramSize=1907
hw.sdCard=yes
hw.sensors.orientation=yes
hw.sensors.proximity=yes
hw.trackBall=no
image.sysdir.1=system-images/android-23/google_apis/x86_64/
sdcard.size=512M
skin.dynamic=no
skin.name=768x1280
skin.path=768x1280
tag.display=Google APIs
tag.id=google_apis
vm.heapSize=64
```

Thanks for any help/insight into this.
 Attached is the debug log. Looks like it just timed out on this run:

EDIT: linking to gist since its a pain in the ass to scroll through. Debug log here: https://gist.github.com/strong-code/bef192fcc2a93952a44124bb9f16416d
 After some further testing with launching the AVDs without STF running, it appears they never get past the boot screen if more than 1 is booted. I don't think this is an STF problem but rather something on my end. I'll play around with it more this weekend and report back. Thanks for the debug tip @sorccu!
 Turns out it was an issue with my HAXM/AVD memory configuration. HAXM, by default, is installed with 1024 MB of memory allocated and my AVD configurations (again by default) were requesting more than this. To solve it, you can either increase HAXM memory allocation or reduce your AVD's memory to an amount less than or equal to the HAXM allocation.

Happy to say I can confirm STF works fine with multiple AVDs!

![](http://strongco.de/media/p/7082dc.png)
 Sadly it is not - just a black screen. I haven't played around with display configuration too much though since I do not need that feature currently. If anyone has interest in trying to get that to work, let me know and I can mess around with it a bit more. Feel free to close this issue and thanks for the rubber duck debugging!
 @suvansh-dev I have not. I've only tried using the AVD utility. I can't imagine adding an additional layer of virtualization would help with the black screen issue though.  when i run 
"docker run openstf/stf stf local" command,there have a error:
INF/db 12 [*] unable to connect to 127.0.0.1:28015

and the program shutdown
  lijialiangdeMacBook-Pro:~ jerry$ stf local
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 1336 [_] Connecting to 127.0.0.1:28015
INF/db:setup 1336 [_] Database "stf" already exists
INF/db:setup 1336 [_] Table "users" already exists
INF/db:setup 1336 [_] Table "accessTokens" already exists
INF/db:setup 1336 [_] Table "vncauth" already exists
INF/db:setup 1336 [_] Table "devices" already exists
INF/db:setup 1336 [_] Table "logs" already exists
INF/db:setup 1336 [_] Index "users"."adbKeys" already exists
INF/db:setup 1336 [_] Index "accessTokens"."email" already exists
INF/db:setup 1336 [_] Index "vncauth"."response" already exists
INF/db:setup 1336 [_] Index "vncauth"."responsePerDevice" already exists
INF/db:setup 1336 [_] Index "devices"."owner" already exists
INF/db:setup 1336 [_] Index "devices"."present" already exists
INF/db:setup 1336 [_] Waiting for index "users"."adbKeys"
INF/db:setup 1336 [_] Waiting for index "accessTokens"."email"
INF/db:setup 1336 [_] Waiting for index "vncauth"."response"
INF/db:setup 1336 [_] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 1336 [_] Waiting for index "devices"."owner"
INF/db:setup 1336 [_] Waiting for index "devices"."present"
INF/db:setup 1336 [_] Index "devices"."providerChannel" already exists
INF/db:setup 1336 [_] Index "users"."adbKeys" is ready
INF/db:setup 1336 [_] Index "accessTokens"."email" is ready
INF/db:setup 1336 [_] Waiting for index "devices"."providerChannel"
INF/db:setup 1336 [_] Index "vncauth"."response" is ready
INF/db:setup 1336 [_] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 1336 [_] Index "devices"."owner" is ready
INF/db:setup 1336 [_] Index "devices"."present" is ready
INF/db:setup 1336 [_] Index "devices"."providerChannel" is ready
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js provider --name lijialiangdeMacBook-Pro.local --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js api --port 7106 --secret kute kittykat --connect-push tcp://127.0.0.1:7113 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-temp --port 7102"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 1335 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 1335 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --api-url http://localhost:7106/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
/usr/local/lib/node_modules/stf/node_modules/zmq/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: Module version mismatch. Expected 48, got 46.
    at Error (native)
    at Object.Module._extensions..node (module.js:583:18)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
    at Function.Module._load (module.js:424:3)
    at Module.require (module.js:483:17)
    at require (internal/module.js:20:19)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/zmq/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:556:32)
    at Object.Module._extensions..js (module.js:565:10)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
    at Function.Module._load (module.js:424:3)
    at Module.require (module.js:483:17)
    at require (internal/module.js:20:19)
FTL/cli:local 1335 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:215:12)
INF/cli:local 1335 [_] Shutting down all child processes
/usr/local/lib/node_modules/stf/node_modules/zmq/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: Module version mismatch. Expected 48, got 46.
    at Error (native)
    at Object.Module._extensions..node (module.js:583:18)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
    at Function.Module._load (module.js:424:3)
    at Module.require (module.js:483:17)
    at require (internal/module.js:20:19)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/zmq/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:556:32)
    at Object.Module._extensions..js (module.js:565:10)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
    at Function.Module._load (module.js:424:3)
    at Module.require (module.js:483:17)
    at require (internal/module.js:20:19)
 Thank you   <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Device go back to home screen when we click the "Stop Using". This makes problem for appium automation.
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->

Do we have any parameter to prevent device go back to home when the device been kicked?
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
1. open device and open an App.
2. Click “stop using"
3. the device screen go back to home.  
4. :(
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md):
  full deployment
- Version used (git hash or `stf -V`): 
  latest master
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
  Chrome
- Operating System and version: 
  Ubuntu server 16.4
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 Thanks for you reply, sorccu. 
But press the home just make the program running backgroundly. 
If we can make it optional it's better...

To those who needs same feature as me.
/lib/units/device/plugins/group.js
Line:106
comment **servcice.pressKey('home')**
  When I access http://stf_url:7100 via mobile browser, there is no home/menu/back button in the webpage. If I press smartphone back button then it exit.
 Thanks for your answer! Although the device may provide its own home/back buttons,  I think these buttons are different from those in webpage. For example, if press device home button, the device will go home screen, and if press webpage home button, the device that connect with stf will go home screen.
 +1
  Last login: Mon Oct 17 17:46:56 on ttys001
Tanmoys-Mac-mini:~ tanmoyray$ brew install rethinkdb graphicsmagick zeromq protobuf yasm pkg-config
==> Auto-updated Homebrew!
Updated 1 tap (homebrew/core).
==> Updated Formulae
armor                      docker                     oysttyer  
aubio                      elixirscript               pgrouting  
aws-elasticbeanstalk       latex2html                 qca  
codequery                  mitmproxy                  terraform  
dcmtk                      mkvtoolnix               

Warning: rethinkdb-2.3.5 already installed, it's just not linked
==> Installing dependencies for graphicsmagick: jpeg, libpng, libtiff, freetype
==> Installing graphicsmagick dependency: jpeg
==> Downloading https://homebrew.bintray.com/bottles/jpeg-8d.el_capitan.bottle.2
Already downloaded: /Users/tanmoyray/Library/Caches/Homebrew/jpeg-8d.el_capitan.bottle.2.tar.gz
Error: SHA256 mismatch
Expected: bbc74f8b5980065d7bf95927150c2d56806d30abea459c2b1edcbdeed2d7c458
Actual: 87a08f636b46e0ca191e886596c58fd38f1dacc16171b5d5df66203daeeed6a4
Archive: /Users/tanmoyray/Library/Caches/Homebrew/jpeg-8d.el_capitan.bottle.2.tar.gz
To retry an incomplete download, remove the file above.
Warning: Bottle installation failed: building from source.
==> Using the sandbox
==> Downloading http://www.ijg.org/files/jpegsrc.v8d.tar.gz
Already downloaded: /Users/tanmoyray/Library/Caches/Homebrew/jpeg-8d.tar.gz
Error: SHA256 mismatch
Expected: 00029b1473f0f0ea72fbca3230e8cb25797fbb27e58ae2e46bb8bf5a806fe0b3
Actual: a375a0d7a054e04edddd4f5b9539e11aeadc5788e62f8a37173ede5efa08c616
Archive: /Users/tanmoyray/Library/Caches/Homebrew/jpeg-8d.tar.gz
To retry an incomplete download, remove the file above.
Tanmoys-Mac-mini:~ tanmoyray$ Tanmoys-Mac-mini:~ tanmoyray$ brew install rethinkdb graphicsmagick zeromq protobuf yasm pkg-config
-bash: Tanmoys-Mac-mini:~: command not found
Tanmoys-Mac-mini:~ tanmoyray$ ==> Auto-updated Homebrew!
-bash: ==: command not found
Tanmoys-Mac-mini:~ tanmoyray$ Updated 1 tap (homebrew/core).
-bash: syntax error near unexpected token `('
Tanmoys-Mac-mini:~ tanmoyray$
  Hi 
I got problem.
I ran docker image openstf/stf on ubuntu(16.04 LTS)
and I connected 8 devices.
when I did remote Control the connections were reconnected every few minutes.
thanks

![screenshot 2016-10-17 pm 3 59 29](https://cloud.githubusercontent.com/assets/18637037/19428145/483ba2c0-9483-11e6-96ae-7a1e31e99782.png)

[logs] 
2016-10-17T06:54:08.623989571Z INF/device:plugins:screen:capture 5602 [ZX1G22J8HF] Capturing screenshot
2016-10-17T06:54:09.061533613Z INF/storage:temp 72 [_] Uploaded "ZX1G22J8HF.jpg" to "/tmp/upload_cb312176793e59554c85e9e73c1f3efd"
2016-10-17T06:54:09.080558609Z INF/device:support:storage 5602 [ZX1G22J8HF] Uploaded to "/s/image/b6e9b00a-1be7-40b7-84ee-9e2c6a161f88/ZX1G22J8HF.jpg"
2016-10-17T06:54:50.903271005Z IMP/device:plugins:service 5614 [0d88b43e25995b5a] Agent connection ended, attempting to relaunch
2016-10-17T06:54:50.905262096Z INF/device:plugins:service 5614 [0d88b43e25995b5a] Launching service
2016-10-17T06:54:50.905921097Z IMP/device:plugins:service 5620 [0d893faa43e4b116] Agent connection ended, attempting to relaunch
2016-10-17T06:54:50.906296579Z IMP/device:plugins:service 5614 [0d88b43e25995b5a] Service connection ended, attempting to relaunch
2016-10-17T06:54:50.906529248Z INF/device:plugins:service 5614 [0d88b43e25995b5a] Launching service
2016-10-17T06:54:50.906761579Z IMP/device:plugins:service 5602 [ZX1G22J8HF] Agent connection ended, attempting to relaunch
2016-10-17T06:54:50.906829794Z IMP/device:plugins:service 5603 [LGF180Ld952c130] Agent connection ended, attempting to relaunch
2016-10-17T06:54:50.907228539Z WRN/device:plugins:touch 5614 [0d88b43e25995b5a] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:54:50.907291097Z INF/device:plugins:service 5603 [LGF180Ld952c130] Launching service
2016-10-17T06:54:50.907401795Z INF/device:plugins:service 5602 [ZX1G22J8HF] Launching service
2016-10-17T06:54:50.907771354Z INF/device:plugins:service 5620 [0d893faa43e4b116] Launching service
2016-10-17T06:54:50.907830565Z INF/device:plugins:touch 5614 [0d88b43e25995b5a] Disconnecting from minitouch service
2016-10-17T06:54:50.908782454Z IMP/device:plugins:service 5603 [LGF180Ld952c130] Service connection ended, attempting to relaunch
2016-10-17T06:54:50.908862095Z INF/provider 42 [_] Device "ZX1G22J8HF" is now "offline" (was "device")
2016-10-17T06:54:50.909117895Z INF/provider 42 [_] Device "0d893faa43e4b116" is now "offline" (was "device")
2016-10-17T06:54:50.909174964Z INF/device:plugins:service 5603 [LGF180Ld952c130] Launching service
2016-10-17T06:54:50.909251229Z FTL/util:lifecycle 5614 [0d88b43e25995b5a] Forward shell ended; we shall share its fate
2016-10-17T06:54:50.909453004Z INF/provider 42 [_] Device "LGF180Ld952c130" is now "offline" (was "device")
2016-10-17T06:54:50.909578086Z INF/provider 42 [_] Lost device "0d88b43e25995b5a" (device)
2016-10-17T06:54:50.909588111Z FTL/util:lifecycle 5614 [0d88b43e25995b5a] Shutting down due to fatal error
2016-10-17T06:54:50.909591211Z WRN/device:plugins:touch 5603 [LGF180Ld952c130] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:54:50.909862803Z INF/provider 42 [_] Shutting down device worker "0d88b43e25995b5a"
2016-10-17T06:54:50.909969323Z INF/provider 42 [_] Lost device "ZX1G22J8HF" (offline)
2016-10-17T06:54:50.910080705Z INF/device:plugins:touch 5603 [LGF180Ld952c130] Disconnecting from minitouch service
2016-10-17T06:54:50.910196862Z INF/provider 42 [_] Shutting down device worker "ZX1G22J8HF"
2016-10-17T06:54:50.910367095Z INF/provider 42 [_] Lost device "0d893faa43e4b116" (offline)
2016-10-17T06:54:50.910652415Z INF/provider 42 [_] Shutting down device worker "0d893faa43e4b116"
2016-10-17T06:54:50.910753233Z INF/provider 42 [_] Lost device "LGF180Ld952c130" (offline)
2016-10-17T06:54:50.910981088Z IMP/device:plugins:service 5602 [ZX1G22J8HF] Service connection ended, attempting to relaunch
2016-10-17T06:54:50.911282579Z INF/provider 42 [_] Shutting down device worker "LGF180Ld952c130"
2016-10-17T06:54:50.912342588Z INF/provider 42 [_] Cleaning up device worker "0d88b43e25995b5a"
2016-10-17T06:54:50.912395121Z INF/provider 42 [_] Cleaning up device worker "ZX1G22J8HF"
2016-10-17T06:54:50.912447600Z INF/provider 42 [_] Cleaning up device worker "0d893faa43e4b116"
2016-10-17T06:54:50.912461654Z INF/provider 42 [_] Cleaning up device worker "LGF180Ld952c130"
2016-10-17T06:54:50.912489134Z INF/provider 42 [_] Gracefully killing device worker "0d88b43e25995b5a"
2016-10-17T06:54:50.912838166Z FTL/util:lifecycle 5603 [LGF180Ld952c130] Forward shell ended; we shall share its fate
2016-10-17T06:54:50.912964560Z INF/provider 42 [_] Gracefully killing device worker "ZX1G22J8HF"
2016-10-17T06:54:50.913282052Z INF/provider 42 [_] Gracefully killing device worker "0d893faa43e4b116"
2016-10-17T06:54:50.913432464Z INF/provider 42 [_] Gracefully killing device worker "LGF180Ld952c130"
2016-10-17T06:54:50.913831729Z INF/device:plugins:service 5602 [ZX1G22J8HF] Launching service
2016-10-17T06:54:50.913908848Z FTL/util:lifecycle 5603 [LGF180Ld952c130] Shutting down due to fatal error
2016-10-17T06:54:50.914426458Z INF/provider 42 [_] Device worker "0d88b43e25995b5a" has retired
2016-10-17T06:54:50.915527837Z WRN/device:plugins:touch 5602 [ZX1G22J8HF] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:54:50.917165485Z INF/device:plugins:touch 5602 [ZX1G22J8HF] Disconnecting from minitouch service
2016-10-17T06:54:50.917193298Z INF/provider 42 [_] Device worker "LGF180Ld952c130" has retired
2016-10-17T06:54:50.917396807Z IMP/device:plugins:service 5620 [0d893faa43e4b116] Service connection ended, attempting to relaunch
2016-10-17T06:54:50.917571845Z INF/device:plugins:service 5620 [0d893faa43e4b116] Launching service
2016-10-17T06:54:50.918618450Z WRN/device:plugins:touch 5620 [0d893faa43e4b116] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:54:50.919414219Z INF/device:plugins:touch 5620 [0d893faa43e4b116] Disconnecting from minitouch service
2016-10-17T06:54:50.919669171Z FTL/util:lifecycle 5602 [ZX1G22J8HF] Forward shell ended; we shall share its fate
2016-10-17T06:54:50.919859674Z FTL/util:lifecycle 5602 [ZX1G22J8HF] Shutting down due to fatal error
2016-10-17T06:54:50.920585553Z FTL/util:lifecycle 5620 [0d893faa43e4b116] Forward shell ended; we shall share its fate
2016-10-17T06:54:50.920755405Z FTL/util:lifecycle 5620 [0d893faa43e4b116] Shutting down due to fatal error
2016-10-17T06:54:50.923652475Z INF/provider 42 [_] Device worker "0d893faa43e4b116" has retired
2016-10-17T06:54:50.923815546Z INF/provider 42 [_] Device worker "ZX1G22J8HF" has retired
2016-10-17T06:54:51.176136496Z INF/provider 42 [_] Found device "ZX1G22J8HF" (offline)
2016-10-17T06:54:51.176858105Z INF/provider 42 [_] Found device "0d893faa43e4b116" (offline)
2016-10-17T06:54:51.177455516Z INF/provider 42 [_] Found device "LGF180Ld952c130" (offline)
2016-10-17T06:54:51.177984664Z INF/provider 42 [_] Found device "0d88b43e25995b5a" (offline)
2016-10-17T06:54:51.195299701Z INF/reaper 36 [reaper001] Device "ZX1G22J8HF" is present
2016-10-17T06:54:51.195457639Z INF/provider 42 [_] Registered device "ZX1G22J8HF"
2016-10-17T06:54:51.195489198Z INF/provider 42 [_] Device "ZX1G22J8HF" is now "device" (was "offline")
2016-10-17T06:54:51.201810163Z INF/reaper 36 [reaper001] Device "0d88b43e25995b5a" is present
2016-10-17T06:54:51.201982851Z INF/provider 42 [_] Registered device "0d88b43e25995b5a"
2016-10-17T06:54:51.202082193Z INF/provider 42 [_] Device "0d88b43e25995b5a" is now "unauthorized" (was "offline")
2016-10-17T06:54:51.202133497Z INF/reaper 36 [reaper001] Device "LGF180Ld952c130" is present
2016-10-17T06:54:51.202659083Z INF/reaper 36 [reaper001] Device "0d893faa43e4b116" is present
2016-10-17T06:54:51.202733470Z INF/provider 42 [_] Registered device "LGF180Ld952c130"
2016-10-17T06:54:51.202920811Z INF/provider 42 [_] Lost device "LGF180Ld952c130" (offline)
2016-10-17T06:54:51.203105193Z INF/provider 42 [_] Registered device "0d893faa43e4b116"
2016-10-17T06:54:51.250182121Z INF/provider 42 [_] Device "0d893faa43e4b116" is now "unauthorized" (was "offline")
2016-10-17T06:54:51.250472460Z INF/provider 42 [_] Device "0d88b43e25995b5a" is now "device" (was "unauthorized")
2016-10-17T06:54:51.264482996Z INF/provider 42 [_] Device "0d893faa43e4b116" is now "device" (was "unauthorized")
2016-10-17T06:54:51.548334762Z INF/device:support:push 5654 [ZX1G22J8HF] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:54:51.550173910Z INF/device 5654 [ZX1G22J8HF] Preparing device
2016-10-17T06:54:51.571010307Z INF/device:support:push 5660 [0d88b43e25995b5a] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:54:51.572797424Z INF/device 5660 [0d88b43e25995b5a] Preparing device
2016-10-17T06:54:51.588270009Z INF/device:support:push 5666 [0d893faa43e4b116] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:54:51.590088799Z INF/device 5666 [0d893faa43e4b116] Preparing device
2016-10-17T06:54:51.864222550Z INF/device:support:sub 5654 [ZX1G22J8HF] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:54:51.864904611Z INF/device:support:sub 5654 [ZX1G22J8HF] Subscribing to permanent channel "_ALL"
2016-10-17T06:54:51.884217232Z INF/device:support:sub 5660 [0d88b43e25995b5a] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:54:51.885009031Z INF/device:support:sub 5660 [0d88b43e25995b5a] Subscribing to permanent channel "_ALL"
2016-10-17T06:54:51.904554634Z INF/device:support:sub 5666 [0d893faa43e4b116] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:54:51.905308961Z INF/device:support:sub 5666 [0d893faa43e4b116] Subscribing to permanent channel "_ALL"
2016-10-17T06:54:51.917866675Z INF/device:support:properties 5654 [ZX1G22J8HF] Loading properties
2016-10-17T06:54:51.960000397Z INF/device:support:properties 5660 [0d88b43e25995b5a] Loading properties
2016-10-17T06:54:51.980707830Z INF/device:support:properties 5666 [0d893faa43e4b116] Loading properties
2016-10-17T06:54:51.981540088Z INF/device:support:abi 5654 [ZX1G22J8HF] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:54:51.992886284Z INF/device:support:abi 5660 [0d88b43e25995b5a] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:54:52.013786997Z INF/device:support:abi 5666 [0d893faa43e4b116] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:54:52.151963019Z INF/device:resources:service 5660 [0d88b43e25995b5a] Checking whether we need to install STFService
2016-10-17T06:54:52.174289890Z INF/device:resources:service 5666 [0d893faa43e4b116] Checking whether we need to install STFService
2016-10-17T06:54:52.185796827Z INF/device:resources:service 5654 [ZX1G22J8HF] Checking whether we need to install STFService
2016-10-17T06:54:52.596020867Z INF/provider 42 [_] Found device "LGF180Ld952c130" (offline)
2016-10-17T06:54:52.608918618Z INF/reaper 36 [reaper001] Device "LGF180Ld952c130" is present
2016-10-17T06:54:52.608980336Z INF/provider 42 [_] Registered device "LGF180Ld952c130"
2016-10-17T06:54:52.726313506Z INF/provider 42 [_] Device "LGF180Ld952c130" is now "device" (was "offline")
2016-10-17T06:54:52.765529087Z INF/device:resources:service 5660 [0d88b43e25995b5a] Running version check
2016-10-17T06:54:52.788977101Z INF/device:resources:service 5666 [0d893faa43e4b116] Running version check
2016-10-17T06:54:53.003063465Z INF/device:resources:service 5654 [ZX1G22J8HF] Running version check
2016-10-17T06:54:53.037350898Z INF/device:support:push 5690 [LGF180Ld952c130] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:54:53.039164399Z INF/device 5690 [LGF180Ld952c130] Preparing device
2016-10-17T06:54:53.323870823Z INF/device:support:sub 5690 [LGF180Ld952c130] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:54:53.324757058Z INF/device:support:sub 5690 [LGF180Ld952c130] Subscribing to permanent channel "_ALL"
2016-10-17T06:54:53.378511781Z INF/device:support:properties 5690 [LGF180Ld952c130] Loading properties
2016-10-17T06:54:53.578996376Z INF/device:resources:service 5660 [0d88b43e25995b5a] STFService up to date
2016-10-17T06:54:53.580116264Z INF/device:plugins:service 5660 [0d88b43e25995b5a] Launching agent
2016-10-17T06:54:53.601678636Z INF/device:resources:service 5666 [0d893faa43e4b116] STFService up to date
2016-10-17T06:54:53.602956295Z INF/device:plugins:service 5666 [0d893faa43e4b116] Launching agent
2016-10-17T06:54:53.692333597Z INF/device:support:abi 5690 [LGF180Ld952c130] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:54:53.822906470Z INF/device:resources:service 5654 [ZX1G22J8HF] STFService up to date
2016-10-17T06:54:53.827799412Z INF/device:plugins:service 5654 [ZX1G22J8HF] Launching agent
2016-10-17T06:54:54.078570097Z INF/device:resources:service 5690 [LGF180Ld952c130] Checking whether we need to install STFService
2016-10-17T06:54:54.291186964Z INF/device:plugins:service 5660 [0d88b43e25995b5a] Launching service
2016-10-17T06:54:54.293209493Z INF/device:plugins:service 5660 [0d88b43e25995b5a] Agent says: "Listening on @stfagent"
2016-10-17T06:54:54.294975155Z INF/device:plugins:service 5660 [0d88b43e25995b5a] Agent says: "InputClient started"
2016-10-17T06:54:54.314626127Z INF/device:plugins:service 5666 [0d893faa43e4b116] Launching service
2016-10-17T06:54:54.332796297Z INF/device:plugins:service 5666 [0d893faa43e4b116] Agent says: "Listening on @stfagent"
2016-10-17T06:54:54.333435636Z INF/device:plugins:service 5666 [0d893faa43e4b116] Agent says: "InputClient started"
2016-10-17T06:54:54.731462027Z INF/device:resources:service 5690 [LGF180Ld952c130] Running version check
2016-10-17T06:54:54.896505528Z INF/device:plugins:service 5654 [ZX1G22J8HF] Launching service
2016-10-17T06:54:54.924954643Z INF/device:plugins:service 5654 [ZX1G22J8HF] Agent says: "Listening on @stfagent"
2016-10-17T06:54:54.926348453Z INF/device:plugins:service 5654 [ZX1G22J8HF] Agent says: "InputClient started"
2016-10-17T06:54:55.164350717Z INF/device:plugins:display 5660 [0d88b43e25995b5a] Reading display info
2016-10-17T06:54:55.170299700Z INF/device:plugins:display 5666 [0d893faa43e4b116] Reading display info
2016-10-17T06:54:55.171152317Z INF/device:plugins:phone 5660 [0d88b43e25995b5a] Fetching phone info
2016-10-17T06:54:55.175021969Z INF/device:plugins:phone 5666 [0d893faa43e4b116] Fetching phone info
2016-10-17T06:54:55.182532065Z INF/device:plugins:identity 5666 [0d893faa43e4b116] Solving identity
2016-10-17T06:54:55.183988853Z INF/device:plugins:solo 5666 [0d893faa43e4b116] Subscribing to permanent channel "DN15WvUZyQjEfWSmB188VWBCI0I="
2016-10-17T06:54:55.185045062Z INF/device:plugins:screen:stream 5666 [0d893faa43e4b116] Starting WebSocket server on port 7472
2016-10-17T06:54:55.189002342Z INF/device:plugins:identity 5660 [0d88b43e25995b5a] Solving identity
2016-10-17T06:54:55.190420297Z INF/device:plugins:solo 5660 [0d88b43e25995b5a] Subscribing to permanent channel "7F5DWBw5aElSb+BKz+dX3ADnuhM="
2016-10-17T06:54:55.191613799Z INF/device:plugins:screen:stream 5660 [0d88b43e25995b5a] Starting WebSocket server on port 7512
2016-10-17T06:54:55.299109706Z INF/device:plugins:touch 5666 [0d893faa43e4b116] Touch origin is top left
2016-10-17T06:54:55.300725051Z INF/device:plugins:touch 5666 [0d893faa43e4b116] Requesting touch consumer to start
2016-10-17T06:54:55.302221929Z INF/device:plugins:touch 5666 [0d893faa43e4b116] Launching screen service
2016-10-17T06:54:55.309383568Z INF/device:plugins:touch 5666 [0d893faa43e4b116] Connecting to minitouch service
2016-10-17T06:54:55.323810359Z INF/device:plugins:touch 5660 [0d88b43e25995b5a] Touch origin is top left
2016-10-17T06:54:55.325452918Z INF/device:plugins:touch 5660 [0d88b43e25995b5a] Requesting touch consumer to start
2016-10-17T06:54:55.327166601Z INF/device:plugins:touch 5660 [0d88b43e25995b5a] Launching screen service
2016-10-17T06:54:55.333981542Z INF/device:plugins:touch 5660 [0d88b43e25995b5a] Connecting to minitouch service
2016-10-17T06:54:55.347677135Z INF/device:plugins:touch 5666 [0d893faa43e4b116] minitouch says: "Type B touch device touch_dev (1079x1919 with 10 contacts) detected on /dev/input/event1 (score 1100)"
2016-10-17T06:54:55.371914050Z INF/device:plugins:touch 5660 [0d88b43e25995b5a] minitouch says: "Type B touch device touch_dev (1079x1919 with 10 contacts) detected on /dev/input/event1 (score 1100)"
2016-10-17T06:54:55.419830880Z INF/device:plugins:touch 5666 [0d893faa43e4b116] minitouch says: "Connection established"
2016-10-17T06:54:55.421505002Z INF/device:plugins:touch 5666 [0d893faa43e4b116] Reading minitouch banner
2016-10-17T06:54:55.445210772Z INF/device:plugins:touch 5660 [0d88b43e25995b5a] minitouch says: "Connection established"
2016-10-17T06:54:55.446752868Z INF/device:plugins:touch 5660 [0d88b43e25995b5a] Reading minitouch banner
2016-10-17T06:54:55.472356028Z INF/device:plugins:vnc 5666 [0d893faa43e4b116] Starting VNC server on port 7474
2016-10-17T06:54:55.477904834Z INF/device:plugins:browser 5666 [0d893faa43e4b116] Loading browser list
2016-10-17T06:54:55.486123555Z INF/device:plugins:browser 5666 [0d893faa43e4b116] Updating browser list
2016-10-17T06:54:55.491183003Z INF/device:plugins:mute 5666 [0d893faa43e4b116] Will not mute master volume during use
2016-10-17T06:54:55.501723792Z INF/device:plugins:vnc 5660 [0d88b43e25995b5a] Starting VNC server on port 7514
2016-10-17T06:54:55.504178418Z INF/device:plugins:browser 5660 [0d88b43e25995b5a] Loading browser list
2016-10-17T06:54:55.511336569Z INF/device:plugins:browser 5660 [0d88b43e25995b5a] Updating browser list
2016-10-17T06:54:55.513510424Z INF/device:plugins:mute 5660 [0d88b43e25995b5a] Will not mute master volume during use
2016-10-17T06:54:55.562352618Z INF/device:resources:service 5690 [LGF180Ld952c130] STFService up to date
2016-10-17T06:54:55.566468140Z INF/device:plugins:service 5690 [LGF180Ld952c130] Launching agent
2016-10-17T06:54:55.599121827Z INF/device:plugins:forward 5666 [0d893faa43e4b116] Launching reverse port forwarding service
2016-10-17T06:54:55.608242146Z INF/device:plugins:forward 5666 [0d893faa43e4b116] Connecting to reverse port forwarding service
2016-10-17T06:54:55.639510662Z INF/device:plugins:forward 5660 [0d88b43e25995b5a] Launching reverse port forwarding service
2016-10-17T06:54:55.643388433Z INF/device:plugins:forward 5660 [0d88b43e25995b5a] Connecting to reverse port forwarding service
2016-10-17T06:54:55.832527754Z INF/device:plugins:display 5654 [ZX1G22J8HF] Reading display info
2016-10-17T06:54:55.906204979Z INF/device:plugins:phone 5654 [ZX1G22J8HF] Fetching phone info
2016-10-17T06:54:55.951877310Z INF/device:plugins:identity 5654 [ZX1G22J8HF] Solving identity
2016-10-17T06:54:55.954126857Z INF/device:plugins:solo 5654 [ZX1G22J8HF] Subscribing to permanent channel "jox4VAeTQgRzrwEW8XQyblTf5Iw="
2016-10-17T06:54:55.958112210Z INF/device:plugins:screen:stream 5654 [ZX1G22J8HF] Starting WebSocket server on port 7484
2016-10-17T06:54:56.172140726Z INF/device:plugins:touch 5654 [ZX1G22J8HF] Touch origin is top left
2016-10-17T06:54:56.173974899Z INF/device:plugins:touch 5654 [ZX1G22J8HF] Requesting touch consumer to start
2016-10-17T06:54:56.175714229Z INF/device:plugins:touch 5654 [ZX1G22J8HF] Launching screen service
2016-10-17T06:54:56.191331677Z INF/device:plugins:touch 5654 [ZX1G22J8HF] Connecting to minitouch service
2016-10-17T06:54:56.342914405Z INF/device:plugins:touch 5654 [ZX1G22J8HF] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2016-10-17T06:54:56.368257764Z INF/device:plugins:service 5690 [LGF180Ld952c130] Launching service
2016-10-17T06:54:56.391396824Z INF/device:plugins:service 5690 [LGF180Ld952c130] Agent says: "Listening on @stfagent"
2016-10-17T06:54:56.391965603Z INF/device:plugins:service 5690 [LGF180Ld952c130] Agent says: "InputClient started"
2016-10-17T06:54:56.396186758Z INF/device:plugins:touch 5654 [ZX1G22J8HF] minitouch says: "Type B touch device atmel_mxt_ts (1439x2559 with 16 contacts) detected on /dev/input/event0 (score 1100)"
2016-10-17T06:54:56.396605443Z INF/device:plugins:touch 5654 [ZX1G22J8HF] minitouch says: "Note: hard-limiting maximum number of contacts to 10"
2016-10-17T06:54:56.448174950Z INF/device:plugins:connect 5666 [0d893faa43e4b116] Listening on port 7473
2016-10-17T06:54:56.454954881Z INF/device 5666 [0d893faa43e4b116] Fully operational
2016-10-17T06:54:56.500396699Z INF/device:plugins:connect 5660 [0d88b43e25995b5a] Listening on port 7513
2016-10-17T06:54:56.507186809Z INF/device 5660 [0d88b43e25995b5a] Fully operational
2016-10-17T06:54:56.514640893Z INF/device:plugins:touch 5654 [ZX1G22J8HF] minitouch says: "Connection established"
2016-10-17T06:54:56.517105401Z INF/device:plugins:touch 5654 [ZX1G22J8HF] Reading minitouch banner
2016-10-17T06:54:56.568073058Z INF/device:plugins:vnc 5654 [ZX1G22J8HF] Starting VNC server on port 7486
2016-10-17T06:54:56.576126341Z INF/device:plugins:browser 5654 [ZX1G22J8HF] Loading browser list
2016-10-17T06:54:56.627195876Z INF/device:plugins:browser 5654 [ZX1G22J8HF] Updating browser list
2016-10-17T06:54:56.632479351Z INF/device:plugins:mute 5654 [ZX1G22J8HF] Will not mute master volume during use
2016-10-17T06:54:56.895055683Z INF/device:plugins:forward 5654 [ZX1G22J8HF] Launching reverse port forwarding service
2016-10-17T06:54:56.906683270Z INF/device:plugins:forward 5654 [ZX1G22J8HF] Connecting to reverse port forwarding service
2016-10-17T06:54:57.322277549Z INF/device:plugins:display 5690 [LGF180Ld952c130] Reading display info
2016-10-17T06:54:57.473244540Z INF/device:plugins:phone 5690 [LGF180Ld952c130] Fetching phone info
2016-10-17T06:54:57.490166587Z INF/device:plugins:identity 5690 [LGF180Ld952c130] Solving identity
2016-10-17T06:54:57.492044732Z INF/device:plugins:solo 5690 [LGF180Ld952c130] Subscribing to permanent channel "pkQkU4Ion94E7Za4M2L4Gd71GJI="
2016-10-17T06:54:57.495932662Z INF/device:plugins:screen:stream 5690 [LGF180Ld952c130] Starting WebSocket server on port 7528
2016-10-17T06:54:57.783423287Z WRN/device:plugins:data 5690 [LGF180Ld952c130] Unable to find device data { serial: 'LGF180Ld952c130',
2016-10-17T06:54:57.783484803Z   platform: 'Android',
2016-10-17T06:54:57.783493487Z   manufacturer: 'LGE',
2016-10-17T06:54:57.783498240Z   operator: null,
2016-10-17T06:54:57.783502858Z   model: 'LG-F180L',
2016-10-17T06:54:57.783507048Z   version: '4.4.2',
2016-10-17T06:54:57.783511223Z   abi: 'armeabi-v7a',
2016-10-17T06:54:57.783515914Z   sdk: '19',
2016-10-17T06:54:57.783520105Z   product: 'geehrc4g_lgu_kr',
2016-10-17T06:54:57.783524591Z   display: 
2016-10-17T06:54:57.783529152Z    { id: 0,
2016-10-17T06:54:57.783533180Z      width: 768,
2016-10-17T06:54:57.783537233Z      height: 1280,
2016-10-17T06:54:57.783541284Z      xdpi: 319.7900085449219,
2016-10-17T06:54:57.783545365Z      ydpi: 318.7449951171875,
2016-10-17T06:54:57.783549413Z      fps: 60,
2016-10-17T06:54:57.783553476Z      density: 2,
2016-10-17T06:54:57.783557502Z      rotation: 0,
2016-10-17T06:54:57.783561568Z      secure: true,
2016-10-17T06:54:57.783565571Z      size: 4.679082154320592,
2016-10-17T06:54:57.783569834Z      url: 'ws://192.168.1.7:7528' },
2016-10-17T06:54:57.783574194Z   phone: { imei: '354282056622539', network: 'UNKNOWN' } }
2016-10-17T06:54:57.785349245Z INF/device:plugins:touch 5690 [LGF180Ld952c130] Touch origin is top left
2016-10-17T06:54:57.786182347Z INF/device:plugins:touch 5690 [LGF180Ld952c130] Requesting touch consumer to start
2016-10-17T06:54:57.787230767Z INF/device:plugins:touch 5690 [LGF180Ld952c130] Launching screen service
2016-10-17T06:54:57.793957626Z INF/device:plugins:touch 5690 [LGF180Ld952c130] Connecting to minitouch service
2016-10-17T06:54:57.944750960Z INF/device:plugins:touch 5690 [LGF180Ld952c130] minitouch says: "Note: device /dev/input/event7 was outscored by /dev/input/event2 (1100 >= 1000)"
2016-10-17T06:54:57.945187261Z INF/device:plugins:touch 5690 [LGF180Ld952c130] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2016-10-17T06:54:57.963326462Z INF/device:plugins:touch 5690 [LGF180Ld952c130] minitouch says: "Type B touch device touch_dev (1535x2559 with 10 contacts) detected on /dev/input/event2 (score 1100)"
2016-10-17T06:54:58.034633081Z INF/device:plugins:connect 5654 [ZX1G22J8HF] Listening on port 7485
2016-10-17T06:54:58.036336170Z INF/device 5654 [ZX1G22J8HF] Fully operational
2016-10-17T06:54:58.106914664Z INF/device:plugins:touch 5690 [LGF180Ld952c130] Reading minitouch banner
2016-10-17T06:54:58.108093573Z INF/device:plugins:touch 5690 [LGF180Ld952c130] minitouch says: "Connection established"
2016-10-17T06:54:58.154031164Z INF/device:plugins:vnc 5690 [LGF180Ld952c130] Starting VNC server on port 7530
2016-10-17T06:54:58.155376577Z INF/device:plugins:browser 5690 [LGF180Ld952c130] Loading browser list
2016-10-17T06:54:58.273498113Z INF/device:plugins:browser 5690 [LGF180Ld952c130] Updating browser list
2016-10-17T06:54:58.278800554Z INF/device:plugins:mute 5690 [LGF180Ld952c130] Will not mute master volume during use
2016-10-17T06:54:58.580110331Z INF/device:plugins:forward 5690 [LGF180Ld952c130] Launching reverse port forwarding service
2016-10-17T06:54:58.586568181Z INF/device:plugins:forward 5690 [LGF180Ld952c130] Connecting to reverse port forwarding service
2016-10-17T06:55:00.102789178Z INF/device:plugins:connect 5690 [LGF180Ld952c130] Listening on port 7529
2016-10-17T06:55:00.104501314Z INF/device 5690 [LGF180Ld952c130] Fully operational
2016-10-17T06:55:00.117038929Z INF/util:datautil 66 [_] Device database does not have an entry for "LGF180Ld952c130" (model "LG-F180L"/"geehrc4g_lgu_kr"). This is not an error, it only means that we don't have data for it yet.
2016-10-17T06:55:00.210713260Z IMP/device:plugins:service 5476 [584eb6a1] Agent connection ended, attempting to relaunch
2016-10-17T06:55:00.211120066Z IMP/device:plugins:service 5470 [0acc27f325995e40] Agent connection ended, attempting to relaunch
2016-10-17T06:55:00.211468184Z IMP/device:plugins:service 5494 [8511aff5] Agent connection ended, attempting to relaunch
2016-10-17T06:55:00.212015110Z INF/provider 42 [_] Device "0acc27f325995e40" is now "offline" (was "device")
2016-10-17T06:55:00.212345075Z INF/device:plugins:service 5494 [8511aff5] Launching service
2016-10-17T06:55:00.212474863Z INF/provider 42 [_] Device "8511aff5" is now "offline" (was "device")
2016-10-17T06:55:00.212551110Z INF/device:plugins:service 5470 [0acc27f325995e40] Launching service
2016-10-17T06:55:00.213030689Z INF/provider 42 [_] Lost device "584eb6a1" (device)
2016-10-17T06:55:00.213228103Z INF/provider 42 [_] Shutting down device worker "584eb6a1"
2016-10-17T06:55:00.213314536Z INF/provider 42 [_] Lost device "0acc27f325995e40" (offline)
2016-10-17T06:55:00.213408980Z INF/provider 42 [_] Shutting down device worker "0acc27f325995e40"
2016-10-17T06:55:00.213480556Z INF/provider 42 [_] Lost device "8511aff5" (offline)
2016-10-17T06:55:00.213581759Z INF/provider 42 [_] Shutting down device worker "8511aff5"
2016-10-17T06:55:00.213767225Z IMP/device:plugins:service 5470 [0acc27f325995e40] Service connection ended, attempting to relaunch
2016-10-17T06:55:00.213936971Z INF/device:plugins:service 5470 [0acc27f325995e40] Launching service
2016-10-17T06:55:00.213977939Z IMP/device:plugins:service 5494 [8511aff5] Service connection ended, attempting to relaunch
2016-10-17T06:55:00.214226006Z INF/device:plugins:service 5494 [8511aff5] Launching service
2016-10-17T06:55:00.214674046Z WRN/device:plugins:touch 5470 [0acc27f325995e40] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:55:00.214933883Z INF/provider 42 [_] Cleaning up device worker "584eb6a1"
2016-10-17T06:55:00.215005515Z WRN/device:plugins:touch 5494 [8511aff5] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:55:00.215295771Z INF/device:plugins:service 5476 [584eb6a1] Launching service
2016-10-17T06:55:00.215524626Z INF/device:plugins:touch 5470 [0acc27f325995e40] Disconnecting from minitouch service
2016-10-17T06:55:00.216040577Z INF/device:plugins:touch 5494 [8511aff5] Disconnecting from minitouch service
2016-10-17T06:55:00.216074629Z IMP/device:plugins:service 5476 [584eb6a1] Service connection ended, attempting to relaunch
2016-10-17T06:55:00.216266164Z INF/provider 42 [_] Cleaning up device worker "0acc27f325995e40"
2016-10-17T06:55:00.216325688Z INF/provider 42 [_] Cleaning up device worker "8511aff5"
2016-10-17T06:55:00.216405991Z INF/provider 42 [_] Gracefully killing device worker "584eb6a1"
2016-10-17T06:55:00.216573177Z INF/provider 42 [_] Gracefully killing device worker "0acc27f325995e40"
2016-10-17T06:55:00.216696992Z INF/provider 42 [_] Gracefully killing device worker "8511aff5"
2016-10-17T06:55:00.217063392Z INF/device:plugins:service 5476 [584eb6a1] Launching service
2016-10-17T06:55:00.217621764Z FTL/util:lifecycle 5470 [0acc27f325995e40] Forward shell ended; we shall share its fate
2016-10-17T06:55:00.218153356Z FTL/util:lifecycle 5470 [0acc27f325995e40] Shutting down due to fatal error
2016-10-17T06:55:00.219819806Z WRN/device:plugins:touch 5476 [584eb6a1] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:55:00.220518503Z INF/device:plugins:touch 5476 [584eb6a1] Disconnecting from minitouch service
2016-10-17T06:55:00.222220748Z FTL/util:lifecycle 5476 [584eb6a1] Forward shell ended; we shall share its fate
2016-10-17T06:55:00.222485725Z FTL/util:lifecycle 5476 [584eb6a1] Shutting down due to fatal error
2016-10-17T06:55:00.223124436Z INF/provider 42 [_] Device worker "0acc27f325995e40" has retired
2016-10-17T06:55:00.224602013Z FTL/util:lifecycle 5494 [8511aff5] Forward shell ended; we shall share its fate
2016-10-17T06:55:00.224775545Z FTL/util:lifecycle 5494 [8511aff5] Shutting down due to fatal error
2016-10-17T06:55:00.225603387Z INF/provider 42 [_] Device worker "584eb6a1" has retired
2016-10-17T06:55:00.227746281Z INF/provider 42 [_] Device worker "8511aff5" has retired
2016-10-17T06:55:00.355471720Z INF/provider 42 [_] Found device "8511aff5" (offline)
2016-10-17T06:55:00.356319545Z INF/provider 42 [_] Found device "0acc27f325995e40" (offline)
2016-10-17T06:55:00.356918794Z INF/provider 42 [_] Found device "584eb6a1" (offline)
2016-10-17T06:55:00.374589968Z INF/provider 42 [_] Registered device "0acc27f325995e40"
2016-10-17T06:55:00.374726304Z INF/reaper 36 [reaper001] Device "0acc27f325995e40" is present
2016-10-17T06:55:00.376174877Z INF/reaper 36 [reaper001] Device "8511aff5" is present
2016-10-17T06:55:00.376349057Z INF/provider 42 [_] Registered device "8511aff5"
2016-10-17T06:55:00.379766860Z INF/provider 42 [_] Device "8511aff5" is now "unauthorized" (was "offline")
2016-10-17T06:55:00.383593739Z INF/provider 42 [_] Registered device "584eb6a1"
2016-10-17T06:55:00.383670823Z INF/provider 42 [_] Lost device "584eb6a1" (offline)
2016-10-17T06:55:00.386955587Z INF/reaper 36 [reaper001] Device "584eb6a1" is present
2016-10-17T06:55:00.438179671Z INF/provider 42 [_] Device "0acc27f325995e40" is now "device" (was "offline")
2016-10-17T06:55:00.441652045Z INF/provider 42 [_] Device "8511aff5" is now "device" (was "unauthorized")
2016-10-17T06:55:00.788113165Z INF/device:support:push 5702 [0acc27f325995e40] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:55:00.788133159Z INF/device:support:push 5703 [8511aff5] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:55:00.789881243Z INF/device 5703 [8511aff5] Preparing device
2016-10-17T06:55:00.789915001Z INF/device 5702 [0acc27f325995e40] Preparing device
2016-10-17T06:55:01.091612077Z INF/device:support:sub 5703 [8511aff5] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:55:01.092135074Z INF/device:support:sub 5702 [0acc27f325995e40] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:55:01.092281784Z INF/device:support:sub 5703 [8511aff5] Subscribing to permanent channel "_ALL"
2016-10-17T06:55:01.092968050Z INF/device:support:sub 5702 [0acc27f325995e40] Subscribing to permanent channel "_ALL"
2016-10-17T06:55:01.142470193Z INF/device:support:properties 5703 [8511aff5] Loading properties
2016-10-17T06:55:01.168986065Z INF/device:support:properties 5702 [0acc27f325995e40] Loading properties
2016-10-17T06:55:01.200100930Z INF/device:support:abi 5702 [0acc27f325995e40] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:55:01.200179092Z INF/device:support:abi 5703 [8511aff5] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:55:01.343090178Z INF/device:resources:service 5702 [0acc27f325995e40] Checking whether we need to install STFService
2016-10-17T06:55:01.377530003Z INF/device:resources:service 5703 [8511aff5] Checking whether we need to install STFService
2016-10-17T06:55:01.776256765Z INF/provider 42 [_] Found device "584eb6a1" (offline)
2016-10-17T06:55:01.792105481Z INF/reaper 36 [reaper001] Device "584eb6a1" is present
2016-10-17T06:55:01.792184150Z INF/provider 42 [_] Registered device "584eb6a1"
2016-10-17T06:55:01.888667648Z INF/provider 42 [_] Device "584eb6a1" is now "device" (was "offline")
2016-10-17T06:55:01.953942619Z INF/device:resources:service 5702 [0acc27f325995e40] Running version check
2016-10-17T06:55:02.036442734Z INF/device:resources:service 5703 [8511aff5] Running version check
2016-10-17T06:55:02.227380847Z INF/device:support:push 5726 [584eb6a1] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:55:02.229141460Z INF/device 5726 [584eb6a1] Preparing device
2016-10-17T06:55:02.513001368Z INF/device:support:sub 5726 [584eb6a1] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:55:02.513506539Z INF/device:support:sub 5726 [584eb6a1] Subscribing to permanent channel "_ALL"
2016-10-17T06:55:02.613956543Z INF/device:support:properties 5726 [584eb6a1] Loading properties
2016-10-17T06:55:02.709733761Z INF/device:support:abi 5726 [584eb6a1] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:55:02.773649438Z INF/device:resources:service 5702 [0acc27f325995e40] STFService up to date
2016-10-17T06:55:02.777786455Z INF/device:plugins:service 5702 [0acc27f325995e40] Launching agent
2016-10-17T06:55:02.929374886Z INF/device:resources:service 5703 [8511aff5] STFService up to date
2016-10-17T06:55:02.933756874Z INF/device:plugins:service 5703 [8511aff5] Launching agent
2016-10-17T06:55:03.120296318Z INF/device:resources:service 5726 [584eb6a1] Checking whether we need to install STFService
2016-10-17T06:55:03.477001667Z INF/device:plugins:service 5702 [0acc27f325995e40] Launching service
2016-10-17T06:55:03.492406897Z INF/device:plugins:service 5702 [0acc27f325995e40] Agent says: "Listening on @stfagent"
2016-10-17T06:55:03.493306476Z INF/device:plugins:service 5702 [0acc27f325995e40] Agent says: "InputClient started"
2016-10-17T06:55:03.629125838Z INF/device:resources:service 5726 [584eb6a1] Running version check
2016-10-17T06:55:03.750140511Z INF/device:plugins:service 5703 [8511aff5] Agent says: "Listening on @stfagent"
2016-10-17T06:55:03.787790828Z INF/device:plugins:service 5703 [8511aff5] Launching service
2016-10-17T06:55:03.789367464Z INF/device:plugins:service 5703 [8511aff5] Agent says: "InputClient started"
2016-10-17T06:55:04.305240378Z INF/device:resources:service 5726 [584eb6a1] STFService up to date
2016-10-17T06:55:04.306276762Z INF/device:plugins:service 5726 [584eb6a1] Launching agent
2016-10-17T06:55:04.318748657Z INF/device:plugins:display 5702 [0acc27f325995e40] Reading display info
2016-10-17T06:55:04.324347688Z INF/device:plugins:phone 5702 [0acc27f325995e40] Fetching phone info
2016-10-17T06:55:04.331508699Z INF/device:plugins:identity 5702 [0acc27f325995e40] Solving identity
2016-10-17T06:55:04.333103636Z INF/device:plugins:solo 5702 [0acc27f325995e40] Subscribing to permanent channel "FMWTMkLnoFBQN/l3qJQtoA02BwM="
2016-10-17T06:55:04.334468833Z INF/device:plugins:screen:stream 5702 [0acc27f325995e40] Starting WebSocket server on port 7524
2016-10-17T06:55:04.438206497Z INF/device:plugins:touch 5702 [0acc27f325995e40] Touch origin is top left
2016-10-17T06:55:04.439935467Z INF/device:plugins:touch 5702 [0acc27f325995e40] Requesting touch consumer to start
2016-10-17T06:55:04.441504374Z INF/device:plugins:touch 5702 [0acc27f325995e40] Launching screen service
2016-10-17T06:55:04.445628171Z INF/device:plugins:touch 5702 [0acc27f325995e40] Connecting to minitouch service
2016-10-17T06:55:04.483956284Z INF/device:plugins:touch 5702 [0acc27f325995e40] minitouch says: "Type B touch device touch_dev (1079x1919 with 10 contacts) detected on /dev/input/event1 (score 1100)"
2016-10-17T06:55:04.553545182Z INF/device:plugins:touch 5702 [0acc27f325995e40] minitouch says: "Connection established"
2016-10-17T06:55:04.555573245Z INF/device:plugins:touch 5702 [0acc27f325995e40] Reading minitouch banner
2016-10-17T06:55:04.613911485Z INF/device:plugins:vnc 5702 [0acc27f325995e40] Starting VNC server on port 7526
2016-10-17T06:55:04.619801371Z INF/device:plugins:browser 5702 [0acc27f325995e40] Loading browser list
2016-10-17T06:55:04.628045965Z INF/device:plugins:browser 5702 [0acc27f325995e40] Updating browser list
2016-10-17T06:55:04.632163687Z INF/device:plugins:mute 5702 [0acc27f325995e40] Will not mute master volume during use
2016-10-17T06:55:04.683962014Z INF/device:plugins:display 5703 [8511aff5] Reading display info
2016-10-17T06:55:04.742063784Z INF/device:plugins:forward 5702 [0acc27f325995e40] Launching reverse port forwarding service
2016-10-17T06:55:04.752147689Z INF/device:plugins:forward 5702 [0acc27f325995e40] Connecting to reverse port forwarding service
2016-10-17T06:55:04.813332579Z INF/device:plugins:phone 5703 [8511aff5] Fetching phone info
2016-10-17T06:55:04.821442827Z INF/device:plugins:identity 5703 [8511aff5] Solving identity
2016-10-17T06:55:04.823424906Z INF/device:plugins:solo 5703 [8511aff5] Subscribing to permanent channel "+CxO2iowp9IVn72MKxk2c+puwNI="
2016-10-17T06:55:04.827391296Z INF/device:plugins:screen:stream 5703 [8511aff5] Starting WebSocket server on port 7496
2016-10-17T06:55:04.870416937Z INF/device:plugins:service 5726 [584eb6a1] Launching service
2016-10-17T06:55:04.885847082Z INF/device:plugins:service 5726 [584eb6a1] Agent says: "Listening on @stfagent"
2016-10-17T06:55:04.888637926Z INF/device:plugins:service 5726 [584eb6a1] Agent says: "InputClient started"
2016-10-17T06:55:04.967694250Z WRN/device:plugins:data 5703 [8511aff5] Unable to find device data { serial: '8511aff5',
2016-10-17T06:55:04.967725750Z   platform: 'Android',
2016-10-17T06:55:04.967731882Z   manufacturer: 'LGE',
2016-10-17T06:55:04.967736698Z   operator: null,
2016-10-17T06:55:04.967740924Z   model: 'LG-F260S',
2016-10-17T06:55:04.967745046Z   version: '4.4.2',
2016-10-17T06:55:04.967749101Z   abi: 'armeabi-v7a',
2016-10-17T06:55:04.967753969Z   sdk: '19',
2016-10-17T06:55:04.967769717Z   product: 'fx1sk_skt_kr',
2016-10-17T06:55:04.967774490Z   display: 
2016-10-17T06:55:04.967778605Z    { id: 0,
2016-10-17T06:55:04.967782827Z      width: 720,
2016-10-17T06:55:04.967786941Z      height: 1280,
2016-10-17T06:55:04.967791011Z      xdpi: 326.5710144042969,
2016-10-17T06:55:04.967795112Z      ydpi: 328.40399169921875,
2016-10-17T06:55:04.967799133Z      fps: 60,
2016-10-17T06:55:04.967803263Z      density: 2,
2016-10-17T06:55:04.967807367Z      rotation: 0,
2016-10-17T06:55:04.967811388Z      secure: true,
2016-10-17T06:55:04.967815399Z      size: 4.477991395714372,
2016-10-17T06:55:04.967819773Z      url: 'ws://192.168.1.7:7496' },
2016-10-17T06:55:04.967824203Z   phone: { imei: '355706052813097', network: 'UNKNOWN' } }
2016-10-17T06:55:04.969720954Z INF/device:plugins:touch 5703 [8511aff5] Touch origin is top left
2016-10-17T06:55:04.970641834Z INF/device:plugins:touch 5703 [8511aff5] Requesting touch consumer to start
2016-10-17T06:55:04.971960875Z INF/device:plugins:touch 5703 [8511aff5] Launching screen service
2016-10-17T06:55:04.975577225Z INF/device:plugins:touch 5703 [8511aff5] Connecting to minitouch service
2016-10-17T06:55:05.285710443Z INF/device:plugins:touch 5703 [8511aff5] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2016-10-17T06:55:05.325952550Z INF/device:plugins:touch 5703 [8511aff5] minitouch says: "Type A touch device synaptics_ts (1540x2560 with 11 contacts) detected on /dev/input/event2 (score 1000)"
2016-10-17T06:55:05.326409867Z INF/device:plugins:touch 5703 [8511aff5] minitouch says: "Note: hard-limiting maximum number of contacts to 10"
2016-10-17T06:55:05.589492106Z INF/device:plugins:connect 5702 [0acc27f325995e40] Listening on port 7525
2016-10-17T06:55:05.591225033Z INF/device 5702 [0acc27f325995e40] Fully operational
2016-10-17T06:55:05.670599436Z INF/device:plugins:display 5726 [584eb6a1] Reading display info
2016-10-17T06:55:05.691827522Z INF/device:plugins:touch 5703 [8511aff5] minitouch says: "Connection established"
2016-10-17T06:55:05.695412675Z INF/device:plugins:touch 5703 [8511aff5] Reading minitouch banner
2016-10-17T06:55:05.735545162Z INF/device:plugins:vnc 5703 [8511aff5] Starting VNC server on port 7498
2016-10-17T06:55:05.737757345Z INF/device:plugins:phone 5726 [584eb6a1] Fetching phone info
2016-10-17T06:55:05.738440911Z INF/device:plugins:browser 5703 [8511aff5] Loading browser list
2016-10-17T06:55:05.776913372Z INF/device:plugins:identity 5726 [584eb6a1] Solving identity
2016-10-17T06:55:05.779200924Z INF/device:plugins:solo 5726 [584eb6a1] Subscribing to permanent channel "FXuFnqglunHbDC4CJPZAIn+6Q48="
2016-10-17T06:55:05.783045747Z INF/device:plugins:screen:stream 5726 [584eb6a1] Starting WebSocket server on port 7520
2016-10-17T06:55:05.839871988Z INF/device:plugins:browser 5703 [8511aff5] Updating browser list
2016-10-17T06:55:05.840786026Z WRN/device:plugins:browser 5703 [8511aff5] Unmapped browser "com.nate.android.portalmini"
2016-10-17T06:55:05.845757573Z INF/device:plugins:mute 5703 [8511aff5] Will not mute master volume during use
2016-10-17T06:55:05.950477402Z INF/device:plugins:forward 5703 [8511aff5] Launching reverse port forwarding service
2016-10-17T06:55:05.959678168Z INF/device:plugins:forward 5703 [8511aff5] Connecting to reverse port forwarding service
2016-10-17T06:55:06.056835986Z WRN/device:plugins:data 5726 [584eb6a1] Unable to find device data { serial: '584eb6a1',
2016-10-17T06:55:06.056869136Z   platform: 'Android',
2016-10-17T06:55:06.056875758Z   manufacturer: 'SAMSUNG',
2016-10-17T06:55:06.056880037Z   operator: null,
2016-10-17T06:55:06.056884183Z   model: 'SHV-E330S',
2016-10-17T06:55:06.056888267Z   version: '5.0.1',
2016-10-17T06:55:06.056892358Z   abi: 'armeabi-v7a',
2016-10-17T06:55:06.056896754Z   sdk: '21',
2016-10-17T06:55:06.056900892Z   product: 'ks01lteskt',
2016-10-17T06:55:06.056904971Z   display: 
2016-10-17T06:55:06.056909010Z    { id: 0,
2016-10-17T06:55:06.056913160Z      width: 1080,
2016-10-17T06:55:06.056917411Z      height: 1920,
2016-10-17T06:55:06.056921413Z      xdpi: 442.45098876953125,
2016-10-17T06:55:06.056925488Z      ydpi: 439.35101318359375,
2016-10-17T06:55:06.056929556Z      fps: 60,
2016-10-17T06:55:06.056933622Z      density: 3,
2016-10-17T06:55:06.056937656Z      rotation: 0,
2016-10-17T06:55:06.056941653Z      secure: true,
2016-10-17T06:55:06.056945732Z      size: 5.005581516669951,
2016-10-17T06:55:06.056950081Z      url: 'ws://192.168.1.7:7520' },
2016-10-17T06:55:06.056954472Z   phone: { imei: '356432056958486', network: 'UNKNOWN' } }
2016-10-17T06:55:06.058462776Z INF/device:plugins:touch 5726 [584eb6a1] Touch origin is top left
2016-10-17T06:55:06.059172156Z INF/device:plugins:touch 5726 [584eb6a1] Requesting touch consumer to start
2016-10-17T06:55:06.060139666Z INF/device:plugins:touch 5726 [584eb6a1] Launching screen service
2016-10-17T06:55:06.070462145Z INF/device:plugins:touch 5726 [584eb6a1] Connecting to minitouch service
2016-10-17T06:55:06.563770342Z INF/device:plugins:touch 5726 [584eb6a1] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2016-10-17T06:55:06.692035236Z INF/device:plugins:touch 5726 [584eb6a1] minitouch says: "Type B touch device sec_touchscreen (1079x1919 with 10 contacts) detected on /dev/input/event3 (score 1100)"
2016-10-17T06:55:06.796635874Z INF/device:plugins:touch 5726 [584eb6a1] Reading minitouch banner
2016-10-17T06:55:06.798000909Z INF/device:plugins:touch 5726 [584eb6a1] minitouch says: "Connection established"
2016-10-17T06:55:06.838168927Z INF/device:plugins:vnc 5726 [584eb6a1] Starting VNC server on port 7522
2016-10-17T06:55:06.839774391Z INF/device:plugins:browser 5726 [584eb6a1] Loading browser list
2016-10-17T06:55:06.872561991Z INF/device:plugins:browser 5726 [584eb6a1] Updating browser list
2016-10-17T06:55:06.878002866Z INF/device:plugins:mute 5726 [584eb6a1] Will not mute master volume during use
2016-10-17T06:55:07.115513708Z INF/device:plugins:connect 5703 [8511aff5] Listening on port 7497
2016-10-17T06:55:07.120496481Z INF/device:plugins:forward 5726 [584eb6a1] Launching reverse port forwarding service
2016-10-17T06:55:07.122631534Z INF/device 5703 [8511aff5] Fully operational
2016-10-17T06:55:07.128430029Z INF/device:plugins:forward 5726 [584eb6a1] Connecting to reverse port forwarding service
2016-10-17T06:55:07.144425087Z INF/util:datautil 66 [_] Device database does not have an entry for "8511aff5" (model "LG-F260S"/"fx1sk_skt_kr"). This is not an error, it only means that we don't have data for it yet.
2016-10-17T06:55:08.223500893Z INF/device:plugins:connect 5726 [584eb6a1] Listening on port 7521
2016-10-17T06:55:08.226433706Z INF/device 5726 [584eb6a1] Fully operational
2016-10-17T06:55:08.245764499Z INF/util:datautil 66 [_] Device database does not have an entry for "584eb6a1" (model "SHV-E330S"/"ks01lteskt"). This is not an error, it only means that we don't have data for it yet.
2016-10-17T06:55:11.780513348Z INF/provider 42 [_] Providing all 8 device(s)
2016-10-17T06:55:19.652363626Z IMP/device:plugins:service 5666 [0d893faa43e4b116] Agent connection ended, attempting to relaunch
2016-10-17T06:55:19.653098522Z INF/device:plugins:service 5666 [0d893faa43e4b116] Launching service
2016-10-17T06:55:19.653451447Z IMP/device:plugins:service 5654 [ZX1G22J8HF] Agent connection ended, attempting to relaunch
2016-10-17T06:55:19.655357345Z INF/provider 42 [_] Device "ZX1G22J8HF" is now "offline" (was "device")
2016-10-17T06:55:19.655626260Z INF/provider 42 [_] Device "0d88b43e25995b5a" is now "offline" (was "device")
2016-10-17T06:55:19.655663441Z IMP/device:plugins:service 5660 [0d88b43e25995b5a] Agent connection ended, attempting to relaunch
2016-10-17T06:55:19.655802922Z INF/provider 42 [_] Device "LGF180Ld952c130" is now "offline" (was "device")
2016-10-17T06:55:19.655862340Z INF/device:plugins:service 5660 [0d88b43e25995b5a] Launching service
2016-10-17T06:55:19.656080657Z INF/provider 42 [_] Lost device "0d893faa43e4b116" (device)
2016-10-17T06:55:19.656203539Z INF/provider 42 [_] Shutting down device worker "0d893faa43e4b116"
2016-10-17T06:55:19.656695901Z IMP/device:plugins:service 5690 [LGF180Ld952c130] Agent connection ended, attempting to relaunch
2016-10-17T06:55:19.658034863Z INF/provider 42 [_] Cleaning up device worker "0d893faa43e4b116"
2016-10-17T06:55:19.658879021Z IMP/device:plugins:service 5660 [0d88b43e25995b5a] Service connection ended, attempting to relaunch
2016-10-17T06:55:19.659075859Z INF/device:plugins:service 5660 [0d88b43e25995b5a] Launching service
2016-10-17T06:55:19.660214230Z INF/device:plugins:service 5690 [LGF180Ld952c130] Launching service
2016-10-17T06:55:19.660904789Z WRN/device:plugins:touch 5660 [0d88b43e25995b5a] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:55:19.661459280Z INF/provider 42 [_] Lost device "ZX1G22J8HF" (offline)
2016-10-17T06:55:19.661565171Z INF/device:plugins:touch 5660 [0d88b43e25995b5a] Disconnecting from minitouch service
2016-10-17T06:55:19.661628858Z INF/provider 42 [_] Shutting down device worker "ZX1G22J8HF"
2016-10-17T06:55:19.661828144Z INF/provider 42 [_] Lost device "0d88b43e25995b5a" (offline)
2016-10-17T06:55:19.661870958Z IMP/device:plugins:service 5690 [LGF180Ld952c130] Service connection ended, attempting to relaunch
2016-10-17T06:55:19.662070034Z INF/provider 42 [_] Shutting down device worker "0d88b43e25995b5a"
2016-10-17T06:55:19.662149456Z INF/provider 42 [_] Lost device "LGF180Ld952c130" (offline)
2016-10-17T06:55:19.662362978Z INF/provider 42 [_] Shutting down device worker "LGF180Ld952c130"
2016-10-17T06:55:19.662439053Z INF/provider 42 [_] Gracefully killing device worker "0d893faa43e4b116"
2016-10-17T06:55:19.663493247Z FTL/util:lifecycle 5660 [0d88b43e25995b5a] Forward shell ended; we shall share its fate
2016-10-17T06:55:19.663629562Z INF/provider 42 [_] Cleaning up device worker "ZX1G22J8HF"
2016-10-17T06:55:19.663791645Z INF/provider 42 [_] Cleaning up device worker "0d88b43e25995b5a"
2016-10-17T06:55:19.663862479Z INF/device:plugins:service 5690 [LGF180Ld952c130] Launching service
2016-10-17T06:55:19.663944529Z INF/provider 42 [_] Cleaning up device worker "LGF180Ld952c130"
2016-10-17T06:55:19.664154415Z INF/provider 42 [_] Gracefully killing device worker "ZX1G22J8HF"
2016-10-17T06:55:19.664276573Z INF/provider 42 [_] Gracefully killing device worker "0d88b43e25995b5a"
2016-10-17T06:55:19.664387061Z WRN/device:plugins:touch 5690 [LGF180Ld952c130] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:55:19.664631637Z INF/provider 42 [_] Gracefully killing device worker "LGF180Ld952c130"
2016-10-17T06:55:19.664899612Z INF/device:plugins:touch 5690 [LGF180Ld952c130] Disconnecting from minitouch service
2016-10-17T06:55:19.665374711Z FTL/util:lifecycle 5660 [0d88b43e25995b5a] Shutting down due to fatal error
2016-10-17T06:55:19.668493392Z FTL/util:lifecycle 5690 [LGF180Ld952c130] Forward shell ended; we shall share its fate
2016-10-17T06:55:19.668948217Z FTL/util:lifecycle 5690 [LGF180Ld952c130] Shutting down due to fatal error
2016-10-17T06:55:19.669770468Z INF/device:plugins:service 5654 [ZX1G22J8HF] Launching service
2016-10-17T06:55:19.671251104Z IMP/device:plugins:service 5654 [ZX1G22J8HF] Service connection ended, attempting to relaunch
2016-10-17T06:55:19.671701944Z INF/device:plugins:service 5654 [ZX1G22J8HF] Launching service
2016-10-17T06:55:19.671805139Z INF/provider 42 [_] Device worker "0d88b43e25995b5a" has retired
2016-10-17T06:55:19.672674178Z WRN/device:plugins:touch 5654 [ZX1G22J8HF] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:55:19.673302630Z INF/device:plugins:touch 5654 [ZX1G22J8HF] Disconnecting from minitouch service
2016-10-17T06:55:19.673750935Z INF/provider 42 [_] Device worker "LGF180Ld952c130" has retired
2016-10-17T06:55:19.675686399Z FTL/util:lifecycle 5654 [ZX1G22J8HF] Forward shell ended; we shall share its fate
2016-10-17T06:55:19.676020380Z FTL/util:lifecycle 5654 [ZX1G22J8HF] Shutting down due to fatal error
2016-10-17T06:55:19.676156236Z IMP/device:plugins:service 5666 [0d893faa43e4b116] Service connection ended, attempting to relaunch
2016-10-17T06:55:19.676411638Z INF/device:plugins:service 5666 [0d893faa43e4b116] Launching service
2016-10-17T06:55:19.679633091Z INF/provider 42 [_] Device worker "ZX1G22J8HF" has retired
2016-10-17T06:55:19.682187633Z WRN/device:plugins:touch 5666 [0d893faa43e4b116] Shell keeping minitouch running ended unexpectedly
2016-10-17T06:55:19.682661523Z INF/device:plugins:touch 5666 [0d893faa43e4b116] Disconnecting from minitouch service
2016-10-17T06:55:19.684019333Z FTL/util:lifecycle 5666 [0d893faa43e4b116] Forward shell ended; we shall share its fate
2016-10-17T06:55:19.684770210Z FTL/util:lifecycle 5666 [0d893faa43e4b116] Shutting down due to fatal error
2016-10-17T06:55:19.688246967Z INF/provider 42 [_] Device worker "0d893faa43e4b116" has retired
2016-10-17T06:55:19.923604669Z INF/provider 42 [_] Found device "ZX1G22J8HF" (offline)
2016-10-17T06:55:19.924472778Z INF/provider 42 [_] Found device "0d893faa43e4b116" (offline)
2016-10-17T06:55:19.925162039Z INF/provider 42 [_] Found device "LGF180Ld952c130" (offline)
2016-10-17T06:55:19.925870800Z INF/provider 42 [_] Found device "0d88b43e25995b5a" (offline)
2016-10-17T06:55:19.946388010Z INF/reaper 36 [reaper001] Device "ZX1G22J8HF" is present
2016-10-17T06:55:19.946538790Z INF/provider 42 [_] Registered device "ZX1G22J8HF"
2016-10-17T06:55:19.946584694Z INF/provider 42 [_] Registered device "0d88b43e25995b5a"
2016-10-17T06:55:19.946695071Z INF/reaper 36 [reaper001] Device "0d88b43e25995b5a" is present
2016-10-17T06:55:19.949423761Z INF/reaper 36 [reaper001] Device "LGF180Ld952c130" is present
2016-10-17T06:55:19.949729595Z INF/provider 42 [_] Registered device "LGF180Ld952c130"
2016-10-17T06:55:19.951672153Z INF/reaper 36 [reaper001] Device "0d893faa43e4b116" is present
2016-10-17T06:55:19.951800921Z INF/provider 42 [_] Registered device "0d893faa43e4b116"
2016-10-17T06:55:19.956382375Z INF/provider 42 [_] Device "ZX1G22J8HF" is now "unauthorized" (was "offline")
2016-10-17T06:55:19.956745864Z INF/provider 42 [_] Device "LGF180Ld952c130" is now "unauthorized" (was "offline")
2016-10-17T06:55:19.957180977Z INF/provider 42 [_] Lost device "0d88b43e25995b5a" (offline)
2016-10-17T06:55:19.960219977Z INF/provider 42 [_] Device "LGF180Ld952c130" is now "device" (was "unauthorized")
2016-10-17T06:55:19.960571939Z INF/provider 42 [_] Device "ZX1G22J8HF" is now "device" (was "unauthorized")
2016-10-17T06:55:20.014708144Z INF/provider 42 [_] Device "0d893faa43e4b116" is now "device" (was "offline")
2016-10-17T06:55:20.315418682Z INF/device:support:push 5738 [LGF180Ld952c130] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:55:20.317219322Z INF/device:support:push 5739 [ZX1G22J8HF] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:55:20.317292744Z INF/device 5738 [LGF180Ld952c130] Preparing device
2016-10-17T06:55:20.319039625Z INF/device 5739 [ZX1G22J8HF] Preparing device
2016-10-17T06:55:20.339677157Z INF/device:support:push 5750 [0d893faa43e4b116] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:55:20.341543569Z INF/device 5750 [0d893faa43e4b116] Preparing device
2016-10-17T06:55:20.630746121Z INF/device:support:sub 5739 [ZX1G22J8HF] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:55:20.630786266Z INF/device:support:sub 5738 [LGF180Ld952c130] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:55:20.631479209Z INF/device:support:sub 5739 [ZX1G22J8HF] Subscribing to permanent channel "_ALL"
2016-10-17T06:55:20.631537763Z INF/device:support:sub 5738 [LGF180Ld952c130] Subscribing to permanent channel "_ALL"
2016-10-17T06:55:20.656391692Z INF/device:support:sub 5750 [0d893faa43e4b116] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:55:20.657217429Z INF/device:support:sub 5750 [0d893faa43e4b116] Subscribing to permanent channel "_ALL"
2016-10-17T06:55:20.682376112Z INF/device:support:properties 5738 [LGF180Ld952c130] Loading properties
2016-10-17T06:55:20.734105950Z INF/device:support:properties 5750 [0d893faa43e4b116] Loading properties
2016-10-17T06:55:20.740386818Z INF/device:support:properties 5739 [ZX1G22J8HF] Loading properties
2016-10-17T06:55:20.769535634Z INF/device:support:abi 5750 [0d893faa43e4b116] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:55:20.783396167Z INF/device:support:abi 5738 [LGF180Ld952c130] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:55:20.844262838Z INF/device:support:abi 5739 [ZX1G22J8HF] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:55:20.899284283Z INF/device:resources:service 5750 [0d893faa43e4b116] Checking whether we need to install STFService
2016-10-17T06:55:20.923742151Z INF/device:resources:service 5738 [LGF180Ld952c130] Checking whether we need to install STFService
2016-10-17T06:55:21.211353258Z INF/device:resources:service 5739 [ZX1G22J8HF] Checking whether we need to install STFService
2016-10-17T06:55:21.415748428Z INF/provider 42 [_] Found device "0d88b43e25995b5a" (offline)
2016-10-17T06:55:21.430535531Z INF/reaper 36 [reaper001] Device "0d88b43e25995b5a" is present
2016-10-17T06:55:21.430640612Z INF/provider 42 [_] Registered device "0d88b43e25995b5a"
2016-10-17T06:55:21.492687066Z INF/provider 42 [_] Device "0d88b43e25995b5a" is now "device" (was "offline")
2016-10-17T06:55:21.558551803Z INF/device:resources:service 5750 [0d893faa43e4b116] Running version check
2016-10-17T06:55:21.581008115Z INF/device:resources:service 5738 [LGF180Ld952c130] Running version check
2016-10-17T06:55:21.830928095Z INF/device:support:push 5774 [0d88b43e25995b5a] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T06:55:21.832668971Z INF/device 5774 [0d88b43e25995b5a] Preparing device
2016-10-17T06:55:22.074239741Z INF/device:resources:service 5739 [ZX1G22J8HF] Running version check
2016-10-17T06:55:22.118258436Z INF/device:support:sub 5774 [0d88b43e25995b5a] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T06:55:22.119035838Z INF/device:support:sub 5774 [0d88b43e25995b5a] Subscribing to permanent channel "_ALL"
2016-10-17T06:55:22.192106962Z INF/device:support:properties 5774 [0d88b43e25995b5a] Loading properties
2016-10-17T06:55:22.221301321Z INF/device:support:abi 5774 [0d88b43e25995b5a] Supports ABIs armeabi-v7a, armeabi
2016-10-17T06:55:22.351286754Z INF/device:resources:service 5774 [0d88b43e25995b5a] Checking whether we need to install STFService
2016-10-17T06:55:22.376345812Z INF/device:resources:service 5750 [0d893faa43e4b116] STFService up to date
2016-10-17T06:55:22.378578224Z INF/device:plugins:service 5750 [0d893faa43e4b116] Launching agent
2016-10-17T06:55:22.612232337Z INF/device:resources:service 5738 [LGF180Ld952c130] STFService up to date
2016-10-17T06:55:22.613827039Z INF/device:plugins:service 5738 [LGF180Ld952c130] Launching agent
2016-10-17T06:55:22.980393487Z INF/device:resources:service 5774 [0d88b43e25995b5a] Running version check
2016-10-17T06:55:22.984299161Z INF/device:resources:service 5739 [ZX1G22J8HF] STFService up to date
2016-10-17T06:55:22.988534279Z INF/device:plugins:service 5739 [ZX1G22J8HF] Launching agent
2016-10-17T06:55:23.156630689Z INF/device:plugins:service 5750 [0d893faa43e4b116] Agent says: "Listening on @stfagent"
2016-10-17T06:55:23.208759719Z INF/device:plugins:service 5750 [0d893faa43e4b116] Launching service
2016-10-17T06:55:23.210362624Z INF/device:plugins:service 5750 [0d893faa43e4b116] Agent says: "InputClient started"
2016-10-17T06:55:23.645613670Z INF/device:plugins:service 5738 [LGF180Ld952c130] Launching service
2016-10-17T06:55:23.690379827Z INF/device:plugins:service 5738 [LGF180Ld952c130] Agent says: "Listening on @stfagent"
2016-10-17T06:55:23.691314812Z INF/device:plugins:service 5738 [LGF180Ld952c130] Agent says: "InputClient started"
2016-10-17T06:55:23.801693083Z INF/device:resources:service 5774 [0d88b43e25995b5a] STFService up to date
2016-10-17T06:55:23.802964099Z INF/device:plugins:service 5774 [0d88b43e25995b5a] Launching agent
2016-10-17T06:55:23.961882989Z INF/device:plugins:service 5739 [ZX1G22J8HF] Launching service
2016-10-17T06:55:23.998881450Z INF/device:plugins:service 5739 [ZX1G22J8HF] Agent says: "Listening on @stfagent"
2016-10-17T06:55:24.001096767Z INF/device:plugins:service 5739 [ZX1G22J8HF] Agent says: "InputClient started"
2016-10-17T06:55:24.084424046Z INF/device:plugins:display 5750 [0d893faa43e4b116] Reading display info
2016-10-17T06:55:24.101199955Z INF/device:plugins:phone 5750 [0d893faa43e4b116] Fetching phone info
2016-10-17T06:55:24.108561741Z INF/device:plugins:identity 5750 [0d893faa43e4b116] Solving identity
2016-10-17T06:55:24.109473909Z INF/device:plugins:solo 5750 [0d893faa43e4b116] Subscribing to permanent channel "DN15WvUZyQjEfWSmB188VWBCI0I="
2016-10-17T06:55:24.111200014Z INF/device:plugins:screen:stream 5750 [0d893faa43e4b116] Starting WebSocket server on port 7456
2016-10-17T06:55:24.188904670Z INF/device:plugins:touch 5750 [0d893faa43e4b116] Touch origin is top left
2016-10-17T06:55:24.190589170Z INF/device:plugins:touch 5750 [0d893faa43e4b116] Requesting touch consumer to start
2016-10-17T06:55:24.192038696Z INF/device:plugins:touch 5750 [0d893faa43e4b116] Launching screen service
2016-10-17T06:55:24.199152600Z INF/device:plugins:touch 5750 [0d893faa43e4b116] Connecting to minitouch service
2016-10-17T06:55:24.235994604Z INF/device:plugins:touch 5750 [0d893faa43e4b116] minitouch says: "Type B touch device touch_dev (1079x1919 with 10 contacts) detected on /dev/input/event1 (score 1100)"
2016-10-17T06:55:24.309265392Z INF/device:plugins:touch 5750 [0d893faa43e4b116] minitouch says: "Connection established"
2016-10-17T06:55:24.310559645Z INF/device:plugins:touch 5750 [0d893faa43e4b116] Reading minitouch banner
2016-10-17T06:55:24.369191998Z INF/device:plugins:vnc 5750 [0d893faa43e4b116] Starting VNC server on port 7458
2016-10-17T06:55:24.374782849Z INF/device:plugins:browser 5750 [0d893faa43e4b116] Loading browser list
2016-10-17T06:55:24.381753547Z INF/device:plugins:browser 5750 [0d893faa43e4b116] Updating browser list
2016-10-17T06:55:24.387175641Z INF/device:plugins:mute 5750 [0d893faa43e4b116] Will not mute master volume during use
2016-10-17T06:55:24.501265778Z INF/device:plugins:forward 5750 [0d893faa43e4b116] Launching reverse port forwarding service
2016-10-17T06:55:24.508736390Z INF/device:plugins:forward 5750 [0d893faa43e4b116] Connecting to reverse port forwarding service
2016-10-17T06:55:24.516354458Z INF/device:plugins:display 5738 [LGF180Ld952c130] Reading display info
2016-10-17T06:55:24.558653054Z INF/device:plugins:service 5774 [0d88b43e25995b5a] Agent says: "Listening on @stfagent"
2016-10-17T06:55:24.598237607Z INF/device:plugins:phone 5738 [LGF180Ld952c130] Fetching phone info
2016-10-17T06:55:24.610036000Z INF/device:plugins:identity 5738 [LGF180Ld952c130] Solving identity
2016-10-17T06:55:24.610582875Z INF/device:plugins:service 5774 [0d88b43e25995b5a] Launching service
2016-10-17T06:55:24.612854984Z INF/device:plugins:solo 5738 [LGF180Ld952c130] Subscribing to permanent channel "pkQkU4Ion94E7Za4M2L4Gd71GJI="
2016-10-17T06:55:24.613848270Z INF/device:plugins:service 5774 [0d88b43e25995b5a] Agent says: "InputClient started"
2016-10-17T06:55:24.617907465Z INF/device:plugins:screen:stream 5738 [LGF180Ld952c130] Starting WebSocket server on port 7476
2016-10-17T06:55:24.718292012Z WRN/device:plugins:data 5738 [LGF180Ld952c130] Unable to find device data { serial: 'LGF180Ld952c130',
2016-10-17T06:55:24.718320797Z   platform: 'Android',
2016-10-17T06:55:24.718325751Z   manufacturer: 'LGE',
2016-10-17T06:55:24.718328184Z   operator: null,
2016-10-17T06:55:24.718330564Z   model: 'LG-F180L',
2016-10-17T06:55:24.718332664Z   version: '4.4.2',
2016-10-17T06:55:24.718334743Z   abi: 'armeabi-v7a',
2016-10-17T06:55:24.718337146Z   sdk: '19',
2016-10-17T06:55:24.718339238Z   product: 'geehrc4g_lgu_kr',
2016-10-17T06:55:24.718341306Z   display: 
2016-10-17T06:55:24.718343378Z    { id: 0,
2016-10-17T06:55:24.718345384Z      width: 768,
2016-10-17T06:55:24.718348155Z      height: 1280,
2016-10-17T06:55:24.718350241Z      xdpi: 319.7900085449219,
2016-10-17T06:55:24.718352289Z      ydpi: 318.7449951171875,
2016-10-17T06:55:24.718354805Z      fps: 60,
2016-10-17T06:55:24.718357137Z      density: 2,
2016-10-17T06:55:24.718359283Z      rotation: 0,
2016-10-17T06:55:24.718361457Z      secure: true,
2016-10-17T06:55:24.718363478Z      size: 4.679082154320592,
2016-10-17T06:55:24.718365872Z      url: 'ws://192.168.1.7:7476' },
2016-10-17T06:55:24.718368162Z   phone: { imei: '354282056622539', network: 'UNKNOWN' } }
2016-10-17T06:55:24.719400955Z INF/device:plugins:touch 5738 [LGF180Ld952c130] Touch origin is top left
2016-10-17T06:55:24.719863505Z INF/device:plugins:touch 5738 [LGF180Ld952c130] Requesting touch consumer to start
2016-10-17T06:55:24.720428965Z INF/device:plugins:touch 5738 [LGF180Ld952c130] Launching screen service
2016-10-17T06:55:24.723304026Z INF/device:plugins:touch 5738 [LGF180Ld952c130] Connecting to minitouch service
2016-10-17T06:55:24.852425492Z INF/device:plugins:touch 5738 [LGF180Ld952c130] minitouch says: "Note: device /dev/input/event7 was outscored by /dev/input/event2 (1100 >= 1000)"
2016-10-17T06:55:24.852873070Z INF/device:plugins:touch 5738 [LGF180Ld952c130] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2016-10-17T06:55:24.871439940Z INF/device:plugins:touch 5738 [LGF180Ld952c130] minitouch says: "Type B touch device touch_dev (1535x2559 with 10 contacts) detected on /dev/input/event2 (score 1100)"
2016-10-17T06:55:24.991062448Z INF/device:plugins:display 5739 [ZX1G22J8HF] Reading display info
2016-10-17T06:55:25.038887179Z INF/device:plugins:touch 5738 [LGF180Ld952c130] minitouch says: "Connection established"
2016-10-17T06:55:25.040100773Z INF/device:plugins:touch 5738 [LGF180Ld952c130] Reading minitouch banner
2016-10-17T06:55:25.050604868Z INF/device:plugins:phone 5739 [ZX1G22J8HF] Fetching phone info
2016-10-17T06:55:25.073444198Z INF/device:plugins:identity 5739 [ZX1G22J8HF] Solving identity
2016-10-17T06:55:25.084343374Z INF/device:plugins:solo 5739 [ZX1G22J8HF] Subscribing to permanent channel "jox4VAeTQgRzrwEW8XQyblTf5Iw="
2016-10-17T06:55:25.088770877Z INF/device:plugins:screen:stream 5739 [ZX1G22J8HF] Starting WebSocket server on port 7508
2016-10-17T06:55:25.091320599Z INF/device:plugins:vnc 5738 [LGF180Ld952c130] Starting VNC server on port 7478
2016-10-17T06:55:25.096492467Z INF/device:plugins:browser 5738 [LGF180Ld952c130] Loading browser list
2016-10-17T06:55:25.148125781Z INF/device:plugins:browser 5738 [LGF180Ld952c130] Updating browser list
2016-10-17T06:55:25.153661748Z INF/device:plugins:mute 5738 [LGF180Ld952c130] Will not mute master volume during use
2016-10-17T06:55:25.246062764Z INF/device:plugins:forward 5738 [LGF180Ld952c130] Launching reverse port forwarding service
2016-10-17T06:55:25.252337469Z INF/device:plugins:forward 5738 [LGF180Ld952c130] Connecting to reverse port forwarding service
2016-10-17T06:55:25.304546231Z INF/device:plugins:touch 5739 [ZX1G22J8HF] Touch origin is top left
2016-10-17T06:55:25.306246103Z INF/device:plugins:touch 5739 [ZX1G22J8HF] Requesting touch consumer to start
2016-10-17T06:55:25.307933360Z INF/device:plugins:touch 5739 [ZX1G22J8HF] Launching screen service
2016-10-17T06:55:25.321926962Z INF/device:plugins:touch 5739 [ZX1G22J8HF] Connecting to minitouch service
2016-10-17T06:55:25.355044310Z INF/device:plugins:connect 5750 [0d893faa43e4b116] Listening on port 7457
2016-10-17T06:55:25.361622252Z INF/device 5750 [0d893faa43e4b116] Fully operational
2016-10-17T06:55:25.465463288Z INF/device:plugins:touch 5739 [ZX1G22J8HF] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2016-10-17T06:55:25.491809069Z INF/device:plugins:display 5774 [0d88b43e25995b5a] Reading display info
2016-10-17T06:55:25.506014764Z INF/device:plugins:phone 5774 [0d88b43e25995b5a] Fetching phone info
2016-10-17T06:55:25.515203709Z INF/device:plugins:identity 5774 [0d88b43e25995b5a] Solving identity
2016-10-17T06:55:25.517465075Z INF/device:plugins:solo 5774 [0d88b43e25995b5a] Subscribing to permanent channel "7F5DWBw5aElSb+BKz+dX3ADnuhM="
2016-10-17T06:55:25.519086506Z INF/device:plugins:screen:stream 5774 [0d88b43e25995b5a] Starting WebSocket server on port 7468
2016-10-17T06:55:25.541803385Z INF/device:plugins:touch 5739 [ZX1G22J8HF] minitouch says: "Type B touch device atmel_mxt_ts (1439x2559 with 16 contacts) detected on /dev/input/event0 (score 1100)"
2016-10-17T06:55:25.543495326Z INF/device:plugins:touch 5739 [ZX1G22J8HF] minitouch says: "Note: hard-limiting maximum number of contacts to 10"
2016-10-17T06:55:25.632138049Z INF/device:plugins:touch 5774 [0d88b43e25995b5a] Touch origin is top left
2016-10-17T06:55:25.633775584Z INF/device:plugins:touch 5774 [0d88b43e25995b5a] Requesting touch consumer to start
2016-10-17T06:55:25.635236068Z INF/device:plugins:touch 5774 [0d88b43e25995b5a] Launching screen service
2016-10-17T06:55:25.645962241Z INF/device:plugins:touch 5739 [ZX1G22J8HF] Reading minitouch banner
2016-10-17T06:55:25.648090315Z INF/device:plugins:touch 5774 [0d88b43e25995b5a] Connecting to minitouch service
2016-10-17T06:55:25.648158937Z INF/device:plugins:touch 5739 [ZX1G22J8HF] minitouch says: "Connection established"
2016-10-17T06:55:25.687481882Z INF/device:plugins:touch 5774 [0d88b43e25995b5a] minitouch says: "Type B touch device touch_dev (1079x1919 with 10 contacts) detected on /dev/input/event1 (score 1100)"
2016-10-17T06:55:25.702442521Z INF/device:plugins:vnc 5739 [ZX1G22J8HF] Starting VNC server on port 7510
2016-10-17T06:55:25.711039951Z INF/device:plugins:browser 5739 [ZX1G22J8HF] Loading browser list
2016-10-17T06:55:25.759705771Z INF/device:plugins:browser 5739 [ZX1G22J8HF] Updating browser list
2016-10-17T06:55:25.761543115Z INF/device:plugins:touch 5774 [0d88b43e25995b5a] Reading minitouch banner
2016-10-17T06:55:25.764091787Z INF/device:plugins:touch 5774 [0d88b43e25995b5a] minitouch says: "Connection established"
2016-10-17T06:55:25.766015708Z INF/device:plugins:mute 5739 [ZX1G22J8HF] Will not mute master volume during use
2016-10-17T06:55:25.810608553Z INF/device:plugins:vnc 5774 [0d88b43e25995b5a] Starting VNC server on port 7470
2016-10-17T06:55:25.816063261Z INF/device:plugins:browser 5774 [0d88b43e25995b5a] Loading browser list
2016-10-17T06:55:25.824075334Z INF/device:plugins:browser 5774 [0d88b43e25995b5a] Updating browser list
2016-10-17T06:55:25.829352645Z INF/device:plugins:mute 5774 [0d88b43e25995b5a] Will not mute master volume during use
2016-10-17T06:55:25.997285291Z INF/device:plugins:forward 5774 [0d88b43e25995b5a] Launching reverse port forwarding service
2016-10-17T06:55:26.005053897Z INF/device:plugins:forward 5774 [0d88b43e25995b5a] Connecting to reverse port forwarding service
2016-10-17T06:55:26.020448996Z INF/device:plugins:forward 5739 [ZX1G22J8HF] Launching reverse port forwarding service
2016-10-17T06:55:26.032448474Z INF/device:plugins:forward 5739 [ZX1G22J8HF] Connecting to reverse port forwarding service
2016-10-17T06:55:26.698920042Z INF/device:plugins:connect 5738 [LGF180Ld952c130] Listening on port 7477
2016-10-17T06:55:26.705687581Z INF/device 5738 [LGF180Ld952c130] Fully operational
2016-10-17T06:55:26.725547523Z INF/util:datautil 66 [_] Device database does not have an entry for "LGF180Ld952c130" (model "LG-F180L"/"geehrc4g_lgu_kr"). This is not an error, it only means that we don't have data for it yet.
2016-10-17T06:55:26.866449177Z INF/device:plugins:connect 5774 [0d88b43e25995b5a] Listening on port 7469
2016-10-17T06:55:26.872808504Z INF/device 5774 [0d88b43e25995b5a] Fully operational
2016-10-17T06:55:27.162444929Z INF/device:plugins:connect 5739 [ZX1G22J8HF] Listening on port 7509
2016-10-17T06:55:27.164405948Z INF/device 5739 [ZX1G22J8HF] Fully operational
2016-10-17T06:55:31.421178723Z INF/provider 42 [_] Providing all 8 device(s)
2016-10-17T07:02:55.542766559Z INF/provider 42 [_] Device "0acc27f325995e40" is now "offline" (was "device")
2016-10-17T07:02:55.543130177Z INF/provider 42 [_] Device "584eb6a1" is now "offline" (was "device")
2016-10-17T07:02:55.543381607Z INF/provider 42 [_] Lost device "8511aff5" (device)
2016-10-17T07:02:55.543638319Z INF/provider 42 [_] Shutting down device worker "8511aff5"
2016-10-17T07:02:55.543861729Z IMP/device:plugins:service 5702 [0acc27f325995e40] Agent connection ended, attempting to relaunch
2016-10-17T07:02:55.544970582Z INF/device:plugins:service 5702 [0acc27f325995e40] Launching service
2016-10-17T07:02:55.546084533Z IMP/device:plugins:service 5726 [584eb6a1] Agent connection ended, attempting to relaunch
2016-10-17T07:02:55.546099422Z IMP/device:plugins:service 5703 [8511aff5] Agent connection ended, attempting to relaunch
2016-10-17T07:02:55.546278447Z INF/provider 42 [_] Lost device "0acc27f325995e40" (offline)
2016-10-17T07:02:55.546290021Z INF/device:plugins:service 5703 [8511aff5] Launching service
2016-10-17T07:02:55.546456723Z INF/provider 42 [_] Shutting down device worker "0acc27f325995e40"
2016-10-17T07:02:55.546496023Z INF/provider 42 [_] Lost device "584eb6a1" (offline)
2016-10-17T07:02:55.546535887Z IMP/device:plugins:service 5702 [0acc27f325995e40] Service connection ended, attempting to relaunch
2016-10-17T07:02:55.546634837Z INF/provider 42 [_] Shutting down device worker "584eb6a1"
2016-10-17T07:02:55.546907887Z INF/device:plugins:service 5702 [0acc27f325995e40] Launching service
2016-10-17T07:02:55.547313290Z INF/provider 42 [_] Cleaning up device worker "8511aff5"
2016-10-17T07:02:55.547342303Z IMP/device:plugins:service 5703 [8511aff5] Service connection ended, attempting to relaunch
2016-10-17T07:02:55.547615935Z INF/device:plugins:service 5703 [8511aff5] Launching service
2016-10-17T07:02:55.547788106Z INF/device:plugins:service 5726 [584eb6a1] Launching service
2016-10-17T07:02:55.548494812Z WRN/device:plugins:touch 5703 [8511aff5] Shell keeping minitouch running ended unexpectedly
2016-10-17T07:02:55.548626497Z INF/provider 42 [_] Cleaning up device worker "0acc27f325995e40"
2016-10-17T07:02:55.548669938Z WRN/device:plugins:touch 5702 [0acc27f325995e40] Shell keeping minitouch running ended unexpectedly
2016-10-17T07:02:55.548694537Z INF/provider 42 [_] Cleaning up device worker "584eb6a1"
2016-10-17T07:02:55.548822445Z INF/provider 42 [_] Gracefully killing device worker "8511aff5"
2016-10-17T07:02:55.548952051Z INF/provider 42 [_] Gracefully killing device worker "0acc27f325995e40"
2016-10-17T07:02:55.549098352Z INF/provider 42 [_] Gracefully killing device worker "584eb6a1"
2016-10-17T07:02:55.549248064Z INF/device:plugins:touch 5703 [8511aff5] Disconnecting from minitouch service
2016-10-17T07:02:55.549878573Z INF/device:plugins:touch 5702 [0acc27f325995e40] Disconnecting from minitouch service
2016-10-17T07:02:55.550081810Z IMP/device:plugins:service 5726 [584eb6a1] Service connection ended, attempting to relaunch
2016-10-17T07:02:55.550323912Z INF/device:plugins:service 5726 [584eb6a1] Launching service
2016-10-17T07:02:55.550644109Z FTL/util:lifecycle 5703 [8511aff5] Forward shell ended; we shall share its fate
2016-10-17T07:02:55.550882189Z WRN/device:plugins:touch 5726 [584eb6a1] Shell keeping minitouch running ended unexpectedly
2016-10-17T07:02:55.550948222Z FTL/util:lifecycle 5703 [8511aff5] Shutting down due to fatal error
2016-10-17T07:02:55.551401129Z INF/device:plugins:touch 5726 [584eb6a1] Disconnecting from minitouch service
2016-10-17T07:02:55.551965730Z FTL/util:lifecycle 5702 [0acc27f325995e40] Forward shell ended; we shall share its fate
2016-10-17T07:02:55.552137429Z FTL/util:lifecycle 5702 [0acc27f325995e40] Shutting down due to fatal error
2016-10-17T07:02:55.552756550Z FTL/util:lifecycle 5726 [584eb6a1] Forward shell ended; we shall share its fate
2016-10-17T07:02:55.552932649Z FTL/util:lifecycle 5726 [584eb6a1] Shutting down due to fatal error
2016-10-17T07:02:55.554813915Z INF/provider 42 [_] Device worker "0acc27f325995e40" has retired
2016-10-17T07:02:55.555201840Z INF/provider 42 [_] Device worker "8511aff5" has retired
2016-10-17T07:02:55.556393107Z INF/provider 42 [_] Device worker "584eb6a1" has retired
2016-10-17T07:02:55.687654593Z INF/provider 42 [_] Found device "8511aff5" (offline)
2016-10-17T07:02:55.688603979Z INF/provider 42 [_] Found device "0acc27f325995e40" (offline)
2016-10-17T07:02:55.692510950Z INF/provider 42 [_] Found device "584eb6a1" (offline)
2016-10-17T07:02:55.706562045Z INF/reaper 36 [reaper001] Device "8511aff5" is present
2016-10-17T07:02:55.708030467Z INF/provider 42 [_] Registered device "8511aff5"
2016-10-17T07:02:55.718779979Z INF/provider 42 [_] Registered device "0acc27f325995e40"
2016-10-17T07:02:55.719010399Z INF/provider 42 [_] Lost device "0acc27f325995e40" (offline)
2016-10-17T07:02:55.719535589Z INF/reaper 36 [reaper001] Device "0acc27f325995e40" is present
2016-10-17T07:02:55.719739646Z INF/provider 42 [_] Registered device "584eb6a1"
2016-10-17T07:02:55.720690683Z INF/reaper 36 [reaper001] Device "584eb6a1" is present
2016-10-17T07:02:55.770205494Z INF/provider 42 [_] Device "8511aff5" is now "device" (was "offline")
2016-10-17T07:02:55.770436287Z INF/provider 42 [_] Device "584eb6a1" is now "unauthorized" (was "offline")
2016-10-17T07:02:55.808433160Z INF/provider 42 [_] Device "584eb6a1" is now "device" (was "unauthorized")
2016-10-17T07:02:56.123963555Z INF/device:support:push 5786 [8511aff5] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T07:02:56.125764472Z INF/device 5786 [8511aff5] Preparing device
2016-10-17T07:02:56.131317759Z INF/device:support:push 5792 [584eb6a1] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T07:02:56.133309050Z INF/device 5792 [584eb6a1] Preparing device
2016-10-17T07:02:56.425718000Z INF/device:support:sub 5786 [8511aff5] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T07:02:56.426414477Z INF/device:support:sub 5786 [8511aff5] Subscribing to permanent channel "_ALL"
2016-10-17T07:02:56.433500342Z INF/device:support:sub 5792 [584eb6a1] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T07:02:56.434347097Z INF/device:support:sub 5792 [584eb6a1] Subscribing to permanent channel "_ALL"
2016-10-17T07:02:56.478289337Z INF/device:support:properties 5786 [8511aff5] Loading properties
2016-10-17T07:02:56.523295607Z INF/device:support:properties 5792 [584eb6a1] Loading properties
2016-10-17T07:02:56.546917867Z INF/device:support:abi 5786 [8511aff5] Supports ABIs armeabi-v7a, armeabi
2016-10-17T07:02:56.644128789Z INF/device:support:abi 5792 [584eb6a1] Supports ABIs armeabi-v7a, armeabi
2016-10-17T07:02:56.729173269Z INF/device:resources:service 5786 [8511aff5] Checking whether we need to install STFService
2016-10-17T07:02:57.028043124Z INF/device:resources:service 5792 [584eb6a1] Checking whether we need to install STFService
2016-10-17T07:02:57.124096507Z INF/provider 42 [_] Found device "0acc27f325995e40" (offline)
2016-10-17T07:02:57.139255407Z INF/reaper 36 [reaper001] Device "0acc27f325995e40" is present
2016-10-17T07:02:57.139320994Z INF/provider 42 [_] Registered device "0acc27f325995e40"
2016-10-17T07:02:57.188296844Z INF/provider 42 [_] Device "0acc27f325995e40" is now "device" (was "offline")
2016-10-17T07:02:57.388927894Z INF/device:resources:service 5786 [8511aff5] Running version check
2016-10-17T07:02:57.499805319Z INF/device:support:push 5810 [0acc27f325995e40] Sending output to "tcp://127.0.0.1:7116"
2016-10-17T07:02:57.501577732Z INF/device 5810 [0acc27f325995e40] Preparing device
2016-10-17T07:02:57.530652968Z INF/device:resources:service 5792 [584eb6a1] Running version check
2016-10-17T07:02:57.789569044Z INF/device:support:sub 5810 [0acc27f325995e40] Receiving input from "tcp://127.0.0.1:7114"
2016-10-17T07:02:57.790457012Z INF/device:support:sub 5810 [0acc27f325995e40] Subscribing to permanent channel "_ALL"
2016-10-17T07:02:57.867915901Z INF/device:support:properties 5810 [0acc27f325995e40] Loading properties
2016-10-17T07:02:57.899083895Z INF/device:support:abi 5810 [0acc27f325995e40] Supports ABIs armeabi-v7a, armeabi
2016-10-17T07:02:58.026840986Z INF/device:resources:service 5810 [0acc27f325995e40] Checking whether we need to install STFService
2016-10-17T07:02:58.224376792Z INF/device:resources:service 5786 [8511aff5] STFService up to date
2016-10-17T07:02:58.228563415Z INF/device:plugins:service 5786 [8511aff5] Launching agent
2016-10-17T07:02:58.363642143Z INF/device:resources:service 5792 [584eb6a1] STFService up to date
2016-10-17T07:02:58.367940365Z INF/device:plugins:service 5792 [584eb6a1] Launching agent
2016-10-17T07:02:58.626771440Z INF/device:resources:service 5810 [0acc27f325995e40] Running version check
2016-10-17T07:02:58.988095496Z INF/device:plugins:service 5786 [8511aff5] Launching service
2016-10-17T07:02:58.989289516Z INF/device:plugins:service 5792 [584eb6a1] Launching service
2016-10-17T07:02:59.034579471Z INF/device:plugins:service 5786 [8511aff5] Agent says: "Listening on @stfagent"
2016-10-17T07:02:59.035234824Z INF/device:plugins:service 5786 [8511aff5] Agent says: "InputClient started"
2016-10-17T07:02:59.075286802Z INF/device:plugins:service 5792 [584eb6a1] Agent says: "Listening on @stfagent"
2016-10-17T07:02:59.078628091Z INF/device:plugins:service 5792 [584eb6a1] Agent says: "InputClient started"
2016-10-17T07:02:59.442656319Z INF/device:resources:service 5810 [0acc27f325995e40] STFService up to date
2016-10-17T07:02:59.443809750Z INF/device:plugins:service 5810 [0acc27f325995e40] Launching agent
2016-10-17T07:02:59.689378586Z INF/device:plugins:display 5792 [584eb6a1] Reading display info
2016-10-17T07:02:59.752579367Z INF/device:plugins:phone 5792 [584eb6a1] Fetching phone info
2016-10-17T07:02:59.761798576Z INF/device:plugins:identity 5792 [584eb6a1] Solving identity
2016-10-17T07:02:59.762287089Z INF/device:plugins:solo 5792 [584eb6a1] Subscribing to permanent channel "FXuFnqglunHbDC4CJPZAIn+6Q48="
2016-10-17T07:02:59.763431800Z INF/device:plugins:screen:stream 5792 [584eb6a1] Starting WebSocket server on port 7452
2016-10-17T07:02:59.939469628Z INF/device:plugins:display 5786 [8511aff5] Reading display info
2016-10-17T07:02:59.976427540Z WRN/device:plugins:data 5792 [584eb6a1] Unable to find device data { serial: '584eb6a1',
2016-10-17T07:02:59.976455281Z   platform: 'Android',
2016-10-17T07:02:59.976460439Z   manufacturer: 'SAMSUNG',
2016-10-17T07:02:59.976463832Z   operator: null,
2016-10-17T07:02:59.976467105Z   model: 'SHV-E330S',
2016-10-17T07:02:59.976470409Z   version: '5.0.1',
2016-10-17T07:02:59.976474075Z   abi: 'armeabi-v7a',
2016-10-17T07:02:59.976477689Z   sdk: '21',
2016-10-17T07:02:59.976481060Z   product: 'ks01lteskt',
2016-10-17T07:02:59.976484580Z   display: 
2016-10-17T07:02:59.976487812Z    { id: 0,
2016-10-17T07:02:59.976492379Z      width: 1080,
2016-10-17T07:02:59.976496033Z      height: 1920,
2016-10-17T07:02:59.976499335Z      xdpi: 442.45098876953125,
2016-10-17T07:02:59.976502575Z      ydpi: 439.35101318359375,
2016-10-17T07:02:59.976506172Z      fps: 60,
2016-10-17T07:02:59.976509685Z      density: 3,
2016-10-17T07:02:59.976512955Z      rotation: 0,
2016-10-17T07:02:59.976516254Z      secure: true,
2016-10-17T07:02:59.976519488Z      size: 5.005581516669951,
2016-10-17T07:02:59.976523015Z      url: 'ws://192.168.1.7:7452' },
2016-10-17T07:02:59.976527385Z   phone: { imei: '356432056958486', network: 'UNKNOWN' } }
2016-10-17T07:02:59.977965207Z INF/device:plugins:touch 5792 [584eb6a1] Touch origin is top left
2016-10-17T07:02:59.978578632Z INF/device:plugins:touch 5792 [584eb6a1] Requesting touch consumer to start
2016-10-17T07:02:59.979326285Z INF/device:plugins:touch 5792 [584eb6a1] Launching screen service
2016-10-17T07:02:59.986631262Z INF/device:plugins:touch 5792 [584eb6a1] Connecting to minitouch service
2016-10-17T07:03:00.024475180Z INF/device:plugins:phone 5786 [8511aff5] Fetching phone info
2016-10-17T07:03:00.029298266Z INF/device:plugins:identity 5786 [8511aff5] Solving identity
2016-10-17T07:03:00.031438925Z INF/device:plugins:solo 5786 [8511aff5] Subscribing to permanent channel "+CxO2iowp9IVn72MKxk2c+puwNI="
2016-10-17T07:03:00.033626929Z INF/device:plugins:screen:stream 5786 [8511aff5] Starting WebSocket server on port 7544
2016-10-17T07:03:00.154485028Z WRN/device:plugins:data 5786 [8511aff5] Unable to find device data { serial: '8511aff5',
2016-10-17T07:03:00.154515796Z   platform: 'Android',
2016-10-17T07:03:00.154523870Z   manufacturer: 'LGE',
2016-10-17T07:03:00.154529104Z   operator: null,
2016-10-17T07:03:00.154533304Z   model: 'LG-F260S',
2016-10-17T07:03:00.154537388Z   version: '4.4.2',
2016-10-17T07:03:00.154542160Z   abi: 'armeabi-v7a',
2016-10-17T07:03:00.154547324Z   sdk: '19',
2016-10-17T07:03:00.154551463Z   product: 'fx1sk_skt_kr',
2016-10-17T07:03:00.154555642Z   display: 
2016-10-17T07:03:00.154559655Z    { id: 0,
2016-10-17T07:03:00.154563619Z      width: 720,
2016-10-17T07:03:00.154568035Z      height: 1280,
2016-10-17T07:03:00.154572146Z      xdpi: 326.5710144042969,
2016-10-17T07:03:00.154576119Z      ydpi: 328.40399169921875,
2016-10-17T07:03:00.154580854Z      fps: 60,
2016-10-17T07:03:00.154585100Z      density: 2,
2016-10-17T07:03:00.154589203Z      rotation: 0,
2016-10-17T07:03:00.154593146Z      secure: true,
2016-10-17T07:03:00.154597163Z      size: 4.477991395714372,
2016-10-17T07:03:00.154601436Z      url: 'ws://192.168.1.7:7544' },
2016-10-17T07:03:00.154605860Z   phone: { imei: '355706052813097', network: 'UNKNOWN' } }
2016-10-17T07:03:00.156194521Z INF/device:plugins:service 5810 [0acc27f325995e40] Launching service
2016-10-17T07:03:00.156470526Z INF/device:plugins:touch 5786 [8511aff5] Touch origin is top left
2016-10-17T07:03:00.157358170Z INF/device:plugins:touch 5786 [8511aff5] Requesting touch consumer to start
2016-10-17T07:03:00.158500578Z INF/device:plugins:touch 5786 [8511aff5] Launching screen service
2016-10-17T07:03:00.162241023Z INF/device:plugins:touch 5786 [8511aff5] Connecting to minitouch service
2016-10-17T07:03:00.175717097Z INF/device:plugins:service 5810 [0acc27f325995e40] Agent says: "Listening on @stfagent"
2016-10-17T07:03:00.176684850Z INF/device:plugins:service 5810 [0acc27f325995e40] Agent says: "InputClient started"
2016-10-17T07:03:00.403603729Z INF/device:plugins:touch 5786 [8511aff5] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2016-10-17T07:03:00.421984105Z INF/device:plugins:touch 5786 [8511aff5] minitouch says: "Type A touch device synaptics_ts (1540x2560 with 11 contacts) detected on /dev/input/event2 (score 1000)"
2016-10-17T07:03:00.422438103Z INF/device:plugins:touch 5786 [8511aff5] minitouch says: "Note: hard-limiting maximum number of contacts to 10"
2016-10-17T07:03:00.477008689Z INF/device:plugins:touch 5786 [8511aff5] minitouch says: "Connection established"
2016-10-17T07:03:00.478335690Z INF/device:plugins:touch 5786 [8511aff5] Reading minitouch banner
2016-10-17T07:03:00.481069395Z INF/device:plugins:touch 5792 [584eb6a1] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
2016-10-17T07:03:00.541977075Z INF/device:plugins:vnc 5786 [8511aff5] Starting VNC server on port 7546
2016-10-17T07:03:00.547628548Z INF/device:plugins:browser 5786 [8511aff5] Loading browser list
2016-10-17T07:03:00.609442646Z INF/device:plugins:touch 5792 [584eb6a1] minitouch says: "Type B touch device sec_touchscreen (1079x1919 with 10 contacts) detected on /dev/input/event3 (score 1100)"
2016-10-17T07:03:00.616177721Z INF/device:plugins:browser 5786 [8511aff5] Updating browser list
2016-10-17T07:03:00.617286145Z WRN/device:plugins:browser 5786 [8511aff5] Unmapped browser "com.nate.android.portalmini"
2016-10-17T07:03:00.621909902Z INF/device:plugins:mute 5786 [8511aff5] Will not mute master volume during use
2016-10-17T07:03:00.709351187Z INF/device:plugins:touch 5792 [584eb6a1] Reading minitouch banner
2016-10-17T07:03:00.710421550Z INF/device:plugins:touch 5792 [584eb6a1] minitouch says: "Connection established"
2016-10-17T07:03:00.732336867Z INF/device:plugins:forward 5786 [8511aff5] Launching reverse port forwarding service
2016-10-17T07:03:00.738303884Z INF/device:plugins:forward 5786 [8511aff5] Connecting to reverse port forwarding service
2016-10-17T07:03:00.765126784Z INF/device:plugins:vnc 5792 [584eb6a1] Starting VNC server on port 7454
2016-10-17T07:03:00.771103569Z INF/device:plugins:browser 5792 [584eb6a1] Loading browser list
2016-10-17T07:03:00.806985041Z INF/device:plugins:browser 5792 [584eb6a1] Updating browser list
2016-10-17T07:03:00.813197386Z INF/device:plugins:mute 5792 [584eb6a1] Will not mute master volume during use
2016-10-17T07:03:01.020492878Z INF/device:plugins:display 5810 [0acc27f325995e40] Reading display info
2016-10-17T07:03:01.038509435Z INF/device:plugins:phone 5810 [0acc27f325995e40] Fetching phone info
2016-10-17T07:03:01.054388002Z INF/device:plugins:identity 5810 [0acc27f325995e40] Solving identity
2016-10-17T07:03:01.058082797Z INF/device:plugins:solo 5810 [0acc27f325995e40] Subscribing to permanent channel "FMWTMkLnoFBQN/l3qJQtoA02BwM="
2016-10-17T07:03:01.060200177Z INF/device:plugins:screen:stream 5810 [0acc27f325995e40] Starting WebSocket server on port 7540
2016-10-17T07:03:01.081645909Z INF/device:plugins:forward 5792 [584eb6a1] Launching reverse port forwarding service
2016-10-17T07:03:01.087779492Z INF/device:plugins:forward 5792 [584eb6a1] Connecting to reverse port forwarding service
2016-10-17T07:03:01.200463283Z INF/device:plugins:touch 5810 [0acc27f325995e40] Touch origin is top left
2016-10-17T07:03:01.202406344Z INF/device:plugins:touch 5810 [0acc27f325995e40] Requesting touch consumer to start
2016-10-17T07:03:01.203965045Z INF/device:plugins:touch 5810 [0acc27f325995e40] Launching screen service
2016-10-17T07:03:01.211150351Z INF/device:plugins:touch 5810 [0acc27f325995e40] Connecting to minitouch service
2016-10-17T07:03:01.263698962Z INF/device:plugins:touch 5810 [0acc27f325995e40] minitouch says: "Type B touch device touch_dev (1079x1919 with 10 contacts) detected on /dev/input/event1 (score 1100)"
2016-10-17T07:03:01.324163396Z INF/device:plugins:touch 5810 [0acc27f325995e40] minitouch says: "Connection established"
2016-10-17T07:03:01.325402383Z INF/device:plugins:touch 5810 [0acc27f325995e40] Reading minitouch banner
2016-10-17T07:03:01.377754063Z INF/device:plugins:vnc 5810 [0acc27f325995e40] Starting VNC server on port 7542
2016-10-17T07:03:01.384088821Z INF/device:plugins:browser 5810 [0acc27f325995e40] Loading browser list
2016-10-17T07:03:01.393917723Z INF/device:plugins:browser 5810 [0acc27f325995e40] Updating browser list
2016-10-17T07:03:01.399065032Z INF/device:plugins:mute 5810 [0acc27f325995e40] Will not mute master volume during use
2016-10-17T07:03:01.552262792Z INF/device:plugins:forward 5810 [0acc27f325995e40] Launching reverse port forwarding service
2016-10-17T07:03:01.561567390Z INF/device:plugins:forward 5810 [0acc27f325995e40] Connecting to reverse port forwarding service
2016-10-17T07:03:01.933828911Z INF/device:plugins:connect 5786 [8511aff5] Listening on port 7545
2016-10-17T07:03:01.935557739Z INF/device 5786 [8511aff5] Fully operational
2016-10-17T07:03:01.958739427Z INF/util:datautil 66 [_] Device database does not have an entry for "8511aff5" (model "LG-F260S"/"fx1sk_skt_kr"). This is not an error, it only means that we don't have data for it yet.
2016-10-17T07:03:02.118398132Z INF/device:plugins:connect 5792 [584eb6a1] Listening on port 7453
2016-10-17T07:03:02.121299005Z INF/device 5792 [584eb6a1] Fully operational
2016-10-17T07:03:02.134359201Z INF/util:datautil 66 [_] Device database does not have an entry for "584eb6a1" (model "SHV-E330S"/"ks01lteskt"). This is not an error, it only means that we don't have data for it yet.
2016-10-17T07:03:02.416310752Z INF/device:plugins:connect 5810 [0acc27f325995e40] Listening on port 7541
2016-10-17T07:03:02.418143785Z INF/device 5810 [0acc27f325995e40] Fully operational
2016-10-17T07:03:07.129411837Z INF/provider 42 [_] Providing all 8 device(s)
2016-10-17T07:04:39.119837853Z INF/storage:temp 72 [*] Cleaning up inactive resource "b6e9b00a-1be7-40b7-84ee-9e2c6a161f88"
  - screepcap (slow)
- camera (fast, too complex)
- other
 ``` java
try {
    Method screenshot = Surface.class.getMethod("screenshot", new Class[] { int.class,
                        int.class });
    screenshot.setAccessible(true);
    mScreenBitmap = (Bitmap) screenshot.invoke(Surface.class.newInstance(),
        new Object[]{(int) dims[0], (int) dims[1]});
} catch (Exception e) {
    e.printStackTrace();
}
```

googled out this method, recorded here. But I have to say I really do not like java.
 yep, maybe need to use `shell export CLASSPATH=.... app_process ...`, anyway something like this. Still a long way to go.
 I write a program which use screencap can reach 1~2 fps. Maybe totally write in C will up to 4~7 fps
 HTC 9088 
![image](https://cloud.githubusercontent.com/assets/3281689/19751946/d4bf9f80-9c2b-11e6-888d-6fea637e86cf.png)

I see that the minicap binaries are removed from stf/vendor directory, So where can I find the lastest binary? thanks.
  There is a sad new that company behind rethinkdb is shuttingdow.Whether STF would plan to replace the database?
  While I can't donate my Pixel, I wanted to share the errors I'm seeing when STF is "Preparing" the device:

```
INF/provider 82174 [*] Cleaning up device worker "FA69T0304880"
ERR/provider 82174 [*] Device worker "FA69T0304880" died with code 1
INF/provider 82174 [*] Restarting device worker "FA69T0304880"



INF/device:support:push 82197 [FA69T0304880] Sending output to "tcp://127.0.0.1:7116"
INF/device 82197 [FA69T0304880] Preparing device

INF/device:support:sub 82197 [FA69T0304880] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 82197 [FA69T0304880] Subscribing to permanent channel "*ALL"
INF/device:support:properties 82197 [FA69T0304880] Loading properties
INF/device:support:abi 82197 [FA69T0304880] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
FTL/device 82197 [FA69T0304880] Setup had an error Error: At least one of these paths should exist: /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-7.1/arm64-v8a/minicap.so, /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-25/arm64-v8a/minicap.so, /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-7.1/armeabi-v7a/minicap.so, /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-25/armeabi-v7a/minicap.so, /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-7.1/armeabi/minicap.so, /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-25/armeabi/minicap.so
    at Object.module.exports.requiredMatch (/usr/local/lib/node_modules/stf/lib/util/pathutil.js:33:9)
    at /usr/local/lib/node_modules/stf/lib/units/device/resources/minicap.js:35:23
    at SerialSyrup.ParallelSyrup.invoke (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at tryCatch1 (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/util.js:63:19)
    at Promise$_callHandler [as _callHandler] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:708:13)
    at Promise$_settlePromiseFromHandler [as _settlePromiseFromHandler] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:724:18)
    at Promise$_settlePromiseAt [as _settlePromiseAt] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:896:14)
    at Promise$_fulfillPromises [as _fulfillPromises] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:1041:14)
    at Async$_consumeFunctionBuffer [as _consumeFunctionBuffer] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/async.js:74:12)
    at Async$consumeFunctionBuffer (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/async.js:37:14)
    at nextTickCallbackWith0Args (node.js:415:9)
    at process._tickCallback (node.js:344:13)
FTL/util:lifecycle 82197 [FA69T0304880] Shutting down due to fatal error
INF/provider 82174 [*] Cleaning up device worker "FA69T0304880"
ERR/provider 82174 [*] Device worker "FA69T0304880" died with code 1
INF/provider 82174 [*] Restarting device worker "FA69T0304880"

INF/device:support:push 82198 [FA69T0304880] Sending output to "tcp://127.0.0.1:7116"
INF/device 82198 [FA69T0304880] Preparing device
```

It appears to continually loop through these errors-- I saw them at least 40 times. 

Hope this helps!
 You're 100% correct. I was on an older version. My Pixel is working great on it now. Thanks!
 I'm not seeing it. Here's what it looks like when I plug in the Pixel:

```
INF/provider 91249 [*] Found device "FA69V0309310" (offline)
INF/reaper 91248 [reaper001] Device "FA69V0309310" is present
INF/provider 91249 [*] Registered device "FA69V0309310"
INF/provider 91249 [*] Device "FA69V0309310" is now "device" (was "offline")
INF/device:support:push 91312 [FA69V0309310] Sending output to "tcp://127.0.0.1:7116"
INF/device 91312 [FA69V0309310] Preparing device
INF/device:support:sub 91312 [FA69V0309310] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 91312 [FA69V0309310] Subscribing to permanent channel "*ALL"
INF/device:support:properties 91312 [FA69V0309310] Loading properties
INF/device:support:abi 91312 [FA69V0309310] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:service 91312 [FA69V0309310] Checking whether we need to install STFService
INF/device:resources:service 91312 [FA69V0309310] Running version check
INF/device:resources:service 91312 [FA69V0309310] STFService up to date
INF/device:plugins:service 91312 [FA69V0309310] Launching agent
INF/device:plugins:service 91312 [FA69V0309310] Agent says: "Listening on @stfagent"
INF/device:plugins:service 91312 [FA69V0309310] Launching service
INF/device:plugins:service 91312 [FA69V0309310] Agent says: "InputClient started"
INF/device:plugins:display 91312 [FA69V0309310] Reading display info
INF/device:plugins:phone 91312 [FA69V0309310] Fetching phone info
INF/device:plugins:identity 91312 [FA69V0309310] Solving identity
INF/device:plugins:solo 91312 [FA69V0309310] Subscribing to permanent channel "ChWTiudFEoUAM9LeyywnbA4zp64="
INF/device:plugins:screen:stream 91312 [FA69V0309310] Starting WebSocket server on port 7412
WRN/device:plugins:data 91312 [FA69V0309310] Unable to find device data { serial: 'FA69V0309310',
  platform: 'Android',
  manufacturer: 'GOOGLE',
  operator: null,
  model: 'Pixel',
  version: '7.1',
  abi: 'arm64-v8a',
  sdk: '25',
  product: 'sailfish',
  display: 
   { id: 0,
     width: 1080,
     height: 1920,
     xdpi: 442.45098876953125,
     ydpi: 443.3450012207031,
     fps: 60.000003814697266,
     density: 2.625,
     rotation: 0,
     secure: true,
     size: 4.971247790102727,
     url: 'ws://localhost:7412' },
  phone: { imei: '352689080865706', network: 'UNKNOWN' } }
INF/device:plugins:touch 91312 [FA69V0309310] Touch origin is top left
INF/device:plugins:touch 91312 [FA69V0309310] Requesting touch consumer to start
INF/device:plugins:touch 91312 [FA69V0309310] Launching screen service
INF/device:plugins:touch 91312 [FA69V0309310] Connecting to minitouch service
INF/device:plugins:touch 91312 [FA69V0309310] minitouch says: "Note: device /dev/input/mouse1 is not supported by libevdev"
INF/device:plugins:touch 91312 [FA69V0309310] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 91312 [FA69V0309310] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 91312 [FA69V0309310] minitouch says: "Type B touch device synaptics_dsxv26 (1079x1919 with 10 contacts) detected on /dev/input/event3 (score 2100)"
INF/device:plugins:touch 91312 [FA69V0309310] Reading minitouch banner
INF/device:plugins:touch 91312 [FA69V0309310] minitouch says: "Connection established"
INF/device:plugins:vnc 91312 [FA69V0309310] Starting VNC server on port 7414
INF/device:plugins:browser 91312 [FA69V0309310] Loading browser list
INF/device:plugins:browser 91312 [FA69V0309310] Updating browser list
INF/device:plugins:mute 91312 [FA69V0309310] Will not mute master volume during use
INF/device:plugins:forward 91312 [FA69V0309310] Launching reverse port forwarding service
INF/device:plugins:forward 91312 [FA69V0309310] Connecting to reverse port forwarding service
INF/device:plugins:connect 91312 [FA69V0309310] Listening on port 7413
INF/device 91312 [FA69V0309310] Fully operational
INF/util:datautil 91253 [*] Device database does not have an entry for "FA69V0309310" (model "Pixel"/"sailfish"). This is not an error, it only means that we don't have data for it yet.
INF/provider 91249 [*] Providing all 2 device(s)
```

This is what it shows when I take control of the device:

```
INF/util:datautil 91252 [*] Device database does not have an entry for "FA69V0309310" (model "Pixel"/"sailfish"). This is not an error, it only means that we don't have data for it yet.
IMP/device:plugins:group 91312 [FA69V0309310] Now owned by "test@email.com"
INF/device:plugins:group 91312 [FA69V0309310] Subscribing to group channel "VjMVDeIXSn6rfp30O0nr+Q=="
INF/util:datautil 91252 [*] Device database does not have an entry for "FA69V0309310" (model "Pixel"/"sailfish"). This is not an error, it only means that we don't have data for it yet.
INF/device:plugins:screen:stream 91312 [FA69V0309310] Keeping 801x1328 as current frame producer projection
INF/device:plugins:screen:stream 91312 [FA69V0309310] Requesting frame producer to start
INF/device:plugins:screen:stream 91312 [FA69V0309310] Launching screen service
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "PID: 18167"
INF/device:plugins:screen:stream 91312 [FA69V0309310] Connecting to minicap service
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: Using projection 1080x1920@747x1328/0"
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:241) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:244) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:251) Creating virtual display"
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:257) Creating buffer queue"
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:262) Creating CPU consumer"
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:266) Creating frame waiter"
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (external/MY_minicap/src/minicap_25.cpp:270) Publishing virtual display"
IMP/device:plugins:connect 91312 [FA69V0309310] Remote Connect Started for device "FA69V0309310" at "localhost:7413"
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 6268932 bytes for JPG encoder"
INF/device:plugins:screen:stream 91312 [FA69V0309310] Reading minicap banner
INF/device:plugins:screen:stream 91312 [FA69V0309310] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
```
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

This is more of a community question, but I am wondering if anyone knows of a used phone that can be purchased for <$30 USD for testing that is known to work with STF. I currently do not have any physical Android phones on hand, but am very eager to test with a physical device.
## What should have happened?

N/A
## Do you have an idea for a solution?

Potential to add as a suggested "testing" device for new users looking to get setup for cheap.
## How can we reproduce the issue?

N/A
## Help us understand your issue by providing context.

N/A
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->

N/A

If this is too broad/off topic, feel free to close. I just wanted to field some suggestions from the community. Thanks so much for your continued development of stf - its truly a great suite of software!
 Those were my thoughts - I'm fine getting something in pretty beat up condition just to test with. In the meantime, I've been using the AVD emulator (which works great, by the way!)
 Thanks for testing and the helpful info @sorccu! Is there any way around the uninitialized USB serial issue? Can it manually be (over)written? For $32 this seems like a great option for people looking to get a small test farm up and running on a budget.
  Hi,

I am developing new app with STF API but when i post 
url: /auth/api/v1/mock 
data : {"name":"test", "email":"test@gmail.com"} 

over postman, API return "invalid csrf token" error. I guess csrf can go in session. What i can do for it or must i change the authentication strategy over API ? 
 You should use token for authentication
 @codeskyblue how can i do with Postman ? I know, i tired you but i need help :(
 login must be manual
 this is not usefull API, thank you so much
 @sorccu you are right man but i dont want to login on browser screen, my web web application use that API step by step login>devices list>device details and test.

A lot user(recorded in rethink) can uses STF over my web application, how can i generate different  token for each person? Because they want to use same device and i cannot handle this situation.
  yeah it is a necessity, I have read all issues about logout and timeout, anyone resolve that. 
you may direct us simo
  I also tried to chmod via adb, also no effect at all :(
Seems this phone is kind of SPECIAL...
 We manage to solve this issue by turning minicap/minitouch into dynamic libraries, and loading them from Java. Jars need no +x permission to be executed. An extra benefit is that we dont have to deal with the PIE problem.
 No need to root, but have to create an extra shell script to make it run, extractly how /system/bin/pm and other java-based cmdline tools work. Is this the app_process trick you mentioned?
 @dkw72n hello，when i use zuk z1 and adb devices, it shows'no permission',i want to know how to solove this problem and what is the shell script you mentioned @sorccu thanks,i'm trying``` @liuang68 
1. build a JNI version  `minicap/minitouch`
2. make a java CLI wrapper that loads the JNI lib which was built in step 1

To run the java CLI wrapper, take a look at https://github.com/openstf/RotationWatcher.apk
the script is just those commands bundle together
 This issue is gone on my ZUK z2 plus after an official update to `Android N`.

also i have theoretical work-around for the `Android M` Zuk, with no code modification needed:
simply change every `/data/local/tmp` to `/data/data/com.android.shell`, too shame i can't verify that.
  Angular has publish 2.0 version. Wether STF upgrade the angular version?
 When that day comes, angular 3.0 comes out.
  step:
1.connect an android 7.0
2.restart stf
3.the devices can't be recognized
devices list:
012e8e2764d6bccc       device product:bullhead model:Nexus_5X device:bullhead

this is the err log:
![image](https://cloud.githubusercontent.com/assets/18346467/18857874/118e0a86-849a-11e6-8864-f178c55bacba.png)
 I have used the old version because I was rewited some code . So I try to Merge the new code.Thank you.
  hi,
I want to know that if I want to customize a page in STF and then after customization if I build my own image and push it on dockerhub, and then pull it while deploying it to real server, the docker file that you provided will do work for building that image or I have to modify something in the docker file? 

Thanks in advance!  There is a bug with android 6.0. Maybe it happened in adbkey-logcat.
device: 
1. huawei PLK-TL01H product:QK1503_A01 model:1503_A01 device:QK1503_A01
2. 360:product:QK1503_A01 model:1503_A01 device:QK1503_A01

step:
1.click one fo android 6.0 device to control
2.click the get logcat 

result:
![image](https://cloud.githubusercontent.com/assets/18346467/18831383/eaf13a1a-8417-11e6-8f81-f5cb8a5bf531.png)
 Which module cause the problem?Which file should be fix?It is module of adbkit?
  Hi!
When [check()](https://github.com/openstf/stf/blob/master/lib/units/provider/index.js#L304) executed with values `device.present = false` and `willStop = false`:

``` node
function check() {
  clearTimeout(timer)
  if (device.present) {
    <...>
  }
  else {
    stop()
  }
}
```

from [stop()](https://github.com/openstf/stf/blob/master/lib/units/provider/index.js#L296) started `worker.cancel()`:

``` node
function stop() {
  if (worker) {
    log.info('Shutting down device worker "%s"', device.id)
    worker.cancel()
  }
}
```

get into [catch(Promise.CancellationError, function()](https://github.com/openstf/stf/blob/master/lib/units/provider/index.js#L250) starting `procutil.gracefullyKill`:

``` node
.catch(Promise.CancellationError, function() {
  log.info('Gracefully killing device worker "%s"', device.id)
  return procutil.gracefullyKill(proc, options.killTimeout)
})
```

and if in `procutil.gracefullyKill` will error, get into [catch(procutil.ExitError, function(err)](https://github.com/openstf/stf/blob/master/lib/units/provider/index.js#L279):

``` node
.catch(procutil.ExitError, function(err) {
  if (!willStop) {
    log.error(
      'Device worker "%s" died with code %s'
      , device.id
      , err.code
    )
    log.info('Restarting device worker "%s"', device.id)
    return Promise.delay(500)
      .then(function() {
        return work()
      })
  }
})
```

since value `willStop = false` worker endlessly restarts.
I'm not sure that properly understood the provider logic, but this small fix helped me.
  Hi @sorccu 
I want to ask some questions.
1.Whether STFService.apk can obtain one of the process's performance datas? 
2.Whether STFService.apk can read files  from the phone's storage?
3.It STFService.apk are opened source ?
 Thank you
  Got minicap failure when connecting HUAWEI G730-U00, may be similar with #404 :

INF/util:datautil 42021 [_] Device database does not have an entry for "IJVKTSDQQGTOJVQ4" (model " G730-U00"/"G730-U00"). This is not an error, it only means that we don't have data for it yet.
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] Setting frame producer projection to 645x849
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] Requesting frame producer to start
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] Launching screen service
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] minicap says: "PID: 14659"
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] minicap says: "INFO: Using projection 540x960@478x849/0"
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:239) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:242) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:249) Creating virtual display"
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:255) Creating CPU consumer"
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] Connecting to minicap service
IMP/device:plugins:connect 42027 [IJVKTSDQQGTOJVQ4] Remote Connect Started for device "IJVKTSDQQGTOJVQ4" at "localhost:7401"
WRN/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] Disconnecting from minicap service
INF/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] Stopping minicap service
FTL/device:plugins:screen:stream 42027 [IJVKTSDQQGTOJVQ4] Frame producer had an error FailError: Failure: 'closed'
    at /usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/parser.js:228:29
    at processImmediate [as _immediateCallback](timers.js:383:17)
FTL/util:lifecycle 42027 [IJVKTSDQQGTOJVQ4] Shutting down due to fatal error
INF/provider 42018 [_] Cleaning up device worker "IJVKTSDQQGTOJVQ4"
ERR/provider 42018 [_] Device worker "IJVKTSDQQGTOJVQ4" died with code 1
INF/provider 42018 [_] Restarting device worker   ##"IJVKTSDQQGTOJVQ4"

<img width="1119" alt="screen shot 2016-09-20 at 11 44 17 am" src="https://cloud.githubusercontent.com/assets/6373277/18656892/c3a3aa5a-7f27-11e6-9628-aab4cfeb9219.png">
 Thanks for the quick response. HUAWEI uses its own CPU(named Haisi), not sure whether it is relevant to the minicap issue. I think it is a appropriate way to do so. if you fix some other Huawei device for similar issue, please update comment on this ticket, i will keep monitoring and then try if it also works
 ok, actually i close it by mistake. I just thought "Close and comment" means close the page. :0
 @sorccu I know some device not working well with minicap. So is this solution OK. Try to find another screenshot method if minicap not supported.
But as far as I know, the default android tool screenshot is too slow, do you know some other tools that can make screenshot a litter faster? Thanks any way.
 Maybe I can do it, just need ideas.
 @sorccu I have tried with servel methods.
- screencap   about 1.0s
- uiautomator screenshot about 0.7s
- use the outside camera, can reach 30fps, but the image quality is very low.
 @sorccu waiting your ideas....
 It is OK, currently I can use screencap instead.
 Maybe your idea is like https://chrome.google.com/webstore/detail/vysor/gidgenkbbabolejbgbpnhbimgjbffefm I guess.
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Haven't dig into it much. So I'm not sure if it's an issue or a restriction made by intent.

I have one OS user, one adb-key, two stf-user tokens. And I'm not able to connect devices via API using second token. Currently we are using docker to connect devices and run tests and we need to rebuild docker image for each stf-user.
## What should have happened?

I would like to be able to use devices based only on stf-user token
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
1. create two stf-users
2. try to add same adb-key to each user.

Only first one will be able to
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- openstf/stf:v2.0.0-beta
- Mock auth
 Got it. Sorry for bothering you and that i haven't found #170 by myself )

The reason we are using two different tokens is because we have two different teams (slightly more actually) and would like to distinguish devices used by them in webapp. Different users from this teams are also using farm to write tests. So we would like to share docker image for running tests instead of Dockerfile, because it would make it much easier to fix bugs in it.

So, there are two ways of fixing it – hack around with adb or add some device lockdown logic, that will provide `adb connect` url after it's done. Both of ways look cumbersome.

Can I close this?
 thanks @vbanthia @sorccu 
  STF version: 2.0.1
Hardware: all as recommended on Linux

To be able to extend idle user session to 1 hour we start provider service is started using "--group-timeout 3600"

But real timeout was set to 900*1000 ms

<STF_HOME>/lib/units/device/plugins/group.js (48-51 lines)
          channels.register(currentGroup.group, {
            timeout: timeout || options.groupTimeout
          , alias: solo.channel
          })

Not sure why but options.groupTimeout is not set correctly and default on is used. Only after hardcoding 3600000 we received extended user session.
Thanks.
 Vishal.
We start stf-provider by regular shell script command:

nohup stf provider --name NAME --connect-sub tcp://HOST:7250 --connect-push tcp://HOST:7270 --storage-url http://HOST --public-ip HOST --group-timeout 3600 --no-cleanup &

Absolutely the same command is used in systemd unit file:
ExecStart=/home/build/.linuxbrew/bin/stf provider --name NAME --connect-sub tcp://HOST:7250 --connect-push tcp://HOST:7270 --storage-url http://HOST --public-ip HOST --group-timeout 3600 --no-cleanup

As additional note: this provider service is configured remotely. Rest of the services are started on different servers.

To debug issue I updated a little bit group.js
log.info('Subscribing to group channel "%s"; timeout "%d"', currentGroup.group, timeout || options.groupTimeout)

and as result during startup I see there "900000" instead of desired "3600000"
Thanks.
 I replaced my host and names by value in brakets and looks like github just hide those values from description :)
Removed "<"  and ">" to make them visible
  Hello,
2 years ago, I've create an android device lab like the one in this project. I've plugged 18 android on 2 [Anker USB 3.0 9-Port Hub + 5V 2.1A Charging Port](http://www.ianker.com/product/68ANHUB-B10A), 1 hub plugged to 1 Mac Mini.
Everything was ok, I was able to make Appium auto tests, etc...
But after 2 years, I have a lot of swollen batteries. One year ago, I've scheduled a "power OFF" for the hubs during night to limit this swollen batteries phenomena, but it was not enough.
So I have one question : how do you manage this ? My purpose first was to send a lot of power to the devices so they don't die, but even with this Anker (that you rate 2/10 because of "insufficient power"), it was too much. Now I'm thinking about regular hubs without power supply to see...
Thanks
 Thanks for the fast answer,
I've tried to plug my android without battery and they didn't want to start...
Last year I've plugged a Nexus 6 on my hub and 10 month after the battery looks like it will explose.. Same for my Galaxy Note 3, a Huawei, a Galaxy Tab 4, ect...
So it's more about security (I'm afraid that a phone will start a fire) that care about batteries.
I will try fex days with 4 x 4 ports hub to see if it can deal with charge...
 I have an idea but never tried before. Because some device have to got a battery so the device can be started. What about change the battery into a large volume capacitor. So there is no worry about the swollen batteries problem. ^_^
 Device complains about that I need to rest every month. :)
 Did you find any solution for this? Do you have experience in the airflow stuff? How should this stop the batteries from gasing? That's right. Did you try it and do you have some statistics over the effect of the fans?  Hello guys, i am developing a module to integrate openstf with selenium grid to tests automation. 
I need some help and advices, the idea is make a plug and play on selenium grid using the openstf, when openstf detect a phone i will informe grid  with new device ready for work.
My Questions is, STF have already some service that can provide me this information when device is connected? Aswell i need 4 infos like udid, device name, plataform, and plataform version of this device. or a should make a module and import to stf and rebuild it?
 @gunta, I am try a new approach for implement the solution, now i am using zmq to try catch some message that show a new device connected. But zmq is new thing for me, i need to find channels and start getting the info  and with that i will launch my scripts at same time  that openstf recognize a new device :)
 @gunda can you confirm if i am acessing to the correct port fo recibe information about new devices?
i am connecting to  "tcp://localhost:7115 and  subscribe '*ALL'  or with that i will receive the new connected devices?
  I see that jade have been rename pug.Is there any changing or it just being renamed? 
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Hi,

I have a pretty long-running test, and my script is to call the api to reserve the device before testing starts, and release the device after testing ends.  When testing started, I can see the device was reserved successfully, but after around 15-20 minutes, the device was released automatically even though my testing was still going on.  That is really an unexpected behaviour because someone else can reserve and use it while my testing has not finished yet.

So, can anyone please share why this happened, and any way to avoid it, or extend the timeout? Thanks.
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 Hi Sorccu,

Thanks for the reply.
I have a separate automation platform, and just want to reserver/release device during test, so others cannot use them.  So, there's no interaction on STF platform, just on devices (running automation scripts).

So, --group-timeout parameter should be used while starting provider, right?  Then it will be passed to each "stf device" process when starting them?
 Have tried to start provider with --group-timeout parameter, seems working now. Thanks!
 Thanks vbanthia for your another great solution!
 Just to extend @vbanthia answer - you can set the timeout to zero, which will reserve the device for for infinite time, until you free it again using API delete, or clicking Stop using button in UI
  I need to add some modules to extend the UI features in stf, how to add the modules,
So that i should not get any dependency injection module error.

Please help me out in this.
 i tried adding new bower modules and got success in that. without any module error.
Thank you.
  I meet a problem, and I red https://github.com/openstf/stf/issues/250;but it seem to no  effect;I have tried npm rebuild zmq; 
![9a0b8add-fba8-4bbd-90b0-678d11addee7](https://cloud.githubusercontent.com/assets/20810414/18308165/f80309dc-7525-11e6-88b5-a721283fe117.png)
  @ sorccu，is /usr/local/lib/node_modules/ ?
 thank you ! I have solved it,
 @sorccu  look this,how to solve
![qq 20170611211931](https://user-images.githubusercontent.com/11188841/27011328-baf11fca-4eeb-11e7-8a16-c7110b831260.png)
   <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

Hi,
First: Thanks for this wonderful tool! You did a great job!! 

While using STF one question appeared very often: Is it possible to increase the timeout of a device stay connected to a user? After some time of inactivity the user will be removed from the device and the session will be cleared. This means the app under test with all its data is also gone and has to be installed again. Sometimes this is very painful.
## What should have happened?

Let the device stay longer occupied by a user.
## Do you have an idea for a solution?

Add a parameter while starting stf, e.g. --session-timeout 120 #min
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- we are using `stf local`
- Version used (git hash or `stf -V`): 1.1.1
- Environment name and version: Chrome  52.0.2743.116 (64-bit), node v4.2.6
- Operating System and version: Ubuntu 16.04.1
  Hi, this is not a bug, but a suggestion for a new feature.

Would be possible for you to add a button to restart adb `adb kill-server && adb start-server`

At least in mac os after a random time some devices disappear, and sometimes restarting adb fixes the problem.

Regards,
 I have the same problem i can't find the reason for this to happen, i think the problem can be associated to hubs. 
 yep, have to restart adb every day in OS X.
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

adbd.service and rethinkdb.service cannot start
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

I pulled below docker images on my Ubuntu server 16.04:

```
test@ubuntu:/etc/systemd/system$ docker images
REPOSITORY           TAG                 IMAGE ID            CREATED             SIZE
openstf/stf          latest              a5e85e901417        2 days ago          751.8 MB
rethinkdb            latest              e30940c8232c        5 days ago          183.9 MB
nginx                latest              4efb2fcdb1ab        12 days ago         183.4 MB
sorccu/adb           latest              d6e99adff7e2        5 weeks ago         25.88 MB
openstf/ambassador   latest              b1f0eb8297cf        12 months ago       6.46 MB
```

Then I tried to start each .service to make sure it can be started successfully.

I started nginx.service successfully by "sudo systemctl start nginx.service", and I saw it's running by cmd "docker ps":
test@ubuntu:/etc/systemd/system$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
1b7abcbf9268        nginx:latest        "nginx"             19 minutes ago      Up 19 minutes                           nginx

But when I tried to start adbd.service, it showed in "docker ps" for a few seconds, then disappeared.  So does it mean that adbd.service FAILED to start?  

```
test@ubuntu:/etc/systemd/system$ sudo systemctl start adbd.service
test@ubuntu:/etc/systemd/system$ 
test@ubuntu:/etc/systemd/system$ docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED                  STATUS                  PORTS               NAMES
c493d061a1d0        sorccu/adb:latest   "/sbin/tini -- adb -a"   Less than a second ago   Up Less than a second                       adbd
1b7abcbf9268        nginx:latest        "nginx"                  22 minutes ago           Up 22 minutes                               nginx
test@ubuntu:/etc/systemd/system$ 
test@ubuntu:/etc/systemd/system$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
1b7abcbf9268        nginx:latest        "nginx"             22 minutes ago      Up 22 minutes                           nginx
```

when I checked by showing process, I saw following:

```
test@ubuntu:/etc/systemd/system$ ps -ef | grep "docker " | grep -v "grep"
root      3327     1  0 16:12 ?        00:00:00 /usr/bin/docker run --rm --name nginx --net host -v /srv/nginx/nginx.conf:/etc/nginx/nginx.conf:ro nginx:latest nginx
root      6358     1  2 17:22 ?        00:00:00 /usr/bin/docker pull sorccu/adb:latest
```

There is always a docker pull for adb image, why is that?  Is it the root cause that adbd.service cannot be started?

BTW, I used the exactly same unit file for adbd.service as in deployment.md

```
test@ubuntu:/etc/systemd/system$ cat adbd.service 
[Unit]
Description=ADB daemon
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull sorccu/adb:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  --privileged \
  -v /dev/bus/usb:/dev/bus/usb \
  --net host \
  sorccu/adb:latest
ExecStop=/usr/bin/docker exec %p adb kill-server
```

Regarding rethinkdb.service, I created unit file as below:

```
test@ubuntu:/etc/systemd/system$ cat rethinkdb.service 
[Unit]
Description=RethinkDB
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull rethinkdb:2.3
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStartPre=/bin/mkdir -p /srv/rethinkdb
ExecStartPre=/usr/bin/chattr -R +C /srv/rethinkdb
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -v /srv/rethinkdb:/data \
  --net host \
  rethinkdb:2.3 \
  rethinkdb --bind all \
    --cache-size 8192
ExecStop=-/usr/bin/docker stop -t 10 %p
```

I cannot start it successfully either.  

```
test@ubuntu:/etc/systemd/system$ sudo systemctl start rethinkdb.service
test@ubuntu:/etc/systemd/system$ 
test@ubuntu:/etc/systemd/system$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
1b7abcbf9268        nginx:latest        "nginx"             About an hour ago   Up About an hour                        nginx
```

In deployment.md, for rethinkdb version, it mentioned:

```
Update the version number in rethinkdb:2.3 for the latest release. We don't use rethinkdb:latest here
```

So, how to get the version number for rethinkdb after pull latest image?  Is this the root cause that rethinkdb.service cannot be started? 
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 found rethinkdb version:

```
test@ubuntu:/etc/systemd/system$ docker run -i -t rethinkdb /bin/sh
# rethinkdb -v
rethinkdb 2.3.5~0jessie (GCC 4.9.2)
```

but tried to replace version number in rethinkdb.service unit file, still cannot start container.
 directly run docker cmd, got following error, is it the reason that adbd.service cannot be started? How to resolve it? 

```
test@ubuntu:/etc/systemd/system$ /usr/bin/docker run --rm --name adbd --privileged -v /dev/bus/usb:/dev/bus/usb --net host sorccu/adb:latest
error: could not install *smartsocket* listener: Address already in use
```

And seems that adbd.service keeps restarting:

```
test@ubuntu:/etc/systemd/system$ ps -ef | grep "docker " | grep -v "grep"
root      3327     1  0 16:12 ?        00:00:00 /usr/bin/docker run --rm --name nginx --net host -v /srv/nginx/nginx.conf:/etc/nginx/nginx.conf:ro nginx:latest nginx
root     32576     1  0 19:37 ?        00:00:00 /usr/bin/docker pull sorccu/adb:latest
test@ubuntu:/etc/systemd/system$ ps -ef | grep "docker " | grep -v "grep"
root      3327     1  0 16:12 ?        00:00:00 /usr/bin/docker run --rm --name nginx --net host -v /srv/nginx/nginx.conf:/etc/nginx/nginx.conf:ro nginx:latest nginx
root     32665     1  0 19:37 ?        00:00:00 /usr/bin/docker pull sorccu/adb:latest
test@ubuntu:/etc/systemd/system$ ps -ef | grep "docker " | grep -v "grep"
root      3327     1  0 16:12 ?        00:00:00 /usr/bin/docker run --rm --name nginx --net host -v /srv/nginx/nginx.conf:/etc/nginx/nginx.conf:ro nginx:latest nginx
root     32751     1  1 19:37 ?        00:00:00 /usr/bin/docker pull sorccu/adb:latest
test@ubuntu:/etc/systemd/system$ ps -ef | grep "docker " | grep -v "grep"
root       372     1  2 19:37 ?        00:00:00 /usr/bin/docker pull sorccu/adb:latest
root      3327     1  0 16:12 ?        00:00:00 /usr/bin/docker run --rm --name nginx --net host -v /srv/nginx/nginx.conf:/etc/nginx/nginx.conf:ro nginx:latest nginx
test@ubuntu:/etc/systemd/system$ ps -ef | grep "docker " | grep -v "grep"
root       460     1  1 19:37 ?        00:00:00 /usr/bin/docker pull sorccu/adb:latest
root      3327     1  0 16:12 ?        00:00:00 /usr/bin/docker run --rm --name nginx --net host -v /srv/nginx/nginx.conf:/etc/nginx/nginx.conf:ro nginx:latest nginx
test@ubuntu:/etc/systemd/system$ 
```
 Thanks for your response!
I need local adb running because other programs need to use it.  So is it possible that stf can use local adb instead of docker adb?  If it's true, that means starting adbd.service is not necessary, right?

How about rethinkdb.service?  I still cannot start it.  Please help, I am really blocked right now :(
Thanks!
 this is what I got:

```
test@ubuntu:/etc/systemd/system$ sudo systemctl start rethinkdb   
test@ubuntu:/etc/systemd/system$ sudo systemctl status rethinkdb
● rethinkdb.service - LSB: This starts a set of rethinkdb server instances.
   Loaded: loaded (/etc/init.d/rethinkdb; static; vendor preset: enabled)
   Active: active (exited) since Tue 2016-09-06 10:55:27 CST; 1s ago
     Docs: man:systemd-sysv-generator(8)
  Process: 26314 ExecStop=/etc/init.d/rethinkdb stop (code=exited, status=0/SUCCESS)
  Process: 26340 ExecStart=/etc/init.d/rethinkdb start (code=exited, status=0/SUCCESS)

Sep 06 10:55:27 ubuntu systemd[1]: Starting LSB: This starts a set of rethinkdb server instances....
Sep 06 10:55:27 ubuntu rethinkdb[26340]: rethinkdb: No instances defined in /etc/rethinkdb/instances.d/
Sep 06 10:55:27 ubuntu rethinkdb[26340]: rethinkdb: See http://www.rethinkdb.com/docs/guides/startup/ for more information
Sep 06 10:55:27 ubuntu systemd[1]: Started LSB: This starts a set of rethinkdb server instances..
```
 my rethinkdb.service unit file as below.  Why cannot start it?  Anything wrong, pls help!

```
test@ubuntu:/etc/systemd/system$ cat rethinkdb.service 
[Unit]
Description=RethinkDB
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull rethinkdb:2.3.5
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStartPre=/bin/mkdir -p /srv/rethinkdb
ExecStartPre=/usr/bin/chattr -R +C /srv/rethinkdb
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -v /srv/rethinkdb:/data \
  -e "AUTHKEY=YOUR_RETHINKDB_AUTH_KEY_HERE_IF_ANY" \
  --net host \
  rethinkdb:2.3.5 \
  rethinkdb --bind all \
    --cache-size 8192
ExecStop=-/usr/bin/docker stop -t 10 %p
```

docker images:

```
test@ubuntu:/etc/systemd/system$ docker images
REPOSITORY           TAG                 IMAGE ID            CREATED             SIZE
openstf/stf          latest              a5e85e901417        3 days ago          751.8 MB
rethinkdb            2.3.5               e30940c8232c        6 days ago          183.9 MB
rethinkdb            latest              e30940c8232c        6 days ago          183.9 MB
nginx                latest              4efb2fcdb1ab        13 days ago         183.4 MB
sorccu/adb           latest              d6e99adff7e2        5 weeks ago         25.88 MB
openstf/ambassador   latest              b1f0eb8297cf        12 months ago       6.46 MB
```
 But I can directly start it by running following cmd (which is really same as what is in the rethinkdb.service file)

```
root@ubuntu:/etc/systemd/system# /usr/bin/docker run --rm --name rethinkdb -v /srv/rethinkdb:/data -e "AUTHKEY=YOUR_RETHINKDB_AUTH_KEY_HERE_IF_ANY" --net host rethinkdb:2.3.5 rethinkdb --bind all --cache-size 8192
Running rethinkdb 2.3.5~0jessie (GCC 4.9.2)...
Running on Linux 4.4.0-36-generic x86_64
Loading data from directory /data/rethinkdb_data
Listening for intracluster connections on port 29015
Listening for client driver connections on port 28015
Listening for administrative HTTP connections on port 8080
Listening on cluster addresses: 127.0.0.1, 172.17.0.1, 10.241.54.10, ::1, fe80::42:f3ff:fe16:512b%6, fe80::82c1:6eff:fe78:bb24%2
Listening on driver addresses: 127.0.0.1, 172.17.0.1, 10.241.54.10, ::1, fe80::42:f3ff:fe16:512b%6, fe80::82c1:6eff:fe78:bb24%2
Listening on http addresses: 127.0.0.1, 172.17.0.1, 10.241.54.10, ::1, fe80::42:f3ff:fe16:512b%6, fe80::82c1:6eff:fe78:bb24%2
Server ready, "ubuntu_2qi" f468da3d-422e-499c-8948-811093cec612
```
 Finally I got all the deployment done successfully, thanks anyway!
 docker run --rm -ti --net container:adbd sorccu/adb adb devices

when I run this command I didn't see the devices attached.

docker@boot2docker:~$ docker run --rm -ti --net container:adbd sorccu/adb adb devices
List of devices attached
  ```
INF/poorxy 25327 [*] Listening on port 7100
events.js:141
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE :::7100
    at Object.exports._errnoException (util.js:856:11)
    at exports._exceptionWithHostPort (util.js:879:20)
    at Server._listen2 (net.js:1234:14)
    at listen (net.js:1270:10)
    at Server.listen (net.js:1366:5)
    at module.exports (/Users/jeeva/stf/lib/units/poorxy/index.js:67:10)
    at Command.<anonymous> (/Users/jeeva/stf/lib/cli.js:802:30)
    at Command.listener (/Users/jeeva/stf/node_modules/commander/index.js:301:8)
    at emitTwo (events.js:87:13)
    at Command.emit (events.js:172:7)
    at Command.parseArgs (/Users/jeeva/stf/node_modules/commander/index.js:615:12)
    at Command.parse (/Users/jeeva/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/Users/jeeva/stf/lib/cli.js:1446:9)
    at Module._compile (module.js:425:26)
    at Object.Module._extensions..js (module.js:432:10)
    at Module.load (module.js:356:32)
FTL/cli:local 25312 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/Users/jeeva/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:87:13)
    at ChildProcess.emit (events.js:172:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)

```

I have tried to build the project locally and getting an error message: I am on Mac.

ERROR in ./bower_components/angular-ladda/src/angular-ladda.js
Module not found: Error: Cannot resolve module 'ladda' in /Users/jeeva/stf/bower_components/angular-ladda/src
 @ ./bower_components/angular-ladda/src/angular-ladda.js 13:4-41

Any suggestion .... 

<!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 Thanks found out that Airserver is using port 7100. after that went on launch the application but with an empty screen. In console log i get below errors

"1.99eccb4….chunk.js:84169 Uncaught Error: Cannot find module "ladda"webpackMissingModule @ 1.99eccb4….chunk.js:84169moduleName @ 1.99eccb4….chunk.js:84169(anonymous function) @ 1.99eccb4….chunk.js:84177__webpack_require__ @ commons.entry.js:51(anonymous function) @ 1.99eccb4….chunk.js:84145__webpack_require__ @ commons.entry.js:51(anonymous function) @ 1.99eccb4….chunk.js:84085__webpack_require__ @ commons.entry.js:51(anonymous function) @ 1.99eccb4….chunk.js:84069__webpack_require__ @ commons.entry.js:51(anonymous function) @ 1.99eccb4….chunk.js:82937__webpack_require__ @ commons.entry.js:51(anonymous function) @ app.entry.js:17webpackJsonpCallback @ commons.entry.js:19(anonymous function) @ 1.99eccb4….chunk.js:1
2016-09-04 12:58:34.266 1.99eccb4….chunk.js:73 Uncaught Error: [$injector:modulerr] Failed to instantiate module app due to:
Error: [$injector:nomod] Module 'app' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.
http://errors.angularjs.org/1.5.8/$injector/nomod?p0=app
    at http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:73:13
    at http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:2087:18
    at ensure (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:2011:39)
    at module (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:2085:15)
    at http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:4622:23
    at forEach (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:326:21)
    at loadModules (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:4606:6)
    at createInjector (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:4528:20)
    at doBootstrap (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:1763:21)
    at bootstrap (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:1784:13)
    at angularInit (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:1669:6)
    at http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:31768:6
    at trigger (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:3212:8)
    at defaultHandlerWrapper (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:3502:12)
    at eventHandler (http://localhost:7100/static/app/build/1.99eccb444e4fce9c089d.chunk.js:3490:10)
http://errors.angularjs.org/1.5.8/$injector/modulerr?p0=app&p1=Error%3A%20%…A7100%2Fstatic%2Fapp%2Fbuild%2F1.99eccb444e4fce9c089d.chunk.js%3A3490%3A10)"
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

I want to deploy STF on multiple Ubuntu machines on which I could not use docker solution.  I have to use stf local, but need detailed instruction on how to do it.
I want to use box1 (10.241.54.10) as the master box, and connect box2(10.241.54.16) to box1, so from http://10.241.54.10:7100/#!/devices, I can see all the devices connected to both box1 and box2.
## What should have happened?

My steps/cmds to run stf:
on box1:

```
start rethinkdb
stf local --allow-remote --public-ip 10.241.54.10 --provider 10.241.54.10 --provider-min-port 15000 --provider-max-port 20000
```

on box2:

```
start rethinkdb
stf local --allow-remote --public-ip 10.241.54.16 --provider 10.241.54.16 --provider-min-port 20000 --provider-max-port 25000
```

Then I can successfully see devices showing up from http://10.241.54.10:7100/#!/devices and http://10.241.54.16:7100/#!/devices
Above steps mean my stf env for both boxes are correct.

I tried to start stf local on box1:

```
stf local --allow-remote --public-ip 10.241.54.10 --provider 10.241.54.10 --provider-min-port 15000 --provider-max-port 20000
```

I checked the processes started by stf local and get the provider one:

```
test     16054 16018  0 Aug30 pts/15   00:01:22 /home/test/.linuxbrew/Cellar/node/6.1.0/bin/node /home/test/.linuxbrew/lib/node_modules/stf/lib/cli.js provider --name 10.241.54.10 --min-port 15000 --max-port 20000 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip 10.241.54.10 --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037 --vnc-initial-size 600x800 --allow-remote
```

then tried to start stf provider on box2(with same port as above):

```
stf provider --allow-remote --name 10.241.54.16 --min-port 20000 --max-port 25000 --connect-sub tcp://10.241.54.10:7114 --connect-push tcp://10.241.54.10:7116 --storage-url http://10.241.54.10
```

but it shows:
INF/provider 11938 [*] Providing all 0 of 5 device(s); ignoring "0123456789ABCDEF", "284cd8fe", "639aa439", "YLHU657DMRG6NNN7", "7TTKM78PNFS8SW7D"
I cannot see devices connected to box2 from http://10.241.54.16:7100/#!/devices
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->

So far, docker solution does not seem to be possible for me to go, so I want to achieve production-like deployment with stf command manually.
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): stf local
- Version used (git hash or `stf -V`): 2.0.1
- Environment name and version (e.g. Chrome 39, node.js 5.4): node 6.1.0
- Operating System and version: Ubuntu Server 14.04
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 Do you solve the problem?The same as me.
 No, I finally switched to docker solution.  Suggest you do the same :)
 yeah,i had done it.
However,a new problem.I can see device ,but the device always disapeared and disconnected when i click the device icon.Then it shows "the devices is disconnected".
Form adb devices,the device is inline and it's ok.
So,could you tell me how you deploy stf on multiple Ubuntu machines? Thank you so much.
I had tried many smartphones,make no difference.
 just follow the deployment guide.  First download docker images on multiple machines, then select one as the main host, create almost all .service file accordingly on it; on other hosts, only need to start provider service.
 I use  "--connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116" instead of  "--connect-sub tcp://publicip:7114 --connect-push tcp://publicip:7116" in the "stf provider" command and the problem  is solved.
  Hi, now I hava an issue，expect to get your consult.

I have researched some applications that realize remotely control to devices.  But almost all require  devices to have root permission.

**So, can you talk about how to realize control devices remotely  in STF ? especially devices don't have root permissions?**
Thank you very much. 
  Hello,

Apologies in advance if this question seems too basic.

I have been using appium to automate many app on real devices using Java.
Now I would like to run the same scripts via OpenSFT. Is this possible? If so, what are the exact desired capabilities i need to set during my driver creation?

Thanks and Regards,
Poorvika
 @poorvikamahesh : Refer this www.vimalselvam.com/2016/08/07/appium-parallel-execution-on-openstf/ for java implementation.
  ## Issue:

![image](https://cloud.githubusercontent.com/assets/8802748/17879128/cc4f8d02-6921-11e6-90e1-56fa57170a92.png)

just like mentioned above，when I connected to my Huawei Phone, the issue comes.
It says : FTL/device 6054 [582af7670d26] Setup had an error Error: Service had an error: "Error: Not found; no service started."
## My doubt

Why? I have tested on 5 phones, just this phone has this problem。  
At  the same time, I find no STFService.apk installed on it.
 this is the modle of this phone, made by Huawei:

```
List of devices attached 
582af7670d26           
device
  usb:14100000 
  product:C8817D 
  model:C8817D 
  device:hwC8817D
```

I guess the reason is antivirus apps，I have installed many antivirus apps on my phone.

Thank you for your reply!
@sorccu 
 I have checked my running apps through “Settings”，then stop some antivirus apps manually。

So, I still use "rethinkdb" and "stf local" commands.  At last, I find I can manipulate my phone through web browser remotely.

At the same time , I uploaded STFService.apk to  some antivirus-checking site, the result is "Safe".
**But I doubt why antivirus apps prevent to install STF.apk, or prevent this apk to start ?**
 I encountered the same issue, uninstalled a few antivirus apps(e.g. 360), but it is not working.  Could you please help take a look? Thx!

adb devices -l shows:
`LE67A06180224872       device usb:1-8.3.2 product:Le2_CN1 model:Le_X620 device:le_x6`
logcat shows:
`08-30 19:27:56.047 D/AndroidRuntime(14924): Calling main entry jp.co.cyberagent.stf.Agent
08-30 19:27:56.160 I/ADB_SERVICES( 7475): service_to_fd shell:am startservice --user 0 -a 'jp.co.cyberagent.stf.ACTION_START' -n 'jp.co.cyberagent.stf/.Service'
08-30 19:27:56.709 W/ActivityManager( 1156): don't allow to start ServiceInfo{f4d3cd jp.co.cyberagent.stf.Service}`
 ```
test@ubuntu:~$ adb -s LE67A06180224872 shell pm list package -3
package:jp.co.cyberagent.stf
package:io.appium.settings
package:com.letv.bbs
package:com.futurestar.mkmyle
package:com.wochacha
package:com.snda.wifilocating
package:com.linksure.wifimaster
package:com.snda.wifisocial
package:com.baidu.BaiduMap
package:com.example.test
package:io.appium.android.ime
package:com.lantern.test
package:com.sina.weibo
package:lbs.cmri.cmcc.com
package:org.dsjzj.mytracks
package:io.appium.unlock
package:cn.wps.moffice_eng
test@ubuntu:~$ 
```

I am thinking, is it possible that some ROMs themselves have some kind of restrictions?
 ```
test@ubuntu:~$ adb -s LE67A06180224872 shell pm list package
package:com.mediatek.gba
package:com.mediatek.ims
package:com.mediatek.ppl
package:jp.co.cyberagent.stf
package:com.huaqin.runtime
package:com.uei.quicksetsdk.letv
package:com.letv.android.quicksearchbox
package:com.android.providers.telephony
package:io.appium.settings
package:com.goodix.fingerprint
package:com.letv.android.agent
package:com.letv.android.theme
package:com.letv.android.zxing
package:com.android.providers.calendar
package:com.android.providers.media
package:com.softsim.control
package:com.mediatek.fwk.plugin
package:com.letv.android.account
package:com.android.wallpapercropper
package:com.mediatek.schpwronoff
package:com.letv.android.wallpaper
package:com.letv.leui.schpwronoff
package:com.redteamobile.virtual.softsim
package:com.dolby.daxappUI
package:com.letv.android.wallpaperonline
package:com.android.documentsui
package:com.letv.leui.sdk.data
package:com.letv.android.letvlive
package:com.letv.android.letvsafe
package:com.android.externalstorage
package:com.lesports.glivesports
package:com.mediatek.ygps
package:com.android.htmlviewer
package:com.letv.android.themesettings
package:com.android.mms.service
package:com.android.providers.downloads
package:com.fw.upgrade
package:com.letv.android.note
package:com.mediatek.engineermode
package:com.letv.bbs
package:com.mediatek.omacp
package:com.letv.letvshop
package:com.android.browser
package:com.android.providers.applications
package:com.le.share.x6pro
package:com.letv.android.usagestats
package:com.letv.android.personalized
package:com.baidu.input_letv
package:com.android.defcontainer
package:com.letv.app.appstore
package:com.android.providers.downloads.ui
package:com.android.pacprocessor
package:com.stv.stvpush
package:com.android.vendors.bridge.softsim
package:com.letv.android.freeflow
package:com.android.certinstaller
package:com.android.carrierconfig
package:android
package:com.mediatek.connectivity
package:com.android.contacts
package:com.android.camera2
package:com.letv.android.remotecontrol
package:com.android.mms
package:com.android.stk
package:com.android.launcher3
package:com.android.backupconfirm
package:se.dirac.acs
package:com.mediatek.bluetooth.dtt
package:com.letv.android.backup
package:com.android.statementservice
package:com.mediatek.voiceextension
package:com.letv.android.client
package:com.letv.android.setupwizard
package:com.mediatek.floatmenu
package:com.android.wallpaper.holospiral
package:com.futurestar.mkmyle
package:com.android.calendar
package:com.android.phasebeam
package:com.mediatek.providers.drm
package:com.letv.android.remotedevice
package:com.letv.android.backupclient
package:com.android.providers.settings
package:com.mediatek.miravision.ui
package:com.android.sharedstoragebackup
package:com.mediatek.batterywarning
package:com.android.printspooler
package:com.android.dreams.basic
package:com.letv.android.recorder
package:com.android.webview
package:com.android.inputdevices
package:com.mediatek
package:com.android.providers.calllogbackup
package:com.example
package:com.android.musicfx
package:com.android.VRAdmin
package:com.letv.bugpostbox
package:com.android.cellbroadcastreceiver
package:com.google.android.webview
package:com.android.onetimeinitializer
package:com.lvr.wizzard
package:com.mediatek.nlpservice
package:com.android.server.telecom
package:com.android.keychain
package:com.letv.android.compass
package:com.android.dialer
package:com.android.gallery3d
package:com.letv.domain
package:com.google.android.gms
package:com.google.android.gsf
package:com.mediatek.hetcomm
package:com.android.packageinstaller
package:com.wochacha
package:com.svox.pico
package:com.dsi.ant.server
package:com.android.proxyhandler
package:com.android.inputmethod.latin
package:com.snda.wifilocating
package:com.letv.agnes
package:com.mediatek.esntrack
package:com.letv.android.supermanager
package:com.letv.games
package:com.letv.android.powercontroller
package:com.linksure.wifimaster
package:com.android.managedprovisioning
package:com.snda.wifisocial
package:com.mediatek.calendarimporter
package:com.mediatek.atci.service
package:com.hq.lcdtest
package:com.letv.android.DebugUtils
package:com.mediatek.thermalmanager
package:com.letv.lesophoneclient
package:com.baidu.BaiduMap
package:com.android.noisefield
package:com.google.android.gsf.login
package:com.example.test
package:com.letv.android.bugreporter
package:com.mtk.telephony
package:com.letv.android.accountinfo
package:com.mediatek.voicecommand
package:com.letv.wallet
package:com.android.wallpaper.livepicker
package:com.alipay.authinfo.provider
package:com.dolby
package:com.baidu.map.location
package:com.letv.android.filemanager
package:io.appium.android.ime
package:com.hq.tptest
package:com.letv.android.themestore
package:com.android.settings
package:com.letv.android.ecoProvider
package:com.le.share.x6
package:com.fw.upgrade.sysoper
package:com.android.calculator2
package:com.huaqin.factoryservice
package:com.mediatek.lbs.em2.ui
package:com.letv.android.emojistore
package:com.letv.android.cloudservice
package:com.lantern.test
package:com.android.wallpaper
package:com.letv.bsp.crashhandler
package:com.android.vpndialogs
package:com.mediatek.systemupdate.sysoper
package:com.android.email
package:com.sina.weibo
package:com.android.music
package:com.android.phone
package:com.android.shell
package:lbs.cmri.cmcc.com
package:com.android.providers.userdictionary
package:se.dirac.examples.effectservice
package:com.android.location.fused
package:org.dsjzj.mytracks
package:com.android.deskclock
package:com.android.systemui
package:com.android.exchange
package:com.android.bluetoothmidiservice
package:sina.mobile.tianqitongletv
package:com.mediatek.systemupdate
package:com.hq.cameratest
package:com.letv.android.videoplayer
package:com.mediatek.mtklogger
package:com.mediatek.sensorhub.ui
package:com.letv.android.ota
package:io.appium.unlock
package:com.android.bluetooth
package:com.sohu.inputmethod.sogou.leshi
package:com.android.providers.contacts
package:com.android.captiveportallogin
package:com.hqfactory.factory
package:cn.wps.moffice_eng
package:com.mediatek.dataprotection
package:com.letv.android.LetvShareProvider
package:com.letv.android.phonecontrol
package:com.letv.android.euitransfer
test@ubuntu:~$ 
```
 Hi Sorccu,

I've pulled the latest stf:

```
test@ubuntu:~$ docker images
REPOSITORY           TAG                 IMAGE ID            CREATED             SIZE
openstf/stf          latest              a5e85e901417        4 days ago          751.8 MB
rethinkdb            2.3.5               e30940c8232c        7 days ago          183.9 MB
rethinkdb            latest              e30940c8232c        7 days ago          183.9 MB
nginx                latest              4efb2fcdb1ab        2 weeks ago         183.4 MB
sorccu/adb           latest              d6e99adff7e2        5 weeks ago         25.88 MB
openstf/ambassador   latest              b1f0eb8297cf        12 months ago       6.46 MB
test@ubuntu:~$ 
test@ubuntu:~$ docker pull openstf/stf:latest
latest: Pulling from openstf/stf

Digest: sha256:7fc0ae8484a5c18498a3f973259487aac4f899c658a0c536eebcd948f5abbfea
Status: Image is up to date for openstf/stf:latest
test@ubuntu:~$ 
```

But still 2 devices showing errors in provider log:

```
LE67A06180224872       device usb:1-8.3.2 product:Le2_CN1 model:Le_X620 device:le_x6
c806b880               device usb:1-8.4.1 product:k9 model:ZUK_Z1 device:k9
```

for LE67A06180224872, errors are same as before.

for c806b880, errors as below:

```
INF/device:plugins:touch 14966 [c806b880] Touch origin is top left
INF/device:plugins:touch 14966 [c806b880] Requesting touch consumer to start
INF/device:plugins:touch 14966 [c806b880] Launching screen service
INF/device:plugins:touch 14966 [c806b880] Connecting to minitouch service
INF/device:plugins:touch 14966 [c806b880] minitouch says: "/system/bin/sh: /data/local/tmp/minitouch: can't execute: Permission denied"
WRN/device:plugins:touch 14966 [c806b880] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 14966 [c806b880] Disconnecting from minitouch service
INF/device:plugins:touch 14966 [c806b880] Stopping minitouch service
INF/device:plugins:touch 14966 [c806b880] Launching screen service
INF/device:plugins:touch 14966 [c806b880] Connecting to minitouch service
INF/device:plugins:touch 14966 [c806b880] minitouch says: "/system/bin/sh: /data/local/tmp/minitouch: can't execute: Permission denied"
WRN/device:plugins:touch 14966 [c806b880] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 14966 [c806b880] Disconnecting from minitouch service
INF/device:plugins:touch 14966 [c806b880] Stopping minitouch service
INF/device:plugins:touch 14966 [c806b880] Launching screen service
INF/device:plugins:touch 14966 [c806b880] Connecting to minitouch service
INF/device:plugins:touch 14966 [c806b880] minitouch says: "/system/bin/sh: /data/local/tmp/minitouch: can't execute: Permission denied"
INF/device:support:push 14990 [LE67A06180224872] Sending output to "tcp://10.241.54.16:7270"
INF/device 14990 [LE67A06180224872] Preparing device
WRN/device:plugins:touch 14966 [c806b880] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 14966 [c806b880] Disconnecting from minitouch service
INF/device:plugins:touch 14966 [c806b880] Stopping minitouch service
INF/device:plugins:touch 14966 [c806b880] Launching screen service
INF/device:plugins:touch 14966 [c806b880] Connecting to minitouch service
INF/device:plugins:touch 14966 [c806b880] minitouch says: "/system/bin/sh: /data/local/tmp/minitouch: can't execute: Permission denied"
WRN/device:plugins:touch 14966 [c806b880] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 14966 [c806b880] Disconnecting from minitouch service
WRN/device:plugins:touch 14966 [c806b880] Will not apply desired state due to too many failures
INF/device:plugins:touch 14966 [c806b880] Stopping minitouch service
FTL/device 14966 [c806b880] Setup had an error Error: Failed more than 3 times in 10000ms
    at TouchConsumer._failLimitExceeded (/app/lib/units/device/plugins/touch/index.js:230:26)
    at FailCounter.emit (/app/node_modules/eventemitter3/index.js:117:35)
    at FailCounter.inc (/app/lib/util/failcounter.js:29:10)
    at TouchConsumer._outputEnded (/app/lib/units/device/plugins/touch/index.js:223:24)
    at RiskyStream.emit (/app/node_modules/eventemitter3/index.js:115:35)
    at RiskyStream.<anonymous> (/app/lib/util/riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:973:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
From previous event:
    at startConsumer (/app/lib/units/device/plugins/touch/index.js:511:14)
    at /app/lib/units/device/plugins/touch/index.js:526:12
    at SerialSyrup.ParallelSyrup.invoke (/app/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /app/node_modules/stf-syrup/lib/serial.js:43:33
    at _combinedTickCallback (internal/process/next_tick.js:67:7)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/util:lifecycle 14966 [c806b880] Shutting down due to fatal error
INF/provider 1 [*] Cleaning up device worker "c806b880"
ERR/provider 1 [*] Device worker "c806b880" died with code 1
```
 @xiaweixing  I have the same phone(le_x6) and the same problem. I sovled it by pushing STFService.apk to /system/priv-app/STFService/STFService.apk, the service will automatically start after a  reboot, and everything works fine now.
 @test01wrk Thanks a lot for the info!!  But how and where can I download the latest STFService.apk?  I couldn't figure it out yet :(
 Great!! It worked like a charm!! Thank you so much!!
 @sorccu I posted another device issue earlier together with le_x620, but it is still not resolved.  Is it possible for you to test it? Or any ideas how to troubleshoot? Thx!

```
c806b880               device usb:1-8.4.1 product:k9 model:ZUK_Z1 device:k9
```

errors as below:

```
INF/device:plugins:touch 14966 [c806b880] Touch origin is top left
INF/device:plugins:touch 14966 [c806b880] Requesting touch consumer to start
INF/device:plugins:touch 14966 [c806b880] Launching screen service
INF/device:plugins:touch 14966 [c806b880] Connecting to minitouch service
INF/device:plugins:touch 14966 [c806b880] minitouch says: "/system/bin/sh: /data/local/tmp/minitouch: can't execute: Permission denied"
WRN/device:plugins:touch 14966 [c806b880] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 14966 [c806b880] Disconnecting from minitouch service
INF/device:plugins:touch 14966 [c806b880] Stopping minitouch service
INF/device:plugins:touch 14966 [c806b880] Launching screen service
INF/device:plugins:touch 14966 [c806b880] Connecting to minitouch service
INF/device:plugins:touch 14966 [c806b880] minitouch says: "/system/bin/sh: /data/local/tmp/minitouch: can't execute: Permission denied"
WRN/device:plugins:touch 14966 [c806b880] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 14966 [c806b880] Disconnecting from minitouch service
INF/device:plugins:touch 14966 [c806b880] Stopping minitouch service
INF/device:plugins:touch 14966 [c806b880] Launching screen service
INF/device:plugins:touch 14966 [c806b880] Connecting to minitouch service
INF/device:plugins:touch 14966 [c806b880] minitouch says: "/system/bin/sh: /data/local/tmp/minitouch: can't execute: Permission denied"
INF/device:support:push 14990 [LE67A06180224872] Sending output to "tcp://10.241.54.16:7270"
INF/device 14990 [LE67A06180224872] Preparing device
WRN/device:plugins:touch 14966 [c806b880] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 14966 [c806b880] Disconnecting from minitouch service
INF/device:plugins:touch 14966 [c806b880] Stopping minitouch service
INF/device:plugins:touch 14966 [c806b880] Launching screen service
INF/device:plugins:touch 14966 [c806b880] Connecting to minitouch service
INF/device:plugins:touch 14966 [c806b880] minitouch says: "/system/bin/sh: /data/local/tmp/minitouch: can't execute: Permission denied"
WRN/device:plugins:touch 14966 [c806b880] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 14966 [c806b880] Disconnecting from minitouch service
WRN/device:plugins:touch 14966 [c806b880] Will not apply desired state due to too many failures
INF/device:plugins:touch 14966 [c806b880] Stopping minitouch service
FTL/device 14966 [c806b880] Setup had an error Error: Failed more than 3 times in 10000ms
    at TouchConsumer._failLimitExceeded (/app/lib/units/device/plugins/touch/index.js:230:26)
    at FailCounter.emit (/app/node_modules/eventemitter3/index.js:117:35)
    at FailCounter.inc (/app/lib/util/failcounter.js:29:10)
    at TouchConsumer._outputEnded (/app/lib/units/device/plugins/touch/index.js:223:24)
    at RiskyStream.emit (/app/node_modules/eventemitter3/index.js:115:35)
    at RiskyStream.<anonymous> (/app/lib/util/riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:973:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
From previous event:
    at startConsumer (/app/lib/units/device/plugins/touch/index.js:511:14)
    at /app/lib/units/device/plugins/touch/index.js:526:12
    at SerialSyrup.ParallelSyrup.invoke (/app/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /app/node_modules/stf-syrup/lib/serial.js:43:33
    at _combinedTickCallback (internal/process/next_tick.js:67:7)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/util:lifecycle 14966 [c806b880] Shutting down due to fatal error
INF/provider 1 [*] Cleaning up device worker "c806b880"
ERR/provider 1 [*] Device worker "c806b880" died with code 1
```
  Hi, After installing an apk and stop using it, when income back to the apk device is not already installed.
 I tried this option but fails.

geovani@geovani-Vostro-3350:~$ stf local --no-cleanup --public-ip 172.16.99.135
  error: unknown option `--no-cleanup'
  Hi,

I am facing disconnection issue with one of our device having Android [5.1.1.] It's happening frequently.

WRN/device:plugins:screen:stream 3689 [4200e52bc6b51300] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] Disconnecting from minicap service
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] Stopping minicap service
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] Launching screen service
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "PID: 14180"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: Using projection 480x800@464x773/0"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:240) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] Connecting to minicap service
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:243) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:250) Creating virtual display"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:256) Creating buffer queue"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:261) Creating CPU consumer"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:265) Creating frame waiter"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:269) Publishing virtual display"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 1154052 bytes for JPG encoder"
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] Reading minicap banner
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
WRN/device:plugins:screen:stream 3689 [4200e52bc6b51300] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 3689 [4200e52bc6b51300] Disconnecting from minicap service
FTL/device:plugins:screen:stream 3689 [4200e52bc6b51300] Frame producer had an error Error: Failed more than 3 times in 10000ms
    at FrameProducer._failLimitExceeded (/Users/apple/Desktop/stf 2.0.0/stf-2.0.0/lib/units/device/plugins/screen/stream.js:222:26)
    at FailCounter.emit (/Users/apple/Desktop/stf 2.0.0/stf-2.0.0/node_modules/eventemitter3/index.js:73:35)
    at FailCounter.inc (/Users/apple/Desktop/stf 2.0.0/stf-2.0.0/lib/util/failcounter.js:29:10)
    at FrameProducer._outputEnded (/Users/apple/Desktop/stf 2.0.0/stf-2.0.0/lib/units/device/plugins/screen/stream.js:215:24)
    at RiskyStream.emit (/Users/apple/Desktop/stf 2.0.0/stf-2.0.0/node_modules/eventemitter3/index.js:71:35)
    at RiskyStream.<anonymous> (/Users/apple/Desktop/stf 2.0.0/stf-2.0.0/lib/util/riskystream.js:14:12)
    at emitNone (events.js:91:20)
    at Socket.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:975:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/util:lifecycle 3689 [4200e52bc6b51300] Shutting down due to fatal error
INF/provider 3679 [_] Cleaning up device worker "4200e52bc6b51300"
ERR/provider 3679 [_] Device worker "4200e52bc6b51300" died with code 1
INF/provider 3679 [_] Restarting device worker "4200e52bc6b51300"
INF/device:support:push 3700 [4200e52bc6b51300] Sending output to "tcp://127.0.0.1:7116"
INF/device 3700 [4200e52bc6b51300] Preparing device
INF/device:support:sub 3700 [4200e52bc6b51300] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 3700 [4200e52bc6b51300] Subscribing to permanent channel "_ALL"
INF/device:support:properties 3700 [4200e52bc6b51300] Loading properties
INF/device:support:abi 3700 [4200e52bc6b51300] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 3700 [4200e52bc6b51300] Checking whether we need to install STFService
INF/device:resources:service 3700 [4200e52bc6b51300] Running version check
INF/device:resources:service 3700 [4200e52bc6b51300] STFService up to date
INF/device:plugins:service 3700 [4200e52bc6b51300] Launching agent
INF/device:plugins:service 3700 [4200e52bc6b51300] Launching service
INF/device:plugins:service 3700 [4200e52bc6b51300] Agent says: "Listening on port 1090"
INF/device:plugins:service 3700 [4200e52bc6b51300] Agent says: "InputClient started"
INF/device:plugins:display 3700 [4200e52bc6b51300] Reading display info
INF/device:plugins:phone 3700 [4200e52bc6b51300] Fetching phone info
INF/device:plugins:identity 3700 [4200e52bc6b51300] Solving identity
INF/device:plugins:solo 3700 [4200e52bc6b51300] Subscribing to permanent channel "n7snQ6axOe/KuOMySYWdGnU5520="
INF/device:plugins:screen:stream 3700 [4200e52bc6b51300] Starting WebSocket server on port 7404
WRN/device:plugins:data 3700 [4200e52bc6b51300] Unable to find device data { serial: '4200e52bc6b51300',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: ',',
  model: 'SM-G361H',
  version: '5.1.1',
  abi: 'armeabi-v7a',
  sdk: '22',
  product: 'coreprimeve3gxx',
  display: 
   { id: 0,
     width: 480,
     height: 800,
     xdpi: 203.1999969482422,
     ydpi: 203.1999969482422,
     fps: 60.000999450683594,
     density: 1.5,
     rotation: 0,
     secure: true,
     size: 4.591300773557018,
     url: 'ws://localhost:7404' },
  phone: { imei: '352724070788533', network: 'UNKNOWN' } }
INF/device:plugins:touch 3700 [4200e52bc6b51300] Touch origin is top left
INF/device:plugins:touch 3700 [4200e52bc6b51300] Requesting touch consumer to start
INF/device:plugins:touch 3700 [4200e52bc6b51300] Launching screen service
INF/device:plugins:touch 3700 [4200e52bc6b51300] Connecting to minitouch service
INF/device:plugins:touch 3700 [4200e52bc6b51300] minitouch says: "Type B touch device sec_touchscreen (479x799 with 10 contacts) detected on /dev/input/event2 (score 1100)"
INF/device:plugins:touch 3700 [4200e52bc6b51300] minitouch says: "Connection established"
![devicedisconnection](https://cloud.githubusercontent.com/assets/17309586/17745070/7b7a4d48-6478-11e6-8c15-562db850a647.JPG)
 hey @sorccu could you please see the comments. I am seeing here every time mincap is going down and while starting it's facing issues.
 Same issue is present with Samsung Galaxy S5 Neo (also with 5.1.1). It seems that it's triggered once you start interacting with the device in the web interface - The connection is stable without that...you can deploy/start the app and interact through adb.
  WHAT A GREAT JOB！
But I find a small problem . 
when i use the adb command ,"input keyevent XXX"，it too slow .
so i want have a function call "minikey" that can input keyevent faster !
poor english , sorry ......
thanks for your coding!
  I want to research minicap how to capture phone screen and adapt myself mobile phone,
where can i get the minicap.so source code and how to compile it?
thanks!
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Question: is there a way to manage permissions to the devices based on the user logged in? 
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->

I want to connect 2 devices, and 2 users, etch can control only one device, and cannot tuch the other device.
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): stf local
- Version used (git hash or `stf -V`): 2.0.1
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: ubuntu 16.4
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 I want this feature too.But only by yourself to finish it.
 We are working on a feature for managing users / devices the idea is to create a simple groups management table and attaching each user to a permission group, We hope to deliver a pull request in 2 weeks if you have any ideas feel free to share
 @kobikal1, is this feature available now? I am very interested in seeing it working. Thanks.  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 assert.js:89
  throw new assert.AssertionError({
  ^
AssertionError: Task never defined: run:checkversion

No specific reason i just updated it.After updating got an error.
I looked at all possible solutions,tried changes in gulpfile.js file still getting same error.

Any solution please.
 thank you
  ## What's the problem (or question)?

I'm an author of https://github.com/email2vimalraj/appium-stf-example. There is no problem, however it is an ask for the new feature. As for the automation, after executing the script, we would like to watch the execution. So it would be great if we can add an execution view where it shows real time streaming of test execution.
## What should have happened?

I triggered an execution using appium and opened the STF dashboard which shown a Devices page. I clicked on the device where the execution is happening, because I was expecting it will show me the execution. But the moment I clicked on it, it released the device from me causing the automation failure.
## Do you have an idea for a solution?

Idea way could be add an execution view where user can view the live execution with no controls (Ex: Perfecto's device dashboard).
Another suggestion would be, we should not immediately allocate / release device when the user clicks on the particular device on the Devices view. Rather, it should be a button to select / release. Because, I sometimes mistakenly clicked on the device causing allocation / releasing.
## Help us understand your issue by providing context.

This ask is better to have and help for automation.
## Please tell us details about your environment.
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): `stf local`
- Version used (git hash or `stf -V`):  `v2.0.1'
- Environment name and version (e.g. Chrome 39, node.js 5.4): `v6.2.1`
- Operating System and version: `Mac OSx 10.11.5`
 @vbanthia : Yes that solves the purpose. But still I'm looking a separate execution view with nothing other than the screen streaming. This will avoid people playing around with un-necessary interactions while the execution is on.

And when the execution is completed, I'm getting this:

<img width="1249" alt="screen shot 2016-08-10 at 8 28 49 am" src="https://cloud.githubusercontent.com/assets/1214686/17540567/c4f36742-5ed4-11e6-9375-247ff12700dd.png">

I'm looking for something like this: https://community.perfectomobile.com/posts/913782-device-dashboard. This will let me to just watch the execution, that's all it.
 @gunta : Yes something similar to SHIFT+CLICK and prevent touches.
  information:
CentOS Linux 2.6.32-431.el6.x86_64
node v0.12.12
npm  v3.10.5

[root@root local]# npm install -g stf
npm WARN deprecated slack-client@2.0.6: Use @slack/client instead, this package is no longer maintained
npm WARN deprecated jade@1.11.0: Jade has been renamed to pug, please install the latest version of pug instead of jade
npm WARN deprecated transformers@2.1.0: Deprecated, use jstransformer
npm WARN deprecated lodash@2.4.2: lodash@<3.0.0 is no longer maintained. Upgrade to lodash@^4.0.0.
/usr/local/node/bin/stf -> /usr/local/node/lib/node_modules/stf/bin/stf
/usr/local/node/lib
└─┬ stf@2.0.1 
  ├─┬ adbkit@2.4.1
  │ └── node-forge@0.6.42 
  ├── aws-sdk@2.4.13 
  ├─┬ gm@1.23.0 
  │ └─┬ cross-spawn@4.0.0 
  │   ├─┬ lru-cache@4.0.1 
  │   │ ├── pseudomap@1.0.2 
  │   │ └── yallist@2.0.0 
  │   └─┬ which@1.2.10 
  │     └── isexe@1.1.2 
  ├─┬ jade@1.11.0
  │ └─┬ uglify-js@2.7.0
  │   └─┬ yargs@3.10.0
  │     └─┬ cliui@2.1.0
  │       └─┬ center-align@0.1.3
  │         └─┬ align-text@0.1.4
  │           └─┬ kind-of@3.0.4 
  │             └── is-buffer@1.1.4 
  ├─┬ markdown-serve@0.3.2
  │ └── marked@0.3.6 
  ├─┬ request@2.74.0
  │ └─┬ http-signature@1.1.1
  │   └── sshpk@1.9.2 
  └─┬ swagger-express-mw@0.6.0
    └─┬ swagger-node-runner@0.6.16
      ├── multer@1.2.0 
      └─┬ sway@0.6.0
        └─┬ z-schema@3.17.0
          └── lodash.get@4.4.1 

[root@root local]# stf doctor
/usr/local/node/lib/node_modules/stf/node_modules/bindings/bindings.js:91
  throw err
        ^
Error: Could not locate the bindings file. Tried:
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/node/lib/node_modules/stf/node_modules/zmq/compiled/0.12.12/linux/ia32/zmq.node
    at bindings (/usr/local/node/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/node/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:460:26)
    at Object.Module._extensions..js (module.js:478:10)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at Object.<anonymous> (/usr/local/node/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:460:26)
    at Object.Module._extensions..js (module.js:478:10)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at Object.<anonymous> (/usr/local/node/lib/node_modules/stf/lib/util/doctor.js:5:11)

run the command stf doctor failed....
need help!!!
 Check zmq folder is available inside /usr/local/node/lib/node_modules/stf/node_modules/
if not present run brew install zeromq.
 @tadesushilgithub  command brew in CentOS does not work!
 I have also encountered the same problem.I'm on OSX.how can I  fix it. I'm on Mac OS.I also have this problem.And I rm node_modules but also get this problem....How can i fix it...  There is a remote PC connected with a devices, I can use `adb devices` to see it.

``` sh
$ adb devices
List of devices attached
S8GMTO7TT44P599S        device
```

Now in another PC, I can use `adb -H 10.0.0.2 devices` to list devices too, but each command executed are slowly(I guess it is because the network connect time cost). I have seen that with stf can do `adb connect 10.0.0.2:7001`

@sorccu Can please give some suggestions how to implement this? I want split out this feature from stf.
 I like to make stf better, and I have made some prs to stf already. But stf is very big, sometimes we only need some small part, Make it simple make it better to maintain it, also make it stable to use too. Stf's js code is some kind complex that hard to locate the real part, so it really helps to have your some suggestions.
Split it as a single tool will make this part code more rebust, it is also a way for me to make stf better.
 I can easily find it, but it is not easy at all when I see the implement code (need socket.js, packet.js) ...
 @codeskyblue Hi, do you implement is feature?
Actually I just want to use adb connect and without reserve the device?
It seems you have tried this. 
Any suggestions will be appreciated
 @WillPangZi you will know that with

```
npm install -g adbkit
adbkit -h
```
 @codeskyblue, awesome feature. Now I can share USB to network directly without fingerprint confirm.
But it seems when click the "Stop Using" button,  the adb share will be disconnected. I'm checking this point.
If you have any suggestions please let me know.
  Just a simple question, but I want to duplicate the physical device setup shown in the project README (image link below). Where can I purchase such a rack, and what is it called? Additionally, can we add this information as a caption to the README image?

https://github.com/openstf/stf/blob/master/doc/shelf_closeup_790x.jpg?raw=true

P.S. I don't think the issue template applies to this question, so I edited it out.
 Thanks, I appreciate the description. I didn't see #1, so thanks for the link there, too. If you have time, I'm curious how you got the rails mounted at that angle. I've been searching for something similar online but no good results are turning up.

Either way, you guys have a great setup to have so many people curious.
  Hi,

I met the following issue during starting "stf local". There is one device connected and "adb devices" can show the device normally.

INF/provider 9141 [_] Tracking devices
INF/provider 9141 [_] Found device "012345678" (device)
INF/provider 9141 [_] Registered device "012345678"
INF/reaper 9132 [reaper001] Device "012345678" is present
INF/device:support:push 9212 [012345678] Sending output to "tcp://127.0.0.1:7116"
INF/device 9212 [012345678] Preparing device
WRN/provider 9141 [_] Device worker "012345678" was killed with signal SIGBUS, assuming deliberate action and not restarting
INF/provider 9141 [_] Cleaning up device worker "012345678"
INF/provider 9141 [_] Device worker "012345678" has retired

May I know some reasons why the device is offline in stf?

Thanks,
Harry
 It is a Nexus 7 device: device usb:1-2 product:razor model:Nexus_7 device:flo
 any idea? thanks.
 Thanks much! Is there any solution to print more debugging information so that I can locate some points on "signal SIGBUS"?
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

I need to do logout for a ldap user,
## What should have happened?

i cleared browser side cookies but i know it wont work,
i need to know is their any service method to clear all the session,cookies related information,
Or is their any other solution for Logout,
so that all the devices should be disconnected after he/she logout.
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 thank you
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.Hi, I find you have installUrl in install-controller, but when i call it, an error occurs that control.uploadUrl is not defined 
2.So, I want to ask how to install app from url
3.Thank you
4.Looking for your answer
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 Facing same issue. when i try to use App upload using RemoteUrl

getting this error 
angular.js:14199 TypeError: control.uploadUrl is not a function
    at Object.InstallService.installService.installUrl (install-service.js:66)
    at ChildScope.InstallCtrl.$scope.installUrl (install-controller.js:18)
    at fn (eval at compile (angular.js:NaN), <anonymous>:4:329)
    at expensiveCheckFn (angular.js:16213)
    at callback (angular.js:26592)
    at ChildScope.$eval (angular.js:17994)
    at ChildScope.$apply (angular.js:18094)
    at HTMLButtonElement.eval (angular.js:26597)
    at defaultHandlerWrapper (angular.js:3546)
    at HTMLButtonElement.eventHandler (angular.js:3534)  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
### What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Hi,

first of all: Thanks for the API to @vbanthia, for the tests i have done yet, it works like a charm. What I could extract from the discussion in issue #219, STF seems to be planned currently as a device provider for automated tests with Appium (or other automation frameworks) via the REST API. 
Do you have any plans to make a deeper integration of automated tests into STF? Maybe for parallel testing?

We think about something like the following procedure to provide a convenient way for the test developer:
- write your test
- upload test to STF
- select multiple phones to run the test on and start test
- background service (maybe part of STF) does the following things:
  - start all the needed Appium Servers and reserve phones in STF
  - let appium servers make the tests
  - provide test results to the test developer

(Since we are only using Appium, i'll descriped it with Appium, but one could write such a feature more generic to add other automation frameworks later maybe...)

Greetings
Benjamin
 Hey, thanks for the quick answer. 
What du you exactly mean by "new repository would be expected"?
Like some kind of "new project" which is afterwards used by STF? 
 Hi, I'm trying to integrate Selenium Grid with OpenSTF, can you give me your opinion about what is the best way to do it? In the first plan, we thought of creating a module to merge the occupations of devices and thus prevent Selenium Grid to run a test on a device that is being used in OpenStf and the other way around.
Looking forward to know some opinions.
 I see that this is quite old and closed issue but it seems to be the most appropriate place to submit links related to automated testing CI/using STF.

[Integration](https://github.com/DroidsOnRoids/bitrise-step-openstf-connect) for [bitrise.io](https://www.bitrise.io) is available. Parallel testing is also supported when [spoon Gradle plugin](https://github.com/stanfy/spoon-gradle-plugin) is used.

Blogpost with more info: https://www.thedroidsonroids.com/blog/how-to-connect-physical-devices-to-bitrise-io  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## Can I connect a virtual device ( created by AVD in Android Studio) to STF ?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

<!--- Include as many relevant details about the environment you experienced the bug in -->
  ExecStartPre=/usr/bin/docker pull rethinkdb:2.3
......
ExecStart=/usr/bin/docker run --rm \
......
rethinkdb:2.1.5 \
......
For "rethinkdb:2.1.5", read "rethinkdb:2.3"
  I have 20 devices connected sometimes some devices goes offline means 20 becomes 17 but it's very critical to know which device goes offline. So I renamed devices by setting up there custom name like RACK1DEV3 so that it would be Identified. But I need to extract that and bring it to UI. So I went through some adb getprop i couldn't found. 
My question if I need to bring device name in UI do I need to change stf.apk? or adb getprop can help me so that I'll write API to get that.
 But the problem is that User's are often change the Notes value every time. Can I get Device name from Android?. The reason of devices goes offline is H/W issue only because I seen that device is not getting connected to the same server but if I remove and add to another server it's work fine and after some days again goes offline :(. I kept usb connection in MTP mode. 
 Please find the Images for more clarity. I want to see **RACK 2 RIGHT5** as my device name in UI.

![snap1](https://cloud.githubusercontent.com/assets/17309586/17275077/fd06fed2-56c8-11e6-9c16-c46094d28ea7.jpg)
![snap2](https://cloud.githubusercontent.com/assets/17309586/17275078/fd5d7a50-56c8-11e6-8be8-0a934cefb760.jpg)
 Ok Thanks @sorccu
 Ya I will try that :).
  Hello OpenSTF,

I was checking OpenSTF and need to know can we do Manual Synchronous Testing i.e., if 10 devices are connected and i perform button action on one device it should reflect of others too. Can we do that using OpenSTF?
  Use adb connect to connect to a remote device as if it was plugged in to your computer, regardless of ADB mode and whether you're connected to the same network
Run any adb command locally, including shell access
Android Studio and other IDE support, debug your app while watching the device screen on your browser
Supports Chrome remote debug tools

If I want to learn this function, so could you tell me where is the relative code in the project? Thx.
 Could you show me the detail? I am not very clearly yet.
 OK, I got it.
  I want to use this with one fixed username and password ,and I don't want to login with input the name everytime when I open a new page ,can I do something to login in with my application  for example  setting cookie
 @sorccu I have my own login page created, Now I need to bypass login and redirect the user to dashboard. Is it possible if I pass required credential in session? 
 excuse me, I have no username and password; where I can sign up.
 thank you. I just solved this problem
 how.? 
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Im trying to add a adb key but the app is not recognising the format. The last part of the file reads like:
= name@name.host.com
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->

It should accept my key. The popup is closing without any answer.
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
  I am accessing through other computer using stf local with a public ip
 Ok. I regenerated it and its working now. I dont know why. It was maybe corrupted. Thanks
  Why stf  is used rethinkdb not mysql/mongodb? What is the advantage of rethinkdb?
  Hi developer,

 i found a problem as title,  I hope it works like the touch event when i'm using from remote web page to  control a device. 

Descriptions:
1. I start stf with command :  stf local --public-ip <my ip>
2. I login stf from another computer with web (Actually, the login process is very slow.)
3. select one device and then try to control it by touch screen, the action is worked as fast by it's screen show sync need to long time with drop frame.

Could you give me some advance?
 @sorccu  Thanks this feedback ,  maybe this is some mistake in my question, both my compute are in the same network. 
 my ip like "10.252.162.10" and another ip is "10.252.163.5" 
 reduce the image size which produced by the stf client is also a way. @boxerxing 
 I get the same problem. But I can't find the way to reduce the image size @codeskyblue. 
 You need to change the code. @FengJianjian 
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Hi there!
Sometimes during remote connection (adb connect) device just unexpectedly disconnects, and becomes "Free" in STF web-interface (and is fully operational), and in STF Provider log I see such error:

```
IMP/device:plugins:group 9702 [E9OKBC204913] Now owned by "example@email.com"
INF/device:plugins:group 9702 [E9OKBC204913] Subscribing to group channel "uaOSQl83TCyTLdCKZZBjgw=="
IMP/device:plugins:connect 9702 [E9OKBC204913] Remote Connect Started for device "E9OKBC204913" at "10.154.18.75:7545"
INF/device:plugins:connect 9702 [E9OKBC204913] New remote ADB connection from ::ffff:10.54.25.49
events.js:141
      throw er; // Unhandled 'error' event
      ^

Error: read ECONNRESET
    at exports._errnoException (util.js:849:11)
    at TCP.onread (net.js:544:26)
INF/provider 1 [*] Cleaning up device worker "E9OKBC204913"
ERR/provider 1 [*] Device worker "E9OKBC204913" died with code 1
INF/provider 1 [*] Restarting device worker "E9OKBC204913"
```

It happens with different devices and it's hard to reproduce.

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
1. Get adb connect string from remoteConnect API method
2. Connect device via adb connect string
3. Run appium UI tests
4. Wait

If I skip step 3 (Run appium tests) I can't reproduce the problem, but it seems appium itself has nothing to do with the problem, maybe pushing big files during tests cause the problem.
### Environment:

<!--- Include as many relevant details about the environment you experienced the bug in -->

<!--- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): -->
- **full deployment**

STF-Provider on desktop host with devices connected and all other STF services on virtual machine

<!--- Version used (git hash or `stf -V`): -->
- **v2.0.0-beta docker image** from docker hub

<!--- Environment name and version (e.g. Chrome 39, node.js 5.4):  -->
- **nodejs v4.1.2**

<!--- Operating System and version:  -->
- **ubuntu 14.04** on all nodes

I will continue to experiment to find the specific conditions to reproduce the problem, but I want to ask for help in the investigation of this problem from error in the STF Provider log - it seems that something just unexpectedly drops some TCP connection (maybe ADB server?), and I don't know how to determine what TCP connection drops and what else can I do about it (maybe get some TCP dumps)

Thank you!
 Usually it works fine, we run a lot of tests on several devices, but sometimes one of devices unexpectedly disconnects with such error.

It doesn't affect other connections with other devices and device become fully operational just after worker restarts
 @sorccu hi!
Now on openstf/stf:v2.3.0 we getting this error. Sometimes, but often - 4 of 5 disconnected.

```
events.js:160
      throw er; // Unhandled 'error' event
      ^

Error: read ECONNRESET
    at exports._errnoException (util.js:1026:11)
    at TCP.onread (net.js:569:26)
```
 Problem with Nexus 5X with direct connection to PC (USB 2.0 port). Checked on two different PC.
 okay, I'll try it
 @sorccu i had an extended stack trace, using `require('longjohn')` instead `Promise.longStackTraces()` in `lib/cli.js`:

```
IMP/device:plugins:connect 26 [00ec0ea6616e95c8] Remote Connect Started for device "00ec0ea6616e95c8" at "10.154.8.17:7405"
INF/device:plugins:connect 26 [00ec0ea6616e95c8] New remote ADB connection from ::ffff:10.54.25.49
Error: read ECONNRESET
    at exports._errnoException (util.js:1026:11)
    at TCP.onread (net.js:569:26)
---------------------------------------------
    at Socket.Readable.on (_stream_readable.js:687:35)
    at Connection.connect (/app/node_modules/adbkit/lib/adb/connection.js:51:17)
    at Client.connection (/app/node_modules/adbkit/lib/adb/client.js:118:8)
    at Client.transport (/app/node_modules/adbkit/lib/adb/client.js:255:17)
    at Service._handleOpenPacket (/app/node_modules/adbkit/lib/adb/tcpusb/service.js:80:24)
    at /app/node_modules/adbkit/lib/adb/tcpusb/service.js:59:26
    at tryCatcher (/app/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Function.Promise.attempt.Promise.try (/app/node_modules/adbkit/node_modules/bluebird/js/main/method.js:31:24)
    at Service.handle (/app/node_modules/adbkit/lib/adb/tcpusb/service.js:55:26)
    at /app/node_modules/adbkit/lib/adb/tcpusb/socket.js:216:24
    at tryCatcher (/app/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Promise._resolveFromResolver (/app/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:476:31)
    at new Promise (/app/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:69:37)
    at Socket._handleOpenPacket (/app/node_modules/adbkit/lib/adb/tcpusb/socket.js:210:12)
    at /app/node_modules/adbkit/lib/adb/tcpusb/socket.js:103:26
    at tryCatcher (/app/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Function.Promise.attempt.Promise.try (/app/node_modules/adbkit/node_modules/bluebird/js/main/method.js:31:24)
    at Socket._handle (/app/node_modules/adbkit/lib/adb/tcpusb/socket.js:95:26)
    at emitOne (events.js:96:13)
    at PacketReader.emit (events.js:188:7)
INF/provider 1 [*] Cleaning up device worker "00ec0ea6616e95c8"
ERR/provider 1 [*] Device worker "00ec0ea6616e95c8" died with code 1
```
 Probably, stf-provider is a victim.
We have succeeded in establishing bad adb command (only sometimes). Trace looks like this:
```
12:43:44             main:  2120:4147975936 | Handling commandline()
12:43:44  adb_commandline:  2120:4147975936 | interactive shell loop. cmd=shell:getprop emu.uuid
12:43:44     _adb_connect:  2120:4147975936 | _adb_connect: host:version
12:43:44   WriteFdExactly:  2120:4147975936 | writex: fd=3 len=4: 30303063 000c
12:43:44   WriteFdExactly:  2120:4147975936 | writex: fd=3 len=12: 686f73743a76657273696f6e host:version
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4 got=4
12:43:44 4f4b4159 OKAY
12:43:44     _adb_connect:  2120:4147975936 | _adb_connect: return fd 3
12:43:44      adb_connect:  2120:4147975936 | adb_connect: service shell:getprop emu.uuid
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4 got=4
12:43:44 30303034 0004
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4 got=4
12:43:44 30303230 0020
12:43:44     _adb_connect:  2120:4147975936 | _adb_connect: shell:getprop emu.uuid
12:43:44   WriteFdExactly:  2120:4147975936 | writex: fd=3 len=4: 30303166 001f
12:43:44   WriteFdExactly:  2120:4147975936 | writex: fd=3 len=31: 686f73743a7472616e73706f72743a31 host:transport:1
12:43:44 switch_socket_transport:  2120:4147975936 | Switch transport in progress
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4 got=4
12:43:44 4f4b4159 OKAY
12:43:44 switch_socket_transport:  2120:4147975936 | Switch transport success
12:43:44   WriteFdExactly:  2120:4147975936 | writex: fd=3 len=4: 30303136 0016
12:43:44   WriteFdExactly:  2120:4147975936 | writex: fd=3 len=22: 7368656c6c3a67657470726f7020656d shell:getprop em
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 wanted=4
12:43:44    ReadFdExactly:  2120:4147975936 | readx: fd=3 disconnected
12:43:44      adb_connect:  2120:4147975936 | _adb_connect error: protocol fault (couldn't read status): Success     adb_connect:  2120:4147975936 | adb_connect: return fd -1
12:43:44 error: protocol fault (couldn't read status): Success
12:43:44  adb_commandline:  2120:4147975936 | interactive shell loop. return r=-1
```

But we don't exactly know why this happens. Device trouble, maybe. I too get the same issue for Android handsets wherein adb disconnects from the device with ECONNRESET when Appium executes the tests. How can we make adb connect back to the device.  I want use the Icon of stf,but I can't find them.  (Some jade'Icon corresponding list of names  like 'fa-gears' ,'fa-upload' ,etc.)
![image](https://cloud.githubusercontent.com/assets/18346467/17098522/63926eda-5295-11e6-808b-624c67e976b8.png)
  I was wondering if someone can update the documentation to get STF setup using docker, I have seen the current doc's and it's slightly confusing to people who never used docker before. I have got STF running on a mac very easily via the terminal, but would like a similar guide on setting up STF docker container via the terminal.  

https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md
 Yup, a setup guide would be nice... I tried with this `docker-compose.yml`:

```
rethinkdb:
    image: rethinkdb

openstf:
    image: openstf/stf
    links:
        - rethinkdb
    ports:
        - "7100:7100"
        - "7110:7110"
    command: stf local
```

I get access to the login page at `http://localhost:7100`, can login, but I'm stuck with the `No devices connected` message (I tried 3 different devices, adb works fine but stf doesn't seems to find them). Did I miss something ?
 Hi,
There must be a good reason people keep saying `stf local` is not meant for docker.
However, I've managed to put together a `docker-compose.yml` that seems to work.

```
rethinkdb:
  image: rethinkdb:2.3
  ports:
    - "8080:8080"
    - "28015:28015"
    - "29015:29015"
  restart: always
  volumes:
    - "/srv/rethinkdb:/data"
  command: "rethinkdb --bind all --cache-size 2048"

adbd:
  image: sorccu/adb
  privileged: true
  ports:
    - "5037:5037"
  restart: always
  volumes:
    - "/dev/bus/usb:/dev/bus/usb"

stf-local:
  image: openstf/stf
  links:
    - rethinkdb
    - adbd
  ports:
    - "7100:7100"
    - "7110:7110"
    - "7120:7120"
    - "7400-7500:7400-7500"
  restart: always
  command: stf local --public-ip 192.168.1.127 --provider-min-port 7400 --provider-max-port 7500 --adb-host adbd
```

Obviously, you'll have to replace the `--public-ip` from the last line with the IP address of your docker host.

With this setup, I'm able to access my devices by going to http://192.168.1.127:7100

I hope it helps "mirceanis" solution works on my mac, thanks. @jabed-m-talukder, did you change links to depends_on in docker compose file? I think links doesnt make sense when all 3 containers are in same network I found this project for a single host deployment of STF by @nikosch86 using docker images
It works well for me on Linux 

https://github.com/nikosch86/stf-poc  Hi STF team,
I downloaded the code from master branch followed below steps:
1. npm install
2. npm link
3. cd bin
4. ./stf local --public-ip ip_address

but after 24 hours server goes down, STF log stops. And I am getting below error in rethinkdb 
**The issue reported is: Some RethinkDB data on this server has been placed into swap memory in the past hour. This may impact performance.**

Now I am sure this is happening because of rethinkdb error OR problem with ubuntu. I am having another STF running from 3 week over mac connected with 30 devices :) but over mac I installed STF using npm install stf -g. What could be the reason? How can I keep STF continuously running over a week. 
 Thanks @sorccu. No I am not doing anything like nodemon. I thought STF stops because of rethinkdb error related to SWAP memory. I will try to fix SWAP memory issue then l'll see how may days stf local continuously works on ubuntu box.
**Also Please clear my below mentioned doubt :**
But I have scenario like Ubuntu-1 has 20 devices + Ubuntu-2 has 20 devices. Can Deployment guide helps us to bring both 2 boxes under 1 url, Where I can see total 40 devices after login?. I got success using Deployment guide help in setting up the STF in Mac OS but Failed in Ubuntu. 
  This is not an issue, just want to know how can I delete an entry from rethinkDB database..
In my case I want to delete a device from there, I just don't know how to make the query to do it.

If someone can help, I will be much appreciated.
Regards,
João Pedro
  Removed
  the device status will be disconnected after run some time,and when I  restart the stf it recovers,but it changes to disconnected some time later again.Why is so unstable?
1.the system is OS X Yosemite 10.10.5,
the stf version is 1.1.1
node.js version is v0.12.4
rethinkdb version is 2.3.2
2.when I use the dmesg |grep usb nothing print 
3.have start the developers mode and commit pc to connect,
4.Does the phone install the stf-service automatically when connected to pc and start the stf ?
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

I have 2 questions. 
1.Can we use a high end Server (HP Z640) with Ubuntu OR Mac Pro( Cylindrical Server)? which one is better?
2. If I install STF Local on a high end machine, will STF local handle 100 devices? 



********************************************************************************
Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. Can we use a high end Server (HP Z640) with Ubuntu OR Mac Pro( Cylindrical Server)?.
A. 

Q. I will install STF local into one box . Can it handle 100 devices if I connect into 1 Box
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

I have 2 questions. 
1.Can we use a high end Server (HP Z640) with Ubuntu OR Mac Pro( Cylindrical Server)? which one is better?
2. If I install STF Local on a high end machine, will STF local handle 100 devices?  

<!--- If suggesting a change/improvement, explain the difference from current behavior -->
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
  I found other samsung device

### Not working
- Samsung Galaxy A8(v5.1.1)

### working fine with followings:
- Samsung Galaxy A5(v5.0.2)
- Samsung Galaxy A7(v5.0.2)

After OS update to 6.0.1, Samsung Galaxy A8 is working fine.
Maybe cause seems to be Android 5.1.1

More Info

``` json
"abi":  "armeabi-v7a" ,
"airplaneMode": false ,
"battery": {
"health":  "good" ,
"level": 100 ,
"scale": 100 ,
"source":  "usb" ,
"status":  "full" ,
"temp": 26.2 ,
"voltage": 4.402
} ,
"display": {
"density": 3 ,
"fps": 59 ,
"height": 1920 ,
"id": 0 ,
"rotation": 0 ,
"secure": true ,
"xdpi": 422.0299987792969 ,
"ydpi": 424.0690002441406
} ,
"manufacturer":  "SAMSUNG" ,
"model":  "SM-A800S" ,
"network": {
"connected": true ,
"failover": false ,
"roaming": false ,
"subtype":  "" ,
"type":  "WIFI"
} ,
"operator": null ,
"owner": null ,
"platform":  "Android" ,

"present": false ,
"product":  "a8elteskt" ,
"provider": {
"ready": true ,
"reverseForwards": [ ],
"sdk":  "22" ,
"status": 3 ,
"version":  "5.1.1"
```
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

click the button screenshot，and also found the image file in directory:/tmp
but when I click the image icon in the stf web page,don` display the image
stf output is:
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:269) Publishing virtual display"
INF/device:plugins:screen:stream 4974 [ab6e5747] Connecting to minicap service 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 6268932 bytes for JPG encoder" 
INF/device:plugins:screen:stream 4974 [ab6e5747] Reading minicap banner INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection" INF/device:plugins:screen:capture 4974 [ab6e5747] Capturing screenshot INF/storage:temp 4795 [_] Uploaded "ab6e5747.jpg" to "/tmp/upload_0a4dad3844e1728b0d7a55f4419d0f12" 
INF/device:support:storage 4974 [ab6e5747] Uploaded to "/s/image/f8c68514-5b68-4008-8b00-8c73b1989f6f/ab6e5747.jpg" 
INF/device:plugins:screen:capture 4974 [ab6e5747] Capturing screenshot 
INF/storage:temp 4795 [_] Uploaded "ab6e5747.jpg" to "/tmp/upload_dbbd561d6f6ca81caab609902ef580f6" 
INF/device:support:storage 4974 [ab6e5747] Uploaded to "/s/image/025a24b7-2c12-47fe-8f7e-7aa2447879d9/ab6e5747.jpg" 
INF/device:plugins:screen:stream 4974 [ab6e5747] Requesting frame producer to stop 
INF/device:plugins:screen:stream 4974 [ab6e5747] Disconnecting from minicap service 
INF/device:plugins:screen:stream 4974 [ab6e5747] Stopping minicap service 
INF/device:plugins:screen:stream 4974 [ab6e5747] Sending SIGTERM to minicap 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (jni/minicap/minicap.cpp:196) Received SIGTERM, stopping" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (jni/minicap/minicap.cpp:512) Closing client connection" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:284) Destroying virtual display" 
INF/device:plugins:screen:stream 4974 [ab6e5747] Keeping 555x854 as current frame producer projection 
INF/device:plugins:screen:stream 4974 [ab6e5747] Requesting frame producer to start 
INF/device:plugins:screen:stream 4974 [ab6e5747] Launching screen service 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "PID: 11411" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: Using projection 1080x1920@480x854/0" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:240) Creating SurfaceComposerClient" 
INF/device:plugins:screen:stream 4974 [ab6e5747] Connecting to minicap service 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:243) Performing SurfaceComposerClient init check" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:250) Creating virtual display" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:256) Creating buffer queue" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:261) Creating CPU consumer" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:265) Creating frame waiter" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:269) Publishing virtual display" 
INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 6268932 bytes for JPG encoder" 
INF/device:plugins:screen:stream 4974 [ab6e5747] Reading minicap banner INF/device:plugins:screen:stream 4974 [ab6e5747] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
this is the screenshot for the webpage
![image](https://cloud.githubusercontent.com/assets/14904226/16720937/e4f98086-476d-11e6-8590-2493077d6921.png)
## What should have happened?

when I click the image icon in the stf web page,I should see the image
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): stf -V 1.1.1
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
  gm -version :GraphicsMagic 1.3.24 2016-05-30
  node -v :v6.3.0
- Operating System and version: Ubuntu 14.0.4 64bit
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
 I also encountered the same problem.Can I see your export of "stf doctor"?I think there is the version of 
module was wrong.
 @0x88l I run the command：stf doctor，but output is nothing

root@dd-OptiPlex-3020:/home/dd/# stf doctor
root@dd-OptiPlex-3020:/home/dd/# 
 You haven't   link  stf ?
 @0x88l link?I already start rethinkdb and stf ,and how link?
 How did you start stf?The command "stf doctor" is one of parameter.You can see stf --help.I don't know why the "stf doctor" output nothing.
 @0x88l I used this command：stf local to start stf
 I have exactly the same problem as niuniudd had. Can someone help out there? Thanks! Thanks for comments @sorccu.
Here is my gm status, is that possible to fix the problem from these information?


ben@uBentu:~$ gm -version
----------------------------------------------------------------------------------------------
GraphicsMagick 1.3.25 2016-09-05 Q8 http://www.GraphicsMagick.org/
Copyright (C) 2002-2016 GraphicsMagick Group.
Additional copyrights and licenses apply to this software.
See http://www.GraphicsMagick.org/www/Copyright.html for details.

Feature Support:
  Native Thread Safe       yes
  Large Files (> 32 bit)   yes
  Large Memory (> 32 bit)  yes
  BZIP                     no
  DPS                      no
  FlashPix                 no
  FreeType                 no
  Ghostscript (Library)    no
  JBIG                     no
  JPEG-2000                no
  JPEG                     no
  Little CMS               no
  Loadable Modules         no
  OpenMP                   yes (201307)
  PNG                      no
  TIFF                     no
  TRIO                     no
  UMEM                     no
  WebP                     no
  WMF                      no
  X11                      yes
  XML                      no
  ZLIB                     no

Host type: x86_64-unknown-linux-gnu

Configured using the command:
  ./configure 

Final Build Parameters:
  CC       = gcc
  CFLAGS   = -fopenmp -g -O2 -Wall -pthread
  CPPFLAGS = 
  CXX      = g++
  CXXFLAGS = -pthread
  LDFLAGS  = 
  LIBS     = -lSM -lICE -lX11 -lm -lgomp -lpthread

ben@uBentu:~$ whereis gm
gm: /usr/local/bin/gm

ben@uBentu:~$ echo $PATH
/home/ben/Android/SDK/tools:/home/ben/Android/SDK/platform-tools:/home/ben/bin:/home/ben/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/protobuf/bin/:/home/ben/.linuxbrew/bin/
----------------------------------------------------------------------------------------------


I also found my stf doctor has some problem, will that "TypeErro" cause the problem too?

ben@uBentu:~$ stf doctor
----------------------------------------------------------------------------------------------
INF/util:doctor 15899 [*] OS Arch: x64
INF/util:doctor 15899 [*] OS Platform: linux
INF/util:doctor 15899 [*] OS Platform: 4.4.0-59-generic
INF/util:doctor 15899 [*] Using Node 6.9.5
INF/util:doctor 15899 [*] Using RethinkDB client 2.3.3
INF/util:doctor 15899 [*] Using ZeroMQ 4.1.4
INF/util:doctor 15899 [*] ProtoBuf 3.1.0
ERR/util:doctor 15899 [*] Current ProtoBuf version is not supported, it has to be 2
INF/util:doctor 15899 [*] GraphicsMagick 1.3.25
INF/util:doctor 15899 [*] Local RethinkDB server 2.3.5 0xenial
/usr/lib/node_modules/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 2.3.5~0xenial
    at new SemVer (/usr/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/usr/lib/node_modules/stf/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/usr/lib/node_modules/stf/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/usr/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /usr/lib/node_modules/stf/lib/util/doctor.js:95:7
    at /usr/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:197:7)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at maybeClose (internal/child_process.js:877:16)
    at Socket.<anonymous> (internal/child_process.js:334:11)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at Pipe._handle.close [as _onclose] (net.js:498:12)





And below is the log once I clicked on Screenshot button. I am able to find the screenshot in the host folder /tmp/upload_6e7289d078ac4d977794997f2fd4ef94
But the link in URL "http://localhost:7100/s/image/3b9ab278-2ef1-4c61-bdc4-b8feeef3d5b4/152085230D0026.jpg" are broken.

----------------------------------------------------------------------------------------------
INF/device:plugins:screen:stream 15842 [152085230D0026] minicap says: "INFO: (jni/minicap/minicap.cpp:448) New client connection"
INF/device:plugins:screen:capture 15842 [152085230D0026] Capturing screenshot
INF/storage:temp 15801 [*] Uploaded "152085230D0026.jpg" to "/tmp/upload_6e7289d078ac4d977794997f2fd4ef94"
INF/device:support:storage 15842 [152085230D0026] Uploaded to "/s/image/3b9ab278-2ef1-4c61-bdc4-b8feeef3d5b4/152085230D0026.jpg"

-------------------------------------------------------------------------------------------------------

And all this is similar to #460.

![ben-20170204-006](https://cloud.githubusercontent.com/assets/24208249/22619556/b329164e-eb31-11e6-82c5-136dbb980f0d.png)
 @bentonglove  Screenshot isnot work here. I also have "ProtoBuf" problem.
```
administrator@ubuntu:~$ stf doctor
INF/util:doctor 16163 [*] OS Arch: x64
INF/util:doctor 16163 [*] OS Platform: linux
INF/util:doctor 16163 [*] OS Platform: 3.13.0-24-generic
INF/util:doctor 16163 [*] Using Node 7.4.0
INF/util:doctor 16163 [*] Using RethinkDB client 2.3.3
INF/util:doctor 16163 [*] Using ZeroMQ 4.1.4
INF/util:doctor 16163 [*] GraphicsMagick 1.3.21
INF/util:doctor 16163 [*] ProtoBuf 3.0.0
ERR/util:doctor 16163 [*] Current ProtoBuf version is not supported, it has to be ~2
INF/util:doctor 16163 [*] Local ADB 1.0.31
INF/util:doctor 16163 [*] Local RethinkDB server 2.3.5~0trusty
/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:293
    throw new TypeError('Invalid Version: ' + version);
    ^

TypeError: Invalid Version: 2.3.5~0trusty
    at new SemVer (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
    at Range.test (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:1036:15)
    at Function.satisfies (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:1085:16)
    at unsupportedVersion (/usr/local/lib/node_modules/stf/lib/util/doctor.js:13:15)
    at /usr/local/lib/node_modules/stf/lib/util/doctor.js:95:7
    at /usr/local/lib/node_modules/stf/lib/util/doctor.js:50:22
    at ChildProcess.exithandler (child_process.js:202:7)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at maybeClose (internal/child_process.js:885:16)
    at Socket.<anonymous> (internal/child_process.js:334:11)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at Pipe._handle.close [as _onclose] (net.js:501:12)
```
Do you have resolved this problem？  
@sorccu Need your help... @sorccu  STF log as follow:
`INF/device:plugins:screen:capture 15914 [LGE9805310cdab] Capturing screenshot
  adb:command Send '001Dhost:transport:LGE9805310cdab' +9s
  adb:command Send '0089shell:LD_LIBRARY_PATH=/data/local/tmp exec /data/local/tmp/minicap -P 1080x1920@1080x1920/0 -s >/data/local/tmp/minicap_1487733564309.jpg' +1ms
  adb:command Send '001Dhost:transport:LGE9805310cdab' +293ms
  adb:command Send '0005sync:' +1ms
  adb:sync STAT /data/local/tmp/minicap_1487733564309.jpg +2ms
  adb:command Send '001Dhost:transport:LGE9805310cdab' +2ms
  adb:command Send '0005sync:' +1ms
  adb:sync RECV /data/local/tmp/minicap_1487733564309.jpg +1ms
INF/storage:temp 2949 [*] Uploaded "LGE9805310cdab.jpg" to "/tmp/upload_1b7a49095cf5b486e435b0a82891c900"
INF/device:support:storage 15914 [LGE9805310cdab] Uploaded to "/s/image/9b990945-5bdd-4368-a9db-11c19d8fcb71/LGE9805310cdab.jpg"
  adb:command Send '001Dhost:transport:LGE9805310cdab' +130ms
  adb:command Send '003Bshell:'rm' '-f' '/data/local/tmp/minicap_1487733564309.jpg'' +4ms
INF/device:plugins:screen:stream 15914 [LGE9805310cdab] Requesting frame producer to stop
INF/device:plugins:screen:stream 15914 [LGE9805310cdab] Disconnecting from minicap service
INF/device:plugins:screen:stream 15914 [LGE9805310cdab] Stopping minicap service
INF/device:plugins:screen:stream 15914 [LGE9805310cdab] Sending SIGTERM to minicap
  adb:command Send '001Dhost:transport:LGE9805310cdab' +29s
  adb:command Send '0016shell:'kill' -15 31608' +0ms
INF/device:plugins:screen:stream 15914 [LGE9805310cdab] minicap says: "INFO: (jni/minicap/minicap.cpp:197) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 15914 [LGE9805310cdab] minicap says: "INFO: (jni/minicap/minicap.cpp:516) Closing client connection"
INF/device:plugins:screen:stream 15914 [LGE9805310cdab] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:297) Destroying virtual display"
`
After click the broken image, browser
![image](https://cloud.githubusercontent.com/assets/16586424/23195978/888ed9c8-f8f1-11e6-8665-9505b1336634.png)
 show:
![Uploading image.png…]()
 The problem is on Ubuntu 14.04 OS. 
I also have stf environment on my mac, everything is all right.  When i operation one some devices, first few minutes it works fine, but after sometime, the device becomes unworkable, cannot perform any action on it, even can not stop using it.
![image](https://cloud.githubusercontent.com/assets/10767521/16644631/099b471e-4451-11e6-840f-af13335d12fe.png)

The log shows:

INF/provider 3646 [_] Restarting device worker "de6894307ce3"
INF/device:support:push 3693 [de6894307ce3] Sending output to "tcp://127.0.0.1:7116"
INF/device 3693 [de6894307ce3] Preparing device
INF/device:support:sub 3693 [de6894307ce3] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 3693 [de6894307ce3] Subscribing to permanent channel "_ALL"
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:adb 3693 [de6894307ce3] Waiting for boot to complete
INF/device:support:properties 3693 [de6894307ce3] Loading properties
INF/device:support:abi 3693 [de6894307ce3] Supports ABIs arm64-v8a, armeabi-v7a, armeabi
INF/device:resources:service 3693 [de6894307ce3] Checking whether we need to install STFService
INF/device:resources:service 3693 [de6894307ce3] Running version check
INF/device:resources:service 3693 [de6894307ce3] STFService up to date
INF/device:plugins:service 3693 [de6894307ce3] Launching agent
INF/device:plugins:service 3693 [de6894307ce3] Agent says: "Listening on port 1090"
INF/device:plugins:service 3693 [de6894307ce3] Launching service
INF/device:plugins:service 3693 [de6894307ce3] Agent says: "InputClient started"
FTL/device 3693 [de6894307ce3] Setup had an error TimeoutError: operation timed out
    at afterTimeout (/Users/zy/workspace/stf/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:11:15)
    at timeoutTimeout (/Users/zy/workspace/stf/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:53:9)
    at Timer.listOnTimeout (timers.js:89:15)
FTL/util:lifecycle 3693 [de6894307ce3] Shutting down due to fatal error
INF/provider 3646 [_] Cleaning up device worker "de6894307ce3"
ERR/provider 3646 [_] Device worker "de6894307ce3" died with code 1

The log keeps printing this infomation, nothing works until i restart the device, pls help!
 @sorccu 
sorry, the device is 
de6894307ce3           device usb:336592896X product:land model:Redmi_3S device:land
 I have been experiencing this on all of my Nexus 5 devices running 6.0.1
0697815100eb88eb       device usb:5-2.4.1 product:hammerhead model:Nexus_5 device:hammerhead
06cae874439ca532       device usb:5-2.2 product:hammerhead model:Nexus_5 device:hammerhead

STF is version 2.0.1 and is running using stf local
The scenario is having the control tab open for the device and connected remotely to my system using adb connect.
stf doctor doesn't actually finish running for me

> INF/util:doctor 31156 [_] OS Arch: x64
> INF/util:doctor 31156 [_] OS Platform: linux
> INF/util:doctor 31156 [_] OS Platform: 4.4.0-34-generic
> INF/util:doctor 31156 [_] Using Node 4.2.6
> INF/util:doctor 31156 [_] Using RethinkDB client 2.3.2
> INF/util:doctor 31156 [_] Using ZeroMQ 4.1.5
> INF/util:doctor 31156 [*] Local RethinkDB server 2.3.4~0xenial
> /usr/local/lib/node_modules/stf/node_modules/semver/semver.js:293
>     throw new TypeError('Invalid Version: ' + version);
>     ^
> 
> TypeError: Invalid Version: 2.3.4~0xenial
>     at new SemVer (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:293:11)
>     at Range.test (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:1036:15)
>     at Function.satisfies (/usr/local/lib/node_modules/stf/node_modules/semver/semver.js:1085:16)
>     at unsupportedVersion (/usr/local/lib/node_modules/stf/lib/util/doctor.js:13:15)
>     at /usr/local/lib/node_modules/stf/lib/util/doctor.js:95:7
>     at /usr/local/lib/node_modules/stf/lib/util/doctor.js:50:22
>     at ChildProcess.exithandler (child_process.js:204:7)
>     at emitTwo (events.js:87:13)
>     at ChildProcess.emit (events.js:172:7)
>     at maybeClose (internal/child_process.js:821:16)
>     at Socket.<anonymous> (internal/child_process.js:319:11)
>     at emitOne (events.js:77:13)
>     at Socket.emit (events.js:169:7)
>     at Pipe._onclose (net.js:469:12)

The log is basically this on loop

> FTL/device 31335 [0697815100eb88eb] Setup had an error TimeoutError: operation timed out
>     at afterTimeout (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:11:15)
>     at timeoutTimeout (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:53:9)
>     at Timer.listOnTimeout (timers.js:92:15)
> FTL/util:lifecycle 31335 [0697815100eb88eb] Shutting down due to fatal error
> INF/provider 9924 [_] Cleaning up device worker "0697815100eb88eb"
> ERR/provider 9924 [_] Device worker "0697815100eb88eb" died with code 1
> INF/provider 9924 [_] Restarting device worker "0697815100eb88eb"
> INF/device:support:adb 31346 [06cae874439ca532] Waiting for boot to complete
> INF/device:support:push 31357 [0697815100eb88eb] Sending output to "tcp://127.0.0.1:7116"
> INF/device 31357 [0697815100eb88eb] Preparing device
> INF/device:support:sub 31357 [0697815100eb88eb] Receiving input from "tcp://127.0.0.1:7114"
> INF/device:support:sub 31357 [0697815100eb88eb] Subscribing to permanent channel "_ALL"
> INF/device:support:adb 31346 [06cae874439ca532] Waiting for boot to complete
> INF/device:support:adb 31357 [0697815100eb88eb] Waiting for boot to complete
> INF/device:support:adb 31346 [06cae874439ca532] Waiting for boot to complete
 
There is hardcoded timeout for boot operation in <STF_HOME>/lib/units/device/support/adb.js
And if in your pool there is slow device you will receive this exception every time after its reboot.
Sometimes it crashes everything in our case and only failover service returns STF back to normal state.
So we increased default timeout on line #25 to resolve this issue:
        .timeout(5*60000)
 @vdelendik I've tried to increase the default timeout to 5*60000, but it's still not working... The device is still in 'zombie state' and the log keeps printing the same error. ZMQ_TCP_KEEPALIVE and ZMQ_TCP_KEEPALIVE_IDLE setting is NOT working...

I've tried to figure out what causes this timeout, it turns out to be the code 
`devutil.waitForPort(adb, options.serial, service.port).timeout(15000)`
I've tried to increased the timeout to 15000*5, but still the same.

And I also found out that at this moment, the adb command of this device becomes **very very very** slow( adb -s SERIAL shell), almost not responding, maybe this is what causes the timeout.

The problem now is WHAT may be the reason that causes adb command of the device slow?
 @sorccu no, and this error seems only happens on Android 6.0.1. @sorccu The latest version of STF works fine! The device remains stable for a long time till now.  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->

after gulp build,stf local wrong

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

few days ago, download the code form openstf. 
sudo gulp build
few errors

then
res/web_modules/epoch/index.js
//require('ng-epoch')
res/web_modules/nine-bootstrap/index.js
//require('font-lato-2-subset')

sudo gulp build
no error

stf local
![image](https://cloud.githubusercontent.com/assets/19684548/16612596/55182c14-439a-11e6-9052-c88d012ba240.png)

![image](https://cloud.githubusercontent.com/assets/19684548/16612622/6ed619ae-439a-11e6-9ee4-b1c1b4e65ad2.png)

ubuntu
npm@3.9.5
node 6.2.2
gulp 3.9.1

thanks
  I want to connect 50 devices using local STF to the HP Elite Desk 800 G2 having ubuntu 14.0 LTS installed on it. on UI it shows **preparing** and **offline**. Could you please tell me what was the reason behind this?

We are using plugable usb 7 port hub, 32 GB RAM, i7 processor. 
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

I can not switch tasks / apps using a task switching button (square) on devices without software buttons. 

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->
## What should have happened?

The button would show the list of previously used applications.

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->

The menu button has been deprecated so it could be used as the switching button.
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
1. Connect to a device without software buttons.
2. Open an application (A)
3. Open another application (B)
4. Try to switch to the application (A) without using the Home button.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->

I need to be able to test using the switcher.
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->

Output from doctor:

```
INF/util:doctor 35838 [*] OS Arch: x64
INF/util:doctor 35838 [*] OS Platform: darwin
INF/util:doctor 35838 [*] OS Platform: 14.5.0
INF/util:doctor 35838 [*] Using Node 6.2.2
INF/util:doctor 35838 [*] Using RethinkDB client 2.3.2
INF/util:doctor 35838 [*] Using ZeroMQ 4.1.4
INF/util:doctor 35838 [*] Local ADB 1.0.36

INF/util:doctor 35838 [*] Local RethinkDB server 2.3.4
INF/util:doctor 35838 [*] ProtoBuf 2.6.1
INF/util:doctor 35838 [*] GraphicsMagick 1.3.24

```
 @juliusspencer the only way I could find is to use ADB Shell Commands from within STF
`input keyevent 219`
It should bring up the application switcher dialog :)

Someone can create pull request for making this as a button.
Would love to do it, but for now I don't know how :)
Maybe someday.
 Thank you @pwicherski for the quick feedback. I'm don't know enough about how it all works. I should take a look at the source.
 A solution I found that I managed to test on 3 different phones is also using an ADB command but slightly different.

`adb shell input keyevent KEYCODE_APP_SWITCH`

When connected to a device using the console I've sent this command and all 3 phones responded correctly by opening the Recent Apps Screen.

I would suggest that instead of the "Menu button" there would be the "Recent button". Or at least have an option somewhere to select which button you'd like at that position.
 With this solution, you can change the behavior of the context menu button to app switch button behavior:

1. Stop the OpenSTF server and open this file:
//usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/keycode.js

2. Modify the value of KEYCODE_MENU to 187 (It's the value of KEYCODE_APP_SWITCH key):
KEYCODE_MENU: 187,

3. Start the server. Now you can use the lower left key for switching apps:
[screen_shot_2017-07-19_at_17_02_03](https://user-images.githubusercontent.com/15833365/28375162-13f2df68-6ca7-11e7-8391-7f96241ed8fa.png)  There is to many stf's parameters.But there  haven't a example of them.Can anybody provide it ?

root@boyaatest:/home/boyaa-test# stf --help

  Usage: stf [options] [command]

  Commands:

```
provider [options] [serial...]          start provider
device [options] <serial>               start device worker
processor [options] <name>              start processor
reaper [options] <name>                 start reaper
triproxy [options] <name>               start triproxy
auth-ldap [options]                     start LDAP auth client
auth-oauth2 [options]                   start OAuth 2.0 auth client
auth-saml2 [options]                    start SAML 2.0 auth client
auth-mock [options]                     start mock auth client
auth-openid [options]                   start openid auth client
notify-hipchat [options]                start HipChat notifier
notify-slack [options]                  start Slack notifier
log-rethinkdb [options]                 start a rethinkdb log recorder
poorxy [options]                        start a poor reverse proxy for local development
app [options]                           start app
websocket [options]                     start websocket
storage-temp [options]                  start temp storage
storage-s3 [options]                    start s3 storage
storage-plugin-image [options]          start storage image plugin
storage-plugin-apk [options]            start storage apk plugin
migrate                                 migrates the database to the latest version
generate-fake-device [options] [model]  generates a fake device for testing
local [options] [serial...]             start everything locally
doctor [options]                        diagnose issues before starting
```

  Options:

```
-h, --help     output usage information
-V, --version  output the version number
```
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): 
- Version used (git hash or `stf -V`): 
- Environment name and version (e.g. Chrome 39, node.js 5.4): 
- Operating System and version: 
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: 

thanks your great project
i edit the nodejs code.but i dont know how to rebuild stf.
 gulp clean
 could u tell me how to gulp clean
 Install gulp ,at the dir of stf enter "gulp clean".
 I have the same question, but to do it with docker.
How can i gulp the project on docker?
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

Hi, I just want to know, if I connect to a device, regardless of using adb or not, let's say I connect via a socket I create, to whatever port in the device, could this device still be "seen" by stf? Or should I use adb no matter what.
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->

1.
2.
3.
4.
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->

I'm trying to connect via network, not just local wifi, but to connect to a device even remotely, and I mean via public network, like I can do with a server daemon, or cliente/server environment. Thanks in advance!
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md):  stf local
- Version used (git hash or `stf -V`): 1.1.1
- Environment name and version (e.g. Chrome 39, node.js 5.4):  Firefox, node.js 0.12
- Operating System and version: Linux mint raffaella
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: No problems with that.
 adb is still needed, because stf  use [adbkit](https://github.com/openstf/adbkit), and adbkit is only a adb client, not adb server.
 Thank You very much @codeskyblue , if I create a new plugin, or maybe dependency, which can connect by ssh, could I add it to stf?

Also, is it possible to create a ssh access to a device, using ssh over adb?

Thanks in advance!
 you do not need ssh. adb is just enough.
 Okay, Thank you @codeskyblue , What I was trying was to access a device through public network or 3g/4g, still don't know if this is possible, I'm doing my research, Than You
 Oh, Ok, Thank You very much @sorccu 

I'm sorry if I ask something out of stf, but, as far as I know, Teamviewer offers remote without rooting, do you have an idea, which technologies or scenarios could allow that? 

Or is it just plain impossible

Sorry for that question, I know it's out of the repo, just curious if You know something about it.

Thank You very much.
  <!---

IF YOU REMOVE THIS TEMPLATE WE WILL CLOSE YOUR ISSUE WITHOUT RESPONSE.
Just read it. See the commonly asked questions and fill in the details we're asking, it saves so much of our time.

Hi there!

Please be sure to run `stf doctor` before submitting an issue. Please include screenshots, command output and log files if any.

=== SUPER COMMON QUESTIONS ===

Q. I'm having issues when multiple devices are connected.
A. Usually caused by insufficient USB power supply or other hardware issue we can't do anything about.

Q. Can I connect a device to STF over WIFI?
A. Yes, with the `--allow-remote` option. However, ADB over WIFI can easily be 10x slower than USB, so don't expect too much.

Q. How do I connect to my local STF from another computer?
A. Try the `--public-ip` option or do a full deployment. See DEPLOYMENT.md in the doc folder.

Q. Can I run STF on multiple machines?
A. Yes, if you do a full deployment. See DEPLOYMENT.md in the doc folder.
-->
## What's the problem (or question)?

<!--- If describing a bug, tell us what happens instead of the expected behavior -->

<!--- If suggesting a change/improvement, explain the difference from current behavior -->

How to connect devices which don't have PTP?
## What should have happened?

<!--- If you're describing a bug, tell us what should happen -->

<!--- If you're suggesting a change/improvement, tell us how it should work -->

Device should be able to connect to STF.
## Do you have an idea for a solution?

<!--- Not obligatory, but suggest a fix/reason for the bug, -->

<!--- or ideas how to implement the addition or change -->

Nope.
## How can we reproduce the issue?

<!--- Provide unambiguous set of steps to reproduce this bug. Include code to reproduce, if relevant -->
1. Connect almost any Sony device. 
## Help us understand your issue by providing context.

<!--- How has this issue affected you? What are you trying to accomplish? -->

<!--- Providing context helps us come up with a solution that is most useful in the real world -->

I can't connect device to STF.
## Please tell us details about your environment.

<!--- Include as many relevant details about the environment you experienced the bug in -->
- Are you using `stf local` or a [full deployment](doc/DEPLOYMENT.md): local
- Version used (git hash or `stf -V`): not relevant.
- Environment name and version (e.g. Chrome 39, node.js 5.4): not relevant.
- Operating System and version: Ubuntu 14.04 LTS
- If there was a problem with a specific device, run `adb devices -l` and paste the relevant row here: not relevant.
 @sorccu OK, updated. Sorry.
 ahhh. You are right! Thank you :)
 Just for the record:

The other workaround is to simply get rid of libmtp  with `sudo apt-get purge --purge libmtp9 libmtp-common libmtp-runtime` ([source](http://stackoverflow.com/a/35506088)) if you don't need to use it (some devices may not be accessible with your file browser etc.).

Just remember to check if `/etc/udev/rules.d/51-android.rules` needs to be updated with your device ids ([source](https://developer.android.com/studio/run/device.html#setting-up)) and to reboot your computer.

This way `adb` will be able to work properly without `root` privileges.
  Suppose, I have my own authentication UI which is developed using nodejs, express, jade.. blah blah..

Now I need to integrate this screen as the first Login screen which internally would connect to my LDAP server, authorizes the user and then come to Device Screen.

How can we do this? Can you give us step by step description?
 Sure thanks, Sorccu I will try this. 
 I want to add logout button in STF page. I did some changes in menu.jade file but it's not reflecting over UI. How the communication between webpack and js file happens? After every change I am restarting STF module using ./stf local But still not reflecting the changes :(. Who can help us in development related activity?
  Browser:Chrome(ch_zn,win 8)
STF server: ubuntu 16.04
Err feature:screenshots
Operating: 
1. choose one of device
2. click the tap of screenshots,and click buttom of screenshots.

result:
The pic that screen shot was empty.
![image](https://cloud.githubusercontent.com/assets/18346467/16065077/def0bef0-32d9-11e6-82d5-9f9bda6126ed.png)

log output:
INF/device:plugins:screen:capture 30486 [F8UDU15131003748] Capturing screenshot
INF/storage:temp 30424 [*] Uploaded "F8UDU15131003748.jpg" to "/tmp/upload_363625db7cbb670e950ce248c921fd78"
INF/device:support:storage 30486 [F8UDU15131003748] Uploaded to "/s/image/59653267-52dc-416f-9c9d-3f6eb82b0ee1/F8UDU15131003748.jpg"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Requesting frame producer to stop
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Disconnecting from minicap service
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Stopping minicap service
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Sending SIGTERM to minicap
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (jni/minicap/minicap.cpp:196) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (jni/minicap/minicap.cpp:512) Closing client connection"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:303) Destroying virtual display"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Keeping 574x804 as current frame producer projection
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Requesting frame producer to start
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Launching screen service
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "PID: 18722"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: Using projection 1080x1920@452x804/0"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:255) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:258) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:265) Creating virtual display"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Connecting to minicap service
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:271) Creating buffer queue"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:278) Creating CPU consumer"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:284) Creating frame waiter"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:288) Publishing virtual display"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 6268932 bytes for JPG encoder"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Reading minicap banner
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Requesting frame producer to stop
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Disconnecting from minicap service
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Stopping minicap service
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] Sending SIGTERM to minicap
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (jni/minicap/minicap.cpp:196) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (jni/minicap/minicap.cpp:512) Closing client connection"
INF/device:plugins:screen:stream 30486 [F8UDU15131003748] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:303) Destroying virtual display"

It's this a bug? 
 I got the same issue as well but in OS X.
Some news about this?
 I think issue could be here
`INF/device:support:storage 30486 [F8UDU15131003748] Uploaded to "/s/image/59653267-52dc-416f-9c9d-3f6eb82b0ee1/F8UDU15131003748.jpg"`

the /s/image directory does not exists...
 I don't really find where is the problem. The screen cature is fine ,maybe it was err when tranfer process or  write file.
The core maybe err at the lib/device/screen/cature.js  50 line.But  I'm still not quite understand nodejs .It take me some time to learn nodejs and angularjs.

.......
          return adb.pull(options.serial, file)
            .then(function(transfer) {
              return storage.store('image', transfer, {
                filename: util.format('%s.jpg', options.serial)
              , contentType: 'image/jpeg'
              , knownLength: stats.size
 I tested now in my setup on Linux , and the screenshots problem is not found , so probably the problem may be related to OS X.
 @joaopedroms22  May I see your "stf doctor" info?
 I don't have "stf doctor" don't know why.
My "stf ''help" shows this:

```
user@test-lab-mac-01:~$ stf --help

  Usage: stf [options] [command]


  Commands:

    provider [options] [serial...]          start provider
    device [options] <serial>               start device worker
    processor [options] <name>              start processor
    reaper [options] <name>                 start reaper
    triproxy [options] <name>               start triproxy
    auth-ldap [options]                     start LDAP auth client
    auth-oauth2 [options]                   start OAuth 2.0 auth client
    auth-saml2 [options]                    start SAML 2.0 auth client
    auth-mock [options]                     start mock auth client
    notify-hipchat [options]                start HipChat notifier
    log-rethinkdb [options]                 start a rethinkdb log recorder
    poorxy [options]                        start a poor reverse proxy for local development
    app [options]                           start app
    websocket [options]                     start web socket
    storage-temp [options]                  start temp storage
    storage-s3 [options]                    start s3 storage
    storage-plugin-image [options]          start storage image plugin
    storage-plugin-apk [options]            start storage ask plugin
    migrate                                 migrates the database to the latest version
    generate-fake-device [options] [model]  generates a fake device for testing
    local [options] [serial...]             start everything locally

  Options:

    -h, --help     output usage information
    -V, --version  output the version number

user@test-lab-mac-01:~$ stf --version
1.1.1

```
 @sorccu  I have catch the wrong message.That is "http404". Why  is my website not found?But my stf'site have been running

log:
2016-07-14 17:12:40 ERR/storage:plugins:image 24061 [*] Unable to transform resource "4ac8ea9d-2a5e-45d4-b621-7e4f2feceb3c" Error: HTTP 404
    at Request.<anonymous> (/opt/stf/lib/units/storage/plugins/image/task/get.js:15:18)
    at emitOne (events.js:90:13)
    at Request.emit (events.js:182:7)
    at Request.onRequestResponse (/opt/stf/node_modules/request/request.js:977:10)
    at emitOne (events.js:90:13)
    at ClientRequest.emit (events.js:182:7)
    at HTTPParser.parserOnIncomingClient [as onIncoming](_http_client.js:458:21)
    at HTTPParser.parserOnHeadersComplete (_http_common.js:103:23)
    at Socket.socketOnData (_http_client.js:348:20)
    at emitOne (events.js:90:13)
    at Socket.emit (events.js:182:7)
    at readableAddChunk (_stream_readable.js:153:18)
    at Socket.Readable.push (_stream_readable.js:111:10)
    at TCP.onread (net.js:531:20)
From previous event:
    at module.exports (/opt/stf/lib/units/storage/plugins/image/task/get.js:9:10)
    at /opt/stf/lib/units/storage/plugins/image/index.js:31:14
    at maybeNext (/opt/stf/lib/util/requtil.js:38:15)
    at /opt/stf/lib/util/requtil.js:49:5
    at Layer.handle [as handle_request](/opt/stf/node_modules/express/lib/router/layer.js:95:5)
    at next (/opt/stf/node_modules/express/lib/router/route.js:131:13)
    at Route.dispatch (/opt/stf/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request](/opt/stf/node_modules/express/lib/router/layer.js:95:5)
    at /opt/stf/node_modules/express/lib/router/index.js:277:22
    at param (/opt/stf/node_modules/express/lib/router/index.js:349:14)
    at param (/opt/stf/node_modules/express/lib/router/index.js:365:14)
    at param (/opt/stf/node_modules/express/lib/router/index.js:365:14)
    at Function.process_params (/opt/stf/node_modules/express/lib/router/index.js:410:3)
    at next (/opt/stf/node_modules/express/lib/router/index.js:271:10)
    at expressInit (/opt/stf/node_modules/express/lib/middleware/init.js:33:5)
    at Layer.handle [as handle_request](/opt/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/opt/stf/node_modules/express/lib/router/index.js:312:13)
    at /opt/stf/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/opt/stf/node_modules/express/lib/router/index.js:330:12)
2016-07-14 17:13:05 INF/device:plugins:screen:stream 24104 [F8UDU15131003748] Requesting frame producer to stop
2016-07-14 17:13:05 INF/device:plugins:screen:stream 24104 [F8UDU15131003748] Disconnecting from minicap service
2016-07-14 17:13:05 INF/device:plugins:screen:stream 24104 [F8UDU15131003748] Stopping minicap service
2016-07-14 17:13:05 INF/device:plugins:screen:stream 24104 [F8UDU15131003748] Sending SIGTERM to minicap
  Hello,

i'm trying to change orientation for m2 note device (Android 5.1) by  clicking Landscape button on STF UI, but nothing happened. If I change it manually, working fine. Also switching from Landscape to Portrait works good via button click

No changes in STF logs after clicking Landscape mode 

Thanks,
Maria 
  STF has been run.
Operating:
1.choose one of the device.
2.upload the apk and install it.
3.to disconnect device.
4.to choose the same device again.

Result:
Already installed app is deleted when the second use.

Question:
Whether has a feature that to del the last user's record?
 Thanks.
    sft run on my VMware. system is ubuntu,Real machine is windows 7
then open http://localhost:7100/, i can login on my VMware.
then open 192.168.75.128:7100 on my  windows 7. url also display http://localhost:7100/.so open failed
picture  like this
![image](https://cloud.githubusercontent.com/assets/19684548/15735962/19f7650e-28cf-11e6-84d0-9cfad28af1b4.png)
 OK,thank u.Next time I will do
 start stf:
stf local --public-ip your_internal_network_ip_here
another computer can connect stf now.
 Hi @zjj796 @sorccu 

I can run Stf locally ,I am trying to run on remote and followed 

**stf local --public-ip <your_internal_network_ip_here>
stf local 10.x.x.x 10..y.y.y**
I can still see its running locally but not on remote address which i mentioned above.
Please let me know If I am doing anything wrong ?

Logs:
INF/util:procutil 64270 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 64271 [*] Connecting to 127.0.0.1:28015
INF/db 64271 [*] Unable to connect to 127.0.0.1:28015
FTL/db 64271 [*] No hosts left to try
FTL/util:lifecycle 64271 [*] Shutting down due to fatal error

/usr/local/lib/node_modules/stf/node_modules/bluebird/js/main/promise.js:680
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:204:12)

Thanks



 Maybe you need to add-R option

发自我的 iPhone

在 2017年2月9日，20:04，sk <notifications@github.com<mailto:notifications@github.com>> 写道：


Hi @zjj796<https://github.com/zjj796> ,

I ca run Stf locally ,I am trying to run on remote and followed

stf local --public-ip <your_internal_network_ip_here>
stf local 10.x.x.x 10..y.y.y
I can still see its running locally but not on remote address which i mentioned above.
Please let me know If I am doing anything wrong ?

Thanks

—
You are receiving this because you are subscribed to this thread.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/343#issuecomment-278623165>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AAclJfLjpc8WdyzmhDhCEJX0yptCXjr0ks5rawDSgaJpZM4IsPqN>.
 @perfectspr 

Got it working now !
stf local --public-ip 10.X.X.X

  @sorccu 

I have deployed stf in production mode on coreOS.
After starting all the services all devices start showing and are accessible. Now after 24 hours or so, 
few of the devices only show on screen and rest go in disconnected state ( Although the devices are connected to the same machines ). 
When i access a device in this state it shows up grey screen and on performing any action ( take screenshot ) it throws error. 
Have attached the screen-shots.  

When i restart the services, all devices start showing up again and are accessible.  Can you please guide me where can be the issue ? 

<img width="1437" alt="screen shot 2016-06-02 at 11 35 40 am" src="https://cloud.githubusercontent.com/assets/8023118/15735421/64103710-28b6-11e6-8c12-6c18c63041a1.png">
<img width="1436" alt="screen shot 2016-06-02 at 11 36 03 am" src="https://cloud.githubusercontent.com/assets/8023118/15735425/6e892ff8-28b6-11e6-9904-9dda0b94aed0.png">
<img width="1434" alt="screen shot 2016-06-02 at 11 40 15 am" src="https://cloud.githubusercontent.com/assets/8023118/15735469/ced29dae-28b6-11e6-9df5-da266b90293e.png">
 The changes was only the logo to check and deploy the changes with docker. 
At the time of starting units all devices starts showing up correctly. But after some time they go in some zombie state. 
 @vbanthia - I have to pass them to providers only ?
Is below given unit file looks okay ?  

[Unit]
Description=STF app
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --link rethinkdb-proxy-28015:rethinkdb \
  -e "SECRET=YOUR_SESSION_SECRET_HERE" \
  -e "ZMQ_TCP_KEEPALIVE =1" \
  -e "ZMQ_TCP_KEEPALIVE_IDLE =30000" \
  -p %i:3000 \
  openstf/stf:latest \
  stf app --port 3000 \
    --auth-url https://stf.example.org/auth/mock/ \
    --websocket-url https://stf.example.org/
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
 Thanks @vbanthia 
I am using COREOS + fleet

I have made the following changes
-e "ZMQ_TCP_KEEPALIVE=1" \
-e "ZMQ_TCP_KEEPALIVE_IDLE=30000" \
to the below unit-files
stf-triproxy-app
stf-triproxy-dev
stf-websocket
stf-provider@
stf-processor@

The setup works absolutely fine. But when i change the value  "ZMQ_TCP_KEEPALIVE_IDLE=30000" to 
 "ZMQ_TCP_KEEPALIVE_IDLE=600000" it starts  failing with the error in all above unit files with 
Invalid argument (tcp.cpp:121)

Any work around or is there any max limit to the value ? 
 @vbanthia  - please check if u get some time 
 Same issue here on my production deployment. Over time (usually a few hours), devices become inaccessible through the Control screen, but still show up as accessible in the main Devices list.  This issue is repeatable on both the master and v2.0.0 versions.

Adding the `ZMQ_TCP_KEEPALIVE=1` and `ZMQ_TCP_KEEPALIVE_IDLE=30000` environment variables to the systemd unit files did not seem to remedy the situation.

Not sure if this helps to diagnose the issue, but restarting only the provider services is sufficient for me to fully restore device access, but only to have the timeout occur again several hours later.
 Looking good so far passing 6 hours uptime with `ZMQ_TCP_KEEPALIVE_IDLE=300`. 

By now, without any direct interaction with STF, I would expect to see at least one provider start to become unresponsive. I'll follow up with on-going feedback since the issue intermittently took as long as ~48 hours idle to occur, but I expect this resolves the issue for me, thanks!
 Tried with  value ZMQ_TCP_KEEPALIVE_IDLE=300  and it failed after approx 8 hrs.
 Four days uptime, all devices and providers still responsive. This definitely fixed the issue for me!

@sj2208  if the connection is still failing, I would try further reducing the value of `ZMQ_TCP_KEEPALIVE_IDLE`. Presumably the connection fails due to idle timeout; this will reduce the time period before the keepalive probes will start to fire to maintain the connection.
 Yep this is working. Thank you guys :) 👍   @vbanthia  @mitchtech  @sorccu  
  ERR! build error 
fatal error: zmq.h: No such file or directory

stf@ubuntu:~$ sudo npm install -g stf
[sudo] password for stf: 
npm WARN deprecated jade@1.11.0: Jade has been renamed to pug, please install the latest version of pug instead of jade
npm WARN deprecated transformers@2.1.0: Deprecated, use jstransformer
/usr/local/bin/stf -> /usr/local/lib/node_modules/stf/bin/stf

> dtrace-provider@0.5.0 install /usr/local/lib/node_modules/stf/node_modules/dtrace-provider
> node scripts/install.js
> 
> jpeg-turbo@0.3.2 install /usr/local/lib/node_modules/stf/node_modules/jpeg-turbo
> node-pre-gyp install --fallback-to-build

[jpeg-turbo] Success: "/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v46-linux-x64/jpegturbo.node" is installed via remote

> bufferutil@1.2.1 install /usr/local/lib/node_modules/stf/node_modules/bufferutil
> node-gyp rebuild

make: Entering directory '/usr/local/lib/node_modules/stf/node_modules/bufferutil/build'
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
  SOLINK_MODULE(target) Release/obj.target/bufferutil.node
  COPY Release/bufferutil.node
make: Leaving directory '/usr/local/lib/node_modules/stf/node_modules/bufferutil/build'

> utf-8-validate@1.2.1 install /usr/local/lib/node_modules/stf/node_modules/utf-8-validate
> node-gyp rebuild

make: Entering directory '/usr/local/lib/node_modules/stf/node_modules/utf-8-validate/build'
  CXX(target) Release/obj.target/validation/src/validation.o
  SOLINK_MODULE(target) Release/obj.target/validation.node
  COPY Release/validation.node
make: Leaving directory '/usr/local/lib/node_modules/stf/node_modules/utf-8-validate/build'

> zmq@2.15.2 install /usr/local/lib/node_modules/stf/node_modules/zmq
> node-gyp rebuild

make: Entering directory '/usr/local/lib/node_modules/stf/node_modules/zmq/build'
  CXX(target) Release/obj.target/zmq/binding.o
../binding.cc:28:17: fatal error: zmq.h: No such file or directory
compilation terminated.
zmq.target.mk:90: recipe for target 'Release/obj.target/zmq/binding.o' failed
make: **\* [Release/obj.target/zmq/binding.o] Error 1
make: Leaving directory '/usr/local/lib/node_modules/stf/node_modules/zmq/build'
gyp ERR! build error 
gyp ERR! stack Error: `make` failed with exit code: 2
gyp ERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/node-gyp/lib/build.js:276:23)
gyp ERR! stack     at emitTwo (events.js:87:13)
gyp ERR! stack     at ChildProcess.emit (events.js:172:7)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)
gyp ERR! System Linux 4.4.0-22-generic
gyp ERR! command "/usr/bin/nodejs" "/usr/local/bin/node-gyp" "rebuild"
gyp ERR! cwd /usr/local/lib/node_modules/stf/node_modules/zmq
gyp ERR! node -v v4.2.6
gyp ERR! node-gyp -v v3.3.1
gyp ERR! not ok 
/usr/local/lib
└── (empty)

npm ERR! Linux 4.4.0-22-generic
npm ERR! argv "/usr/bin/nodejs" "/usr/bin/npm" "install" "-g" "stf"
npm ERR! node v4.2.6
npm ERR! npm  v3.5.2
npm ERR! code ELIFECYCLE

npm ERR! zmq@2.15.2 install: `node-gyp rebuild`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the zmq@2.15.2 install script 'node-gyp rebuild'.
npm ERR! Make sure you have the latest version of node.js and npm installed.
npm ERR! If you do, this is most likely a problem with the zmq package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get information on how to open an issue for this project with:
npm ERR!     npm bugs zmq
npm ERR! Or if that isn't available, you can get their info via:
npm ERR!     npm owner ls zmq
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /home/stf/npm-debug.log
npm ERR! code 1
stf@ubuntu:~$ 
 thanks，reinstall zeromq,then ok
  I am not able to connect device even using "Remote debug" connection string. I have some problems with standard STF functionality.

When I click "Use" in web-interface, and then execute 'adb connect host:port', and still can't see device in adb devices. 
When I execute remote debug string in shell 'adb connect host:port' i get,
- daemon not running. starting it now on port 5038 *
- daemon started successfully *
  connected to 192.**_._.**_:_***

after this when i execute 'adb devices' i get,
- daemon not running. starting it now on port 5038 *
- daemon started successfully *
  List of devices attached 

There is one device connected to stf but it is not being displayed.

My aim is to connect and bind the devices connected to openstf from my system to run the test cases.
Can you let me know how will I come to know when the devices are binded and ready to use from my system? I am using python-stf-utils to bind and connect to stf devices.
 The below image is the stf doctor output..
![2016-06-01-photo-00000002](https://cloud.githubusercontent.com/assets/7942835/15721925/e517f586-2858-11e6-97a1-87fd6ff90b9c.jpg)

The below images are the stf logs.
![img_1639](https://cloud.githubusercontent.com/assets/7942835/15721964/16d09e98-2859-11e6-861d-edba65e9e345.JPG)
![img_1642](https://cloud.githubusercontent.com/assets/7942835/15721966/1b291f60-2859-11e6-9877-6193529f21c8.JPG)
![img_1643](https://cloud.githubusercontent.com/assets/7942835/15721969/2022676a-2859-11e6-94a8-7fd7683ea926.JPG)
 How much devices have you access?
 I am connecting only one device, HTC desire 600. And the others which appear in the log are the ones which I connected once for testing but haven't used them since long.
 So what might be the reason for adb not getting the list of devices connected from the web interface of stf shell command? Am I missing something?
 What else can I post, can you suggest?
And I also got two errors in stf doctor. To update the node and protobuf, Does that have any effect?
 I think you can try to del the recored from rethinkdb.
   Hi~

Thank you for your awesome stuff. stf is really great job.

I am trying to install stf in my workspace. But, I have a problem when applying ldap auth.
I think that my workspace ldap settings are uncommon. cn field is a array. ex) ['employee ID', 'employee name']

So, I would like to add an option which can select ldap field for stf username.

Please check this PR.
thank you in advance
 @sorccu Thanks quick review!
I fixed typo

Thank you for merging!!
  Hi There,

I got this issue when installing STF and running `stf local` the error something like this :

```
INF/util:procutil 1899 [*] Forking "/Users/lutvirosyady/stf/lib/cli.js migrate"
INF/db 1900 [*] Connecting to 127.0.0.1:28015
undefined:1
ERROR: Received an unsupported protocol version. This port is for RethinkDB queries. Does your client driver version not match the server?
^

SyntaxError: Unexpected token E in JSON at position 0
    at Object.parse (native)
    at Socket.handshake_callback (/Users/lutvirosyady/stf/node_modules/rethinkdb/net.js:624:35)
    at emitOne (events.js:96:13)
    at Socket.emit (events.js:188:7)
    at readableAddChunk (_stream_readable.js:172:18)
    at Socket.Readable.push (_stream_readable.js:130:10)
    at TCP.onread (net.js:542:20)

/Users/lutvirosyady/stf/node_modules/bluebird/js/main/promise.js:677
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/Users/lutvirosyady/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:106:13)
    at ChildProcess.emit (events.js:191:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:204:12)
```

For you detail information when I run `stf doctor` I got result like this as follow :

```
Users/lutvirosyady/stf/node_modules/zmq/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: Module version mismatch. Expected 48, got 14.
    at Error (native)
    at Object.Module._extensions..node (module.js:568:18)
    at Module.load (module.js:458:32)
    at tryModuleLoad (module.js:417:12)
    at Function.Module._load (module.js:409:3)
    at Module.require (module.js:468:17)
    at require (internal/module.js:20:19)
    at bindings (/Users/lutvirosyady/stf/node_modules/zmq/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/Users/lutvirosyady/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:541:32)
    at Object.Module._extensions..js (module.js:550:10)
    at Module.load (module.js:458:32)
    at tryModuleLoad (module.js:417:12)
    at Function.Module._load (module.js:409:3)
    at Module.require (module.js:468:17)
    at require (internal/module.js:20:19)
```

Could you please help with this, so I can start to use STF.. :-)
Much appreciated for all your help here..

Cheers,
 You can try to reinstall stf and another version of rethinkdb that I was doing.

The issue I have ask: https://github.com/openstf/stf/issues/305
The link of rethinkdb:  http://download.rethinkdb.com/apt
Choose a suitable one 
![image](https://cloud.githubusercontent.com/assets/18346467/15671309/d35cd3c2-275c-11e6-99d3-2bd304fdabba.png)

I hope that can help you.
 It's been fixed, It just need to upgrade rethinkdb version to latest version..

Thanks @0x88l @sorccu  for all your supports
  @sorccu - Need help regarding the production setup on coreOS:

I have done the production setup for STF on  4 coreOS machines. Now the major problem that i run into is that every other night one or the other COREOS machine restarts and the services restarts on other machines. I have to go and then edit the nginx.conf file with the updated end-points. 

Need to know if there is a way to disable the reboot for the machines ? or is there any stable way for production setup so that they don't bring the complete production setup down ?

Below are the setup details:

CoreOS version - stable 
I have coreOS machine with an entry for "reboot-strategy:off" in cloud config. 
coreos:
  update:
    reboot-strategy: off
 Sure I agree that it belong to a COREOS problem, thought if you have some ideas to share on it. 

I validated my cloud-config at this [link](https://coreos.com/validate/) and it has no error.

I have made the changes to my unit files to run on the basis of machineID for now.  I saw your reply on the [thread](https://github.com/coreos/bugs/issues/161), so posted the question here. 
Thanks,
Closing this issue.
 I completely understand  👍 
Will try to be precise about the issues from next time :) 

You have developed an amazing tool and its so helpful. Hoping for some new features \m/
  does stf support to connect to  phone or Simulator(genymotion) with wifi, if so ,  how to make it.
 could you please send me a link?
  I receive the following error when trying to run the stf-migrate docker. 

INF/db 1 [*] Connecting to 172.17.0.2:28015
undefined:1
ERROR: Received an unsupported protocol version. This port is for RethinkDB queries. Does your client driver version not match the server?
^

SyntaxError: Unexpected token E
    at Object.parse (native)
    at Socket.handshake_callback (/app/node_modules/rethinkdb/net.js:624:35)
    at emitOne (events.js:77:13)
    at Socket.emit (events.js:169:7)
    at readableAddChunk (_stream_readable.js:146:16)
    at Socket.Readable.push (_stream_readable.js:110:10)
    at TCP.onread (net.js:523:20)

Tried rethinkdb version 2.1.1 and 2.3.2. 
 Thanks stupid mistake.  The deployment doc should be updated to version 2.3.2

[Unit]
Description=RethinkDB
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull rethinkdb:**2.1.1**
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStartPre=/usr/bin/mkdir -p /srv/rethinkdb
ExecStartPre=/usr/bin/chattr -R +C /srv/rethinkdb
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -v /srv/rethinkdb:/data \
  -e "AUTHKEY=YOUR_RETHINKDB_AUTH_KEY_HERE_IF_ANY" \
  --net host \
  rethinkdb:**2.1.1** \
  rethinkdb --bind all \
    --cache-size 8192
ExecStop=-/usr/bin/docker stop -t 10 %p
  I have STF deployed on Oracle VM box. 2 devices are connected properly and available in usb filter also. But device showing offline and then gets disconnected. 
please find below logs:
Lost device "c8ee0c84" (offline)
ADB lists a weird device : "??????"
ADB lists a weird device : "??????"
Providing all 0 device(s)
  Write please instructions for beginners or record a video installation please.
I really liked your project. I want to test it. But I can not figure out how to run it on Linux.
 Yes, you wrote to me how to run . But, how to install?
 You can google it.
  @sorccu 
Hi I have followed the steps mentioned [here]
Below is the error that appears while building a docker image from local ( macOSX )

**ERROR in Missing binding /tmp/build/node_modules/node-sass/vendor/linux-x64-46/binding.node
Node Sass could not find a binding for your current environment: Linux 64-bit with Node.js 4.x

Found bindings for the following environments:
- OS X 64-bit with Node.js 4.x

This usually happens because your environment has changed since running `npm install`.
Run `npm rebuild node-sass` to build the binding for your current environment.
 @ ./res/web_modules/nine-bootstrap/nine-bootstrap.scss 4:14-137**

System Details
Current node version- v4.4.4
npm - v2.15.1
brew -v 
Homebrew 0.9.9 (git revision 799d; last commit 2016-04-19)
Homebrew/homebrew-core (git revision 34ac; last commit 2016-04-19)

sw_vers
ProductName:    Mac OS X
ProductVersion: 10.10.4
BuildVersion:   14E46

Here is complete log for the build( search for error and it will appear in (/res/web_modules/nine-bootstrap/nine-bootstrap.scss)):
- cd /tmp/build
- export PATH=/tmp/build/node_modules/.bin:/app/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
- npm install --loglevel http

> stf@1.1.1 prepublish /tmp/build
> bower install && not-in-install && gulp build || in-install

npm WARN engineStrict Per-package engineStrict (found in this package's package.json) 
npm WARN engineStrict won't be used in npm 3+. Use the config setting `engine-strict` instead.
- npm pack

> stf@1.1.1 prepublish /tmp/build
> bower install && not-in-install && gulp build || in-install

Warning: gulp-run is deprecated
[13:38:10] Using gulpfile /tmp/build/gulpfile.js
[13:38:10] Starting 'clean'...
[13:38:10] Starting 'webpack:build'...
INF/webpack:config 62 [_] Build progress 0% (compile)
INF/webpack:config 62 [_] Build progress 34% (32/79 build modules)
INF/webpack:config 62 [_] Build progress 37% (98/211 build modules)
INF/webpack:config 62 [_] Build progress 41% (142/271 build modules)
INF/webpack:config 62 [_] Build progress 56% (276/353 build modules)
INF/webpack:config 62 [_] Build progress 62% (398/451 build modules)
INF/webpack:config 62 [_] Build progress 66% (472/498 build modules)
INF/webpack:config 62 [_] Build progress 62% (501/577 build modules)
[13:38:19] [webpack:build] Hash: 57daa9b8e25369c40ae0
Version: webpack 1.13.0
Time: 8885ms
                                 Asset       Size  Chunks             Chunk Names
 34f4fb7db2bd6acd7b011434f72adb5c.woff    77.5 kB          [emitted]  
  f4769f9bdb7466be65088239c12046d1.eot    20.1 kB          [emitted]  
 fa2772327f55d8198301fdb8bcfc8158.woff    23.4 kB          [emitted]  
  e18bbf611f2a2e43afc071aa2f4e1512.ttf    45.4 kB          [emitted]  
  89889688147bd7575d6327160d64e760.svg     109 kB          [emitted]  
  32400f4e08932a94d8bfd2422702c446.eot    70.8 kB          [emitted]  
db812d8a70a4e88e888744c1c9a27e89.woff2    66.6 kB          [emitted]  
 a35720c2fed2c7f043bc7e4ffb45e073.woff    83.6 kB          [emitted]  
  a3de2170e4e9df77161ea5d3f31b2668.ttf     142 kB          [emitted]  
  f775f9cca88e21d45bebe185b27c0e5b.svg     366 kB          [emitted]  
 443a27166608ea2aef94f5cf05ff19ec.woff    74.7 kB          [emitted]  
448c34a56d699c29117adc64c43affeb.woff2      18 kB          [emitted]  
 96978e6fcc6395ca44894139e0baa0b2.woff    80.4 kB          [emitted]  
 a8a00e89adc0ba57870098be433da27a.woff      81 kB          [emitted]  
  fda02a702c4a73c27958341c42582645.png    6.17 kB          [emitted]  
  2ea14771c3aa7a75e01bd1faf7e10d80.png    56.1 kB          [emitted]  
                    entry/app.entry.js       1 kB    0, 6  [emitted]  app
       1.57daa9b8e25369c40ae0.chunk.js    4.99 MB    1, 6  [emitted]  
               entry/authldap.entry.js  602 bytes    2, 6  [emitted]  authldap
       3.57daa9b8e25369c40ae0.chunk.js    1.48 MB    3, 6  [emitted]  
               entry/authmock.entry.js  601 bytes    4, 6  [emitted]  authmock
       5.57daa9b8e25369c40ae0.chunk.js    1.48 MB    5, 6  [emitted]  
                entry/commons.entry.js    3.56 kB       6  [emitted]  entry/commons.entry.js
chunk    {0} entry/app.entry.js (app) 835 bytes {6} [rendered]
    [0] ./res/app/app.js 835 bytes {0} [built]
chunk    {1} 1.57daa9b8e25369c40ae0.chunk.js 4.84 MB {0} [rendered]
    [1] ./res/bower_components/angular/angular.js 1.15 MB {1} {3} {5} [built]
    [2] ./res/bower_components/angular-route/angular-route.js 38.1 kB {1} {3} {5} [built]
    [3] ./res/bower_components/angular-touch/angular-touch.js 26.6 kB {1} {3} {5} [built]
    [4] ./res/web_modules/gettext/index.js 67 bytes {1} {3} {5} [built]
    [5] ./res/bower_components/angular-gettext/dist/angular-gettext.js 24.6 kB {1} {3} {5} [built]
    [6] ./res/web_modules/angular-hotkeys/index.js 160 bytes {1} [built]
    [7] ./res/bower_components/angular-hotkeys/build/hotkeys.css 949 bytes {1} [built]
    [8] ./~/css-loader!./res/bower_components/angular-hotkeys/build/hotkeys.css 2.13 kB {1} [built]
    [9] ./~/css-loader/lib/css-base.js 1.51 kB {1} {3} {5} [built]
   [10] ./~/style-loader/addStyles.js 7.15 kB {1} {3} {5} [built]
   [11] ./res/bower_components/angular-hotkeys/build/hotkeys.js 53 kB {1} [built]
   [12] ./res/app/layout/index.js 682 bytes {1} [built]
   [13] ./res/web_modules/nine-bootstrap/index.js 179 bytes {1} {3} {5} [built]
   [14] ./res/bower_components/bootstrap/dist/css/bootstrap.css 967 bytes {1} {3} {5} [built]
   [15] ./~/css-loader!./res/bower_components/bootstrap/dist/css/bootstrap.css 154 kB {1} {3} {5} [built]
   [16] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.eot 82 bytes {1} {3} {5} [built]
   [17] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2 84 bytes {1} {3} {5} [built]
   [18] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.woff 83 bytes {1} {3} {5} [built]
   [19] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.ttf 82 bytes {1} {3} {5} [built]
   [20] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.svg 82 bytes {1} {3} {5} [built]
   [21] ./res/web_modules/nine-bootstrap/nine-bootstrap.scss 1.1 kB {1} {3} {5} [built] [1 error]
   [23] ./res/bower_components/components-font-awesome/css/font-awesome.css 964 bytes {1} {3} {5} [built]
   [24] ./~/css-loader!./res/bower_components/components-font-awesome/css/font-awesome.css 37.4 kB {1} {3} {5} [built]
   [25] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.eot?v=4.5.0 82 bytes {1} {3} {5} [built]
   [26] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.eot 82 bytes {1} {3} {5} [built]
   [27] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.woff2?v=4.5.0 84 bytes {1} {3} {5} [built]
   [28] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.woff?v=4.5.0 83 bytes {1} {3} {5} [built]
   [29] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.ttf?v=4.5.0 82 bytes {1} {3} {5} [built]
   [30] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.svg?v=4.5.0 82 bytes {1} {3} {5} [built]
   [31] ./res/bower_components/font-lato-2-subset/css/font-lato-2.css 961 bytes {1} {3} {5} [built]
   [32] ./~/css-loader!./res/bower_components/font-lato-2-subset/css/font-lato-2.css 1.15 kB {1} {3} {5} [built]
   [33] ./res/bower_components/font-lato-2-subset/font/LatoLatinHair-Regular.woff 83 bytes {1} {3} {5} [built]
   [34] ./res/bower_components/font-lato-2-subset/font/LatoLatinLight-Regular.woff 83 bytes {1} {3} {5} [built]
   [35] ./res/bower_components/font-lato-2-subset/font/LatoLatin-Regular.woff 83 bytes {1} {3} {5} [built]
   [36] ./res/bower_components/font-lato-2-subset/font/LatoLatin-Bold.woff 83 bytes {1} {3} {5} [built]
   [37] ./res/app/layout/cursor.css 934 bytes {1} [built]
   [38] ./~/css-loader!./res/app/layout/cursor.css 839 bytes {1} [built]
   [39] ./res/app/layout/small.css 931 bytes {1} [built]
   [40] ./~/css-loader!./res/app/layout/small.css 824 bytes {1} [built]
   [41] ./res/app/layout/stf-styles.css 946 bytes {1} [built]
   [42] ./~/css-loader!./res/app/layout/stf-styles.css 7.32 kB {1} [built]
   [43] ./res/app/components/stf/landscape/index.js 149 bytes {1} [built]
   [44] ./res/app/components/stf/browser-info/index.js 119 bytes {1} [built]
   [45] ./res/app/components/stf/browser-info/browser-info-service.js 1.78 kB {1} [built]
   [46] ./res/app/components/stf/landscape/landscape-directive.js 1.33 kB {1} [built]
   [47] ./res/app/components/stf/basic-mode/index.js 145 bytes {1} [built]
   [48] ./res/app/components/stf/basic-mode/basic-mode.css 970 bytes {1} [built]
   [49] ./~/css-loader!./res/app/components/stf/basic-mode/basic-mode.css 891 bytes {1} [built]
   [50] ./res/app/components/stf/basic-mode/basic-mode-directive.js 359 bytes {1} [built]
   [51] ./res/web_modules/ui-bootstrap/index.js 99 bytes {1} [built]
   [52] ./~/script-loader!./res/bower_components/angular-bootstrap/ui-bootstrap-tpls.js 192 bytes {1} [built]
   [53] ./~/script-loader/addScript.js 231 bytes {1} [built]
   [54] ./~/raw-loader!./res/bower_components/angular-bootstrap/ui-bootstrap-tpls.js 297 kB {1} [built]
   [55] ./res/web_modules/angular-borderlayout/index.js 186 bytes {1} [built]
   [56] ./res/bower_components/angular-borderlayout/src/borderLayout.js 26.7 kB {1} [built]
   [57] ./res/bower_components/angular-borderlayout/src/borderLayout.css 964 bytes {1} [built]
   [58] ./~/css-loader!./res/bower_components/angular-borderlayout/src/borderLayout.css 1.43 kB {1} [built]
   [59] ./res/web_modules/angular-borderlayout/style.css 931 bytes {1} [built]
   [60] ./~/css-loader!./res/web_modules/angular-borderlayout/style.css 834 bytes {1} [built]
   [61] ./res/app/components/stf/common-ui/index.js 722 bytes {1} [built]
   [62] ./res/app/components/stf/common-ui/safe-apply/index.js 572 bytes {1} [built]
   [63] ./res/app/components/stf/common-ui/clear-button/index.js 121 bytes {1} [built]
   [64] ./res/app/components/stf/common-ui/clear-button/clear-button-directive.js 167 bytes {1} [built]
   [65] ./res/app/components/stf/common-ui/clear-button/clear-button.jade 160 bytes {1} [built]
   [66] ./res/app/components/stf/common-ui/filter-button/index.js 124 bytes {1} [built]
   [67] ./res/app/components/stf/common-ui/filter-button/filter-button-directive.js 193 bytes {1} [built]
   [68] ./res/app/components/stf/common-ui/filter-button/filter-button.jade 236 bytes {1} [built]
   [69] ./res/app/components/stf/common-ui/nothing-to-show/index.js 173 bytes {1} [built]
   [70] ./res/app/components/stf/common-ui/nothing-to-show/nothing-to-show.css 997 bytes {1} [built]
   [71] ./~/css-loader!./res/app/components/stf/common-ui/nothing-to-show/nothing-to-show.css 325 bytes {1} [built]
   [72] ./res/app/components/stf/common-ui/nothing-to-show/nothing-to-show-directive.js 310 bytes {1} [built]
   [73] ./res/app/components/stf/common-ui/nothing-to-show/nothing-to-show.html 177 bytes {1} [built]
   [74] ./res/app/components/stf/common-ui/error-message/index.js 158 bytes {1} [built]
   [75] ./res/app/components/stf/common-ui/error-message/error-message.css 991 bytes {1} [built]
   [76] ./~/css-loader!./res/app/components/stf/common-ui/error-message/error-message.css 221 bytes {1} [built]
   [77] ./res/app/components/stf/common-ui/error-message/error-message-directive.js 303 bytes {1} [built]
   [78] ./res/app/components/stf/common-ui/error-message/error-message.jade 217 bytes {1} [built]
   [79] ./res/app/components/stf/common-ui/table/index.js 137 bytes {1} [built]
   [80] ./res/app/components/stf/common-ui/table/table.css 967 bytes {1} [built]
   [81] ./~/css-loader!./res/app/components/stf/common-ui/table/table.css 3.64 kB {1} [built]
   [82] ./~/script-loader!./res/bower_components/ng-table/dist/ng-table.js 179 bytes {1} [built]
   [83] ./~/raw-loader!./res/bower_components/ng-table/dist/ng-table.js 95.8 kB {1} [built]
   [84] ./res/app/components/stf/common-ui/notifications/index.js 177 bytes {1} [built]
   [85] ./res/bower_components/angular-animate/angular-animate.js 151 kB {1} [built]
   [86] ./res/app/components/stf/common-ui/notifications/growl.css 967 bytes {1} [built]
   [87] ./~/css-loader!./res/app/components/stf/common-ui/notifications/growl.css 631 bytes {1} [built]
   [88] ./res/web_modules/angular-growl/index.js 175 bytes {1} [built]
   [89] ./res/bower_components/angular-growl-v2/build/angular-growl.js 15.3 kB {1} [built]
   [90] ./res/app/components/stf/common-ui/ng-enter/index.js 111 bytes {1} [built]
   [91] ./res/app/components/stf/common-ui/ng-enter/ng-enter-directive.js 327 bytes {1} [built]
   [92] ./res/app/components/stf/common-ui/tooltips/index.js 112 bytes {1} [built]
   [93] ./res/app/components/stf/common-ui/tooltips/tooltips-directive.js 113 bytes {1} [built]
   [94] ./res/app/components/stf/common-ui/modals/index.js 201 bytes {1} [built]
   [95] ./res/app/components/stf/common-ui/modals/fatal-message/index.js 213 bytes {1} [built]
   [96] ./res/app/components/stf/common-ui/modals/common/index.js 114 bytes {1} [built]
   [97] ./res/app/components/stf/common-ui/modals/common/modals.css 982 bytes {1} [built]
   [98] ./~/css-loader!./res/app/components/stf/common-ui/modals/common/modals.css 1.44 kB {1} [built]
   [99] ./res/app/components/stf/common-ui/modals/fatal-message/fatal-message-service.js 1.95 kB {1} [built]
  [100] ./res/app/components/stf/common-ui/modals/fatal-message/fatal-message.jade 1.22 kB {1} [built]
  [101] ./res/app/components/stf/common-ui/modals/socket-disconnected/index.js 192 bytes {1} [built]
  [102] ./res/app/components/stf/common-ui/modals/socket-disconnected/socket-disconnected-service.js 824 bytes {1} [built]
  [103] ./res/app/components/stf/common-ui/modals/socket-disconnected/socket-disconnected.jade 701 bytes {1} [built]
  [104] ./res/app/components/stf/common-ui/modals/version-update/index.js 217 bytes {1} [built]
  [105] ./res/app/components/stf/common-ui/modals/version-update/version-update-service.js 608 bytes {1} [built]
  [106] ./res/app/components/stf/common-ui/modals/version-update/version-update.jade 617 bytes {1} [built]
  [107] ./res/app/components/stf/common-ui/modals/add-adb-key-modal/index.js 184 bytes {1} [built]
  [108] ./res/app/components/stf/common-ui/modals/add-adb-key-modal/add-adb-key-modal-service.js 958 bytes {1} [built]
  [109] ./res/app/components/stf/common-ui/modals/add-adb-key-modal/add-adb-key-modal.jade 1.24 kB {1} [built]
  [110] ./res/app/components/stf/common-ui/include-cached/index.js 201 bytes {1} [built]
  [111] ./res/app/components/stf/common-ui/include-cached/compile-cache-service.js 513 bytes {1} [built]
  [112] ./res/app/components/stf/common-ui/include-cached/include-cached-directive.js 469 bytes {1} [built]
  [113] ./res/app/components/stf/common-ui/text-focus-select/index.js 137 bytes {1} [built]
  [114] ./res/app/components/stf/common-ui/text-focus-select/text-focus-select-directive.js 243 bytes {1} [built]
  [115] ./res/app/components/stf/common-ui/counter/index.js 111 bytes {1} [built]
  [116] ./res/app/components/stf/common-ui/counter/counter-directive.js 1.43 kB {1} [built]
  [117] ./res/app/components/stf/common-ui/badge-icon/index.js 146 bytes {1} [built]
  [118] ./res/app/components/stf/common-ui/badge-icon/badge-icon.css 982 bytes {1} [built]
  [119] ./~/css-loader!./res/app/components/stf/common-ui/badge-icon/badge-icon.css 262 bytes {1} [built]
  [120] ./res/app/components/stf/common-ui/badge-icon/badge-icon-directive.js 198 bytes {1} [built]
  [121] ./res/app/components/stf/common-ui/badge-icon/badge-icon.jade 175 bytes {1} [built]
  [122] ./res/app/components/stf/common-ui/enable-autofill/index.js 173 bytes {1} [built]
  [123] ./res/bower_components/angular-cookies/angular-cookies.js 9.81 kB {1} [built]
  [124] ./res/app/components/stf/common-ui/enable-autofill/enable-autofill-directive.js 1.77 kB {1} [built]
  [125] ./res/app/components/stf/common-ui/icon-inside-input/index.js 137 bytes {1} [built]
  [126] ./res/app/components/stf/common-ui/icon-inside-input/icon-inside-input-directive.js 513 bytes {1} [built]
  [127] ./res/app/components/stf/common-ui/focus-element/index.js 126 bytes {1} [built]
  [128] ./res/app/components/stf/common-ui/focus-element/focus-element-directive.js 517 bytes {1} [built]
  [129] ./res/app/components/stf/common-ui/blur-element/index.js 123 bytes {1} [built]
  [130] ./res/app/components/stf/common-ui/blur-element/blur-element-directive.js 465 bytes {1} [built]
  [131] ./res/app/components/stf/common-ui/stacked-icon/index.js 121 bytes {1} [built]
  [132] ./res/app/components/stf/common-ui/stacked-icon/stacked-icon-directive.js 237 bytes {1} [built]
  [133] ./res/app/components/stf/common-ui/stacked-icon/stacked-icon.css 988 bytes {1} [built]
  [134] ./~/css-loader!./res/app/components/stf/common-ui/stacked-icon/stacked-icon.css 399 bytes {1} [built]
  [135] ./res/app/components/stf/common-ui/stacked-icon/stacked-icon.jade 197 bytes {1} [built]
  [136] ./res/app/components/stf/common-ui/help-icon/index.js 112 bytes {1} [built]
  [137] ./res/app/components/stf/common-ui/help-icon/help-icon-directive.js 206 bytes {1} [built]
  [138] ./res/app/components/stf/common-ui/help-icon/help-icon.jade 222 bytes {1} [built]
  [139] ./res/app/components/stf/socket/socket-state/index.js 873 bytes {1} [built]
  [140] ./res/app/components/stf/socket/index.js 242 bytes {1} [built]
  [141] ./res/app/components/stf/app-state/index.js 114 bytes {1} [built]
  [142] ./res/app/components/stf/app-state/app-state-provider.js 437 bytes {1} [built]
  [143] ./res/app/components/stf/socket/socket-service.js 900 bytes {1} [built]
  [144] ./~/socket.io-client/lib/index.js 1.66 kB {1} [built]
  [145] ./~/socket.io-client/lib/url.js 1.61 kB {1} [built]
  [146] ./~/socket.io-client/~/parseuri/index.js 1.19 kB {1} [built]
  [147] ./~/debug/browser.js 3.76 kB {1} [built]
  [148] ./~/debug/debug.js 4.1 kB {1} [built]
  [149] ./~/debug/~/ms/index.js 2.33 kB {1} [built]
  [150] ./~/socket.io-client/~/socket.io-parser/index.js 7.63 kB {1} [built]
  [151] ./~/socket.io-client/~/socket.io-parser/~/json3/lib/json3.js 43.3 kB {1} [built]
  [152](webpack)/buildin/module.js 251 bytes {1} [built]
  [153](webpack)/buildin/amd-options.js 43 bytes {1} [built]
  [154] ./~/socket.io-client/~/socket.io-parser/~/isarray/index.js 120 bytes {1} [built]
  [155] ./~/socket.io-client/~/socket.io-parser/~/component-emitter/index.js 3 kB {1} [built]
  [156] ./~/socket.io-client/~/socket.io-parser/binary.js 3.84 kB {1} [built]
  [157] ./~/socket.io-client/~/socket.io-parser/is-buffer.js 252 bytes {1} [built]
  [158] ./~/socket.io-client/lib/manager.js 12 kB {1} [built]
  [159] ./~/socket.io-client/~/engine.io-client/index.js 38 bytes {1} [built]
  [160] ./~/socket.io-client/~/engine.io-client/lib/index.js 140 bytes {1} [built]
  [161] ./~/socket.io-client/~/engine.io-client/lib/socket.js 17.6 kB {1} [built]
  [162] ./~/socket.io-client/~/engine.io-client/lib/transports/index.js 1.08 kB {1} [built]
  [163] ./~/socket.io-client/~/engine.io-client/lib/xmlhttprequest.js 1.16 kB {1} [built]
  [164] ./~/socket.io-client/~/engine.io-client/~/has-cors/index.js 396 bytes {1} [built]
  [165] ./~/socket.io-client/~/engine.io-client/lib/transports/polling-xhr.js 8.81 kB {1} [built]
  [166] ./~/socket.io-client/~/engine.io-client/lib/transports/polling.js 4.93 kB {1} [built]
  [167] ./~/socket.io-client/~/engine.io-client/lib/transport.js 2.7 kB {1} [built]
  [168] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/lib/browser.js 14.4 kB {1} [built]
  [169] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/lib/keys.js 297 bytes {1} [built]
  [170] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/~/has-binary/index.js 1.08 kB {1} [built]
  [171] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/~/has-binary/~/isarray/index.js 120 bytes {1} [built]
  [172] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/~/arraybuffer.slice/index.js 725 bytes {1} [built]
  [173] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/~/base64-arraybuffer/lib/base64-arraybuffer.js 1.7 kB {1} [built]
  [174] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/~/after/index.js 685 bytes {1} [built]
  [175] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/~/utf8/utf8.js 6.38 kB {1} [built]
  [176] ./~/socket.io-client/~/engine.io-client/~/engine.io-parser/~/blob/index.js 2.2 kB {1} [built]
  [177] ./~/socket.io-client/~/engine.io-client/~/component-emitter/index.js 3 kB {1} [built]
  [178] ./~/socket.io-client/~/engine.io-client/~/parseqs/index.js 708 bytes {1} [built]
  [179] ./~/socket.io-client/~/engine.io-client/~/component-inherit/index.js 146 bytes {1} [built]
  [180] ./~/socket.io-client/~/engine.io-client/~/yeast/index.js 1.35 kB {1} [built]
  [181] ./~/socket.io-client/~/engine.io-client/lib/transports/polling-jsonp.js 4.92 kB {1} [built]
  [182] ./~/socket.io-client/~/engine.io-client/lib/transports/websocket.js 6.05 kB {1} [built]
  [183] ws (ignored) 15 bytes {1} [optional]
  [184] ./~/socket.io-client/~/indexof/index.js 199 bytes {1} [built]
  [185] ./~/socket.io-client/~/engine.io-client/~/parsejson/index.js 842 bytes {1} [built]
  [186] ./~/socket.io-client/lib/socket.js 7.54 kB {1} [built]
  [187] ./~/socket.io-client/~/component-emitter/index.js 2.98 kB {1} [built]
  [188] ./~/socket.io-client/~/to-array/index.js 216 bytes {1} [built]
  [189] ./~/socket.io-client/lib/on.js 370 bytes {1} [built]
  [190] ./~/socket.io-client/~/component-bind/index.js 474 bytes {1} [built]
  [191] ./~/socket.io-client/~/has-binary/index.js 1.21 kB {1} [built]
  [192] ./~/socket.io-client/~/has-binary/~/isarray/index.js 120 bytes {1} [built]
  [193] ./~/socket.io-client/~/backo2/index.js 1.4 kB {1} [built]
  [194] ./res/app/components/stf/common-ui/refresh-page/index.js 121 bytes {1} [built]
  [195] ./res/app/components/stf/common-ui/refresh-page/refresh-page-directive.js 295 bytes {1} [built]
  [196] ./res/app/components/stf/common-ui/refresh-page/refresh-page.jade 180 bytes {1} [built]
  [197] ./res/app/components/stf/socket/socket-state/socket-state-directive.js 2.83 kB {1} [built]
  [198] ./res/app/components/stf/socket/socket-state/socket-state.jade 19 bytes {1} [built]
  [199] ./res/app/layout/layout-controller.js 570 bytes {1} [built]
  [200] ./res/app/device-list/index.js 859 bytes {1} [built]
  [201] ./res/app/device-list/device-list.css 949 bytes {1} [built]
  [202] ./~/css-loader!./res/app/device-list/device-list.css 1.72 kB {1} [built]
  [203] ./res/web_modules/angular-xeditable/index.js 167 bytes {1} [built]
  [204] ./res/bower_components/angular-xeditable/dist/js/xeditable.js 72.8 kB {1} [built]
  [205] ./res/bower_components/angular-xeditable/dist/css/xeditable.css 967 bytes {1} [built]
  [206] ./~/css-loader!./res/bower_components/angular-xeditable/dist/css/xeditable.css 2.44 kB {1} [built]
  [207] ./res/web_modules/angular-xeditable/style.css 931 bytes {1} [built]
  [208] ./~/css-loader!./res/web_modules/angular-xeditable/style.css 1.21 kB {1} [built]
  [209] ./res/app/components/stf/device/index.js 253 bytes {1} [built]
  [210] ./res/app/components/stf/device/device-info-filter/index.js 3.7 kB {1} [built]
  [211] ./res/app/components/stf/device/enhance-device/index.js 170 bytes {1} [built]
  [212] ./res/app/components/stf/device/enhance-device/enhance-device-service.js 2.9 kB {1} [built]
  [213] ./res/app/components/stf/device/device-service.js 5.29 kB {1} [built]
  [214] ./res/bower_components/oboe/dist/oboe-browser.js 82.6 kB {1} [built]
  [215] ./res/bower_components/lodash/lodash.js 411 kB {1} [built]
  [216] ./~/eventemitter3/index.js 6.08 kB {1} [built]
  [217] ./res/app/components/stf/device/state-classes-service.js 1.16 kB {1} [built]
  [218] ./res/app/components/stf/user/group/index.js 197 bytes {1} [built]
  [219] ./res/app/components/stf/user/index.js 134 bytes {1} [built]
  [220] ./res/app/components/stf/user/user-service.js 1.24 kB {1} [built]
  [221] ./res/app/components/stf/transaction/index.js 216 bytes {1} [built]
  [222] ./res/app/components/stf/transaction/transaction-error.js 317 bytes {1} [built]
  [223] ./res/app/components/stf/transaction/transaction-service.js 6.08 kB {1} [built]
  [224] ./~/bluebird/js/browser/bluebird.js 153 kB {1} [built]
  [225](webpack)/~/node-libs-browser/~/process/browser.js 2.12 kB {1} [built]
  [226](webpack)/~/node-libs-browser/~/timers-browserify/main.js 2.1 kB {1} [built]
  [227] ./~/node-uuid/uuid.js 8.08 kB {1} [built]
  [228](webpack)/~/node-libs-browser/~/buffer/index.js 42.8 kB {1} [built]
  [229](webpack)/~/node-libs-browser/~/buffer/~/base64-js/lib/b64.js 3.57 kB {1} [built]
  [230](webpack)/~/node-libs-browser/~/buffer/~/ieee754/index.js 2.05 kB {1} [built]
  [231](webpack)/~/node-libs-browser/~/buffer/~/isarray/index.js 132 bytes {1} [built]
  [232] ./res/app/components/stf/user/group/group-service.js 1.36 kB {1} [built]
  [233] ./res/app/components/stf/control/index.js 207 bytes {1} [built]
  [234] ./res/app/components/stf/keycodes/index.js 422 bytes {1} [built]
  [235] ./res/app/components/stf/keycodes/mapped/index.json 500 bytes {1} [built]
  [236] ./res/app/components/stf/control/control-service.js 6.63 kB {1} [built]
  [237] ./res/app/components/stf/settings/index.js 171 bytes {1} [built]
  [238] ./res/app/components/stf/settings/settings-service.js 2.84 kB {1} [built]
  [239] ./res/app/device-list/column/index.js 159 bytes {1} [built]
  [240] ./res/app/device-list/column/device-column-service.js 17.8 kB {1} [built]
  [241] ./res/app/device-list/details/index.js 367 bytes {1} [built]
  [242] ./res/app/device-list/details/device-list-details.css 985 bytes {1} [built]
  [243] ./~/css-loader!./res/app/device-list/details/device-list-details.css 560 bytes {1} [built]
  [244] ./res/app/components/stf/admin-mode/index.js 117 bytes {1} [built]
  [245] ./res/app/components/stf/admin-mode/admin-mode-directive.js 249 bytes {1} [built]
  [246] ./res/app/device-list/empty/index.js 136 bytes {1} [built]
  [247] ./res/app/device-list/empty/device-list-empty-directive.js 847 bytes {1} [built]
  [248] ./res/app/device-list/empty/device-list-empty.jade 151 bytes {1} [built]
  [249] ./res/app/device-list/details/device-list-details-directive.js 16.9 kB {1} [built]
  [250] ./res/app/device-list/util/patch-array/index.js 1.62 kB {1} [built]
  [251] ./res/app/device-list/details/device-list-details.jade 489 bytes {1} [built]
  [252] ./res/app/device-list/icons/index.js 356 bytes {1} [built]
  [253] ./res/app/device-list/icons/device-list-icons.css 979 bytes {1} [built]
  [254] ./~/css-loader!./res/app/device-list/icons/device-list-icons.css 1.97 kB {1} [built]
  [255] ./res/app/components/stf/standalone/index.js 632 bytes {1} [built]
  [256] ./res/app/components/stf/standalone/standalone.css 970 bytes {1} [built]
  [257] ./~/css-loader!./res/app/components/stf/standalone/standalone.css 168 bytes {1} [built]
  [258] ./res/app/components/stf/screen/index.js 394 bytes {1} [built]
  [259] ./res/app/components/stf/screen/screen.css 958 bytes {1} [built]
  [260] ./~/css-loader!./res/app/components/stf/screen/screen.css 616 bytes {1} [built]
  [261] ./res/app/components/stf/screen/scaling/index.js 110 bytes {1} [built]
  [262] ./res/app/components/stf/screen/scaling/scaling-service.js 5.4 kB {1} [built]
  [263] ./res/app/components/stf/util/vendor/index.js 106 bytes {1} [built]
  [264] ./res/app/components/stf/util/vendor/vendor-util.js 354 bytes {1} [built]
  [265] ./res/app/components/stf/page-visibility/index.js 135 bytes {1} [built]
  [266] ./res/app/components/stf/page-visibility/page-visibility-service.js 369 bytes {1} [built]
  [267] ./res/app/components/stf/screen/screen-directive.js 29.4 kB {1} [built]
  [268] ./res/app/components/stf/screen/rotator.js 490 bytes {1} [built]
  [269] ./res/app/components/stf/screen/imagepool.js 470 bytes {1} [built]
  [270] ./res/app/components/stf/screen/screen.jade 1.11 kB {1} [built]
  [271] ./res/app/components/stf/screen/screen-controller.js 286 bytes {1} [built]
  [272] ./res/app/components/stf/standalone/standalone.jade 19 bytes {1} [built]
  [273] ./res/app/components/stf/standalone/standalone-controller.js 48 bytes {1} [built]
  [274] ./res/app/components/stf/standalone/standalone-service.js 3.34 kB {1} [built]
  [275] ./res/app/components/stf/standalone/standalone-directive.js 290 bytes {1} [built]
  [276] ./res/app/device-list/icons/device-list-icons-directive.js 15.9 kB {1} [built]
  [277] ./res/app/device-list/icons/device-list-icons.jade 174 bytes {1} [built]
  [278] ./res/app/device-list/stats/index.js 199 bytes {1} [built]
  [279] ./res/app/device-list/stats/device-list-stats.css 979 bytes {1} [built]
  [280] ./~/css-loader!./res/app/device-list/stats/device-list-stats.css 1.75 kB {1} [built]
  [281] ./res/app/device-list/stats/device-list-stats-directive.js 2.71 kB {1} [built]
  [282] ./res/app/device-list/stats/device-list-stats.jade 1.08 kB {1} [built]
  [283] ./res/app/device-list/customize/index.js 106 bytes {1} [built]
  [284] ./res/app/device-list/customize/device-list-customize.css 991 bytes {1} [built]
  [285] ./~/css-loader!./res/app/device-list/customize/device-list-customize.css 535 bytes {1} [built]
  [286] ./res/app/device-list/search/index.js 100 bytes {1} [built]
  [287] ./res/app/device-list/search/device-list-search.css 982 bytes {1} [built]
  [288] ./~/css-loader!./res/app/device-list/search/device-list-search.css 324 bytes {1} [built]
  [289] ./res/app/device-list/device-list.jade 2.98 kB {1} [built]
  [290] ./res/app/device-list/device-list-controller.js 3.1 kB {1} [built]
  [291] ./res/app/device-list/util/query-parser/index.js 2.95 kB {1} [built]
  [292] ./res/app/control-panes/index.js 1.56 kB {1} [built]
  [293] ./res/app/components/stf/common-ui/nice-tabs/index.js 171 bytes {1} [built]
  [294] ./res/app/components/stf/common-ui/nice-tabs/nice-tab-directive.js 235 bytes {1} [built]
  [295] ./res/app/components/stf/common-ui/nice-tabs/nice-tab.jade 19 bytes {1} [built]
  [296] ./res/app/components/stf/common-ui/nice-tabs/nice-tabs-directive.js 808 bytes {1} [built]
  [297] ./res/app/components/stf/common-ui/nice-tabs/nice-tabs.jade 371 bytes {1} [built]
  [298] ./res/app/components/stf/scoped-hotkeys/index.js 174 bytes {1} [built]
  [299] ./res/app/components/stf/scoped-hotkeys/scoped-hotkeys-service.js 766 bytes {1} [built]
  [300] ./res/app/control-panes/device-control/index.js 728 bytes {1} [built]
  [301] ./res/app/control-panes/device-control/device-control.css 970 bytes {1} [built]
  [302] ./~/css-loader!./res/app/control-panes/device-control/device-control.css 5.47 kB {1} [built]
  [303] ./res/web_modules/ng-context-menu/index.js 126 bytes {1} [built]
  [304] ./res/bower_components/ng-context-menu/dist/ng-context-menu.js 6.41 kB {1} [built]
  [305] ./res/web_modules/ng-context-menu/context-menu.css 952 bytes {1} [built]
  [306] ./~/css-loader!./res/web_modules/ng-context-menu/context-menu.css 220 bytes {1} [built]
  [307] ./res/app/components/stf/device-context-menu/index.js 214 bytes {1} [built]
  [308] ./res/app/components/stf/device-context-menu/device-context-menu.css 997 bytes {1} [built]
  [309] ./~/css-loader!./res/app/components/stf/device-context-menu/device-context-menu.css 199 bytes {1} [built]
  [310] ./res/app/components/stf/device-context-menu/device-context-menu-directive.js 620 bytes {1} [built]
  [311] ./res/app/components/stf/device-context-menu/device-context-menu.jade 1.56 kB {1} [built]
  [312] ./res/app/control-panes/device-control/device-control.jade 4.13 kB {1} [built]
  [313] ./res/app/control-panes/device-control/device-control-standalone.jade 544 bytes {1} [built]
  [314] ./res/app/control-panes/device-control/device-control-controller.js 3.39 kB {1} [built]
  [315] ./res/app/control-panes/device-control/device-control-key-directive.js 1.09 kB {1} [built]
  [316] ./res/app/control-panes/advanced/index.js 485 bytes {1} [built]
  [317] ./res/app/control-panes/advanced/advanced.css 952 bytes {1} [built]
  [318] ./~/css-loader!./res/app/control-panes/advanced/advanced.css 185 bytes {1} [built]
  [319] ./res/app/control-panes/advanced/input/index.js 310 bytes {1} [built]
  [320] ./res/app/control-panes/advanced/input/input.css 955 bytes {1} [built]
  [321] ./~/css-loader!./res/app/control-panes/advanced/input/input.css 185 bytes {1} [built]
  [322] ./res/app/control-panes/advanced/input/input.jade 3.71 kB {1} [built]
  [323] ./res/app/control-panes/advanced/input/input-controller.js 119 bytes {1} [built]
  [324] ./res/app/control-panes/advanced/port-forwarding/index.js 466 bytes {1} [built]
  [325] ./res/app/control-panes/advanced/port-forwarding/port-forwarding.css 985 bytes {1} [built]
  [326] ./~/css-loader!./res/app/control-panes/advanced/port-forwarding/port-forwarding.css 544 bytes {1} [built]
  [327] ./res/app/control-panes/advanced/port-forwarding/port-forwarding.jade 2.43 kB {1} [built]
  [328] ./res/app/control-panes/advanced/port-forwarding/port-forwarding-controller.js 1.69 kB {1} [built]
  [329] ./res/app/control-panes/advanced/maintenance/index.js 340 bytes {1} [built]
  [330] ./res/app/control-panes/advanced/maintenance/maintenance.jade 481 bytes {1} [built]
  [331] ./res/app/control-panes/advanced/maintenance/maintenance-controller.js 556 bytes {1} [built]
  [332] ./res/app/control-panes/advanced/advanced.jade 587 bytes {1} [built]
  [333] ./res/app/control-panes/advanced/advanced-controller.js 46 bytes {1} [built]
  [334] ./res/app/control-panes/automation/index.js 301 bytes {1} [built]
  [335] ./res/app/control-panes/automation/store-account/index.js 432 bytes {1} [built]
  [336] ./res/app/control-panes/automation/store-account/store-account.css 979 bytes {1} [built]
  [337] ./~/css-loader!./res/app/control-panes/automation/store-account/store-account.css 270 bytes {1} [built]
  [338] ./res/web_modules/angular-ladda/index.js 158 bytes {1} [built]
  [339] ./res/bower_components/angular-ladda/src/angular-ladda.js 3.21 kB {1} [built]
  [340] ./res/web_modules/ladda/index.js 115 bytes {1} [built]
  [341] ./res/bower_components/ladda/dist/ladda-themeless.min.css 985 bytes {1} [built]
  [342] ./~/css-loader!./res/bower_components/ladda/dist/ladda-themeless.min.css 7.91 kB {1} [built]
  [343] ./res/bower_components/ladda/dist/spin.min.js 4.12 kB {1} [built]
  [344] ./res/bower_components/ladda/dist/ladda.min.js 3.4 kB {1} [built]
  [345] ./res/bower_components/spin.js/spin.js 11.6 kB {1} [built]
  [346] ./res/app/control-panes/automation/store-account/store-account.jade 3.2 kB {1} [built]
  [347] ./res/app/control-panes/automation/store-account/store-account-controller.js 1.51 kB {1} [built]
  [348] ./res/app/control-panes/automation/device-settings/index.js 365 bytes {1} [built]
  [349] ./res/app/control-panes/automation/device-settings/device-settings.css 985 bytes {1} [built]
  [350] ./~/css-loader!./res/app/control-panes/automation/device-settings/device-settings.css 195 bytes {1} [built]
  [351] ./res/app/control-panes/automation/device-settings/device-settings.jade 2.02 kB {1} [built]
  [352] ./res/app/control-panes/automation/device-settings/device-settings-controller.js 940 bytes {1} [built]
  [353] ./res/app/control-panes/automation/automation.jade 300 bytes {1} [built]
  [354] ./res/app/control-panes/performance/index.js 350 bytes {1} [built]
  [355] ./res/app/control-panes/performance/performance.css 961 bytes {1} [built]
  [356] ./~/css-loader!./res/app/control-panes/performance/performance.css 188 bytes {1} [built]
  [357] ./res/app/control-panes/performance/cpu/index.js 306 bytes {1} [built]
  [358] ./res/app/control-panes/performance/cpu/cpu.css 949 bytes {1} [built]
  [359] ./~/css-loader!./res/app/control-panes/performance/cpu/cpu.css 183 bytes {1} [built]
  [360] ./res/web_modules/epoch/index.js 172 bytes {1} [built]
  [361] ./res/bower_components/jquery/dist/jquery.js 248 kB {1} [built]
  [362] ./res/bower_components/d3/d3.js 337 kB {1} [built]
  [363] ./res/bower_components/epoch/dist/css/epoch.min.css 967 bytes {1} [built]
  [364] ./~/css-loader!./res/bower_components/epoch/dist/css/epoch.min.css 58.3 kB {1} [built]
  [365] ./res/bower_components/epoch/dist/js/epoch.min.js 70.5 kB {1} [built]
  [366] ./res/bower_components/ng-epoch/ng-epoch.js 6.13 kB {1} [built]
  [367] ./res/app/control-panes/performance/cpu/cpu.jade 247 bytes {1} [built]
  [368] ./res/app/control-panes/performance/cpu/cpu-controller.js 41 bytes {1} [built]
  [369] ./res/app/control-panes/performance/performance.jade 152 bytes {1} [built]
  [370] ./res/app/control-panes/performance/performance-controller.js 49 bytes {1} [built]
  [371] ./res/app/control-panes/dashboard/index.js 506 bytes {1} [built]
  [372] ./res/app/control-panes/dashboard/navigation/index.js 330 bytes {1} [built]
  [373] ./res/app/control-panes/dashboard/navigation/navigation.css 970 bytes {1} [built]
  [374] ./~/css-loader!./res/app/control-panes/dashboard/navigation/navigation.css 710 bytes {1} [built]
  [375] ./res/app/control-panes/dashboard/navigation/navigation.jade 2.02 kB {1} [built]
  [376] ./res/app/control-panes/dashboard/navigation/navigation-controller.js 2.01 kB {1} [built]
  [377] ./res/app/control-panes/dashboard/navigation/default-favicon.png 82 bytes {1} [built]
  [378] ./res/app/control-panes/dashboard/shell/index.js 353 bytes {1} [built]
  [379] ./res/app/control-panes/dashboard/shell/shell.css 955 bytes {1} [built]
  [380] ./~/css-loader!./res/app/control-panes/dashboard/shell/shell.css 444 bytes {1} [built]
  [381] ./res/app/control-panes/dashboard/shell/shell.jade 1.26 kB {1} [built]
  [382] ./res/app/control-panes/dashboard/shell/shell-controller.js 638 bytes {1} [built]
  [383] ./res/app/control-panes/dashboard/install/index.js 513 bytes {1} [built]
  [384] ./res/app/control-panes/dashboard/install/install.css 961 bytes {1} [built]
  [385] ./~/css-loader!./res/app/control-panes/dashboard/install/install.css 940 bytes {1} [built]
  [386] ./res/web_modules/ng-file-upload/index.js 147 bytes {1} [built]
  [387] ./res/bower_components/ng-file-upload/angular-file-upload-shim.js 12.2 kB {1} [built]
  [388] ./res/bower_components/ng-file-upload/angular-file-upload.js 14.3 kB {1} [built]
  [389] ./res/app/control-panes/dashboard/install/activities/index.js 376 bytes {1} [built]
  [390] ./res/app/control-panes/dashboard/install/activities/activities.css 982 bytes {1} [built]
  [391] ./~/css-loader!./res/app/control-panes/dashboard/install/activities/activities.css 193 bytes {1} [built]
  [392] ./res/app/control-panes/dashboard/install/activities/activities.jade 2.08 kB {1} [built]
  [393] ./res/app/control-panes/dashboard/install/activities/activities-controller.js 2.91 kB {1} [built]
  [394] ./res/app/components/stf/storage/index.js 160 bytes {1} [built]
  [395] ./res/app/components/stf/storage/storage-service.js 1.03 kB {1} [built]
  [396] ./res/app/components/stf/install/index.js 206 bytes {1} [built]
  [397] ./res/app/components/stf/install/install-error-filter.js 6.45 kB {1} [built]
  [398] ./res/app/components/stf/install/install-service.js 3.8 kB {1} [built]
  [399] ./res/app/components/stf/upload/index.js 144 bytes {1} [built]
  [400] ./res/app/components/stf/upload/upload-error-filter.js 373 bytes {1} [built]
  [401] ./res/app/control-panes/dashboard/install/install.jade 3.35 kB {1} [built]
  [402] ./res/app/control-panes/dashboard/install/install-controller.js 846 bytes {1} [built]
  [403] ./res/app/control-panes/dashboard/apps/index.js 319 bytes {1} [built]
  [404] ./res/app/control-panes/dashboard/apps/apps.css 952 bytes {1} [built]
  [405] ./~/css-loader!./res/app/control-panes/dashboard/apps/apps.css 564 bytes {1} [built]
  [406] ./res/app/control-panes/dashboard/apps/apps.jade 1.4 kB {1} [built]
  [407] ./res/app/control-panes/dashboard/apps/apps-controller.js 1.74 kB {1} [built]
  [408] ./res/app/control-panes/dashboard/clipboard/index.js 400 bytes {1} [built]
  [409] ./res/app/control-panes/dashboard/clipboard/clipboard.css 967 bytes {1} [built]
  [410] ./~/css-loader!./res/app/control-panes/dashboard/clipboard/clipboard.css 251 bytes {1} [built]
  [411] ./res/bower_components/angular-elastic/elastic.js 7.96 kB {1} [built]
  [412] ./res/app/control-panes/dashboard/clipboard/clipboard.jade 776 bytes {1} [built]
  [413] ./res/app/control-panes/dashboard/clipboard/clipboard-controller.js 610 bytes {1} [built]
  [414] ./res/app/control-panes/dashboard/remote-debug/index.js 374 bytes {1} [built]
  [415] ./res/app/control-panes/dashboard/remote-debug/remote-debug.css 976 bytes {1} [built]
  [416] ./~/css-loader!./res/app/control-panes/dashboard/remote-debug/remote-debug.css 386 bytes {1} [built]
  [417] ./res/app/control-panes/dashboard/remote-debug/remote-debug.jade 636 bytes {1} [built]
  [418] ./res/app/control-panes/dashboard/remote-debug/remote-debug-controller.js 969 bytes {1} [built]
  [419] ./res/app/control-panes/dashboard/dashboard.jade 828 bytes {1} [built]
  [420] ./res/app/control-panes/dashboard/dashboard-controller.js 47 bytes {1} [built]
  [421] ./res/app/control-panes/logs/index.js 343 bytes {1} [built]
  [422] ./res/app/control-panes/logs/logs.less 1.09 kB {1} [built]
  [423] ./~/css-loader!./~/less-loader!./res/app/control-panes/logs/logs.less 651 bytes {1} [built]
  [424] ./res/app/components/stf/logcat/index.js 174 bytes {1} [built]
  [425] ./res/app/components/stf/filter-string/index.js 129 bytes {1} [built]
  [426] ./res/app/components/stf/filter-string/filter-string-service.js 1.54 kB {1} [built]
  [427] ./res/app/components/stf/logcat/logcat-service.js 3.47 kB {1} [built]
  [428] ./res/bower_components/underscore.string/index.js 4.54 kB {1} [built]
  [429] ./res/bower_components/underscore.string/isBlank.js 136 bytes {1} [built]
  [430] ./res/bower_components/underscore.string/helper/makeString.js 161 bytes {1} [built]
  [431] ./res/bower_components/underscore.string/stripTags.js 149 bytes {1} [built]
  [432] ./res/bower_components/underscore.string/capitalize.js 276 bytes {1} [built]
  [433] ./res/bower_components/underscore.string/decapitalize.js 177 bytes {1} [built]
  [434] ./res/bower_components/underscore.string/chop.js 192 bytes {1} [built]
  [435] ./res/bower_components/underscore.string/trim.js 433 bytes {1} [built]
  [436] ./res/bower_components/underscore.string/helper/defaultToWhiteSpace.js 270 bytes {1} [built]
  [437] ./res/bower_components/underscore.string/helper/escapeRegExp.js 164 bytes {1} [built]
  [438] ./res/bower_components/underscore.string/clean.js 116 bytes {1} [built]
  [439] ./res/bower_components/underscore.string/cleanDiacritics.js 537 bytes {1} [built]
  [440] ./res/bower_components/underscore.string/count.js 250 bytes {1} [built]
  [441] ./res/bower_components/underscore.string/chars.js 128 bytes {1} [built]
  [442] ./res/bower_components/underscore.string/swapCase.js 225 bytes {1} [built]
  [443] ./res/bower_components/underscore.string/escapeHTML.js 390 bytes {1} [built]
  [444] ./res/bower_components/underscore.string/helper/escapeChars.js 433 bytes {1} [built]
  [445] ./res/bower_components/underscore.string/unescapeHTML.js 659 bytes {1} [built]
  [446] ./res/bower_components/underscore.string/helper/htmlEntities.js 296 bytes {1} [built]
  [447] ./res/bower_components/underscore.string/splice.js 181 bytes {1} [built]
  [448] ./res/bower_components/underscore.string/insert.js 125 bytes {1} [built]
  [449] ./res/bower_components/underscore.string/replaceAll.js 256 bytes {1} [built]
  [450] ./res/bower_components/underscore.string/include.js 185 bytes {1} [built]
  [451] ./res/bower_components/underscore.string/join.js 220 bytes {1} [built]
  [452] ./res/bower_components/underscore.string/lines.js 112 bytes {1} [built]
  [453] ./res/bower_components/underscore.string/dedent.js 610 bytes {1} [built]
  [454] ./res/bower_components/underscore.string/reverse.js 117 bytes {1} [built]
  [455] ./res/bower_components/undeINF/webpack:config 62 [_] Build progress 100% (complete)
rscore.string/startsWith.js 350 bytes {1} [built]
  [456] ./res/bower_components/underscore.string/helper/toPositive.js 92 bytes {1} [built]
  [457] ./res/bower_components/underscore.string/endsWith.js 442 bytes {1} [built]
  [458] ./res/bower_components/underscore.string/pred.js 115 bytes {1} [built]
  [459] ./res/bower_components/underscore.string/helper/adjacent.js 262 bytes {1} [built]
  [460] ./res/bower_components/underscore.string/succ.js 114 bytes {1} [built]
  [461] ./res/bower_components/underscore.string/titleize.js 207 bytes {1} [built]
  [462] ./res/bower_components/underscore.string/camelize.js 321 bytes {1} [built]
  [463] ./res/bower_components/underscore.string/underscored.js 176 bytes {1} [built]
  [464] ./res/bower_components/underscore.string/dasherize.js 163 bytes {1} [built]
  [465] ./res/bower_components/underscore.string/classify.js 278 bytes {1} [built]
  [466] ./res/bower_components/underscore.string/humanize.js 246 bytes {1} [built]
  [467] ./res/bower_components/underscore.string/ltrim.js 424 bytes {1} [built]
  [468] ./res/bower_components/underscore.string/rtrim.js 423 bytes {1} [built]
  [469] ./res/bower_components/underscore.string/truncate.js 273 bytes {1} [built]
  [470] ./res/bower_components/underscore.string/prune.js 904 bytes {1} [built]
  [471] ./res/bower_components/underscore.string/words.js 208 bytes {1} [built]
  [472] ./res/bower_components/underscore.string/pad.js 705 bytes {1} [built]
  [473] ./res/bower_components/underscore.string/helper/strRepeat.js 195 bytes {1} [built]
  [474] ./res/bower_components/underscore.string/lpad.js 121 bytes {1} [built]
  [475] ./res/bower_components/underscore.string/rpad.js 130 bytes {1} [built]
  [476] ./res/bower_components/underscore.string/lrpad.js 130 bytes {1} [built]
  [477] ./res/bower_components/underscore.string/sprintf.js 4.79 kB {1} [built]
  [478] ./res/bower_components/underscore.string/vsprintf.js 145 bytes {1} [built]
  [479] ./res/bower_components/underscore.string/toNumber.js 195 bytes {1} [built]
  [480] ./res/bower_components/underscore.string/numberFormat.js 387 bytes {1} [built]
  [481] ./res/bower_components/underscore.string/strRight.js 255 bytes {1} [built]
  [482] ./res/bower_components/underscore.string/strRightBack.js 263 bytes {1} [built]
  [483] ./res/bower_components/underscore.string/strLeft.js 232 bytes {1} [built]
  [484] ./res/bower_components/underscore.string/strLeftBack.js 228 bytes {1} [built]
  [485] ./res/bower_components/underscore.string/toSentence.js 411 bytes {1} [built]
  [486] ./res/bower_components/underscore.string/toSentenceSerial.js 160 bytes {1} [built]
  [487] ./res/bower_components/underscore.string/slugify.js 260 bytes {1} [built]
  [488] ./res/bower_components/underscore.string/surround.js 97 bytes {1} [built]
  [489] ./res/bower_components/underscore.string/quote.js 134 bytes {1} [built]
  [490] ./res/bower_components/underscore.string/unquote.js 212 bytes {1} [built]
  [491] ./res/bower_components/underscore.string/repeat.js 480 bytes {1} [built]
  [492] ./res/bower_components/underscore.string/naturalCmp.js 701 bytes {1} [built]
  [493] ./res/bower_components/underscore.string/levenshtein.js 1.29 kB {1} [built]
  [494] ./res/bower_components/underscore.string/toBoolean.js 668 bytes {1} [built]
  [495] ./res/bower_components/underscore.string/exports.js 236 bytes {1} [built]
  [496] ./res/bower_components/underscore.string/wrap.js 2.24 kB {1} [built]
  [497] ./res/bower_components/underscore.string/map.js 231 bytes {1} [built]
  [498] ./res/app/components/stf/logcat-table/index.js 154 bytes {1} [built]
  [499] ./res/app/components/stf/logcat-table/logcat-table.css 976 bytes {1} [built]
  [500] ./~/css-loader!./res/app/components/stf/logcat-table/logcat-table.css 1.47 kB {1} [built]
  [501] ./res/app/components/stf/logcat-table/logcat-table-directive.js 3.73 kB {1} [built]
  [502] ./res/app/components/stf/logcat-table/logcat-table.jade 162 bytes {1} [built]
  [503] ./res/app/control-panes/logs/logs.jade 1.98 kB {1} [built]
  [504] ./res/app/control-panes/logs/logs-controller.js 1.12 kB {1} [built]
  [505] ./res/app/control-panes/screenshots/index.js 393 bytes {1} [built]
  [506] ./res/app/control-panes/screenshots/screenshots.css 961 bytes {1} [built]
  [507] ./~/css-loader!./res/app/control-panes/screenshots/screenshots.css 572 bytes {1} [built]
  [508] ./res/app/components/stf/image-onload/index.js 203 bytes {1} [built]
  [509] ./res/app/components/stf/image-onload/image-onload-directive.js 266 bytes {1} [built]
  [510] ./res/app/components/stf/image-onload/image-onload-animate-directive.js 432 bytes {1} [built]
  [511] ./res/app/control-panes/screenshots/screenshots.jade 2.08 kB {1} [built]
  [512] ./res/app/control-panes/screenshots/screenshots-controller.js 910 bytes {1} [built]
  [513] ./res/app/control-panes/explorer/index.js 1.74 kB {1} [built]
  [514] ./res/app/control-panes/explorer/explorer.css 952 bytes {1} [built]
  [515] ./~/css-loader!./res/app/control-panes/explorer/explorer.css 165 bytes {1} [built]
  [516] ./res/app/control-panes/explorer/explorer.jade 1.79 kB {1} [built]
  [517] ./res/app/control-panes/explorer/explorer-controller.js 1.59 kB {1} [built]
  [518] ./res/app/control-panes/info/index.js 370 bytes {1} [built]
  [519] ./res/app/control-panes/info/info.css 940 bytes {1} [built]
  [520] ./~/css-loader!./res/app/control-panes/info/info.css 708 bytes {1} [built]
  [521] ./res/app/components/stf/angular-packery/index.js 413 bytes {1} [built]
  [522] ./res/app/components/stf/angular-packery/angular-packery.css 985 bytes {1} [built]
  [523] ./~/css-loader!./res/app/components/stf/angular-packery/angular-packery.css 822 bytes {1} [built]
  [524] ./res/bower_components/packery/js/rect.js 3.4 kB {1} [built]
  [525] ./res/bower_components/packery/js/packer.js 4.19 kB {1} [built]
  [526] ./res/bower_components/packery/js/item.js 4.93 kB {1} [built]
  [527] ./res/bower_components/get-style-property/get-style-property.js 1.24 kB {1} [built]
  [528] ./res/bower_components/outlayer/outlayer.js 22.4 kB {1} [built]
  [529] ./res/bower_components/eventie/eventie.js 1.79 kB {1} [built]
  [530] ./res/bower_components/eventEmitter/EventEmitter.js 18.4 kB {1} [built]
  [531] ./res/bower_components/get-size/get-size.js 6.49 kB {1} [built]
  [532] ./res/bower_components/fizzy-ui-utils/utils.js 6.72 kB {1} [built]
  [533] ./res/bower_components/doc-ready/doc-ready.js 1.78 kB {1} [built]
  [534] ./res/bower_components/matches-selector/matches-selector.js 2.55 kB {1} [built]
  [535] ./res/bower_components/outlayer/item.js 15.7 kB {1} [built]
  [536] ./res/bower_components/packery/js/packery.js 12.8 kB {1} [built]
  [537] ./res/bower_components/classie/classie.js 1.97 kB {1} [built]
  [538] ./res/app/components/stf/angular-draggabilly/index.js 260 bytes {1} [built]
  [539] ./res/bower_components/draggabilly/draggabilly.js 13.4 kB {1} [built]
  [540] ./res/bower_components/unidragger/unidragger.js 9.59 kB {1} [built]
  [541] ./res/bower_components/unipointer/unipointer.js 8.09 kB {1} [built]
  [542] ./res/app/components/stf/angular-draggabilly/angular-draggabilly-directive.js 500 bytes {1} [built]
  [543] ./res/app/components/stf/angular-packery/angular-packery-directive.js 1.76 kB {1} [built]
  [544] ./res/app/components/stf/common-ui/modals/lightbox-image/index.js 210 bytes {1} [built]
  [545] ./res/app/components/stf/common-ui/modals/lightbox-image/lightbox-image.css 1.01 kB {1} [built]
  [546] ./~/css-loader!./res/app/components/stf/common-ui/modals/lightbox-image/lightbox-image.css 259 bytes {1} [built]
  [547] ./res/app/components/stf/common-ui/modals/lightbox-image/lightbox-image-service.js 835 bytes {1} [built]
  [548] ./res/app/components/stf/common-ui/modals/lightbox-image/lightbox-image.jade 487 bytes {1} [built]
  [549] ./res/app/control-panes/info/info.jade 8.16 kB {1} [built]
  [550] ./res/app/control-panes/info/info-controller.js 546 bytes {1} [built]
  [551] ./res/app/control-panes/control-panes.jade 1.33 kB {1} [built]
  [552] ./res/app/control-panes/control-panes-service.js 124 bytes {1} [built]
  [553] ./res/app/control-panes/control-panes-controller.js 2.69 kB {1} [built]
  [554] ./res/app/control-panes/control-panes-no-device-controller.js 279 bytes {1} [built]
  [555] ./res/app/control-panes/control-panes-hotkeys-controller.js 3.37 kB {1} [built]
  [556] ./res/app/menu/index.js 403 bytes {1} [built]
  [557] ./res/app/menu/menu.css 928 bytes {1} [built]
  [558] ./~/css-loader!./res/app/menu/menu.css 1.47 kB {1} [built]
  [559] ./res/common/logo/exports/STF-512.png 82 bytes {1} [built]
  [560] ./res/app/components/stf/nav-menu/index.js 109 bytes {1} [built]
  [561] ./res/app/components/stf/nav-menu/nav-menu-directive.js 1.46 kB {1} [built]
  [562] ./res/app/components/stf/common-ui/modals/external-url-modal/index.js 291 bytes {1} [built]
  [563] ./res/app/components/stf/common-ui/modals/external-url-modal/external-url-modal.css 1.02 kB {1} [built]
  [564] ./~/css-loader!./res/app/components/stf/common-ui/modals/external-url-modal/external-url-modal.css 206 bytes {1} [built]
  [565] ./res/app/components/stf/common-ui/modals/external-url-modal/external-url-modal-service.js 936 bytes {1} [built]
  [566] ./res/app/components/stf/common-ui/modals/external-url-modal/external-url-modal.jade 426 bytes {1} [built]
  [567] ./res/app/components/stf/common-ui/modals/external-url-modal/on-load-event-directive.js 240 bytes {1} [built]
  [568] ./res/app/components/stf/native-url/index.js 120 bytes {1} [built]
  [569] ./res/app/components/stf/native-url/native-url-service.js 2.09 kB {1} [built]
  [570] ./res/app/menu/menu-controller.js 378 bytes {1} [built]
  [571] ./res/app/menu/menu.jade 1.46 kB {1} [built]
  [572] ./res/app/settings/index.js 400 bytes {1} [built]
  [573] ./res/app/settings/general/index.js 366 bytes {1} [built]
  [574] ./res/app/settings/general/general.css 949 bytes {1} [built]
  [575] ./~/css-loader!./res/app/settings/general/general.css 184 bytes {1} [built]
  [576] ./res/app/settings/general/language/index.js 348 bytes {1} [built]
  [577] ./res/app/components/stf/language/index.js 261 bytes {1} [built]
  [578] ./res/app/components/stf/language/language-service.js 1.27 kB {1} [built]
  [579] ./res/common/lang/langs.json 188 bytes {1} [built]
  [580] ./res/app/components/stf/language/language-provider.js 1.81 kB {1} [built]
  [581] ./res/app/settings/general/language/language.jade 444 bytes {1} [built]
  [582] ./res/app/settings/general/language/language-controller.js 289 bytes {1} [built]
  [583] ./res/app/settings/general/local/index.js 438 bytes {1} [built]
  [584] ./res/bower_components/angular-bootstrap/ui-bootstrap-tpls.js 286 kB {1} [built]
  [585] ./res/app/settings/general/local/local-settings.jade 410 bytes {1} [built]
  [586] ./res/app/settings/general/local/local-settings-controller.js 156 bytes {1} [built]
  [587] ./res/app/settings/general/general.jade 263 bytes {1} [built]
  [588] ./res/app/settings/general/general-controller.js 45 bytes {1} [built]
  [589] ./res/app/settings/keys/index.js 346 bytes {1} [built]
  [590] ./res/app/settings/keys/keys.css 940 bytes {1} [built]
  [591] ./~/css-loader!./res/app/settings/keys/keys.css 975 bytes {1} [built]
  [592] ./res/app/settings/keys/adb-keys/index.js 391 bytes {1} [built]
  [593] ./res/app/settings/keys/adb-keys/adb-keys.css 964 bytes {1} [built]
  [594] ./~/css-loader!./res/app/settings/keys/adb-keys/adb-keys.css 362 bytes {1} [built]
  [595] ./res/app/components/stf/keys/add-adb-key/index.js 268 bytes {1} [built]
  [596] ./res/app/components/stf/keys/add-adb-key/add-adb-key.css 985 bytes {1} [built]
  [597] ./~/css-loader!./res/app/components/stf/keys/add-adb-key/add-adb-key.css 194 bytes {1} [built]
  [598] ./res/app/components/stf/keys/add-adb-key/add-adb-key-directive.js 1.15 kB {1} [built]
  [599] ./res/app/components/stf/keys/add-adb-key/add-adb-key.jade 1.79 kB {1} [built]
  [600] ./res/app/components/stf/keys/add-adb-key/adb-keys-service.js 236 bytes {1} [built]
  [601] ./res/app/settings/keys/adb-keys/adb-keys.jade 1.44 kB {1} [built]
  [602] ./res/app/settings/keys/adb-keys/adb-keys-controller.js 333 bytes {1} [built]
  [603] ./res/app/settings/keys/access-tokens/index.js 468 bytes {1} [built]
  [604] ./res/app/settings/keys/access-tokens/access-tokens.css 979 bytes {1} [built]
  [605] ./~/css-loader!./res/app/settings/keys/access-tokens/access-tokens.css 432 bytes {1} [built]
  [606] ./res/app/components/stf/tokens/index.js 159 bytes {1} [built]
  [607] ./res/app/components/stf/tokens/generate-access-token/index.js 196 bytes {1} [built]
  [608] ./res/app/components/stf/tokens/generate-access-token/generate-access-token.css 1.01 kB {1} [built]
  [609] ./~/css-loader!./res/app/components/stf/tokens/generate-access-token/generate-access-token.css 206 bytes {1} [built]
  [610] ./res/app/components/stf/tokens/generate-access-token/generate-access-token-directive.js 610 bytes {1} [built]
  [611] ./res/app/components/stf/tokens/generate-access-token/generate-access-token.jade 924 bytes {1} [built]
  [612] ./res/app/components/stf/tokens/access-token-service.js 850 bytes {1} [built]
  [613] ./res/app/settings/keys/access-tokens/access-tokens.jade 2.08 kB {1} [built]
  [614] ./res/app/settings/keys/access-tokens/access-tokens-controller.js 790 bytes {1} [built]
  [615] ./res/app/settings/keys/keys.jade 264 bytes {1} [built]
  [616] ./res/app/settings/keys/keys-controller.js 42 bytes {1} [built]
  [617] ./res/app/settings/settings.jade 205 bytes {1} [built]
  [618] ./res/app/settings/settings-controller.js 332 bytes {1} [built]
  [619] ./res/app/docs/index.js 1.48 kB {1} [built]
  [620] ./res/app/docs/docs.css 928 bytes {1} [built]
  [621] ./~/css-loader!./res/app/docs/docs.css 758 bytes {1} [built]
  [622] ./res/app/docs/docs-controller.js 650 bytes {1} [built]
  [623] ./res/app/user/index.js 261 bytes {1} [built]
  [624] ./res/app/user/user.jade 32 bytes {1} [built]
  [625] ./res/app/user/user-controller.js 47 bytes {1} [built]
  [626] ./res/common/lang/index.js 370 bytes {1} [built]
  [627] ./res/common/lang/translations ^.\/stf.._.json$ 318 bytes {1} [built]
  [628] ./res/common/lang/translations/stf.es.json 9.65 kB {1} [optional] [built]
  [629] ./res/common/lang/translations/stf.fr.json 19.5 kB {1} [optional] [built]
  [630] ./res/common/lang/translations/stf.ja.json 9.59 kB {1} [optional] [built]
  [631] ./res/common/lang/translations/stf.ko_KR.json 11.2 kB {1} [optional] [built]
  [632] ./res/common/lang/translations/stf.pl.json 7.19 kB {1} [optional] [built]
  [633] ./res/common/lang/translations/stf.ru_RU.json 13.2 kB {1} [optional] [built]
  [634] ./res/common/lang/translations/stf.zh-Hant.json 7.85 kB {1} [optional] [built]
  [635] ./res/common/lang/translations/stf.zh_CN.json 13.1 kB {1} [optional] [built]
chunk    {2} entry/authldap.entry.js (authldap) 461 bytes {6} [rendered]
    [0] ./res/auth/ldap/scripts/entry.js 461 bytes {2} [built]
chunk    {3} 3.57daa9b8e25369c40ae0.chunk.js 1.45 MB {2} [rendered]
    [1] ./res/bower_components/angular/angular.js 1.15 MB {1} {3} {5} [built]
    [2] ./res/bower_components/angular-route/angular-route.js 38.1 kB {1} {3} {5} [built]
    [3] ./res/bower_components/angular-touch/angular-touch.js 26.6 kB {1} {3} {5} [built]
    [4] ./res/web_modules/gettext/index.js 67 bytes {1} {3} {5} [built]
    [5] ./res/bower_components/angular-gettext/dist/angular-gettext.js 24.6 kB {1} {3} {5} [built]
    [9] ./~/css-loader/lib/css-base.js 1.51 kB {1} {3} {5} [built]
   [10] ./~/style-loader/addStyles.js 7.15 kB {1} {3} {5} [built]
   [13] ./res/web_modules/nine-bootstrap/index.js 179 bytes {1} {3} {5} [built]
   [14] ./res/bower_components/bootstrap/dist/css/bootstrap.css 967 bytes {1} {3} {5} [built]
   [15] ./~/css-loader!./res/bower_components/bootstrap/dist/css/bootstrap.css 154 kB {1} {3} {5} [built]
   [16] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.eot 82 bytes {1} {3} {5} [built]
   [17] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2 84 bytes {1} {3} {5} [built]
   [18] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.woff 83 bytes {1} {3} {5} [built]
   [19] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.ttf 82 bytes {1} {3} {5} [built]
   [20] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.svg 82 bytes {1} {3} {5} [built]
   [21] ./res/web_modules/nine-bootstrap/nine-bootstrap.scss 1.1 kB {1} {3} {5} [built] [1 error]
   [23] ./res/bower_components/components-font-awesome/css/font-awesome.css 964 bytes {1} {3} {5} [built]
   [24] ./~/css-loader!./res/bower_components/components-font-awesome/css/font-awesome.css 37.4 kB {1} {3} {5} [built]
   [25] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.eot?v=4.5.0 82 bytes {1} {3} {5} [built]
   [26] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.eot 82 bytes {1} {3} {5} [built]
   [27] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.woff2?v=4.5.0 84 bytes {1} {3} {5} [built]
   [28] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.woff?v=4.5.0 83 bytes {1} {3} {5} [built]
   [29] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.ttf?v=4.5.0 82 bytes {1} {3} {5} [built]
   [30] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.svg?v=4.5.0 82 bytes {1} {3} {5} [built]
   [31] ./res/bower_components/font-lato-2-subset/css/font-lato-2.css 961 bytes {1} {3} {5} [built]
   [32] ./~/css-loader!./res/bower_components/font-lato-2-subset/css/font-lato-2.css 1.15 kB {1} {3} {5} [built]
   [33] ./res/bower_components/font-lato-2-subset/font/LatoLatinHair-Regular.woff 83 bytes {1} {3} {5} [built]
   [34] ./res/bower_components/font-lato-2-subset/font/LatoLatinLight-Regular.woff 83 bytes {1} {3} {5} [built]
   [35] ./res/bower_components/font-lato-2-subset/font/LatoLatin-Regular.woff 83 bytes {1} {3} {5} [built]
   [36] ./res/bower_components/font-lato-2-subset/font/LatoLatin-Bold.woff 83 bytes {1} {3} {5} [built]
  [636] ./res/auth/ldap/scripts/signin/index.js 277 bytes {3} [built]
  [637] ./res/auth/ldap/scripts/signin/signin.css 958 bytes {3} [built]
  [638] ./~/css-loader!./res/auth/ldap/scripts/signin/signin.css 1.72 kB {3} [built]
  [639] ./res/auth/ldap/scripts/signin/signin.jade 1.86 kB {3} [built]
  [640] ./res/auth/ldap/scripts/signin/signin-controller.js 881 bytes {3} [built]
chunk    {4} entry/authmock.entry.js (authmock) 460 bytes {6} [rendered]
    [0] ./res/auth/mock/scripts/entry.js 460 bytes {4} [built]
chunk    {5} 5.57daa9b8e25369c40ae0.chunk.js 1.45 MB {4} [rendered]
    [1] ./res/bower_components/angular/angular.js 1.15 MB {1} {3} {5} [built]
    [2] ./res/bower_components/angular-route/angular-route.js 38.1 kB {1} {3} {5} [built]
    [3] ./res/bower_components/angular-touch/angular-touch.js 26.6 kB {1} {3} {5} [built]
    [4] ./res/web_modules/gettext/index.js 67 bytes {1} {3} {5} [built]
    [5] ./res/bower_components/angular-gettext/dist/angular-gettext.js 24.6 kB {1} {3} {5} [built]
    [9] ./~/css-loader/lib/css-base.js 1.51 kB {1} {3} {5} [built]
   [10] ./~/style-loader/addStyles.js 7.15 kB {1} {3} {5} [built]
   [13] ./res/web_modules/nine-bootstrap/index.js 179 bytes {1} {3} {5} [built]
   [14] ./res/bower_components/bootstrap/dist/css/bootstrap.css 967 bytes {1} {3} {5} [built]
   [15] ./~/css-loader!./res/bower_components/bootstrap/dist/css/bootstrap.css 154 kB {1} {3} {5} [built]
   [16] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.eot 82 bytes {1} {3} {5} [built]
   [17] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2 84 bytes {1} {3} {5} [built]
   [18] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.woff 83 bytes {1} {3} {5} [built]
   [19] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.ttf 82 bytes {1} {3} {5} [built]
   [20] ./res/bower_components/bootstrap/dist/fonts/glyphicons-halflings-regular.svg 82 bytes {1} {3} {5} [built]
   [21] ./res/web_modules/nine-bootstrap/nine-bootstrap.scss 1.1 kB {1} {3} {5} [built] [1 error]
   [23] ./res/bower_components/components-font-awesome/css/font-awesome.css 964 bytes {1} {3} {5} [built]
   [24] ./~/css-loader!./res/bower_components/components-font-awesome/css/font-awesome.css 37.4 kB {1} {3} {5} [built]
   [25] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.eot?v=4.5.0 82 bytes {1} {3} {5} [built]
   [26] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.eot 82 bytes {1} {3} {5} [built]
   [27] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.woff2?v=4.5.0 84 bytes {1} {3} {5} [built]
   [28] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.woff?v=4.5.0 83 bytes {1} {3} {5} [built]
   [29] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.ttf?v=4.5.0 82 bytes {1} {3} {5} [built]
   [30] ./res/bower_components/components-font-awesome/fonts/fontawesome-webfont.svg?v=4.5.0 82 bytes {1} {3} {5} [built]
   [31] ./res/bower_components/font-lato-2-subset/css/font-lato-2.css 961 bytes {1} {3} {5} [built]
   [32] ./~/css-loader!./res/bower_components/font-lato-2-subset/css/font-lato-2.css 1.15 kB {1} {3} {5} [built]
   [33] ./res/bower_components/font-lato-2-subset/font/LatoLatinHair-Regular.woff 83 bytes {1} {3} {5} [built]
   [34] ./res/bower_components/font-lato-2-subset/font/LatoLatinLight-Regular.woff 83 bytes {1} {3} {5} [built]
   [35] ./res/bower_components/font-lato-2-subset/font/LatoLatin-Regular.woff 83 bytes {1} {3} {5} [built]
   [36] ./res/bower_components/font-lato-2-subset/font/LatoLatin-Bold.woff 83 bytes {1} {3} {5} [built]
  [641] ./res/auth/mock/scripts/signin/index.js 277 bytes {5} [built]
  [642] ./res/auth/mock/scripts/signin/signin.css 958 bytes {5} [built]
  [643] ./~/css-loader!./res/auth/mock/scripts/signin/signin.css 1.72 kB {5} [built]
  [644] ./res/auth/mock/scripts/signin/signin.jade 1.91 kB {5} [built]
  [645] ./res/auth/mock/scripts/signin/signin-controller.js 871 bytes {5} [built]
chunk    {6} entry/commons.entry.js (entry/commons.entry.js) 0 bytes [rendered]

ERROR in Missing binding /tmp/build/node_modules/node-sass/vendor/linux-x64-46/binding.node
Node Sass could not find a binding for your current environment: Linux 64-bit with Node.js 4.x

Found bindings for the following environments:
- OS X 64-bit with Node.js 4.x

This usually happens because your environment has changed since running `npm install`.
Run `npm rebuild node-sass` to build the binding for your current environment.
 @ ./res/web_modules/nine-bootstrap/nine-bootstrap.scss 4:14-137
[13:38:19] Finished 'webpack:build' after 9.03 s
stf-1.1.1.tgz
- tar xzf stf-1.1.1.tgz --strip-components 1 -C /app
- bower cache clean
- npm prune --production
  unbuild jasmine-core@2.4.1
  unbuild json-loader@0.5.4
  unbuild karma-firefox-launcher@0.1.7
  unbuild karma-ie-launcher@0.2.0
  unbuild karma-jasmine@0.3.8
  unbuild karma-opera-launcher@0.3.0
  unbuild karma-safari-launcher@0.1.1
  unbuild raw-loader@0.5.1
  unbuild script-loader@0.6.1
  unbuild sinon-chai@2.8.0
  unbuild event-stream@3.3.2
  unbuild jasmine-reporters@2.1.1
  unbuild karma-junit-reporter@0.3.8
  unbuild karma-phantomjs-launcher@1.0.0
  unbuild protractor-html-screenshot-reporter@0.0.21
  unbuild chai@3.5.0
  unbuild exports-loader@0.6.3
  unbuild extract-text-webpack-plugin@1.0.1
  unbuild file-loader@0.8.5
  unbuild gulp-run@1.6.12
  unbuild imports-loader@0.6.5
  unbuild karma-webpack@1.7.0
  unbuild less-loader@2.2.3
  unbuild memory-fs@0.3.0
  unbuild sass-loader@3.2.0
  unbuild sinon@1.17.4
  unbuild style-loader@0.13.1
  unbuild template-html-loader@0.0.3
  unbuild url-loader@0.5.7
  unbuild gulp-jade@1.1.0
  unbuild karma-chrome-launcher@0.2.3
  unbuild del@2.2.0
  unbuild gulp-jsonlint@1.1.2
  unbuild gulp-angular-gettext@2.1.0
  unbuild node-libs-browser@1.0.0
  unbuild css-loader@0.23.1
  unbuild gulp-protractor@2.3.0
  unbuild gulp-util@3.0.7
  unbuild html-loader@0.4.3
  unbuild gulp-eslint@1.1.1
  unbuild bower@1.7.9
  unbuild less@2.7.1
  unbuild eslint@2.10.2
  unbuild phantomjs-prebuilt@2.1.7
  unbuild protractor@3.3.0
  unbuild webpack-dev-server@1.14.1
  unbuild gulp@3.9.1
  unbuild node-sass@3.7.0
  unbuild karma@0.13.22
  unbuild webpack@1.13.0
- mv node_modules /app
- npm cache clean
- rm -rf /home/stf-build/.node-gyp
- cd /app
- rm -rf /tmp/build
  ---> 7b8e4e17266b
  Removing intermediate container ed6dc941d564
  Step 9 : USER stf
  ---> Running in 358e1f5f8136
  ---> 60d323594657
  Removing intermediate container 358e1f5f8136
  Step 10 : CMD stf --help
  ---> Running in 9b46905e94e9
  ---> 5e9c459e04c9
  Removing intermediate container 9b46905e94e9
  Successfully built 5e9c459e04c9
 @sorccu  @gunta  
Please help,
I fixed the above issue by downloading the [correct binding](https://github.com/sass/node-sass-binaries) for node-saas for specific platform and built a docker image on my local. 
But now when i try to run it on my local ( macOSX ) it throws this error: 
**command: docker run local-image stf doctor**

/app/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: /app/node_modules/zmq/build/Release/zmq.node: invalid ELF header
    at Error (native)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at bindings (/app/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/app/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:434:26)
    at Object.Module._extensions..js (module.js:452:10)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at Object.<anonymous> (/app/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:434:26)
    at Object.Module._extensions..js (module.js:452:10)

How do we build a docker image with local source code and deploy it on CoreOS cluster ?
 I will do as you said and will update. 

Thanks
 It worked. Thanks,
Closing
  It would be nice to allow multiple users to view the same device so that users can demonstrate features or bugs like in vysor. 

http://www.vysor.io/
https://github.com/koush/vysor.io
  All of  devices can be used by one person. How did STF to manage the devices or limit the maximum connection of devices？
 You can change the code for such feature, invite a new device after kick off the last one automatically.
 I tried to achieve this feature.
  Hi there,

I'm trying to get STF working on my MacBook. I have tried it on a linux VM before and it works pretty awesome. It's now running on OS X, but I met a challenge: screenshots feature is not working.

I'm using `bin/stf local --public-ip <my-IP>`, and console shows following error when screenshot button is clicked:

``` bash
INF/device:plugins:screen:capture 37409 [03157df39da5dc05] Capturing screenshot
INF/device:plugins:screen:stream 37409 [03157df39da5dc05] Requesting frame producer to stop
INF/device:plugins:screen:stream 37409 [03157df39da5dc05] Disconnecting from minicap service
INF/device:plugins:screen:stream 37409 [03157df39da5dc05] Stopping minicap service
INF/device:plugins:screen:stream 37409 [03157df39da5dc05] Sending SIGTERM to minicap
INF/device:plugins:screen:stream 37409 [03157df39da5dc05] minicap says: "INFO: (jni/minicap/minicap.cpp:196) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 37409 [03157df39da5dc05] minicap says: "INFO: (jni/minicap/minicap.cpp:512) Closing client connection"
INF/device:plugins:screen:stream 37409 [03157df39da5dc05] minicap says: "INFO: (external/MY_minicap/src/minicap_21.cpp:284) Destroying virtual display"
ERR/device:support:storage 37409 [03157df39da5dc05] Upload to "http://localhost:7100/s/upload/image" failed: HTTP 301
ERR/device:plugins:screen:capture 37409 [03157df39da5dc05] Screen capture failed Error: Upload to "http://localhost:7100/s/upload/image" failed: HTTP 301
    at Request._callback (/Users/Me/Projects/stf/lib/units/device/support/storage.js:30:27)
    at Request.self.callback (/Users/Me/Projects/stf/node_modules/request/request.js:200:22)
    at emitTwo (events.js:106:13)
    at Request.emit (events.js:191:7)
    at Request.<anonymous> (/Users/Me/Projects/stf/node_modules/request/request.js:1067:10)
    at emitOne (events.js:101:20)
    at Request.emit (events.js:188:7)
    at IncomingMessage.<anonymous> (/Users/Me/Projects/stf/node_modules/request/request.js:988:12)
    at emitNone (events.js:91:20)
    at IncomingMessage.emit (events.js:185:7)
    at endReadableNT (_stream_readable.js:926:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
```

I noticed that minicap service stopped after each time I trigger a screenshot, but I don't know why this is happening 

here's the `stf doctor` output:

``` bsah
INF/util:doctor 39181 [*] OS Arch: x64
INF/util:doctor 39181 [*] OS Platform: darwin
INF/util:doctor 39181 [*] OS Platform: 15.4.0
INF/util:doctor 39181 [*] Using Node 6.1.0
INF/util:doctor 39181 [*] Using RethinkDB client 2.3.1
INF/util:doctor 39181 [*] Using ZeroMQ 4.1.4
INF/util:doctor 39181 [*] ProtoBuf 2.6.1
INF/util:doctor 39181 [*] GraphicsMagick 1.3.23
INF/util:doctor 39181 [*] Local RethinkDB server 2.3.2
INF/util:doctor 39181 [*] Local ADB 1.0.32
```

The `stf -V` is `1.1.1` with git hash `commit b61df410f72505367728c4d05ef53449eadd4d69`

Any thoughts/suggestions to help me overcome this issue?  
 hi @Lubricy,

Did you already solve this issue? 
I'm with a similar problem , but in my case the MiniCap works perfectly , at least openstf stderr shows no error , but the screenshot is not shown in openstf web interface . Follow the log openSTF and managed to open the image without problems , so the problem is not in taking the screenshot but the referral to the openSTF interface.
Any suggestion @sorccu ?

I'm using OS X as well, with El Captain 10.11.5.

Regards
 I have all installed dependancy . I had before the openstf housed in a machine with Linux , and screenshots working properly , only since I moved to OS X is no longer functioning properly .
I leave here a screenshot of the interface and openSTF as appears screenshot:
http://imgur.com/KEUI1CV

My stderr file shows this output:

```
INF/device:plugins:screen:capture 16627 [09ece081] Capturing screenshot
INF/storage:temp 16607 [*] Uploaded "09ece081.jpg" to "/var/folders/xs/gk3f7hg178199sxhr68728k80000gn/T/upload_38c39b903b89dc96fe7c67e0c1284a48"
INF/device:support:storage 16627 [09ece081] Uploaded to "/s/image/2594da4a-9144-44e7-bcc5-4995cfe5e2a0/09ece081.jpg"
```

Thanks for your help.
 yes, graphicsmagick commands works. 
This is the output of gm version command:

```
userpc:/var/folders/xs/gk3f7hg178199sxhr68728k80000gn/T$ gm version
GraphicsMagick 1.3.24 2016-05-30 Q16 http://www.GraphicsMagick.org/
Copyright (C) 2002-2016 GraphicsMagick Group.
Additional copyrights and licenses apply to this software.
See http://www.GraphicsMagick.org/www/Copyright.html for details.

Feature Support:
  Native Thread Safe       yes
  Large Files (> 32 bit)   yes
  Large Memory (> 32 bit)  yes
  BZIP                     yes
  DPS                      no
  FlashPix                 no
  FreeType                 yes
  Ghostscript (Library)    no
  JBIG                     no
  JPEG-2000                no
  JPEG                     yes
  Little CMS               no
  Loadable Modules         yes
  OpenMP                   no
  PNG                      yes
  TIFF                     yes
  TRIO                     no
  UMEM                     no
  WebP                     no
  WMF                      no
  X11                      no
  XML                      yes
  ZLIB                     yes

Host type: x86_64-apple-darwin15.5.0

Configured using the command:
  ./configure  '--prefix=/usr/local/Cellar/graphicsmagick/1.3.24' '--disable-dependency-tracking' '--enable-shared' '--disable-static' '--with-modules' '--disable-openmp' '--with-quantum-depth=16' '--without-gslib' '--with-gs-font-dir=/usr/local/share/ghostscript/fonts' '--without-x' '--without-lcms2' 'CC=clang' 'CXX=clang++'

Final Build Parameters:
  CC       = clang
  CFLAGS   = -g -O2 -Wall -D_THREAD_SAFE
  CPPFLAGS = -I/usr/local/Cellar/freetype/2.6.3/include/freetype2 -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk/usr/include/libxml2
  CXX      = clang++
  CXXFLAGS = -D_THREAD_SAFE
  LDFLAGS  = -L/usr/local/Cellar/freetype/2.6.3/lib -L/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk/usr/lib
  LIBS     = -lfreetype -lbz2 -lz -lltdl -lm -lpthread
```
 Hi @joaopedroms22,
In my case I found that there is a firewall on my macbook blocking all incoming connections even they're from localhost. After I turned it off everything goes well.
Not sure if this helps ...
 When using homebrew to install graphicsmagick gm binary is located at ``/usr/local/bin`` (actually, it's symlinked).
So make sure that your ``PATH`` env contains that folder when launching stf. That was the problem that I and @joaopedroms22 had.

  **Run： gulp webpack:build**

```
ERROR in ./res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'nine-bootstrap' in /usr/local/lib/node_modules/stf/res/auth/ldap/scripts
 @ ./res/auth/ldap/scripts/entry.js 2:2-27

ERROR in ./res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'nine-bootstrap' in /usr/local/lib/node_modules/stf/res/auth/mock/scripts
 @ ./res/auth/mock/scripts/entry.js 2:2-27

ERROR in ./res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-route' in /usr/local/lib/node_modules/stf/res/auth/ldap/scripts
 @ ./res/auth/ldap/scripts/entry.js 5:2-26

ERROR in ./res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-route' in /usr/local/lib/node_modules/stf/res/auth/mock/scripts
 @ ./res/auth/mock/scripts/entry.js 5:2-26

ERROR in ./res/app/app.js
Module not found: Error: Cannot resolve module 'angular-route' in /usr/local/lib/node_modules/stf/res/app
 @ ./res/app/app.js 4:2-26

ERROR in ./res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-touch' in /usr/local/lib/node_modules/stf/res/auth/ldap/scripts
 @ ./res/auth/ldap/scripts/entry.js 6:2-26

ERROR in ./res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-touch' in /usr/local/lib/node_modules/stf/res/auth/mock/scripts
 @ ./res/auth/mock/scripts/entry.js 6:2-26

ERROR in ./res/app/app.js
Module not found: Error: Cannot resolve module 'angular-touch' in /usr/local/lib/node_modules/stf/res/app
 @ ./res/app/app.js 5:2-26

ERROR in ./res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/auth/ldap/scripts
 @ ./res/auth/ldap/scripts/entry.js 11:4-22

ERROR in ./res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/auth/mock/scripts
 @ ./res/auth/mock/scripts/entry.js 11:4-22

ERROR in ./res/app/app.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app
 @ ./res/app/app.js 10:4-22

ERROR in ./res/app/app.js
Module not found: Error: Cannot resolve module 'angular-hotkeys' in /usr/local/lib/node_modules/stf/res/app
 @ ./res/app/app.js 11:4-30

ERROR in ./res/app/layout/index.js
Module not found: Error: Cannot resolve module 'nine-bootstrap' in /usr/local/lib/node_modules/stf/res/app/layout
 @ ./res/app/layout/index.js 1:0-25

ERROR in ./res/app/layout/index.js
Module not found: Error: Cannot resolve module 'ui-bootstrap' in /usr/local/lib/node_modules/stf/res/app/layout
 @ ./res/app/layout/index.js 10:2-25

ERROR in ./res/app/layout/index.js
Module not found: Error: Cannot resolve module 'angular-borderlayout' in /usr/local/lib/node_modules/stf/res/app/layout
 @ ./res/app/layout/index.js 11:2-33

ERROR in ./res/app/device-list/index.js
Module not found: Error: Cannot resolve module 'angular-xeditable' in /usr/local/lib/node_modules/stf/res/app/device-list
 @ ./res/app/device-list/index.js 4:2-30

ERROR in ./res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'exports' in /usr/local/lib/node_modules/stf/res/auth/ldap/scripts
 @ ./res/auth/ldap/scripts/entry.js 4:2-20

ERROR in ./res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'exports' in /usr/local/lib/node_modules/stf/res/auth/mock/scripts
 @ ./res/auth/mock/scripts/entry.js 4:2-20

ERROR in ./res/app/app.js
Module not found: Error: Cannot resolve module 'exports' in /usr/local/lib/node_modules/stf/res/app
 @ ./res/app/app.js 3:2-20

ERROR in ./res/auth/ldap/scripts/signin/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/auth/ldap/scripts/signin
 @ ./res/auth/ldap/scripts/signin/index.js 1:0-23

ERROR in ./res/auth/ldap/scripts/signin/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/auth/ldap/scripts/signin
 @ ./res/auth/ldap/scripts/signin/index.js 7:18-42

ERROR in ./res/app/layout/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/layout
 @ ./res/app/layout/index.js 3:0-23

ERROR in ./res/app/layout/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/layout
 @ ./res/app/layout/index.js 4:0-22

ERROR in ./res/app/layout/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/layout
 @ ./res/app/layout/index.js 5:0-27

ERROR in ./res/auth/mock/scripts/signin/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/auth/mock/scripts/signin
 @ ./res/auth/mock/scripts/signin/index.js 1:0-23

ERROR in ./res/auth/mock/scripts/signin/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/auth/mock/scripts/signin
 @ ./res/auth/mock/scripts/signin/index.js 7:18-42

ERROR in ./res/app/device-list/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/device-list
 @ ./res/app/device-list/index.js 1:0-28

ERROR in ./res/app/device-list/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/device-list
 @ ./res/app/device-list/index.js 21:18-47

ERROR in ./res/app/menu/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/menu
 @ ./res/app/menu/index.js 1:0-21

ERROR in ./res/app/menu/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/menu
 @ ./res/app/menu/index.js 11:36-58

ERROR in ./res/app/control-panes/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes
 @ ./res/app/control-panes/index.js 27:18-49 37:18-49

ERROR in ./res/app/docs/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/docs
 @ ./res/app/docs/index.js 1:0-21

ERROR in ./res/common/lang/index.js
Module not found: Error: Cannot resolve module 'json' in /usr/local/lib/node_modules/stf/res/common/lang
 @ ./res/common/lang/index.js 3:18-36

ERROR in ./res/app/user/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/user
 @ ./res/app/user/index.js 6:18-40

ERROR in ./res/app/settings/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/settings
 @ ./res/app/settings/index.js 9:16-42

ERROR in ./res/app/components/stf/standalone/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/standalone
 @ ./res/app/components/stf/standalone/index.js 1:0-27

ERROR in ./res/app/components/stf/standalone/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/standalone
 @ ./res/app/components/stf/standalone/index.js 12:6-34

ERROR in ./res/app/device-list/column/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/device-list/column
 @ ./res/app/device-list/column/index.js 2:2-20

ERROR in ./res/app/device-list/icons/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/device-list/icons
 @ ./res/app/device-list/icons/index.js 4:2-20

ERROR in ./res/app/components/stf/scoped-hotkeys/index.js
Module not found: Error: Cannot resolve module 'angular-hotkeys' in /usr/local/lib/node_modules/stf/res/app/components/stf/scoped-hotkeys
 @ ./res/app/components/stf/scoped-hotkeys/index.js 1:0-26

ERROR in ./res/app/control-panes/device-control/index.js
Module not found: Error: Cannot resolve module 'ng-context-menu' in /usr/local/lib/node_modules/stf/res/app/control-panes/device-control
 @ ./res/app/control-panes/device-control/index.js 7:2-28

ERROR in ./res/app/components/stf/language/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/components/stf/language
 @ ./res/app/components/stf/language/index.js 3:2-20

ERROR in ./res/app/components/stf/basic-mode/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/basic-mode
 @ ./res/app/components/stf/basic-mode/index.js 1:0-27

ERROR in ./res/app/device-list/details/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/device-list/details
 @ ./res/app/device-list/details/index.js 1:0-36

ERROR in ./res/app/device-list/icons/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/device-list/icons
 @ ./res/app/device-list/icons/index.js 1:0-34

ERROR in ./res/app/device-list/stats/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/device-list/stats
 @ ./res/app/device-list/stats/index.js 1:0-34

ERROR in ./res/app/device-list/search/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/device-list/search
 @ ./res/app/device-list/search/index.js 1:0-35

ERROR in ./res/app/device-list/customize/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/device-list/customize
 @ ./res/app/device-list/customize/index.js 1:0-38

ERROR in ./res/app/components/stf/common-ui/modals/external-url-modal/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/external-url-modal
 @ ./res/app/components/stf/common-ui/modals/external-url-modal/index.js 1:0-35

ERROR in ./res/app/control-panes/device-control/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/device-control
 @ ./res/app/control-panes/device-control/index.js 1:0-31

ERROR in ./res/app/control-panes/device-control/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/device-control
 @ ./res/app/control-panes/device-control/index.js 12:6-38

ERROR in ./res/app/control-panes/device-control/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/device-control
 @ ./res/app/control-panes/device-control/index.js 15:6-49

ERROR in ./res/app/control-panes/automation/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/automation
 @ ./res/app/control-panes/automation/index.js 8:8-36

ERROR in ./res/app/control-panes/advanced/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced
 @ ./res/app/control-panes/advanced/index.js 1:0-25

ERROR in ./res/app/control-panes/advanced/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced
 @ ./res/app/control-panes/advanced/index.js 13:6-32

ERROR in ./res/app/control-panes/performance/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/performance
 @ ./res/app/control-panes/performance/index.js 1:0-28

ERROR in ./res/app/control-panes/performance/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/performance
 @ ./res/app/control-panes/performance/index.js 8:6-35

ERROR in ./res/app/control-panes/dashboard/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard
 @ ./res/app/control-panes/dashboard/index.js 12:8-35

ERROR in ./res/app/control-panes/screenshots/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/screenshots
 @ ./res/app/control-panes/screenshots/index.js 1:0-28

ERROR in ./res/app/control-panes/screenshots/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/screenshots
 @ ./res/app/control-panes/screenshots/index.js 9:6-35

ERROR in ./res/app/control-panes/logs/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/logs
 @ ./res/app/control-panes/logs/index.js 1:0-22

ERROR in ./res/app/control-panes/logs/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/logs
 @ ./res/app/control-panes/logs/index.js 9:6-28

ERROR in ./res/app/control-panes/explorer/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/explorer
 @ ./res/app/control-panes/explorer/index.js 1:0-25

ERROR in ./res/app/control-panes/explorer/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/explorer
 @ ./res/app/control-panes/explorer/index.js 6:6-32

ERROR in ./res/app/control-panes/info/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/info
 @ ./res/app/control-panes/info/index.js 1:0-21

ERROR in ./res/app/control-panes/info/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/info
 @ ./res/app/control-panes/info/index.js 9:6-28

ERROR in ./res/app/settings/general/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/settings/general
 @ ./res/app/settings/general/index.js 1:0-24

ERROR in ./res/app/settings/general/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/settings/general
 @ ./res/app/settings/general/index.js 10:8-33

ERROR in ./res/app/settings/keys/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/settings/keys
 @ ./res/app/settings/keys/index.js 1:0-21

ERROR in ./res/app/settings/keys/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/settings/keys
 @ ./res/app/settings/keys/index.js 9:33-55

ERROR in ./res/app/components/stf/screen/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/screen
 @ ./res/app/components/stf/screen/index.js 1:0-23

ERROR in ./res/app/components/stf/device/device-service.js
Module not found: Error: Cannot resolve module 'oboe' in /usr/local/lib/node_modules/stf/res/app/components/stf/device
 @ ./res/app/components/stf/device/device-service.js 1:11-26

ERROR in ./res/app/control-panes/dashboard/shell/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/shell
 @ ./res/app/control-panes/dashboard/shell/index.js 5:2-20

ERROR in ./res/app/control-panes/dashboard/install/index.js
Module not found: Error: Cannot resolve module 'ng-file-upload' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/install
 @ ./res/app/control-panes/dashboard/install/index.js 3:0-25

ERROR in ./res/app/control-panes/dashboard/clipboard/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/clipboard
 @ ./res/app/control-panes/dashboard/clipboard/index.js 7:2-20

ERROR in ./res/app/control-panes/dashboard/clipboard/index.js
Module not found: Error: Cannot resolve module 'angular-elastic' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/clipboard
 @ ./res/app/control-panes/dashboard/clipboard/index.js 3:0-26

ERROR in ./res/app/control-panes/dashboard/remote-debug/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/remote-debug
 @ ./res/app/control-panes/dashboard/remote-debug/index.js 4:2-20

ERROR in ./res/app/components/stf/language/language-service.js
Module not found: Error: Cannot resolve module 'json' in /usr/local/lib/node_modules/stf/res/app/components/stf/language
 @ ./res/app/components/stf/language/language-service.js 1:25-72

ERROR in ./res/app/components/stf/common-ui/notifications/index.js
Module not found: Error: Cannot resolve module 'angular-animate' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/notifications
 @ ./res/app/components/stf/common-ui/notifications/index.js 1:0-26

ERROR in ./res/app/components/stf/common-ui/notifications/index.js
Module not found: Error: Cannot resolve module 'angular-growl' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/notifications
 @ ./res/app/components/stf/common-ui/notifications/index.js 3:0-24

ERROR in ./res/app/components/stf/common-ui/table/index.js
Module not found: Error: Cannot resolve module 'script' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/table
 @ ./res/app/components/stf/common-ui/table/index.js 2:0-40

ERROR in ./res/app/components/stf/common-ui/enable-autofill/index.js
Module not found: Error: Cannot resolve module 'angular-cookies' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/enable-autofill
 @ ./res/app/components/stf/common-ui/enable-autofill/index.js 1:0-26

ERROR in ./res/app/components/stf/common-ui/modals/common/index.js
Module not found: Error: Cannot resolve module 'ui-bootstrap' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/common
 @ ./res/app/components/stf/common-ui/modals/common/index.js 4:2-25

ERROR in ./res/app/device-list/details/device-list-details-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/device-list/details
 @ ./res/app/device-list/details/device-list-details-directive.js 16:14-51

ERROR in ./res/app/device-list/icons/device-list-icons-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/device-list/icons
 @ ./res/app/device-list/icons/device-list-icons-directive.js 101:14-49

ERROR in ./res/app/device-list/stats/device-list-stats-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/device-list/stats
 @ ./res/app/device-list/stats/device-list-stats-directive.js 6:14-49

ERROR in ./res/app/components/stf/common-ui/modals/external-url-modal/external-url-modal-service.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/external-url-modal
 @ ./res/app/components/stf/common-ui/modals/external-url-modal/external-url-modal-service.js 20:16-52

ERROR in ./res/app/components/stf/device-context-menu/index.js
Module not found: Error: Cannot resolve module 'ng-context-menu' in /usr/local/lib/node_modules/stf/res/app/components/stf/device-context-menu
 @ ./res/app/components/stf/device-context-menu/index.js 4:2-28

ERROR in ./res/app/control-panes/automation/store-account/index.js
Module not found: Error: Cannot resolve module 'angular-ladda' in /usr/local/lib/node_modules/stf/res/app/control-panes/automation/store-account
 @ ./res/app/control-panes/automation/store-account/index.js 2:0-24

ERROR in ./res/app/control-panes/advanced/port-forwarding/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced/port-forwarding
 @ ./res/app/control-panes/advanced/port-forwarding/index.js 6:2-20

ERROR in ./res/app/control-panes/advanced/maintenance/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced/maintenance
 @ ./res/app/control-panes/advanced/maintenance/index.js 2:2-20

ERROR in ./res/app/control-panes/performance/cpu/index.js
Module not found: Error: Cannot resolve module 'epoch' in /usr/local/lib/node_modules/stf/res/app/control-panes/performance/cpu
 @ ./res/app/control-panes/performance/cpu/index.js 6:2-18

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/rect.js' in /usr/local/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 3:0-29

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/packer.js' in /usr/local/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 4:0-31

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/item.js' in /usr/local/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 5:0-29

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/packery.js' in /usr/local/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 6:14-46

ERROR in ./res/app/settings/general/local/index.js
Module not found: Error: Cannot resolve module 'angular-bootstrap/ui-bootstrap-tpls' in /usr/local/lib/node_modules/stf/res/app/settings/general/local
 @ ./res/app/settings/general/local/index.js 1:0-28

ERROR in ./res/app/components/stf/socket/socket-state/socket-state-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/socket/socket-state
 @ ./res/app/components/stf/socket/socket-state/socket-state-directive.js 11:14-44

ERROR in ./res/app/components/stf/common-ui/table/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/table
 @ ./res/app/components/stf/common-ui/table/index.js 1:0-22

ERROR in ./res/app/components/stf/common-ui/modals/socket-disconnected/socket-disconnected-service.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/socket-disconnected
 @ ./res/app/components/stf/common-ui/modals/socket-disconnected/socket-disconnected-service.js 21:18-55

ERROR in ./res/app/device-list/empty/device-list-empty-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/device-list/empty
 @ ./res/app/device-list/empty/device-list-empty-directive.js 4:14-49

ERROR in ./res/app/components/stf/common-ui/nice-tabs/nice-tab-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/nice-tabs
 @ ./res/app/components/stf/common-ui/nice-tabs/nice-tab-directive.js 8:14-40

ERROR in ./res/app/components/stf/common-ui/nice-tabs/nice-tabs-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/nice-tabs
 @ ./res/app/components/stf/common-ui/nice-tabs/nice-tabs-directive.js 5:14-41

ERROR in ./res/app/control-panes/dashboard/navigation/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/navigation
 @ ./res/app/control-panes/dashboard/navigation/index.js 1:0-27

ERROR in ./res/app/control-panes/dashboard/navigation/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/navigation
 @ ./res/app/control-panes/dashboard/navigation/index.js 8:6-34

ERROR in ./res/app/control-panes/dashboard/shell/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/shell
 @ ./res/app/control-panes/dashboard/shell/index.js 1:0-22

ERROR in ./res/app/control-panes/dashboard/shell/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/shell
 @ ./res/app/control-panes/dashboard/shell/index.js 9:6-29

ERROR in ./res/app/control-panes/dashboard/install/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/install
 @ ./res/app/control-panes/dashboard/install/index.js 1:0-24

ERROR in ./res/app/control-panes/dashboard/install/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/install
 @ ./res/app/control-panes/dashboard/install/index.js 15:6-31

ERROR in ./res/app/control-panes/dashboard/apps/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/apps
 @ ./res/app/control-panes/dashboard/apps/index.js 1:0-21

ERROR in ./res/app/control-panes/dashboard/apps/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/apps
 @ ./res/app/control-panes/dashboard/apps/index.js 8:6-28

ERROR in ./res/app/control-panes/dashboard/clipboard/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/clipboard
 @ ./res/app/control-panes/dashboard/clipboard/index.js 1:0-26

ERROR in ./res/app/control-panes/dashboard/clipboard/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/clipboard
 @ ./res/app/control-panes/dashboard/clipboard/index.js 11:6-33

ERROR in ./res/app/control-panes/dashboard/remote-debug/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/remote-debug
 @ ./res/app/control-panes/dashboard/remote-debug/index.js 1:0-29

ERROR in ./res/app/control-panes/dashboard/remote-debug/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/remote-debug
 @ ./res/app/control-panes/dashboard/remote-debug/index.js 9:6-36

ERROR in ./res/app/components/stf/common-ui/notifications/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/notifications
 @ ./res/app/components/stf/common-ui/notifications/index.js 2:0-22

ERROR in ./res/app/components/stf/common-ui/nothing-to-show/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/nothing-to-show
 @ ./res/app/components/stf/common-ui/nothing-to-show/index.js 1:0-32

ERROR in ./res/app/components/stf/common-ui/error-message/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/error-message
 @ ./res/app/components/stf/common-ui/error-message/index.js 1:0-30

ERROR in ./res/app/components/stf/common-ui/badge-icon/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/badge-icon
 @ ./res/app/components/stf/common-ui/badge-icon/index.js 1:0-27

ERROR in ./res/app/components/stf/common-ui/modals/common/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/common
 @ ./res/app/components/stf/common-ui/modals/common/index.js 1:0-23

ERROR in ./res/app/components/stf/keycodes/index.js
Module not found: Error: Cannot resolve module 'json' in /usr/local/lib/node_modules/stf/res/app/components/stf/keycodes
 @ ./res/app/components/stf/keycodes/index.js 5:11-41

ERROR in ./res/app/components/stf/device-context-menu/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/device-context-menu
 @ ./res/app/components/stf/device-context-menu/index.js 1:0-36

ERROR in ./res/app/control-panes/automation/store-account/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/automation/store-account
 @ ./res/app/control-panes/automation/store-account/index.js 1:0-30

ERROR in ./res/app/control-panes/automation/store-account/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/automation/store-account
 @ ./res/app/control-panes/automation/store-account/index.js 10:6-37

ERROR in ./res/app/control-panes/automation/device-settings/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/automation/device-settings
 @ ./res/app/control-panes/automation/device-settings/index.js 1:0-32

ERROR in ./res/app/control-panes/automation/device-settings/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/automation/device-settings
 @ ./res/app/control-panes/automation/device-settings/index.js 8:6-39

ERROR in ./res/app/control-panes/advanced/input/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced/input
 @ ./res/app/control-panes/advanced/input/index.js 1:0-22

ERROR in ./res/app/control-panes/advanced/input/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced/input
 @ ./res/app/control-panes/advanced/input/index.js 7:6-29

ERROR in ./res/app/control-panes/advanced/port-forwarding/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced/port-forwarding
 @ ./res/app/control-panes/advanced/port-forwarding/index.js 1:0-32

ERROR in ./res/app/control-panes/advanced/port-forwarding/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced/port-forwarding
 @ ./res/app/control-panes/advanced/port-forwarding/index.js 11:6-39

ERROR in ./res/app/control-panes/advanced/maintenance/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced/maintenance
 @ ./res/app/control-panes/advanced/maintenance/index.js 6:6-35

ERROR in ./res/app/control-panes/performance/cpu/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/performance/cpu
 @ ./res/app/control-panes/performance/cpu/index.js 1:0-20

ERROR in ./res/app/control-panes/performance/cpu/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/performance/cpu
 @ ./res/app/control-panes/performance/cpu/index.js 10:6-27

ERROR in ./res/app/components/stf/logcat-table/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/logcat-table
 @ ./res/app/components/stf/logcat-table/index.js 1:0-29

ERROR in ./res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/angular-packery
 @ ./res/app/components/stf/angular-packery/index.js 1:0-32

ERROR in ./res/app/components/stf/common-ui/modals/lightbox-image/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/lightbox-image
 @ ./res/app/components/stf/common-ui/modals/lightbox-image/index.js 1:0-31

ERROR in ./res/app/settings/general/language/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/settings/general/language
 @ ./res/app/settings/general/language/index.js 7:49-75

ERROR in ./res/app/settings/general/local/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/settings/general/local
 @ ./res/app/settings/general/local/index.js 11:6-38

ERROR in ./res/app/settings/keys/adb-keys/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/settings/keys/adb-keys
 @ ./res/app/settings/keys/adb-keys/index.js 1:0-25

ERROR in ./res/app/settings/keys/adb-keys/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/settings/keys/adb-keys
 @ ./res/app/settings/keys/adb-keys/index.js 9:46-72

ERROR in ./res/app/settings/keys/access-tokens/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/settings/keys/access-tokens
 @ ./res/app/settings/keys/access-tokens/index.js 1:0-30

ERROR in ./res/app/settings/keys/access-tokens/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/settings/keys/access-tokens
 @ ./res/app/settings/keys/access-tokens/index.js 10:56-87

ERROR in ./res/app/components/stf/screen/screen-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/screen
 @ ./res/app/components/stf/screen/screen-directive.js 15:14-38

ERROR in ./res/app/components/stf/socket/socket-service.js
Module not found: Error: Cannot resolve module 'socket.io-client' in /usr/local/lib/node_modules/stf/res/app/components/stf/socket
 @ ./res/app/components/stf/socket/socket-service.js 1:9-29

ERROR in ./res/app/components/stf/install/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/components/stf/install
 @ ./res/app/components/stf/install/index.js 2:2-20

ERROR in ./res/app/components/stf/upload/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/components/stf/upload
 @ ./res/app/components/stf/upload/index.js 2:2-20

ERROR in ./res/app/components/stf/storage/index.js
Module not found: Error: Cannot resolve module 'ng-file-upload' in /usr/local/lib/node_modules/stf/res/app/components/stf/storage
 @ ./res/app/components/stf/storage/index.js 1:0-25

ERROR in ./res/app/components/stf/logcat/logcat-service.js
Module not found: Error: Cannot resolve module 'underscore.string/index' in /usr/local/lib/node_modules/stf/res/app/components/stf/logcat
 @ ./res/app/components/stf/logcat/logcat-service.js 2:9-37

ERROR in ./res/app/components/stf/common-ui/modals/version-update/index.js
Module not found: Error: Cannot resolve module 'ui-bootstrap' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/version-update
 @ ./res/app/components/stf/common-ui/modals/version-update/index.js 3:2-25

ERROR in ./res/app/components/stf/common-ui/error-message/error-message-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/error-message
 @ ./res/app/components/stf/common-ui/error-message/error-message-directive.js 8:14-45

ERROR in ./res/app/components/stf/common-ui/modals/fatal-message/index.js
Module not found: Error: Cannot resolve module 'angular-route' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/fatal-message
 @ ./res/app/components/stf/common-ui/modals/fatal-message/index.js 1:0-24

ERROR in ./res/app/components/stf/common-ui/badge-icon/badge-icon-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/badge-icon
 @ ./res/app/components/stf/common-ui/badge-icon/badge-icon-directive.js 7:14-42

ERROR in ./res/app/components/stf/device-context-menu/device-context-menu-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/device-context-menu
 @ ./res/app/components/stf/device-context-menu/device-context-menu-directive.js 10:14-51

ERROR in ./res/app/control-panes/dashboard/navigation/navigation-controller.js
Module not found: Error: Cannot resolve module 'url' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/navigation
 @ ./res/app/control-panes/dashboard/navigation/navigation-controller.js 14:24-56

ERROR in ./res/app/components/stf/logcat-table/logcat-table-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/logcat-table
 @ ./res/app/components/stf/logcat-table/logcat-table-directive.js 8:16-46

ERROR in ./res/app/components/stf/angular-draggabilly/index.js
Module not found: Error: Cannot resolve module 'draggabilly' in /usr/local/lib/node_modules/stf/res/app/components/stf/angular-draggabilly
 @ ./res/app/components/stf/angular-draggabilly/index.js 1:18-40

ERROR in ./res/app/components/stf/common-ui/modals/lightbox-image/lightbox-image-service.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/lightbox-image
 @ ./res/app/components/stf/common-ui/modals/lightbox-image/lightbox-image-service.js 19:16-48

ERROR in ./res/app/components/stf/keys/add-adb-key/index.js
Module not found: Error: Cannot resolve module 'gettext' in /usr/local/lib/node_modules/stf/res/app/components/stf/keys/add-adb-key
 @ ./res/app/components/stf/keys/add-adb-key/index.js 4:2-20

ERROR in ./res/app/components/stf/common-ui/refresh-page/refresh-page-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/refresh-page
 @ ./res/app/components/stf/common-ui/refresh-page/refresh-page-directive.js 7:14-44

ERROR in ./res/app/components/stf/common-ui/clear-button/clear-button-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/clear-button
 @ ./res/app/components/stf/common-ui/clear-button/clear-button-directive.js 6:14-44

ERROR in ./res/app/components/stf/common-ui/nothing-to-show/nothing-to-show-directive.js
Module not found: Error: Cannot resolve module 'html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/nothing-to-show
 @ ./res/app/components/stf/common-ui/nothing-to-show/nothing-to-show-directive.js 9:14-47

ERROR in ./res/app/components/stf/common-ui/filter-button/filter-button-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/filter-button
 @ ./res/app/components/stf/common-ui/filter-button/filter-button-directive.js 7:14-45

ERROR in ./res/app/components/stf/common-ui/stacked-icon/stacked-icon-directive.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/stacked-icon
 @ ./res/app/components/stf/common-ui/stacked-icon/stacked-icon-directive.js 1:0-29

ERROR in ./res/app/components/stf/common-ui/stacked-icon/stacked-icon-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/stacked-icon
 @ ./res/app/components/stf/common-ui/stacked-icon/stacked-icon-directive.js 11:14-44

ERROR in ./res/app/components/stf/common-ui/help-icon/help-icon-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/help-icon
 @ ./res/app/components/stf/common-ui/help-icon/help-icon-directive.js 9:14-41

ERROR in ./res/app/control-panes/dashboard/install/activities/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/install/activities
 @ ./res/app/control-panes/dashboard/install/activities/index.js 1:0-27

ERROR in ./res/app/control-panes/dashboard/install/activities/index.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/control-panes/dashboard/install/activities
 @ ./res/app/control-panes/dashboard/install/activities/index.js 9:6-34

ERROR in ./res/app/components/stf/keys/add-adb-key/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/keys/add-adb-key
 @ ./res/app/components/stf/keys/add-adb-key/index.js 1:0-28

ERROR in ./res/app/components/stf/tokens/generate-access-token/index.js
Module not found: Error: Cannot resolve module 'style' in /usr/local/lib/node_modules/stf/res/app/components/stf/tokens/generate-access-token
 @ ./res/app/components/stf/tokens/generate-access-token/index.js 1:0-38

ERROR in ./res/app/components/stf/transaction/transaction-service.js
Module not found: Error: Cannot resolve module 'imports' in /usr/local/lib/node_modules/stf/res/app/components/stf/transaction
 @ ./res/app/components/stf/transaction/transaction-service.js 2:11-31

ERROR in ./res/app/control-panes/advanced/port-forwarding/port-forwarding-controller.js
Module not found: Error: Cannot resolve module 'imports' in /usr/local/lib/node_modules/stf/res/app/control-panes/advanced/port-forwarding
 @ ./res/app/control-panes/advanced/port-forwarding/port-forwarding-controller.js 1:11-31

ERROR in ./res/app/components/stf/keys/add-adb-key/add-adb-key-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/keys/add-adb-key
 @ ./res/app/components/stf/keys/add-adb-key/add-adb-key-directive.js 9:14-43

ERROR in ./res/app/components/stf/tokens/generate-access-token/generate-access-token-directive.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/tokens/generate-access-token
 @ ./res/app/components/stf/tokens/generate-access-token/generate-access-token-directive.js 8:14-53

ERROR in ./res/app/components/stf/common-ui/modals/version-update/version-update-service.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/version-update
 @ ./res/app/components/stf/common-ui/modals/version-update/version-update-service.js 17:16-48

ERROR in ./res/app/components/stf/common-ui/modals/add-adb-key-modal/add-adb-key-modal-service.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/add-adb-key-modal
 @ ./res/app/components/stf/common-ui/modals/add-adb-key-modal/add-adb-key-modal-service.js 28:18-53

ERROR in ./res/app/components/stf/common-ui/modals/fatal-message/fatal-message-service.js
Module not found: Error: Cannot resolve module 'template-html-loader' in /usr/local/lib/node_modules/stf/res/app/components/stf/common-ui/modals/fatal-message
 @ ./res/app/components/stf/common-ui/modals/fatal-message/fatal-message-service.js 60:18-49

```
 Thanks, has been resolved
 @siterui Hi, I have this same problem with you, but I execute `gulp webpack:build` after `npm install`  and `npm link` , so Can you tell me how can you solve your problems?
  
@gunta Look forward for you apply too! Thanks! I have resolved this problem, by execute`bower install` to install web modules in bower.json. Effectively I solved the problem with bower install, but before that I sudo chmod -R 777 / Users / jrolon /. config  It's possible that  I want to set 'zh_CN' for default Language ?And what should I do?

Thanks.
 I want  the first time who has logined is Chinese rather than English. Is it  possible?
 Thank you very much.
 "navigator.userAgent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
"navigator.language: zh-CN"
"navigator.userLanguage: undefined"
"navigator.languages: zh-CN,zh"
"navigator.browserLanguage:undefined"
"navigator.systemLanguage:undefined"
"navigator.userLanguage:undefined"
 @gunta  Would you update the code?
  I'm so sorry that haven't put the info of errs at last time.
version: master
activity: 
1.select a phone and connect ,
2.click the tab "drop file to upload".
3.Choose the a over 40MB apk package and upload
result:
when the package upload,the stf server was crash at the sametime and couldn't  visit the website
There is the err  info.
![image](https://cloud.githubusercontent.com/assets/18346467/15002519/7e6594c8-11d4-11e6-8507-a5c62ff89a32.png)
 I would sent email to you.But I have tried to install  several kinds of apk, it also crash.
My rethinkdb version is v2.3.0.
 It also crash that I have tried to install several kinds of apk,.

At 2016-05-04 19:22:39, "Simo Kinnunen" notifications@github.com wrote:

I don't think the size of the package is related. The automatic launcher activity detection seems to be failing for some reason. Is there any chance you could send the .apk file to me?

—
You are receiving this because you authored the thread.
Reply to this email directly or view it on GitHub

从网易163邮箱发来的云附件
test.apk (94.41M, 2016年5月20日 9:04 到期)
下载
 There is another crash log when I tried to install the apk(test-errsocket.apk). The err log was print that socket hang up.

 Uploaded "越南棋牌大厅体验包-4.28-10h.apk" to "/tmp/upload_f68457a69acc57c282da    64c5bb817705"
stream.js:74
      throw er; // Unhandled stream error in pipe.
      ^

Error: socket hang up
    at createHangUpError (_http_client.js:239:15)
    at Socket.socketOnEnd (_http_client.js:331:23)
    at emitNone (events.js:85:20)
    at Socket.emit (events.js:179:7)
    at endReadableNT (_stream_readable.js:913:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
ERR/poorxy 1194 [_] Proxy had an error Error: socket hang up
    at createHangUpError (_http_client.js:239:15)
    at Socket.socketOnEnd (_http_client.js:331:23)
    at emitNone (events.js:85:20)
    at Socket.emit (events.js:179:7)
    at endReadableNT (_stream_readable.js:913:12)
    at _combinedTickCallback (internal/process/next_tick.js:74:11)
    at process._tickCallback (internal/process/next_tick.js:98:9)
FTL/cli:local 1056 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/home/boyaa-test/stf/lib/util/procutil.js:49:23    )
    at emitTwo (events.js:100:13)
    at ChildProcess.emit (events.js:185:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:204:12)
INF/cli:local 1056 [*] Shutting down all child processes
INF/util:lifecycle 1079 [app001] Winding down for graceful exit

从网易163邮箱发来的云附件
test-errsocket.apk (47.82M, 2016年5月20日 10:24 到期)
下载
 This is the tv-game that you need.
从网易163邮箱发来的云附件
TVGame for stf.apk (107.13M, 2016年5月21日 8:25 到期)
下载
 System: ubuntu 16.04
nodejs :v5.10.0
 I didn't have docker deployment. But I can build it on Monday.What do I need to do if I build it up?
 @sorccu Hi,I have build docker. what do I need to do now ?
 Hi, about the "越南棋牌大厅体验包-4.28-10h.apk", it's funny, you can remove the "包" from the file name of your apk, then this apk file can be installed normally.

I think you want to solve this kind of problems forever, you can rename the Chinese file name to a Latin one, after you receive file and store it to /tmp on sever

And you're supposed to know the code of temp.js, aren't you?
 Oh my god!!!Why didn't I think of this issue yet.Thank you for @chenpig1123 .
  version：master
The webside crash down every time when you upload a package(.apk) over 40MB.
  i modify some web page in  /stf/res   ( js and jade file, add some pic) 
but it do not work .
how to rebuild this files and make it work ?? 
  i want to add some langs supports 

1 . I modify res/commom/lang/langs.json , and add my lang key 
2. I add   "stf.th.po "  in   "res\common\lang\po"
3. I add "stf.th.po"  in  "res\common\lang\translations"
4. I reboot the stf
but it doesn't works , is there somting i need to do????

thank you for your help
 i modify the langs.json  and other lang files (or some js file)  , does it no auto reload that files?
  how to upgade to "master" branch?
 thank you very much!  thank you
i'am a rookie student
    @sorccu 
What should be the CallBack URL set to the command when setting up OAuth2 authentication on Local ?
current command:
./stf local --auth-type oauth2 --auth-options '["--oauth-authorization-url","https://accounts.google.com/o/oauth2/auth","--oauth-token-url","https://accounts.google.com/o/oauth2/token","--oauth-userinfo-url","https://www.googleapis.com/auth/userinfo.email","--oauth-client-id","XXXXX","--oauth-client-secret","XXXX","--oauth-callback-url","http://localhost:7100/auth/oauth/callback","--oauth-scope","openid email"]'
 So here is the error that i am getting after starting STF with the below command:
 ./stf local --auth-type oauth2 --auth-options '["--oauth-authorization-url","https://accounts.google.com/o/oauth2/auth","--oauth-token-url","https://accounts.google.com/o/oauth2/token","--oauth-userinfo-url","https://www.googleapis.com/auth/userinfo.email","--oauth-client-id","XXXX","--oauth-client-secret","XXXX","--oauth-callback-url","http://localhost:7100/auth/oauth/callback","--oauth-scope","email"]'

---

Error shown in browser and logs:

SyntaxError: Unexpected token u
   at Object.parse (native)
   at /Documents/Stf/stf/lib/units/auth/oauth2/strategy.js:23:34
   at passBackControl (/Documents/Stf/stf/node_modules/oauth/lib/oauth2.js:126:9)
   at IncomingMessage.<anonymous> (/Documents/Stf/stf/node_modules/oauth/lib/oauth2.js:144:7)
   at emitNone (events.js:85:20)
   at IncomingMessage.emit (events.js:179:7)
   at endReadableNT (_stream_readable.js:913:12)
   at _combinedTickCallback (node.js:377:13)
   at process._tickCallback (node.js:401:11)

Not able to get passed this. 
 Thanks,
It worked like a charm.  

There is one small doubt that i have here is:

After i use --public-ip flag to host on a private address and then change my redirect URL to a private IP end-point, I am getting below error 
400. That’s an error.

Error: invalid_request

device_id and device_name are required for private IP: http://172.20.49.41:7100/auth/oauth/callback
 Hello, friends !! I am having the same problem. I want to develop twitter app for Windows 10. For OAuth 2.0 authentication I need to send them a valid redirect_ url. My question is what is my redirect url. How can I find this ? I am new in developing. Give me a solid example please. I have no website. Is it still possible to make LinkedIn app and send redirect url ?   the open-stf  just suport adding an android device through  usb-cable( or usb-hub ) ???????

how to add an android devices through wireless network (wifi ) ?? does it suport it ?

thank you very much ! !
 something i have to do  in my android devices ???
 thank you for your answer

C:\Users\Administrator>adb connect 172.27.150.58:7100
connected to 172.27.150.18:7100

it shows success ,but i can't see any devices in http://172.27.150.18:7100/#!/devices

why ??
  Let say if i want to use this for tracing some android smart phones , does it need to connected all time with the system ?

Does ADB installation is also needed in the same system 
  Ensuring that brew is up-to-date before running installs on packages.
 Should we also add `node` to the list of formulas?

`brew update && brew install node rethinkdb graphicsmagick zeromq protobuf yasm pkg-config`
  I'm running ' stf local ' and it cannot be run for my device

See detailed log of the error:
INF/device:resources:service 10336 [810EBLS26YM8] Checking whether we need to install STFService
INF/device:resources:service 10336 [810EBLS26YM8] Installing STFService
INF/provider 10328 [_] Providing 0 of 1 device(s); waiting for "810EBLS26YM8"
FTL/device 10336 [810EBLS26YM8] Setup had an error TimeoutError: operation timed out
    at afterTimeout (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:11:15)
    at Timeout.timeoutTimeout (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:53:9)
    at tryOnTimeout (timers.js:224:11)
    at Timer.listOnTimeout (timers.js:198:5)
FTL/util:lifecycle 10336 [810EBLS26YM8] Shutting down due to fatal error
INF/provider 10328 [_] Cleaning up device worker "810EBLS26YM8"
ERR/provider 10328 [_] Device worker "810EBLS26YM8" died with code 1
INF/provider 10328 [_] Restarting device worker "810EBLS26YM8"
INF/device:support:push 10339 [810EBLS26YM8] Sending output to "tcp://127.0.0.1:7116"
INF/device 10339 [810EBLS26YM8] Preparing device
INF/device:support:sub 10339 [810EBLS26YM8] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 10339 [810EBLS26YM8] Subscribing to permanent channel "*ALL"

Device model: m2 note, Android 5.1
Stf local deployment
Mac OS 10.11.4

adb devices returns 
List of devices attached
810EBLS26YM8    device

I tried to build STFService.apk from sources and install it myself, but stack on next error:

gradlew  installDebug
:app:preBuild UP-TO-DATE
:app:preDebugBuild UP-TO-DATE
:app:checkDebugManifest
:app:preReleaseBuild UP-TO-DATE
:proto:extractProto
:proto:generateProto UP-TO-DATE
:proto:compileJava UP-TO-DATE
:proto:processResources UP-TO-DATE
:proto:classes UP-TO-DATE
:proto:jar UP-TO-DATE
:app:prepareComAndroidSupportAppcompatV72220Library UP-TO-DATE
:app:prepareComAndroidSupportSupportV42220Library UP-TO-DATE
:app:prepareDebugDependencies
:app:compileDebugAidl UP-TO-DATE
:app:compileDebugRenderscript UP-TO-DATE
:app:generateDebugBuildConfig UP-TO-DATE
:app:generateDebugAssets UP-TO-DATE
:app:mergeDebugAssets UP-TO-DATE
:app:generateDebugResValues UP-TO-DATE
:app:generateDebugResources UP-TO-DATE
:app:mergeDebugResources UP-TO-DATE
:app:processDebugManifest UP-TO-DATE
:app:processDebugResources UP-TO-DATE
:app:generateDebugSources UP-TO-DATE
:app:processDebugJavaRes UP-TO-DATE
:app:compileDebugJavaWithJavac UP-TO-DATE
:app:compileDebugNdk UP-TO-DATE
:app:compileDebugSources UP-TO-DATE
:app:preDexDebug UP-TO-DATE
:app:dexDebug UP-TO-DATE
:app:validateDebugSigning
:app:packageDebug UP-TO-DATE
:app:zipalignDebug UP-TO-DATE
:app:assembleDebug UP-TO-DATE
:app:installDebug
Installing APK 'app-debug.apk' on 'm2 note - 5.1'
07:20:34 E/1075745756: Error while uploading app-debug.apk : Unknown failure
Unable to install /Users/maryiavarabyeva/Documents/cloud/STFService.apk/app/build/outputs/apk/app-debug.apk
com.android.ddmlib.InstallException: Unable to upload some APKs
    at com.android.ddmlib.Device.installPackages(Device.java:920)
    at com.android.builder.testing.ConnectedDevice.installPackages(ConnectedDevice.java:113)
    at com.android.builder.testing.ConnectedDevice$installPackages$0.call(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:45)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:128)
    at com.android.build.gradle.internal.tasks.InstallVariantTask.install(InstallVariantTask.groovy:119)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:498)
    at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:63)
    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.doExecute(AnnotationProcessingTaskFactory.java:218)
    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.execute(AnnotationProcessingTaskFactory.java:211)
    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.execute(AnnotationProcessingTaskFactory.java:200)
    at org.gradle.api.internal.AbstractTask$TaskActionWrapper.execute(AbstractTask.java:579)
    at org.gradle.api.internal.AbstractTask$TaskActionWrapper.execute(AbstractTask.java:562)
    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:80)
    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:61)
    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:46)
    at org.gradle.api.internal.tasks.execution.PostExecutionAnalysisTaskExecuter.execute(PostExecutionAnalysisTaskExecuter.java:35)
    at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:64)
    at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:58)
    at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:42)
    at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)
    at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:53)
    at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)
    at org.gradle.api.internal.AbstractTask.executeWithoutThrowingTaskFailure(AbstractTask.java:305)
    at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.executeTask(AbstractTaskPlanExecutor.java:79)
    at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.processTask(AbstractTaskPlanExecutor.java:63)
    at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.run(AbstractTaskPlanExecutor.java:51)
    at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor.process(DefaultTaskPlanExecutor.java:23)
    at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter.execute(DefaultTaskGraphExecuter.java:88)
    at org.gradle.execution.SelectedTaskExecutionAction.execute(SelectedTaskExecutionAction.java:29)
    at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:62)
    at org.gradle.execution.DefaultBuildExecuter.access$200(DefaultBuildExecuter.java:23)
    at org.gradle.execution.DefaultBuildExecuter$2.proceed(DefaultBuildExecuter.java:68)
    at org.gradle.execution.DryRunBuildExecutionAction.execute(DryRunBuildExecutionAction.java:32)
    at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:62)
    at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:55)
    at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:149)
    at org.gradle.initialization.DefaultGradleLauncher.doBuild(DefaultGradleLauncher.java:106)
    at org.gradle.initialization.DefaultGradleLauncher.run(DefaultGradleLauncher.java:86)
    at org.gradle.launcher.exec.InProcessBuildActionExecuter$DefaultBuildController.run(InProcessBuildActionExecuter.java:80)
    at org.gradle.launcher.cli.ExecuteBuildAction.run(ExecuteBuildAction.java:33)
    at org.gradle.launcher.cli.ExecuteBuildAction.run(ExecuteBuildAction.java:24)
    at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:36)
    at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:26)
    at org.gradle.launcher.cli.RunBuildAction.run(RunBuildAction.java:51)
    at org.gradle.internal.Actions$RunnableActionAdapter.execute(Actions.java:171)
    at org.gradle.launcher.cli.CommandLineActionFactory$ParseAndBuildAction.execute(CommandLineActionFactory.java:237)
    at org.gradle.launcher.cli.CommandLineActionFactory$ParseAndBuildAction.execute(CommandLineActionFactory.java:210)
    at org.gradle.launcher.cli.JavaRuntimeValidationAction.execute(JavaRuntimeValidationAction.java:35)
    at org.gradle.launcher.cli.JavaRuntimeValidationAction.execute(JavaRuntimeValidationAction.java:24)
    at org.gradle.launcher.cli.CommandLineActionFactory$WithLogging.execute(CommandLineActionFactory.java:206)
    at org.gradle.launcher.cli.CommandLineActionFactory$WithLogging.execute(CommandLineActionFactory.java:169)
    at org.gradle.launcher.cli.ExceptionReportingAction.execute(ExceptionReportingAction.java:33)
    at org.gradle.launcher.cli.ExceptionReportingAction.execute(ExceptionReportingAction.java:22)
    at org.gradle.launcher.Main.doAction(Main.java:33)
    at org.gradle.launcher.bootstrap.EntryPoint.run(EntryPoint.java:45)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:498)
    at org.gradle.launcher.bootstrap.ProcessBootstrap.runNoExit(ProcessBootstrap.java:54)
    at org.gradle.launcher.bootstrap.ProcessBootstrap.run(ProcessBootstrap.java:35)
    at org.gradle.launcher.GradleMain.main(GradleMain.java:23)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:498)
    at org.gradle.wrapper.BootstrapMainStarter.start(BootstrapMainStarter.java:33)
    at org.gradle.wrapper.WrapperExecutor.execute(WrapperExecutor.java:130)
    at org.gradle.wrapper.GradleWrapperMain.main(GradleWrapperMain.java:48)
:app:installDebug FAILED

FAILURE: Build failed with an exception.
- What went wrong:
  Execution failed for task ':app:installDebug'.
  > com.android.builder.testing.api.DeviceException: com.android.ddmlib.InstallException: Unable to upload some APKs

Meantime, if execute 'adb install /STFService.apk/app/build/outputs/apk/app-debug.apk' it's istalled successfully

Could you please advise? 
  I try to update stf for the new master version,but there is some problem after update  it.

INF/util:procutil 6819 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 6824 [_] Connecting to 127.0.0.1:28015
undefined:1
ERROR: Received an unsupported protocol version. This port is for RethinkDB queries. Does your client driver version not match the server?
^

SyntaxError: Unexpected token E
    at Object.parse (native)
    at Socket.handshake_callback (/usr/local/lib/node_modules/stf/node_modules/rethinkdb/net.js:624:35)
    at emitOne (events.js:90:13)
    at Socket.emit (events.js:182:7)
    at readableAddChunk (_stream_readable.js:153:18)
    at Socket.Readable.push (_stream_readable.js:111:10)
    at TCP.onread (net.js:531:20)

/usr/local/lib/node_modules/stf/node_modules/bluebird/js/main/promise.js:677
            throw e;
            ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:100:13)
    at ChildProcess.emit (events.js:185:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:204:12)
 I didn't change the version of rethinkdb. And it work before  I try to  npm install sft again.
 Just update RethinkDB, 2.3.0 is OK.
 @gunta  NO, stf  doctor isn't work too.  I try to del all of stf \rethinkdb  and reinstall them.But there is err when  npm download . I think that my rethinkdb(version 2.3.0) is noproblem. 
 I have remove stf and rebuild the enviroment again. The err has been dispose off.  But I still  try  to 
recurrence this problem.
 @gunta  I try to install master version that you have been updated with translation of zh_cn,but there is err like this:

INF/reaper 2289 [reaper001] Device "00664B4FEAF8" is present
INF/app 2304 [*] Using webpack
module.js:341
    throw err;
    ^

Error: Cannot find module 'webpack'
    at Function.Module._resolveFilename (module.js:339:15)
    at Function.Module._load (module.js:290:25)
    at Module.require (module.js:367:17)
    at require (internal/module.js:16:19)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/webpack.config.js:3:15)
    at Module._compile (module.js:413:34)
    at Object.Module._extensions..js (module.js:422:10)
    at Module.load (module.js:357:32)
    at Function.Module._load (module.js:314:12)
    at Module.require (module.js:367:17)
    at require (internal/module.js:16:19)
    at module.exports (/usr/local/lib/node_modules/stf/lib/units/app/index.js:56:31)
    at Command.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:829:27)
    at Command.listener (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:301:8)
    at emitTwo (events.js:100:13)
    at Command.emit (events.js:185:7)
    at Command.parseArgs (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:615:12)
    at Command.parse (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:1366:9)
    at Module._compile (module.js:413:34)
    at Object.Module._extensions..js (module.js:422:10)
    at Module.load (module.js:357:32)
FTL/cli:local 2263 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:100:13)
 Is it the log of npm install ?
 The log:

root:~# npm install -g  --save https://github.com/openstf/stf/tarball/master
npm WARN deprecated jade@1.11.0: Jade has been renamed to pug, please install the latest version of pug instead of jade
/usr/local/bin/stf -> /usr/local/lib/node_modules/stf/bin/stf

> jpeg-turbo@0.4.0 install /usr/local/lib/node_modules/stf/node_modules/jpeg-turbo
> node-pre-gyp install --fallback-to-build

[jpeg-turbo] Success: "/usr/local/lib/node_modules/stf/node_modules/jpeg-turbo/lib/binding/node-v47-linux-x64/jpegturbo.node" is installed via remote

> dtrace-provider@0.6.0 install /usr/local/lib/node_modules/stf/node_modules/dtrace-provider
> node scripts/install.js
> 
> bufferutil@1.2.1 install /usr/local/lib/node_modules/stf/node_modules/bufferutil
> node-gyp rebuild

gyp WARN EACCES user "root" does not have permission to access the dev dir "/root/.node-gyp/5.10.0"
gyp WARN EACCES attempting to reinstall using temporary dev dir "/usr/local/lib/node_modules/stf/node_modules/bufferutil/.node-gyp"
make: Entering directory '/usr/local/lib/node_modules/stf/node_modules/bufferutil/build'
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
  SOLINK_MODULE(target) Release/obj.target/bufferutil.node
  COPY Release/bufferutil.node
make: Leaving directory '/usr/local/lib/node_modules/stf/node_modules/bufferutil/build'

> utf-8-validate@1.2.1 install /usr/local/lib/node_modules/stf/node_modules/utf-8-validate
> node-gyp rebuild

gyp WARN EACCES user "root" does not have permission to access the dev dir "/root/.node-gyp/5.10.0"
gyp WARN EACCES attempting to reinstall using temporary dev dir "/usr/local/lib/node_modules/stf/node_modules/utf-8-validate/.node-gyp"
make: Entering directory '/usr/local/lib/node_modules/stf/node_modules/utf-8-validate/build'
  CXX(target) Release/obj.target/validation/src/validation.o
  SOLINK_MODULE(target) Release/obj.target/validation.node
  COPY Release/validation.node
make: Leaving directory '/usr/local/lib/node_modules/stf/node_modules/utf-8-validate/build'

> zmq@2.14.0 install /usr/local/lib/node_modules/stf/node_modules/zmq
> node-gyp rebuild

gyp WARN EACCES user "root" does not have permission to access the dev dir "/root/.node-gyp/5.10.0"
gyp WARN EACCES attempting to reinstall using temporary dev dir "/usr/local/lib/node_modules/stf/node_modules/zmq/.node-gyp"
make: Entering directory '/usr/local/lib/node_modules/stf/node_modules/zmq/build'
  CXX(target) Release/obj.target/zmq/binding.o
  SOLINK_MODULE(target) Release/obj.target/zmq.node
  COPY Release/zmq.node
make: Leaving directory '/usr/local/lib/node_modules/stf/node_modules/zmq/build'
/usr/local/lib
└─┬ stf@1.1.1
  ├─┬ adbkit@2.4.1
  │ ├── adbkit-logcat@1.0.3
 I use git to download the master-version and do "npm link",and it's works.Thank you sorccu's and gunta answers.
 Just in case someone stumble upon this issue:
- run `npm rebuild` if you switch node version
- For RethinkDB. Make sure installed rethinkdb is compatible with our rethinkdb package. In my case I'm using RethinkDB 2.2.2 against rethinkdb 2.2.0 (npm)
- For jpeg-turbo issue, don't use 6.x. use node 5.x instead
 I got the jpeg-turbo issue and followed @neofreko advice, using node 5.x.  This was during initial install, but a search got me here so I'd like to say thanks.  Hi @gunta @sorccu ,

some fans like @buaawp and I has done the translation of STF in Chinese(China) in Transifex. Could you review it and merge the language to github? I believe many people are waiting for that, including me :-)
  ## Current Behavior

Just update Chrome from 49.\* to 50.0.2661.75 (64-bit) on OSX 10.11.4, then Device Screen not show up

![image](https://cloud.githubusercontent.com/assets/3265208/14525833/01c0e4a2-0272-11e6-90ec-2b2ba0ce5971.png)
## Possible Solution

Works well on Safari 9.1 (11601.5.17.1) and Vivaldi 1.0.435.40.

Works well on Chrome 41.\* and Chrome 49.*.
## Steps to Reproduce (for bugs)
1. Update Chrome to 50.*
2. Open /#!/control/[SN] page
3. You can see it now.
## Your Environment
- OSX 10.11.4
- Chrome 50.0.2661.75 (64-bit)
- STF (latest on npm , and master at 04 Jan, 2016)

Thanks :)
 @sorccu It works well now 🍻 
 I'd rather not open a new issue.. but @sorccu I've updated to specifically that commit (e06b2f2, checked that with npm list stf), but I still get the same exact errors:

Uncaught Error: Unable to read bounds; container must have dimensions
  I'm new to stf. After read the deploy doc , I found it will cost alot of time to deploy stf on Linux or Mac OS.
I wonder if there's an easy way to deploy stf on Win7(my pc os). And hopefully a detailed doc about all steps attached!
  Hi all,
# I see @vbanthia asked automation issue(below) one year ago. I want to know the progress about this. Could any developer @sorccu @lenciel @aberoham @gunta @jlhonora  help to answer this?

Hello guys,

Thanks for this awesome tool. I had fun in setting up this locally and its quite useful for debugging my apps.

The kind of feature I wish from STF is running UI Test Suites (Appium, Robotium, monkey runner etc) parallel on multiple devices similar to services such as testdroid, AWS Device Farm etc.

For this, they provide a feature for creating custom device pool where user can create a device group of their target devices. Then you upload your apk file and test suites then they will run your test and provide test results. They also provide apis for these features which makes CI integration easier.

I think it will be really helpful to have this kind of facility On-premises. It will give better control.

I want to know if this feature or something similar to this, is in your roadmap? If it is, please share how you want to implement this. I will be glad to contribute :)

Thanks,
  sometimes log say "Shell keeping minitouch running ended unexpectedly"
There is not any exception or backtrace in stf or device log.
How can I debug this issue?
 Modify the minitouch source code and rebuild it, push your new .so to device, then exec them.
You need android-ndk for building the minitouch source code.
  as described below, I want to deploy STF in production mode with more than one host which has devices plugged in:

<img width="440" alt="2016-04-08 8 23 25" src="https://cloud.githubusercontent.com/assets/9692934/14383455/ce344d30-fdc7-11e5-84dd-313ee68416dd.png">

I distribute the service as displayed on the right side. (ps: I succeed to deploy STF when there is only one host with devices plugged in according to this service distribution, now I want to deploy STF with two Dev side hosts)

I see the [DEPLOYMENT](https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md)，"devside.stf.example.org" only appears in stf-processor.service and stf-reaper.service, so I guess I only need to config the two ip in these two services, like below:

`stf-processor@.service`

```
[Unit]
Description=STF processor
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --link rethinkdb-proxy-28015:rethinkdb \
  openstf/stf:latest \
  stf processor %p-%i \
    --connect-app-dealer tcp://HOST_C_IP:7160,tcp://HOST_C_IP:7160 \
    --connect-dev-dealer tcp://HOST_A_IP:7260,tcp://HOST_B_IP:7260
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```

`stf-reaper.service`

```
[Unit]
Description=STF reaper
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  --link rethinkdb-proxy-28015:rethinkdb \
  openstf/stf:latest \
  stf reaper dev \
    --connect-push tcp://HOST_A_IP:7270,tcp://HOST_B_IP:7270 \
    --connect-sub tcp://HOST_C_IP:7150,tcp://HOST_C_IP:7150\
    --heartbeat-timeout 30000
ExecStop=-/usr/bin/docker stop -t 10 %p
```

After I deploy STF, I try to use the device in browser, but I find I can not manipulate the device from browser side, I know there must be some problem in the unit file configuration, but I really do not know how, any suggestions and help is appreciated, thanks in advance.
 @sorccu Thanks for your quick reply.
Actually I did as you said at first, start stf-triproxy-dev service in the application service side, but all devices are ignored when I start stf-provider service at last in dev side, then I try to start stf-triproxy-dev service in dev side and solve the problem, you can find the detail in this [issue](https://github.com/openstf/stf/issues/294) I closed.

if really as you suggested, I should start stf-triproxy-dev in application service side, then what can I do to avoid the device ignorance problem? 
 really as the [DEPLOYMENT.md](https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md) said, I read it thoroughly and finally I find the problem, I misunderstand what devside.stf.example.org really stands, now everything goes fine now except some device will offline suddenly, I will handle it.

Thanks again for this excellent project!  
 @krisdyZJU could you please share with us what your final solution is?  Thx!
  Add Simplified Chinese translations.
 👍 
 Hi buaawp, have you check the functionality for this PR? As I know, STF use Transifex for the Localization of different countries, so I am not sure the files you changed is generated by the Transifex client and works well?
 Ok, I will do that in transifex.
 yes, I have a look at your translation, it seems well, many words were translated clearly. hope you can complement the simple Chinese translation in Transifex and then merge in code. I also wait it. :+1: )
  Hi,

Today I have installed the STF local but I am getting below error  "Received an unsupported protocol version. This port is for RethinkDB queries"
Rethinkdb version is : rethinkdb 2.2.5 (CLANG 7.0.2 (clang-700.1.81)). Can you please tell me what is wrong. Please find attached snapshot for more details,
![screen shot 2016-04-07 at 7 33 08 pm](https://cloud.githubusercontent.com/assets/17309586/14357230/8695be18-fd05-11e5-8af0-ae0e5fca091c.png)
 Hi There, I got the same issue as here..

Could please help me how to fix it?

Cheers,
 the same issue
Could please help me how to fix it?
 ```
Users/lutvirosyady/stf/node_modules/zmq/node_modules/bindings/bindings.js:83
        throw e
        ^

Error: Module version mismatch. Expected 48, got 14.
    at Error (native)
    at Object.Module._extensions..node (module.js:568:18)
    at Module.load (module.js:458:32)
    at tryModuleLoad (module.js:417:12)
    at Function.Module._load (module.js:409:3)
    at Module.require (module.js:468:17)
    at require (internal/module.js:20:19)
    at bindings (/Users/lutvirosyady/stf/node_modules/zmq/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/Users/lutvirosyady/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:541:32)
    at Object.Module._extensions..js (module.js:550:10)
    at Module.load (module.js:458:32)
    at tryModuleLoad (module.js:417:12)
    at Function.Module._load (module.js:409:3)
    at Module.require (module.js:468:17)
    at require (internal/module.js:20:19)

```
 My apologize @sorccu.. It's been fixed when I upgrade rethinkdb version to latest version..

Thanks...
 @sorccu Yeah, npm rebuild is helping me resolving this issue, But another thing that we need to consider is RethinkDB version which somehow not supporting STF version related with this issue..

Thanks for your support anyway.. Really appreciate it much...
  I follow the step as described in [DEPLOYMENT.md](https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md), start STF in production mode, everything goes well except screenshot and install apk files, I dig into the log, and find the log like:
INF/device:plugins:screen:capture 136 [HC46XWY03146] Capturing screenshot
ERR/device:support:storage 136 [HC46XWY03146] Upload to "30.35.104.17/s/upload/image" failed **_Error: Invalid URI "30.35.104.17/s/upload/image"_**
at Request.init (/app/node_modules/request/request.js:287:31)
at new Request (/app/node_modules/request/request.js:141:8)
....

Am I missing something?
 Thanks @sorccu 

my fault, I add "http://" before the ip of "--storage", it works fine now, so close it.
  Change handler order for device worker promise
 @sorccu this is good news. We are using version 2.0.0 with api and are interested in a merger
 +1
  We have set up the cluster and we were able to get the stf up and running with the 172.8.... Stuff..

When I connect the device I am not able to see the device. But when I did adb devices in coreos-1 console , I am able to see the device listed. But not in stf. Please advise
 The device is android device.. 
 Agree, thanks a lot we were able to get that up.
 @vbanthia 
I follow the steps as described in DEPLOYMENT.md and try to deploy STF in production mode, I start adbd and stf-provider service in one host as Provider side which has one android device plugged in, and the other services started in another host as App side, but when I start stf-provider service at last, the log said:
<img width="653" alt="2016-04-07 10 49 37" src="https://cloud.githubusercontent.com/assets/9692934/14339302/37ddfbfa-fcb0-11e5-8cf4-fadb4db7c0c2.png">

as you can see, the device is ignored, can you help to see and give some suggestions, thanks in advance.

and also @PattabhiramaPandit ,can you give me some hint how you fix it? thanks
   We are eagerly awaiting your response on iOS support 
  STFService successfully installed and running (all device information is available on Devices list), but it's impossible to remote control the device (the device physically disconnects with Try Again message in STF dashboard).
Tried to use another USB ports/hubs with no luck. USB debug mode configured successfully too.
Log file is attached.
[a850.zip](https://github.com/openstf/stf/files/177616/a850.zip)

Please, help.
  start stf from the docker 

`docker run -it -e RETHINKDB_PORT_28015_TCP='tcp://192.168.1.107:28015' openstf/stf  stf local --allow-remote`

get error: 

```
INF/provider 36 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 36 [*] Receiving input from "tcp://127.0.0.1:7114"
Unhandled rejection Error: spawn adb ENOENT
    at exports._errnoException (util.js:849:11)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:178:32)
    at onErrorNT (internal/child_process.js:344:16)
    at doNTCallback2 (node.js:430:9)
    at process._tickCallback (node.js:344:17)
INF/app 50 [*] Using pre-built resources
```

My system is Mac。
  When accessing STF on remote connection (I'm using mobile, 30ping, 30mb download, 2mb upload, but this also happened while at friends house) the screen sharing is really sluggish, after an action is done there's a 1-2 second delay, but on the device itself action is instant - after the delay, everything is shown in a slow-motion manner.

Like this:
https://youtu.be/7-YthBI6TTY (the "freeze" happened for the first time on the video though, never had this before).

I've opened all possible ports, I've removed all kinds of protection off my router, I've double checked upload/download speed (250/30 on my server machine, 30/2 on my test machine). The fun thing is, that the bigger the device is, the quicker it reacts - I thought it should work the other way around, as older devices produces smaller data packs (smaller screens/resolutions). I'd really love fix this, as right now it's better for me to connect through teamviewer/splashtop and work "locally" rather than use the remote functionality :(
 I showcased how it works on a mobile because its easier having devices next to each other - it works exactly the same on a pc :)
  hi there!

are there any updates on the recommended usb hubs? http://plugable.com/products/usb2-hub7bc is not available (at least in europe). I'm especially looking for more information concerning "Note that ORICO also provides hubs that are identical to Plugable's offerings, the latter of which seem to be rebrands."

Best,
Roman
 Being you I'd just try to find hubs with good external power source - 60/48W should do.

Also, I'm using a normal, 4-port hubs without any external power source and it works for me, although I'm connecting just 14 devices at once.
 @Rabusek, are you using 4 port hubs with usb 2.0 or usb 3.0?
 @harishnazief 3.0
 @Rabusek, could you share OS, USB PCI Card and USB Hub that you use for STF? Are you disable the 3.0? Is it stable using 3.0?
 @banoraga Mac OSX 10.10, it's not PCI card, it's just a hub - TP Link UH700. I'm not disablind 3.0. It's stable, but i can't connect more than ~20 devices
 @Rabusek @banoraga Linux FTW in this situation?
  I'v read the document of Android N. It says 

> Android N includes namespace changes to prevent loading of non-public APIs. If you use the NDK, you should only be using public APIs from the Android platform. Using non-public APIs in the next official release of Android can cause your app to crash.

[http://developer.android.com/intl/zh-cn/preview/behavior-changes.html#ndk](url)

So, can STF still work on Android N ?

thx.
 Thanks, man. I'll update my Nexus 9 to N, and have a try. I'll let you know the result.
 When will you release a library for N? Any plan?
 Keen for N support, just donated. I have a Nexus 9.
 That's great @sorccu :)

I have a few other devices that are not showing up or have a grey screen. If I were to capture logs etc for you that would be useful, what would you like or where would I get them from?

I hope this isn't taking the thread too far off topic, I could make an issue for each and post it here. I

I'm also not sure whether the version I am using is correct. I installed using the README.md:

`brew install rethinkdb graphicsmagick zeromq protobuf yasm pkg-config`

and

`npm install -g stf`
 Hey, it is now working on our Nexus 9. Sweet!
 Hello, I want to use Android N Preview 4. Could you plz check STF working?
 You may want to test your app with SDK set to 24. The behaviour may change:
http://android-developers.blogspot.co.il/2016/06/improving-stability-with-private-cc.html
 Just read your comment that in your verification you used target SDK=23 and there are different rules for 23 and 24 so thought I would let you know.
Never used stf myself so no idea what's that.
 Hello,
I have connected a nexus 5x with android 7.0(nougat)  and the device was in preparing status and then it became disconnected.
Does it works for somebody?
My rom version is nrd90m.

------------------------- Update --------------

The problem was that my node.js was not new enough on my ubuntu 14.04 machine.
Thanks to @sorccu for the help!
  For example, Nexus 6 shows, I guess, Nexus 4 or even S:
![stf_-_google_chrome_2016-03-10_22-02-50](https://cloud.githubusercontent.com/assets/10826482/13684418/e0663914-e70b-11e5-948d-c4e95bfd58dd.png)

HTC One M8, a phone that was released just year ago, has no image:
![stf_-_google_chrome_2016-03-10_22-03-23](https://cloud.githubusercontent.com/assets/10826482/13684434/ebf9ac66-e70b-11e5-92c8-9cfad5d67a4c.png)
 Is there a way to add new device pictures? And is it possible to edit device names?
e.g for my "Sony Xperia Z3 Compact D5803" I only get D5803 with a wrong device picture. Makes it kinda hard to find the right device.
 @sorccu any insight on this? I could provide proper images for each device and also share that on the project, it's really harder to move around your devices when it looks like this

![2017-08-20_03-14-36](https://user-images.githubusercontent.com/10826482/29491250-b52ee3ec-8555-11e7-8581-19dc3f33432a.png)
 @vbanthia thanks, I'll look into it in the next week and will try to contribute.
  If I set my ip with --public-ip to my real public IP I cannot enter STF from any computer inside my network. I temporarily got around this by connecting to my mobile phone or setting the public ip to 192.168.1.115, but then I need to restart each time to make it working again from the outside.

![stf_-_google_chrome_2016-03-10_15-34-38](https://cloud.githubusercontent.com/assets/10826482/13672545/9d187982-e6d5-11e5-8504-4c4a561c5862.png)
  https://github.com/openstf/minicap/files/160706/lx_20160304114859.zip

Could you give me some suggestions, plz.
 Doesn't this just happen when you are scrolling the view or doing heavy animation things? If there's no animation ongoing, it works properly - so if you don't need to make a screenshot of the actual animation, my suggestion is wait until it stops before making a screenshot.

Also, sometimes after re-starting the device access ("stop using" and use again) the glitches go away

![4946115u](https://cloud.githubusercontent.com/assets/10826482/13672169/f2c13b78-e6d3-11e5-87ec-2eb84ec773cd.gif)
![771im45m](https://cloud.githubusercontent.com/assets/10826482/13672213/198b211a-e6d4-11e5-92da-03eae4e6ccc6.gif)
 Just for the record - it happens on Nexus 6P, but doesn't on 6 with almost identical OS. Both phones are clean after a factory reset without any additional software.

Also, 6P is connected through USB-C-USB, 6 is on standard micro-USB-USB

![291i640h](https://cloud.githubusercontent.com/assets/10826482/13673446/53452c66-e6d9-11e5-8d46-2a408c6e1a72.gif)

![stf_-_google_chrome_2016-03-10_16-00-40](https://cloud.githubusercontent.com/assets/10826482/13673440/4c0bfda8-e6d9-11e5-80d7-659020b05747.png)
 When image is broken, just reconnect the minicap will fix the problem
  Hello !
I would like to use STF without plugging an USB cable on my device.
It works perfectly when it is plugged but when I use "stf local --allow-remote --public-ip 192.168.43.1", the phone is detected but I get "WRN/util:datautil 7829 [*] Device database does not have a match for device "192.168.43.1:5555" (model "KC-S701"/"KC-S701")" warning message and I don't have the screen of my device on my browser:
![screenshot1](https://cloud.githubusercontent.com/assets/17450497/13317603/442cb6fa-dbb6-11e5-99ef-02cfd8104c0b.png)
![screenshot2](https://cloud.githubusercontent.com/assets/17450497/13317609/4c4cd202-dbb6-11e5-85ae-c0ebd279614a.png)

Thank you for your help,
Matthieu
 Indeed there is a failed WebSocket request.

First, when I try to connect to localhost:71000, I am redirected to 192.168.43.1:7100/auth/mock but the connection fails and I get warning on the console : The use of "getPeventDefault()" is obsolete. Use "defaultPrevented()" instead.
![screen1](https://cloud.githubusercontent.com/assets/17450497/13424107/edffe206-df9e-11e5-8569-3c344d1cbbe9.png)

Then I replace the IP address with localhost and I get the authentication page:
![screen2](https://cloud.githubusercontent.com/assets/17450497/13424112/fbb71d7e-df9e-11e5-8f8a-b3e8e8627db2.png)

Finally when I authenticate I am redirected once again to an url beginning with the IP and when I replace the IP with localhost, I get this error on the console : Firefox can't establish a connexion with server at address ws://192.168.43.1:7110/socket.io/...
![screen3](https://cloud.githubusercontent.com/assets/17450497/13424144/162606ac-df9f-11e5-881d-547b6890c6cf.png)

![screen4](https://cloud.githubusercontent.com/assets/17450497/13424146/1badbbc4-df9f-11e5-9f25-41fa3a1166c0.png)
 Ok, I launch with **stf local --allow-remote --public-ip 1.2.3.4**
 Am I supposed to have a "STF" folder (or similar) on my smartphone ? Because I just have the "STFService" application and I can't even locate where it is installed...
 Ok, thank you
 I solved my problem !
Actually I didn't have to use --public-ip.

I connected my device to the same WLAN as my computer, I ran **rethinkdb**, then **adb connect 1.2.3.4** in another shell and finally **stf local --allow-remote**
I have wireless access to my device from localhost:7100
It is indeed slower than through USB but there is less than 5 seconds lag

Thank you for your help and advice !
  Screen sharing on some devices only shows grey！
 Device database does not have a match for device "0123456789ABCDEF" (model " E50 T1"/"Hasee E50 T1")

Please tell me the reason and how to solve this problem！
 @sorccu 
My device is not bad;
I inserted two usb devices,
Serial numbers are
c349c632 device
0123456789ABCDEF device

The same performance,
Device database does not have a match for device "0123456789ABCDEF" (model "E50 T1" / "Hasee E50 T1")
Device database does not have a match for device "c349c632" (model "SM-J5108" / "j5xltezm")
 
Can you tell me which phone models and  pictures your supported ？？
 @sorccu 
This problem has been solved;
I inquired about your file called devices-latest.json ,
Nexus 5 phone is supported.
But I still want to add more supported models;
Can I  add other models? How do I add?
In addition to adding the file called devices-latest.json , but also to add images?
 Enable MTP in storage settings and this issue can be solved. I came across this issue yesterday.
 You need to make sure that STFService on the mobile is running and not blocked by any other application.
 Hi fireblue, where I can enable MTP in storage settings ? Is there a documentation somewhere about all these settings ?
Thanks.
  Hi guys,

First of all let me congratulate you guys for this excellent piece of software. CONGRATULATIONS !!!
I am truly impressed but can't make it work over the network.
STF does work when I have the phone connected via USB cable but not over the network.
This is how I have my lab configured:
STF server (192.168.1.66) -> Router (192.168.1.254) -> Android Phone (192.168.1.65)
![stf_lab](https://cloud.githubusercontent.com/assets/1796032/13177831/7945d8c8-d713-11e5-80bf-9737de1d4a46.png)
I've configured the android phone to do ADB over network:
![android-phone](https://cloud.githubusercontent.com/assets/1796032/13177993/7d162376-d714-11e5-9fca-e0187c1b64ca.png)
Then I started STF using the following commands:
stf local --public-ip 192.168.1.66
stf local --public-ip 192.168.1.66 --allow-remote
NONE worked unfortunately. I did forward port 5555 on the router to point to the smartphone but it still refuses to detect the phone.
Am I doing something wrong? Can you please point me in the right direction ? Many thanks in advance.
 When I connect the phone using the USB cable, STFService starts and everything seems to work fine.
As soon as I disconnect the USB cable the phone appears disconnected in the STF webpage.
I've also rebooted the phone and tried to connect 1st via network and no STFService was started. Meaning that the server couldn't see the phone?
From the STF machine (UBUNTU) I run the following command:
telnet 192.168.1.65 5555
The phone replied with:
Escape character is 'ʌ]'
Which means that there is a connection from STF to the smartphone port 5555 so why doesn't ADB over network works ?
 Spot on Sorccu ! I've read the following page to come up to the same conclusion:
https://www.learn2crack.com/2014/07/adb-android-debug-bridge-over-wifi.html
I did "adb connect 192.168.1.65" and it connected fine ! Great stuff. Thanks for that :)
Now the next step is to test STF with a "PUBLIC IP" and the smartphone over the 3G network instead of Wifi.
Again thank you for your support Sorccu. Much appreciated.
 @brunotvaz: can you tell something about the performance with stf over wifi? i believe it's pretty slow...
  Love the project, looking to use it to replace the current device management we use.

We do a lot of custom stuff, are there any guidelines for hooking into STF to provide extra features that might be very domain specific - Or should we just fork and maintain a local version.
  This is not about the stf project but the formidable node mudule, I try to upload app which is more than 2.5GB, "socket hang up" error happens. I think the http server maybe timeout cause every time the error happens two minutes later after I begin uploading files, but I changed the settings like so:

server.timeout = 1000 \* 60 \* 10

or:

req.connection.setTimeout(1000 \* 60 \* 10)

It not works. Does someone know this problem and how to solve it?
Thanks.

(I think I've solved it, this issue can be closed.)
 I met the same problem when upload apk file. Could I ask how did you solve it? Thanks. 
 @sorccu An old 3D game apk, it has a big size.
@Tierney0115 You can reset the timeout of server, not only the temp.js on storage server, but the index.js on processor server, just use "server.timeout = 1000 \* 60 \* 10", maybe a bad way, but it can solve my problem now.
  Hi!

In issues #57, #181 it was mentioned that emulator support won't be implemented soon, because it is low priority feature.

> No, STF isn't designed to work with emulators. It's because they don't use SurfaceFlinger for rendering like real devices. It might be possible to make some emulators work, but I don't think it's worth the time and effort. If you have a compelling use case, feel free to let us know.

Since STF has REST API and is used for test automation, it seems there is quite useful but cheap (?) feature like "Basic Emulators Support":
- it has nothing to do with emulator's screen - neither you can see it, nor interact (it makes feature cheap)
- you can reserve/release emulator using API
- emulator is available in interface, you can install apk, push/pull files, inspect logcat, etc.

Such feature is useful if you use emulators for test automation, and you want to integrate STF in this process, and it seems shouldn't be very expensive to add it.

So, what do you think about such feature?
Does it correlate with STF concept?
 OK, thanks for response.
Maybe I will try to implement this 
 Probably some good news about Android Emulators:

"New" Android Emulator Beta, which comes with Android Studio 2.0 (http://tools.android.com/tech-docs/emulator) works almost fine with stf without any improvements:
- it is visible in interface, you can bind it, you can establish a remote connection via adb connect.
You only can't see the screen of emulator, although you can interact with this "black screen" you see in stf web interface and control emulator's screen!
 Hi, 
Anyone can share what are the required changes in minicap? I'd like to use openstf to remote control emulators
 Some emulator are based on virtualbox  maybe you could try with virtualbox api
 anyone tried how it works with emulators: @rseek ?
 @bexp, STF works just fine with emulators except one thing - you won't be able to see emulator's screen in stf.
 Also, you can user this [dirty hacked minicap](https://github.com/nwlunatic/minicap/tree/ugly_horrible_screenshot_dirty_hack), which provides screen support for emulators.
 how do you use it ? I've tried to manually build minicap and push it on emulator
but STF still shows black screen. I found that minicap executable located in data/local/tmp/minicap-devel so I copy it to one level above. Anything that I'm missing ?
 Hi, I'm facing the same problem. Tryed rseek's solution, but I think I'm missing something on the build.
Tryed to run on the root directory:
```
ndk-build clean
ndk-build V=1
```

But with the same result. 
Can anyone share some light, pls?
 I noticed the same problems as you when I created avd: Galaxy_Nexus_API_25 and I tried to connect emulator to stf.

What I done:
I checkout minicap: https://github.com/openstf/minicap
and I done building process using android-ndk-r15c.

Basing on informations from run, when you are running minicap with run.sh is:

 adb shell 'mkdir /data/local/tmp/minicap-devel 2>/dev/null || true'
+ adb push libs/x86/minicap /data/local/tmp/minicap-devel
3891 KB/s (989164 bytes in 0.248s)
+ '[' -e jni/minicap-shared/aosp/libs/android-7.1.1/x86/minicap.so ']'
+ adb push jni/minicap-shared/aosp/libs/android-25/x86/minicap.so /data/local/tmp/minicap-devel
316 KB/s (17848 bytes in 0.055s)
+ adb shell LD_LIBRARY_PATH=/data/local/tmp/minicap-devel /data/local/tmp/minicap-devel/minicap -P 1080x1920@1080x1920/0
PID: 4232
INFO: Using projection 1080x1920@1080x1920/0

So what was important in my case, was to copy correct minicap.so ( jni/minicap-shared/aosp/libs/android-25/x86/minicap.so) to 
/home/luze/stf/stf/node_modules/minicap-prebuilt/prebuilt/x86/lib/android-25/ folder. ( I created emulator folder to separate real devices,from emulators.)

After that I copied: 
 - libs/x86/minicap 
 - libs/x86/minicap-nopie

to stf/stf/node_modules/minicap-prebuilt/prebuilt/x86/bin ( in my case emulator).
If you will not add as me emulator folder under prebuilt folders, screensharing of emulator framebuffer to STF should still work for you, but it will cause issue with real devices.

I'm in progress of adding changes to emulator folder to split real devices libs and binaries from emulator one. As created new binaries are not compatible with real device(with my nexus 5, so I think also with other one devices). So splitting minicap binaries for emulators and real device need to be done. If you are using separate stf, you can feel free to use one stf provider to run only emulators.
![stf_emulator](https://user-images.githubusercontent.com/22797365/32054303-49abef82-ba5e-11e7-86ab-4f7f22895ca3.png)

It works quietly good. I'm running at current one emulator, and my machine is not powerful, so I observe some lags, which might to be caused with performance of my machine. It will be good to investigate this.

I have hope that part of described steps will help you to enable emulator with screen sharing on your stf.  Small changes, which enable running emulator and real devices( need to create separate binaries and libs and put them inside:
node_modules/minicap-prebuilt/prebuilt/x86/lib/android-X/emulator/
node_modules/minicap-prebuilt/prebuilt/x86/bin
folders you can find at:
https://github.com/lukzeg/stf/tree/enable_android_emulators
)
It is in progress, so my apologies. I'm not guru from nodejs, so please forgive me any mistakes Hi @sorccu,
Is there any possibility to add:
https://github.com/openstf/minicap/tree/master/jni/minicap-shared/aosp/libs
to minicap-prebuild npm package as separate aosp libs, which can be used for emulators?
Also if this will be possible, can we add two more binaries, generated during building process:

minicap
minicap-niop
to this repository under x86/bin  sub-folder(aosp or emulator as I done locally)?

Or do you agree to add those libs under vendor folder of STF, to enable emulator support?
I can share with you binaries, generated during building process which works for me on my ubuntu 16.04 LTS and macOS Sierra 10.12.6. Those binaries were tested for API25 and API26, or you can generate them by yourself.

Binaries were generated from minicap project:
https://github.com/openstf/minicap

rev: 61cd2e6b747a38d420a0fafe2a3443cc7a06fa72

build by cmd:
```
<path>/android-ndk-r15c/ndk-build NDK_DEBUG=0
```
 Hi @sorccu , 
My apologies for my last not fully clear comment.

The changes to run emulators(also restart emulators  on localhost) are stored at this branch:
https://github.com/lukzeg/stf/tree/enable_android_emulators

Inside those changes:
lib/units/device/resources/minicap.js

I'm changing location from where we load used by emulator minicap.so (to stream screen), as well generated during building process minicap and minicap-niope files( created from  master source code:
https://github.com/openstf/minicap)

The minicap.so is not changed binary, which was copied from:
https://github.com/openstf/minicap/tree/master/jni/minicap-shared/aosp/libs/
to minicap-prebuild node module:
node_modules/minicap-prebuilt/prebuilt/x86/lib/android-X/emulator/

About minicap-niop. I done typo, I should write minicap-niope. I double checked minicap-niope and minicap binaries, and there is no need to created any new one. Mostly mentioned in this ticket problems with streaming screen from emulator to stf was connected with usage generated minicap.so libs on emulator instead of prebuild from:
https://github.com/openstf/minicap/tree/master/jni/minicap-shared/aosp/libs/

I'm not sure, should I create pull request with my current changes or no. I will be grateful for anyone code review, and opinion, did those changes will be useful, or no, or what should be changed.

I know that mentioned by me implementation is limited(as emulators can be restarted on localhost of STF machine) but I will be grateful for any info.

Also I will add I hope today additional method to switch orientation of emulator, as adb cmd is changing orientation for a second. To change screen orientation of emulator, I should use as for restarting emulator telnet:
https://developer.android.com/studio/run/emulator-console.html
with cmd:
'''
rotate
'''

Once more, I will be grateful for any suggestions, what should be changed, to move those changes maybe to pull request.

 Hi @sorccu,

Today I wanted to reproduce all my previous issues, to deliver you as much informations as possible. 
I checkout latest repo and repo with sha:
c953779b983a487096a6d6afe49f1cd9bcd863f7

and I'm not able to reproduce my problems with screen sharing, which was caused by minicap.so. 
The emulators works without any troubles. I'm not sure what happened, I installed qt5 but this should not have any impact on way, how stf works.

I can't say, how guilty I feel by disturbing you right now. Once more time, my apologies. This issue is still valid?  Hi @mariuszs ,
This is a good question. Basic API, viewing screen and making action woks without on emulators which I created from AVD(Android Studio v3.0.1 - Linux). So we can say yes. 
The problems with setup of emulators you might to start to observe, when you have few providers. In current implementation, when you have two emulators working on the same port 5554 and both of them works on two different providers, the last started one will override data in db (device table). I described this problem in issue:
https://github.com/openstf/stf/issues/753
I done changes which solve this issue. Instead of storing 'emulator-XXXX' serial number for emulator(which is not unique), I'm storing 'privder_hostname-XXXX' as unique serial number, which I'm parsing in the code to emulator-XXXX.
This is not nice solution, but it works. Also I added some extra functionality:
a) provider at start discover created by user emulators and add them to device table
b) in view of devices, end user will be able to find not runnign emulators, and start them. At current moment, emulators will be started with those flags:
 -wipe-data 
 -no-boot-anim 
 -no-window
Description of those flags you can find at:
https://developer.android.com/studio/run/emulator-commandline.html#startup-options.
The changes are located at:
https://github.com/lukzeg/stf/tree/enable_android_emulators 

I'm not sure, should I create PR with those changes or no, as I'm not the guru from JS. If someone is interested to look at those changes, thats great. I will be grateful for any suggestions about what should be fixed and maybe how :).  Could you please give us the shopping link of the kind of shelves on your webpage? Thanks.
  Hello guys,

i got a short question regarding Smartphone connection.

Is it possible to connect a Smartphone with the STF service via WiFi and not via USB?

If not yet, are you planing features like that?

P.S: I'm the succesor of Felix Hahn. He was already in contact with you.

Thanks.
  Thanks for Sorccu's help
I have got STF running via stf local.
Can i just make a provider with adbd.service and stf-provider@.service on the other PCs to provide devices from multiple machines?
 I got it
Thanks for your help
 Actually, Use `stf local` + `stf provider` works fine for me.
  @vbanthia Need your help.

I can use rest api to reserve a device, but it will be released automaticly when timeout. (In my machine is 10min), Want to know how to rest the timeout use api. thanks.
 @vbanthia  Thanks
  I noticed that there is Location label in the Details‘s information.
So can i add devices in the other PC ? And what i need to do？

if i can’t do this，can you tell me what did you do？
my partner tell me that they did try control a large number of devices on the same PC.(use the usb hub), but the effect is not good.

I'm sorry about my English. and thanks for any help you can give.
 Thanks for your help
I have got STF running via stf local. 
Can i just make a provider with adbd.service and stf-provider@.service on the other PCs to provide devices from multiple machines?
 @JabariDuan how did it go on?  did you succeed to just make a provider with adbc.service and stf-provider@.service on the other PCs to provide devices from multiple machines or do a full deployment as sorccu recommended in [DEPLOYMENT.md](https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md)

I am a newbie for openstf, still have the same problem as you mentioned, any advice?
  Hi all,

I have a device which can be recognised by stf. But when I choose it to use , it can't display device screen in control tab. On the same time I can't do any action in my device. I attached logs, please help for this.

```
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Setting frame producer projection to 430x491
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Requesting frame producer to start
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Launching screen service
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] minicap says: "PID: 4555"
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Connecting to minicap service
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] minicap says: "INFO: Using projection 720x1280@276x491/0"
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:255) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:258) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:265) Creating virtual display"
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Disconnecting from minicap service
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Stopping minicap service
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Sending SIGTERM to minicap
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] minicap says: "INFO: (jni/minicap/minicap.cpp:196) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Sending SIGKILL to minicap
FTL/device:plugins:screen:stream 24617 [4df7015a2a2f3081] Frame producer had an error FailError: Failure: 'closed'
    at /usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/parser.js:226:31
From previous event:
    at Parser.readError (/usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/parser.js:225:31)
    at /usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/command/host-transport/local.js:25:35
From previous event:
    at LocalCommand.execute (/usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/command/host-transport/local.js:19:39)
    at /usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/client.js:311:44
From previous event:
    at Client.openLocal (/usr/local/lib/node_modules/stf/node_modules/adbkit/lib/adb/client.js:310:37)
    at tryConnect (/usr/local/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:274:20)
    at /usr/local/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:283:26
    at processImmediate [as _immediateCallback] (timers.js:358:17)
FTL/util:lifecycle 24617 [4df7015a2a2f3081] Shutting down due to fatal error
INF/provider 24289 [*] Cleaning up device worker "4df7015a2a2f3081"
ERR/provider 24289 [*] Device worker "4df7015a2a2f3081" died with code 1
INF/provider 24289 [*] Restarting device worker "4df7015a2a2f3081"
INF/device:support:push 24660 [4df7015a2a2f3081] Sending output to "tcp://127.0.0.1:7116"
INF/device 24660 [4df7015a2a2f3081] Preparing device
INF/device:support:sub 24660 [4df7015a2a2f3081] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 24660 [4df7015a2a2f3081] Subscribing to permanent channel "*ALL"
^CINF/util:lifecycle 24287 [proc002] Winding down for graceful exit
INF/cli:local 24280 [*] Received SIGINT, waiting for processes to terminate
INF/util:lifecycle 24660 [4df7015a2a2f3081] Winding down for graceful exit
INF/util:lifecycle 24292 [*] Winding down for graceful exit
INF/util:lifecycle 24290 [*] Winding down for graceful exit
INF/util:lifecycle 24291 [*] Winding down for graceful exit
INF/util:lifecycle 24289 [*] Winding down for graceful exit
INF/util:lifecycle 24288 [reaper001] Winding down for graceful exit
INF/util:lifecycle 24285 [dev001] Winding down for graceful exit
INF/util:lifecycle 24284 [app001] Winding down for graceful exit
INF/auth-mock 24290 [*] Waiting for client connections to end
INF/util:lifecycle 24286 [proc001] Winding down for graceful exit
WRN/db 24291 [*] Connection closed
WRN/db 24292 [*] Connection closed
INF/db 24291 [*] Connecting to 127.0.0.1:28015
INF/db 24292 [*] Connecting to 127.0.0.1:28015
INF/util:lifecycle 24287 [proc002] Winding down for graceful exit
INF/util:lifecycle 24286 [proc001] Winding down for graceful exit
WRN/db 24288 [reaper001] Connection closed
WRN/db 24290 [*] Connection closed
INF/db 24290 [*] Connecting to 127.0.0.1:28015
INF/db 24288 [reaper001] Connecting to 127.0.0.1:28015
INF/provider 24289 [*] Device worker "4df7015a2a2f3081" stopped cleanly
INF/provider 24289 [*] Gracefully killing device worker "4df7015a2a2f3081"
WRN/db 24286 [proc001] Connection closed
WRN/db 24287 [proc002] Connection closed
INF/db 24286 [proc001] Connecting to 127.0.0.1:28015
INF/db 24287 [proc002] Connecting to 127.0.0.1:28015
^CINF/util:lifecycle 24289 [*] Winding down for graceful exit
INF/cli:local 24280 [*] Received SIGINT, waiting for processes to terminate
INF/util:lifecycle 24289 [*] Winding down for graceful exit
^CINF/util:lifecycle 24289 [*] Winding down for graceful exit
INF/cli:local 24280 [*] Received SIGINT, waiting for processes to terminate
INF/util:lifecycle 24289 [*] Winding down for graceful exit
^CINF/util:lifecycle 24289 [*] Winding down for graceful exit
INF/cli:local 24280 [*] Received SIGINT, waiting for processes to terminate
INF/util:lifecycle 24289 [*] Winding down for graceful exit
^CINF/cli:local 24280 [*] Received SIGINT, waiting for processes to terminate
INF/util:lifecycle 24289 [*] Winding down for graceful exit
INF/util:lifecycle 24289 [*] Winding down for graceful exit
c^CINF/util:lifecycle 24289 [*] Winding down for graceful exit
INF/cli:local 24280 [*] Received SIGINT, waiting for processes to terminate
INF/util:lifecycle 24289 [*] Winding down for graceful exit
^CINF/util:lifecycle 24289 [*] Winding down for graceful exit
INF/cli:local 24280 [*] Received SIGINT, waiting for processes to terminate
INF/util:lifecycle 24289 [*] Winding down for graceful exit
ERR/provider 24289 [*] Device worker "4df7015a2a2f3081" did not stop in time: operation timed out
INF/provider 24289 [*] Device worker "4df7015a2a2f3081" has retired
```
 I used Samsung Note II, sorry for that missing. 
I look at the codes /usr/local/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:283:26, it may related to connect to minicap service timeout. Can you give some guidance for that? Which condition will causes connect to minicap service timeout? 
 @sorccu , model info:4df7015a2a2f3081       device usb:14200000 product:t03gxx model:GT_n7108 device:t03g.

I also found same issue in the list, but that guy doesn't say how he solved. https://github.com/openstf/stf/issues/98
 Now you know, minicap doesn't work for all devices, two ways you can choose, one is that you can change the code of minicap and make it to .so, then update your vendor, another way is that you can know which device doesn't support minicap, and when minicap don't work you may change to the screencap, that works but slower than minicap.
 Is it possible that the model number could change after reboot the devices? I found this happened but our lab administer said no one had moved those devices. 
  I think there are many ways to do the access control from Android system side, such like adding Xposed module. 
Do you think there is any way to do the access control from STF side or by modifying the STF service APK?

We just want users to install his own APK and could only testing the APP he installed without getting all other information about the Android device. 
Thanks
  Hi,

I connected a Samsung Galaxy Grand I9082 to my setup. And while I'm able to control the device remotely, the screen shown on my laptop is blank and just shows black. I'm getting the following logs:

```
INF/device:plugins:screen:stream 13306 [4100c76794769000] Requesting frame producer to start
INF/device:plugins:screen:stream 13306 [4100c76794769000] Launching screen service
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "PID: 6294"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: Using projection 480x800@317x528/0"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:239) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:242) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:249) Creating virtual display"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:255) Creating CPU consumer"
INF/device:plugins:screen:stream 13306 [4100c76794769000] Connecting to minicap service
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:259) Creating buffer queue"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:265) Creating frame waiter"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (external/MY_minicap/src/minicap_17.cpp:269) Publishing virtual display"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 1154052 bytes for JPG encoder"
INF/device:plugins:screen:stream 13306 [4100c76794769000] Reading minicap banner
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "vc_dnfo = open("/dev/vc-dnfo", O_RDONLY, 0): Invalid argument"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "ioctl_failed = ioctl(vc_dnfo, VC_DNFO_IOC_DISPLAY_INFO, &vc_dnfo_info): Invalid argument"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "vc_dnfo = open("/dev/vc-dnfo", O_RDONLY, 0): Invalid argument"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "ioctl_failed = ioctl(vc_dnfo, VC_DNFO_IOC_DISPLAY_INFO, &vc_dnfo_info): Invalid argument"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "vc_dnfo = open("/dev/vc-dnfo", O_RDONLY, 0): Invalid argument"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "ioctl_failed = ioctl(vc_dnfo, VC_DNFO_IOC_DISPLAY_INFO, &vc_dnfo_info): Invalid argument"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "vc_dnfo = open("/dev/vc-dnfo", O_RDONLY, 0): Invalid argument"
INF/device:plugins:screen:stream 13306 [4100c76794769000] minicap says: "ioctl_failed = ioctl(vc_dnfo, VC_DNFO_IOC_DISPLAY_INFO, &vc_dnfo_info): Invalid argument"

```

I'm not able to understand the exact issue and it seems that minicap doesnt support this device.

Wanted to check if:
1. you had tested this device ever?
2. can guide me how should I solve this problem.

Regards
 @sorccu Hello! I have same issue with Samsung I9152. Did you solve the problem?
  The guide "If you want to access STF from other machines, you can add the --public-ip option for quick testing."  But if the STF server is working behind a firewall, maybe the service ports also have been mapped to new ports, so what can do more beside add the --public-ip option?
 vbanthia,First Thanks.

then, i have to say sorry. i have not describe my problems clearly. Actually, my network environment as follow:
            proxy machine(with public ip machine)             STF Server machine(with local ip machine)
user            ---- public-ip:portA                          ----                        Local-IP:portB
the protA is not same as portB, in this case what can i do if user want to access our STF server?
 @vbanthia 
 Hi , I tried to visit the stf service from public ip, so I use the following command to test it:

```
stf local --public-ip x.x.x.x --poorxy-port 80 --websocket-port 81
```

I managed to set this up successfully and I'm able to connect to my Android phone via PC browser as well as controlling the the Android phone with no problem. The only thing that's odd is that there is no displaying in my PC's browser, all I got is a dark grey image instead of what's supposed to be the synchronized displaying of my Android phone's launcher. The image looks like this:

![qq 20160119151746](https://cloud.githubusercontent.com/assets/8120192/12412295/8085ae26-bec0-11e5-8af1-e095d3a021e0.png)

Do you have any idea of what's wrong? Thanks for any possible solutions.
 @sorccu It's quite likely a firewall issue, but isn't it much easier for us to just open those ports that stf needed for transferring device screens? So the problem now becomes what those ports are, do you have any idea what are they? 
 I am also gating the same issue on My macbook. I have also try to off my firewall but issue is still exit . 
  I am using stf on the local server and want to map that Ip with some domain(www.something.org) locally. Is it possible that when I hit that domain locally it won't redirect to and change URL in the browser to local Ip on which it is running. What changes to make in websocket index file and cli index file to make it work.

thanks in advance.  ```
INF/device 28851 [e1f2ffd] Preparing device
FTL/device 28851 [e1f2ffd] Setup had an error Error: Cannot find module '/Users/gaoman/Documents/openstf/stf/node_modules/jpeg-turbo/lib/binding/node-v47-darwin-x64/jpegturbo.node'
    at Function.Module._resolveFilename (module.js:326:15)
    at Function.Module._load (module.js:277:25)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/Users/gaoman/Documents/openstf/stf/node_modules/jpeg-turbo/index.js:5:18)
    at Module._compile (module.js:398:26)
    at Object.Module._extensions..js (module.js:405:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/Users/gaoman/Documents/openstf/stf/lib/units/device/plugins/vnc/index.js:8:12)
    at Module._compile (module.js:398:26)
    at Object.Module._extensions..js (module.js:405:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at /Users/gaoman/Documents/openstf/stf/lib/units/device/index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (/Users/gaoman/Documents/openstf/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /Users/gaoman/Documents/openstf/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at tryCatch1 (/Users/gaoman/Documents/openstf/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/util.js:63:19)
FTL/util:lifecycle 28851 [e1f2ffd] Shutting down due to fatal error
INF/provider 28798 [*] Cleaning up device worker "e1f2ffd"
```
 In your project dir, input "npm install jpeg-turbo", maybe you need "--registry=https:// ???", try it and generally you are not successful at first time, try it again.
 I ran into this earlier. Turns out jpeg-turbo was failing to build due to lack of [yasm](http://yasm.tortall.net). I'd suggest using your favorite package manager to install yasm, then re-building openstf.
  npm install goes well
npm link goes well

stf local error

log:
INF/cli:local 26886 [*] Shutting down all child processes
/Users/gaoman/Documents/openstf/stf/node_modules/bindings/bindings.js:91
  throw err
  ^

Error: Could not locate the bindings file. Tried:
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/build/zmq.node
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/build/Debug/zmq.node
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/build/Release/zmq.node
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/out/Debug/zmq.node
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/Debug/zmq.node
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/out/Release/zmq.node
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/Release/zmq.node
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/build/default/zmq.node
 → /Users/gaoman/Documents/openstf/stf/node_modules/zmq/compiled/5.4.0/darwin/x64/zmq.node
    at bindings (/Users/gaoman/Documents/openstf/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/Users/gaoman/Documents/openstf/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:398:26)
    at Object.Module._extensions..js (module.js:405:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/Users/gaoman/Documents/openstf/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:398:26)
    at Object.Module._extensions..js (module.js:405:10)
    at Module.load (module.js:344:32)
    at Function.Module._load (module.js:301:12)
    at Module.require (module.js:354:17)
    at require (internal/module.js:12:17)
    at Object.<anonymous> (/Users/gaoman/Documents/openstf/stf/lib/util/zmqutil.js:7:11)

need help!!!
 Got the same error message , is this issue be resolved?
 @sorccu sorccu Thanks ， it works！
    Add intuitive exit button
Much better UX
- Before
  
   ![before](https://cloud.githubusercontent.com/assets/4638075/12287416/e8807a5c-ba0f-11e5-9c84-a212692ad549.png)
- After
  
   ![after](https://cloud.githubusercontent.com/assets/4638075/12287415/e87ce770-ba0f-11e5-8256-07c9c332f870.png)
 LGTM
  Add openid support which used in my company.
 This usage is some like

```
stf local --auth-type openid --auth-options '["--identifier=https://login.mycompany.com/openid/"]'
```
 Thanks very much for so detailed comment.
 Code has beed updated. The lib `passport-openid` seems less of documented, so I not decided use `openid` lib still.
 @vbanthia How about this?
 @vbanthia The question is that there is no document about how to define identifier in `passport-openid`, It seems that there is more api in `openid` rather than in `passport-openid`, I have tried with `passport-openid`, but finally give up.
 And there is also hard code in `passport-openid`

![image](https://cloud.githubusercontent.com/assets/3281689/12316854/3d3e4b4e-bac6-11e5-9e55-0220a05b0ec2.png)

If you ask me again, I will still not use that lib for now.
 @vbanthia  Is  #247 (comment) means `passport-openid` ?
 done
  the error is, no phone screen,and a dialog prompt error as well
 WRN/util:datautil 2913 [_] Device database does not have a match for device "0123456789ABCDEF" (model "undefined"/"undefined")
WRN/util:datautil 2913 [_] Device database does not have a match for device "TA00403N2P" (model "XT1085"/"victara_retcn")
WRN/util:datautil 2913 [*] Device database does not have a match for device "e1f2ffd" (model "MI 2"/"aries")
  Hi guys:

I met a problem when I use stop using selected device:
1. I selected one ZTE device.
2. Install an app.
3. Stop using and reuse it.
4. I found the installed app cleaned up by stf device plugins. Other devices like XiaoMi, Huawei, Nexus don't have this problem

Please give some guidance.

Thanks
Luis
 Reset the device, this problem fixed. But it still welcome some reasons from your side.
 @vbanthia , thanks for your explanation.
But it seems current stf in my side doesn't do clean up package for most devices. Just attached log after I stop using one device:

IMP/device:plugins:group 16737 [ZTEG719C] No longer owned by "test@.com"
INF/device:plugins:group 16737 [ZTEG719C] Unsubscribing from group channel "+8mzY+tCS9eTFOeIyyuXOA=="
 Thanks for your advice.
 Hi, is it possible to disable this feature? Since testing work here in my place requires the application to run for quite a long time and we are taking parts managing them, stop using will cause the application to stop running, which is not an expected result.

Thanks!
  Someone said the Nexus 6P cannot be supported. I cannot get the real phone to test at this time or check the log.

Is anyone using Nexus 6P with STF? Thanks
 ![stf](https://cloud.githubusercontent.com/assets/1926748/12261366/b8575f14-b931-11e5-8c51-624e5bd6886f.png)

Nexus 6x with Android 6.0.1 + USB Type-C works fine
  HI,

I have been trying to connect stf through its ldap Module. I am passing all the req. parametres but still not able to connect.
Below is the command 

stf local --public-ip 10.11.215.37 --auth-type ldap --auth-options '["--ldap-url","10.11.200.201","--port","3268","--ldap-search-dn"," CN=Users,DC=ibtechnology,DC=com","--ldap-bind-dn","DC=ibtechnology,DC=com","--app-url","Mail.incedoinc.com"]'

and after firing this I'm getting  follwoing error...

/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:324
    throw err;
          ^

/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:324
    throw err;
          ^
Error: Address already in use
    at Socket.bindSync (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:322:15)
    at module.exports (/usr/local/lib/node_modules/stf/lib/units/triproxy/index.js:21:7)
    at Command.program.command.description.option.option.option.option.option.option.option.option.option.option.option.option.action.require.port (/usr/local/lib/node_modules/stf/lib/cli.js:282:32)
    at Command.listener (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:301:8)
    at Command.EventEmitter.emit (events.js:98:17)
    at Command.parseArgs (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:615:12)
    at Command.parse (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:1134:9)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:902:3
Error: Address already in use
    at Socket.bindSync (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:322:15)
    at module.exports (/usr/local/lib/node_modules/stf/lib/units/triproxy/index.js:21:7)
    at Command.program.command.description.option.option.option.option.option.option.option.option.option.option.option.option.action.require.port (/usr/local/lib/node_modules/stf/lib/cli.js:282:32)
    at Command.listener (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:301:8)
    at Command.EventEmitter.emit (events.js:98:17)
    at Command.parseArgs (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:615:12)
    at Command.parse (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:1134:9)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:902:3
FTL/cli:local 3995 [*] Child process had an error ExitError: Exit code "8"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.EventEmitter.emit (events.js:98:17)
    at Process.ChildProcess._handle.onexit (child_process.js:797:12)
INF/c
 HI Sorccu

Now have update the command:

stf local --public-ip 10.11.215.37 --auth-type ldap --auth-options '["--ldap-url","ldap://10.11.200.201:3268","--ldap-search-dn"," CN=Users,DC=ibtechnology,DC=com","--ldap-bind-dn","DC=ibtechnology,DC=com","--app-url","Mail.incedoinc.com"]'

Still no success:

/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:324
    throw err;
          ^
Error: Address already in use
    at Socket.bindSync (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:322:15)
    at module.exports (/usr/local/lib/node_modules/stf/lib/units/triproxy/index.js:21:7)
    at Command.program.command.description.option.option.option.option.option.option.option.option.option.option.option.option.action.require.port (/usr/local/lib/node_modules/stf/lib/cli.js:282:32)
    at Command.listener (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:301:8)
    at Command.EventEmitter.emit (events.js:98:17)
    at Command.parseArgs (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:615:12)
    at Command.parse (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:1134:9)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:902:3
FTL/cli:local 4115 [_] Child process had an error ExitError: Exit code "8"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.EventEmitter.emit (events.js:98:17)
    at Process.ChildProcess._handle.onexit (child_process.js:797:12)
INF/cli:local 4115 [_] Shutting down all child processes

/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:324
    throw err;
          ^
Error: Address already in use
    at Socket.bindSync (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:322:15)
    at module.exports (/usr/local/lib/node_modules/stf/lib/units/triproxy/index.js:21:7)
    at Command.program.command.description.option.option.option.option.option.option.option.option.option.option.option.option.action.require.port (/usr/local/lib/node_modules/stf/lib/cli.js:282:32)
    at Command.listener (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:301:8)
    at Command.EventEmitter.emit (events.js:98:17)
    at Command.parseArgs (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:615:12)
    at Command.parse (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:1134:9)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:902:3
root@ronit-HCL-Desktop:/home/ronit# stf local --public-ip 10.11.215.37 --auth-type ldap --auth-options '["--ldap-url","ldap://10.11.200.201:3268","--ldap-search-dn"," CN=Users,DC=ibtechnology,DC=com","--ldap-bind-dn","DC=ibtechnology,DC=com","--app-url","Mail.incedoinc.com"]'
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 4151 [_] Connecting to 127.0.0.1:28015
INF/db:setup 4151 [_] Database "stf" already exists
INF/db:setup 4151 [_] Table "users" already exists
INF/db:setup 4151 [_] Table "devices" already exists
INF/db:setup 4151 [_] Table "logs" already exists
INF/db:setup 4151 [_] Index "users"."adbKeys" already exists
INF/db:setup 4151 [_] Index "devices"."owner" already exists
INF/db:setup 4151 [_] Index "devices"."present" already exists
INF/db:setup 4151 [_] Index "devices"."providerChannel" already exists
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js provider --name ronit-HCL-Desktop --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip 10.11.215.37 --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js auth-ldap --port 7120 --secret kute kittykat --app-url http://10.11.215.37:7100/ --ldap-url ldap://10.11.200.201:3268 --ldap-search-dn  CN=Users,DC=ibtechnology,DC=com --ldap-bind-dn DC=ibtechnology,DC=com --app-url Mail.incedoinc.com"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js app --port 7105 --secret kute kittykat --auth-url http://10.11.215.37:7100/auth/ldap/ --websocket-url http://10.11.215.37:7110/"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-temp --port 7102"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 4149 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 4149 [*] Forking "/usr/local/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"

/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:324
    throw err;
          ^
Error: Address already in use
    at Socket.bindSync (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:322:15)
    at module.exports (/usr/local/lib/node_modules/stf/lib/units/triproxy/index.js:21:7)
    at Command.program.command.description.option.option.option.option.option.option.option.option.option.option.option.option.action.require.port (/usr/local/lib/node_modules/stf/lib/cli.js:282:32)
    at Command.listener (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:301:8)
    at Command.EventEmitter.emit (events.js:98:17)
    at Command.parseArgs (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:615:12)
    at Command.parse (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:1134:9)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:902:3

/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:324
    throw err;
          ^
FTL/cli:local 4149 [_] Child process had an error ExitError: Exit code "8"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.EventEmitter.emit (events.js:98:17)
    at Process.ChildProcess._handle.onexit (child_process.js:797:12)
Error: Address already in use
    at Socket.bindSync (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:322:15)
    at module.exports (/usr/local/lib/node_modules/stf/lib/units/triproxy/index.js:21:7)
    at Command.program.command.description.option.option.option.option.option.option.option.option.option.option.option.option.action.require.port (/usr/local/lib/node_modules/stf/lib/cli.js:282:32)
    at Command.listener (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:301:8)
    at Command.EventEmitter.emit (events.js:98:17)
    at Command.parseArgs (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:615:12)
    at Command.parse (/usr/local/lib/node_modules/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/cli.js:1134:9)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:902:3
INF/cli:local 4149 [_] Shutting down all child processes
 HI

 now am able to connect to ldap but when i try n login it is giving an assertion error

ERR/auth-ldap 2497 [127.0.0.1] Unexpected error AssertionError: options.attribute (string) is required
    at EqualityFilter (/usr/local/lib/node_modules/stf/node_modules/ldapjs/node_modules/ldap-filter/lib/equality_filter.js:15:12)
    at new EqualityFilter (/usr/local/lib/node_modules/stf/node_modules/ldapjs/lib/filters/equality_filter.js:16:26)
    at tryFind (/usr/local/lib/node_modules/stf/lib/util/ldaputil.js:55:15)
    at /usr/local/lib/node_modules/stf/lib/util/ldaputil.js:108:12
From previous event:
    at Object.module.exports.login (/usr/local/lib/node_modules/stf/lib/util/ldaputil.js:107:23)
    at requtil.validate.then.then.jwtutil.encode.payload.email (/usr/local/lib/node_modules/stf/lib/units/auth/ldap.js:71:29)
    at process._tickCallback (node.js:415:13)
From previous event:
    at /usr/local/lib/node_modules/stf/lib/units/auth/ldap.js:70:12
    at Layer.handle [as handle_request](/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at next (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/route.js:131:13)
    at Route.dispatch (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request](/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at /usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:277:22
    at Function.process_params (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
    at next (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:271:10)
    at /usr/local/lib/node_modules/stf/lib/units/auth/ldap.js:50:5
    at Layer.handle [as handle_request](/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:312:13)
    at /usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
    at next (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:271:10)
    at /usr/local/lib/node_modules/stf/node_modules/express-validator/lib/express_validator.js:228:5
    at Layer.handle [as handle_request](/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:312:13)
    at /usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
 HI

Can you help me what things i need to pass in search field and search scope
 Hi @sorccu 
I am getting below error while authenticating via ldap server (**got STF ldap UI**).

ERR/auth-ldap 4170 [::ffff:127.0.0.1] Unexpected error AssertionError: options.attribute (string) is required
    at EqualityFilter (/usr/local/lib/node_modules/stf/node_modules/ldap-filter/lib/equality_filter.js:15:12)
    at new EqualityFilter (/usr/local/lib/node_modules/stf/node_modules/ldapjs/lib/filters/equality_filter.js:16:26)
    at tryFind (/usr/local/lib/node_modules/stf/lib/util/ldaputil.js:55:15)
    at /usr/local/lib/node_modules/stf/lib/util/ldaputil.js:108:12
 Hi @sorccu ,

I am running below command,

stf local --public-ip <stf_server_ip_address> --auth-type ldap --auth-options '["--ldap-url","<ldap_server_ip>","--port","ldap_port","--ldap-search-dn","CN=Users,DC=organization,DC=com","--ldap-bind-dn","DC=organization,DC=com","--app-url","organization.com"]'
 Thanks so much @sorccu. Your suggestions work for me :+1: 

stf local --auth-type ldap --auth-options '["--ldap-url","ldap://ip:port","--ldap-search-dn","OU=inner_ou,OU=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-bind-dn","CN=username,OU=inner_ou,OU=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-bind-credentials","username_actual_credential","--ldap-search-field","sAMAccountName"]'
  I get the error message:

`missing requirere argument '--secret'`

When I just add '--secret' it starts with no errors but I cant reach stf.
I used @tadesushilgithub example.
And I'am not sure what I need in  --ldap-search-field. 
Any Ideas?
 @xell66 use "--ldap-search-field","sAMAccountName" as it is if your LDAP uses Microsoft server Active Directory. If you uses master branch code base it won't ask you for --secret. Send me your command and mentioned the step how you running it?
 I tried Version 2.0.0 and also get the --secret failure. 
I'am running on Ubuntu so I gues I need to change "sAMAccountName"?  
I`am not very familiar with ldap. So I used this command:

stf local --public-ip 172.18.92.157 --auth-type ldap --auth-options '["--ldap-url","ldap://127.0.0.1:389","--ldap-search-dn","CN=iue,DC=selen","ldap-bind-dn","DC=selen","--ldap-search-field","sAMAccountName"]'

I'am also not sure about the port. I configured ldap via phpldapadmin.
@tadesushilgithub 
 Hello,
tried to run stf local with LDAP, but our ldap connecting is https
so i run connect with: 

["--ldap-url","ldaps://ip:port","--ldap-search-dn","OU=inner_ou,OU=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-bind-dn","CN=user,OU=inner_ou,OU=inner_ou,DC=inner_dc,DC=inner_dc,DC=com","--ldap-bind-credentials","password","--ldap-search-field","sAMAccountName"]

but after connecting attempt in LDAP UI i got this error:
events.js:141
      throw er; // Unhandled 'error' event
      ^

Error: Hostname/IP doesn't match certificate's altnames: "IP: 172.17.17.2 is not in the cert's list: "
    at Object.checkServerIdentity (tls.js:191:15)
    at TLSSocket.<anonymous> (_tls_wrap.js:1006:29)
    at emitNone (events.js:67:13)
    at TLSSocket.emit (events.js:166:7)
    at TLSSocket._finishInit (_tls_wrap.js:567:8)
ERR/poorxy 83 [_] Proxy had an error Error: socket hang up
    at createHangUpError (_http_client.js:203:15)
    at Socket.socketOnEnd (_http_client.js:288:23)
    at emitNone (events.js:72:20)
    at Socket.emit (events.js:166:7)
    at endReadableNT (_stream_readable.js:893:12)
    at doNTCallback2 (node.js:430:9)
    at process._tickCallback (node.js:344:17)
FTL/cli:local 13 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/app/lib/util/procutil.js:49:23)
    at emitTwo (events.js:87:13)
    at ChildProcess.emit (events.js:172:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)

any help what is wrong?
 found a solution for that, my ldaps can talk with nginx by hhtps and to stf by http.
but after the Authentication, i;m rederected to work on http, and secound attempt to go to https page, results in error:

ixed Content: The page at 'https://stf.ironsrc.com/' was loaded over HTTPS, but attempted to connect to the insecure WebSocket endpoint 'ws://stf.ironsrc.com:7110/socket.io/?uip=172.17.7.193&EIO=3&transport=websocket'. This request has been blocked; this endpoint must be available over WSS.WS.doOpen @ 1.8bed18f….chunk.js:50487
1.8bed18f….chunk.js:13713 Error: Failed to construct 'WebSocket': An insecure WebSocket connection may not be initiated from a page loaded over HTTPS.
    at Error (native)
    at WS.doOpen (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:50487:33)
    at WS.Transport.open (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:48574:11)
    at Socket.open (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:47194:14)
    at new Socket (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:47075:9)
    at Socket (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:47001:42)
    at Manager.open.Manager.connect (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:46591:18)
    at new Manager (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:46445:31)
    at Manager (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:46414:43)
    at lookup (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:44017:20)
    at Object.SocketFactory (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:43916:17)
    at Object.invoke (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:4714:20)
    at Object.enforcedReturnValue [as $get](https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:4553:38)
    at Object.invoke (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:4714:20)
    at https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:4513:38
    at getService (https://stf.ironsrc.com/static/app/build/1.8bed18f555f9bd501fe6.chunk.js:4660:40)

Is there a way to run all stf over https, to skip this problem?
 So has anyone an idea about the `--secret` error?  How is this argument suposed to use?
 I think for `openldap` you need to use `uid` instead of `sAMAccountName`.
At least with this config I get an incorrect login message in the gui when I use a incorrect login, but when I use a correct login I just get an empty page in the browser (about:blank) and the stf server says: 
`INF/auth-ldap 6671 [::ffff:127.0.0.1] Authenticated "undefined"`
 I figured out that the problem with the empty page resulted from the fact that my IP changed. So I used the command `stf local --public-ip 172.18.92.157 --auth-type ldap --auth-options '["--ldap-url","ldap://127.0.0.1:389","--ldap-search-dn","OU=ou1,OU=ou2,DC=dc1,DC=dc2","--ldap-bind-dn","CN=admin,DC=dc1,DC=dc2","--ldap-bind-credentials","PASSWORD","--ldap-search-field","uid"]'`
I still can reach STF despite the fact that I used a wrong IP. But I needed to use the url `PCNAME:7100/aut/ldap/`

Anyways I still have the problem that I get this error when I "successfully" login.

```
INF/auth-ldap 11940 [::ffff:127.0.0.1] Authenticated "undefined"
ReqlDriverCompileError: Argument 1 to get may not be `undefined`.
    at ReqlDriverCompileError.ReqlError [as constructor] (/usr/local/lib/node_modules/stf/node_modules/rethinkdb/errors.js:23:13)
    at ReqlDriverCompileError.ReqlCompileError [as constructor] (/usr/local/lib/node_modules/stf/node_modules/rethinkdb/errors.js:35:51)
    at new ReqlDriverCompileError (/usr/local/lib/node_modules/stf/node_modules/rethinkdb/errors.js:46:57)
    at Get.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/rethinkdb/ast.js:1462:17)
    at Get.RDBOp [as constructor] (/usr/local/lib/node_modules/stf/node_modules/rethinkdb/ast.js:1466:8)
    at new Get (/usr/local/lib/node_modules/stf/node_modules/rethinkdb/ast.js:1846:38)
    at /usr/local/lib/node_modules/stf/node_modules/rethinkdb/ast.js:1068:43
    at Table.RDBVal.get (/usr/local/lib/node_modules/stf/node_modules/rethinkdb/ast.js:1070:7)
    at dbapi.saveUserAfterLogin (/usr/local/lib/node_modules/stf/lib/db/api.js:22:34)
    at /usr/local/lib/node_modules/stf/lib/units/app/middleware/auth.js:14:15
    at Layer.handle [as handle_request] (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:312:13)
    at /usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
    at next (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:271:10)
    at _cookieSession (/usr/local/lib/node_modules/stf/node_modules/cookie-session/index.js:124:5)
    at Layer.handle [as handle_request] (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:312:13)
    at /usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
    at next (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:271:10)
    at favicon (/usr/local/lib/node_modules/stf/node_modules/serve-favicon/index.js:72:7)
```

Is maybe something wrong with my LDAP structure?
 Has no one an idea what could be wrong? I tried a lot of configurations with my LDAP Server but nothing worked.
 Your suggestion worked. Thank you!
The User Object has to have the ObjectClass `inetOrgPerson`, then it is possible to add an email adress.
 Hi guys, 
I have one simply question: before using STF‘s ldap module, should I deploy the ldap service?  I am writing the client script to control the minitouch, so I need a sample, thanks. 
 Could you show me a single nodejs file which can control the minitouch, I am not familiar with the nodejs coding. The index.js is too complicated for me.
  Thank you for your excellent system first.
We need to test on more than 100 handsets and can we upload and install apk in one time?Can we test on all device connected by operating on one device and others are doing the same operation?
 Hi @sorccu , Is there any solution in stf 2.0.0 to install apk for all devices in one time?
 Thanks @vbanthia , I will try.
  I have found that the stf doesn't support the windows system, yet I want to make sure this question again, thanks.
 openSTF has a docker solution. You can install DockerToolbox in windows and use their docker image to run openSTF. Just a workaround I could think of.
 I guess I've almost managed to get this running. There is just one small issue I am facing as pointed out here https://github.com/sorccu/node-jpeg-turbo/issues/8 I would love to send an update to the documentation pointing out installation instructions for windows once the issue with `jpeg-turbo` is resolved. That is the only issue i've been facing.
```
FTL/device 18892 [5d89bf39] Setup had an error Error: Cannot find module 'jpeg-turbo'
    at Function.Module._resolveFilename (module.js:470:15)
    at Function.Module._load (module.js:418:25)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at Object.<anonymous> (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\lib\units\device\plugins\vnc\index.js:8:12)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.require (module.js:498:17)
    at require (internal/module.js:20:19)
    at C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\lib\units\device\index.js:23:21
    at SerialSyrup.ParallelSyrup.invoke (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\lib\parallel.js:54:24)
    at C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\lib\serial.js:43:33
    at tryCatch1 (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\node_modules\bluebird\js\main\util.js:63:19)
    at Promise$_callHandler [as _callHandler] (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\node_modules\bluebird\js\main\promise.js:708:13)
    at Promise$_settlePromiseFromHandler [as _settlePromiseFromHandler] (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\node_modules\bluebird\js\main\promise.js:724:18)
    at Promise$_settlePromiseAt [as _settlePromiseAt] (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\node_modules\bluebird\js\main\promise.js:896:14)
    at Promise$_fulfillPromises [as _fulfillPromises] (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\node_modules\bluebird\js\main\promise.js:1041:14)
    at Async$_consumeFunctionBuffer [as _consumeFunctionBuffer] (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\node_modules\bluebird\js\main\async.js:74:12)
    at Async$consumeFunctionBuffer (C:\Users\t-sus\Documents\OpenSource\GameAutomators\stf\node_modules\stf-syrup\node_modules\bluebird\js\main\async.js:37:14)
```
I had in the process faced a temporary issue with `zmq` not connecting correctly. The fix for that was 
```sh
cd node_modules\zmq
node-gyp rebuild
```
 It's possible to install stf on Windows 10 using "Windows Subsystem for Linux", It's not exactly what you want but it's a quick and dirty solution.

Screenshot:
![screen shot 2017-07-01 at 9 48 01 am](https://user-images.githubusercontent.com/588431/27759460-815af694-5e42-11e7-8ffa-f78dc057b256.png)
 I'm going to see if I can use the install script from the devs and the subsystem. If it works I'll be beyond over the moon, since the docker "solution" requires Windows 10 PRO...Home edition doesn't have Hyper V.

[edit]
NVM on the script, it needs docker (I didn't read it through). Guess I'll have to do it manually.  I hava written a python script to call minitouch socket server, but i came with the problem below, it seems like the heads of the request is wrong.

--- request header ---
GET / HTTP/1.1
Upgrade: websocket
Connection: Upgrade
Host: localhost:1111
Origin: http://localhost:1111
Sec-WebSocket-Key: zreWTQ9Syce2aG2b7sohOA==
Sec-WebSocket-Version: 13

---

--- response header ---
v 1
^ 10 720 1280 0
error: Invalid header
### closed

my script:
# coding=gbk

import websocket
import thread
import time
import ssl
import socket

def on_message(ws, message):
    print message

def on_error(ws, error):
    print 'error: ' + str(error)

def on_close(ws):
    print "### closed ###"

def on_open(ws):
    ws.send("d 0 100 100 50")
    ws.send("c")
    ws.send("u 0 ")
    ws.send("c")
    ws.close()

if **name** == "**main**":
    websocket.enableTrace(True)
    ws = websocket.WebSocketApp("ws://localhost:1111/",
                              on_message = on_message,
                              on_error = on_error,
                              on_close = on_close)
    ws.on_open = on_open
    ws.run_forever(sslopt={"cert_reqs": ssl.CERT_NONE})
 Yes,  I have tried the socket method. But, it wasn't useful also. When I input 2 command, the cmd.exe is blocked. Here is my python code:

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('localhost',1111))
while 1:
    cmd=raw_input("Please input cmd:")  
    s.sendall(cmd)
    data=s.recv(1024)  
    print data
s.close() 

the log:

--- request header ---
GET / HTTP/1.1
Upgrade: websocket
Connection: Upgrade
Host: localhost:1111
Origin: http://localhost:1111
Sec-WebSocket-Key: 4JwELC7XpMgKlXWh+mYLzw==
Sec-WebSocket-Version: 13

---

--- response header ---
v 1
^ 10 720 1280 0
error: Invalid header

### closed

Please input cmd:d 0 100 100 50
v 1
^ 10 720 1280 0
$ 9315

Please input cmd:c
 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
Because of this?
socket.AF_INET is explained to ipv4, and socket.SOCK_STREAM is tcp connection.
  Is there a any way to open a URL in a particular browser on multiple devices, without doing this once for each device — either programatically or via the UI?

For example, I'd like to be able to open a page on all devices in Chrome, then switch all devices to open the same page in Firefox.

(BTW — thanks for STF! Very useful and easy to set up.)
 Thanks for the `cc` suggestion.

@gauntface fyi

Always happy to help out with WebRTC questions :)! Email me at dutton@google.com or raise an issue here. 
 Hey @sorccu — meant to ask: could you give some more detail about how you're using WebRTC for STF?
  I have a issues with your  branch, i am testing your rest api is working fine but at same time i get a problem wiht the gui from stf, the user interface don't start  give errors missing modules or can't locate some of them.
 @vbanthia 

Hey I tried to build my own version of stf (cloned this repo) with the API enabled. However when I try to access the API I get a 302 response redirecting me to /auth/mock and I can't access the API... Since the tool is behind an internal VPN it's fine to not have to authenticate and use the mock version. But I can't access the API, what can I do?
The server is running with `stf -local`
Below you'll find the logs from the request I made through curl. Hope you can help me.

**_Request_**
`curl -H "Authorization: Bearer 26de8268b133418fa8ad87b2e404c60f8ba865f3655b444a83e9bead1157d80c" -i http://172.31.10.33:7100/api/v1/devices`

**Response**
`HTTP/1.1 302 Found
x-powered-by: Express
location: http://172.31.10.33:7100/auth/mock/
vary: Accept
content-type: text/plain; charset=utf-8
content-length: 57
date: Fri, 03 Jun 2016 09:32:16 GMT
connection: close
`
 @vbanthia 

I ran stf -V and it returned 2.0.0 so I guess I am running from the correct branch.
 @vbanthia @dhartwich1991 

I hit the same problem @dhartwich1991 did.  The problem was that I had not looked at the changes to the deployment guide, so I didn't have nginx set up, or the api service running.

Is it possible that when running "stf local" that it isn't starting the api service, and nginx isn't configured correctly?

Also, I've found some issues with the deployment document.   The same stf-api@.service appears to tells you to run "stf app", instead of "stf api".   However, once you change it to "stf api" (and set your secret), the "stf api" command complains that there isn't a "--connect-sub" or "--connect-push" parameter provided.

I'm not sure which socket "stf api" wants to connect to, but when I try either 7170 or 7270 for the "--connect-push" and then attempt to query the devices endpoint, the docker for "stf api" terminates with no log messages.   (I may need to crank up the logging level, that is the next thing I am going to look in to.)

So, the deployment doc probably needs to be updated a little bit to account for these issues.  (Unless I am doing everything wrong, which is entirely possible!)

BTW - @vbanthia Thanks for doing this!  It'll make my integration with Jenkins a _LOT_ easier!  (I am planning on looking in to what is involved in building a Jenkins plugin to work with these patches.)
 @vbanthia 
I tried port 7270 for the push, and 7250 for the sub, and managed to query the devices endpoint!   (So, anyone else struggling with this should use those ports to get everything working.)
 @vbanthia - I've been working on a small Jenkins plugin, but hit an issue with the API.  When I try to add a device to a user, I keep getting back a 504 response with the JSON '{"success":false,"description":"Device is not responding"}'.

From looking at the logs for the API docker, I don't see any error messages when I run the query.  So, it is unclear what the problem might be.

FWIW - This happens with both curl and my Java code.   The command I am using is  : 

curl -v -X POST --header "Content-Type:application/json" --data '{"serial":"HT254W302991"}' -H "Authorization: Bearer ea06b6215c844409bdee5cfb970dcee8a702e72c67e1461492576b84c4749114" http://192.168.64.56/api/v1/user/devices

(And, yes, I am really running it over http, not https.  I know there are some issues with that, but I have not had a chance to rebuild my test environment yet.  I'll probably start on that today, in case it helps with this issue.)

FWIW - I'll post this over on the Google group as well, just in case this discussion isn't monitored.
 Hi @vbanthia -

Per your suggestion, I moved my development from my own home-grown interface to the API to the swagger generated Java class.   Seems like it will be easier to maintain in the long run.

I moved my setup over to using HTTPS to try to rule that out as a problem.   However, the issue still remains.   If I use the web interface I am able to claim a device and even control it as expected.  So, I either have something messed up in my setup (wouldn't be the first time), or there is a bug in the API.

I'm going to spend an hour or two trying to dig in to the API code and see if I can figure out what is going on, but if you have any thoughts on things I can check, I would appreciate it.

If I manage to figure out what is going on, I'll post a follow-up here.

Thanks again for your work!  It is appreciated!
 Hi @vbanthia -

I am completely at a loss as to what is going on.  I set up a local OpenSTF on my development machine, and was able to access the device over the API even though I couldn't actually use it through the UI.   But, on the set up that I have where I can use devices through the UI, I can't access the devices.

On the set up that times out trying to take control of a device, I tried changing the time out in the code you linked to.  I set it to 30 seconds, figuring that should be more than enough for a response, even if everything is running really slowly.   The end result is still the same.   (Except now I have to wait 30 seconds for it to happen.)

When I access devices through the UI, there isn't any noticeable lag, so it doesn't seem that lag is the issue.   It seems more like the response that the API is waiting for isn't getting where it is supposed to go.  

Since I was just guessing as to how the API hooked in to everything else, is it possible that I got something hooked up wrong?  (i.e. Are the ports not 7270 and 7250?)

The only other thing I can think of that could be a problem is that the devices are connected to one machine, and the rest of the OpenSTF processes run on another machine.  (The machine with the devices has the adb and provider service running.)   But, that seems like a dead end too since the UI is working.

Is there any kind of verbose debugging that I can turn on to try to track down what is failing?   Or is there anything else you can think of that might be a problem?

Thanks!
 @fbatogo @vbanthia 
Somehow I don't really get if I am doing everything right in order to start up the API service, on what port it is running etc. could you be so kind to give me a short list on how to start up the service correctly keeping the stf local etc.

Currently we do: 
`~/stf/bin/stf local --public-ip 172.31.10.33`

and:

`rethinkdb` 

what else needs to be called in order to get access to the API, please help me out since I never worked with Docker / node before and I don't know how to get started :(
 @vbanthia - No worries.  I've done a fair bit of open source in the past, so I don't expect you guys to work on the weekends or do anything too wildly special for me.   Which is why I am mostly asking for enough help to hopefully figure out the issue and post back here what it was.  Knowing how to enable more verbose logging would be REALLY helpful, as I have found it kinda hard to debug issues with OpenSTF.  (Which may well be a comment on me not understanding the technology as anything. ;)

@dhartwich1991 -

I'm not sure that the order you start the various services matters much.   However, I do always try to start up rethinkdb before starting anything else since it seems to be the core of everything.

If you are trying to start OpenSTF using the "local" command, you don't really need to know anything about docker.  (That said, when I started with OpenSTF I was a total docker n00b.  I spent a little bit of time trying to understand docker a bit more, and was surprised at how handy it is.   One thing that messed me up was a belief that docker was something akin to a VM.  In reality, it is more akin to a chroot environment.   Once I understood that, things started to make a fair bit more sense!)

I suspect the problem you are running in to has to do with following the instructions on Github to get OpenSTF running.   This will work just fine, but you will end up with an OpenSTF instance that doesn't contain the API functionality.   You can verify that pretty easily using two different methods.  One is to run "stf -V" and make sure it outputs "2.0.0".   The other is to run "stf --help" and look in the output to see if there is a line that says "api [options]             start api" in the help output.   If the version isn't 2.0.0, and the "api" module isn't listed in the help output, then you aren't running the branch that has the API functionality.

I would bet that there is a better way to do this, but I basically downloaded the 2.0.0 branch to a directory and then copied it over the files that were downloaded using the instructions from the GitHub instruction page.  (For me, the downloaded version of OpenSTF ended up in the /usr/local/lib/node_modules/stf directory.)   You will probably want to make a backup of that directory before you overwrite the files.   Also note that when I did this, I was able to get the API working, but I had some issues with the devices being accessible through the UI.   For my needs at the time, this wasn't an issue, but it may be for you.   That said, I suspect that the bulk of my problem with the UI came from the fact that I had some development processes on my machine that were also using adb to talk to the device.   So, you may not have any problems, but YMMV.
 After MUCH mucking around, I finally figured out that the problem I was running in to is that I actually had the ports wrong.  (Seems odd that it half way works when the ports are wrong.  And that there doesn't seem to be any error messages when they are wrong either.)

For the --connect-push, I had to use 7170.  For the --connect-sub, I had to use 7150.   So, my stf-api@.service file ends up looking like this : 

[Unit]
Description=STF api
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:v2.0.0-beta
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --link rethinkdb-proxy-28015:rethinkdb \
  -e "SECRET=<your secret>" \
  -p %i:3000 \
  stfapi/chris \
  stf api --port 3000 \
  --connect-push tcp://<your server ip>:7170 \
  --connect-sub tcp://<your server ip>:7150
ExecStop=-/usr/bin/docker stop -t 10 %p-%i

Hopefully this helps someone else!
 How to use this API? Can I use API with having default authentication with local STF? When I do curl I will get request is redirect to mock URL. Please help on this.
 You mean that, I need to install STF 2.0.0. Is this STF new release? I went through same link.

> On 05-Jul-2016, at 12:22 AM, Vishal Banthia notifications@github.com wrote:
> 
> Read this https://github.com/openstf/stf/blob/2.0.0/doc/API.md and use 2.0.0 branch
> 
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub, or mute the thread.
 @tadesushilgithub 

I don't believe the 2.0.0 branch is a full release yet.   So, you do have to do things a little different to get it up and running.  However, if you look at my comments above, and use the documentation included in the new branch, it isn't too hard to get going.

And, yes, it should work fine with a local STF.  I debugged my Jenkins plug-in using a local STF.

If you need a stable release, you'll probably want to wait for the official release.
 I am getting error while running command  **npm install stf@2.0.0-beta**

> npm ERR! Error: version not found: stf@2.0.0-beta
 @tadesushilgithub 
version 2.0.0-beta is not present in npm, you have to remove the "-beta".
Just try `npm install stf@2.0.0` 
This should work
 Hi,
After executing curl 
**>curl -H "Authorization: Bearer a3fc22e88ba74fb3b67cfcaf0154da
138714a5fd764f4021a08f49b8bd03209f" -i http://ip:7100/api/v1/devices**

HTTP/1.1 500 Internal Server Error
x-powered-by: Express
content-type: application/json; charset=utf-8
content-length: 17
etag: W/"11-wKQin2UUhiiybkUTBN2saA"
date: Tue, 26 Jul 2016 11:33:45 GMT
connection: close

**{"success":false}**

I am getting HTTP/1.1 500 Internal Server Error. What could be the cause?
 Unhandled rejection TimeoutError: operation timed out
    at tryOnTimeout (timers.js:224:11)
    at Timer.listOnTimeout (timers.js:198:5)
  Hi

I m trying to figure out the auth module which is mock by default. now i want to change it to ldap and connect it to my ldap server. So could you  please help in finding the file in which i need to perform changes.
 Thanks For your quick reply. Let me try with oAuth & with Ldap.
  We are considering allow user to do factory reset and after that keep the device online without human interface.
Could the devices just run a script after reboot to open the USB debug mode?  
Thanks. 
 Yeah, that is so important. Do you have an any idea @sorccu ? Here is the script I use to do that:
https://gist.github.com/phhusson/3d1e8833309dc34ee5502a409b80e292
You need to give it a blank userdata.img, or the userdata.img provided by your OEM,
This has been tested on various devices, ranging from 5.1 to 7.1, either AOSP-based, or MTK based.
For Spreadtrum-based, some firmwares won't allow this to work. (I have some modifications to work-around that, but they break other things) Yup this requires oem unlocked device obviously, but there is no check of a signature or anything for userdata partition.
There is some encryption (which would do the signature actually), but if the partition is not encrypted, the device will just encrypt it on first boot. (That's why the partsize leaves 200MB left, some place is needed to leave encryption information), so it is fine in this case.

It is possible it won't work for FBE devices, but I don't have a FBE-by-default device to check   That's a good idea. The Wugfresh tool kit is great for rooting Nexus devices. However the tool kit is only for windows at the moment. The link says Linux users can use an app called Wine to run the root software on linux. It would also be cool if you could send the rooting commands through the STF

Link to Rooting tool kit on linux discussion 
http://goo.gl/aSVbvR
  By analyzing the blame information on this pull request, we identified @sorccu, @gunta and @greenkeeperio-bot to be potential reviewers
  Hi,

I'm trying to setup dev environment with STF and after following all the installation steps, start of the DB with "sudo rethinkdb", "sudo adb start-server" and then "sudo stf local" I still receive this error in the console:

FTL/device 59845 [0657234af0ea3cf3] Setup had an error Error: At least one of these paths should exist: /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-6.0.1/armeabi-v7a/minicap.so, /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-23/armeabi-v7a/minicap.so, /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-6.0.1/armeabi/minicap.so, /usr/local/lib/node_modules/stf/vendor/minicap/shared/android-23/armeabi/minicap.so
    at Object.module.exports.requiredMatch (/usr/local/lib/node_modules/stf/lib/util/pathutil.js:33:9)
    at /usr/local/lib/node_modules/stf/lib/units/device/resources/minicap.js:35:23
    at SerialSyrup.ParallelSyrup.invoke (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at tryCatch1 (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/util.js:63:19)
    at Promise$_callHandler [as _callHandler](/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:708:13)
    at Promise$_settlePromiseFromHandler [as _settlePromiseFromHandler](/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:724:18)
    at Promise$_settlePromiseAt [as _settlePromiseAt](/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:896:14)
    at Promise$_fulfillPromises [as _fulfillPromises](/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:1041:14)
    at Async$_consumeFunctionBuffer [as _consumeFunctionBuffer](/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/async.js:74:12)
    at Async$consumeFunctionBuffer (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/async.js:37:14)
    at process._tickCallback (node.js:355:11)
FTL/util:lifecycle 59845 [0657234af0ea3cf3] Shutting down due to fatal error
INF/provider 59745 [_] Cleaning up device worker "0657234af0ea3cf3"
ERR/provider 59745 [_] Device worker "0657234af0ea3cf3" died with code 1
INF/provider 59745 [*] Restarting device worker "0657234af0ea3cf3"

I would like to ask does STF support Nexus 5 and arm ABI? How could I fix that?
 Thanks, now it works fine.
  my Setup was relatively effordless with instructions from here:
https://gist.github.com/pvsune/a2122369f91d2a518271

everything worked fine in my Virtual Box with Ubuntu 14.04.3-desktop-amd64 to the point of installing stf itself.

i do 'npm install -g stf'
-> works nicely
i go into stf in npm-modules 
i do 'npm install'
=> stf is vanished from modules and i can't do the last part with bower and npm link
Please help me. I would love to show stf to my QA team.

greetings Markus
 Host OS is Windows 7 64bit, I'll try again from scratch.
 is there a gist i can use?
 or would you provide a working virtualbox image for testing purposes?
 tyring to install the whole thing for two days now, always errors. rethinkdb works fine, but stf doesn't start
 I'll do as you recommended before, start from scratch and put the whole error output here. Will be some time till I'm there. Maybe tomorrow. Thx in advance.
 Started from scratch with instructions:https://gist.github.com/pvsune/a2122369f91d2a518271
just used sudo npm install -g stf
then started rethinkdb (which works fine)
the started stf with "stf local" command 
Errors in TXT
[error_when_startstf.txt](https://github.com/openstf/stf/files/69709/error_when_startstf.txt)
  I can not use minicap on device samsung note4 sm-n9100
 More details @BigWavelet 
 The cpu-abi of the device is armeabi-v7a, and after I typed "LD_LIBRARY_PATH=/data/local/tmp /data/local/tmp/minicap -i" in adb shell, the result is "Segmentation fault".  
   wget http://127.0.0.1:7100

`ERR/poorxy 2369 [*] Proxy had an error Error: connect ECONNREFUSED 127.0.0.1:7105
    at Object.exports._errnoException (util.js:874:11)
    at exports._exceptionWithHostPort (util.js:897:20)
    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1063:14)`
  when i execute `adb connect xx.xx.xx.xx` connect my phone, the phone's status always be 'offline' .

Anybody who know the possible reason ?
 @sorccu Can you help me ?
 Yes, sorry for that.
1. I use `adb connect` remote debug phone
2. yes, on the same machine, and when i run `adb connect`, the STF seems find the phone but report `due to heartbeat timeout` soon
3. yes, when i run `adb devices`, i see `offline`
 I am not sure if this Attachment describes your scenario (LiufxLucky365). But I am seeing offline on Web UI (localhost) when I still have device connected and File Transfer mode on device. 

<img width="632" alt="screen shot 2016-12-24 at 6 42 59 pm" src="https://cloud.githubusercontent.com/assets/23224331/21469418/41654eb8-ca09-11e6-9c3b-d4df7407b324.png">

Any feedback is good : 
If you know why am i seeing this and How do i resolve this?  I've been experiencing the same kind of issue, BUT, only with Motorola phones. Most of them is running on Android 6.0.*. At the same nodes I'm having no issues with phones from other brands (Samsung, LG, ...). The device has its status changed to "Preparing" and after a few seconds, it goes offline again.  good
 good job!
 I am trying to access the API but is redirecting always to http://localhost:7100/auth/mock/
I started stf in 2.0.0 branch and im running it locally. The authorization token is in the request.
I have tried the following endpoints:
http://localhost:7100/app/api/v1/devices
http://localhost:7100/api/v1/devices
http://localhost:7100/api/v1/swagger.json
But I always get the redirection.
 Is this part of some known issue?
 Its working! I wasnt using v2.0.0 after all. I am testing the api with calabash and a ruby script.
 Hi All,

I am very poor at coding. I am working on appium with Pom in Java . I want to run appium test cases parallel on stf. Please provide me the step by step setup of appium on stf parallel.
  I can not install apk and the console shows following error:

INF/storage:temp 14483 [] Uploaded "com.eg.android.AlipayGphone.1512041827.apk" to "/tmp/upload_4661586ca7a0226fcb7ee3f55b9db4ad"
Dec 07 14:11:55 odroid stf[14427]: ERR/storage:plugins:apk 14493 [] Unable to read manifest of "8d25b9bd-5f9a-4498-9f74-cfa46d549ee7" Error: Invalid or unsupported zip format. No END header found
Dec 07 14:11:55 odroid stf[14427]: at new ApkReader (/root/STF/node_modules/adbkit-apkreader/lib/apkreader.js:27:17)
Dec 07 14:11:55 odroid stf[14427]: at Function.ApkReader.readFile (/root/STF/node_modules/adbkit-apkreader/lib/apkreader.js:16:14)
Dec 07 14:11:55 odroid stf[14427]: at /root/STF/lib/units/storage/plugins/apk/task/manifest.js:9:30
Dec 07 14:11:55 odroid stf[14427]: at doNTCallback0 (node.js:408:9)
Dec 07 14:11:55 odroid stf[14427]: at process._tickCallback (node.js:337:13)

Thanks.
 Thank you for the answer. I have tried many different apk packages and all have the same error. I also tried the released old version of STF. Still the same problem. Do you think does it relate to my local file system or the npm dependency of the APKreader? Thanks. 
  gyp: Undefined variable yasm_format in deps/libjpeg-turbo.gyp while loading dependencies of binding.gyp while trying to load binding.gyp
gyp ERR! configure error 
gyp ERR! stack Error: `gyp` failed with exit code: 1
gyp ERR! stack     at ChildProcess.onCpExit (/root/node-v4.1.2-linux-armv7l/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:355:16)
gyp ERR! stack     at emitTwo (events.js:87:13)
gyp ERR! stack     at ChildProcess.emit (events.js:172:7)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)
gyp ERR! System Linux 3.10.82-39
gyp ERR! command "/root/node-v4.1.2-linux-armv7l/bin/node" "/root/node-v4.1.2-linux-armv7l/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "configure" "--fallback-to-build" "--module=/root/stf-master/node_modules/jpeg-turbo/lib/binding/node-v46-linux-arm/jpegturbo.node" "--module_name=jpegturbo" "--module_path=/root/stf-master/node_modules/jpeg-turbo/lib/binding/node-v46-linux-arm"
gyp ERR! cwd /root/stf-master/node_modules/jpeg-turbo
gyp ERR! node -v v4.1.2
gyp ERR! node-gyp -v v3.0.3
gyp ERR! not ok 
node-pre-gyp ERR! build error 
node-pre-gyp ERR! stack Error: Failed to execute '/root/node-v4.1.2-linux-armv7l/bin/node /root/node-v4.1.2-linux-armv7l/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js configure --fallback-to-build --module=/root/stf-master/node_modules/jpeg-turbo/lib/binding/node-v46-linux-arm/jpegturbo.node --module_name=jpegturbo --module_path=/root/stf-master/node_modules/jpeg-turbo/lib/binding/node-v46-linux-arm' (1)
node-pre-gyp ERR! stack     at ChildProcess.<anonymous> (/root/stf-master/node_modules/jpeg-turbo/node_modules/node-pre-gyp/lib/util/compile.js:83:29)
node-pre-gyp ERR! stack     at emitTwo (events.js:87:13)
node-pre-gyp ERR! stack     at ChildProcess.emit (events.js:172:7)
node-pre-gyp ERR! stack     at maybeClose (internal/child_process.js:818:16)
node-pre-gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:211:5)
node-pre-gyp ERR! System Linux 3.10.82-39
node-pre-gyp ERR! command "/root/node-v4.1.2-linux-armv7l/bin/node" "/root/stf-master/node_modules/jpeg-turbo/node_modules/.bin/node-pre-gyp" "install" "--fallback-to-build"
node-pre-gyp ERR! cwd /root/stf-master/node_modules/jpeg-turbo
node-pre-gyp ERR! node -v v4.1.2
node-pre-gyp ERR! node-pre-gyp -v v0.6.10
node-pre-gyp ERR! not ok 
Failed to execute '/root/node-v4.1.2-linux-armv7l/bin/node /root/node-v4.1.2-linux-armv7l/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js configure --fallback-to-build --module=/root/stf-master/node_modules/jpeg-turbo/lib/binding/node-v46-linux-arm/jpegturbo.node --module_name=jpegturbo --module_path=/root/stf-master/node_modules/jpeg-turbo/lib/binding/node-v46-linux-arm' (1)
npm verb unsafe-perm in lifecycle true
npm info jpeg-turbo@0.3.0 Failed to exec install script
npm verb unlock done using /root/.npm/_locks/jpeg-turbo-712d5d6e1a1ca886.lock for /root/stf-master/node_modules/jpeg-turbo
npm verb stack Error: jpeg-turbo@0.3.0 install: `node-pre-gyp install --fallback-to-build`
npm verb stack Exit status 1
npm verb stack     at EventEmitter.<anonymous> (/root/node-v4.1.2-linux-armv7l/lib/node_modules/npm/lib/utils/lifecycle.js:214:16)
npm verb stack     at emitTwo (events.js:87:13)
npm verb stack     at EventEmitter.emit (events.js:172:7)
npm verb stack     at ChildProcess.<anonymous> (/root/node-v4.1.2-linux-armv7l/lib/node_modules/npm/lib/utils/spawn.js:24:14)
npm verb stack     at emitTwo (events.js:87:13)
npm verb stack     at ChildProcess.emit (events.js:172:7)
npm verb stack     at maybeClose (internal/child_process.js:818:16)
npm verb stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:211:5)
npm verb pkgid jpeg-turbo@0.3.0
npm verb cwd /root/stf-master
npm ERR! Linux 3.10.82-39
npm ERR! argv "/root/node-v4.1.2-linux-armv7l/bin/node" "/usr/local/bin/npm" "install" "--verbose" "--unsafe-perm"
npm ERR! node v4.1.2
npm ERR! npm  v2.14.4
npm ERR! code ELIFECYCLE

npm ERR! jpeg-turbo@0.3.0 install: `node-pre-gyp install --fallback-to-build`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the jpeg-turbo@0.3.0 install script 'node-pre-gyp install --fallback-to-build'.
npm ERR! This is most likely a problem with the jpeg-turbo package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-pre-gyp install --fallback-to-build
npm ERR! You can get their info via:
npm ERR!     npm owner ls jpeg-turbo
npm ERR! There is likely additional logging output above.
npm verb exit [ 1, true ]
npm verb unbuild node_modules/jpeg-turbo
npm info preuninstall jpeg-turbo@0.3.0
npm info uninstall jpeg-turbo@0.3.0
npm verb unbuild rmStuff jpeg-turbo@0.3.0 from /root/stf-master/node_modules
npm info postuninstall jpeg-turbo@0.3.0
npm verb gentlyRm don't care about contents; nuking /root/stf-master/node_modules/jpeg-turbo

npm ERR! Please include the following file with any support request:
npm ERR!     /root/stf-master/npm-debug.log

Thanks
 I have tried other user as well and they all have the same error when npm install jpeg-turbo@0.3.0 package. It seems like it has some error to rebuild the module: module=/root/stf-master/node_modules/jpeg-turbo/lib/binding/node-v46-linux-arm/jpegturbo.node
 OK, Very appreciate :)
  how to use these token in api request
  Sorry for spamming :).

My tester stumpled over another little UI bug.

If he scrolls over the "?"  icon on "Dashboard" --> "Shell" it's flickering.

Here is a short screen capture of the error:

https://drive.google.com/file/d/0B0fmELvOD4uQSGNEWHJlYloxTlk/view?usp=sharing

Only tested with Firefox 42.0

Take care and sorry.

PS: Next time I will collect the Bugs and will open only one issue.
  Hi,

we stumpled over another bug.
We can't access the phone settings over "Dashboard" --> "Apps" --> "Settings" on Samsung devices.

We tested it with a Samsung Galaxy S3 (Android 4.43) and Samsung Galaxy S5 (Android 5.0)

Thank you and take care.

Kind regards

Felix Hahn
 Hi,

we tested it again with both Samsungs and getting the following output:

```
* daemon not running. starting it now on port 5038 *
* daemon started successfully *
error: device not found
```

Used following command with the Galaxy S5

`adb -s 19e99847 shell am start -a android.intent.action.MAIN -n com.android.settings/.Settings`

There ist a Screenshot of the "info" task of our Galaxy S5:

![device_serial](https://cloud.githubusercontent.com/assets/9655106/11399802/ec4b7684-9389-11e5-8bdd-e441e9d97607.PNG)

We can access the settings with LG and Sony devices.

Kind regards

Felix Hahn
  I just want to close the connect between stf and phone from web page or api. what should i do?
 i dont want to stop using, what i want is to close the connect and free 5555 port. how can i do that :(
  Hi,

at first, I'am writing my master thesis about remote controlling a smartphone for a german automotive company and we're amazed how capable your solution is compared to the other solutions there are considering they all cost a lot of money.
Especially your capabilities for manual testing! They are miles better then every solution I looked into. Maybe we are missing one or two features but the rest ist amazing. It could happen that we will try to develop them in house and we are willing to share them with you. Right now I'am evaluating this scenario and calculating the possible costs for one or two small features and a big feature like Appium integration or iOS support. I wil discuss my results with my higher ups and can give you a feedback if you want to.

Right now we're testing your solution with serveral employees who are doing manuel application test for one of our costumers. We got a very postive feedback. 

But there is one big issue. I don't know if it's a problem with our hubs (the plugable hubs are ordered) or if it's a bug:

Every time we want to take a screenshot with "right click" on the screen and "Save Screenshot" the screen freezes and we must refresh the page to control the smartphone again. Is it a known bug or is it a problem on our configuration. 

We're running STF on a ubuntu server on a ESXi host with stf version 1.0.10.
I can't see any errors in the server logs.

Oh and I actually talked to the CTO of Testobject and he mentioned he was/is in touch with you guys. For more information we may write a personal message.

Thank you for your amazing work and your help!

Kind regards

Felix Hahn
 Hi,

thank you for your quick responses.

We will definitly integrate your solution into our test infrastructure.
Just to give you a short idea what we're doing:
We're a automotive engineering company working for nearly every big car manufactor worldwide. We have several departments which are specialized on testing only the car infotainment systems (contains the navigationssystem, radio, multimedia, connectivity of the vehicle, whole speedometer unit etc.). We also developing mobile applications which are interacting with the car infotainment systems. Also there is a lot of work for us to do with interfaces like Android Auto, Apple Car Play, Mirrorlink, VW Appconnect .... With these interfaces the smartphone will be deeply integrated in the electronics of the car. That means a immense testing effort. Furthermore we have a lot of interoperability (IOP) tests between smartphones and the infotainmentsystems. Not only for bluetooth, also for WLAN, USB-Connection, Android Auto, Apple CarPlay and so on. Therefor we often need 100+ different devices per test.

The main unit of the infotainment system (mainly it is the big screen where the sat nav sits) is running a operating system pretty similar to a normal computer. That means there are different software releases, updates and versions which are depending on which system you selected buying you car and which car you got. Some of them are highly modular and you get the same system from different manufacturer without even noticing :).

Ideally we would like to have a second way to connect the smartphone to your STF solution. Not USB, we're looking for someting like ADB Wireless. For some test cases (Android Auto, Mirrorlilnk) we need to connect the phones via USB to the infotainment system. 

We have 5 features we're missing right now:
1.) iOS support
2.) direct access to the file system of an Android Phone (For some test cases we need to put some dummy data into some folders. It would be nice if we could do that remotly)
3.) Video capturing a test run
4.) Appium support (test automation)
5.) A second way to connect a Smartphone to STF (maybe ADB Wireless will work)

Goal of my thesis was to get a remote control into our company network. Therefor I looked into many different solutions (f.e. TestObject, Experitest, Keynote .....). And for manual testing you got by far the best solution for us an we will start using your software in the future. Right now we're testing it with only a small team. But we're looking forward to work with you.

Right now we're in the process of checking if we could share the features we may develop in the future. But it's looking good.
We're planning to develop features in house through bachelor and or master theses and we definitly want to cooperate and share with you.

It would be nice if we could talk about our cooperation via mail. 
Please feel free to contact me:  felix.hahn@iav.de

Right now we're doing some manual testing for different android application on STF and we must take screeshots from every HMI error we detect. The best practice for us is to use this screenshot feature. Unfortunaly the Screenshot task in your dashboard forgets all the saved screenshots when switching into another task. Maybe I should also report this as a bug.

I did read all these issues and like the ideas which are behind these approaches.

Kind regards

Felix Hahn
  If I change the source code. Can I just create my own docker image by running 'docker build -t myname/stf:dev .' based on your Dockfile? 

Thanks. 
  When I using "adb connect“ to a Visual Studio Emulator for Android,the micap,minitouch can be installed and run, and when I slide,the emulator slide normal, but the screen on the dashborad is always black.
Can you tell me the reason?If I use Genymotion,will it work?
Thx.
  I used IntelliJ to connect to the phone which is plugging in other computer which is running STF locally with public IP. 
All debugging processes are slow including loading frames, loading variables and loading the Threads. Every step into or  step over hit will take about 5-6 seconds to load data.
Do you have any clue about which part limit the speed of remote debugging? It is very smooth to debug APP locally with real phone.
Thanks. 
 Same with Eclipse debugging
  Hi, i find the [id].[hash].chunk.js file is very large, about 4M, are there any options in stf to make it smaller?
 I'll take a look are there any solution or improvement about this issue ? have you solved the file size problem so far ?  Such like adding a shake button on control panel. When click the button, it will trigger out the acceleration transducer to achieve shake function on the real phone.

We can also add tilt left and tilt right buttons.

Do you have some clues about how to do this? Thanks.
  The STF is running locally by --public-ip xxx
When my other PC connect to it if I am using proxy, the control panel is grey all the time and the log shows "Device database does not have a match for device xxx"
And this situation also happened when I connect STF from other area network's PC. (Of course they are in the same LAN because I can connect to STF, but the Control panel failed)
I think it could be the rethinkdb connection problem under proxy because the STF service works fine. 
Can I get rethinkdb work when I using proxy?
Thanks.  
 @vbanthia 
Thanks for your reply. Do you mean the ports on PC which running the stf local? I think both my server PC and client PC have those ports open because it works fine when I close my proxy setting. Does it relate to the proxy server's ports?

I will check the WebSocket connections. Thanks.
  Hi guys,

I connected to a device and see "10.xx.xx.xx:7409" in remote debug tab, and I run "adb connect 10.xx.xx.xx:7409". It says "connected to 10.xx.xx.xx:7409", but I run "adb devices" I can't see this device. I also can't find it in my android studio? 

Please give some help, thanks.

B.R.
Luis
 STF local running in one machine. 
One user login from another machine to connect this device and do the remote debug. Then he stop using this machine.(ADB key not removed?)
Another user login from third machine to connect this device  and want to debug, but after he run "adb connect 10.xx.xx.xx:7409", key can't pops up and can't find this device.
But I return to the first user and remove the key, use second user to login again and run "adb connect 10.xx.xx.xx:7409", key pops up and it works.

Can you help and fix this issue? Once user stop using this machine and remove the adb key?
 Second user don't have key, no add keys dialog pops up after he run "adb connect 10.xx.xx.xx:7409".
 @sorccu 
You said , Is stf local running on the same machine as Android Studio?
stf local and Android Studio run on the same machine will cause error ?
  FTL/reaper 28116 [reaper001] Unable to load initial state { name: 'ReqlOpFailedError',
  msg: 'Index `present` was not found on table `stf.devices`.',
  frames: [],
  message: 'Index `present` was not found on table `stf.devices` in:\nr.table("devices").getAll(true, {index: "present"})\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^' }
FTL/util:lifecycle 28116 [reaper001] Shutting down due to fatal error
FTL/cli:local 28106 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.EventEmitter.emit (events.js:98:17)
    at Process.ChildProcess._handle.onexit (child_process.js:797:12)
  I have installed docker and pulled the image from the docker hub. 
Now i am confused what to do next?
Do i need to install all the requirements explicitly on my ubuntu machine including rethinkdb ?
I have also tried to ref. to the solution given by you but you have mentioned there to see the deployment file, which makes me confused to understand difference between stf local and actual deployment.

Can you please help me.
 HI 

Thanks for your reply.

Yes i am reading coreos in the meanwhile i have installed docker on ubuntu 14.04 lts and trying to get the things done.

I have also tried the "Mitesh Shah" method , by that i am able to create the tables in the db but i am getting an error of  stf device. Can you help me in this

FTL/reaper 28116 [reaper001] Unable to load initial state { name: 'ReqlOpFailedError',
  msg: 'Index `present` was not found on table `stf.devices`.',
  frames: [],
  message: 'Index `present` was not found on table `stf.devices` in:\nr.table("devices").getAll(true, {index: "present"})\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^' }
FTL/util:lifecycle 28116 [reaper001] Shutting down due to fatal error
FTL/cli:local 28106 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.EventEmitter.emit (events.js:98:17)
    at Process.ChildProcess._handle.onexit (child_process.js:797:12)
 Hi
 I am able to up the system and up the ui on 7100 port . Currently it is showing zero devices connected.
To test i started android studio on which i have installed genymotion. When i start avirtual device from genymotion , i suddenly get an error , which says try reconnect. can you please help me in resolving this

FTL/util:lifecycle 4024 [_] Tracker had an error Error: Connection closed
    at /usr/lib/node_modules/stf/node_modules/adbkit/lib/adb/tracker.js:22:15
    at tryCatcher (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at CatchFilter.doFilter (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/catch_filter.js:40:36)
    at CatchFilter.tryCatcher (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/util.js:26:23)
    at Promise._settlePromiseFromHandler (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:503:31)
    at Promise._settlePromiseAt (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:577:18)
    at Promise._settlePromises (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/promise.js:693:14)
    at Async._drainQueue (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:123:16)
    at Async._drainQueues (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:133:10)
    at Async.drainQueues (/usr/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/async.js:15:14)
    at process._tickCallback (node.js:415:13)
FTL/util:lifecycle 4024 [_] Shutting down due to fatal error
FTL/cli:local 4011 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.EventEmitter.emit (events.js:98:17)
    at Process.ChildProcess._handle.onexit (child_process.js:797:12)
INF/cli:local 4011 [_] Shutting down all child processes
INF/util:lifecycle 4015 [app001] Winding down for graceful exit
INF/util:lifecycle 4016 [dev001] Winding down for graceful exit
INF/util:lifecycle 4017 [proc001] Winding down for graceful exit
INF/util:lifecycle 4020 [proc002] Winding down for graceful exit
INF/util:lifecycle 4022 [reaper001] Winding down for graceful exit
WRN/db 4022 [reaper001] Connection closed
INF/db 4022 [reaper001] Connecting to 127.0.0.1:28015
WRN/db 4017 [proc001] Connection closed
INF/db 4017 [proc001] Connecting to 127.0.0.1:28015
INF/util:lifecycle 4026 [_] Winding down for graceful exit
INF/util:lifecycle 4028 [_] Winding down for graceful exit
INF/auth-mock 4026 [_] Waiting for client connections to end
INF/util:lifecycle 4029 [_] Winding down for graceful exit
WRN/db 4020 [proc002] Connection closed
INF/db 4020 [proc002] Connecting to 127.0.0.1:28015
WRN/db 4029 [_] Connection closed
WRN/db 4028 [_] Connection closed
INF/db 4029 [_] Connecting to 127.0.0.1:28015
INF/db 4028 [_] Connecting to 127.0.0.1:28015
 Hi,

Thanks the system is up on Ubuntu 14.04 LTS single machine and now I'm exploring it.
But yes the best thing would be to setup the production environment using core os.
  my device sometimes does not work and the server gives the following message, util i restart stf . anybody can give me a hand?

INF/device:plugins:service 28177 [030b337e215f78a6] Launching service
FTL/device:plugins:service 28177 [030b337e215f78a6] Service connection could not be relaunched Error: Service had an error: "Error type 2"
    at /root/stf/stf/lib/units/device/plugins/service.js:155:23
From previous event:
    at /root/stf/stf/lib/units/device/plugins/service.js:130:14
    at processImmediate [as _immediateCallback](timers.js:358:17)
From previous event:
    at callService (/root/stf/stf/lib/units/device/plugins/service.js:124:10)
    at openService (/root/stf/stf/lib/units/device/plugins/service.js:172:14)
    at Socket.endListener (/root/stf/stf/lib/units/device/plugins/service.js:195:9)
    at Socket.g (events.js:199:16)
    at Socket.emit (events.js:129:20)
    at _stream_readable.js:908:16
    at process._tickCallback (node.js:355:11)
FTL/util:lifecycle 28177 [030b337e215f78a6] Shutting down due to fatal error
INF/provider 28011 [_] Cleaning up device worker "030b337e215f78a6"
ERR/provider 28011 [_] Device worker "030b337e215f78a6" died with code 1
INF/provider 28011 [*] Restarting device worker "030b337e215f78a6"

  error: missing required argument `--screen-port'
 thank you very much!
 I was also tackling with similar kind of issue for Sendgrid.

I got it worked by adding following header.

"Content-Type": "application/json; charset=utf8"  Hello.

I'm trying to run stf locally and I have a problem with connecting to RethinkDB from Docker. Is there any reason why don't you put rethinkdb server startup in dockerfile?

Could you provide any support to help me connect stf to rethinkdb locally on docker containers?

Cheers!
  Hi , i am mad on remote debug recently 
i find that eclipse "run as" runs very well but eclipse "debug as" just a little slow. but i think the data for debuging is smaller than the screen data from minicap , so how can "debug as" be so slow ?
  When i press screenshot button press disconnect stf server connection.

Logs:
 Capturing screenshot
INF/storage:temp 3724 [*] Uploaded "591ed406.jpg" to "/var/folders/_2/gtz250tn4ql569c0y733t8tc0000gn/T/upload_be05e340923862c495043ede59fd8e75"
INF/device:support:storage 3728 [591ed406] Uploaded to "/s/image/6bc210e8-fd35-4333-b1e2-a2cfcd8ed991/591ed406.jpg"
events.js:141
      throw er; // Unhandled 'error' event
      ^

Error: spawn gm ENOENT
    at exports._errnoException (util.js:874:11)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:178:32)
    at onErrorNT (internal/child_process.js:344:16)
    at doNTCallback2 (node.js:439:9)
    at process._tickCallback (node.js:353:17)
ERR/poorxy 3727 [_] Proxy had an error Error: socket hang up
    at createHangUpError (_http_client.js:203:15)
    at Socket.socketOnEnd (_http_client.js:288:23)
    at emitNone (events.js:72:20)
    at Socket.emit (events.js:166:7)
    at endReadableNT (_stream_readable.js:903:12)
    at doNTCallback2 (node.js:439:9)
    at process._tickCallback (node.js:353:17)
FTL/cli:local 3713 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/Users/software/Downloads/DeviceTest/stf-master/lib/util/procutil.js:49:23)
    at emitTwo (events.js:87:13)
    at ChildProcess.emit (events.js:172:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)
INF/cli:local 3713 [_] Shutting down all child processes
INF/util:lifecycle 3715 [app001] Winding down for graceful exit
INF/util:lifecycle 3716 [dev001] Winding down for graceful exit
INF/util:lifecycle 3717 [proc001] Winding down for graceful exit
INF/util:lifecycle 3718 [proc002] Winding down for graceful exit
INF/util:lifecycle 3719 [reaper001] Winding down for graceful exit
INF/util:lifecycle 3723 [_] Winding down for graceful exit
INF/util:lifecycle 3720 [_] Winding down for graceful exit
INF/util:lifecycle 3721 [_] Winding down for graceful exit
INF/auth-mock 3721 [_] Waiting for client connections to end
INF/util:lifecycle 3722 [_] Winding down for graceful exit
INF/provider 3720 [_] Gracefully killing device worker "591ed406"
INF/util:lifecycle 3728 [591ed406] Winding down for graceful exit
INF/device:plugins:screen:stream 3728 [591ed406] Requesting frame producer to stop
WRN/db 3717 [proc001] Connection closed
INF/device:plugins:screen:stream 3728 [591ed406] Disconnecting from minicap service
WRN/db 3718 [proc002] Connection closed
INF/db 3717 [proc001] Connecting to 127.0.0.1:28015
INF/db 3718 [proc002] Connecting to 127.0.0.1:28015
WRN/db 3719 [reaper001] Connection closed
INF/db 3719 [reaper001] Connecting to 127.0.0.1:28015
IMP/device:plugins:group 3728 [591ed406] No longer owned by "hpatel@yopmail.com"
INF/device:plugins:group 3728 [591ed406] Unsubscribing from group channel "vb79K3IVRUubV2CtbBAl1A=="
WRN/db 3723 [_] Connection closed
INF/db 3723 [_] Connecting to 127.0.0.1:28015
INF/provider 3720 [_] Device worker "591ed406" stopped cleanly
INF/provider 3720 [*] Device worker "591ed406" has retired
 I install GraphicsMagick and image capture successfully but image is broken can't open in browser.
 I put GraphicsMagick version
softwares-iMac-2:platform-tools software$ gm version
GraphicsMagick 1.3.22 2015-10-04 Q8 http://www.GraphicsMagick.org/
Copyright (C) 2002-2015 GraphicsMagick Group.
Additional copyrights and licenses apply to this software.
See http://www.GraphicsMagick.org/www/Copyright.html for details.

Feature Support:
  Native Thread Safe       yes
  Large Files (> 32 bit)   yes
  Large Memory (> 32 bit)  yes
  BZIP                     yes
  DPS                      no
  FlashPix                 no
  FreeType                 no
  Ghostscript (Library)    no
  JBIG                     no
  JPEG-2000                no
  JPEG                     no
  Little CMS               no
  Loadable Modules         no
  OpenMP                   no
  PNG                      no
  TIFF                     no
  TRIO                     no
  UMEM                     no
  WebP                     no
  WMF                      no
  X11                      no
  XML                      yes
  ZLIB                     yes

Host type: x86_64-apple-darwin15.0.0

Configured using the command:
  ./configure 

Final Build Parameters:
  CC       = gcc
  CFLAGS   = -g -O2 -Wall -D_THREAD_SAFE
  CPPFLAGS = -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk/usr/include/libxml2
  CXX      = g++
  CXXFLAGS = -D_THREAD_SAFE
  LDFLAGS  = -L/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk/usr/lib
  LIBS     = -lbz2 -lxml2 -lz -lm -lpthread
 Physical location of screenshots file in mac?
  my adb server and STF is in different host, can i use this option to set the adb server ? 

``` shell
stf local -R  --adb-host 172.18.146.123 
```

and on my 172.18.146.123 host, i run

``` shell
adb kill-server && adb start-server
```

but STF report

``` shell
Unhandled rejection Error: connect ECONNREFUSED 172.18.146.123:5037
    at Object.exports._errnoException (util.js:874:11)
    at exports._exceptionWithHostPort (util.js:897:20)
    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1063:14)
```

anybody who knows where am i wrong ? Thanks
 This is because stf is not able to connect adb host server. By default adb server listen only on localhost. In order to make it a remote host you must have to make it listen on all network interfaces.

Start adb server with below command

```
adb kill-server      # Just to make sure
adb -a -P 5037 fork-server server&
```

And restart stf using the same command, `stf local -R  --adb-host 172.18.146.123`. It should work.
  I want to update the STF UI Theme, hide some button or some useless module for me. But when i change some jade file, and restart STF, i found it doesn't work. 

What's more, does STF use some build tool? i see the build directory, how to rebuild STF?

Thanks
 I haven't used this two tools before, i install gulp through `npm install gulp` and in the stf derctory run common `gulp clean`, it reports this error

``` shell
[10:03:25] No gulpfile found
```

this is my directory
![image](https://cloud.githubusercontent.com/assets/3864063/10836824/26339644-7eed-11e5-970f-0d5160f50ca8.png)

i install stf through `npm install stf`, why i miss the file gulpfile ?
 yes, your answer is helpful for me, thank you.

But when i run `gulp clean`, report many module miss error, now i just `npm install` them one by one. I think there must be some auto install scripts? 

---

I read the stf document again, and found what i need, thank you, i think my bad english is now my big problem .....
  Error was:

```
ERROR in ./~/css-loader!./~/sass-loader!./res/web_modules/nine-bootstrap/nine-bootstrap.scss
Module build failed:
.btn &.disabled,
    ^
      Base-level rules cannot contain the parent-selector-referencing character '&'.

Backtrace:
    stdin:395
      in /Users/Github/stf/res/web_modules/nine-bootstrap/nine-bootstrap.scss (line 395, column 6)
 @ ./res/web_modules/nine-bootstrap/nine-bootstrap.scss 4:14-137
```
  When i run this http://localhost:7404 url in my mac- chrome browser, blank web page display.

Log
INF/provider 8654 [_] Device "23b11e90" is now "device" (was "offline")
INF/device:support:push 9317 [23b11e90] Sending output to "tcp://127.0.0.1:7116"
INF/device 9317 [23b11e90] Preparing device
INF/device:support:sub 9317 [23b11e90] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 9317 [23b11e90] Subscribing to permanent channel "_ALL"
INF/device:support:properties 9317 [23b11e90] Loading properties
INF/device:support:abi 9317 [23b11e90] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 9317 [23b11e90] Checking whether we need to install STFService
INF/device:resources:service 9317 [23b11e90] Running version check
INF/device:resources:service 9317 [23b11e90] STFService up to date
INF/device:plugins:service 9317 [23b11e90] Launching agent
INF/device:plugins:service 9317 [23b11e90] Launching service
INF/device:plugins:service 9317 [23b11e90] Agent says: "Listening on port 1090"
INF/device:plugins:service 9317 [23b11e90] Agent says: "InputClient started"
INF/provider 8654 [_] Providing 2 of 1 device(s); waiting for "23b11e90"
INF/device:plugins:display 9317 [23b11e90] Reading display info
INF/device:plugins:phone 9317 [23b11e90] Fetching phone info
INF/device:plugins:identity 9317 [23b11e90] Solving identity
INF/device:plugins:solo 9317 [23b11e90] Subscribing to permanent channel "e8eKWom6kdFoDU+xSlbBFomw/N8="
INF/device:plugins:screen:stream 9317 [23b11e90] Starting WebSocket server on port 7408
WRN/device:plugins:data 9317 [23b11e90] Unable to find device data { serial: '23b11e90',
  platform: 'Android',
  manufacturer: 'SAMSUNG',
  operator: null,
  model: 'GT-S7562',
  version: '4.0.4',
  abi: 'armeabi-v7a',
  sdk: '15',
  product: 'kylexx',
  display: 
   { id: 0,
     width: 480,
     height: 800,
     xdpi: 239.06,
     ydpi: 236.28,
     size: 3.94,
     density: 1.5,
     fps: 60,
     secure: false,
     rotation: 0,
     url: 'ws://localhost:7408' },
  phone: { imei: '--------', network: 'UNKNOWN' } }
INF/device:plugins:touch 9317 [23b11e90] Touch origin is top left
INF/device:plugins:touch 9317 [23b11e90] Requesting touch consumer to start
INF/device:plugins:touch 9317 [23b11e90] Launching screen service
INF/device:plugins:touch 9317 [23b11e90] Connecting to minitouch service
INF/device:plugins:touch 9317 [23b11e90] minitouch says: "Type B touch device sec_touchscreen (480x800 with 5 contacts) detected on /dev/input/event0 (score 1100)"
INF/device:plugins:touch 9317 [23b11e90] minitouch says: "Connection established"
INF/device:plugins:touch 9317 [23b11e90] Reading minitouch banner
INF/device:plugins:vnc 9317 [23b11e90] Starting VNC server on port 7410
INF/device:plugins:browser 9317 [23b11e90] Loading browser list
INF/device:plugins:browser 9317 [23b11e90] Updating browser list
WRN/device:plugins:browser 9317 [23b11e90] Unmapped browser "devian.tubemate.home"
INF/device:plugins:mute 9317 [23b11e90] Will not mute master volume during use
INF/device:plugins:forward 9317 [23b11e90] Launching reverse port forwarding service
INF/device:plugins:forward 9317 [23b11e90] Connecting to reverse port forwarding service
INF/device:plugins:connect 9317 [23b11e90] Listening on port 7409
INF/device 9317 [23b11e90] Fully operational
INF/provider 8654 [_] Providing all 1 device(s)
 Same issue with this url http://localhost:7100/auth/mock/

My phone run STFService running successfully.
 Yes i followed all instruction from README.
 If you want some log report from me i'll provide you.
 Now working fine i followed all steps from REDME
 @hemant4524  please tell me,how to fix it...  I installed all module:
![screen shot 2015-10-23 at 9 57 30 am](https://cloud.githubusercontent.com/assets/12729083/10684598/b1a6f882-796c-11e5-9302-a3e2cb80fdb8.png)

module.js:339
    throw err;
    ^

Error: Cannot find module 'zmq'
    at Function.Module._resolveFilename (module.js:337:15)
    at Function.Module._load (module.js:287:25)
    at Module.require (module.js:366:17)
    at require (module.js:385:17)
    at Object.<anonymous> (/Users/software/Downloads/Device Test/stf-master/lib/util/zmqutil.js:7:11)
    at Module._compile (module.js:435:26)
    at Object.Module._extensions..js (module.js:442:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:311:12)
    at Module.require (module.js:366:17)
    at require (module.js:385:17)
    at Object.<anonymous> (/Users/software/Downloads/Device Test/stf-master/lib/units/triproxy/index.js:3:15)
    at Module._compile (module.js:435:26)
    at Object.Module._extensions..js (module.js:442:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:311:12)
FTL/cli:local 40746 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/Users/software/Downloads/Device Test/stf-master/lib/util/procutil.js:49:23)
    at emitTwo (events.js:87:13)
    at ChildProcess.emit (events.js:172:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)
INF/cli:local 40746 [_] Shutting down all child processes
 node -v : v4.2.1
npm -v : 2.14.7
brew -v : Homebrew 0.9.5
sw_vers : ProductName:  Mac OS X
ProductVersion: 10.11

## BuildVersion:   15A284

how you installed node/npm? 
-> Install node/npm installation dmg file and command line instruction follows from website.

Is there any changes require in this file
zmqutil.js

// ISSUE-100 (https://github.com/openstf/stf/issues/100)

// In some networks TCP Connection dies if kept idle for long.
// Setting TCP_KEEPALIVE option true, to all the zmq sockets
// won't let it die

var zmq = require('zmq')

var log = require('./logger').createLogger('util:zmqutil')

module.exports.socket = function() {
  var sock = zmq.socket.apply(zmq, arguments)

  ;['ZMQ_TCP_KEEPALIVE', 'ZMQ_TCP_KEEPALIVE_IDLE'].forEach(function(opt) {
    if (process.env[opt]) {
      try {
        sock.setsockopt(zmq[opt], +process.env[opt])
      }
      catch (err) {
        log.warn('ZeroMQ library too old, no support for %s', opt)
      }
    }
  })

  return sock
}
 I solve this error used this command

$ npm install zmq
https://github.com/JustinTulloss/zeromq.node
 Thank you for reply,
I install rethinkdb and run in browser 
http://localhost:8080/
when run 
$ stf local
Following url type in browser
http://localhost:7100
but nothing display in browser (http://localhost:7100/auth/mock/)

Log 
ERROR in ../res/app/app.js
Module not found: Error: Cannot resolve module 'angular' in /Users/software/Downloads/DeviceTest/stf-master/res/app
 @ ../res/app/app.js 3:2-20

ERROR in ../res/app/app.js
Module not found: Error: Cannot resolve module 'angular-route' in /Users/software/Downloads/DeviceTest/stf-master/res/app
 @ ../res/app/app.js 4:2-26

ERROR in ../res/app/app.js
Module not found: Error: Cannot resolve module 'angular-touch' in /Users/software/Downloads/DeviceTest/stf-master/res/app
 @ ../res/app/app.js 5:2-26

ERROR in ../res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular' in /Users/software/Downloads/DeviceTest/stf-master/res/auth/ldap/scripts
 @ ../res/auth/ldap/scripts/entry.js 4:2-20

ERROR in ../res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-route' in /Users/software/Downloads/DeviceTest/stf-master/res/auth/ldap/scripts
 @ ../res/auth/ldap/scripts/entry.js 5:2-26

ERROR in ../res/auth/ldap/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-touch' in /Users/software/Downloads/DeviceTest/stf-master/res/auth/ldap/scripts
 @ ../res/auth/ldap/scripts/entry.js 6:2-26

ERROR in ../res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular' in /Users/software/Downloads/DeviceTest/stf-master/res/auth/mock/scripts
 @ ../res/auth/mock/scripts/entry.js 4:2-20

ERROR in ../res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-route' in /Users/software/Downloads/DeviceTest/stf-master/res/auth/mock/scripts
 @ ../res/auth/mock/scripts/entry.js 5:2-26

ERROR in ../res/auth/mock/scripts/entry.js
Module not found: Error: Cannot resolve module 'angular-touch' in /Users/software/Downloads/DeviceTest/stf-master/res/auth/mock/scripts
 @ ../res/auth/mock/scripts/entry.js 6:2-26

ERROR in ../res/web_modules/angular-hotkeys/index.js
Module not found: Error: Cannot resolve module 'angular-hotkeys/build/hotkeys.css' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/angular-hotkeys
 @ ../res/web_modules/angular-hotkeys/index.js 1:0-44

ERROR in ../res/web_modules/angular-hotkeys/index.js
Module not found: Error: Cannot resolve module 'angular-hotkeys/build/hotkeys.js' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/angular-hotkeys
 @ ../res/web_modules/angular-hotkeys/index.js 3:0-43

ERROR in ../res/web_modules/gettext/index.js
Module not found: Error: Cannot resolve module 'angular-gettext' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/gettext
 @ ../res/web_modules/gettext/index.js 1:0-26

ERROR in ../res/web_modules/nine-bootstrap/index.js
Module not found: Error: Cannot resolve module 'bootstrap/dist/css/bootstrap.css' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/nine-bootstrap
 @ ../res/web_modules/nine-bootstrap/index.js 1:0-43

ERROR in ../res/web_modules/nine-bootstrap/index.js
Module not found: Error: Cannot resolve module 'components-font-awesome/css/font-awesome.css' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/nine-bootstrap
 @ ../res/web_modules/nine-bootstrap/index.js 5:0-55

ERROR in ../res/web_modules/nine-bootstrap/index.js
Module not found: Error: Cannot resolve module 'font-lato-2-subset' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/nine-bootstrap
 @ ../res/web_modules/nine-bootstrap/index.js 7:0-29

ERROR in ../res/web_modules/angular-borderlayout/index.js
Module not found: Error: Cannot resolve module 'angular-borderlayout/src/borderLayout.js' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/angular-borderlayout
 @ ../res/web_modules/angular-borderlayout/index.js 1:0-51

ERROR in ../res/web_modules/angular-borderlayout/index.js
Module not found: Error: Cannot resolve module 'angular-borderlayout/src/borderLayout.css' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/angular-borderlayout
 @ ../res/web_modules/angular-borderlayout/index.js 2:0-52

ERROR in ../res/web_modules/ui-bootstrap/index.js
Module not found: Error: Cannot resolve module 'angular-bootstrap/ui-bootstrap-tpls' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/ui-bootstrap
 @ ../res/web_modules/ui-bootstrap/index.js 1:0-53

ERROR in ../res/app/components/stf/device/device-service.js
Module not found: Error: Cannot resolve module 'oboe' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/device
 @ ../res/app/components/stf/device/device-service.js 1:11-26

ERROR in ../res/app/components/stf/common-ui/notifications/index.js
Module not found: Error: Cannot resolve module 'angular-animate' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/common-ui/notifications
 @ ../res/app/components/stf/common-ui/notifications/index.js 1:0-26

ERROR in ../res/app/settings/general/local/index.js
Module not found: Error: Cannot resolve module 'angular-bootstrap/ui-bootstrap-tpls' in /Users/software/Downloads/DeviceTest/stf-master/res/app/settings/general/local
 @ ../res/app/settings/general/local/index.js 1:0-28

ERROR in ../res/app/components/stf/common-ui/enable-autofill/index.js
Module not found: Error: Cannot resolve module 'angular-cookies' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/common-ui/enable-autofill
 @ ../res/app/components/stf/common-ui/enable-autofill/index.js 1:0-26

ERROR in ../res/app/components/stf/common-ui/table/index.js
Module not found: Error: Cannot resolve module 'ng-table/dist/ng-table' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/common-ui/table
 @ ../res/app/components/stf/common-ui/table/index.js 2:0-40

ERROR in ../res/web_modules/ng-context-menu/index.js
Module not found: Error: Cannot resolve module 'ng-context-menu/dist/ng-context-menu' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/ng-context-menu
 @ ../res/web_modules/ng-context-menu/index.js 1:0-47

ERROR in ../res/app/control-panes/dashboard/clipboard/index.js
Module not found: Error: Cannot resolve module 'angular-elastic' in /Users/software/Downloads/DeviceTest/stf-master/res/app/control-panes/dashboard/clipboard
 @ ../res/app/control-panes/dashboard/clipboard/index.js 3:0-26

ERROR in ../res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/rect.js' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/angular-packery
 @ ../res/app/components/stf/angular-packery/index.js 3:0-29

ERROR in ../res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/packer.js' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/angular-packery
 @ ../res/app/components/stf/angular-packery/index.js 4:0-31

ERROR in ../res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/item.js' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/angular-packery
 @ ../res/app/components/stf/angular-packery/index.js 5:0-29

ERROR in ../res/app/components/stf/angular-packery/index.js
Module not found: Error: Cannot resolve module 'packery/js/packery.js' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/angular-packery
 @ ../res/app/components/stf/angular-packery/index.js 6:14-46

ERROR in ../res/app/components/stf/logcat/logcat-service.js
Module not found: Error: Cannot resolve module 'underscore.string/index' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/logcat
 @ ../res/app/components/stf/logcat/logcat-service.js 2:9-37

ERROR in ../res/app/components/stf/common-ui/modals/fatal-message/index.js
Module not found: Error: Cannot resolve module 'angular-route' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/common-ui/modals/fatal-message
 @ ../res/app/components/stf/common-ui/modals/fatal-message/index.js 1:0-24

ERROR in ../res/web_modules/angular-growl/index.js
Module not found: Error: Cannot resolve module 'angular-growl-v2/build/angular-growl.js' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/angular-growl
 @ ../res/web_modules/angular-growl/index.js 1:0-50

ERROR in ../res/web_modules/angular-ladda/index.js
Module not found: Error: Cannot resolve module 'angular-ladda/src/angular-ladda' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/angular-ladda
 @ ../res/web_modules/angular-ladda/index.js 3:0-42

ERROR in ../res/web_modules/ng-file-upload/index.js
Module not found: Error: Cannot resolve module 'ng-file-upload/angular-file-upload-shim' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/ng-file-upload
 @ ../res/web_modules/ng-file-upload/index.js 1:0-50

ERROR in ../res/web_modules/ng-file-upload/index.js
Module not found: Error: Cannot resolve module 'ng-file-upload/angular-file-upload' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/ng-file-upload
 @ ../res/web_modules/ng-file-upload/index.js 2:0-45

ERROR in ../res/app/components/stf/angular-draggabilly/index.js
Module not found: Error: Cannot resolve module 'draggabilly' in /Users/software/Downloads/DeviceTest/stf-master/res/app/components/stf/angular-draggabilly
 @ ../res/app/components/stf/angular-draggabilly/index.js 1:18-40

ERROR in ../res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'jquery' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/epoch
 @ ../res/web_modules/epoch/index.js 1:0-17

ERROR in ../res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'd3' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/epoch
 @ ../res/web_modules/epoch/index.js 3:0-13

ERROR in ../res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'epoch/epoch.min.css' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/epoch
 @ ../res/web_modules/epoch/index.js 4:0-30

ERROR in ../res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'epoch/epoch.min.js' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/epoch
 @ ../res/web_modules/epoch/index.js 5:0-29

ERROR in ../res/web_modules/epoch/index.js
Module not found: Error: Cannot resolve module 'ng-epoch' in /Users/software/Downloads/DeviceTest/stf-master/res/web_modules/epoch
 @ ../res/web_modules/epoch/index.js 6:0-19
 @hemant4524 anyupdate on issue but nothing display in browser (http://localhost:7100/auth/mock/)
 I solve this problem following the commands
1.brew install zeromq
it will solve can not find libzmq problem when just run npm install zmq
2.npm install zmq
  indexWait does not report actual availability of index form query so we need to use actual query to verify an index is actually ready.

We need to process simple indexes (index with no indexFunction option) first before processing the complex indexes (which may be dependent to simple indexes).

Example log:
INF/db 24299 [_] Connecting to 127.0.0.1:28015
INF/db:setup 24299 [_] Database "stf" created
INF/db:setup 24299 [_] Table "vncauth" created
INF/db:setup 24299 [_] Processing simple indexes [ 'response' ]
INF/db:setup 24299 [_] Table "devices" created
INF/db:setup 24299 [_] Processing simple indexes [ 'present' ]
INF/db:setup 24299 [_] Table "users" created
INF/db:setup 24299 [_] Processing simple indexes []
INF/db:setup 24299 [_] Processing non-simple indexes [ 'adbKeys' ]
INF/db:setup 24299 [_] Index "vncauth"."response" created
INF/db:setup 24299 [_] Index "devices"."present" created
INF/db:setup 24299 [_] Waiting for index "vncauth"."response"
INF/db:setup 24299 [_] Waiting for index "devices"."present"
INF/db:setup 24299 [_] Index "users"."adbKeys" created
INF/db:setup 24299 [_] Waiting for index "users"."adbKeys"
INF/db:setup 24299 [_] Table "logs" created
INF/db:setup 24299 [_] Index "devices"."present" is ready
INF/db:setup 24299 [_] Processing non-simple indexes [ 'owner', 'providerChannel' ]
INF/db:setup 24299 [_] Index "vncauth"."response" is ready
INF/db:setup 24299 [_] Processing non-simple indexes [ 'responsePerDevice' ]
INF/db:setup 24299 [_] Index "users"."adbKeys" is ready
INF/db:setup 24299 [_] Index "devices"."owner" created
INF/db:setup 24299 [_] Waiting for index "devices"."owner"
INF/db:setup 24299 [_] Index "vncauth"."responsePerDevice" created
INF/db:setup 24299 [_] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 24299 [_] Index "devices"."providerChannel" created
INF/db:setup 24299 [_] Waiting for index "devices"."providerChannel"
INF/db:setup 24299 [_] Index "devices"."owner" is ready
INF/db:setup 24299 [_] Index "vncauth"."responsePerDevice" is ready
INF/db:setup 24299 [_] Index "devices"."providerChannel" is ready
 I finally solve this by upgrading rethinkdb to 2.2.1 (via brew)
  Issue: https://github.com/openstf/stf/issues/124
### When there are no notes .

![screen shot 2015-10-23 at 01 43 01](https://cloud.githubusercontent.com/assets/7875161/10671808/a693977e-7927-11e5-824d-10cb589ffd7c.png)
### On hover

![screen shot 2015-10-23 at 01 43 12](https://cloud.githubusercontent.com/assets/7875161/10671833/c4708fcc-7927-11e5-824f-f2102719dfd3.png)
### On click

![screen shot 2015-10-23 at 01 43 56](https://cloud.githubusercontent.com/assets/7875161/10671839/cc8057c4-7927-11e5-9b35-493587574783.png)
### After adding note

![screen shot 2015-10-23 at 01 44 06](https://cloud.githubusercontent.com/assets/7875161/10671845/d83280c4-7927-11e5-90d5-806855d0927b.png)
# UPDATE
### When there are no notes

![screen shot 2015-11-14 at 00 30 46](https://cloud.githubusercontent.com/assets/7875161/11149690/749b5c38-8a67-11e5-8c9d-737c65f1ab1f.png)
### On hover

![screen shot 2015-11-14 at 00 31 06](https://cloud.githubusercontent.com/assets/7875161/11149692/78199424-8a67-11e5-92c2-cd56f51267e4.png)
### On Edit

![screen shot 2015-11-14 at 00 31 35](https://cloud.githubusercontent.com/assets/7875161/11149697/81b03e8e-8a67-11e5-85f2-01453bfdaf77.png)
### After Editing

![screen shot 2015-11-14 at 00 33 56](https://cloud.githubusercontent.com/assets/7875161/11149702/86703cbc-8a67-11e5-9289-78e29c65c545.png)
### On hover

![screen shot 2015-11-14 at 00 36 19](https://cloud.githubusercontent.com/assets/7875161/11149756/c1dc99e4-8a67-11e5-8449-7aae577a2d70.png)
  module.js:339
    throw err;
    ^

Error: Cannot find module 'commander'
    at Function.Module._resolveFilename (module.js:337:15)
    at Function.Module._load (module.js:287:25)
    at Module.require (module.js:366:17)
    at require (module.js:385:17)
    at Object.<anonymous> (/Users/software/Downloads/stf-master/lib/cli.js:4:15)
    at Module._compile (module.js:435:26)
    at Object.Module._extensions..js (module.js:442:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:311:12)
    at Module.require (module.js:366:17)

I installed all module and run ./stf local in mac os X give me above error.
 Can you provide me for installation video tutorial for mac os?
  Hi,

We would like to know how to setup a development environment.
We searched in your documentations and didn't find how to run STF from the source code.
How can we modify the source code and deploy the changes?

Thanks.
 Thanks, we had an error during the npm install and we missed it.
  I am running STF locally on my Windows 7 and linked to remote rethinkdb on other Linux VM. Everything works fine except no English word shown in Chrome. But when I set it to Japanese or Russian, it shows properly. Could you please give me some hints about solving this problem? I am thinking if it relates to Jade. Thanks.
 Does anyone try to connect STF from Chrome on Win 7? I got no English Support only Japanese and Russian. And also I got nothing shown from IE on Win 7. Local Linux Firefox could work. I start STF by using: stf local --public-ip xxx on my Linux and try to connect it from other Win 7. Thanks. 
 Thank you for your reply.

My environment is Windows 7 (Version 6.1.7601) with  Chrome 43.0.2357.132

By the way the system is running on a virtual machine, I think it relates to the problem since my PC with Windows works fine also. 

I am sorry for the inconvenient that I cannot upload screenshot since I am in company network. The browser just cannot show all the English words, but other pictures and functions just works fine.

Thanks. 
 @vbanthia Thank for your help. But it still can not fix the bug.
@gunta I have tried to disabled all extensions but still not work. Thanks anyway. The Firefox works fine in my environment. It should be caused by some setting problems of my Chrome.
 I finally figured it out. Deleted the Lato from font-family worked for me. Thanks all.
 @gunta Yes. Sorry for the delay reply
 ![image](https://user-images.githubusercontent.com/16593799/39408690-a8f7fe78-4c0c-11e8-9e38-aa516fabf0a5.png)

env:    ubuntu 16,04   (vmware)  Hi, i am really amazing about the remote debug feature and i wonder how it works?
the data transferred from websocket or tcp socket?
can you just give me some explanations? thank you very much!
 if i want to use this feature through nginx, do i need to set tcp proxy?
 For remote debugging you can read the google official docs first, especially the port [forwarding section](https://developer.chrome.com/devtools/docs/remote-debugging)

And what do you mean by "use this feature through nginx"...Do you mean you want to deploy stf on real server (not run locally), and the web container you use is nginx? Then you will need a lot of public ip for this.

By the way...

> Hi, i am really amazing about the remote debug feature 

Generally you should not say you are amazing...it is the feature that is amazing.
  Hi. I met a bug. I had used latest version of openstf/stf in dockerfiles.
When I updated `openstf/stf:latest`, our journalctl shows below.

```
systemd[1]: Started STF dev triproxy.
docker[21135]: INF/triproxy 1 [dev] PUB socket bound on tcp://*:7250
docker[21135]: INF/triproxy 1 [dev] DEALER socket bound on tcp://*:7260
docker[21135]: INF/triproxy 1 [dev] PULL socket bound on tcp://*:7270
docker[21135]: Invalid argument (tcp.cpp:121)
systemd[1]: stf-triproxy-dev.service: main process exited, code=exited, status=139/n/a
```

And I checked `docker ps`, then stf-triproxy-dev rescheduled many times.
I found an issue and Pull Request related to the error.
https://github.com/openstf/stf/issues/109 https://github.com/openstf/stf/commit/b248e96dc2582f0176b3a75468fa18ab0036c3e1
Also, I assume that these codes are something bad for my environment.
https://github.com/JustinTulloss/zeromq.node/blob/master/lib/index.js#L324

My environment is Ubuntu 15.04, and zeromq libraries are

```
ii  libzmq1:amd64                       2.2.0+dfsg-6                        amd64        lightweight messaging kernel (shared library)
rc  libzmq3:amd64                       4.0.5+dfsg-2+deb8u1build0.15.04.1   amd64        lightweight messaging kernel (shared library)
ii  libzmq5:amd64                       4.1.2-1                             amd64        lightweight messaging kernel (shared library)
ii  libzmq5-dev:amd64                   4.1.2-1                             amd64        lightweight messaging kernel (development files)
```

Now I have changed from `openstf/stf:latest` to `openstf/stf:1.0.10` in all dockerfiles related to openstf, instead.

Thanks.
 >  It's included in the docker image.

Thanks. I use docker with service files in `DEPLOYMENT.md`.

I checked #104 yesterday before I post this. Also, I have removed all docker images yesterday, and pulled newest docker images. Of course I also killed all systemd processes (services) about this system.
 #104 made 13 days ago from now, but something odd to me because I made my STF environment yesterday. That's why I posted this Issue.

Thankfully, now I can see both you guys are checking this issue, and zeromq.
I will report after fixing bug with `openstf/stf:latest`.
  lib/units/provider/index.js
function spawn(){
var allocatedPorts = ports.splice(0, 2)
          , proc = options.fork(device, allocatedPorts)
          , resolver = Promise.defer()
...
}
after options.fork(...), allocatedPorts become empty, so that the allocated ports can not be returned.
to fix it, we should pass value of allocatedPorts, not its reference.
 proc = options.fork(device, allocatedPorts.slice())
 another issue:
some times the .finally() block in spawn() function is not executed.
I  moved the .finally() block after .catch() block, the .finally() block "finally" executed. 
I am not sure this is a bug in bluebird.
 Still have the same problem especially for Android 6.0 devices. 
I have 8 devices connected and four Android 6.0 devices met this problem after about 1 day. I can only restart the service to fix this error. Any idea to fix this? Thanks
 Thank you for your reply.
I am using ODROID-XU4 with Odroid([Ubuntu 15.04](http://odroid.com/dokuwiki/doku.php?id=en:xu3_ubuntu_release_note_20150710))
The power adapter is 5V 4A
DIPO USB HUB 2.0 12V 5A adapter. 2A X 10 2.0 ports
The uname -a information is blow:
Linux odroid 3.10.82-39 #1 SMP PREEMPT Fri Jul 10 17:12:32 BRT 2015 armv7l armv7l armv7l GNU/Linux
So you think maybe USB  connection caused this problem?
 I also have an other XU4 with the same system and connected 9 devices with the same USB Hub.
All the Android devices seem work fine for about a week and the only different is the XU4 don't have Android 6.0 connected. So I am not sure this is the kernel problem. Hope you could find this is kernel problem or not. 
Right now restarting service cannot solve the problem and there are two devices always show 
error missing required argument --screen-port
Since I am not at the same place with phones I cannot re plug it. And the adb devices show normally
 And also all the devices have flashed new ROM and rooted. They are using unofficial cables.
 Thank you for your advice. 

I have tracked devices and it seems not adb problem. I found the --screen-port error always shown on journalctl -u mystf.service, even I stop the service, so that I reboot all the servers and restart STF services. 

It is turned out the same error as #108 and #95. I am using the latest master code and tried three Android 6.0 devices, two of them have the error, the other one is fine. And also one Android 5.0 system has the same issue,too. I just checked all your commits relate to get compatibility for Android 6.0 and found issues under openstf minicap that some devices have error with the minicap. I am not sure why those error devices were successful the first time and got error after one day.  

Is this reason caused the problem and could you give me some debug hint about get compatibility for those "special" devices?

Sorry for bothering you again. Very appreciate.
 @sorccu 
This problem caused by unstable USB cable... Thank you for your help.
  I check the code and i need to set my own JWT token, but i don't know where to get the STF's secret or set my own secret.

the code is here
https://github.com/openstf/stf/blob/master/lib/units/app/middleware/auth.js#L10
 thanks, i use wrong option before
  # Overview

This feature provide optional storage type using Amazon S3.
# How to use

Add storage type option to launch arguments.

```
stf local --storage-type s3 --storage-options '["--bucket", "YOUR_BUCKET_NAME", "--endpoint", "ENDPOINT", "--profile", "YOUR_PROFILENAME"]'
```

Replace YOUR_BUCKET_NAME with your bucket name. Bucket name is required parameter. And replace ENDPOINT with S3 endpoint.  It wil use Tokyo region endpoint by default.  Replace YOUR_PROFILENAME with your credential profile name. It will refer 'stf-storage' by default. 
## Details and examples

Please refer wiki page.
[[https://github.com/hogehoge-banana/stf/wiki/%5Bja%5DUse-AmazonS3]]

Thanks.
 Hi sorccu

Thanks for check my PR. I'll fix them and another PR. There are some related comments.

Thanks.
Best
 Ah yes. My mean, Your comment is related to "booking" PR.
 Hi, sorccu

I fixed for comments. Please check them again.

Thanks.
Best
 It still works. Great! Thanks.
  Dear all

I have my own user database, how can i access STF with my own information ? 
 I find i don't describe right what i really want.

What i want to realize is not sign in from STF with mock-auth or ldap-auth, but let users be login state with my user database.

so users of my platform can access to the STF control page directly and the STF also know the device is used by whom.

I just don't want that when i redirect my logined users to the STF control page they have to sign in again.

@sorccu Please help me when you have time, thank you.
 ok, I finally get what you mean, i use JWT realize what i want, thank you all the same!
  Dear all:

I try to use STF in my platform, I want to read the devices' state from rethinkdb real time, and parse the device's serial, then jump to the phone control page directly.

The state i want to get is :
1. when the device is disconnected
2. when the device is connected, but preparing STF service
3. when the device is connected, but being used
4. when the device is connected, and is free

But i don't know which field ?

``` json
{
"abi":  "armeabi-v7a" ,
"airplaneMode": false ,
"battery": {
"health":  "good" ,
"level": 82 ,
"scale": 100 ,
"source":  "unknown_0" ,
"status":  "discharging" ,
"temp": 30 ,
"voltage": 3.967
} ,
"browser": {
"apps": [
{
"id":  "com.baidu.browser.inter/.BrowserActivity" ,
"name":  "Baidu" ,
"selected": false ,
"system": false ,
"type":  "baidu"
} ,
{
"id":  "com.google.android.browser/com.android.browser.BrowserActivity" ,
"name":  "Browser" ,
"selected": false ,
"system": true ,
"type":  "google-android-browser"
} ,
{
"id":  "com.opera.browser/com.opera.Opera" ,
"name":  "Opera" ,
"selected": false ,
"system": false ,
"type":  "opera"
} ,
{
"id":  "com.opera.mini.android/.Browser" ,
"name":  "Opera Mini" ,
"selected": false ,
"system": false ,
"type":  "opera-mini"
} ,
{
"id":  "com.opera.mini.native/com.opera.mini.android.Browser" ,
"name":  "Opera Mini" ,
"selected": false ,
"system": false ,
"type":  "opera-mini-native"
} ,
{
"id":  "com.UCMobile.intl/com.UCMobile.main.UCMobile" ,
"name":  "UC" ,
"selected": false ,
"system": false ,
"type":  "uc"
}
] ,
"selected": false
} ,
"channel":  "ELxYMOBOrR/NMj9TSalbkYBqjJg=" ,
"createdAt": Thu Oct 15 2015 07:46:31 GMT+00:00 ,
"display": {
"density": 2 ,
"fps": 58.98100280761719 ,
"height": 1280 ,
"id": 0 ,
"rotation": 0 ,
"secure": true ,
"size": 4.619571685791016 ,
"url":  "ws://172.18.182.19:7404" ,
"width": 720 ,
"xdpi": 315.3103332519531 ,
"ydpi": 318.7450866699219
} ,
"manufacturer":  "SAMSUNG" ,
"model":  "Galaxy Nexus" ,
"network": {
"connected": true ,
"failover": false ,
"roaming": false ,
"subtype":  "" ,
"type":  "WIFI"
} ,
"operator": null ,
"owner": null ,
"phone": {
"iccid": null ,
"imei":  "351554052641959" ,
"network":  "HSDPA" ,
"phoneNumber": null
} ,
"platform":  "Android" ,
"presenceChangedAt": Thu Oct 15 2015 08:59:31 GMT+00:00 ,
"present": false ,
"product":  "yakju" ,
"provider": {
"channel":  "6chwLcCuQj6VHvyoMYmHlQ==" ,
"name":  "liufuxindeMacBook-Pro.local"
} ,
"ready": true ,
"reverseForwards": [ ],
"sdk":  "18" ,
"serial":  "172.18.176.103:5555" ,
"status": 3 ,
"statusChangedAt": Thu Oct 15 2015 08:09:58 GMT+00:00 ,
"version":  "4.3"
}
```
 I have another platform, and I want to display the devices' state which are connected to STF in my platform, and users can choose the device which can be used, and jump to the STF's control page directly.

But, the problem is, when i read the device from rethinkdb the STF use, I find i can't know which device is connected and which can be used.

Thanks. I have no choice, but using a remote device, perhaps the device number is about 400.
 That code run in server ? I insert some debug code like:

``` javascript
function sync(data) {
      console.log('+++++++++++++++++++++++++++++++');
      // usable IF device is physically present AND device is online AND
      // preparations are ready AND the device has no owner or we are the
      // owner
      data.usable = data.present && data.status === 3 && data.ready &&
        (!data.owner || data.using)

      // Make sure we don't mistakenly think we still have the device
      if (!data.usable || !data.owner) {
        data.using = false
      }

      EnhanceDeviceService.enhance(data)
    }
```

but i have not seen any output in my server console.

when do the function sync run ?

Thanks again.
 i find what i need from the console output:

``` shell
INF/provider 3444 [*] Found device "172.18.176.138:5555" (offline)
INF/provider 3444 [*] Registered device "172.18.176.138:5555"
INF/reaper 3443 [reaper001] Device "172.18.176.138:5555" is present
INF/provider 3444 [*] Device "172.18.176.138:5555" is now "device" (was "offline")
INF/device:support:push 3463 [172.18.176.138:5555] Sending output to "tcp://127.0.0.1:7116"
INF/device 3463 [172.18.176.138:5555] Preparing device
INF/device:support:sub 3463 [172.18.176.138:5555] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 3463 [172.18.176.138:5555] Subscribing to permanent channel "*ALL"
INF/device:support:properties 3463 [172.18.176.138:5555] Loading properties
INF/device:support:abi 3463 [172.18.176.138:5555] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 3463 [172.18.176.138:5555] Checking whether we need to install STFService
INF/device:resources:service 3463 [172.18.176.138:5555] Running version check
INF/device:resources:service 3463 [172.18.176.138:5555] STFService up to date
INF/device:plugins:service 3463 [172.18.176.138:5555] Launching agent
INF/device:plugins:service 3463 [172.18.176.138:5555] Launching service
INF/device:plugins:service 3463 [172.18.176.138:5555] Agent says: "Listening on port 1090"
INF/device:plugins:service 3463 [172.18.176.138:5555] Agent says: "InputClient started"
INF/device:plugins:display 3463 [172.18.176.138:5555] Reading display info
INF/device:plugins:phone 3463 [172.18.176.138:5555] Fetching phone info
INF/device:plugins:identity 3463 [172.18.176.138:5555] Solving identity
INF/device:plugins:solo 3463 [172.18.176.138:5555] Subscribing to permanent channel "x/7BGbNJ2M+jTdnf9l9ehmN2x4E="
INF/device:plugins:screen:stream 3463 [172.18.176.138:5555] Starting WebSocket server on port 7400
INF/device:plugins:browser 3463 [172.18.176.138:5555] Loading browser list
INF/device:plugins:browser 3463 [172.18.176.138:5555] Updating browser list
WRN/device:plugins:browser 3463 [172.18.176.138:5555] Unmapped browser "com.snda.wifilocating"
WRN/device:plugins:browser 3463 [172.18.176.138:5555] Unmapped browser "com.baidu.searchbox"
INF/device:plugins:mute 3463 [172.18.176.138:5555] Will not mute master volume during use
WRN/device:plugins:data 3463 [172.18.176.138:5555] Unable to find device data { serial: '172.18.176.138:5555',
```

I can see the new device's life cycle. So i think i can insert hook code in the nodejs's server side, write these in a DB, so i can share the devices' state with my platform. Do you think this plan can be realized ?

Do you have another better ? 

sorry for disturb you so much....
 Can you describe more detail ? I just try some ways, but i don't know when and where the function sync execute.

I have not used nodejs before, please forgive my stupid question. 
 The JSON i posted ? i think your mean is that i insert some code into the function sync, so when the client side sync the device state to the server, it also sync the state to my own platform. is it right ?

can you tell me when the function sync execute ?
 Yes ! Perfect, this is what i really want. I understand what you mean. Thank you so much !

owner   : 'not null' if device has been used;
ready    : false if device is preparing ( may installing STF);
present : i see it always true...is it right ?
status   : i see it always 3

do i describe right ?
 Thanks, you are a so nice man. Thanks for your help, thanks.
  I want to run STF as a daemon in my server, but i don't see any right option in the help.
  Device List has a "Notes" column. I don't know what was the real intention behind this feature, but I can say it will be good to write notes or remarks for a device. 

Currently, it is only ReadOnly and there is no way to update this from STF UI. Only way is to update DB directly.

Can you tell me what was the real intention behind this column? And is there any plan to make it editable?
 Hi. I use this column as the place where I put the device in real.
I wrote how to update using RQL and you can use it if you needed.

Go to your Rethinkdb Admin Tool -> Data Explorer -> Run below RQL.
Change your own model and notes as you like!
if you have same model, change the filter.

```
r.do(
  r.db("stf").table("devices").filter({model: "SC-02C"}).update({"notes": "A1"}),
  r.db("stf").table("devices").filter({model: "SC-05G"}).update({"notes": "A2"}),
  r.db("stf").table("devices").filter({model: "SC-06D"}).update({"notes": "A3"}),
  r.db("stf").table("devices").filter({model: "Nexus 7"}).update({"notes": "B1"})
)
```
 In my case, I don't want to give users direct DB access thats why I was looking for some way to edit it from STF UI itself.

BTW, instead of using filters, you should use primaryKey to get a device which is device serial for "devices" table (https://github.com/openstf/stf/blob/master/lib/db/tables.js#L29). 

```
r.db("stf").table("devices").get('DEVICE_SERIAL').update({notes: "A1"})
```
 ah, i could understand well. thank you for your nice filter. :+1: 
 Pull request regarding this feature - https://github.com/openstf/stf/pull/147
  This was very helpful!  I try to let my STF server connect to a remote rethinkdb, but I have not found the right option. Everybody who knows that ? 

Thanks.
 Yes, thanks. I just find that. 

Another small question, if i change the nodejs code under '/usr/local/lib/node_modules/stf/', and restart the STF, do the change code work ?

Thanks.
 Thanks for your help.

I try to start remote rethinkdb like this:

``` shell
rethinkdb --http-port xxxx --bind xxx.xxx.xxx.xxx --driver-port 9901
```

and the rethinkdb response:

``` shell
Server ready, "liufuxinlucky365" ea74d40e-6ff0-46ee-a90e-0d9db54ad4ed
```

and i start stf like this:

``` shell
    export RETHINKDB_PORT_28015_TCP='tcp://xxx.xxx.xxx.xxx:9901'
    stf local --allow-remote
```

response:

``` shell
    INF/db 2690 [*] Connecting to xxx.xxx.xxx.xxx:9901
    FTL/db 2690 [*] Could not connect to xxx.xxx.xxx.xxx:9901, operation timed out.
```

but it seems that stf doesn't connect successfully. Have you ever try this feature ?
 That should be what you say. I change my port to 8999, and local can connect successfully. 

Thanks for your help.
  Hi, I have tried other Android based mobile systems like EMUI 3.0 and MIUI 6, but failed to connect. Have you considered support other Android based systems before? Could you please give me some hints about how to support them? Thanks. 
 Hi, thank you for your reply. I have figured it out that on my EMUI device, I need to accept a service manually on my phone and it worked. But I don't have to do it on my Galaxy.  Maybe it caused by the EMUI security configuration. Anyway, thanks. 
  Currently, shift-click does not work if click event is made on device icon. This fix will allow to start device remote control on standalone mode even click is made on device icon.
  I can see
![image](https://cloud.githubusercontent.com/assets/3281689/10482692/bcc4ad0c-72ac-11e5-9508-c181a9a8df62.png)

But really can't connect with vnc viewer. It seems the port 7042 is not listening.
 Hi,

We're looking for a way to create a VNC server and interact with Android devices.

I see in this project that quite some work is already done to make this work.
Is there a possibility for us to support/donate to finish this feature?

Thanks!
TestingBot
 @codeskyblue @sorccu the VNC feature is similar to this https://github.com/openstf/stf/issues/352 , I did comment on that ticket that you can share devices with multiple users at the same time if the users use the same login details. 
  I consistently getting this when running `stf local`

```
FTL/reaper 7584 [reaper001] Unable to load initial state { [ReqlOpFailedError: Index `present` was not found on table `stf.devices` in:
r.table("devices").getAll(true, {index: "present"})
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^]
  name: 'ReqlOpFailedError',
  msg: 'Index `present` was not found on table `stf.devices`.',
  frames: [],
  message: 'Index `present` was not found on table `stf.devices` in:\nr.table("devices").getAll(true, {index: "present"})\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^' }
```

Manually adding the index to the table fixed the problem.

Apparently `migrate` cli already exit before the index was fully created.
 It's SDD on OSX.

I tried this, but no luck yet (pardon my lack of nodejs-fu):

```
return rTable.indexCreate.apply(rTable, args).run(conn)
      .then(function() {
          //log.info('options for table %s index %s', table, index)
          if (!options) {
            log.info('Waiting for table %s index %s', table, index)
            return Promise.resolve(rTable.indexWait(args[0]).run(conn).then(function () {
              log.info('Index "%s"."%s" finally created', table, index)
            }))
          } else {
            log.info('Index "%s"."%s" created', table, index)
          }
      })
      .catch(alreadyExistsError, function() {
        log.info('Index "%s"."%s" already exists', table, index)
        return Promise.resolve()
      })
      .catch(noMasterAvailableError, function() {
        return Promise.delay(1000).then(function() {
          return createIndex(table, index, options)
        })
      })
  }
```

The way we write `table.js` might also requires reordering to make sure we are not creating index that depends on another index before it's dependencies got resolved.

Log:

```
INF/db 8452 [*] Connecting to 127.0.0.1:28015
INF/db:setup 8452 [*] Database "stf" created
INF/db:setup 8452 [*] Table "users" created
INF/db:setup 8452 [*] Index "users"."adbKeys" created
INF/db:setup 8452 [*] Table "logs" created
INF/db:setup 8452 [*] Table "vncauth" created
INF/db:setup 8452 [*] Waiting for table vncauth index response
INF/db:setup 8452 [*] Index "vncauth"."responsePerDevice" created
INF/db:setup 8452 [*] Table "devices" created
FTL/cli:migrate 8452 [*] Migration had an error: ReqlOpFailedError: Index `response` was not found on table `stf.vncauth` in:
```
 sorry, I have no any knowledge about nodejs, how can I fix this bug.

I always meet this bug today suddenly

---

I try this in the rethinkDB, and solve this problem

>   r.db('stf').table("devices").getAll(true, {index: "present"})
 This is the log from today's master

```
INF/db 6257 [*] Connecting to 127.0.0.1:28015
INF/db:setup 6257 [*] Database "stf" created
INF/db:setup 6257 [*] Table "vncauth" created
INF/db:setup 6257 [*] Index "vncauth"."response" created
INF/db:setup 6257 [*] Waiting for index "vncauth"."response"
INF/db:setup 6257 [*] Index "vncauth"."responsePerDevice" created
INF/db:setup 6257 [*] Waiting for index "vncauth"."responsePerDevice"
INF/db:setup 6257 [*] Table "logs" created
FTL/cli:migrate 6257 [*] Migration had an error: ReqlOpFailedError: Index `response` was not found on table `stf.vncauth` in:
r.table("vncauth").indexWait("response")
```

Not sure this is more into rethinkdb API issue. Since indexWait said index was ready when it's not -- fail when we start accessing the index in question. indexStatus also return the same state. So the appropriate check should be an actual query. I tried this on my local but I messed up my promises and it never resolve :crying_cat_face: 
  Just a question not so related with STF itself, we would like to know where to buy such cabinet to place all the mobile devices
 thanks for the reply.
could it be possible to send me the picture of the shelf and if better the production shelf so that I can send it to my boss to make the decision?
  At first, my English is so bad. :)

Thanks for STF, it is really useful for us. But I have a problem that I cannot use 7100 in my company's server, so I must change 7100 to another, but I don't find how to do that. 

Who can tell me ? Thanks very much.
 ```
stf local --poorxy-port xxxx
```
 Yes ! That works ! Thanks so much !!!

BTW, where do get the option information ? I don't see that in the help
 For specific command options, you need to check command help

eg. `stf local --help`
 Thank you. 
  i pull the newest code from master, and run npm install successfully
but when i run stf, i find the error below
how can i fix it?

/home/zhuxun/COMPANY/stf/newstf/node_modules/zmq/lib/index.js:252
  this._zmq.setsockopt(opts[opt] || opt, val);
            ^
Error: Invalid argument
    at Error (native)
    at Socket.setsockopt (/home/zhuxun/COMPANY/stf/newstf/node_modules/zmq/lib/index.js:252:13)
    at Object.module.exports.socket (/home/zhuxun/COMPANY/stf/newstf/lib/util/zmqutil.js:11:8)
    at module.exports (/home/zhuxun/COMPANY/stf/newstf/lib/units/triproxy/index.js:19:21)
    at Command.<anonymous> (/home/zhuxun/COMPANY/stf/newstf/lib/cli.js:306:32)
    at Command.listener (/home/zhuxun/COMPANY/stf/newstf/node_modules/commander/index.js:301:8)
    at Command.emit (events.js:110:17)
    at Command.parseArgs (/home/zhuxun/COMPANY/stf/newstf/node_modules/commander/index.js:610:12)
    at Command.parse (/home/zhuxun/COMPANY/stf/newstf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/home/zhuxun/COMPANY/stf/newstf/lib/cli.js:1166:9)
    at Module._compile (module.js:460:26)
    at Object.Module._extensions..js (module.js:478:10)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Function.Module.runMain (module.js:501:10)
    at startup (node.js:129:16)
FTL/cli:local 19744 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/home/zhuxun/COMPANY/stf/newstf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:110:17)
    at Process.ChildProcess._handle.onexit (child_process.js:1074:12)
INF/cli:local 19744 [_] Shutting down all child processes
/home/zhuxun/COMPANY/stf/newstf/node_modules/zmq/lib/index.js:252
  this._zmq.setsockopt(opts[opt] || opt, val);
            ^
Error: Invalid argument
    at Error (native)
    at Socket.setsockopt (/home/zhuxun/COMPANY/stf/newstf/node_modules/zmq/lib/index.js:252:13)
    at Object.module.exports.socket (/home/zhuxun/COMPANY/stf/newstf/lib/util/zmqutil.js:11:8)
    at module.exports (/home/zhuxun/COMPANY/stf/newstf/lib/units/triproxy/index.js:19:21)
    at Command.<anonymous> (/home/zhuxun/COMPANY/stf/newstf/lib/cli.js:306:32)
    at Command.listener (/home/zhuxun/COMPANY/stf/newstf/node_modules/commander/index.js:301:8)
    at Command.emit (events.js:110:17)
    at Command.parseArgs (/home/zhuxun/COMPANY/stf/newstf/node_modules/commander/index.js:610:12)
    at Command.parse (/home/zhuxun/COMPANY/stf/newstf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/home/zhuxun/COMPANY/stf/newstf/lib/cli.js:1166:9)
    at Module._compile (module.js:460:26)
    at Object.Module._extensions..js (module.js:478:10)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Function.Module.runMain (module.js:501:10)
    at startup (node.js:129:16)
 I also confirmed. Working okay on my machine.
  Hi, i use nexus 5 and install android 6.0 on it, but when i start stf, i find the error below
can you give me some suggestions to fix the problem? thank you

INF/device:plugins:service 19293 [0642e51a005db76f] Launching agent
FTL/device 19293 [0642e51a005db76f] Setup had an error TimeoutError: operation timed out
    at Timer.listOnTimeout (timers.js:119:15)
From previous event:
    at /home/zhuxun/COMPANY/stf/stf/lib/units/device/plugins/service.js:80:14
    at processImmediate [as _immediateCallback](timers.js:367:17)
From previous event:
    at openAgent (/home/zhuxun/COMPANY/stf/stf/lib/units/device/plugins/service.js:77:10)
    at /home/zhuxun/COMPANY/stf/stf/lib/units/device/plugins/service.js:699:12
    at SerialSyrup.ParallelSyrup.invoke (/home/zhuxun/COMPANY/stf/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /home/zhuxun/COMPANY/stf/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at process._tickCallback (node.js:355:11)
FTL/util:lifecycle 19293 [0642e51a005db76f] Shutting down due to fatal error
  Hello :wave:

This is the first automated pull requests to help reach the goal of up to date and stable software.
It updates all of the dependencies in the `package.json` at one go, but from now on you’ll receive **pull requests** for each dependency update **in isolation and in real time**.

For updates that satisfy the existing version range you’ll get pull-requests only if it breaks your build.

Example:

``` diff
-  "underscore": "^1.6.0"
+  "underscore": "^1.7.0"
```

When an update does not satisfy the existing range you’ll get the pull request right away.

Example:

``` diff
-  "lodash": "^3.0.0"
+  "lodash": "^4.0.0"
```

Happy fixing and merging :palm_tree:

---

This pull request was created by [greenkeeper.io](http://greenkeeper.io/).
It keeps your software, up to date, all the time.

<sub>
Tired of seeing this sponsor message? Upgrade to the supporter plan!
You'll also get your pull requests faster :zap:
</sub>
  Hi, android 6.0 comes , is there any schedule to support android 6.0 ?
i think maybe to build an android 6.0 minicap.so will work?
  Issue - https://github.com/openstf/stf/issues/100
 True. Will change it.
 done.
 Thanks for the review, and yeah please check this in your environment too. Its working okay on mac.
 Sorry, I could not test this PR in CoreOS. I need to make a CoreOS dev environment.

The reason, I added ZMQ_TCP_KEEPALIVE_IDLE option is that default KEEP_IDLE (_Amount of time, in milliseconds, that the (TCP) connection must be idle before sending keepalive probes_) option value for mac or some linux OS such as CentOS is 2hrs. Which means TCP_KEEP_ALIVE will start probing after 2hrs. And in my case connection was dying after 20mins, so I set it to 5mins.

And thanks for making these param optional.
 ZeroMQ documentation looks a bit weird. Because in source code it is setting SO_KEEPIDLE option on ZMQ_TCP_KEEPALIVE_IDLE 

https://github.com/zeromq/libzmq/blob/master/src/tcp.cpp#L131-L135

```
#ifdef ZMQ_HAVE_TCP_KEEPIDLE
        if (keepalive_idle_ != -1) {
            int rc = setsockopt (s_, IPPROTO_TCP, TCP_KEEPIDLE, &keepalive_idle_, sizeof (int));
            errno_assert (rc == 0);
        }
```
  Hi,

```
stf -V
1.0.10
```

when I click,
![5802f33a-f899-42eb-b0c6-2962bf2d54f5](https://cloud.githubusercontent.com/assets/5791692/10384774/3669aff6-6e73-11e5-988c-832fecab3d37.png)

then,
![4da2c1d8-69c3-49ba-9f24-a2d52e47d098](https://cloud.githubusercontent.com/assets/5791692/10384777/415ec608-6e73-11e5-959a-8a58789d891b.png)

log:

``` bash
NF/device:plugins:group 64490 [3190de0d] Subscribing to group channel "mUID/6efQI6QkUp3n9mv4A=="
WRN/util:datautil 64482 [*] Device database does not have a match for device "3190de0d" (model "HM NOTE 1S"/"gucci")
INF/device:plugins:screen:stream 64490 [3190de0d] Setting frame producer projection to 486x810
INF/device:plugins:screen:stream 64490 [3190de0d] Requesting frame producer to start
INF/device:plugins:screen:stream 64490 [3190de0d] Launching screen service
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "PID: 17457"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: Using projection 720x1280@456x810/0"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:255) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 64490 [3190de0d] Connecting to minicap service
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:258) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:265) Creating virtual display"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:271) Creating buffer queue"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:278) Creating CPU consumer"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:284) Creating frame waiter"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:288) Publishing virtual display"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 2766852 bytes for JPG encoder"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
INF/device:plugins:screen:stream 64490 [3190de0d] Reading minicap banner
INF/provider 64480 [*] Providing all 3 device(s)
INF/device:plugins:screen:stream 64490 [3190de0d] Requesting frame producer to stop
INF/device:plugins:screen:stream 64490 [3190de0d] Disconnecting from minicap service
INF/device:plugins:screen:stream 64490 [3190de0d] Stopping minicap service
INF/device:plugins:screen:stream 64490 [3190de0d] Sending SIGTERM to minicap
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (jni/minicap/minicap.cpp:512) Closing client connection"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (jni/minicap/minicap.cpp:196) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:303) Destroying virtual display"
INF/device:plugins:screen:stream 64490 [3190de0d] Keeping 486x810 as current frame producer projection
INF/device:plugins:screen:stream 64490 [3190de0d] Requesting frame producer to start
INF/device:plugins:screen:stream 64490 [3190de0d] Launching screen service
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "PID: 17465"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: Using projection 720x1280@456x810/0"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:255) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:258) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:265) Creating virtual display"
INF/device:plugins:screen:stream 64490 [3190de0d] Connecting to minicap service
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:271) Creating buffer queue"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:278) Creating CPU consumer"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:284) Creating frame waiter"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (external/MY_minicap/src/minicap_19.cpp:288) Publishing virtual display"
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 2766852 bytes for JPG encoder"
INF/device:plugins:screen:stream 64490 [3190de0d] Reading minicap banner
INF/device:plugins:screen:stream 64490 [3190de0d] minicap says: "INFO: (jni/minicap/minicap.cpp:444) New client connection"
INF/device:plugins:screen:capture 64490 [3190de0d] Capturing screenshot
INF/storage:temp 64484 [*] Uploaded "3190de0d.jpg" to "/var/folders/80/xbm17qz14j1_2_0_y1s3dgpr0000gn/T/upload_8fae0bbbc02ef9974098de898824f310"
INF/device:support:storage 64490 [3190de0d] Uploaded to "/s/image/30bc148e-5f9c-4f8e-9ffd-dc4aec992089/3190de0d.jpg"
events.js:85
      throw er; // Unhandled 'error' event
            ^
Error: spawn gm ENOENT
    at exports._errnoException (util.js:746:11)
    at Process.ChildProcess._handle.onexit (child_process.js:1053:32)
    at child_process.js:1144:20
    at process._tickCallback (node.js:355:11)
ERR/poorxy 64487 [*] Proxy had an error Error: socket hang up
    at createHangUpError (_http_client.js:215:15)
    at Socket.socketOnEnd (_http_client.js:300:23)
    at Socket.emit (events.js:129:20)
    at _stream_readable.js:908:16
    at process._tickCallback (node.js:355:11)
FTL/cli:local 64473 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:110:17)
    at Process.ChildProcess._handle.onexit (child_process.js:1074:12)
INF/cli:local 64473 [*] Shutting down all child processes
INF/util:lifecycle 64475 [app001] Winding down for graceful exit
INF/util:lifecycle 64477 [proc001] Winding down for graceful exit
INF/util:lifecycle 64476 [dev001] Winding down for graceful exit
INF/util:lifecycle 64478 [proc002] Winding down for graceful exit
INF/util:lifecycle 64479 [reaper001] Winding down for graceful exit
INF/util:lifecycle 64480 [*] Winding down for graceful exit
INF/util:lifecycle 64482 [*] Winding down for graceful exit
INF/util:lifecycle 64481 [*] Winding down for graceful exit
INF/util:lifecycle 64483 [*] Winding down for graceful exit
```

Can you help?
thx!
 yep, thx.

I installed GraphicsMagick by Macports at first,  it dosn't work.

It must use Homebrew.
  I have 2 Linux machine and each has more than 10 devices. 
Could I start one instance  on SFT and have access to all devices? 

Like selenium grid
  # Overview

This is Device booking feature. You can book device schedule on device-list. then, device scheduler unit  set you to "owner" on the time. And reject other user if the device is busy. device scheduler will check device schedule per a minute.
# Note

You can book schedule from one hour later.
 <img width="926" alt="device-list" src="https://cloud.githubusercontent.com/assets/2498574/10360015/70dc8b0e-6dd8-11e5-93f7-6ff897e91e7f.png">
<img width="917" alt="booking-modal" src="https://cloud.githubusercontent.com/assets/2498574/10360036/95b29784-6dd8-11e5-8942-6d367f41f9de.png">
 wow
 :+1:  (for the feature, haven't read the code yet)
 Thanks for your reply. Because my English is no good Maybe some method name or some variable name is fishy. And actually, it need more test for actual business. I continue test and I'll fix if I found any problem.
 ![](https://assets-cdn.github.com/images/icons/emoji/unicode/1f44d.png)
Great work, I was looking at implementing this myself!!
 Thanks for check. I'll research it.
 :+1: nice feature!
 Thanks for check. I'll follow them. It's similar to one of my other ideas.
 > 1. In there, start listening for a ReserveUpdateMessage, and send a ReserveUpdateRequestMessage when the device worker loads (just a sample name)
> 2. processor receives it, loads the full schedule for that device from the database, and a ReserveUpdateMessage back to the device with the details

You mean, I can "not" access to rethinkdb from  `device/plugins/reserve.js`  right?
 my idea is as follow images.

### On Device wake up.

![on-wakeup-flow](https://cloud.githubusercontent.com/assets/2498574/11688908/9d1493a8-9ed2-11e5-8c1e-87c09f7066cf.png)

### On update schedule.

![on-update-flow](https://cloud.githubusercontent.com/assets/2498574/11688922/b3771850-9ed2-11e5-82f9-dacaf857057f.png)

---

It can make completely separate this feature.
 How can I see this feature in installed STF? or Do I need to add this plugin separately? 
 It's not ready yet. Sorry.
 Hi hogehoge-banana, 
Thanks very much for this nice feature.
I added your code and start STF but could not see the screen 'Book Device'. 
Would you please let me know if I missed something or how we can activate this feature?
 Hi, Thanks for check my code. While I'll research it, It will take time. Because Actually I left this project. Now, I just play "stf" on my private time.
 Hey @hogehoge-banana , 

This is amazing feature for STF , is this ready yet ?
please let me know.

Thanks
SK @skumar1122
Not ready yet. Sorry.
 @hogehoge-banana 
No worries !  I have a working setup of STF in production.Currently, I am having a problem which is bugging me for couple of days and want to know if somebody else is having same.

The problem is, if I keep my device idle for 20 or 30 minutes, then I get totally blank screen after click the use button on device. Below are the screen shots.

STF Device list view, as it can be seen device are usable
![screen shot 2015-10-07 at 13 25 59](https://cloud.githubusercontent.com/assets/7875161/10329270/edac688c-6cf9-11e5-99cc-66746517460f.png)

This is the view I get when I click use button for some (expired) device.
![screen shot 2015-10-07 at 13 46 30](https://cloud.githubusercontent.com/assets/7875161/10329267/e74c88e6-6cf9-11e5-9b6d-d94498fc7d30.png)

I did troubleshooting for this and found out that device subscriber is not receiving message if it is kept idle for some minutes. So basically "group.invite" or GroupMessage from app side is not being received by device unit.

I confirmed this by writing a simple zeromq subscriber and subscribed it with dev-side publisher. Script looks like this

``` nodejs
var zmq = require('zmq');
var util = require('util')

var sub = zmq.socket('sub');

// subscribing to device channel
sub.subscribe("QsoRFrXSROZTpgwiqmTxlpDoelg=")

sub.on("message", function(channel, data) {
  console.log('got message on channel ' + channel + " data is : " + data.toString() + "\n")
})

sub.connect("tcp://DEVSIDE_IP:7250")
```

If I press the "Use" button now, then I can see subscriber in the script is receiving messages. Then I kept (expired) device idle for around 30 minutes and not surprisingly subscriber in the script also stopped receiving messages. So basically, subscriber is dying if kept idle.

I did research about zeromq's subscriber dying problem and found that it may because of various reason such as TCP timeout or network problem between machines. I checked TCP timeout in my provider machine, it is 2hrs so most probably this is not the problem.

One more additional thing, I am using mac-os for my provider instead of linux machine. I know STF does not support mac-osx for production but currently I am using my available resources. All the other units are running in CentOS 7.0

I want to know, if somebody has faced subscriber dying problem or can suggest me reason why it is dying or not receiving messages? I will be glad if someone can also suggest work around for this problem, currently I am thinking of sending heartbeats to all the device subscriber to keep them alive.

Thanks,
 Currently experiencing the same, with both my providers. A Raspbian (raspberry pi) provider and a Ubuntu 15 server. If left idle, the devices are still visible as usable, but no data is received if you try to use them, and they are not marked as in use (no "stop using" button visible, it's like I never tried to connect). 
So far my workaround has been to periodically restart the stf-provider service.
 Well, I did some experiment by creating different publisher and subscriber on different machines, current results are as follow:
1. If publisher and subscriber on same host (same machine), subscriber will continue receiving message (as in case of stf local).
2. If publisher and subscriber are on different host, subscriber discontinue receiving messages if kept idle.

Still trying to figure out cause behind the problem. And its frustrating since I have to wait 30minutes to reproduce the behaviour.

Related Issues: http://stackoverflow.com/questions/28252054/zmq-socket-not-working-after-a-period-of-time
 I think, I figured it out. 

As mentioned in ZeroMQ guide, http://zguide.zeromq.org/page:all#Shrugging-It-Off

> If we use a TCP connection that stays silent for a long while, it will, in some networks, just die. Sending something (technically, a "keep-alive" more than a heartbeat), will keep the network alive.

Indeed the problem was in TCP connection. By default, ZeroMQ uses OS settings for TCP_KEEPALIVE option http://api.zeromq.org/3-2:zmq-setsockopt

> Override SO_KEEPALIVE socket option(where supported by OS). The default value of -1 means to skip any overrides and leave it to OS default.

And for OS X or most of the linux, the default is false. So, turning it on worked for me.

``` bash
sudo -w sysctl net.inet.tcp.always_keepalive=1
```

In addtion, the default wait time for sending pings is 2hrs, so it is also need to be lowered. I made it 10mins.

``` bash
sudo -w sysctl net.inet.tcp.keepidle=600000
```

This fixed my problem, but I still feel that it is not a good solution. It will be good if we can handle it from application itself. ZeroMQ provides options where we can set these option while creating zmq sockets. So, good solution will be to set these options on all the subscribers and dealers of stf, some thing like below

``` js
sub.setsockopt(zmq.ZMQ_TCP_KEEPALIVE, 1)
sub.setsockopt(zmq.ZMQ_TCP_KEEPALIVE_IDLE, 600000)
```

@MichaelMadsen 
Can you check if this solution works for you. I don't have a linux provider.
 Yeah sure, I will write PR for this. Reason I did not do it before is that I did not test this on linux provider.

For people who are interested in why TCP connection dies on some network, this will help.

> The other useful goal of keepalive is to prevent inactivity from disconnecting the channel. It's a very common issue, when you are behind a NAT proxy or a firewall, to be disconnected without a reason. This behavior is caused by the connection tracking procedures implemented in proxies and firewalls, which keep track of all connections that pass through them. Because of the physical limits of these machines, they can only keep a finite number of connections in their memory. The most common and logical policy is to keep newest connections and to discard old and inactive connections first.

http://tldp.org/HOWTO/TCP-Keepalive-HOWTO/overview.html
 Hi @vbanthia ,
Great work !

I started using STF now and it's very useful for me and I am loving it.
If you could help me in answering for couple of questions please,
**I am using Mac 10.12.4** 

1)If publisher and subscriber are on different host, subscriber discontinue receiving messages if kept idle.
Say I forgot to click on stop using device before session time , Will that device will be busy for others until I click stop using or session time-out ?
So as u said is there only one chance that we can reduce/set session timeout(By TCP) time for device if its idle or not used for a time.

2)How do I re-name my devices in STF ?

ATM we cannot get device name , instead its getting model name. Is there any ADB command to get device name.

![screen shot 2017-04-06 at 15 09 31](https://cloud.githubusercontent.com/assets/20112173/24758711/15116838-1adb-11e7-9a53-7e52e1079320.png)


Thanks
SK

  Hi,
I am currently experiencing problems trying to get LDAP user authentication working. Are you able to provide me with an example of an stf-auth@.service so i can use this to help get this implemented correctly.

Thanks in advance,

Ben
  Can we add devices that are connected to ADB over tcpip, not connected with USB? When I try this way, cannot see device on sft application. 
  Hello, I am facing some problem in installing apk files in production setup. Since, it is working perfectly with `stf local` , so most probably the problem is some where in my setup. I tried debugging it but could not figure out. Hope someone can help me out.

So, the problem starts with nginx responding with 502(Bad gateway) on uploading apk file. Below is the screenshot.

![stf-error-screenshot](https://cloud.githubusercontent.com/assets/7875161/10214662/56a25594-6855-11e5-83b5-70ff2a9bb3d3.png)

![manifest_end_point](https://cloud.githubusercontent.com/assets/7875161/10214664/5a3c7c2a-6855-11e5-81d5-76c6055d1299.png)

This is my stf-storage-temp@3500 same as Deployment.md

```
[Unit]
Description=STF temp storage
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  -v /mnt/storage:/data \
  -p %i:3000 \
  openstf/stf:latest \
  stf storage-temp --port 3000 \
    --save-dir /data
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```

I tried checking into containers /data folder but there was nothing inside. apk file was inside /tmp folder inside

``` bash
[stf@enigma ~]$ docker exec -it stf-storage-temp-3500 /bin/bash
stf@af7372510bb1:/app$ ls /data
stf@af7372510bb1:/app$ ls /tmp/
upload_53e55f6c6b2b1b5f6ae57356df2807be
```

I tried to explore code but could not find where this --save-dir option is being used. [storage-temp unit](https://github.com/openstf/stf/blob/master/lib/units/storage/temp.js) is not using it

I can provide more information and logs. Please have a look!
 I checked my backend servers, they are running fine.

This is nginx error log for that 502 response

```
*469 upstream prematurely closed connection while reading response header from upstream, client: 172.23.57.87, server: stf.example.org, request: "GET /s/apk/04a9f9cb-1bc1-41c7-aac3-8b0068337a74/service-release-20150916113424690.apk/manifest HTTP/1.1", upstream: "http://10.33.85.12:3300/s/apk/04a9f9cb-1bc1-41c7-aac3-8b0068337a74/service-release-20150916113424690.apk/manifest", host: "stf.example.org", referrer: "http://stf.example.org/"
```

In case, backend server are down, nginx will raise connection refused error

```
connect() failed (111: Connection refused) while connecting to upstream,
```

and this is the log from stf-storage-plugin-apk server

```
[stf@enigma ~]$ docker logs stf-storage-plugin-apk-3300
INF/storage:plugins:apk 1 [*] Listening on port 3000
```

BTW, `/data (--save-dir)` directory of stf-storage-temp container is empty. And also host's `/mnt/storage` directory is also empty. I am trying to find out which part of code responsible for copying uploaded files from `/tmp` directory to `/data (--save-dir)` directory. Can you help me with that?
 Sorry to mention this before, my storage url is okay, I just changed the log in order to hide private domain.

Same thought for uploading, because I can see the uploaded apk file inside tmp folder of container. I also think problem is with `/s/apk/:id/:name/manifest` endpoint. I tried hitting plugin-apk server directly this is what I got.

```
 wget http://stf.mydomain.org:3300/s/apk/da5f9fb2-7552-457b-8fd8-6a72aa3ca647/service-release-20150916113424690.apk
--2015-10-01 16:53:46--  http://stf.mydomain.org:3300/s/apk/da5f9fb2-7552-457b-8fd8-6a72aa3ca647/service-release-20150916113424690.apk
Resolving stf.mydomain.org... 10.33.85.12
Connecting to stf.mydomain.org|10.33.85.12|:3300... connected.
HTTP request sent, awaiting response... No data received.
Retrying.

--2015-10-01 16:53:47--  (try: 2)  http://stf.mydomain.org:3300/s/apk/da5f9fb2-7552-457b-8fd8-6a72aa3ca647/release-20150916113424690.apk
Connecting to stf.mydomain.org|10.33.85.12|:3300... failed: Connection refused.
Resolving stf.mydomain.org... 10.33.85.12
Connecting to stf.mydomain.org|10.33.85.12|:3300... failed: Connection refused.
```

Can you tell me one thing, while getting apk or image files from storage server. From which location storage server get these files? `/data` or `/tmp`
 The problem was with --storage-url. stf-storage-plugin-apk container was not able to resolve the domain for storage-url thats why server was crashing. And systemd was restarting it again. 

Using `-e DEBUG=express:*` helped in debugging.
  Hi,  
I try to connect Nexus 5 Android 6 Dev Prev 3 device to stf but getting some errors repeatedly. How can I fix this problem.

Thanks.

LOG:

"
FTL/device 19726 [0718fd5a0059c7ce] Setup had an error TimeoutError: operation timed out
    at afterTimeout (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:11:15)
    at timeoutTimeout (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:53:9)
    at Timer.listOnTimeout (timers.js:89:15)
FTL/util:lifecycle 19726 [0718fd5a0059c7ce] Shutting down due to fatal error
INF/provider 19595 [_] Cleaning up device worker "0718fd5a0059c7ce"
ERR/provider 19595 [_] Device worker "0718fd5a0059c7ce" died with code 1
INF/provider 19595 [_] Restarting device worker "0718fd5a0059c7ce"
INF/device:support:push 19729 [0718fd5a0059c7ce] Sending output to "tcp://127.0.0.1:7116"
INF/device 19729 [0718fd5a0059c7ce] Preparing device
INF/device:support:sub 19729 [0718fd5a0059c7ce] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 19729 [0718fd5a0059c7ce] Subscribing to permanent channel "_ALL"
INF/device:support:properties 19729 [0718fd5a0059c7ce] Loading properties
INF/device:support:abi 19729 [0718fd5a0059c7ce] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 19729 [0718fd5a0059c7ce] Checking whether we need to install STFService
INF/device:resources:service 19729 [0718fd5a0059c7ce] Running version check
INF/device:resources:service 19729 [0718fd5a0059c7ce] STFService up to date
INF/device:plugins:service 19729 [0718fd5a0059c7ce] Launching agent
FTL/device 19727 [0718fd5a0059c7ce] Setup had an error TimeoutError: operation timed out
    at afterTimeout (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:11:15)
    at timeoutTimeout (/usr/local/lib/node_modules/stf/node_modules/adbkit/node_modules/bluebird/js/main/timers.js:53:9)
    at Timer.listOnTimeout (timers.js:89:15)
FTL/util:lifecycle 19727 [0718fd5a0059c7ce] Shutting down due to fatal error
INF/provider 19595 [_] Cleaning up device worker "0718fd5a0059c7ce"
ERR/provider 19595 [_] Device worker "0718fd5a0059c7ce" died with code 1
INF/provider 19595 [_] Restarting device worker "0718fd5a0059c7ce"
INF/device:support:push 19730 [0718fd5a0059c7ce] Sending output to "tcp://127.0.0.1:7116"
INF/device 19730 [0718fd5a0059c7ce] Preparing device
INF/device:support:sub 19730 [0718fd5a0059c7ce] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 19730 [0718fd5a0059c7ce] Subscribing to permanent channel "_ALL"
INF/device:support:properties 19730 [0718fd5a0059c7ce] Loading properties
INF/device:support:abi 19730 [0718fd5a0059c7ce] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 19730 [0718fd5a0059c7ce] Checking whether we need to install STFService
INF/device:resources:service 19730 [0718fd5a0059c7ce] Running version check
INF/device:resources:service 19730 [0718fd5a0059c7ce] STFService up to date
INF/device:plugins:service 19730 [0718fd5a0059c7ce] Launching agent
INF/provider 19595 [*] Providing 2 of 2 device(s); waiting for "0718fd5a0059c7ce"
 ok, try this way and work

thanks

I want to ask one more question, can we add genymotion or emulator to this system.
  Without these changes, the dropdown occluded the buttons area:

![screen shot 2015-09-28 at 10 26 02 am](https://cloud.githubusercontent.com/assets/1577721/10136970/a376d190-65cd-11e5-832c-a0b849fec60c.png)

Adding a pull-left solves it:

![screen shot 2015-09-28 at 10 43 53 am](https://cloud.githubusercontent.com/assets/1577721/10137029/df881cf2-65cd-11e5-9e57-dcecc90f8bf5.png)
 Good catch as well :) . I'll give it a closer look and reopen it.

By the way, how can I try frontend changes without running `npm link` each time?
 Exactly. If I change something then reloading the page doesn't seem to load the changes... Is that the expected behavior? Should I run stf in some specific way?
 Perfect, thanks!
  Hi, sorry to bother you again!
I have 4 devices on my pc and i just want to provide two to stf.
i tried to run provider serial1 serial2 , provider [serial1 serial2], provider serial1, serial2 and so on , but none works
is there a way to do this or i have to run two provider like , provider serial1 , provider serial2.
i just want to run one provider and provide two devices
thank you
  A very simple one. Can list and download.

![2015-09-22 5 23 32](https://cloud.githubusercontent.com/assets/3281689/10014848/beb13492-614e-11e5-97ca-e71b34efbac2.png)
 Plese check again. @sorccu 
  Add TopApp to dashboard. Support kill current running app. Run app.

![2015-09-21 5 39 03](https://cloud.githubusercontent.com/assets/3281689/9989082/4cbc72dc-6088-11e5-9709-1548262a101c.png)

After refresh

![2015-09-21 5 41 41](https://cloud.githubusercontent.com/assets/3281689/9989077/3ce23d38-6088-11e5-8be2-1dcff238bf49.png)
 I test most 4.0+, never tested 2.3.  I'll remove the console.log. But  I have to say, this code may be still need some modification. I just opening the subject.
 @gunta OK, but this may be will take some time.  I'll arrange one of my colleague to do this.
 @gunta  @sorccu  I'm codeskyblue's colleague. Now I want to implement the top APP  function as a realtime monitor feature. But I don't know how to monitor if the top APP has changed. Could you give me some suggestions? And how does the ratation watcher realized?
 maybe this pr should be closed.
  Hi, I want to know can i just provide one device to stf when i have two devices connected on the pc?
  This is provider log

```
INF/provider 12411 [*] Subscribing to permanent channel "DtYjl0G1SiSoYJ6q53Abgg=="
INF/provider 12411 [*] Sending output to "tcp://10.246.14.51:7116"
INF/provider 12411 [*] Receiving input from "tcp://10.246.14.51:7114"
INF/provider 12411 [*] Tracking devices
INF/provider 12411 [*] Found device "cff039ebb31fa11" (device)
INF/provider 12411 [*] Providing all 0 of 1 device(s); ignoring "cff039ebb31fa11"
```

And this is reaper log

```
INF/reaper 7561 [reaper001] Reaping device "cff039ebb31fa11" due to heartbeat timeout
```

But when I restart stf. I can see the normal log.

```
INF/reaper 12663 [reaper001] Device "cff039ebb31fa11" is present
```

Can you tell me why?
 I'm seeing a similar issue after building from master. I was previously using 1.0.10 but had to upgrade for Marshmallow support, and now I cannot use _any_ of my devices:

```
INF/provider 3846 [*] Subscribing to permanent channel "STiZJHdmQtSPFq18dOqyGg=="
INF/provider 3846 [*] Sending output to "tcp://127.0.0.1:7116"
INF/provider 3846 [*] Receiving input from "tcp://127.0.0.1:7114"
INF/provider 3846 [*] Tracking devices
INF/provider 3846 [*] Found device "CLV8C4CF5D0" (device)
INF/provider 3846 [*] Found device "085b366f" (device)
INF/provider 3846 [*] Found device "085b3f5c" (device)
INF/provider 3846 [*] Found device "520515f76325118b" (device)
INF/provider 3846 [*] Found device "00D2070834530ULE" (device)
INF/provider 3846 [*] Found device "4790011cce533100" (device)
INF/provider 3846 [*] Found device "HT12PS012077" (device)
INF/provider 3846 [*] Found device "1bcc69b6" (device)
INF/provider 3846 [*] Found device "LGV50099ce0832" (device)
INF/provider 3846 [*] Found device "a4c121c5" (device)
INF/provider 3846 [*] Found device "90082aa7" (device)
INF/app 3852 [*] Using pre-built resources
INF/app 3852 [*] Listening on port 7105
INF/db 3852 [*] Connecting to 127.0.0.1:28015
INF/websocket 3857 [*] Subscribing to permanent channel "*ALL"
INF/websocket 3857 [*] Listening on port 7110
INF/db 3857 [*] Connecting to 127.0.0.1:28015
INF/websocket 3857 [*] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 3857 [*] Receiving input from "tcp://127.0.0.1:7111"
INF/provider 3846 [*] Providing all 0 of 11 device(s); ignoring "CLV8C4CF5D0", "085b366f", "085b3f5c", "520515f76325118b", "00D2070834530ULE", "4790011cce533100", "HT12PS012077", "1bcc69b6", "LGV50099ce0832", "a4c121c5", "90082aa7"
```
 I already gave that a try. No dice.
 I experienced same problem as @JordanMarshall.
Didn't try node 4.0 yet.
 With the commits on October 21st it now lists all the devices, but they are perpetually stuck 'preparing'
 I wiped, performed a clean install, update to node 4.2.1 (previously using 4.2.0), and now everything seems to work!
    I'm having some trouble connecting to the device video feed, having moved the provider to a separate VM (remote control works, getting blank video feed and the adb connection string is unable to connect as well). It's definitely because I am configuring wrong, and some clarification of the different IPs would be helpful for me.

So as far as I know, the files that must be configured to add a new provider are stf-provider@.service on the provider machine, and nginx.conf on the webserver.
I have taken the ips of the example configuration files and added in my interpretation/questions.

stf-provider@newprovider.service (running on machine with only adbd.service and a connected android device):

```
[Unit]
Description=STF provider
After=adbd.service
BindsTo=adbd.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --net host \
  openstf/stf:latest \
  stf provider \
    --name "%H/%i" \
    --connect-sub tcp://IP_OF_DEV_TRIPROXY:7250 \
    --connect-push tcp://IP_OF_DEV_TRIPROXY:7270 \
    --storage-url https://IP_OF_STF_STORAGE_TEMP? or maybe    IP_OF_DATABASE?/ \
    --public-ip PUBLIC_IP_OF_THIS_MACHINE \
    --min-port=15000 \
    --max-port=25000 \
    --heartbeat-interval 10000 \
    --screen-ws-url-pattern "wss://IP_OF_WEBSERVER?/d/%i/<%= serial %>/<%= publicPort %>/"
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```

Nginx.conf:

```
# Handle stf-provider@newprovider.service
    location ~ "^/d/newprovider/([^/]+)/(?<port>[0-9]{5})/$" {
      proxy_pass http://PUBLIC_IP_OF_PROVIDER:$port/;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_set_header X-Forwarded-For $remote_addr;
      proxy_set_header X-Real-IP $remote_addr;
    }
```

So in my case I have 3 machines, 
192.168.99.**106**: app side, running all services and webserver
192.168.99.**107**: rethinkdb, running rethinkdb
192.168.99.**108**: provider, running adbd.service and stf-provider

And I'm a bit unsure where the different IPs would go. At least I haven't hit a combination that works for the video feed yet. And maybe the problem is somewhere else altogether, I'm just pressuming it must be my configuration. Websocket is getting a 504:
<img width="1222" alt="screen shot 2015-09-17 at 15 09 13" src="https://cloud.githubusercontent.com/assets/657289/9935379/300fcc98-5d4e-11e5-8504-594238bf913f.png">

If anybody could point me in the right direction it would be appreciated.
 Oh yeah, the newprovider name was just made up for this post, in all of my files it's called remotehost.

```
sudo ufw disable
```

did the trick

I can't believe it was just the default firewall settings, I hadn't even considered it since all remote control and screenshots were working. But I guess that's all handled through the open connection from provider to app side, doesn't mean anything is allowed in.

Thanks for the help.
  Hi ,

Can you give some instruction about what happens when user click "stop using" on one specified device?

I can't see any request in the network.  I tried to update the owner to null in device table, and UI seems to that device was released. But when I chose to use this device again, it can't show any device UI in control tab. I only need disconnect and reconnect this device again, it can work well again. 

So it need your instruction about what happens when user click "stop using" on one specified device? 
I want to release this device after use logout.

Thanks
Luis
 Thanks for your rich answer. So if I want to logout with releasing the occupied devices, I need simulate above process? Can you share some stf code snippet which were used for 'stop using' action.
 Thats a great life cycle explanation, Simo. I think, it would be great if you can write a document explaining STF architecture to speed up contribution from others.
 @luisxiaomai 

I tried to put the whole event cycle in diagram. If you read Simo's explanation with this image, It will be easy to understand.

![stf-architecture](https://cloud.githubusercontent.com/assets/7875161/9933823/b55123e0-5d88-11e5-8746-ae91fe90bc8c.png)
 @vbanthia good job. BTW, you lost stf device. stf-device should inside stf-provider.
 Really great diagram, gives a good overview of how the services interact.
I'd be very interested as well in an explanation of how to claim/release devices, as well as getting the adb connection string without having a browser involved.
 @sorccu, @gunta @vbanthia @codeskyblue  I read the front end code. When user clicks the "stop using" on one using device, browser sends the websocket message which is triggered by pure front end code, I want to know how I can simulate this in backend because I want to release all current user using devices when user session timeout or user logout.
 so this question has already been resolved? I meet the same problem now  @sorccu, @gunta @vbanthia @codeskyblue

my user always close the browser directly, so the other user must wait for the device to be timeout
 open a new ? but my problem is the same with luisxiaomai , when my user logout, the other users cannot use that device until timeout.

BTW, #152 can you cost some time to answer me ?  Thanks
 @gunta Thanks for your help, that's helpful.

I think if i can supply some big 'logout' button, they would like to click it. But like luisxiaomai, how I can simulate this in backend. Now what i do is that when user logout, update the device owner as 'null', then wait the device to timeout.  Is there another better way to release the device ?

BTW, where can i set the timeout option ? 

Thanks
 provider unit has timeout option, by default it is 15mins. So device will be released automatically after 15mins if kept idle. If you are running stf local then you can set it using --group-timeout options

`stf local --group-timeout 60`

If you are running using docker then you will have to set this option in provider unit.

>  Is there another better way to release the device ?

I don't think there is any better way but there is an easter egg. Just press Konami code when you are on device list { up up down down left right left right enter }. You will see a dialogue which will make you "admin" and then you can steal anyone's device. But do remember _with great power comes great responsibility_. So use it wisely.
 @LiufxLucky365 @gunta @vbanthia , my question is not to provide a logout function. My question is how I can simulate "release devices" in backend, whatever I want to do this when I logout or my trial time is over. I want to implement this similar features.
 I have a similar need. The primary need of my stakeholders is to get adb connection strings as easily as possible. So getting a list of devices (and whether they are claimed or not), claiming devices and releasing devices should ideally be done purely through API. 
Trying to get some node knowledge in order to dive in and figure it out myself, but any pointers would be appreciated.
 @luisxiaomai  Have you implemented that features now ?
 There is a similar issue, https://github.com/openstf/stf/issues/38

I started implementing RESTful `devices/:serial/reserve` & `devices/:serial/release` endpoints. But found its too complex because STF uses websocket for most of the client-server communication (which is good because it makes it real time app). And also, it checks xcrf token in each request which makes it kind of more difficult to create stateless apis. So I kind of gave up in between.

If anyone wants to give it a try, I can write what approach I was using but I will suggest to get it reviewed from STF developers before any implementation.

## Authorisation
- Every request to stf-app unit (api provider) goes through [auth middleware](https://github.com/openstf/stf/blob/master/lib/units/app/middleware/auth.js) which checks for valid session-id. If your request does not have a session id, it will redirect it to auth server to create a new session. So you need to modify this auth middleware such that it can forward request even it has only [jwt token](https://github.com/openstf/stf/blob/master/lib/units/app/middleware/auth.js#L8)
- Next step will be to develop a feature which can provide users their jwt token. Best way would be to create a section in "Setting" tab and show users their jwt token like github.
- Next, you need to get rid of csrf checking for RESTful apis. One way to do is check csrf after RESTful api section.

After this you will be able to access all STF apis from any http client library using command line.

## Implement reserve/release endpoints
- You will be going to implements these new endpoints in [stf-app unit](https://github.com/openstf/stf/blob/master/lib/units/app/index.js)
- For this just mimic the [websocket unit](https://github.com/openstf/stf/blob/master/lib/units/websocket/index.js) and do the same things what websocket unit does when it gets [reserve](https://github.com/openstf/stf/blob/master/lib/units/websocket/index.js#L614-L631) and [release](https://github.com/openstf/stf/blob/master/lib/units/websocket/index.js#L632-L643) messages. 
- You need to add app side push sockets and push group.join and group.kick messages to processor and inform all the websocket subscriber about the event so that people who are using web browser can also be updated.
- For remote debugging you need to send `connect.start` message to server and get remote debug url.

## Implement client

Last part being implement a good stf command line client which can use these endpoints easily.

I hope this will help.
  Hi, my stf works very well with two devices connected
but when i add more devices ( now i have 6 devices connected )
i find some devices hard to be ready and when they are ready , i connect them, the screen is white
i really do not know why
does anyone have ideas about this?
 Your USB controllers are probably aren't supplying enough power to all your devices. Consider getting a powered USB hub (see the FAQ section for more details about this).
 thank you for your answer
i find the device record in rethinkdb , the ready is false , does this means that the device is unable to use?
when i plug it off and plug in again , sometimes it is ok
so it is wierd
   Is this a good pr?
 If no reply on this pr until tomorror, I'll close it.
 Really poor English, shame ...-_-!!
 I still not thinking well about it and the UI is not well enough. I'm waiting for other people who can change it better.
 I am getting this below error

ERROR in ./~/css-loader!./~/sass-loader!./res/web_modules/nine-bootstrap/nine-bootstrap.scss
Module build failed: 
.btn &.disabled,
    ^
      Base-level rules cannot contain the parent-selector-referencing character '&'.

Backtrace:
    stdin:395
      in /Users/tade/Downloads/stf-0bf0beb61563117d16e033e7ecf40f7f37bda73f/res/web_modules/nine-bootstrap/nine-bootstrap.scss (line 395, column 6)
 @ ./res/web_modules/nine-bootstrap/nine-bootstrap.scss 4:14-137

node v0.12.7
npm 2.11.3
 Ok let me check.
  I look the docs, but didn't found any keyword about api.
  Fixed a bug related with gm module. 
This error is raised when storage-plugin-image server is seperated.
The error is shown the following.

``` javascript
Error: spawn gm ENOENT
    at exports._errnoException (util.js:746:11)
    at Process.ChildProcess._handle.onexit (child_process.js:1053:32)
    at child_process.js:1144:20
    at process._tickCallback (node.js:355:11)
error: Forever detected script exited with code: 1
error: Script restart attempt #16
INF/storage:plugins:image 16186 [*] Listening on port 7103
events.js:85
      throw er; // Unhandled 'error' event
```
 I'm sorry.
This is my mistake. GraphicsMagick library was installed incorrectly.
After GraphicsMagick reinstallation, everything is fine.
  Hello,
I'm using STF to control a set of many Android devices. Sometimes I can plug 6 devices without problem, and sometimes when I plug those 6 same devices, some devices stay disconnected after a connection attempt.

Here is the error message in the shell:

INF/provider 83795 [_] Cleaning up device worker "HT4AGJT04584"
ERR/provider 83795 [_] Device worker "HT4AGJT04584" died with code 1
INF/provider 83795 [*] Restarting device worker "HT4AGJT04584"
  error: missing required argument `--screen-port'

I got this message when I try to plug our Nexus 9 tab in Android 5.0.1.

Here are some info about the plugged device: 

add device 1: /dev/input/event0
  bus:      0000
  vendor    0000
  product   0003
  version   2002
  name:     "synaptics_dsx"
  location: "synaptics_dsx/touch_input"
  id:       ""
  version:  1.0.1
  events:
    KEY (0001): KEY_WAKEUP
    ABS (0003): ABS_MT_SLOT           : value 0, min 0, max 9, fuzz 0, flat 0, resolution 0
                ABS_MT_TOUCH_MAJOR    : value 0, min 0, max 47, fuzz 0, flat 0, resolution 0
                ABS_MT_TOUCH_MINOR    : value 0, min 0, max 47, fuzz 0, flat 0, resolution 0
                ABS_MT_POSITION_X     : value 0, min 0, max 3072, fuzz 0, flat 0, resolution 0
                ABS_MT_POSITION_Y     : value 0, min 0, max 2304, fuzz 0, flat 0, resolution 0
                ABS_MT_TRACKING_ID    : value 0, min 0, max 65535, fuzz 0, flat 0, resolution 0
                ABS_MT_PRESSURE       : value 0, min 0, max 255, fuzz 0, flat 0, resolution 0
  input props:
    INPUT_PROP_DIRECT
add device 2: /dev/input/event3
  bus:      0019
  vendor    0001
  product   0001
  version   0100
  name:     "gpio-keys.6"
  location: "gpio-keys/input0"
  id:       ""
  version:  1.0.1
  events:
    KEY (0001): KEY_VOLUMEDOWN        KEY_VOLUMEUP          KEY_POWER
  input props:
    <none>
add device 3: /dev/input/event2
  bus:      0000
  vendor    0000
  product   0000
  version   0000
  name:     "h2w headset"
  location: ""
  id:       ""
  version:  1.0.1
  events:
    KEY (0001): KEY_END               KEY_MUTE              KEY_VOLUMEDOWN        KEY_VOLUMEUP
                KEY_NEXTSONG          KEY_PLAYPAUSE         KEY_PREVIOUSSONG      KEY_REWIND
                KEY_FASTFORWARD       KEY_MEDIA             KEY_SEND              KEY_VOICECOMMAND
  input props:
    <none>
add device 4: /dev/input/event1
  bus:      0000
  vendor    0000
  product   0000
  version   0000
  name:     "CwMcuSensor"
  location: ""
  id:       ""
  version:  1.0.1
  events:
    SW  (0005): SW_LID                SW_CAMERA_LENS_COVER*
  input props:
    <none>

There is no problem with the Nexus 6 - 5.0.1.
Edit: Now, the same problem appears with the Nexus 6 - 5.0.1.
Thanks for your help guys ;-)
 Unfortunately, I met the same problem with you. Has now been fixed. I suggest you install the latest 'jpeg-turbo' package. And make sure other packages are up to date. I wish good luck
  sudo npm install -g stf

Mac 10.10   node 4.0.0

make: **\* [Release/obj.target/validation/src/validation.o] Error 1
gyp ERR! build error
gyp ERR! stack Error: `make` failed with exit code: 2
gyp ERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:270:23)
 stack     at emitTwo (events.js:87:13)
gyp ERR! stack     at ChildProcess.emit (events.js:172:7)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)
gyp ERR! System Darwin 14.5.0
gyp ERR! command "/usr/local/bin/node" "/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "rebuild"
gyp ERR! cwd /usr/local/lib/node_modules/stf/node_modules/ws/node_modules/utf-8-validate
gyp ERR! node -v v4.0.0
gyp ERR! node-gyp -v v3.0.1
gyp ERR! not ok
npm WARN optional dep failed, continuing bufferutil@1.1.0
 OK
 I spent last 2 days trying to run "npm install opencv" but it was working because my used node version was the 4.0.0. 
But thank to you guys, I came back to use node 0.12.7 and now , the command succeeded to install opencv. 

thanks a lot!!!  
 ``` diff
diff --git a/package.json b/package.json
index 1635d21..087fd3c 100644
--- a/package.json
+++ b/package.json
@@ -56,12 +56,12 @@
     "lodash": "^3.10.1",
     "markdown-serve": "^0.3.2",
     "mime": "^1.3.4",
-    "minimatch": "^2.0.10",
+    "minimatch": "^3.0.0",
     "my-local-ip": "^1.0.0",
     "node-uuid": "^1.4.3",
     "passport": "^0.3.0",
     "passport-oauth2": "^1.1.2",
-    "protobufjs": "^3.8.2",
+    "protobufjs": "^4.1.1",
     "proxy-addr": "^1.0.7",
     "request": "^2.61.0",
     "request-progress": "^0.3.1",
```

that fixed it for me

however, it produced a new error

```
WRN/device:plugins:data 75973 [DEVICE SERIAL] Unable to find device data { serial: 'DEVICE SERIAL',
  platform: 'Android',
  manufacturer: 'MOTOROLA',
  operator: '',
  model: 'XT1049',
  version: '4.4.4',
  abi: 'armeabi-v7a',
  sdk: '19',
  product: 'ghost_repw',
  display:
   { id: 0,
     width: 720,
     height: 1280,
     xdpi: 315.6499938964844,
     ydpi: 315.30999755859375,
     fps: 60,
     density: 2,
     rotation: 90,
     secure: true,
     size: 4.656448360854734,
     url: 'ws://localhost:7400' },
  phone:
   { imei: 'VALID IMEI',
     phoneNumber: 'VALID PHONE',
     iccid: 'VALID ICCID',
     network: 'LTE' } }
INF/device:plugins:touch 75973 [DEVICE SERIAL] Touch origin is top left
INF/device:plugins:touch 75973 [DEVICE SERIAL] Requesting touch consumer to start
INF/device:plugins:touch 75973 [DEVICE SERIAL] Launching screen service
INF/device:plugins:touch 75973 [DEVICE SERIAL] Connecting to minitouch service
INF/device:plugins:touch 75973 [DEVICE SERIAL] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 75973 [DEVICE SERIAL] minitouch says: "Type B touch device synaptics_dsx_i2c (719x1279 with 10 contacts) detected on /dev/input/event2 (score 1100)"
INF/webpack:config 75967 [*] Build progress 64% (108/120 build modules)
INF/device:plugins:touch 75973 [DEVICE SERIAL] Reading minitouch banner
INF/device:plugins:touch 75973 [DEVICE SERIAL] minitouch says: "Connection established"
INF/device:plugins:vnc 75973 [DEVICE SERIAL] Starting VNC server on port 7402
INF/device:plugins:browser 75973 [DEVICE SERIAL] Loading browser list
INF/device:plugins:browser 75973 [DEVICE SERIAL] Updating browser list
INF/device:plugins:mute 75973 [DEVICE SERIAL] Will not mute master volume during use
INF/device:plugins:forward 75973 [DEVICE SERIAL] Launching reverse port forwarding service
INF/device:plugins:forward 75973 [DEVICE SERIAL] Connecting to reverse port forwarding service
INF/device:plugins:connect 75973 [DEVICE SERIAL] Listening on port 7401
INF/device 75973 [DEVICE SERIAL] Fully operational
INF/webpack:config 75967 [*] Build progress 67% (116/121 build modules)
events.js:141
      throw er; // Unhandled 'error' event
      ^

TypeError: keyOrObj.hasOwnProperty is not a function
    at MessagePrototype.set (/Users/name/stf/node_modules/protobufjs/dist/ProtoBuf.js:2444:42)
    at Message (/Users/name/stf/node_modules/protobufjs/dist/ProtoBuf.js:2374:34)
    at Router.<anonymous> (/Users/name/stf/lib/units/device/plugins/solo.js:43:11)
    at Router.emit (/Users/name/stf/node_modules/eventemitter3/index.js:74:35)
    at Router.<anonymous> (/Users/name/stf/lib/wire/router.js:36:12)
    at emitTwo (events.js:87:13)
    at emit (events.js:172:7)
    at Socket._flush (/Users/name/stf/node_modules/zmq/lib/index.js:554:17)
    at _zmq.onReady (/Users/name/stf/node_modules/zmq/lib/index.js:203:12)
INF/provider 75965 [*] Cleaning up device worker "DEVICE SERIAL"
ERR/provider 75965 [*] Device worker "DEVICE SERIAL" died with code 1
```
  Sorry to keep spamming this forum, but I seem to be really close to having the complete system working. All services are in the green and everything seems to communicate like it should... Except for the database connection, so that's quite an important link I'm missing.

Here's my setup:
1. A Ubuntu Server 15 VM (192.168.99.**107**) running RethinkDB in a docker container, and an ambassador exposing it to the world.

rethinkdb.service

```
[Unit]
Description=RethinkDB
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull sorccu/rethinkdb:1.15.2
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  sorccu/rethinkdb:1.15.2
ExecStop=-/usr/bin/docker stop -t 10 %p
```

rethinkdb-ambassador.service

```
[Unit]
Description=RethinkDB ambassador
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/ambassador:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  --link rethinkdb:rethinkdb \
  -p 28015:28015 \
  openstf/ambassador:latest
ExecStop=-/usr/bin/docker stop -t 10 %p
```
1. A Ubuntu Server 15 VM (192.168.99.**106**) running the rest of the stf services, and a rethinkdb-proxy-28015.service to make the database connection 

rethinkdb-proxy-28015.service

```
[Unit]
Description=RethinkDB proxy/28015
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/ambassador:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -e "AUTHKEY=1234" \
  -p 28015 \
  -e RETHINKDB_PORT_28015_TCP=tcp://192.168.99.107:28015 \
  openstf/ambassador:latest
ExecStop=-/usr/bin/docker stop -t 10 %p
```

To test it I try running the stf-migrate.service

```
[Unit]
Description=STF migrate
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
Type=oneshot
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  --link rethinkdb-proxy-28015:rethinkdb \
  openstf/stf:latest \
  stf migrate
```

Now, from the client, I can do wget 192.168.99.107:28015 and receive the index.html explaining "this is a rethinkdb port, you are connecting wrong". So I know that the address is open and accessible, so the ambassador is working its part.

However, trying to launch stf-migrate (or any other service connecting to the rethinkdb-proxy), this happens:

```
Sep 09 10:34:08 ubuntu docker[17758]: INF/db 1 [*] Connecting to 172.17.7.85:28015
Sep 09 10:34:08 ubuntu docker[17758]: INF/db 1 [*] Unable to connect to 172.17.7.85:28015
Sep 09 10:34:08 ubuntu docker[17758]: FTL/db 1 [*] No hosts left to try
Sep 09 10:34:08 ubuntu docker[17758]: FTL/util:lifecycle 1 [*] Shutting down due to fatal error
Sep 09 10:34:09 ubuntu systemd[1]: stf-migrate.service: main process exited, code=exited, status=1/FAILURE
```

So stf-migrate tries to connect to the rethinkdb-proxy-28015.service docker container, and fails. The problem seems to be entirely local on the second machine, since the ambassador seems to work perfectly. The services cannot connect to the proxy properly, but I cannot figure out where the problem comes from.
 I was just trying different things in desperation, trying to get it to work. Found your rethinkdb docker container via your docker account, presumed it was the one you were using. I've changed it to the official one now.

The problem turned out to be the auth key. Now I can connect to the database server. Thanks a lot!

Now all the services seem to be running and communicating with each other.
Only problem left is accessing the webpage. Trying to connect to the ip gives a 502 Bad Gateway, and the log for nginx.service shows, I think, that it doesn't get a response from the stf-app@3100.service:

```
Sep 09 12:46:03 ubuntu docker[15216]: 192.168.99.1 - - [09/Sep/2015:11:46:03 +0000] "GET / HTTP/1.1" 502 575 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.85 Safari/537.36"
Sep 09 12:46:03 ubuntu docker[15216]: 2015/09/09 11:46:03 [error] 6#0: *8 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.99.1, server: 192.168.99.106, request: "GET / HTTP/1.1", upstream: "http://192.168.99.106:3100/", host: "192.168.99.106"
Sep 09 12:46:03 ubuntu docker[15216]: 2015/09/09 11:46:03 [error] 6#0: *8 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.99.1, server: 192.168.99.106, request: "GET /favicon.ico HTTP/1.1", upstream: "http://192.168.99.106:3100/favicon.ico", host: "192.168.99.106", referrer: "https://192.168.99.106/"
Sep 09 12:46:03 ubuntu docker[15216]: 192.168.99.1 - - [09/Sep/2015:11:46:03 +0000] "GET /favicon.ico HTTP/1.1" 502 575 "https://192.168.99.106/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.85 Safari/537.36"
```

The log for stf-app@3100.service shows it starting up, and apparantly nothing else:

```
Sep 09 12:10:33 ubuntu systemd[1]: Started STF app.
Sep 09 12:10:34 ubuntu docker[361]: INF/app 1 [*] Using pre-built resources
Sep 09 12:10:34 ubuntu docker[361]: INF/app 1 [*] Listening on port 3000
Sep 09 12:10:34 ubuntu docker[361]: INF/db 1 [*] Connecting to 172.17.9.111:28015
```

Connecting manually to 192.168.99.106:3100 (app address), gives ERR_CONNECTION_REFUSED in a browser. My nginx.conf is identical to the verison in DEPLOYMENT.md, except I changed all the IPs to my local one, 192.168.99.106, where all the services run. Kept the ports the same as the examples in DEPLOYMENT.md:

```
daemon off;
worker_processes 4;

events {
  worker_connections 1024;
}

http {
  upstream stf_app {
    server 192.168.99.106:3100 max_fails=0;
  }

  upstream stf_auth {
    server 192.168.99.106:3200 max_fails=0;
  }

  upstream stf_storage_apk {
    server 192.168.99.106:3300 max_fails=0;
  }

  upstream stf_storage_image {
    server 192.168.99.106:3400 max_fails=0;
  }

  upstream stf_storage {
    server 192.168.99.106:3500 max_fails=0;
  }

  upstream stf_websocket {
    server 192.168.99.106:3600 max_fails=0;
  }

  types {
    application/javascript  js;
    image/gif               gif;
    image/jpeg              jpg;
    text/css                css;
    text/html               html;
  }

    map $http_upgrade $connection_upgrade {
    default  upgrade;
    ''       close;
  }

  server {
    listen 80;
    server_name 192.168.99.106;
    return 301 https://$server_name$request_uri;
  }

  server {
    listen 443 ssl;
    server_name 192.168.99.106;
    keepalive_timeout 70;
    root /dev/null;

    # https://mozilla.github.io/server-side-tls/ssl-config-generator/
    ssl_certificate /etc/nginx/ssl/cert.pem;
    ssl_certificate_key /etc/nginx/ssl/cert.key;
    ssl_session_timeout 5m;
    ssl_session_cache shared:SSL:10m;
    ssl_dhparam /etc/nginx/ssl/dhparam.pem;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA;
    ssl_prefer_server_ciphers on;

    #add_header Strict-Transport-Security max-age=15768000;

    #ssl_stapling on;
    #ssl_stapling_verify on;
    #ssl_trusted_certificate /etc/nginx/ssl/cert.pem;

    resolver 8.8.4.4 8.8.8.8 valid=300s;
    resolver_timeout 10s;

    # Handle stf-provider@cupboard1.service
    location ~ "^/d/cupboard1/([^/]+)/(?<port>[0-9]{5})/$" {
      proxy_pass http://192.168.99.106:$port/;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_set_header X-Forwarded-For $remote_addr;
      proxy_set_header X-Real-IP $remote_addr;
    }

    location /auth/mock/ {
      proxy_pass http://stf_auth/auth/mock/;
    }

    location /s/image/ {
      proxy_pass http://stf_storage_image;
    }

    location /s/apk/ {
      proxy_pass http://stf_storage_apk;
    }

    location /s/ {
      client_max_body_size 1024m;
      client_body_buffer_size 128k;
      proxy_pass http://stf_storage;
    }

     location /socket.io/ {
      proxy_pass http://stf_websocket;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Real-IP $http_x_real_ip;
    }

    location / {
      proxy_pass http://stf_app;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Real-IP $http_x_real_ip;
    }
  }
}

```
 I had the same problem, I fixed it by

Removing 127.0.0.1 from publish port of all the services which starts nodejs server. For example

this will

```
[Unit]
Description=STF app
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --link rethinkdb-proxy-28015:rethinkdb \
  -e "SECRET=YOUR_SESSION_SECRET_HERE" \
  -p 127.0.0.1:%i:3000 \
  openstf/stf:latest \
  stf app --port 3000 \
    --auth-url https://stf.example.org/auth/mock/ \
    --websocket-url https://stf.example.org/
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```

become this

```
[Unit]
Description=STF app
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p-%i
ExecStartPre=-/usr/bin/docker rm %p-%i
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  --link rethinkdb-proxy-28015:rethinkdb \
  -e "SECRET=YOUR_SESSION_SECRET_HERE" \
  -p %i:3000 \
  openstf/stf:latest \
  stf app --port 3000 \
    --auth-url https://stf.example.org/auth/mock/ \
    --websocket-url https://stf.example.org/
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```

You need to do this for all the below services
- stf-app@.service
- stf-auth@.service
- stf-storage-plugin-apk@.service
- stf-storage-plugin-image@.service
- stf-storage-temp@.service
- stf-websocket@.service

After you finish this and restart your units, you will be able to see the login page. But wont be able to login, because there is a small problem in sample nginx.conf file.

You will need to change

```
    location /auth/mock/ {
      proxy_pass http://stf_auth/auth/mock/;
    }
```

to

```
    location /auth/ {
      proxy_pass http://stf_auth/auth/;
    }
```

in your nginx.conf file.

After this, I think you will be ready to enjoy STF in production.

Would like to add one last point here, In my case I am not running nginx using docker, I am running nginx directly on the host server.
 Well truth is I did not research much for the root cause, When I started my units with publish port `127.0.0.1:...`. I was able to get valid response from  `wget 127.0.0.1:3100` but  `wget $IP:3100` was resulting into connection refused error. 

After removing 127.0.0.1 from publish port, I was getting valid response from `wget $IP:3100`.
 Removing 127.0.0.1 and changing the nginx.config fixed it. Everything now works, except I can't see the screen of the device - controlling it works, but the field is just blank grey.
 I did a bit research and found that after removing 127.0.0.1, docker will publish or bind it to 0.0.0.0 which means it is binding container port to all the host interface which is not very good or secure. My current best approach will be to bind docker port to IP address itself. eg `-p $HOST_STATIC_IP:%i:$PORT`. This will bind only to eth0 interface.

I am still trying to understand why it is working in case of Simo. I can think about two cases.
1. nginx is proxying to localhost instead of raising connection refused.
2. docker container is also binding port to $HOST_IP

@sorccu 
Can you try accessing stf-app server directly using `wget $HOST_IP:3100`
 I can now take screenshots without problems - my self-signed ssh certificate was ruining the screenshot feature:

```
Sep 09 15:20:00 ubuntu docker[2376]: INF/device:plugins:screen:capture 18 [aa0d987a] Capturing screenshot
Sep 09 15:20:01 ubuntu docker[2376]: ERR/device:support:storage 18 [aa0d987a] Upload to "https://192.168.99.106/s/upload/image" failed Error: certificate has expired
Sep 09 15:20:01 ubuntu docker[2376]: at Error (native)
Sep 09 15:20:01 ubuntu docker[2376]: at TLSSocket.<anonymous> (_tls_wrap.js:929:36)
Sep 09 15:20:01 ubuntu docker[2376]: at TLSSocket.emit (events.js:104:17)
Sep 09 15:20:01 ubuntu docker[2376]: at TLSSocket._finishInit (_tls_wrap.js:460:8)
Sep 09 15:20:01 ubuntu docker[2376]: ERR/device:plugins:screen:capture 18 [aa0d987a] Screen capture failed Error: certificate has expired
Sep 09 15:20:01 ubuntu docker[2376]: at Error (native)
Sep 09 15:20:01 ubuntu docker[2376]: at TLSSocket.<anonymous> (_tls_wrap.js:929:36)
Sep 09 15:20:01 ubuntu docker[2376]: at TLSSocket.emit (events.js:104:17)
Sep 09 15:20:01 ubuntu docker[2376]: at TLSSocket._finishInit (_tls_wrap.js:460:8)
```

Turned off ssh and running on normal http, screenshots work.

Still can't see the feed of the device screen, though. Tested on 4 devices that work in stf -local.
What service is responsible for providing the video feed? Where can I check the logs?
 provider is responsible for fetching device screen. You should check provider unit logs.
 I have submitted a pull request regarding a problem in sample nginx.conf file, you should also consider this, since most of the people going to use same sample nginx.conf for first time.

https://github.com/openstf/stf/pull/75
 Yeah, seems like it's not connecting to the websocket.
<img width="1279" alt="screen shot 2015-09-09 at 16 11 03" src="https://cloud.githubusercontent.com/assets/657289/9765744/b0533b84-570d-11e5-88ef-d746664682df.png">

And this is what the only part of the provider log that mentions the websocket:

```
Sep 09 15:53:48 ubuntu docker[1586]: INF/device:plugins:screen:stream 10 [aa0d987a] Starting WebSocket server on port 15000
```

and this is how it's formated in the service file:

```
--screen-ws-url-pattern "wss://192.168.99.106/d/%i/<%= serial %>/<%= publicPort %>/"
```
 I think since you are not using ssl, you should use "ws" URL Scheme for url pattern instead of wss.
 You're probably right. Changing that one line doesn't seem to be enough, though. Now it just leads to a 404.
<img width="1280" alt="screen shot 2015-09-09 at 16 42 15" src="https://cloud.githubusercontent.com/assets/657289/9766650/ed237f70-5711-11e5-9d8c-cdf527a70d31.png">

I might just try setting ssl up again with the NODE_TLS_REJECT flag instead, in order to stay closer to the example configuration.
 Literally just pasted from 443 over to 80 instead, minus the ssl part:

```
daemon off;
worker_processes 4;

events {
  worker_connections 1024;
}

http {
  upstream stf_app {
    server 192.168.99.106:3100 max_fails=0;
  }

  upstream stf_auth {
    server 192.168.99.106:3200 max_fails=0;
  }

  upstream stf_storage_apk {
    server 192.168.99.106:3300 max_fails=0;
  }

  upstream stf_storage_image {
    server 192.168.99.106:3400 max_fails=0;
  }

  upstream stf_storage {
    server 192.168.99.106:3500 max_fails=0;
  }

  upstream stf_websocket {
    server 192.168.99.106:3600 max_fails=0;
  }

  types {
    application/javascript  js;
    image/gif               gif;
    image/jpeg              jpg;
    text/css                css;
    text/html               html;
  }

    map $http_upgrade $connection_upgrade {
    default  upgrade;
    ''       close;
  }

  server {
    listen 80;
    server_name 192.168.99.106;

    keepalive_timeout 70;
    root /dev/null;

    resolver 8.8.4.4 8.8.8.8 valid=300s;
    resolver_timeout 10s;

    # Handle stf-provider@cupboard1.service
    location ~ "^/d/cupboard1/([^/]+)/(?<port>[0-9]{5})/$" {
      proxy_pass http://192.168.99.106:$port/;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_set_header X-Forwarded-For $remote_addr;
      proxy_set_header X-Real-IP $remote_addr;
    }

    location /auth/ {
      proxy_pass http://stf_auth/auth/;
    }

    location /s/image/ {
      proxy_pass http://stf_storage_image;
    }

    location /s/apk/ {
      proxy_pass http://stf_storage_apk;
    }

    location /s/ {
      client_max_body_size 1024m;
      client_body_buffer_size 128k;
      proxy_pass http://stf_storage;
    }

    location /socket.io/ {
      proxy_pass http://stf_websocket;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Real-IP $http_x_real_ip;
    }

    location / {
      proxy_pass http://stf_app;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Real-IP $http_x_real_ip;
    }

  }

}
```
 your provider name is "cabinet1" while in your nginx config file you have written "cupboard1". 

change `location ~ "^/d/cupboard1/([^/]+)/(?<port>[0-9]{5})/$" {` -> `location ~ "^/d/cabinet1/([^/]+)/(?<port>[0-9]{5})/$" {`
 Well that was a really stupid mistake on my part, well spotted.

Videofeed and everything else works now, thank you guys for all the help!
 marcuccifelicia01@gmail.com
 I am having some problem in running stf-app@.service, stf-migrate.service, stf-reaper.service

status of services..
● stf-websocket@3600.service - STF websocket
Loaded: loaded (/etc/systemd/system/stf-websocket@.service; static; vendor preset: enabled)
Drop-In: /etc/systemd/system/stf-websocket@.service.d
└─override.conf
Active: inactive (dead)

Jul 04 16:01:52 linux-rahul docker[30612]: FTL/db 1 [] No hosts left to try
Jul 04 16:01:52 linux-rahul docker[30612]: FTL/util:lifecycle 1 [] Shutting down due to fatal error
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Main process exited, code=exited, status=1/FAILURE
Jul 04 16:01:52 linux-rahul docker[30766]: Error response from daemon: No such container: stf-websocket-3600
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Control process exited, code=exited status=1
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Unit entered failed state.
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Failed with result 'exit-code'.
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Service hold-off time over, scheduling restart.
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Stop job pending for unit, delaying automatic rest
Jul 04 16:01:52 linux-rahul systemd[1]: Stopped STF websocket.
lines 1-16/16 (END)

● stf-reaper.service - STF reaper
Loaded: loaded (/etc/systemd/system/stf-reaper.service; static; vendor preset: enabled)
Drop-In: /etc/systemd/system/stf-reaper.service.d
└─override.conf
Active: failed (Result: exit-code) since Tue 2017-07-04 16:08:18 IST; 3s ago
Process: 31367 ExecStop=/usr/bin/docker stop -t 10 %p (code=exited, status=0/SUCCESS)
Process: 31348 ExecStop=/usr/bin/docker stop -t 10 %p (code=exited, status=0/SUCCESS)
Process: 31200 ExecStart=/usr/bin/docker run --rm --name %p --link rethinkdb-proxy-28015:rethinkdb openstf/stf:lates
Process: 31192 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
Process: 31183 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
Process: 31174 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/SUCCESS)
Process: 31166 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
Process: 31158 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
Process: 31151 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/SUCCESS)
Main PID: 31200 (code=exited, status=1/FAILURE)

Jul 04 16:08:17 linux-rahul docker[31200]: INF/db 1 [dev] Unable to connect to 172.17.0.7:28015
Jul 04 16:08:17 linux-rahul docker[31200]: FTL/db 1 [dev] No hosts left to try
Jul 04 16:08:17 linux-rahul docker[31200]: FTL/util:lifecycle 1 [dev] Shutting down due to fatal error
Jul 04 16:08:18 linux-rahul systemd[1]: Stopping STF reaper...
Jul 04 16:08:18 linux-rahul docker[31348]: stf-reaper
Jul 04 16:08:18 linux-rahul docker[31367]: stf-reaper
Jul 04 16:08:18 linux-rahul systemd[1]: stf-reaper.service: Main process exited, code=exited, status=1/FAILURE

● stf-app@3100.service - STF app
Loaded: loaded (/etc/systemd/system/stf-app@.service; static; vendor preset: enabled)
Drop-In: /etc/systemd/system/stf-app@.service.d
└─override.conf
Active: inactive (dead)

Jul 04 15:44:13 linux-rahul docker[29378]: INF/app 1 [] Using pre-built resources
Jul 04 15:44:13 linux-rahul docker[29378]: INF/app 1 [] Listening on port 3000
Jul 04 15:44:13 linux-rahul docker[29378]: INF/db 1 [] Connecting to 172.17.0.7:28015
Jul 04 15:44:14 linux-rahul docker[29378]: INF/db 1 [] Unable to connect to 172.17.0.7:28015
Jul 04 15:44:14 linux-rahul docker[29378]: FTL/db 1 [] No hosts left to try
Jul 04 15:44:14 linux-rahul docker[29378]: FTL/util:lifecycle 1 [] Shutting down due to fatal error
Jul 04 15:44:14 linux-rahul systemd[1]: Stopping STF app...
Jul 04 15:44:14 linux-rahul docker[29536]: stf-app-3100
Jul 04 15:44:14 linux-rahul docker[29552]: stf-app-3100
Jul 04 15:44:14 linux-rahul systemd[1]: Stopped STF app.

my other services that are needed for these service to work are running

CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
6f473dd263b7 openstf/ambassador:latest "/run.sh" 33 minutes ago Up 33 minutes 0.0.0.0:32769->28015/tcp rethinkdb-proxy-28015
162a96d3b7b2 openstf/stf:latest "stf auth-mock --port" 48 minutes ago Up 48 minutes 0.0.0.0:3200->3000/tcp stf-auth-3200
f5f11e62a352 rethinkdb:2.3.5 "rethinkdb --bind all" 2 hours ago Up 2 hours 0.0.0.0:8080->8080/tcp, 0.0.0.0:28015->28015/tcp, 0.0.0.0:29015->29015/tcp rethinkdb
cab4b8344e50 openstf/stf:latest "stf triproxy dev --b" 2 hours ago Up 2 hours stf-triproxy-dev
0bcda7b6a11f openstf/stf:latest "stf triproxy app --b" 2 hours ago Up 2 hours stf-triproxy-app
e62202bbfe23 openstf/stf:latest "stf storage-plugin-i" 2 hours ago Up 2 hours 0.0.0.0:3500->3000/tcp stf-storage-temp-3500
ac9926857cc6 openstf/stf:latest "stf storage-plugin-i" 2 hours ago Up 2 hours 0.0.0.0:3400->3000/tcp stf-storage-plugin-image-3400
1a95bacdeefb openstf/stf:latest "stf storage-plugin-a" 2 hours ago Up 2 hours 0.0.0.0:3300->3000/tcp stf-storage-plugin-apk-3300
d7ac389ce7f6 openstf/stf:latest "stf provider --name " 2 hours ago Up 2 hours stf-provider-floor8
877bde7a6f16 openstf/stf:latest "stf provider --name " 2 hours ago Up 2 hours stf-provider-floor4
1a2441bcf8a9 sorccu/adb:latest "/sbin/tini -- adb -a" 2 hours ago Up 2 hours adbd

I am not able to figure out what is the problem here, please guide. Thanks in advance If we are running all services on a single machine rather than running on distributed cluster do we still need rethinkdb-proxy-28015.service. Or we can simply connect other services to rethinkdb.service instead of rethinkdb-proxy-28015. 

Thanks in advance  With current sample nginx.conf, endpoint such as [/auth/api/v1/mock](https://github.com/openstf/stf/blob/master/lib/units/auth/mock.js#L60) or [/auth/api/v1/ldap](https://github.com/openstf/stf/blob/master/lib/units/auth/ldap.js#L61) will be proxied to stf-app instead of stf-auth server which will cause status 302 with /undefined endpoint.

This is a small fix for above problem.
  ```
$ netstat -anp | grep 7100
$ tcp6       0      0 :::7100                 :::*                    LISTEN      19521/node
```

How can I run stf on localhost? I would like the following output "127.0.0.1:7100". But it's not. (I see and try deployment paper)
 Yes you are right, i am accessing it. But i want to forward on nginx(proxy_pass option). They conflicts(nginx and stf -> 0.0.0.0:7100). How to fix it? 
 kartx22:~/workspace (master) $ stf local
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js migrate"
INF/db 52255 [_] Connecting to 127.0.0.1:28015
INF/db:setup 52255 [_] Database "stf" already exists
INF/db:setup 52255 [_] Table "users" already exists
INF/db:setup 52255 [_] Table "devices" already exists
INF/db:setup 52255 [_] Table "logs" already exists
INF/db:setup 52255 [_] Index "users"."adbKeys" already exists
INF/db:setup 52255 [_] Index "devices"."owner" already exists
INF/db:setup 52255 [_] Index "devices"."present" already exists
INF/db:setup 52255 [_] Index "devices"."providerChannel" already exists
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js provider --name kartx22-stf-2306377 --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js storage-temp --port 7102"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 52250 [_] Forking "/home/ubuntu/.nvm/versions/node/v4.2.1/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
INF/triproxy 52260 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 52260 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 52260 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/db 52266 [proc001] Connecting to 127.0.0.1:28015
INF/processor 52266 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 52266 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/triproxy 52265 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 52265 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 52265 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/reaper 52280 [reaper001] Subscribing to permanent channel "_ALL"
INF/reaper 52280 [reaper001] Reaping devices with no heartbeat
INF/db 52280 [reaper001] Connecting to 127.0.0.1:28015
INF/reaper 52280 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 52280 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/db 52271 [proc002] Connecting to 127.0.0.1:28015
INF/processor 52271 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/poorxy 52316 [_] Listening on port 7100
INF/processor 52271 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/provider 52285 [_] Subscribing to permanent channel "ys8/8DcXTMS4yjsiD1NBDA=="
INF/provider 52285 [_] Sending output to "tcp://127.0.0.1:7116"
INF/provider 52285 [_] Receiving input from "tcp://127.0.0.1:7114"
Unhandled rejection Error: spawn adb ENOENT
    at exports._errnoException (util.js:874:11)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:178:32)
    at onErrorNT (internal/child_process.js:344:16)
    at doNTCallback2 (node.js:439:9)
    at process._tickCallback (node.js:353:17)
INF/storage:plugins:apk 52315 [_] Listening on port 7104
INF/auth-mock 52286 [_] Listening on port 7120
INF/storage:temp 52301 [_] Listening on port 7102
INF/storage:plugins:image 52306 [_] Listening on port 7103
INF/app 52291 [_] Using pre-built resources
INF/app 52291 [_] Listening on port 7105
INF/db 52291 [_] Connecting to 127.0.0.1:28015
INF/websocket 52296 [_] Subscribing to permanent channel "_ALL"
INF/websocket 52296 [_] Listening on port 7110
INF/db 52296 [_] Connecting to 127.0.0.1:28015
INF/websocket 52296 [_] Sending output to "tcp://127.0.0.1:7113"
INF/websocket 52296 [*] Receiving input from "tcp://127.0.0.1:7111"

when i enter http://localhost:7100 on browser it only show blank page i try using --public-ip i got no website available on browser 
 ok ill try to reinstall adb and try again.
 I run the prompt on this machine, unable to enter the STF client, what happened?
Can not access this site

localhost rejected our connection request.
Please try the following:
Check the network connection
Check the proxy server and firewall
ERR_CONNECTION_REFUSED  Hi there
Again, hope I'm not missing something obvious, but it turned out to be a good idea to write here when I couldn't get adbd.service working.

When I start rethinkdb-proxy-28015 I get an error that I have tried to troubleshoot all day.
Using the same rethinkdb-proxy-28015.service as DEPLOYMENT.md, changed the authkey to 1234 and the ip to the ip of this same machine (running everything on one machine)
RethinkDB is running with --bind all, and I can access the web interface from my browser on the same ip, port 8080.

Here is what happens when I try to start the service:

```
Sep 07 15:44:26 ubuntu systemd[1]: Starting rethinkdb-proxy-28015.service...
Sep 07 15:44:28 ubuntu docker[568]: latest: Pulling from ctlc/ambassador
Sep 07 15:44:28 ubuntu docker[568]: 093e01545ca5: Already exists
Sep 07 15:44:28 ubuntu docker[568]: 639d60300768: Already exists
Sep 07 15:44:28 ubuntu docker[568]: 50e9f95f98f1: Already exists
Sep 07 15:44:28 ubuntu docker[568]: 6d021018145f: Already exists
Sep 07 15:44:28 ubuntu docker[568]: c33211982f7d: Already exists
Sep 07 15:44:28 ubuntu docker[568]: 0da04ef149d0: Already exists
Sep 07 15:44:28 ubuntu docker[568]: c56de9c5a0d2: Already exists
Sep 07 15:44:28 ubuntu docker[568]: 410000273ccc: Already exists
Sep 07 15:44:28 ubuntu docker[568]: 1c9abde34886: Already exists
Sep 07 15:44:28 ubuntu docker[568]: 53e2694bc9d6: Already exists
Sep 07 15:44:28 ubuntu docker[568]: a853fbf35ee2: Already exists
Sep 07 15:44:28 ubuntu docker[568]: cea471227545: Already exists
Sep 07 15:44:28 ubuntu docker[568]: cea471227545: Already exists
Sep 07 15:44:28 ubuntu docker[568]: Digest: sha256:f1648fa46b91d757b7cdd681ff134284e9903849faab0d30f3d8179c2429340c
Sep 07 15:44:28 ubuntu docker[568]: Status: Image is up to date for ctlc/ambassador:latest
Sep 07 15:44:28 ubuntu docker[701]: Error response from daemon: Cannot kill container rethinkdb-proxy-28015: no such id: rethinkdb-proxy-28015
Sep 07 15:44:28 ubuntu docker[701]: Error: failed to kill containers: [rethinkdb-proxy-28015]
Sep 07 15:44:28 ubuntu docker[709]: Error response from daemon: no such id: rethinkdb-proxy-28015
Sep 07 15:44:28 ubuntu docker[709]: Error: failed to remove containers: [rethinkdb-proxy-28015]
Sep 07 15:44:28 ubuntu systemd[1]: Started rethinkdb-proxy-28015.service.
Sep 07 15:44:28 ubuntu docker[716]: 2015-09-07 14:44:28,963 CRIT Supervisor running as root (no user in config file)
Sep 07 15:44:28 ubuntu docker[716]: 2015-09-07 14:44:28,963 WARN Included extra file "/etc/supervisor/conf.d/supervisord-socat.conf" during parsing
Sep 07 15:44:28 ubuntu docker[716]: 2015-09-07 14:44:28,988 INFO RPC interface 'supervisor' initialized
Sep 07 15:44:28 ubuntu docker[716]: 2015-09-07 14:44:28,988 WARN cElementTree not installed, using slower XML parser for XML-RPC
Sep 07 15:44:28 ubuntu docker[716]: 2015-09-07 14:44:28,988 CRIT Server 'unix_http_server' running without any HTTP authentication checking
Sep 07 15:44:28 ubuntu docker[716]: 2015-09-07 14:44:28,988 INFO supervisord started with pid 1
Sep 07 15:44:29 ubuntu docker[716]: 2015-09-07 14:44:29,992 INFO spawned: 'socat' with pid 7
Sep 07 15:44:30 ubuntu docker[716]: 2015-09-07 14:44:29,999 INFO exited: socat (exit status 0; not expected)
Sep 07 15:44:31 ubuntu docker[716]: 2015-09-07 14:44:31,002 INFO spawned: 'socat' with pid 13
Sep 07 15:44:31 ubuntu docker[716]: 2015-09-07 14:44:31,009 INFO exited: socat (exit status 0; not expected)
Sep 07 15:44:31 ubuntu docker[716]: 2015-09-07 14:44:31,012 CRIT reaped unknown pid 18)
Sep 07 15:44:33 ubuntu docker[716]: 2015-09-07 14:44:33,018 INFO spawned: 'socat' with pid 22
Sep 07 15:44:33 ubuntu docker[716]: 2015-09-07 14:44:33,026 INFO exited: socat (exit status 0; not expected)
Sep 07 15:44:33 ubuntu docker[716]: 2015-09-07 14:44:33,027 CRIT reaped unknown pid 27)
Sep 07 15:44:36 ubuntu docker[716]: 2015-09-07 14:44:36,032 INFO spawned: 'socat' with pid 28
Sep 07 15:44:36 ubuntu docker[716]: 2015-09-07 14:44:36,046 INFO exited: socat (exit status 0; not expected)
Sep 07 15:44:36 ubuntu docker[716]: 2015-09-07 14:44:36,048 INFO gave up: socat entered FATAL state, too many start retries too quickly
Sep 07 15:44:36 ubuntu docker[716]: 2015-09-07 14:44:36,048 CRIT reaped unknown pid 33)
```

And here is my rethinkdb-proxy-28015.service file:

```
Description=RethinkDB proxy/28015
After=docker.service
Requires=docker.service

[Service]
EnvironmentFile=/etc/environment
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull ctlc/ambassador:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -e "AUTHKEY=1234" \
  -p 28015 \
  -e RETHINKDB_PORT_28015_TCP=tcp://192.168.99.106:28015 \
  ctlc/ambassador:latest
ExecStop=-/usr/bin/docker stop -t 10 %p
```

Tried running the docker run command directly, both on this machine and on a fresh install and it does the same. I am unsure where I should look to find the error, feel like I've been through everything.

Thanks for your time, I appreciate the help
 Hi,

I am experiencing the same problem. 

Can anyone help?

Thanks!
 -- Logs begin at Mon 2015-09-07 22:18:29 BST, end at Tue 2015-09-08 15:56:09 BST. --
Sep 08 15:53:32 ubuntu systemd[1]: Starting RethinkDB proxy/28015...
Sep 08 15:53:34 ubuntu docker[2464]: latest: Pulling from ctlc/ambassador
Sep 08 15:53:34 ubuntu docker[2464]: 093e01545ca5: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: 639d60300768: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: 50e9f95f98f1: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: 6d021018145f: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: c33211982f7d: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: 0da04ef149d0: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: c56de9c5a0d2: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: 410000273ccc: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: 1c9abde34886: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: 53e2694bc9d6: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: a853fbf35ee2: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: cea471227545: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: cea471227545: Already exists
Sep 08 15:53:34 ubuntu docker[2464]: Digest: sha256:f1648fa46b91d757b7cdd681ff134284e9903849faab0d30f3d8179c2429340c
Sep 08 15:53:34 ubuntu docker[2464]: Status: Image is up to date for ctlc/ambassador:latest
Sep 08 15:53:34 ubuntu docker[2476]: Error response from daemon: Cannot kill container rethinkdb-proxy-28015: Container c914ebf62e08487ab381cd32330c0eaae730dd5e25d66c7477f06688b0fbc
Sep 08 15:53:34 ubuntu docker[2476]: Error: failed to kill containers: [rethinkdb-proxy-28015]
Sep 08 15:53:34 ubuntu docker[2483]: rethinkdb-proxy-28015
Sep 08 15:53:34 ubuntu systemd[1]: Started RethinkDB proxy/28015.
Sep 08 15:53:35 ubuntu docker[2490]: 2015-09-08 14:53:35,291 CRIT Supervisor running as root (no user in config file)
Sep 08 15:53:35 ubuntu docker[2490]: 2015-09-08 14:53:35,291 WARN Included extra file "/etc/supervisor/conf.d/supervisord-socat.conf" during parsing
Sep 08 15:53:35 ubuntu docker[2490]: 2015-09-08 14:53:35,327 INFO RPC interface 'supervisor' initialized
Sep 08 15:53:35 ubuntu docker[2490]: 2015-09-08 14:53:35,328 WARN cElementTree not installed, using slower XML parser for XML-RPC
Sep 08 15:53:35 ubuntu docker[2490]: 2015-09-08 14:53:35,328 CRIT Server 'unix_http_server' running without any HTTP authentication checking
Sep 08 15:53:35 ubuntu docker[2490]: 2015-09-08 14:53:35,329 INFO supervisord started with pid 1
Sep 08 15:53:36 ubuntu docker[2490]: 2015-09-08 14:53:36,332 INFO spawned: 'socat' with pid 6
Sep 08 15:53:36 ubuntu docker[2490]: 2015-09-08 14:53:36,353 INFO exited: socat (exit status 0; not expected)
Sep 08 15:53:37 ubuntu docker[2490]: 2015-09-08 14:53:37,357 INFO spawned: 'socat' with pid 12
Sep 08 15:53:37 ubuntu docker[2490]: 2015-09-08 14:53:37,367 INFO exited: socat (exit status 0; not expected)
Sep 08 15:53:37 ubuntu docker[2490]: 2015-09-08 14:53:37,370 CRIT reaped unknown pid 17)
Sep 08 15:53:39 ubuntu docker[2490]: 2015-09-08 14:53:39,375 INFO spawned: 'socat' with pid 18
Sep 08 15:53:39 ubuntu docker[2490]: 2015-09-08 14:53:39,383 INFO exited: socat (exit status 0; not expected)
Sep 08 15:53:39 ubuntu docker[2490]: 2015-09-08 14:53:39,386 CRIT reaped unknown pid 23)
Sep 08 15:53:42 ubuntu docker[2490]: 2015-09-08 14:53:42,391 INFO spawned: 'socat' with pid 24
Sep 08 15:53:42 ubuntu docker[2490]: 2015-09-08 14:53:42,404 INFO exited: socat (exit status 0; not expected)
Sep 08 15:53:42 ubuntu docker[2490]: 2015-09-08 14:53:42,406 INFO gave up: socat entered FATAL state, too many start retries too quickly
Sep 08 15:53:42 ubuntu docker[2490]: 2015-09-08 14:53:42,406 CRIT reaped unknown pid 29)
Sep 08 15:53:51 ubuntu systemd[1]: Started RethinkDB proxy/28015.
Sep 08 15:56:09 ubuntu systemd[1]: Started RethinkDB proxy/28015.
 Thanks for the reply,

I have pulled the previous version and the only difference between that and the latest is the addition of a line:

https://github.com/benjamin-m-kane/ctlc-docker-ambassador/commit/a7e01769b4c35859f8ebf606c3fa452fc8e88d9f

Any further guidance/advice would be appreciated.

Thanks.
 Well just to add, I just deployed STF today with latest ambassador image and it worked for me. 
 Impossible launche stf-app.service with rethinkdb-proxy-28015 .... When launch rethinkdb and rethinkdb-proxy-28015 works fine, but when launche stf-app.service the load average and cpu is high. socat use high cpu...

# systemctl status rethinkdb-proxy-28015.service

feb 22 19:01:22 nodito1 systemd[1]: Started RethinkDB proxy/28015.
feb 22 19:01:32 nodito1 docker[30460]: 2018/02/22 18:01:32 socat[28244] E connect(5, AF=2 172.17.0.2:28015, 16): Address not available
feb 22 19:01:55 nodito1 docker[30460]: 2018/02/22 18:01:55 socat[24009] E connect(5, AF=2 172.17.0.2:28015, 16): Address not available

From host I can telnet to ip and port works well:

@nodito1:/lib/systemd/system# telnet 172.17.0.2 28015
Trying 172.17.0.2...
Connected to 172.17.0.2.
Escape character is '^]'.

I don't understanding anything...

https://imgur.com/a/54Niw I solved change the ip 172.17.0.2 from docker to ip from host physical and works well...

I don't understand ...but works now  Would it be possible to get a little more guidance on how to deploy the Docker container for STF provided on Docker Hub? Is it as simple as entering the container and running `npm install -g stf` followed by all the usual commands for installing/building STF in a manual installation, or is there more to it?

Also, is it recommended that RethinkDB is run in a linked Docker container?
  remove redundant "keeps"
  stf is really a great repo.

It's is very hard for us to contribute translation in http://transifex.com because of `GFW`.
My colleague @Hepper99 translated the Chinese part. 
 @gunta OK, I'll have a try. Thanks for your work, really.
 May I ask how to compile `stf.zh.po` to stf.zh.json
 Closed for now, I'll create a new pr.
  I am trying to deploy stf to a single Ubuntu Server 15 VM for testing purposes, and I am having trouble launching the adbd.service.

Looking at journalctl -u adbd.service, this is what happens (on repeat) when it tries to launch:

```
Sep 04 16:04:36 ubuntu systemd[1]: Started ADB daemon.
Sep 04 16:04:36 ubuntu docker[4803]: /bin/sh: 1: /usr/local/bin/adb: not found
Sep 04 16:04:36 ubuntu systemd[1]: adbd.service: main process exited, code=exited, status=127/n/a
```

Full log, in case you're interested:

```
...
Sep 04 16:04:36 ubuntu docker[4557]: latest: Pulling from sorccu/adb
Sep 04 16:04:36 ubuntu docker[4557]: d3a1f33e8a5a: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: c22013c84729: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: d74508fb6632: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: 91e54dfb1179: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: 5dde12b72c43: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: 69b150265bc0: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: c72b51ab8d13: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: b617de8df343: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: 48254714e6a4: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: ee9c8d6bd17d: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: bd8b96efe841: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: d973d4bb6ad8: Already exists
Sep 04 16:04:36 ubuntu docker[4557]: Digest: sha256:ddccf76a7e3884bd12c58efab1d37f3db33a456d601cbb374850859e9f49b4d5
Sep 04 16:04:36 ubuntu docker[4557]: Status: Image is up to date for sorccu/adb:latest
Sep 04 16:04:36 ubuntu docker[4769]: Error response from daemon: Cannot kill container adbd: no such id: adbd
Sep 04 16:04:36 ubuntu docker[4769]: Error: failed to kill containers: [adbd]
Sep 04 16:04:36 ubuntu docker[4791]: Error response from daemon: no such id: adbd
Sep 04 16:04:36 ubuntu docker[4791]: Error: failed to remove containers: [adbd]
Sep 04 16:04:36 ubuntu systemd[1]: Started ADB daemon.
Sep 04 16:04:36 ubuntu docker[4803]: /bin/sh: 1: /usr/local/bin/adb: not found
Sep 04 16:04:36 ubuntu systemd[1]: adbd.service: main process exited, code=exited, status=127/n/a
Sep 04 16:04:37 ubuntu docker[4887]: Error response from daemon: no such id: adbd
Sep 04 16:04:37 ubuntu docker[4887]: Error: failed to stop containers: [adbd]
Sep 04 16:04:37 ubuntu systemd[1]: Unit adbd.service entered failed state.
Sep 04 16:04:37 ubuntu systemd[1]: adbd.service failed.
Sep 04 16:04:37 ubuntu systemd[1]: adbd.service holdoff time over, scheduling restart.
Sep 04 16:04:37 ubuntu systemd[1]: Starting ADB daemon...
Sep 04 16:04:39 ubuntu docker[4919]: latest: Pulling from sorccu/adb
...
```

My adbd.service file is an exact copy of the one in DEPLOYMENT.md:

```
[Unit]
Description=ADB daemon
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull sorccu/adb:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  --privileged \
  -v /dev/bus/usb:/dev/bus/usb \
  --net host \
  sorccu/adb:latest
ExecStop=-/usr/bin/docker stop -t 2 %p
```

Same thing happens when I take a look at the docker file and try to run the adbd.service command manually:

```
michael@ubuntu:~$ /usr/bin/docker run --rm \
>   --name adbd \
>   --privileged \
>   -v /dev/bus/usb:/dev/bus/usb \
>   --net host \
>   sorccu/adb:latest
/bin/sh: 1: /usr/local/bin/adb: not found
```

I tried to do it on a completely empty "boot to docker" image, and it gives the same error.
Any help would be greatly appreciated.
I am new both to systemd and docker, so please forgive me if this is an obvious problem or a rookie mistake.
  Thanks for the great sharing. I have tried to deploy it on real servers for several days,but now I meet a question, I can not take it work when I input the URL in my browser,there will nothing(Unable to connect) I think there is something wrong in the file of 'nginx.conf'.
1. I create the the file of '/srv/nginx/nginx.conf' by myself,and I have pulled the docker image of nginx:1.7.10
2. I have started all of the units active(running), I used my host's IP (10.240.154.173:7100)instead of https://stf.example.org/ in all of the units and the file 'nginx.conf'. 
3. I don't know how to create certs,so I can't use the https , I have commented some codes in the '/srv/nginx/nginx.conf' about https.
4. I have changed the code like ' server 192.168.255.100:3100 max_fails=0;'to ' server 10.240.154.173:3100 max_fails=0;'
5. It will be change to 10.240.154.173:7100 if I input 10.240.154.173:80 in  browser,it can shows the nginx.conf have worked.But why there is nothing in 10.240.154.173:7100?
6. The rest of the file '/srv/nginx/nginx.conf'is like doc/DEPLOYMENT.md .Then the nginx.service delete the code like
   ConditionPathExists=/srv/ssl/stf.example.org.crt
   ConditionPathExists=/srv/ssl/stf.example.org.key
   ConditionPathExists=/srv/ssl/dhparam.pem
   and
   -v /srv/ssl/stf.example.org.crt:/etc/nginx/ssl/cert.pem:ro \
   -v /srv/ssl/stf.example.org.key:/etc/nginx/ssl/cert.key:ro \
   -v /srv/ssl/dhparam.pem:/etc/nginx/ssl/dhparam.pem:ro \
7. Now I can see the change of RethinkDB from 'localhost:8080' if I link devices to host.

Who can tell me how to do it? Thanks.
  I want to do deployment. Which ports do I need to turn out? There are only 7100 open. I can see device list now, but I can not control remote devices. The device comes in a gray screen instead.
 Hi,unverb. I'm trying to deploy  STF to actual servers,but there is some questions when i start .service units, especially the unit configuration of nginx.service,i have pulled the docker image of nginx:1.7.10,should i have to install nginx separately?can you give me some consultation or steps? how to deploy the separate unit for RethinkDB? My email is yuan890811@163.com  Thanks.
 @sorccu Does this have an impact on the performance of the port range? How can I improve the performance? I completed the setup. But it is running slow by remote access.
 I am accessing public network. This is very slow. How to fix it? Change capture frame rate or ..?  @sorccu 
  Hi there,

Is there any way or clues on how to continue to manage devices once USB removed ?
## 

Regis A. Despres
 Hey,

Thanks for the prompt answer. I'm looking for a way to configure adb into stf in order to join device wirelessly =)

## 

Regis A. Despres
 @kawl STF recognizes devices via adb (e.g. `adb devices`) so you can try something like [adb over wifi](http://stackoverflow.com/questions/2604727/how-can-i-connect-to-android-with-adb-over-tcp) to setup your device, and then `adb connect [ip_address]` with your local device IP. 

I'm personally using [WiFi ADB - Debug Over Air](https://play.google.com/store/apps/details?id=com.ttxapps.wifiadb&hl=en).
 Thanks for the tip.

I finally get my device to be recognized.
  I start rethinkdb as default configure in new terminal with command "rethinkdb",then start the unit "rethinkdb-proxy-28015.service".

Then I start the unit "stf-app@3100.service",it can running at first,but it will  failed after a while, I have tried it like the following method.How can I deal with it?
# docker run openstf/stf:latest stf app --port 3000 --secret 123456 --auth-url 10.240.154.173:7100 --websocket-url 10.240.154.173:7100

INF/app 1 [_] Using pre-built resources
INF/app 1 [_] Listening on port 3000
INF/db 1 [_] Connecting to 127.0.0.1:28015
INF/db 1 [_] Unable to connect to 127.0.0.1:28015
FTL/db 1 [_] No hosts left to try
FTL/util:lifecycle 1 [_] Shutting down due to fatal error
 It will also failed if I start the stf-app@3100.service with the command "systemctl start stf-app@3100.service ". The question maybe the docker's IP can not link the expose port of rethinkdb if add the --link option (172.17.0.179:28015--->127.0.0.1:28015),I don't know how to deal with it. (if i don't use --link option,it will connecting to 127.0.0.1.:28015)

Then I try to start Like following:

# docker run --link rethinkdb-proxy-28015:rethinkdb -e "SECRET=123456" -p 127.0.0.1:3100:3000 openstf/stf:latest stf app --port 3000 --secret 123456 --auth-url 10.240.154.173:7100 --websocket-url 10.240.154.173:7100

INF/app 1 [_] Using pre-built resources
INF/app 1 [_] Listening on port 3000
INF/db 1 [_] Connecting to 172.17.0.179:28015
INF/db 1 [_] Unable to connect to 172.17.0.179:28015
FTL/db 1 [_] No hosts left to try
FTL/util:lifecycle 1 [_] Shutting down due to fatal error
 Try this. Start rethinkdb using --bind all

```
rethinkdb --bind all
```
 Thanks,I have tried it,but it doesn't work. Now i want to ask another question,should i have to install nginx separately in my host? I have pulled the docker image of nginx:1.7.10,Should i have to create the file of nginx.conf by myself and deploy it like https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md? how to create the file like cert.pem cert.key dhparam.pem?
 Oh,i see,thanks.
It's means that i must deploy the platform of STF by myself if i want to run it on real servers,the file https://github.com/openstf/stf/blob/master/doc/DEPLOYMENT.md just a reference. There are a lot of things I should to change or create in my way.It will not work if i deploy it just like the description of DEPLOYMENT .

thanks again, I will learn it by my best.
 thanks a lot,I'm trying ! sorry to trouble you !
  Awesome, inspiring stuff.  
# TLDR; is iOS support on your roadmap?

I've been tinkering around with a solution that works on iOS devices (or simulators).  The approach streams snapshots over websockets to a canvas and forwards user-generated mouse/keyboard events to Appium which replays them against a device.  For a stand alone solution, with a single device, it works. 

next up on the roadmap:   
- improve performance of image capture
- support multicasting of a device
- support streaming multiple concurrent devices (i.e. one per browser tab)
- polish the code (env variables and such)
- approval w/ stakeholders to release as open source

---

I understand its hard to comment on a solution you haven't seen.  Before I get too much further down this proof-of-concept, I wanted to solicit feedback **Are there any plans to support iOS in STF?**   Have you already been down this path and abandoned it?  
### proof of concept approach
#### image capture

To capture images, I've evaluated: 
-  using `libimobiledevice` which uses devloper disk image to capture on the device to achieve 5-10 fps.  Unfortunatly these are large files (3MB TIFFs), that are begging to be pre-processed into a PNG.
-  using QuickTime's screen mirroring; and screenshoting that (on the host) which allows ~25 fps, but won't scale beyond the first device.
-  forking [xrecord](https://github.com/WPO-Foundation/xrecord) to implement a QT mirroing solution that output jpegs (and would allow multiple devices) 
#### devices

Testing against a physical device is desirable however without jailbreaking the device there are some limitations (lockscreen, home button).

The iOS simulator was able to produce highest framerates, and the closest experience to what STF provides for Android, but there is a nagging feeling it's not going to scale or meet the requirements (e.g. managed in MDM, recgnoize an internal cert chain)
#### Shortcomings
-  Appium is limited to the underlying device automation implementation.  On iOS  it is [UIATarget](https://developer.apple.com/library/ios/documentation/ToolsLanguages/Reference/UIATargetClassReference/)
  -  UIATarget has an api to send the application to the background for a duration. Appium wants to launch an application on startup.  On a physical device this means there's no interacting with Home Screen, system properties without jailbreaking the device and getting creative.  For simulators, there may be a way to mimic, but would need to figure out how to support concurrent simulators.
  - perceptable lag (~1-2 seconds) on keyboard events propagating back to the device. A short (100ms) buffer for keyboard events may help, but special keys like Delete make it interesting
-  Duplication of inventory in Selenium Grid and STF.   We've got a node module that watches USB for new device connections, starts an Appium server and registeres it with a Selenium grid, but we need to federate that back into STF for discovery 
 I'm still working on this.  The code's in much better shape, and the stakeholders are listening.

Thanks for the tip on TIFF to JPG.  It shaved 100ms off the image processing.
 The effort stalled.  Stakeholders haven't said no, but they've shifted priorities.  

I'm able to sample stills from a video stream, but it's drinking from a firehose.  I was refactoring the image acquisition code to send the results back over a WebSocket (rather than diskIO), when I bumped into a hard limit of one device at a time  https://github.com/WPO-Foundation/xrecord/issues/1
 Thanks for such amazing work ;) 
 Hi ,

Can you please share your solution?
We want to test it out for iOS devices?
 If anyone has a SD solution available please share the same. We are in dire need of getting this on iOS.
 Ooppsss!... I meant iOS.. Not SD
 Dear Sorccu, you mentioned to me that you would give me the exact quote for developing the iOS Support. Can you please give me as soon as possible?

Regards
Pattabhi
 @sorccu @kwv it might be worth checking this out https://github.com/phonegap/ios-deploy and https://github.com/phonegap/ios-sim for building and deploying iOS apps to device and simulators. I know STF does not currently support iOS but it would be nice to deploy apps via the web browser. The tool also supports lldb which is useful for out putting console logs.  
 Curious to the original proposed solution that got stalled, as well as any other potential solutions. How far can you scale device support (or even simulator support)?

From what I encountered, unless I'm mistaken, just toying with Appium and physical iOS devices, there seemed to be a single device limitation per instance of XCode on Mac OS. Therefore, to reliably scale to more iOS devices (to work in parallel), one has to deploy 2 virtual machines (the max licensed amount allowed by Apple, on the physical Mac host) running Mac OS with the same XCode and Appium setup, etc. In that setup, assign a specific iOS device per VM via USB port/device allocation in the VM software, and the remaining (last) device to the physical Mac. Each instance (physical Mac, VMs) have their own XCode and Appium to control the device. So there's a max device limit of 3 iOS devices per Mac machine (using the VMs). This doesn't scale as well compared to Android, as more Mac machines would be needed to scale higher.
 this might be useful for video recording https://github.com/isonic1/flick
 @Ashraf-Ali-aa This tools about iOS recording is using capture pictures and combine them to video file. maybe not fitted for stf.
 Since stf got minicap, combine the image stream into video is a better way in my view.
 @gunta I have a question, how to know ios orientation from command line.
 facebook have implemented an extension of xcuitest that allows remote interactions with ios devices and appium has adopted the code. 

https://github.com/facebook/WebDriverAgent
https://github.com/appium/appium-xcuitest-driver

related links:
https://github.com/facebook/FBSimulatorControl
https://github.com/rsms/peertalk
 @daluu I never made it past the scaling limitation.   

I started down the path of spinning up VMs for each tethered device, but I started to recognize the difference between being a trailblazer and stumbling around in the woods.  Defining a repeatable approach was going to be challenging, let alone coming up with a solution that would fit back into STF. 

@Ashraf-Ali-aa Capturing video and sending the stream back to a browser was a problem.  @codeskyblue is right, it is easier to use images over a websocket to fake a stream.  Munging the QT frames into a websocket was next, but that required stronger opinions on the architecture.  (Does the app collecting the screen pipe directly to the browser or through a middle agent? If its direct, what supports discovery, or starts the app?)  I wanted to leverage a lot of STF's architecture decisions for this, but the approach had already diverged.

I wonder how the commercial products work, if they use an app installed on the device which functions similar to minicap.   Rather than pulling from the host machine (like the approach outlined above), push from the device itself (using private APIs?).    In the near term FBSimulatorControl looks very interesting. 

If nothing else, it just re-enforces that @sorccu and @gunta are doing amazing work.
 Hello guys! Like @kwv  i'm trying find a way to screencast the ios screen, i am currently try apply this code from @isonic1, this one https://github.com/isonic1/flick, to make a minicap for IOS. if you guys have some advise to me please tell me.
 @NareshJain91 I am dividing the problem, first i want identify the device and set it visible in stf, next i want make the screencast from ios devices! that is my main work, for now, but we want keep going until get full functionality presented in the android.
So far i am fighting to detect iphone and make screencast.Now with flick i am capable  to detect the udid for all devices and take screenshots in all ios devices. I will try this path to make a solution.
 @HelderVSousa Sure, if you need my assistance anywhere please let me know. Till now i am able to capture ScreenShots and video from iOS Devices, also i can get how many devices are connected and their UDID. But major problem i am stuck is how to give command from browser/System to iPhone, if it resolves i will be able to implement rest things, for that i have also raised the question to Developer apple forum, but most of have replied that apple do not allow it.

If you find something to give commend from mac to iOS, let me know.
Thanks
 @HelderVSousa you can use https://github.com/phonegap/ios-deploy to detect connected iOS devices
 @Ashraf-Ali-aa thanks for the tip, for now my work is fully focused on detect and  screen capture ios, my recent research and tests show me the flick can be the tool i am looking for,  i will create minicapIOS based on approach in minicap. But in future i will check it to see if i can use to control the ios.
 @HelderVSousa I came across this tool https://github.com/sanekgusev/SGASScreenRecorder but it seems it does not work for iOS 9. 

https://github.com/gabriel/CaptureRecord

https://github.com/JaviSoto/iOS10-Runtime-Headers/blob/master/Frameworks/MediaToolbox.framework/FigScreenCaptureController.h
 @HelderVSousa check this out https://www.macstories.net/ios/vidyo-a-screen-recorder-for-ios/

https://github.com/johnno1962/Remote
 Hello people i have made some progress however this is not working like i want, now i am using libimobiledivice api to take screenshots and pass that screenshots over socket's to browser, but unfortunately i only can get 4 a 5 frames a second, that is not perfect but is a start, if someone know a lib that take screenshots faster than libimobiledevice, pls share to see what i can make improvements.
 @HelderVSousa with https://github.com/WPO-Foundation/xrecord higher FPS is possible, but it's using QuickTime as a bridge.     
 @HelderVSousa I found out that use idevicescreenshot(tools from libimobiledevice) take 0.7s, how did you make 4,5 fps.

Actually 4,5 fps is enough for the remote control. Touch swipe... basic operations can use https://github.com/facebook/WebDriverAgent (this is so far I know.)
 So, its possible get this WebDriverAgent and integrate with STF?
 Should we use libimobiledivice api or WebDriverAgent to take screenshots and pass it to browser?
or do we have another better solution, please share.
 Thanks very much for quick respond. 
If so, we should use QuickTime ("https://github.com/WPO-Foundation/xrecord") or libimobiledivice api (HelderVSousa's comment, 4 a 5 frames a second), right ? 
I'm still seeking a best solution for iOS. If you have any idea, please share.
 AirPlay is another way. very quickly, just do not known how to do it.
 I want to share a working prototype https://github.com/nwlunatic/ios-minicap.
Any futher ideas/issues/pull requests are welcome.
 looks like the only missing stuff is ios-minitouch
 Well, I hope someone also will come up with some server/client solution for macOS to solve remote usb connection problem. Like [usbip](http://usbip.sourceforge.net/), or any [other solutions for remote accesing usb](http://www.eltima.com/products/usb-over-network-mac/). Or i've missed something? ) This will probably require to write some kind of virtual usb device and kext. And solve a lot of other possible usb problems )
 does this work with more then one device per host?
 I tested multiple devices, it seems not working. It just kept showing usage text whenever I plug 2 iOS devices. One device is good so far. I see that we use CoreMediaIO to enable DAL. That may not work with multiple devices.
 For ios-minitouch, Is it possible with IOKit framework?
 or should we use UIKit.framework ? 
refer to "https://github.com/johnno1962/Remote/blob/master/Classes/RemoteCapture.h"
--> (void)processEvents
 We need to send touch events from Mac OS to USB connected iOS devices.
"http://stackoverflow.com/questions/35339953/send-touch-events-from-mac-osx-application-to-usb-connected-iphone" confirmed that they implemented this feature in their VNC Server but can't share the source code :)
 On iOS6 & 7, can use IOHIDEvents (IOKit.Framework) to send touches/swipes/buttons from MAC OS to iOS devices. Not sure if IOHIDEvents (IOKit.Framework) is still supported on iOS 10.
 Could we not use appium/WebDriverAgent to send the touch events commands to the device since it was designed to run automation tests 
 @sorccu I am not sure if that is true these days, especially with the release of this library from Facebook: https://github.com/facebook/WebDriverAgent We also use it internally, but have found it to be quite snappy and stable. Are you pushing events over Wifi or USB?  I suffered the same problem. Can't wait to see that WDA was improved. @tk8817 Please notice that it's about the touch and key. For the rest, WDA works well to me. Hi. You're doing great job guys! Now for iOS, besides screen capturing there are other problems to solve, like **app deployment (install/uninstall)** on the device, right? Do anyone of you guys have a solution for that? 

With Android the OpenSTF is so convenient with the instant drag and drop feature, how would this look like in case of iOS? Since xcode isn't really an option for device farms, I've tried libraries like **libimobiledevice, fastlane, cfgutil, SSH+ipainstaller** etc, with partial success only. In the other hand, Cydia Impactor's drag-n-drop interface is quite comfy, takes care of resigning and all, it cannot be automatized for larger-scale usage. Do any of you guys have experience on this? I'm happy to contribute in this btw. @apprayadmin check out https://github.com/phonegap/ios-sim and https://github.com/phonegap/ios-deploy this would be useful for ios minicap https://github.com/andrealufino/Luminous It looks like someone has figured out how to do it the STF way with ios devices ... https://kobiton.com/ @sorccu any updates on this ? Sorry for these douchebags, we love to use openstf at my workplace and we really respect your work.

https://www.engadget.com/2014/04/14/why-9-41-am-is-the-always-the-time-displayed-on-iphones-and-ipad/ I spend some time looking at how you could implement minitouch in recent iOS versions. The gist of it is: you can't, but I think you can get close.

VNC servers on iOS 5 and below use IOHIDEvents but that route is now closed for iOS apps.

The only way that I know of to inject touch events in an iOS device is via Xcode UI Test, the same framework the Facebook WebDriverAgent and Appium build upon.

Any XCUITest application interacts with a service call `testmanagerd` which does use IOHIDEvents to synthesize touches.

The communication between the XCUITest and `testmanagerd` (and eventualy IOHIDEvents) runs via the [`XCTestManager_ManagerInterface `](https://bootstraponline.github.io/xcuitest/Xcode_7.2_(7C68)/private_docs/html/Protocols/XCTestManager_ManagerInterface.html) interface.

You can send touch events via the `_XCT_performTouchGesture` method.

There are limitations, though. You are required to send the _entire_ gesture (from touch down to touch up) before it is performed. That means you can't implement a real-time touch mirroring protocol on top of it. For example, for a long touch or a swipe operation, you would first need to let the user perform the swipe before you can replay the swipe. Some UI clients solve this problem by "drawing" the gesture on the screen before it is replayed; but there will always be a lag.

That said, `_XCT_performTouchGesture` executes nearly instantly; there are definitive no second-long delays. I think the delays @sorccu has seen in WDA stem from the fact that WDA contains a lot of synchronisation points where WDA will wait for, for example, transitions and animations to stop before executing any operation.

Long story short, if you can get creative and can account for the fact that you can only replay a gesture on the device after the user has performed the entire gesture, you can use WDA to build a fairly decent remote control solution on top of it. Hello everyone! Any news about iOS support? iOS 11 introduced screenshare option. Maybe this'll help. @sorccu nobody including your team? I suppose this has least priority than ability to connect emulated devices to stf. That's bad. I can't find any solutions to create own iOS-device farm. @sorccu I'm just asking, no offence. You already made very powerful tool, no doubt. I know that I'm in no position to demand something from opensource project. About funding - I thought that you have some sponsorship from Headspin. 
 About priorities - It was a question about feature roadmap. @glolsh if you scroll up a few messages you'll see someone recommended http://kobiton.com - I've heard they provide on-prem android and ios device farm options as well, it's not free though. Wish I could figure out how they did fluent screen capturing with iPhones... :)   @sorccu hi, if you come up with business model, plans and roadmap, i'm pretty sure you'll have more contribution than just a few bug ticket posters. Many of open source software succeeded that way, and your tool is awesome, why not making it even better? :)  @apprayadmin thank you! Also I agree with you about "plans". If I (and other people too, I think) would be sure that this functionality is going to be implemented, I would donate some money.
upd: these guys in kobition allow only testing and autotesting, no way to develop there. Agree with glolsh. I think this certainly deserve funding. I will talk to my organization about this. Team, 
I just want to give one heads up here. Currently I am using Macaca App inspector for object identification in IOS. The XCTestWD agent installed in the device can emulate real device screen, right now atleast we can give an option in OpenSTF to show the connected device screen. But the problem is we cannot control the device, if we have that device control option it will be great for us to continue in IOS also in Open STF. Just check through, and it may be helpful for us.

Regarding Funding,
Will talk to my Company also. Lets rock this.  @rdhandapani88 this method has been talked before metioned as WDA here is an interesting project https://github.com/kishikawakatsumi/ScreenRecorder Looks like it can be used for showing display, not for controlling it. https://github.com/manishPatwari/WebDriverAgent We have tried to improve upon the WebDriverAgent provided by Facebook.

**Enhancements:**
- We have created a node server which would be able to connect to several web and device clients through web sockets.
- Web sockets in mobile clients have introduced two way communication and improved the speed significantly
- The screenshots of the devices are being casted in the background thread from mobile clients for optimisation towards unblocking of the actions
- Added the functionality of supporting multiple devices (both simulator and real ones) with a lock enabled when a device is being used

_NOTE_: This is a POC from our side and still requires more work. You would be more than welcome to contribute towards making this even better.

Special thanks to @shubhankaryash for contributing in this @manishPatwari 

Great work! Very impressive the performance improvements that you made upon the Facebook's WebDriverAgent.  can u provide some gif videos? recommended using LiceCap @codeskyblue We have recorded the video : https://www.youtube.com/watch?v=bGJAKXdfrgM  @manishPatwari 
Just Awesome! Thank you so much! I was able to launch on some Simulator but not able on real ones.
I got no device connected with real ones even the build and test OK.

> If there is no devices, run the WebDriverAgentRunner testRunnerSocket
Could you possibly tell a little more about this?

I'm sorry for asking here because there is no place on the forked project to ask about that! @manishPatwari
The root cause (as I saw from the log) is the socket is not connected for the real ones but not sure which one triggered that... @manishPatwari allow Issue creation on your repo please. @TuHuynhVan You have to update the Socket path in this file : https://github.com/manishPatwari/WebDriverAgent/blob/master/WebDriverAgentLib/Routing/FBWebSocket.m  ,

Replace "localhost" with the ip address where Node server is running. @glolsh I have enabled issue creation and also created reference issue in my repo .
https://github.com/manishPatwari/WebDriverAgent/issues/1  @sorccu we were trying to do so:) Team,
Entire World is waiting for this precious solution for iOS with OpenSTF. STF team can consider manishPatwari's webdriver agent implementation of mirroring and accessing connected IOs devices. I know you guys are busy with other stuff's. But to make openSTF more power ful with IOs, we all should be united. Team need to tell, what they want actually ? what is blocking. Regards.  I installed requirements and STF (npm install -g stf). But I could not run properly. I created the folder as  says in error, but did not work.

Operating System -> Ubuntu 14.04.2
Node.js Version    -> v0.12.4
STF Version          -> v1.0.9

Start Rethinkdb 

```
rethinkdb --port 8081 --bind all
```

Start STF          

```
stf local --public-ip 192.168.1.5
```

Error message 

```
FTL/device 9730 [1C1D67034F9D] Setup had an error Error: At least one of these paths should exist: /usr/local/lib/node_modules/stf/vendor/minicap/bin/armeabi/minicap-nopie
    at Object.module.exports.requiredMatch (/usr/local/lib/node_modules/stf/lib/util/pathutil.js:33:9)
    at /usr/local/lib/node_modules/stf/lib/units/device/resources/minicap.js:21:23
    at SerialSyrup.ParallelSyrup.invoke (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /usr/local/lib/node_modules/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at tryCatch1 (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/util.js:63:19)
    at Promise$_callHandler [as _callHandler] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:708:13)
    at Promise$_settlePromiseFromHandler [as _settlePromiseFromHandler] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:724:18)
    at Promise$_settlePromiseAt [as _settlePromiseAt] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:896:14)
    at Promise$_fulfillPromises [as _fulfillPromises] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/promise.js:1041:14)
    at Async$_consumeFunctionBuffer [as _consumeFunctionBuffer] (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/async.js:74:12)
    at Async$consumeFunctionBuffer (/usr/local/lib/node_modules/stf/node_modules/stf-syrup/node_modules/bluebird/js/main/async.js:37:14)
    at process._tickCallback (node.js:355:11)
FTL/util:lifecycle 19327 [1C1D67034F9D] Shutting down due to fatal error
INF/provider 19102 [*] Cleaning up device worker "1C1D67034F9D"
ERR/provider 19102 [*] Device worker "1C1D67034F9D" died with code 1
INF/provider 19102 [*] Restarting device worker "1C1D67034F9D"
```
 The output of this command to empty all devices.

Command 

```
 adb -s [SERIAL] shell getprop | grep '^ro\.'
```

No problem when I tried the same devices with OSX.
 You are right @sorccu. There was a problem with the device. How do I exclude by using the serial number?
 I have an old HTC Wildfire here which is also not supported.
The output of `adb devices -l` is:
`SH18KTR25629 device usb:338690048X`
  Some questions generate when i start units.who can give me some suggestion to deal with it?
1.start the rethinkdb-proxy-28015.service unit,there is some problems like "/usr/bin/docker rm %p (code=exited, status=1/FAILURE)"
check status with the command "systemctl status rethinkdb-proxy-28015.service -l",then i can see

● rethinkdb-proxy-28015.service - RethinkDB proxy/28015
   Loaded: loaded (/etc/systemd/system/rethinkdb-proxy-28015.service; static; vendor preset: enabled)
   Active: active (running) since 一 2015-08-24 16:43:01 CST; 7min ago
  Process: 7911 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 7903 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)

2.start the adbd.service unit(other units have the same questions)
check status with the command "systemctl status adbd.service -l",then i can see

 adbd.service - ADB daemon
   Loaded: loaded (/etc/systemd/system/adbd.service; static; vendor preset: enabled)
   Active: active (running) since 一 2015-08-24 17:09:51 CST; 2s ago
  Process: 15532 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 15527 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
  Process: 15401 ExecStartPre=/usr/bin/docker pull sorccu/adb:latest (code=exited, status=0/SUCCESS)
 Main PID: 15539 (docker)
   Memory: 1.7M
   CGroup: /system.slice/adbd.service
           └─15539 /usr/bin/docker run --rm --name adbd --privileged -v /dev/bus/usb:/dev/bus/usb --net host sorccu/adb:latest

 8月 24 17:09:32 OMTL docker[15401]: Pulling repository docker.io/sorccu/adb
 8月 24 17:09:35 OMTL docker[15401]: 37b4eb7ce7a3: Layer already being pulled by another client. Waiting.
 8月 24 17:09:51 OMTL docker[15401]: 37b4eb7ce7a3: Download complete
 8月 24 17:09:51 OMTL docker[15401]: Status: Image is up to date for sorccu/adb:latest
 8月 24 17:09:51 OMTL docker[15527]: Error response from daemon: Cannot kill container adbd: no such id: adbd
 8月 24 17:09:51 OMTL docker[15527]: Error: failed to kill containers: [adbd]
 8月 24 17:09:51 OMTL docker[15532]: Error response from daemon: no such id: adbd
 8月 24 17:09:51 OMTL docker[15532]: Error: failed to remove containers: [adbd]
 8月 24 17:09:51 OMTL systemd[1]: Started ADB daemon.
 8月 24 17:09:52 OMTL docker[15539]: OK

3.start the nginx.service unit(other units have the same questions)

 root@OMTL-STF:/etc# systemctl status nginx
● nginx.service - STF nginx public load balancer
   Loaded: loaded (/etc/systemd/system/nginx.service; static; vendor preset: enabled)
   Active: failed (Result: start-limit) since 一 2015-08-24 17:27:02 CST; 4s ago
  Process: 31651 ExecStop=/usr/bin/docker stop -t 2 %p (code=exited, status=1/FAILURE)
  Process: 31638 ExecStart=/usr/bin/docker run --rm --name %p --net host -v /home/yuancc/ssl.crt:/etc/nginx/ssl/ssl.crt:ro -v /home/yuancc/ssl.key:/etc/nginx/ssl/ssl.key:ro -v /home/yuancc/ssl.pfx:/etc/nginx/ssl/ssl.pfx:ro -v /etc/nginx/nginx.conf:/etc/nginx/nginx.conf:ro nginx:1.7.10 nginx (code=exited, status=1/FAILURE)
  Process: 31632 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 31625 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
  Process: 31692 ExecStartPre=/usr/bin/docker pull nginx:1.7.10 (code=exited, status=1/FAILURE)
 Main PID: 31638 (code=exited, status=1/FAILURE)

 8月 24 17:27:02 OMTL-STF systemd[1]: Failed to start STF nginx public load balancer.
 8月 24 17:27:02 OMTL-STF systemd[1]: Unit nginx.service entered failed state.
 8月 24 17:27:02 OMTL-STF systemd[1]: nginx.service failed.
 8月 24 17:27:02 OMTL-STF systemd[1]: nginx.service holdoff time over, scheduling restart.
 8月 24 17:27:02 OMTL-STF systemd[1]: start request repeated too quickly for nginx.service
 8月 24 17:27:02 OMTL-STF systemd[1]: Failed to start STF nginx public load balancer.
 8月 24 17:27:02 OMTL-STF systemd[1]: Unit nginx.service entered failed state.
 8月 24 17:27:02 OMTL-STF systemd[1]: nginx.service failed.
 I am having some problem in running stf-app@.service, stf-migrate.service, stf-reaper.service


status of services..
●  stf-websocket@3600.service - STF websocket
   Loaded: loaded (/etc/systemd/system/stf-websocket@.service; static; vendor preset: enabled)
  Drop-In: /etc/systemd/system/stf-websocket@.service.d
           └─override.conf
   Active: inactive (dead)

Jul 04 16:01:52 linux-rahul docker[30612]: FTL/db 1 [*] No hosts left to try
Jul 04 16:01:52 linux-rahul docker[30612]: FTL/util:lifecycle 1 [*] Shutting down due to fatal error
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Main process exited, code=exited, status=1/FAILURE
Jul 04 16:01:52 linux-rahul docker[30766]: Error response from daemon: No such container: stf-websocket-3600
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Control process exited, code=exited status=1
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Unit entered failed state.
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Failed with result 'exit-code'.
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Service hold-off time over, scheduling restart.
Jul 04 16:01:52 linux-rahul systemd[1]: stf-websocket@3600.service: Stop job pending for unit, delaying automatic rest
Jul 04 16:01:52 linux-rahul systemd[1]: Stopped STF websocket.
lines 1-16/16 (END)

● stf-reaper.service - STF reaper
   Loaded: loaded (/etc/systemd/system/stf-reaper.service; static; vendor preset: enabled)
  Drop-In: /etc/systemd/system/stf-reaper.service.d
           └─override.conf
   Active: failed (Result: exit-code) since Tue 2017-07-04 16:08:18 IST; 3s ago
  Process: 31367 ExecStop=/usr/bin/docker stop -t 10 %p (code=exited, status=0/SUCCESS)
  Process: 31348 ExecStop=/usr/bin/docker stop -t 10 %p (code=exited, status=0/SUCCESS)
  Process: 31200 ExecStart=/usr/bin/docker run --rm --name %p --link rethinkdb-proxy-28015:rethinkdb openstf/stf:lates
  Process: 31192 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 31183 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
  Process: 31174 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/SUCCESS)
  Process: 31166 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 31158 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
  Process: 31151 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/SUCCESS)
 Main PID: 31200 (code=exited, status=1/FAILURE)

Jul 04 16:08:17 linux-rahul docker[31200]: INF/db 1 [dev] Unable to connect to 172.17.0.7:28015
Jul 04 16:08:17 linux-rahul docker[31200]: FTL/db 1 [dev] No hosts left to try
Jul 04 16:08:17 linux-rahul docker[31200]: FTL/util:lifecycle 1 [dev] Shutting down due to fatal error
Jul 04 16:08:18 linux-rahul systemd[1]: Stopping STF reaper...
Jul 04 16:08:18 linux-rahul docker[31348]: stf-reaper
Jul 04 16:08:18 linux-rahul docker[31367]: stf-reaper
Jul 04 16:08:18 linux-rahul systemd[1]: stf-reaper.service: Main process exited, code=exited, status=1/FAILURE

● stf-app@3100.service - STF app
   Loaded: loaded (/etc/systemd/system/stf-app@.service; static; vendor preset: enabled)
  Drop-In: /etc/systemd/system/stf-app@.service.d
           └─override.conf
   Active: inactive (dead)

Jul 04 15:44:13 linux-rahul docker[29378]: INF/app 1 [*] Using pre-built resources
Jul 04 15:44:13 linux-rahul docker[29378]: INF/app 1 [*] Listening on port 3000
Jul 04 15:44:13 linux-rahul docker[29378]: INF/db 1 [*] Connecting to 172.17.0.7:28015
Jul 04 15:44:14 linux-rahul docker[29378]: INF/db 1 [*] Unable to connect to 172.17.0.7:28015
Jul 04 15:44:14 linux-rahul docker[29378]: FTL/db 1 [*] No hosts left to try
Jul 04 15:44:14 linux-rahul docker[29378]: FTL/util:lifecycle 1 [*] Shutting down due to fatal error
Jul 04 15:44:14 linux-rahul systemd[1]: Stopping STF app...
Jul 04 15:44:14 linux-rahul docker[29536]: stf-app-3100
Jul 04 15:44:14 linux-rahul docker[29552]: stf-app-3100
Jul 04 15:44:14 linux-rahul systemd[1]: Stopped STF app.


my other services that are needed for these service to work are running

CONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS              PORTS                                                                        NAMES
6f473dd263b7        openstf/ambassador:latest   "/run.sh"                33 minutes ago      Up 33 minutes       0.0.0.0:32769->28015/tcp                                                     rethinkdb-proxy-28015
162a96d3b7b2        openstf/stf:latest          "stf auth-mock --port"   48 minutes ago      Up 48 minutes       0.0.0.0:3200->3000/tcp                                                       stf-auth-3200
f5f11e62a352        rethinkdb:2.3.5             "rethinkdb --bind all"   2 hours ago         Up 2 hours          0.0.0.0:8080->8080/tcp, 0.0.0.0:28015->28015/tcp, 0.0.0.0:29015->29015/tcp   rethinkdb
cab4b8344e50        openstf/stf:latest          "stf triproxy dev --b"   2 hours ago         Up 2 hours                                                                                       stf-triproxy-dev
0bcda7b6a11f        openstf/stf:latest          "stf triproxy app --b"   2 hours ago         Up 2 hours                                                                                       stf-triproxy-app
e62202bbfe23        openstf/stf:latest          "stf storage-plugin-i"   2 hours ago         Up 2 hours          0.0.0.0:3500->3000/tcp                                                       stf-storage-temp-3500
ac9926857cc6        openstf/stf:latest          "stf storage-plugin-i"   2 hours ago         Up 2 hours          0.0.0.0:3400->3000/tcp                                                       stf-storage-plugin-image-3400
1a95bacdeefb        openstf/stf:latest          "stf storage-plugin-a"   2 hours ago         Up 2 hours          0.0.0.0:3300->3000/tcp                                                       stf-storage-plugin-apk-3300
d7ac389ce7f6        openstf/stf:latest          "stf provider --name "   2 hours ago         Up 2 hours                                                                                       stf-provider-floor8
877bde7a6f16        openstf/stf:latest          "stf provider --name "   2 hours ago         Up 2 hours                                                                                       stf-provider-floor4
1a2441bcf8a9        sorccu/adb:latest           "/sbin/tini -- adb -a"   2 hours ago         Up 2 hours                                                                                       adbd


I am not able to figure out what is the problem here, please guide. Thanks in advance


 @vbanthia  sorry to bother you once again.

here are my rethinkdb  and rethinkdb-proxy-28015 service that is actively running 
● rethinkdb.service - RethinkDB
   Loaded: loaded (/etc/systemd/system/rethinkdb.service; static; vendor preset: enabl
  Drop-In: /etc/systemd/system/rethinkdb.service.d
           └─override.conf
   Active: active (running) since Wed 2017-07-05 11:22:27 IST; 6h ago
 Main PID: 20411 (docker)
    Tasks: 7
   Memory: 4.3M
      CPU: 83ms
   CGroup: /system.slice/rethinkdb.service
           └─20411 /usr/bin/docker run --rm --name rethinkdb -v /srv/rethinkdb:/data -

Jul 05 11:22:29 linux-rahul docker[20411]: Running on Linux 4.4.0-81-generic x86_64
Jul 05 11:22:29 linux-rahul docker[20411]: Loading data from directory /data/rethinkdb
Jul 05 11:22:29 linux-rahul docker[20411]: warn: Cache size is larger than available m
Jul 05 11:22:29 linux-rahul docker[20411]: Listening for intracluster connections on p
Jul 05 11:22:29 linux-rahul docker[20411]: Listening for client driver connections on 
Jul 05 11:22:29 linux-rahul docker[20411]: Listening for administrative HTTP connectio
Jul 05 11:22:34 linux-rahul docker[20411]: Listening on cluster addresses: 127.0.0.1, 
Jul 05 11:22:35 linux-rahul docker[20411]: Listening on driver addresses: 127.0.0.1, 1
Jul 05 11:22:35 linux-rahul docker[20411]: Listening on http addresses: 127.0.0.1, 172
Jul 05 11:22:35 linux-rahul docker[20411]: Server ready, "090e939c8a09_xbn" f1a073ee-e
lines 1-22/22 (END)


● rethinkdb-proxy-28015.service - RethinkDB proxy/28015
   Loaded: loaded (/etc/systemd/system/rethinkdb-proxy-28015.service; static; vendor p
  Drop-In: /etc/systemd/system/rethinkdb-proxy-28015.service.d
           └─override.conf
   Active: active (running) since Wed 2017-07-05 12:20:16 IST; 5h 14min ago
  Process: 22941 ExecStop=/usr/bin/docker stop -t 10 %p (code=exited, status=1/FAILURE
  Process: 22929 ExecStop=/usr/bin/docker stop -t 10 %p (code=exited, status=1/FAILURE
  Process: 23019 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 23011 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
  Process: 23001 ExecStartPre=/usr/bin/docker pull openstf/ambassador:latest (code=exi
  Process: 22992 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 22984 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
  Process: 22964 ExecStartPre=/usr/bin/docker pull openstf/ambassador:latest (code=exi
 Main PID: 23028 (docker)
    Tasks: 7
   Memory: 4.0M
      CPU: 66ms
   CGroup: /system.slice/rethinkdb-proxy-28015.service
           └─23028 /usr/bin/docker run --rm --name rethinkdb-proxy-28015 -e AUTHKEY= -

Jul 05 12:20:16 linux-rahul docker[23001]: a3ed95caeb02: Already exists
Jul 05 12:20:16 linux-rahul docker[23001]: 2574e0aab087: Already exists
Jul 05 12:20:16 linux-rahul docker[23001]: bdb8e229719e: Already exists

and my config file is
1. rethinkdb.service
[Unit]
Description=RethinkDB
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull rethinkdb:2.3.5
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStartPre=/usr/bin/chattr -R +C /srv/rethinkdb
ExecStart=
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -v /srv/rethinkdb:/data \
  -e "AUTHKEY=" \
  -p 8080:8080 \
  -p 28015:28015 \
  -p 29015:29015 \
  rethinkdb:2.3.5 \
  rethinkdb --bind all --canonical-address 192.168.104.183 \
    --cache-size 8192
ExecStop=-/usr/bin/docker stop -t 10 %p


2. rethinkdb-proxy-28015.service

[Unit]
Description=RethinkDB proxy/28015
After=docker.service rethinkdb.service
Requires=docker.service

[Service]
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/ambassador:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -e "AUTHKEY=" \
  -p 28015 \
  -e RETHINKDB_PORT_28015_TCP=tcp://rethinkdb.stf.example.org:28015 \
  openstf/ambassador:latest
ExecStop=-/usr/bin/docker stop -t 10 %p


I have removed the environment variable as I haven't set the authorisation key for rethinkdb as suggested by @sorccu in #56 
and also I am able to open web UI at 192.186.104.183:8080
but still the error in stf-app@3100.service occur which require rethinkdb-proxy-28015.service, please help.Thanks in advance!

 
here is the status of stf-app@3100.service
● stf-app@3100.service - STF app
   Loaded: loaded (/etc/systemd/system/stf-app@.service; static; vendor preset: enabled)
  Drop-In: /etc/systemd/system/stf-app@.service.d
           └─override.conf
   Active: failed (Result: exit-code) since Wed 2017-07-05 17:45:47 IST; 15s ago
  Process: 27129 ExecStop=/usr/bin/docker stop -t 10 %p-%i (code=exited, status=0/SUCCESS)
  Process: 27110 ExecStop=/usr/bin/docker stop -t 10 %p-%i (code=exited, status=0/SUCCESS)
  Process: 26950 ExecStart=/usr/bin/docker run --rm --name %p-%i --link rethinkdb-proxy-28015
  Process: 26941 ExecStartPre=/usr/bin/docker rm %p-%i (code=exited, status=1/FAILURE)
  Process: 26932 ExecStartPre=/usr/bin/docker kill %p-%i (code=exited, status=1/FAILURE)
  Process: 26923 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/
  Process: 26915 ExecStartPre=/usr/bin/docker rm %p-%i (code=exited, status=1/FAILURE)
  Process: 26907 ExecStartPre=/usr/bin/docker kill %p-%i (code=exited, status=1/FAILURE)
  Process: 26897 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/
 Main PID: 26950 (code=exited, status=1/FAILURE)

Jul 05 17:45:46 linux-rahul docker[26950]: INF/db 1 [*] Unable to connect to 172.17.0.3:28015
Jul 05 17:45:46 linux-rahul docker[26950]: FTL/db 1 [*] No hosts left to try
Jul 05 17:45:46 linux-rahul docker[26950]: FTL/util:lifecycle 1 [*] Shutting down due to fata
Jul 05 17:45:47 linux-rahul systemd[1]: Stopping STF app...
Jul 05 17:45:47 linux-rahul docker[27110]: stf-app-3100
Jul 05 17:45:47 linux-rahul docker[27129]: stf-app-3100
Jul 05 17:45:47 linux-rahul systemd[1]: stf-app@3100.service: Main process exited, code=exite
lines 1-23

 where?  in rethinkdb-proxy-28015 unit ?? 

yes it is the exact line  sorry to bother you again and again.
after replacing the rethinkdb.stf.example.org in rethinkdb-proxy-28015 unit with  an address of rethinkdb server and then running the stf-app@3100.service unit I got the following error

● stf-app@3100.service - STF app
   Loaded: loaded (/etc/systemd/system/stf-app@.service; static; vendor preset: enabled)
  Drop-In: /etc/systemd/system/stf-app@.service.d
           └─override.conf
   Active: activating (start-pre) since Wed 2017-07-05 18:34:45 IST; 6s ago
  Process: 30472 ExecStop=/usr/bin/docker stop -t 10 %p-%i (code=exited, status=1/FAILURE)
  Process: 30465 ExecStop=/usr/bin/docker stop -t 10 %p-%i (code=exited, status=1/FAILURE)
  Process: 30346 ExecStart=/usr/bin/docker run --rm --name %p-%i --link rethinkdb-proxy-28015:rethinkdb -e SECRET= -p %i:3000 openstf/stf:lates
  Process: 30338 ExecStartPre=/usr/bin/docker rm %p-%i (code=exited, status=1/FAILURE)
  Process: 30510 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/SUCCESS)
  Process: 30501 ExecStartPre=/usr/bin/docker rm %p-%i (code=exited, status=1/FAILURE)
  Process: 30493 ExecStartPre=/usr/bin/docker kill %p-%i (code=exited, status=1/FAILURE)
  Process: 30483 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/SUCCESS)
 Main PID: 30346 (code=exited, status=1/FAILURE);         : 30518 (docker)
   CGroup: /system.slice/system-stf\x2dapp.slice/stf-app@3100.service
           └─control
             └─30518 /usr/bin/docker kill stf-app-3100

Jul 05 18:34:45 linux-rahul systemd[1]: Starting STF app...
Jul 05 18:34:49 linux-rahul docker[30483]: latest: Pulling from openstf/stf
Jul 05 18:34:49 linux-rahul docker[30483]: Digest: sha256:2a81ec596c46e979cb4663e80c063ae76f3207c50ad704ed3946793c496bfa5d
Jul 05 18:34:49 linux-rahul docker[30483]: Status: Image is up to date for openstf/stf:latest
Jul 05 18:34:49 linux-rahul docker[30493]: Error response from daemon: Cannot kill container stf-app-3100: No such container: stf-app-3100
Jul 05 18:34:49 linux-rahul docker[30501]: Error response from daemon: No such container: stf-app-3100
Jul 05 18:34:52 linux-rahul docker[30510]: latest: Pulling from openstf/stf
Jul 05 18:34:52 linux-rahul docker[30510]: Digest: sha256:2a81ec596c46e979cb4663e80c063ae76f3207c50ad704ed3946793c496bfa5d
Jul 05 18:34:52 linux-rahul docker[30510]: Status: Image is up to date for openstf/stf:latest


here is the unit file config of rethinkdb-proxy-28015.service

[Unit]
Description=RethinkDB proxy/28015
After=docker.service rethinkdb.service
Requires=docker.service

[Service]
TimeoutStartSec=0
Restart=always
ExecStartPre=/usr/bin/docker pull openstf/ambassador:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  -e "AUTHKEY=" \
  -p 28015 \
  -e RETHINKDB_PORT_28015_TCP=tcp://192.168.104.183:28015 \
  openstf/ambassador:latest
ExecStop=-/usr/bin/docker stop -t 10 %p
 once again I am sorry to bother. 
As suggested by @sorccu  I have replaced the domain name stf.example.org by the actual IP address and my rethinkdb and rethinkdb-proxy-28015 are working fine and even stf-app@3100 and stf-websocket@.service are actively running. Now only one service is left that is stf-migrate.service which is not working correctly and getting failed. 

Here is the status of the stf-migrate.service
```
● stf-migrate.service - STF migrate
   Loaded: loaded (/etc/systemd/system/stf-migrate.service; static; vendor preset: enabled)
  Drop-In: /etc/systemd/system/stf-migrate.service.d
           └─override.conf
   Active: failed (Result: exit-code) since Thu 2017-07-06 15:53:11 IST; 2h 2min ago
 Main PID: 3449 (code=exited, status=1/FAILURE)

Jul 06 15:53:07 linux-rahul docker[3432]: Error response from daemon: Cannot kill container stf-migrate: No such container: stf-migrate
Jul 06 15:53:07 linux-rahul docker[3441]: Error response from daemon: No such container: stf-migrate
Jul 06 15:53:10 linux-rahul docker[3449]: INF/db 1 [*] Connecting to 172.17.0.3:28015
Jul 06 15:53:10 linux-rahul docker[3449]: INF/db 1 [*] Unable to connect to 172.17.0.3:28015
Jul 06 15:53:10 linux-rahul docker[3449]: FTL/db 1 [*] No hosts left to try
Jul 06 15:53:10 linux-rahul docker[3449]: FTL/util:lifecycle 1 [*] Shutting down due to fatal error
Jul 06 15:53:11 linux-rahul systemd[1]: stf-migrate.service: Main process exited, code=exited, status=1/FAILURE
Jul 06 15:53:11 linux-rahul systemd[1]: Failed to start STF migrate.
Jul 06 15:53:11 linux-rahul systemd[1]: stf-migrate.service: Unit entered failed state.
Jul 06 15:53:11 linux-rahul systemd[1]: stf-migrate.service: Failed with result 'exit-code'.
```

and here is the unit file config of stf-migrate 

[Unit]
Description=STF migrate
After=rethinkdb-proxy-28015.service
BindsTo=rethinkdb-proxy-28015.service

[Service]
Type=oneshot
ExecStartPre=/usr/bin/docker pull openstf/stf:latest
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStart=/usr/bin/docker run --rm \
  --name %p \
  --link rethinkdb-proxy-28015:rethinkdb \
  openstf/stf:latest \
  stf migrate

since it depends on rethinkdb-proxy-28015.service and which is working fine, could not figure out why it is getting failed. Please guide. Thanks in advance  hi：
i am interested in your program，and try to build the progrom，i follow the stuep，and install these dependencies，but an last i meet a problem，the tips is that：
jcdeMacBook-Pro:zeromq-4.1.2 jc$ sudo npm install -g stf
Password:

> utf-8-validate@1.1.0 install /usr/local/lib/node_modules/stf/node_modules/ws/node_modules/utf-8-validate
> node-gyp rebuild

/usr/local/lib/node_modules/npm/bin/node-gyp-bin/node-gyp: line 3: node: command not found

> bufferutil@1.1.0 install /usr/local/lib/node_modules/stf/node_modules/ws/node_modules/bufferutil
> node-gyp rebuild

/usr/local/lib/node_modules/npm/bin/node-gyp-bin/node-gyp: line 3: node: command not found
npm WARN optional dep failed, continuing utf-8-validate@1.1.0
npm WARN optional dep failed, continuing bufferutil@1.1.0

> dtrace-provider@0.5.0 install /usr/local/lib/node_modules/stf/node_modules/ldapjs/node_modules/dtrace-provider
> node scripts/install.js

sh: node: command not found
npm WARN optional dep failed, continuing dtrace-provider@0.5.0

> zmq@2.12.0 install /usr/local/lib/node_modules/stf/node_modules/zmq
> node-gyp rebuild

/usr/local/lib/node_modules/npm/bin/node-gyp-bin/node-gyp: line 3: node: command not found
npm ERR! Darwin 14.3.0
npm ERR! argv "node" "/usr/local/bin/npm" "install" "-g" "stf"
npm ERR! node v0.12.7
npm ERR! npm  v2.11.3
npm ERR! file sh
npm ERR! code ELIFECYCLE
npm ERR! errno ENOENT
npm ERR! syscall spawn

npm ERR! zmq@2.12.0 install: `node-gyp rebuild`
npm ERR! spawn ENOENT
npm ERR! 
npm ERR! Failed at the zmq@2.12.0 install script 'node-gyp rebuild'.
npm ERR! This is most likely a problem with the zmq package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get their info via:
npm ERR!     npm owner ls zmq
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /soft/zeromq-4.1.2/npm-debug.log

pleae help me
“npm ERR! Failed at the zmq@2.12.0 install script 'node-gyp rebuild'.
npm ERR! This is most likely a problem with the zmq package,
npm ERR! not with npm itself.” ，may be this is important 
 error:/usr/local/lib/node_modules/npm/bin/node-gyp-bin/node-gyp: line 3: node: command not found
i open the file, :
#!/usr/bin/env sh
if [ "x$npm_config_node_gyp" = "x" ]; then
  node "`dirname "$0"`/../../node_modules/node-gyp/bin/node-gyp.js" "$@"
else
  "$npm_config_node_gyp" "$@"
fi

i have install node ,and
jcdeMacBook-Pro:~ jc$ node -v
v0.12.7
jcdeMacBook-Pro:~ jc$ 

i am puzzled
 @jc5055 This usually happens when there's a permissions issue with node and using the global flag. There are some other possibilities for it as well. See: https://github.com/nodejs/node-gyp/issues/132
 @sorccu @jonalmeida 
thank you
i got
the problem is a permissions issue with node,
to use "sudo npm install --unsafe-perm --verbose -g stf " instand of "sudo npm install -g stf" ,the problem is  solve
 npm install --save bcrypt
|

> bcrypt@0.8.5 install /home/tronwares/Escritorio/Oglit/Provedores-App/node_modules/bcrypt
> node-gyp rebuild

gyp ERR! build error 
gyp ERR! stack Error: not found: make
gyp ERR! stack     at F (/usr/lib/node_modules/npm/node_modules/which/which.js:72:28)
gyp ERR! stack     at E (/usr/lib/node_modules/npm/node_modules/which/which.js:75:29)
gyp ERR! stack     at /usr/lib/node_modules/npm/node_modules/which/which.js:83:16
gyp ERR! stack     at FSReqWrap.oncomplete (fs.js:95:15)
gyp ERR! System Linux 3.16.0-4-amd64
gyp ERR! command "node" "/usr/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "rebuild"
gyp ERR! cwd /home/tronwares/Escritorio/Oglit/Provedores-App/node_modules/bcrypt
gyp ERR! node -v v0.12.7
gyp ERR! node-gyp -v v2.0.1
gyp ERR! not ok 
npm ERR! Linux 3.16.0-4-amd64
npm ERR! argv "/usr/bin/node" "/usr/bin/npm" "install" "--save" "bcrypt"
npm ERR! node v0.12.7
npm ERR! npm  v2.11.3
npm ERR! code ELIFECYCLE

npm ERR! bcrypt@0.8.5 install: `node-gyp rebuild`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the bcrypt@0.8.5 install script 'node-gyp rebuild'.
npm ERR! This is most likely a problem with the bcrypt package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get their info via:
npm ERR!     npm owner ls bcrypt
npm ERR! There is likely additional logging output above.

npm ERR! Please include the following file with any support request:
npm ERR!     /home/tronwares/Escritorio/Oglit/Provedores-App/npm-debug.log
  some devices , the logcat is really fast , and it often cause the page to die when i open logcat and wait for a while , how to solve this problem
 the log in stf ui
I find the reason , it's because the logcat puts chinese encoded with utf8 , and the logcat module cannot parse chinese , but i do not know how to make it compatible with chinese .
do you have any suggestions?
 You don't need to do anything with the Chinese, it's not the reason that makes the UI die.
You will find out the binary.js in the adbkit-logCat which is in the node_modules, some parser codes have problems. If you have the android source code, you can see that a struct about logcat has changes when the target > 19(maybe 21, I forgot), the cursor is not on the correct index on the entry buffer when program want read the time, pid, tid... , so in the page, we can see a lot of strange contents  which make no sence.
In a word, when target<=19, the length of entry data is less than the same data when target>19, change the cursor, and maybe you need a "if-else", then everything will work.
 I also encountered this problem , if I open the logs, sometime later, the browser will die! 
Do you have any solutions about this problem? 
 Hi @l674964417 ,

I'm not sure that it will solve your problem but you can change:
       var maxEntriesBuffer = 3000
defined in : res/app/components/stf/logcat-table/logcat-table-directive.js
to some smaller value, lets say 500 even less(everything depends mostly from how much information is stored for each line of log produced by logcat). What is important. This is not perfect solution, as you will decrease number of information stored in logcat buffer. It should solve your problem, but this problem should be fixed in proper way. I'm working on some modifications under logcat section for STF. I have hope that I will find some time to finish it during this weekend and I will try ask somebody from STF team, to look at my changes.  @l674964417 @lukzeg It's indeed a problem that the web page of STF would hang when logcat output at a fast and furious rate. My solution is adding rate limiter both in websocket and device components:

```javascript
    var RateLimiter = require('limiter').RateLimiter
    var logcatRateLimiter = new RateLimiter(10, 'second') // allow 10 msg to be sent every 1 second
    ... ...
    .on(wire.DeviceLogcatEntryMessage, function (channel, message) {
        if (logcatRateLimiter != null) {
             logcatRateLimiter.removeTokens(1, function () {
               if (logcatRateLimiter != null) {
                 socket.emit('logcat.entry', message)
               }
             })
       }
```

@sorccu It might be a performance problem in Browser, any suggestion to resolve this kind of problem?  When doing:

```
adb connect HOST:PORT
adb install app.apk
```

I'm seeing transfer speeds of about 100 KB/s

When I instead forward the main adb port:

```
killall adb
ssh -L 5037:localhost:5037 HOST &
adb install app.apk
```

I see a speed of: 3424 KB/s
 Confirmed it's fast when running over localhost:

```
adb -s localhost:7403 push file /sdcard/delme
4892 KB/s (543576 bytes in 0.108s)
```

Over ssh tunnel to myself:

```
ssh -N -L 6000:localhost:7403 localhost &
adb connect localhost:6000
adb -s localhost:6000 push file /sdcard/delme
1578 KB/s (543576 bytes in 0.336s)
```

And over the network, it's always at around 100 KB/s

Dug through the code but see no obvious place where things are awry :(
 Nice! I've still been using stf (just with manual ssh adb forwarding). So I'll be happy to verify whether it's fixed with that once it's landed / there's an easy way to check.
 Updated to v1.1.1, but sadly the speed was a whopping 32kb/s 
 The stf update required me to update my version of rethinkdb, so def. did get updated.
 Sadly, that won't be allowable :(. I'm fine to live with it since forwarding 5307 is a reasonable work-around. I am curious to see if anyone else hits the problem though.
 hello,
Yes, I have also this problem on "ADB connect" issue, it is a real one while accesssing a remote device located very far of you as from France to China for example.

Moreover, the work around using the SSH tunnel has some drawbacks:
- the ADB client version and the ADB server version must be compatible, otherwise it does not work, for example a ADB client 1.0.39 is not compatible with a ADB server 1.0.36

- the client has SSH credentials to connect to the server, so it is not very secure

- no ADB server has to run accidentally on the client which requires a special system configuration

- all server devices are seen as locally attached on the client side, so the client totally bypasses the controlling of devices by other third party software (i.e. STF), which may lead to inconsistent situations

In synthesis, this work around is very useful for test platforms but not for production ones, so it will be great to fix the "ADB connect" issue.

Thanks  Can I use STF to debug an app running in android emulator?
  Thanks for your great sharing and reply! I have got STF running via stf local and now I want to try deploying STF to actual servers.But I have some questions need your help.(I want to deploy the platform on two hosts,each host connected to several devices for testing,the OS of hosts is Ubuntu 15.04 )
1.Whether I need to deploy the local Requirements at every host at first (like Node.js >= 0.12,ADB properly set up ,GraphicsMagick ,RethinkDB >= 2.0.0,ZeroMQ ,Protocol Buffers,and pkg-config as stf local) before deploying STF to actual servers like DEPLOYMENT.md?
2.If I don't use Authorization method when I testing the platform,neither OAuth2.0 nor LDAP,How can  I set up the "SECRET=YOUR_SESSION_SECRET_HERE" in stf-app@.service,stf-auth@.service,stf-websocket@.service? How to deal with "AUTHKEY=YOUR_RETHINKDB_AUTH_KEY_HERE_IF_ANY" in rethinkdb-proxy-28015.service.
Thanks!
 Hi sorccu,thanks for your replay.I'll have a try,maybe I‘ll need to ask you for further help!
 Hi sorccu,when i use the command "sudo docker pull openstf/base:v1.0.1" it will show "Error while pulling image:Get https://index.docker.io/v1/repositories/openstf/base/images: net/http: TLS handshke time".

when i  create the docker image in the current directory of Dockerfile with the command "sudo docker build .",it will show "Get https://registry-1.docker.io/v1/repositories/openstf/base/tags/v1.0.1:dial tcp 54.152.161.54.443: i/o timeout".

How can i resolve the question?
 Thanks a lot! I‘m interested in this platform!But I haven't used systemd and docker before,
Now,I have create the units(rethinkdb-proxy-28015.service,adbd.service,stf-provider@.service and other files of '.service' ) under the  directory of "/etc/systemd/system",Can you describe the other implementation steps in detail?

This is the new question with docker build -t openstf/base:v1.0.1 . 
yuancc@STF:/usr/share/docker-engine/contrib/desktop-integration/gparted$ sudo docker build -t openstf/base:v1.0.1 .
Sending build context to Docker daemon 4.096 kB
Step 0 : FROM openstf/base:v1.0.1
Pulling repository docker.io/openstf/base
4f0e1fd9c617: Download complete 
83e4dde6b9cf: Download complete 
b670fb0c7ecd: Download complete 
29460ac93442: Download complete 
d2a0ecffe6fa: Download complete 
Status: Downloaded newer image for openstf/base:v1.0.1
 ---> 4f0e1fd9c617
Step 1 : RUN useradd --system       --no-create-home       --shell /usr/sbin/nologin       --home-dir /app       stf
 ---> Running in 4c1c1be06067
 ---> 401d9d32010a
Removing intermediate container 4c1c1be06067
Step 2 : ENV PATH /app/bin:$PATH
 ---> Running in c3cd0bd3a006
 ---> 8c16a2c9eee9
Removing intermediate container c3cd0bd3a006
Step 3 : WORKDIR /app
 ---> Running in 69bd52d20074
 ---> fc2dec01370e
Removing intermediate container 69bd52d20074
Step 4 : EXPOSE 3000
 ---> Running in 5c92582d4370
 ---> dc5e825e1d51
Removing intermediate container 5c92582d4370
Step 5 : COPY . /app/
 ---> 205a07eb5316
Removing intermediate container 28029e2bc23a
Step 6 : RUN export PATH=/app/node_modules/.bin:$PATH &&     npm install &&     bower install --allow-root &&     gulp build
 ---> Running in 6c247023b6a2
npm ERR! install Couldn't read dependencies
npm ERR! Linux 3.19.0-15-generic
npm ERR! argv "/usr/local/bin/node" "/usr/local/bin/npm" "install"
npm ERR! node v0.12.7
npm ERR! npm  v2.11.3
npm ERR! path /app/package.json
npm ERR! code ENOPACKAGEJSON
npm ERR! errno -2

npm ERR! package.json ENOENT, open '/app/package.json'
npm ERR! package.json This is most likely not a problem with npm itself.
npm ERR! package.json npm can't find a package.json file in your current directory.

npm ERR! Please include the following file with any support request:
npm ERR!     /app/npm-debug.log
The command '/bin/sh -c export PATH=/app/node_modules/.bin:$PATH &&     npm install &&     bower install --allow-root &&     gulp build' returned a non-zero code: 254

Sorry to bother you！
 I change the contents of Dockerfile "RUN export PATH=/app/node_modules/.bin:$PATH && npm install && bower install --allow-root && gulp build" to "RUN export PATH=/usr/local/lib/node_modules/.bin:$PATH && npm install && bower install --allow-root && gulp build" ,the question still exist!
 Hi,sorccu,I'm sorry to bother you again.

I have created the docker image(openstf/base:v1.0.1) by the method like below：
1.$docker search openstf/base
2.$docker pull openstf/base:v1.0.1
3.$docker images,then i can see 
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
<none>              <none>              93a5a17e88f4        15 hours ago        489.5 MB
<none>              <none>              8624680b8bd9        15 hours ago        489.5 MB
ctlc/ambassador     latest              cea471227545        13 days ago         186.4 MB
openstf/base        v1.0.1              4f0e1fd9c617        5 weeks ago         474.7 MB

I have create the units in the path of /etc/systemd/system
    adbd.service
    stf-provider@.service
    rethinkdb-proxy-28015.service
    stf-app@.service
    stf-auth@.service
    stf-log-rethinkdb.service
    stf-migrate.service
    stf-notify-hipchat.service
    stf-processor@.service
    stf-provider@.service
    stf-reaper.service
    stf-storage-plugin-apk@.service
    stf-storage-plugin-image@.service
    stf-storage-temp@.service
    stf-triproxy-app.service
    stf-triproxy-dev.service
    stf-websocket@.service  and ngnix.service

Then I change the configuration of nginx like DEPLOYMENT.md,
In addition to the above comes,I have installed RethinkDB separetely.

But, I don't know how to get the platform running,I tested it by the following method:
1.open a new terminal,input the command "rethinkdb" (like stf local)

2.open a new terminal,input the command "sudo docker run -d -p 80:80 openstf/base:v1.0.1",the result is "yuancc@STF:~$ sudo docker run -d -p 80:80 openstf/base:v1.0.1
e3392b09e421056c2fa7df3be715c439b858003c51783c28337b506ebff8a266
yuancc@STF:~$ "

3.input the URL(https://stf.example.org/) in my browser,it will be show"Server not found"
Maybe it's wrong,or I missed something?I want to run it on my PC at first,and then i will try deploy it on several hosts.

Can you tell me the correct and detailed steps to take the platform running? 

Looking forward to your reply!
Thanks!
 Hi,sorccu!I have learned the basic knowledge about docker and systemd.
But I don't know the meaning of commands like "ExecStartPre=-/usr/bin/docker kill %p,docker rm %p",when I start the units(like rethinkdb-proxy-28015.service),I can check the status with the command of "$systemctl status rethinkdb-proxy-28015.service ",it will show

"root@OMTL-STF:/home/yuancc# systemctl status rethinkdb-proxy-28015.service -l
● rethinkdb-proxy-28015.service - RethinkDB proxy/28015
   Loaded: loaded (/etc/systemd/system/rethinkdb-proxy-28015.service; static; vendor preset: enabled)
   Active: active (running) since 一 2015-08-17 19:21:33 CST; 25min ago
  Process: 1639 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 1633 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)"

I can't start the unit stf-migrate.service, the status is
"root@OMTL-STF:/home/yuancc# systemctl status stf-migrate.service -l
● stf-migrate.service - STF migrate
   Loaded: loaded (/etc/systemd/system/stf-migrate.service; static; vendor preset: enabled)
   Active: failed (Result: exit-code) since 一 2015-08-17 19:34:43 CST; 1min 24s ago
  Process: 8461 ExecStart=/usr/bin/docker run --rm --name %p --link rethinkdb-proxy-28015:rethinkdb openstf/stf:latest stf migrate (code=exited, status=1/FAILURE)
  Process: 8455 ExecStartPre=/usr/bin/docker rm %p (code=exited, status=1/FAILURE)
  Process: 8448 ExecStartPre=/usr/bin/docker kill %p (code=exited, status=1/FAILURE)
  Process: 7848 ExecStartPre=/usr/bin/docker pull openstf/stf:latest (code=exited, status=0/SUCCESS)
 Main PID: 8461 (code=exited, status=1/FAILURE)"

this kind of question will be emerge where have the command like "docker kill %p".how can i deal with it?

others:
I can find 5 images in my the list of images when i run the command "$docker images".

"root@OMTL-STF:/home/yuancc# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
openstf/stf         latest              1e2efcf0fd35        8 days ago          979.4 MB
ctlc/ambassador     latest              cea471227545        2 weeks ago         186.4 MB
openstf/base        v1.0.1              4f0e1fd9c617        5 weeks ago         474.7 MB
nginx               1.7.10              3f72b0ae3e59        5 months ago        93.43 MB
sorccu/adb          latest              37b4eb7ce7a3        13 months ago       343 MB "
and i start rethinkdb in a new terminal:"$rethinkdb"like "stf local",then i start rethinkdb-proxy-28015.service "$systemctl start rethinkdb-proxy-28015.service",then start the migrate unit "$systemctl start stf-migrate.service"but it failed!

Sorry to trouble you again.
  I find the device object has a channel and device's owner has a channel and device's provider has a channel, i don't really know what do these channels used for? can anybody have a explanation?
  execute the rethinkdb, then execute the command of "stf local",  error, the error info as below:

INF/util:procutil 2999 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
/usr/local/lib/node_modules/stf/node_modules/zmq/node_modules/bindings/bindings.js:83
        throw e
              ^
Error: /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node: wrong ELF class: ELFCLASS64
    at Error (native)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at bindings (/usr/local/lib/node_modules/stf/node_modules/zmq/node_modules/bindings/bindings.js:76:44)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:460:26)
    at Object.Module._extensions..js (module.js:478:10)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:460:26)
    at Object.Module._extensions..js (module.js:478:10)
FTL/cli:local 2999 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:110:17)
    at Process.ChildProcess._handle.onexit (child_process.js:1074:12)
INF/cli:local 2999 [*] Shutting down all child processes
 Thanks, I have resolved the problem. My nodejs environment is not good.
 Hi i am still getting the error on running the following commands:
1. rethinkdb
2. stf local

error:

Error: Could not locate the bindings file. Tried:
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Debug/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/out/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/Release/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/build/default/zmq.node
 → /usr/local/lib/node_modules/stf/node_modules/zmq/compiled/5.0.0/darwin/x64/zmq.node
    at bindings (/usr/local/lib/node_modules/stf/node_modules/bindings/bindings.js:88:9)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/lib/index.js:6:30)
    at Module._compile (module.js:425:26)
    at Object.Module._extensions..js (module.js:432:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:311:12)
    at Module.require (module.js:366:17)
    at require (module.js:385:17)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/node_modules/zmq/index.js:2:18)
    at Module._compile (module.js:425:26)
    at Object.Module._extensions..js (module.js:432:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:311:12)
    at Module.require (module.js:366:17)
    at require (module.js:385:17)
    at Object.<anonymous> (/usr/local/lib/node_modules/stf/lib/units/triproxy/index.js:1:73)
FTL/cli:local 27695 [*] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at emitTwo (events.js:87:13)
    at ChildProcess.emit (events.js:172:7)
    at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)

I have 64-bit node.  
  Hi,
I'm using STF to control my Android device(it is a "thinclient", Android system, use VGA to display), get this error:

```
INF/device:plugins:touch 17628 [200.200.138.60:5555] Connecting to minitouch service
INF/device:plugins:touch 17628 [200.200.138.60:5555] minitouch says: "Unable to find a suitable touch device"
WRN/device:plugins:touch 17628 [200.200.138.60:5555] Shell keeping minitouch running ended unexpectedly
INF/device:plugins:touch 17628 [200.200.138.60:5555] Disconnecting from minitouch service
WRN/device:plugins:touch 17628 [200.200.138.60:5555] Will not apply desired state due to too many failures
INF/device:plugins:touch 17628 [200.200.138.60:5555] Stopping minitouch service
FTL/device 17628 [200.200.138.60:5555] Setup had an error Error: Failed more than 3 times in 10000ms
    at TouchConsumer._failLimitExceeded (/usr/lib/node_modules/stf/lib/units/device/plugins/touch/index.js:231:26)
    at FailCounter.emit (/usr/lib/node_modules/stf/node_modules/eventemitter3/index.js:73:35)
    at FailCounter.inc (/usr/lib/node_modules/stf/lib/util/failcounter.js:29:10)
    at TouchConsumer._outputEnded (/usr/lib/node_modules/stf/lib/units/device/plugins/touch/index.js:224:24)
    at RiskyStream.emit (/usr/lib/node_modules/stf/node_modules/eventemitter3/index.js:71:35)
    at RiskyStream.<anonymous> (/usr/lib/node_modules/stf/lib/util/riskystream.js:14:12)
    at Socket.emit (events.js:129:20)
    at _stream_readable.js:908:16
From previous event:
    at startConsumer (/usr/lib/node_modules/stf/lib/units/device/plugins/touch/index.js:512:14)
    at /usr/lib/node_modules/stf/lib/units/device/plugins/touch/index.js:527:12
    at SerialSyrup.ParallelSyrup.invoke (/usr/lib/node_modules/stf/node_modules/stf-syrup/lib/parallel.js:54:24)
    at /usr/lib/node_modules/stf/node_modules/stf-syrup/lib/serial.js:43:33
    at process._tickCallback (node.js:355:11)
FTL/util:lifecycle 17628 [200.200.138.60:5555] Shutting down due to fatal error
INF/provider 17582 [*] Cleaning up device worker "200.200.138.60:5555"
ERR/provider 17582 [*] Device worker "200.200.138.60:5555" died with code 1

```

what should I do?
 ```

shell@android:/ $ getevent -ilp                                                
add device 1: /dev/input/event2
  bus:      0003
  vendor    093a
  product   2510
  version   0111
  name:     "PixArt USB Optical Mouse"
  location: "usb-usb20_host-1.2/input0"
  id:       ""
  version:  1.0.1
  events:
    KEY (0001): BTN_LEFT              BTN_RIGHT             BTN_MIDDLE           
    REL (0002): REL_X                 REL_Y                 REL_WHEEL            
    MSC (0004): MSC_SCAN             
  input props:
    <none>
add device 2: /dev/input/event0
  bus:      0019
  vendor    0001
  product   0001
  version   0100
  name:     "rk29-keypad"
  location: "gpio-keys/input0"
  id:       ""
  version:  1.0.1
  events:
    KEY (0001): KEY_POWER             KEY_WAKEUP           
  input props:
    <none>
add device 3: /dev/input/event1
  bus:      0019
  vendor    0001
  product   0001
  version   0100
  name:     "rkxx-remotectl"
  location: "gpio-keys/input0"
  id:       ""
  version:  1.0.1
  events:
    KEY (0001): KEY_ENTER             KEY_F8                KEY_F9                KEY_F10              
                KEY_F11               KEY_F12               KEY_HOME              KEY_UP               
                KEY_LEFT              KEY_RIGHT             KEY_DOWN              KEY_MUTE             
                KEY_VOLUMEDOWN        KEY_VOLUMEUP          KEY_POWER             KEY_MENU             
                KEY_WAKEUP            KEY_BACK              KEY_F13               KEY_F14              
                KEY_F15               KEY_F16               KEY_SEARCH            KEY_REPLY            
                KEY_MODE              KEY_TEXT              KEY_YELLOW            KEY_BLUE             
                KEY_CHANNELUP        
  input props:
    <none>

```

yes, it has no touch device, it use usb keyboard and mouse to input.

but, I can use `adb shell input tap x y` to touch somewhere.
 Hi!
I'm having the same issue with a resistive screen.

The input devices are the following:

```
add device 3: /dev/input/event2
  bus:      0018
  vendor    0000
  product   0000
  version   0000
  name:     "aw2083_input"
  location: "aw2xxx/input0"
  id:       ""
  version:  1.0.1
  events:
    KEY (0001): BTN_TOUCH            
    ABS (0003): ABS_X                 : value 2, min 0, max 480, fuzz 0, flat 0, resolution 0
                ABS_Y                 : value 2, min 0, max 800, fuzz 0, flat 0, resolution 0
                ABS_MISC              : value 0, min 0, max 0, fuzz 0, flat 0, resolution 0
  input props:
    INPUT_PROP_DIRECT
add device 4: /dev/input/event1
  bus:      0000
  vendor    0000
  product   0000
  version   0000
  name:     "adxl346"
  location: "sensor-input/input0"
  id:       ""
  version:  1.0.1
  events:
    ABS (0003): ABS_X                 : value 5, min -32768, max 32767, fuzz 0, flat 0, resolution 0
                ABS_Y                 : value -2, min -32768, max 32767, fuzz 0, flat 0, resolution 0
                ABS_Z                 : value 253, min -32768, max 32767, fuzz 0, flat 0, resolution 0
  input props:
    <none>
add device 5: /dev/input/event0
  bus:      0000
  vendor    0000
  product   0000
  version   0000
  name:     "sensor-input"
  location: "sensor-input/input0"
  id:       ""
  version:  1.0.1
  events:
  input props:
    <none>
```

Any help will be appreciated, thanks for making this project!
 It is a Senter PDA (custom chinese phone), here is the output: https://gist.github.com/mitoyarzun/4fccf90b448b34ff8bb9
 Exactly like that ;)

The screen is resistive and it has a custom Android 4.1 ROM.
 run ```getevent -ilp``` on my device,  print out
```
could not open /dev/input/event9, Permission denied
could not open /dev/input/event8, Permission denied
could not open /dev/input/event7, Permission denied
could not open /dev/input/event4, Permission denied
could not open /dev/input/mouse0, Permission denied
could not open /dev/input/event2, Permission denied
could not open /dev/input/event1, Permission denied
could not open /dev/input/mice, Permission denied
could not open /dev/input/event5, Permission denied
could not open /dev/input/event6, Permission denied
could not open /dev/input/event3, Permission denied
could not open /dev/input/event0, Permission denied
```   @sorccu Nice! That a good idea! @DoctorQ Then I see your share on TesterHome,Thanks all!
  Hi,
I have a problem, here's my scenario:
- i have run 'rethinkdb' and 'stf local --public-ip x.x.x.x'
- open browser and access x.x.x.x:7100
- i can see list of my devices connected. But the screen is grey and i can't get any information about the device.

It's normal if i access locally. Am i missed something?
 My firewall is already off. I even cannot save ADB Key from other machine.
Is there other setting to do? Or only run stf local --public-ip ?
  As we have dozens of mobile devices we have to connect devices to different servers, then how to setup a central server to access all the devices?
 get it, thanks a lot.
we may be back to you when we got some troubles. :)
  Hi, thank you for your great app. I want to use node --debug to have a better understand of how it works. I tried node -- debug cli local, but it failed, both in node version 0.10 and 0.12. I googled and learned that this is a clustered app and all the workers attempted to listen on the same debug port. So how do you debug in your development? Can I set breakpoint on it? Can I debug it or part of it separately?
 Can anyone help on this? 
@YuxinZhou, do you have any progress?
 https://strongloop.com/strongblog/whats-new-nodejs-v0-12-debugging-clusters/
 Thx, sorccu sen. Just try to debug stf modules by node-inspector separately. As you mentioned, the node debugger is a little annoying.. 
  Hi 

Firstly, thanks for you great project.
I have a question about how to expand device pool to 100+? Suppose one PC has 4 motherboard's USB ports, and each one connects to a usb hub with 7 ports. It can only connect to 28 devices, how we can expand to 100+? 
  Hi,

I know STF provides authentication units for OAuth 2.0, LDAP, mock. When we run stf with this command "stf local", it will use mock implementation which only asks for a name and an email address.

But I want to use true user authentication by LDAP, suppose that we have a LDAP server like xxxx.xxxx.xxx:222,  but how I run STF and use which command?  Please  help give some guidance, thanks a lot.
 Thanks for you quick answer, I know this command but not so familiar with the options which stf auth-ldap provided. Hope you can paste a complete command sample for LDAP.
 ok, thank for you answer and I will try.
 @sorccu 

I want to authenticate users in stf against an existing LDAP server, I tried to use this command to lauch stf: 

##### stf local --auth-type ldap --auth-options '["--ldap-url","ldap://myldapserver"]'

But it display below error after I click the login button in ldap login page.

/auth-ldap 55816 [::ffff:127.0.0.1] Unexpected error AssertionError: options.attribute (string) is required
    at EqualityFilter (/usr/local/lib/node_modules/stf/node_modules/ldapjs/node_modules/ldap-filter/lib/equality_filter.js:15:12)
    at new EqualityFilter (/usr/local/lib/node_modules/stf/node_modules/ldapjs/lib/filters/equality_filter.js:16:26)
    at tryFind (/usr/local/lib/node_modules/stf/lib/util/ldaputil.js:55:15)
    at /usr/local/lib/node_modules/stf/lib/util/ldaputil.js:108:12
From previous event:
    at Object.module.exports.login (/usr/local/lib/node_modules/stf/lib/util/ldaputil.js:107:23)
    at /usr/local/lib/node_modules/stf/lib/units/auth/ldap.js:71:29
    at processImmediate [as _immediateCallback](timers.js:358:17)
From previous event:
    at /usr/local/lib/node_modules/stf/lib/units/auth/ldap.js:70:12
    at Layer.handle [as handle_request](/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at next (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/route.js:131:13)
    at Route.dispatch (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request](/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at /usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:277:22
    at Function.process_params (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
    at next (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:271:10)
    at /usr/local/lib/node_modules/stf/lib/units/auth/ldap.js:50:5
    at Layer.handle [as handle_request](/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:312:13)
    at /usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
    at next (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:271:10)
    at /usr/local/lib/node_modules/stf/node_modules/express-validator/lib/express_validator.js:163:5
    at Layer.handle [as handle_request](/usr/local/lib/node_modules/stf/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:312:13)
    at /usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/usr/local/lib/node_modules/stf/node_modules/express/lib/router/index.js:330:12)
 I've been trying to enable LDAP authentication with the auth module service file. I am getting what is probably a mix of syntax and comprehension errors. I do have people I can go to for figuring out what parameters I need for LDAP, but I'll need to make sure I get the syntax right before I waste peoples time. Is this the right way to add the variables to the run command in a service file?

```
ExecStart=/usr/bin/docker run --rm \
  --name %p-%i \
  -e "SECRET=SECRET" \
  -e "NODE_TLS_REJECT_UNAUTHORIZED=0" \
  -p %i:3000 \
  openstf/stf:latest \
  stf auth-ldap --port 3000 \
    -u ldap://XXXauth.XXX.com:389/ \
    -t 0 \
    --ldap-bind-dn "CN=XXX,OU=XXX,OU=XXX,DC=XXX,DC=com" \
    --ldap-bind-credentials "PASSWORD_HERE" \
    --ldap-search-dn "OU=User Accounts,DC=XXX,DC=com" \
    --ldap-search-scope "sAMAccountName={0}" \
    --app-url https://xx.xx.xx.xx/
ExecStop=-/usr/bin/docker stop -t 10 %p-%i
```
 Hey I am using STF local when I run below command
stf local --auth-type oauth2 \
  --auth-options '[ 
    "--oauth-authorization-url", "https://sso.company.example.org/as/authorization.oauth2",
    "--oauth-token-url", "https://sso.company.example.org/as/token.oauth2",
    "--oauth-userinfo-url", "https://sso.company.example.org/idp/userinfo.openid",
    "--oauth-client-id", "12345",
    "--oauth-client-secret", "54321",
    "--oauth-callback-url", "https://stf.example.org/auth/oauth/callback",
    "--oauth-scope", "tadesushil@gmail.com"
  ]'

**I am getting below error**

INF/util:procutil 2199 [_] Forking "/usr/local/lib/node_modules/stf/lib/cli.js migrate"
INF/db 2204 [_] Connecting to 127.0.0.1:28015
INF/db 2204 [_] Unable to connect to 127.0.0.1:28015
FTL/db 2204 [_] No hosts left to try
FTL/util:lifecycle 2204 [*] Shutting down due to fatal error 
/usr/local/lib/node_modules/stf/node_modules/bluebird/js/main/promise.js:677
                                                             throw e;
                                                             ^
ExitError: Exit code "1"
      at ChildProcess.<anonymous> (/usr/local/lib/node_modules/stf/lib/util/procutil.js:49:23)
      at emitTwo (events.js:100:13)
      at ChildProcess.emit (events.js:185:7)
      at Process.ChildProcess._handle.oneexit (internal/child_process.js:200:12)

am I missing something?
  Hi,May I ask a question? When I click Screenshots, I can see a picture in the window of Screenshots , but I can't open the image when I click it,The new window will be prompted“The image http://localhost:7100/s/image/75eaef9a-0504-4a2c-8ffa-0d17ab1c3963/0e8bc602.jpg cannot be displayed because it contains errors”.
I have been troubled by the problem for several days,Looking forward to your answer,Thanks
 yuancc, hi, I had similar problem, so maybe my experience will help.
The problem was with GraphicsMagick indeed.
I installed it from source, following instructions on GraphicsMagick official site, and I faced exactly the same problem you are describing.
After I removed it and installed from my ubuntu repository, screenshots repaired.
https://github.com/openstf/stf/issues/20
 hi,sorccu and rseek,thanks for your reply! My problem has been solved by the method of rseek !
But now, I want to ask another question! How to set the rights of login?,everyone can login the platform of STF if he/she know my URL via his/her name and E-mail. In this case, there is a big security risk, where can I change it? Only through change from the source code ?
 Hi,@sorccu good afternoon,paradon me,i need your help,my screenshots function doesn't working,i don't know why,the problem tip is 'http://localhost:7100/s/image/75eaef9a-0504-4a2c-8ffa-0d17ab1c3963/0e8bc602.jpg cannot be displayed because it contains errors' ,install GraphicsMagick ???how install ?can you give me a command?thx @sorccu  i looked.but `````
 sudo npm install graphicsmagick
npm WARN lifecycle graphicsmagick@0.0.1~preinstall: cannot run in wd %s %s (wd=%s) graphicsmagick@0.0.1 node-waf clean || (exit 0); node-waf configure build /usr/local/lib/node_modules/stf/node_modules/.staging/graphicsmagick-e990271d
stf@2.3.0 /usr/local/lib/node_modules/stf
└── graphicsmagick@0.0.1 

npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@^1.0.0 (node_modules/chokidar/node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.1: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})
  Hello,
I'm trying to run STF with Docker, but I got an error 

stf@10d2f43a5185:/app$ stf local
INF/util:procutil 13 [_] Forking "/app/lib/cli.js migrate"
INF/db 14 [_] Connecting to 127.0.0.1:28015
INF/db 14 [_] Unable to connect to 127.0.0.1:28015
FTL/db 14 [_] No hosts left to try
FTL/util:lifecycle 14 [*] Shutting down due to fatal error

/app/node_modules/bluebird/js/main/promise.js:673
            throw e;
                  ^
ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/app/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:110:17)
    at Process.ChildProcess._handle.onexit (child_process.js:1074:12)

Do you have an idea about the issue?
 ok, then it would be easier to install all Requirements by hand without Docker, no?
 @sorccu regarding OS X + Docker support, if I configure Virtualbox to forward USB ports to guest boot2docker machine would it work? Or using something like https://bitbucket.org/chabernac/adbportforward/wiki/Home ? The last one sounds a bit like a jerry rig.
  i run on my android tv box and gets this error 
minicap error: "ERROR: (external/MY_minicap/src/minicap_17.cpp:123: errno: Invalid argument) Unable to lock next buffer BAD_VALUE (-22)"
is it something wrong with my android device or can i do something to fix it?
 adb shell getprop | grep ro.product  returns
ro.product.board]: [MagicBox1s]
ro.product.brand]: [MBX]
ro.product.cpu.abi2]: [armeabi]
ro.product.cpu.abi]: [armeabi-v7a]
ro.product.device]: [MagicBox1s]
ro.product.locale.language]: [zh]
ro.product.locale.region]: [CN]
ro.product.manufacturer]: [MagicBox1s]
ro.product.model]: [MagicBox1s]
ro.product.name]: [MagicBox1s]

and adb shell getprop | grep ro.build.version returns
ro.build.version.codename]: [REL]
ro.build.version.incremental]: [20141214]
ro.build.version.release]: [2.1.0-R-20141214.1729]
ro.build.version.sdk]: [17]
 here's another device (i have a lot of devices ~~)

adb shell getprop | grep ro.product returns
ro.product.board]: [rk30sdk]
ro.product.brand]: [rockchip]
ro.product.cpu.abi2]: [armeabi]
ro.product.cpu.abi]: [armeabi-v7a]
ro.product.device]: [rk312x]
ro.product.locale.language]: [zh]
ro.product.locale.region]: [CN]
ro.product.manufacturer]: [rockchip]
ro.product.model]: [PULIER_RK28_XX]
ro.product.name]: [rk312x]
ro.product.ota.host]: [www.rockchip.com:2300]
ro.product.usbfactory]: [rockchip_usb]
ro.product.version]: [1.0.0]

and adb shell getprop | grep ro.build.version returns
ro.build.version.codename]: [REL]
ro.build.version.incremental]: [eng.pro_rk3128.20150521.133921]
ro.build.version.release]: [2.1.2-R-20150521.1339]
ro.build.version.sdk]: [19]
  Hi, i am using stf with an android tv magic box , it's os is based on android and it is connected to adb using network , i use --allow-remote to start stf , when i try to control the device , it waits for a while and tells me some one stole your device , i don't know what dose that mean , what errors can cause that ?
 i catched this message

FTL/device:plugins:service 26170 [192.168.8.23:5555] Service connection could not be relaunched TimeoutError: operation timed out
    at Timer.listOnTimeout (timers.js:119:15)
From previous event:
    at Socket.endListener (/root/stf/stf/lib/units/device/plugins/service.js:196:12)
    at Socket.g (events.js:199:16)
    at Socket.emit (events.js:129:20)
    at _stream_readable.js:908:16
    at process._tickCallback (node.js:355:11)
FTL/util:lifecycle 26170 [192.168.8.23:5555] Shutting down due to fatal error

my device is there and adb is connected
 i got it , it is something wrong with the owner
  I am trying to start rethinkdb in different port than the default one (command used - rethinkdb -o 8081) and then start "stf" (command used - stf local). But I am getting an error as -

INF/util:procutil 6386 [_] Forking "/home/xxx/xxx/stf/lib/cli.js migrate"
INF/db 6394 [_] Connecting to 127.0.0.1:28015
INF/db 6394 [_] Unable to connect to 127.0.0.1:28015
FTL/db 6394 [_] No hosts left to try
FTL/util:lifecycle 6394 [*] Shutting down due to fatal error

/home/zaloraqa/Downloads/stf/node_modules/bluebird/js/main/promise.js:673
           throw e;
                 ^
ExitError: Exit code "1"
   at ChildProcess.<anonymous> (/home/xxxx/xxxx/stf/lib/util/procutil.js:49:23)
   at ChildProcess.emit (events.js:110:17)
   at Process.ChildProcess._handle.onexit (child_process.js:1074:12)

So please let me know is it possible to run stf when renthinkdb not running in default port (8080)

Thanks
 Thanks it worked
  i have a NX device and sdk is 17, but i find that the screen only shows the first capture and do not move  again. on my device my act takes effect and the screen changed , but in the brower the screen do not move. do you have any suggestions for that?
 Hi, there's the output
[root@localhost ]# adb shell getprop | grep ro.product
[ro.product.board]: [neken NX]

[ro.product.device]: [neken NX]

[ro.product.model]: [neken NX]
[ro.product.name]: [neken NX]
it is wired , why github only shows four line
 i got these message from logcat , does it help?
Error   10:45:46.209    158 298 IMGSRV  :0: gralloc_module_map: Cannot map buffer ID=130 before register (0x0)
Error   10:45:46.209    158 298 IMGSRV  :0: MapBufferObtainParams: Mapping buffer failed
Error   10:45:46.209    158 298 IMGSRV  :0: WSEGL_GetDrawableParameters: Failed to obtain buffer parameters
Error   10:45:46.209    158 298 IMGSRV  :0: KEGLRecreateDrawable: Couldn't create a drawable
Error   10:45:46.209    158 298 IMGSRV  :0: KEGLGetDrawableParameters: Can't recreate drawable
Error   10:45:46.209    158 298 IMGSRV  :0: GLESMakeCurrentGC: Invalid drawable - what do we do?
Error   10:45:46.209    158 298 IMGSRV  :0: gralloc_module_map: Cannot map buffer ID=130 before register (0x0)
Error   10:45:46.209    158 298 IMGSRV  :0: MapBufferObtainParams: Mapping buffer failed
Error   10:45:46.209    158 298 IMGSRV  :0: WSEGL_GetDrawableParameters: Failed to obtain buffer parameters
Error   10:45:46.209    158 298 IMGSRV  :0: KEGLRecreateDrawable: Couldn't create a drawable
Error   10:45:46.209    158 298 IMGSRV  :0: KEGLGetDrawableParameters: Can't recreate drawable
Error   10:46:00.105    158 298 IMGSRV  :0: gralloc_module_map: Cannot map buffer ID=130 before register (0x0)
Error   10:46:00.105    158 298 IMGSRV  :0: MapBufferObtainParams: Mapping buffer failed
Error   10:46:00.105    158 298 IMGSRV  :0: WSEGL_GetDrawableParameters: Failed to obtain buffer parameters
Error   10:46:00.105    158 298 IMGSRV  :0: KEGLRecreateDrawable: Couldn't create a drawable
Error   10:46:00.105    158 298 IMGSRV  :0: KEGLGetDrawableParameters: Can't recreate drawable
Error   10:46:00.105    158 298 IMGSRV  :0: GLESMakeCurrentGC: Invalid drawable - what do we do?
Error   10:46:00.106    158 298 IMGSRV  :0: gralloc_module_map: Cannot map buffer ID=130 before register (0x0)
Error   10:46:00.106    158 298 IMGSRV  :0: MapBufferObtainParams: Mapping buffer failed
Error   10:46:00.106    158 298 IMGSRV  :0: WSEGL_GetDrawableParameters: Failed to obtain buffer parameters
Error   10:46:00.106    158 298 IMGSRV  :0: KEGLRecreateDrawable: Couldn't create a drawable
Error   10:46:00.106    158 298 IMGSRV  :0: KEGLGetDrawableParameters: Can't recreate drawable
Error   10:46:00.244    158 298 IMGSRV  :0: MapBufferObtainParams: Mapping buffer failed
Error   10:46:00.244    158 298 IMGSRV  :0: gralloc_module_map: Cannot map buffer ID=130 before register (0x0)
Error   10:46:00.244    158 298 IMGSRV  :0: WSEGL_GetDrawableParameters: Failed to obtain buffer parameters
Error   10:46:00.244    158 298 IMGSRV  :0: KEGLRecreateDrawable: Couldn't create a drawable
Error   10:46:00.244    158 298 IMGSRV  :0: KEGLGetDrawableParameters: Can't recreate drawable
Error   10:46:00.244    158 298 IMGSRV  :0: GLESMakeCurrentGC: Invalid drawable - what do we do?
Error   10:46:00.244    158 298 IMGSRV  :0: gralloc_module_map: Cannot map buffer ID=130 before register (0x0)
Error   10:46:00.244    158 298 IMGSRV  :0: MapBufferObtainParams: Mapping buffer failed
Error   10:46:00.244    158 298 IMGSRV  :0: WSEGL_GetDrawableParameters: Failed to obtain buffer parameters
Error   10:46:00.244    158 298 IMGSRV  :0: KEGLRecreateDrawable: Couldn't create a drawable
Error   10:46:00.244    158 298 IMGSRV  :0: KEGLGetDrawableParameters: Can't recreate drawable
Error   10:46:00.283    158 298 IMGSRV  :0: gralloc_module_map: Cannot map buffer ID=130 before register (0x0)
Error   10:46:00.283    158 298 IMGSRV  :0: WSEGL_GetDrawableParameters: Failed to obtain buffer parameters
Error   10:46:00.283    158 298 IMGSRV  :0: MapBufferObtainParams: Mapping buffer failed
Error   10:46:00.283    158 298 IMGSRV  :0: KEGLGetDrawableParameters: Can't recreate drawable
Error   10:46:00.283    158 298 IMGSRV  :0: KEGLRecreateDrawable: Couldn't create a drawable
Error   10:46:00.283    158 298 IMGSRV  :0: GLESMakeCurrentGC: Invalid drawable - what do we do?
Error   10:46:00.283    158 298 IMGSRV  :0: gralloc_module_map: Cannot map buffer ID=130 before register (0x0)
Error   10:46:00.283    158 298 IMGSRV  :0: WSEGL_GetDrawableParameters: Failed to obtain buffer parameters
Error   10:46:00.283    158 298 IMGSRV  :0: MapBufferObtainParams: Mapping buffer failed
Error   10:46:00.283    158 298 IMGSRV  :0: KEGLRecreateDrawable: Couldn't create a drawable
Error   10:46:00.283    158 298 IMGSRV  :0: KEGLGetDrawableParameters: Can't recreate drawable
 ok , if it is the same behavior , maybe it is the same reason , and if you want me to do something , just mail me at channingbreeze@163.com , i will try my best to help . thank you !
 Hello, @sorccu, @channingbreeze
I faced exactly the same issue with HUAWEI U8825-1, so I am very interested in solving this issue too, I will follow this thread, and I am ready to post some debug info if needed
  Hi,

here is the log:
 stf local
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js migrate"
INF/db 24095 [_] Connecting to 127.0.0.1:28015
INF/db:setup 24095 [_] Database "stf" already exists
INF/db:setup 24095 [_] Table "users" already exists
INF/db:setup 24095 [_] Table "devices" already exists
INF/db:setup 24095 [_] Table "logs" already exists
INF/db:setup 24095 [_] Index "users"."adbKeys" already exists
INF/db:setup 24095 [_] Index "devices"."owner" already exists
INF/db:setup 24095 [_] Index "devices"."present" already exists
INF/db:setup 24095 [_] Index "devices"."providerChannel" already exists
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js triproxy app001 --bind-pub tcp://127.0.0.1:7111 --bind-dealer tcp://127.0.0.1:7112 --bind-pull tcp://127.0.0.1:7113"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js triproxy dev001 --bind-pub tcp://127.0.0.1:7114 --bind-dealer tcp://127.0.0.1:7115 --bind-pull tcp://127.0.0.1:7116"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js processor proc001 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js processor proc002 --connect-app-dealer tcp://127.0.0.1:7112 --connect-dev-dealer tcp://127.0.0.1:7115"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js reaper reaper001 --connect-push tcp://127.0.0.1:7116 --connect-sub tcp://127.0.0.1:7111"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js provider --name ubuntu --min-port 7400 --max-port 7700 --connect-sub tcp://127.0.0.1:7114 --connect-push tcp://127.0.0.1:7116 --group-timeout 900 --public-ip localhost --storage-url http://localhost:7100/ --adb-host 127.0.0.1 --adb-port 5037"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js auth-mock --port 7120 --secret kute kittykat --app-url http://localhost:7100/"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js app --port 7105 --secret kute kittykat --auth-url http://localhost:7100/auth/mock/ --websocket-url http://localhost:7110/"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js websocket --port 7110 --secret kute kittykat --storage-url http://localhost:7100/ --connect-sub tcp://127.0.0.1:7111 --connect-push tcp://127.0.0.1:7113"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js storage-temp --port 7102"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js storage-plugin-image --port 7103 --storage-url http://localhost:7100/"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js storage-plugin-apk --port 7104 --storage-url http://localhost:7100/"
INF/util:procutil 24092 [_] Forking "/usr/lib/node_modules/stf/lib/cli.js poorxy --port 7100 --app-url http://localhost:7105/ --auth-url http://localhost:7120/ --websocket-url http://localhost:7110/ --storage-url http://localhost:7102/ --storage-plugin-image-url http://localhost:7103/ --storage-plugin-apk-url http://localhost:7104/"
INF/triproxy 24098 [app001] PUB socket bound on tcp://127.0.0.1:7111
INF/triproxy 24098 [app001] DEALER socket bound on tcp://127.0.0.1:7112
INF/triproxy 24098 [app001] PULL socket bound on tcp://127.0.0.1:7113
INF/triproxy 24099 [dev001] PUB socket bound on tcp://127.0.0.1:7114
INF/triproxy 24099 [dev001] DEALER socket bound on tcp://127.0.0.1:7115
INF/triproxy 24099 [dev001] PULL socket bound on tcp://127.0.0.1:7116
INF/reaper 24104 [reaper001] Subscribing to permanent channel "_ALL"
INF/reaper 24104 [reaper001] Reaping devices with no heartbeat
INF/db 24104 [reaper001] Connecting to 127.0.0.1:28015
INF/db 24103 [proc002] Connecting to 127.0.0.1:28015
INF/reaper 24104 [reaper001] Receiving input from "tcp://127.0.0.1:7111"
INF/reaper 24104 [reaper001] Sending output to "tcp://127.0.0.1:7116"
INF/processor 24103 [proc002] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 24103 [proc002] Device dealer connected to "tcp://127.0.0.1:7115"
INF/db 24100 [proc001] Connecting to 127.0.0.1:28015
INF/processor 24100 [proc001] App dealer connected to "tcp://127.0.0.1:7112"
INF/processor 24100 [proc001] Device dealer connected to "tcp://127.0.0.1:7115"
INF/poorxy 24122 [_] Listening on port 7100
INF/storage:plugins:image 24120 [_] Listening on port 7103
INF/auth-mock 24106 [_] Listening on port 7120
INF/storage:temp 24115 [_] Listening on port 7102
INF/storage:plugins:apk 24121 [_] Listening on port 7104
INF/provider 24105 [_] Subscribing to permanent channel "O6uuMWGCQiygamxH7OprEA=="
INF/provider 24105 [_] Sending output to "tcp://127.0.0.1:7116"
INF/provider 24105 [_] Receiving input from "tcp://127.0.0.1:7114"
INF/provider 24105 [_] Tracking devices
INF/provider 24105 [_] Found device "0146B5681401101C" (offline)
INF/reaper 24104 [reaper001] Device "0146B5681401101C" is present
INF/provider 24105 [_] Registered device "0146B5681401101C"
INF/app 24107 [_] Using webpack
module.js:338
    throw err;
    ^
Error: Cannot find module './../../../webpack.config'
    at Function.Module._resolveFilename (module.js:336:15)
    at Function.Module._load (module.js:278:25)
    at Module.require (module.js:365:17)
    at require (module.js:384:17)
    at module.exports (/usr/lib/node_modules/stf/lib/units/app/index.js:56:31)
    at Command.<anonymous> (/usr/lib/node_modules/stf/lib/cli.js:627:27)
    at Command.listener (/usr/lib/node_modules/stf/node_modules/commander/index.js:301:8)
    at Command.emit (events.js:110:17)
    at Command.parseArgs (/usr/lib/node_modules/stf/node_modules/commander/index.js:610:12)
    at Command.parse (/usr/lib/node_modules/stf/node_modules/commander/index.js:458:21)
    at Object.<anonymous> (/usr/lib/node_modules/stf/lib/cli.js:1102:9)
    at Module._compile (module.js:460:26)
    at Object.Module._extensions..js (module.js:478:10)
    at Module.load (module.js:355:32)
    at Function.Module._load (module.js:310:12)
    at Function.Module.runMain (module.js:501:10)
FTL/cli:local 24092 [_] Child process had an error ExitError: Exit code "1"
    at ChildProcess.<anonymous> (/usr/lib/node_modules/stf/lib/util/procutil.js:49:23)
    at ChildProcess.emit (events.js:110:17)
    at Process.ChildProcess._handle.onexit (child_process.js:1074:12)
INF/cli:local 24092 [_] Shutting down all child processes
INF/util:lifecycle 24098 [app001] Winding down for graceful exit
INF/util:lifecycle 24103 [proc002] Winding down for graceful exit
INF/util:lifecycle 24100 [proc001] Winding down for graceful exit
INF/util:lifecycle 24105 [_] Winding down for graceful exit
INF/util:lifecycle 24104 [reaper001] Winding down for graceful exit
INF/util:lifecycle 24106 [_] Winding down for graceful exit
INF/auth-mock 24106 [_] Waiting for client connections to end
WRN/db 24104 [reaper001] Connection closed
INF/db 24104 [reaper001] Connecting to 127.0.0.1:28015
WRN/db 24100 [proc001] Connection closed
INF/db 24100 [proc001] Connecting to 127.0.0.1:28015
INF/websocket 24110 [_] Subscribing to permanent channel "_ALL"
INF/websocket 24110 [_] Listening on port 7110
INF/util:lifecycle 24110 [_] Winding down for graceful exit
INF/db 24110 [_] Connecting to 127.0.0.1:28015

But... webpack seems to be installed:
npm install webpack -g
npm WARN optional dep failed, continuing fsevents@0.3.6
/usr/bin/webpack -> /usr/lib/node_modules/webpack/bin/webpack.js
webpack@1.10.5 /usr/lib/node_modules/webpack
├── interpret@0.6.5
├── tapable@0.1.9
├── clone@1.0.2
├── memory-fs@0.2.0
├── supports-color@3.1.0 (has-flag@1.0.0)
├── async@1.4.0
├── enhanced-resolve@0.9.0 (graceful-fs@3.0.8)
├── mkdirp@0.5.1 (minimist@0.0.8)
├── optimist@0.6.1 (wordwrap@0.0.3, minimist@0.0.10)
├── webpack-core@0.6.6 (source-list-map@0.1.5, source-map@0.4.4)
├── watchpack@0.2.8 (graceful-fs@3.0.8, async@0.9.2, chokidar@1.0.5)
├── uglify-js@2.4.24 (uglify-to-browserify@1.0.2, async@0.2.10, yargs@3.5.4, source-map@0.1.34)
├── esprima@1.2.5
└── node-libs-browser@0.5.2 (https-browserify@0.0.0, tty-browserify@0.0.0, constants-browserify@0.0.1, path-browserify@0.0.0, os-browserify@0.1.2, string_decoder@0.10.31, process@0.11.1, domain-browser@1.1.4, punycode@1.3.2, querystring-es3@0.2.1, assert@1.3.0, timers-browserify@1.4.1, stream-browserify@1.0.0, events@1.0.2, vm-browserify@0.0.4, console-browserify@1.1.0, util@0.10.3, http-browserify@1.7.0, readable-stream@1.1.13, url@0.10.3, buffer@3.3.1, browserify-zlib@0.1.4, crypto-browserify@3.2.8)

Can you help?
Thanks.
 Hi,
stf -V
1.0.7
 No, I built it.
I went and installed with your command, and it now works.
Go figure. ;-)
Thanks.
 Well, I did it on an Ubuntu while using the root user I'm afraid.
sudo -E npm install -g
sudo -E bower --allow-root install
  What about adding a section **Folders** (like Dashboard, Screenshots, Automation, Advanced & Info)  and use `adb shell ls` to list all of them and each folder, for ex. `adb shell ls sdcard`. 
And then on each file(that the user can access) use `adb pull` ?
 I got the same in mind. Is anybody already implementing this or can I take the lead ? 
 Yeah, I meant as contribution @gunta . I'll create a fork and a branch called "FileExplorer" and let you know when I got something implemented for you guys to test. 
 @vrunoa Any progress on this issue?
 hey @codeskyblue , tonight i'll commit some implementations I made. 
 @vrunoa good. currently I only finished download file from a specific path. but list and file explorer not done any yet.
 File Explorer added in https://github.com/openstf/stf/pull/89 and it is very useful;
Though it supports only downloading files.
Looking forward to seeing Uploading files (not only .apk), cuz it would be very useful feature too.
 Should this issue closed, because there is FileExplorer now.
 My pleasure. Great work for the STF team.
  Hello guys,

Thanks for this awesome tool. I had fun in setting up this locally and its quite useful for debugging my apps.

The kind of feature I wish from STF is running UI Test Suites (Appium, Robotium, monkey runner etc) **parallel** on **multiple devices** similar to services such as [testdroid](http://testdroid.com/), [AWS Device Farm](http://aws.amazon.com/device-farm/) etc.

For this, they provide a feature for creating custom device pool where user can create a device group of their target devices. Then you upload your apk file and test suites then they will run your test and provide test results. They also provide apis for these features which makes CI integration easier.

I think it will be really helpful to have this kind of facility On-premises. It will give better control.

I want to know if this feature or something similar to this, is in your roadmap? If it is, please share how you want to implement this. I will be glad to contribute :)

Thanks,
 Thanks for reply,

> At first we're just planning on just creating a fairly simple API to reserve devices with the desired features, with the possibility to enumerate the devices in the response and adb connect to them yourself.

This can be a good start. 

One limitation with this model which I can see now is, client(using "adb connect" api) will be running the test suites instead of STF. Client will be storing test results. It will be difficult to manage test history on STF in this model. Moreover, this limitation is only when if we want to support test history or project management on STF. User can always use CI tools such as Jenkins to manage project and test history by running test on Jenkins slaves machine using STF apis.

I will start digging up STF source code and try to come up with system requirements and possible designs related to test automation.
 Hi @sorccu ,

The kind of automation which I currently want to do is as follow:
- Run android monkey test and Appium test on multiple devices parallel from script.

From current STF, I can do this by doing:
1.) Connect all the required devices from STF web app
2.) Get Remote Debug Command string corresponding to each device
3.) Run remote debug command locally and get all devices connected
4.) Run monkey or appium test
5.) Disconnect devices from STF web app

In order to automate this fully, person will require apis which can lock and unlock desired device for him. And he will also need "Remote Debug Command String" which he can run locally to connect remote device.

I checked STF code and found that you have implemented some minimal apis [here](https://github.com/openstf/stf/blob/master/lib/units/app/index.js#L127-L202). By using these apis, person can get list of all devices and device info/status. But there is no api for locking a device.

I am proposing to implement two more end points which are as follow:
1.) `/app/api/v1/devices/:serial/lock`
2.) `/app/api/v1/devices/:serial/unlock`

The "lock" endpoint will do the same thing when user click "Use" button for a device and in response it will return device information (`/app/api/v1/devices/:serial`) + remote debug command string. 

The "unlock" endpoint will release the device from user same when a user click "Stop Using" button.

If you like this idea, then I will start designing apis and implementing code. If you have other suggestions please share.

Thanks,
 Hi, @vbanthia, @sorccu, 
I just wanted to vote for approach offered by @vbanthia, and I think providing API to lock/unlock (maybe lock/unlock are not best words cuz it causes mess with screen locking) - is more or less simple but very useful step in this path to automation, because it makes stf easy-integrable in existing automated testing environments
 @rseek 

lock/unlock can be changed with reserve/release. But lets wait for @sorccu  opinion, what he suggests.
 Thanks for the opinions. I will start working on it soon :).
 +1 . If someone is already working on this I'd be glad to help.
 :+1: 
 Well, I stopped in between. Writing my research and one of the approaches to implement this feature.

## Authentication
- Every request to stf-app unit (api provider) goes through [auth middleware](https://github.com/openstf/stf/blob/master/lib/units/app/middleware/auth.js) which checks for valid session-id. If your request does not have a session id, it will redirect it to auth server to create a new session. So you need to modify this auth middleware such that it can forward request even it has only [jwt token](https://github.com/openstf/stf/blob/master/lib/units/app/middleware/auth.js#L8)
- Next step will be to develop a feature which can provide users their jwt token. Best way would be to create a section in "Setting" tab and show users their jwt token like github.
- Next, you need to get rid of csrf checking for RESTful apis. One way to do is check csrf after RESTful api section.

After this you will be able to access all STF apis from any http client library using command line.

## Implement reserve/release endpoints
- You will be going to implements these new endpoints in [stf-app unit](https://github.com/openstf/stf/blob/master/lib/units/app/index.js)
- For this just mimic the [websocket unit](https://github.com/openstf/stf/blob/master/lib/units/websocket/index.js) and do the same things what websocket unit does when it gets [reserve](https://github.com/openstf/stf/blob/master/lib/units/websocket/index.js#L614-L631) and [release](https://github.com/openstf/stf/blob/master/lib/units/websocket/index.js#L632-L643) messages. 
- You need to add app side push sockets and push group.join and group.kick messages to processor and inform all the websocket subscriber about the event so that people who are using web browser can also be updated.
- For remote debugging you need to send `connect.start` message to server and get remote debug url.

## Implement client

Last part being implement a good stf command line client which can use these endpoints easily.

I hope this will help.
 I recently found out about [Square's Spoon](http://square.github.io/spoon/) tool, which would be a nice add-on for STF. I also saw that @sorccu made some of contribs there, so he's aware of the project at least. I don't think we should re-invent the wheel and use what's already available, any thoughts?
 > you can use the preliminary UI for the access tokens in res/app/settings/keys/access-tokens

That's great. One less task to do.
 Good conversation. I had to read this issue first.
I'm making similar requirements on "booking" PR. Actually The feature aimed to combinate other Test Automation tool.
This is deferent approach. Very interesting.
 Hi @vbanthia i wanted to run Espresso test test are you planning to do that soon as well ?
And Are you planning to use spoon as well?
Thanks and Regards,
 Yashasvi.
 Thanks @vbanthia  :) for replying so soon,
i will try running Espresso test. I wanted to edit code and add few UI and Functionality to run test.
Basic Idea:
1) Select Devices to run tests ,
2) Upload test Apk and ,
3) run test through a UI Button in web interface,
4) And display the execution of the devices selected 

Also,
I am new to this can you please tell me how to run the code after editing.

Thanks,
Yashasvi.
 Using Jenkins , I was able to set up a fully functional Test Automation structure and running it successfully now .
Here is how I am doing this : 
1. Run jenkins in a docker container. Here is the link to docker file. 
https://github.com/PrabhatPandey/Jenkins-docker
2.Run STF in a docker container. 
3.Occupy all the devices for automation in jenkins container through STF-apis ie. remote connect.
4. Use Spoon runner in Jenkins to create the reports of the automation results. 
"java -jar spoon-runner-1.3.1-jar-with-dependencies.jar \
    --apk ExampleApp-debug.apk \
    --test-apk ExampleApp-debug-androidTest-unaligned.apk --grant-all"












 @PrabhatPandey thank you for you solution  I would like to ask how fast are you able to execute tests  on real devices ? With Appium it Took me around 1 minute to init() real device. My boss expects around 15 seconds. I cant try it I am out of space on this linux machine :dancing_men:  @trix0 I allocate the devices using open-stf apis. Allocation happens instantly. After allocation is done ie 'adb devices' shows you the list of devices then it's pretty straightforward from there.   i don't want the auth module , and i tried to disable it , but i don't have req.user in js
is it possible to disable auth module?
  I'm trying to use STF with a tablet Asus Nexus 7 with Android 4.2.2.
The device is controllable but the preview is grey and always grey.
See this attachment: 
![capture d ecran 2015-07-27 a 17 49 50](https://cloud.githubusercontent.com/assets/13520796/8910896/a9adc28c-3489-11e5-8e6e-81fa957c3e79.png)
 It seems that there're no error in chrome.

![capture d ecran 2015-07-27 a 18 08 52](https://cloud.githubusercontent.com/assets/13520796/8911097/a8a4cb64-348a-11e5-8687-77381c760cd4.png)

The same in the Node Terminal that launch "stf local".
 @sorccu This is the same issue that I'm seeing that I mentioned in #31 .
![screen shot 2015-07-26 at 21 37 35](https://cloud.githubusercontent.com/assets/1370580/8918962/9849c810-3470-11e5-9dc4-a6f8578e9f2a.png)
 @sorccu Here is the output: https://gist.github.com/jonalmeida/38ea576eeba5dedc4c43

It includes the the shutdown logging as well right after startup.
 Here are logs with some interaction that shows up on the device, but I still can't see anything here. (This is via `stf local` only though): https://gist.github.com/jonalmeida/278f7b8eef52913886e2
 @sorccu Here are logs with the min and max ports set on a Galaxy Nexus (which shows the grey) followed by a Nexus 5 (which works fine): https://gist.github.com/jonalmeida/86fb7e11cc0eb7d97065
  Hello guys,

I'm investigating STF and I'm facing a limitation:
On the real device, i've a "system" button that display all the currently running application. On this "task manager" view, I can kill some process. On the control screen of STF, there are 3 buttons: "Menu", "Home" and "Back". On my real device, there are 3 buttons: "System", "Home" and "Back".

How to simulate a click on this "System" button ?
How to replace the "Menu" button by a "System" button ?
Does exist a way to display the "task manager" view with STF ?
What is the Shell command to kill an Android process ?

Thanks for your answers.
 You can do this from a shell, by first doing:
1. `adb connect [ip_given_in_STF]`.
2. You can grep through to find the pid of your app: `ps | grep 'com.example'`
3. Kill the app using the pid you find from there: `kill [pid_goes_here]`

Side note: If you wanted to uninstall your app, you can do that from adb as well: `adb uninstall com.example`
  Hello,
I would like to repport a bug i'm facing with the Sony Xperia S on Android 4.0.4:
I control the Smartphone without any problem. This real device has a material camera button. A long press on it launch the camera application.

On the Advanced Tab of STF, a clic on the Camera button has no effect. A Long clic neither.

In addition, if on the device I launch the camera, the screen is black (but all controls are okay). See this attachment:
![capture d ecran 2015-07-27 a 16 17 16](https://cloud.githubusercontent.com/assets/13520796/8908375/210625ee-347c-11e5-8e0a-bbf9b9453e68.png)
  hi, my computer doesn't has systemd and it uses init , can stf deploy on my computer?
and my computer only has one port for public net and the port is 80, how can i deploy stf on my computer and visit it from the public net?
thank you for this wonderful project , it helps me a lot
  Android 4.4+ have a built-in support for screen recording:

```
shell@mako:/ $ screenrecord --help                                             
Usage: screenrecord [options] <filename>

Android screenrecord v1.2.  Records the device's display to a .mp4 file.

Options:
--size WIDTHxHEIGHT
    Set the video size, e.g. "1280x720".  Default is the device's main
    display resolution (if supported), 1280x720 if not.  For best results,
    use a size supported by the AVC encoder.
--bit-rate RATE
    Set the video bit rate, in bits per second.  Value may be specified as
    bits or megabits, e.g. '4000000' is equivalent to '4M'.  Default 4Mbps.
--bugreport
    Add additional information, such as a timestamp overlay, that is helpful
    in videos captured to illustrate bugs.
--time-limit TIME
    Set the maximum recording time, in seconds.  Default / maximum is 180.
--verbose
    Display interesting information on stdout.
--help
    Show this message.

Recording continues until Ctrl-C is hit or the time limit is reached.
```
 I usually record some app behaviour with this command. I am looking for something like the screenshots feature but for taking screencasts. 
 ![image](https://cloud.githubusercontent.com/assets/3281689/9869020/f14f56d8-5bb1-11e5-9af3-f09ab224d5ee.png)

I make a continous screenshot button. I call it screen capture. If you feel that useful, I will make a pr or just ignore me.
 Pull requested.
 it would be nice to record it to a video format or a gif
 Any update on this feature ? I feel it would really help exchange between developer <-> QA.
 Today, I think use `ffmpeg` to convert images to video is a better way.
  I have a Galaxy Nexus connected to an Ubuntu machine which doesn't seem to show the screen sharing at all (all I see is grey). Everything else about the device connect to OpenSTF, i.e. I can interact with the device with my mouse on the grey screen and I see it on my phone, adb connect, etc.

I realize this isn't much details to work on, but please let know what other details I can provide to help debug this.
 > Which browser (and version) are you using?
- Chrome: 44.0.2403.89 beta (64-bit)
- Firefox Dev Edition: 41.0a2 (2015-07-18)

> Which version of Android is your Galaxy Nexus running?
- Stock Android, 4.3
- Baseband I9250XXLJ1

> The exact command you use to run STF (e.g. just stf local)
- `stf local`
- `stf local  --public-ip [ip_address_here]`

> The exact URL you use do access STF (e.g. just http://localhost:7100)
- If using plain "local": `http://localhost:7100/#!/control/014691490A00D006`
- With "public-ip": `http://[ip_used_in_command]:7100/#!/control/[device_id]`

Yes, I forgot to mention that this happens with only two devices I've tried (Galaxy Nexus and Asus Transformer TF-101) I don't have the details on the Transformer on me at the moment; will update later.

With a Nexus 5 & Nexus 9, up-to-date on Lollipop, there are no issues as well as an Asus Transformer Prime.
 Referencing the comments in #36 , I wonder if there is a dependency on my setup that's missing..

I'll try using the docker container and see how that fairs, but I'm expecting the same results.
 > Can I ask what specs you have on your computer (both the STF app server and your local client if different)?

Right now, I'm testing this all locally on the same server machine which is a fresh install of Ubuntu 15.04.
Processor: Intel Core i7 CPU 860 @ 2.80GHz
Graphics: GeForce GTS 240 (default nouveau drivers)

> Does the network panel show anything when the screen is grey?

There is some network i/o going on (comparing it to a working Nexus 5), but there isn't any change when interacting with the device while I can see the interactions taking place irl.

> The full network log from before you control the device to you seeing the grey screen for the first time. 

Here are the HAR logs with and without interaction with the device: https://www.dropbox.com/s/36zrssykcckvgn3/HAR%20logs.zip?dl=0

> If there's nothing in there either, we may have to resort to screen sharing if somebody's willing to let me do that.

I'd be happy to help via screen sharing, if we can't figure out the issue otherwise!
 is there any relation with Serial Number of the phone? Because i have same problem and I found something weird about Serial Number, it's 0123456789ABCDEF
 @gunta no, my another devices has different unique serial number. I don't know, is serial number is an unique id for android device? Oh ya for this issue, i found this on log:

INF/device:plugins:touch 12533 [0123456789ABCDEF] Launching screen service
INF/device:plugins:touch 12533 [0123456789ABCDEF] Connecting to minitouch service
INF/device:plugins:touch 12533 [0123456789ABCDEF] minitouch says: "Note: device /dev/input/mouse0 is not supported by libevdev"
INF/device:plugins:touch 12533 [0123456789ABCDEF] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 12533 [0123456789ABCDEF] minitouch says: "Note: type A device reports a max value of 0 for ABS_MT_TRACKING_ID. This means that the device is most likely reporting incorrect information. Guessing 9."

is there any relation about this issue?
 @swarawan I don't think there's any relation, but this might be a separate issue entirely. The serial for my device where I see this issue is correctly identified.
 @sorccu my team found that websocket is still direct to localhost even access from different ip (using --public-ip). what should i do then?

![11pasted_image_at_2015_08_07_01_02_pm copy](https://cloud.githubusercontent.com/assets/998286/9129738/c560579a-3d05-11e5-9faf-c3a3ac16e43a.png)
 following doc, first install the requirements and its dependencies
`brew install rethinkdb graphicsmagick zeromq protobuf pkg-config`
then setting up ADB. Launch STF:
Start rethinkdb using `rethinkdb`
Start STF using `stf local --public-ip 172.17.2.130` and for local `stf local`

is there something i missed?
 oh ya, i forgot to write on my last comment, i'd installed with `npm install -g stf` . it shown version 1.0.9
 v0.12.7
is there nothing i should to edit somewhere?
 @sorccu were you able to look into this issue? I'd be happy to skype with you to help solve this.
 @swarawan ，
Our problems are the same，can you solve it ?
 @jonalmeida ,
Our problems are the same，can you solve it ?
 Hi everyone!

I've been having the same issue but only in Google Chrome (Version 50.0.2661.75 m, which is the latest as of now) and in Opera. Whereas in Firefox the app is working just alright! I suspect there is a bug going on with this latest version of Chrome. Some colleagues with v. 49 could access STF successfully.

Here's a screenshot of the console output just to share with you all:
![chrome console errors](https://cloud.githubusercontent.com/assets/14092665/14676617/a2d3fe30-06e4-11e6-93a3-3bd0f8bf5b66.PNG)

I'll be taking a further look on this issue, to see if I can come up with something. Please, let me know if you have encountered the same issue.

Cheers!
 Seems that the following line did the trick :) could also work for other people with similar issues:

`sudo apt-get update && sudo apt-get upgrade`

Thanks for the ideas and support.
  Would that be possible? Currently running raspbian, but I get hit with a lot of installation and configuration. 

Do you have any guides or tips? 
 Awesome! This might come in handy:
- https://iojs.org/en/index.html
- http://www.rethinkdb.com/docs/install/ubuntu/
 I have successfully running on RPi 2 (archlinux) also with RethinkDB. And it works, but only tested with 6 devices.
Note that RethinkDB have an [experimental support on ARM platforms](http://rethinkdb.com/docs/install/) and you may need to compile on your own.

Thanks for this great project! :wink: 
 Didn't try with docker, but it would be great if it works!
 @arcxyz could you give me a short guide on how you set up the install?
 Taking a [clean Archlinux install](http://archlinuxarm.org/platforms/armv7/broadcom/raspberry-pi-2#qt-platform_tabs-ui-tabs2) as a starting point, run these commands (extracted from our Pi history):

```
# System Upgrade
pacman -Syu
# STF deps:
pacman -S android-tools nodejs npm graphicsmagick zeromq pkg-config 
# RethinkDB build dependencies
pacman -S base-devel # Select ALL
pacman -S libsodium libpgm protobuf protobuf-c libboost boost boost-libs python2 gperftools python2-pip
# Download rethinkDB sources
curl -O http://download.rethinkdb.com/dist/rethinkdb-2.0.4.tgz
tar zxvf rethinkdb-2.0.4.tgz
 # Change default python version 
ln -sf /usr/bin/python2.7 /usr/bin/python
# Configure and build! (it may take hours on Pi)
cd rethinkdb-2.0.4
./configure --with-system-malloc --allow-fetch
make
make install
# finally install stf
npm install -g stf
```

Let me know if you get errors compiling rethinkDB
 Anyone managed to get openstf working on raspbian?
 I have some websocket connection issues. The video stream for devices is blank gray, but I'm pretty sure it's a problem in my network, still investigating. Apart from that, my pi running raspbian is working. Screenshots, remote control (again, without visible video), uploading apps, everything seems good. 

I manually installed raspbian versions of adb and docker, and used the openstf/arm7hf-stf image. Since I am still working on network issues, I haven't stress or stability tested yet.

Important note: The pi is only running the stf-provider service file described in the deployment section, meaning that all the heavy lifting is being done on a beefy server in the cloud. I have no idea if it could handle running everything on its own.
 My raspberry Pi 2 lost device and reconnected every 2 or 3 mins. Does anyone use raspberry could last long time? I am wandering if all the Raspberry pi have the same problem. Thanks.
 Hi sorccu,
Thank you for your advice. I am considering using ODROID-XU4 instead of Raspberry Pi. 
 @sorccu 
One more shot question, which USB hub are you using with ODROID-XU4? Is this one Plugable's USB 2.0 7 Port Hub with 60W Power Adapter?
Thanks. 
 @sorccu 
Thank you for your advice :)
 Running on Raspberry PI 2 with Raspbian, STF not showing any devices. 

I'm running everything on it. Got docker, ADB , rethinkdb all working on host.  Tried docker image. Stf loads and can access web page. But when it loads, I see following message while loading

INF/provider 36 [_] Sending output to "tcp://127.0.0.1:7116"
INF/provider 36 [_] Receiving input from "tcp://127.0.0.1:7114"
Unhandled rejection Error: spawn adb ENOENT
    at exports._errnoException (util.js:746:11)
    at Process.ChildProcess._handle.onexit (child_process.js:1053:32)
    at child_process.js:1144:20
    at process._tickCallback (node.js:355:11)
INF/storage:temp 56 [*] Listening on port 7102
 @sorccu 
I am using the Odroid XU4 for about a week. The stability of USB port is still not very good. It often reconnect about 5 to 6 hour with 3 devices connecting. Have you tested ODroid already? Could you give me some advice about enhance the stability. Thanks. 
 Thank you for your help. I have tried this method but not work for my ODroid. I have many Odroid all have the same problem. Finally we choose USB HUB 2.0 to enhance the stability.
 I have Open STF running on Raspbian on a Raspberry Pi 3. Still polishing the install and run process. Looking forward to helping contribute any results from my own farm to STF.
 Hi Will (capricornuscipher),
May you publish your installation procedure of STF on Raspbian/PI3 ?
Thanks.
 @capricornuscipher hiho :) Any progress?
 @sorccu adb for arm can be download from here https://github.com/NetEaseGame/AutomatorX/releases/tag/1.0.12
 @denis99999 @pwicherski I am working on some guides and will start publishing soon. I have it working on my RPi3. I've ran it both over Ethernet and WiFi. For now I'm have the RethinkDB for it running on it. I'm also currently attempting to create a WiFi hotspot from the Raspberry Pi for the smartphones. I'm also using python to control the phones over the IP address adb, but for now it's manually set up. I'm considering adding a python API to openSTF. Any suggestions are welcome. Hi @pwicherski<https://github.com/pwicherski>, thank you very much for your answer, since my original request I also progress a lot in this domain and I see we are working exactly on the same issues. From my side I develop a CLI to control in an automatic way devices either in WIFI or usb.


@denis99999<https://github.com/denis99999> @pwicherski<https://github.com/pwicherski> I am working on some guides and will start publishing soon. I have it working on my RPi3. I've ran it both over Ethernet and WiFi. For now I'm have the RethinkDB for it running on it. I'm also currently attempting to create a WiFi hotspot from the Raspberry Pi for the smartphones. I'm also using python to control the phones over the IP address adb, but for now it's manually set up. I'm considering adding a python API to openSTF. Any suggestions are welcome.

—
You are receiving this because you were mentioned.
Reply to this email directly, view it on GitHub<https://github.com/openstf/stf/issues/30#issuecomment-275942509>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AVtkCh9_-FMhIrs3s2t7dHYp4I5ZOp3jks5rXPNkgaJpZM4FfynM>.

_________________________________________________________________________________________________________________________

Ce message et ses pieces jointes peuvent contenir des informations confidentielles ou privilegiees et ne doivent donc
pas etre diffuses, exploites ou copies sans autorisation. Si vous avez recu ce message par erreur, veuillez le signaler
a l'expediteur et le detruire ainsi que les pieces jointes. Les messages electroniques etant susceptibles d'alteration,
Orange decline toute responsabilite si ce message a ete altere, deforme ou falsifie. Merci.

This message and its attachments may contain confidential or privileged information that may be protected by law;
they should not be distributed, used or copied without authorisation.
If you have received this email in error, please notify the sender and delete this message and its attachments.
As emails may be altered, Orange is not liable for messages that have been modified, changed or falsified.
Thank you.

 --edited--

After 8 hours of reading Im understanding docker and stf a little better .... 

I re-flashed my xu4 and started over with docker - I will post something on my own thread when I get absolutely stuck.

Thanks

   +1
  So, when navigating to STF, you get redirected to your localhost.

However, if you would want to connect from you iPhone that won't work, because it will just keep looking for the localhost of the phone, not from the other computer running STF. Also, when using a proxy, this won't work.

By just removing the redirect, this issue would be fixed (I guess?). 
 Awesome, thanks for the quick reply! It indeed fixes the issue.

This also enables us to run STF from a rasbperry pi somewhere else in the office, awesome job!
  Really great software! Thanks very much! :+1: 

There is a bit crazy idea - if it is ever possible - to redirect sound input/output to browser?
Might be useful for testing.

What do you think?

Also then one can finally leave phone at home and make calls from browser :-)
 Hello, is there any update for this issue?
Actually I need to check the sound condition for music streaming.
 Hi, do you have an update on this feature since last then? I am more than happy to pay for this feature if it is available. Thanks We have a prototype for that but it requires an extra cable in the
headphone jack (or root)

Could you give me some detail information about the cable, and how it works? @sorccu,  would you please provide some details about that analog audio --> USB converter ? would you kindly share a link to a similar device that I can acquire? Many thanks. The phone connected the PC with a 3mm audio cable, and the service running on the PC received the PCM data from the usb handle, then you can transform the PCM data to web format.

Below is my demo code:

package main

import (
    "fmt"
    // "io/ioutil"
    "encoding/binary"
    "os"
    "time"

    "github.com/google/gousb"
    "github.com/youpy/go-wav"
    "gopkg.in/hraban/opus.v2"
)

var (
    CaptureNum = 500

    SampleRate = 48000
    ChannelNum = 1
    SampleBits = 16

    OpusFrameSize = 480
)

func writeUSBDataToSamples(usbData []byte) []wav.Sample {
    samples := make([]wav.Sample, 0)
    for i := 0; i < len(usbData); i += 2 {
        sample := wav.Sample{}
        sample.Values[0] = int(usbData[i])
        sample.Values[0] = int(usbData[i+1])
        samples = append(samples, sample)
    }
    return samples
}

func convertBytesToInt16(inputData []byte) []int16 {
    outputData := make([]int16, 0)
    inputDataLength := len(inputData)
    for index := 0; index < inputDataLength-1; index += 2 {
        outputData = append(outputData, int16(binary.LittleEndian.Uint16(inputData[index:index+2])))
    }
    return outputData
}

func main() {

    var readBuffer = make([]byte, 4096)

    vid, pid := gousb.ID(0x0d8c), gousb.ID(0x0014)

    context := gousb.NewContext()
    defer context.Close()

    device, err := context.OpenDeviceWithVIDPID(vid, pid)
    if err != nil {
        fmt.Println(err)
    }

    device.SetAutoDetach(true)

    configNum, _ := device.ActiveConfigNum()
    config, _ := device.Config(configNum)

    intf, err := config.Interface(2, 1)
    if err != nil {
        fmt.Println("config.Interface err: %s", err.Error())
    }

    endPoint, err := intf.InEndpoint(2)
    if err != nil {
        fmt.Println(err)
    }

    pcmBytesBuffer := make([]byte, 0)

    beginTime := time.Now()
    for i := 0; i <= CaptureNum; i++ {
        readLen, err := endPoint.Read(readBuffer)
        if err != nil {
            fmt.Println("Read readBuffer err: %s", err.Error())
        } else {
            // fmt.Println("readLen ", readLen)
            pcmBytesBuffer = append(pcmBytesBuffer, readBuffer[:readLen]...)
            if err != nil {
                fmt.Println("Write err: %s", err.Error())
            }
        }
        // time.Sleep(time.Millisecond * 10)
    }

    duration := time.Now().Sub(beginTime).Seconds()

    fmt.Println("pcmBytesBuffer len: ", len(pcmBytesBuffer))
    fmt.Println("duration: ", duration)

    fwav, _ := os.OpenFile("output.wav", os.O_RDWR|os.O_CREATE, 0777)
    writer := wav.NewWriter(fwav, uint32(len(pcmBytesBuffer)), uint16(ChannelNum), uint32(SampleRate), uint16(SampleBits))
    writer.Write(pcmBytesBuffer)
    fwav.Close()

    fpcm, _ := os.OpenFile("output.pcm", os.O_RDWR|os.O_CREATE, 0777)
    fpcm.Write(pcmBytesBuffer)
    fpcm.Close()

    pcmInt16Data := convertBytesToInt16(pcmBytesBuffer)
    enc, err := opus.NewEncoder(SampleRate, ChannelNum, opus.AppVoIP)
    if err != nil {
        fmt.Println("opus.NewEncoder err: ", err.Error())
    }

    fmt.Println("pcmInt16Data length ", len(pcmInt16Data))

    opusOutput := make([]byte, 0)
    opusData := make([]byte, 4096)

    encodedNumSum := 0
    for encodedNumSum+OpusFrameSize < len(pcmInt16Data) {
        encodedNum, err := enc.Encode(pcmInt16Data[encodedNumSum:(encodedNumSum+OpusFrameSize)], opusData)
        if err != nil {
            fmt.Println("enc.Encode err ", err.Error())
            break
        }
        fmt.Println("encodedNum ", encodedNum)
        opusOutput = append(opusOutput, opusData[:encodedNum]...)
        encodedNumSum += OpusFrameSize
    }
    fmt.Println("opusOutput length ", len(opusOutput))
    fopus, _ := os.OpenFile("output.opus", os.O_RDWR|os.O_CREATE, 0777)
    fopus.Write(opusOutput)
    fopus.Close()

}

   @likezjuisee  Do you have a GitHub project that sets out relatively complete solutions and ideas?
（有建立GitHub 项目，阐述相对完整的解决思路和方案吗？）  <img width="894" alt="screen shot 2015-07-22 at 11 50 50 pm" src="https://cloud.githubusercontent.com/assets/1861729/8833487/8c7b78d2-30cc-11e5-88f8-2f5ecb49e01e.png">
  pkg -config is already installed and its version is pkg-config-0.28
 When I am running the "which -a pkg-config" its not returning anything.

Can you throw some light on how to set the path for this "pkg-config". As my understanding when i am installing through brew it should set the path also.
 Following is the content of $PATH

/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/git/bin
 Can you suggest me which is the minimal version of the node i need to install? Currently I have 0.10.33. My other project is dependent on this node version.
 I checked in ReadMe its specified >=0.12. I will upgrade my node and ry out this and update you. 

@sorccu Thanks for your support. 
  Hello!
Thank you for awesome software!

Unfortunately I faced some problem with taking screenshots, I hope you can help me.
When I try to take a screenshot, I see an icon which shows screenshot image is not available:
![torn_minicap](https://cloud.githubusercontent.com/assets/12827469/8823163/26704b46-3084-11e5-93b0-372b8676a4a5.png)
When I try to click this image, I see following error message in a new browser tab:
`The image "http://<my-ip>:7100/s/image/5aac3806-8ba7-4f29-bc49-1bcc1f28dede/<deviceName>.jpg" cannot be displayed because it contains errors.`

I tried to download image by url, and noticed image is just empty file(0 bytes size).

Stf is launched in "local" mode on my ubuntu 14.04 desktop like this:
`stf local --public-ip <my-ip>`
[there is no X server running on desktop, if it is important]
I am trying to take screenshot from my laptop

So, in console log I noticed following messages:
`INF/device:plugins:screen:capture 25422 [<deviceName>] Capturing screenshot
INF/storage:temp 25341 [*] Uploaded "<deviceName>.jpg" to "/tmp/upload_04db85c0a0bff470298192dcaffd7049"
INF/device:support:storage 25422 [<deviceName>] Uploaded to "/s/image/5aac3806-8ba7-4f29-bc49-1bcc1f28dede/<deviceName>.jpg"
`

I checked the file `/tmp/upload_04db85c0a0bff470298192dcaffd7049` and found my screenshot. 
 Thank you for your answer, the problem really was with GraphicsMagick.

Originally I downloaded it from their official site and built from source with `make; make install`.
(Cause in your doc there is a link to their site ;))

But now I installed it from ubuntu repository and uninstalled version from official site and now everything work fine.

Thank you again, and sorry for dumb questions :)
  I can take screenshots and see them.
They are being saved in /var/folders/...
But when I change tabs from screenshot to any other tab and come back to screenshot they are gone from screenshots tab(but they are still saved on disk at /var/folders/...).
 @sorccu 
Have you guys implemented this feature and it is not working? Or you have just skipped the feature?
Can you point me in the direction where have you written the code for the same?
 @sorccu Thanks found it. By state persistence I assume you are talking about client side tab's state. But shouldn't we save the screenshots for a device in db itself so that in the next session user can see his/her screenshots?
 Lost my js chops a few years back. Don't wanna pollute your code. Anyways, I will discuss with my js friends who might pick this if time allows.
Thanks :)
  ![bug](https://cloud.githubusercontent.com/assets/13414843/8785019/79afa4ce-2f57-11e5-966d-c9f2179ac1d9.png)  

I'm a rookie and I don't know what's wrong. Wish you could tell me how to fix it. 
Thank you.
 ![2](https://cloud.githubusercontent.com/assets/13414843/8785156/506c352c-2f58-11e5-80fe-6ff3b442c195.png)
  I had to install pkg-config to get it to work:
$ brew install pkg-config
Perhaps update your documentation.  You can close this as non-issue of course.
 +1
 Another OSX installation failure when doing `npm install -g stf` is this:  

npm ERR! Darwin 14.4.0
npm ERR! argv "node" "/usr/local/bin/npm" "install" "-g" "stf"
npm ERR! node v0.12.0
npm ERR! npm  v2.7.1
npm ERR! path /usr/local/lib/node_modules/stf/node_modules/stf-wiki
npm ERR! code ENOTEMPTY
npm ERR! errno -66
npm ERR! ENOTEMPTY, rmdir '/usr/local/lib/node_modules/stf/node_modules/stf-wiki'
npm ERR!  

npm ERR! If you need help, you may report this error at:
npm ERR!     https://github.com/npm/npm/issues
npm ERR! error rolling back Error: ENOTEMPTY, rmdir '/usr/local/lib/node_modules/stf/node_modules/stf-wiki'
npm ERR! error rolling back     at Error (native)
npm ERR! error rolling back  { [Error: ENOTEMPTY, rmdir '/usr/local/lib/node_modules/stf/node_modules/stf-wiki']
npm ERR! error rolling back   errno: -66,
npm ERR! error rolling back   code: 'ENOTEMPTY',
npm ERR! error rolling back   path: '/usr/local/lib/node_modules/stf/node_modules/stf-wiki' }
 `brew install node`
On Jul 20, 2015 6:13 PM, "Simo Kinnunen" notifications@github.com wrote:

> @nasahapps https://github.com/nasahapps Can I ask how you installed
> node? Looks to me like you probably used the official installer, but I'm
> asking just to be sure.
> 
> —
> Reply to this email directly or view it on GitHub
> https://github.com/openstf/stf/issues/17#issuecomment-123120247.
 Thanks.  And bada$$ software BTW
  First STF working Great if we connect device via USB.

I was trying to connect device to adb with wifi

```
 adb tcpip 5555
adb connect mobile-ip:5555
```

But now adb show wifi connected device on `adb devices` command but stf display that device as disconnected.
 Figure it out have to pass --allow-remote :)
 hello. my goal is to connect openstf with remote phones via ssh tunnel.

i was trying to get openstf to connect to my android phones via ssh port-forward. basically my phone is connected to a wifi, adb over wifi is enabled, and i just forward the port 5555 to the machine running openstf. i can do "adb connect localhost:5555" and even use "adb shell" and do all the goodies. its not even that slow over ssh, its ok. 

i have been trying to make this work for the last 3 days now, with ubuntu 14 and 16, on a VM, on a physical machine, but no luck. i keep getting the same error.

the error:
when i open localhost:7100 in the browser (chrome, firefox), i see the device, its model number, but as soon as i click on it, it will open the UI and a bit later a dialog pops up "Disconnected. Error. Try to reconnect"

i have tried really everything now. 2 different phones. 2 different Ubuntu (14 and 16), also tried to forward 5037 adb server port instead of the phones 5555 port, but i keep getting the same results.

also tried adb v1.0.32 and v1.0.31

on the machine where openstf is installed, i forwarded 7100 to my laptop, such that i can use Chrome with localhost:7100 - is there any other ports i need to forward? openstf opens a ton of ports.

i dont know whats the problem. i can use "adb shell" just fine on the machine where openstf runs, but openstf just doesnt get booted, here are some logs:

```
stf local --allow-remote localhost:5555 

WRN/device:plugins:data 13734 [localhost:5555] Unable to find device data { serial: 'localhost:5555',
  platform: 'Android',
  manufacturer: 'LGE',
  operator: 'Boost Mobile',
  model: 'LG-LS720',
  version: '4.1.2',
  abi: 'armeabi-v7a',
  sdk: '16',
  product: 'fx3s_spr_us',
  display: 
   { id: 0,
     width: 480,
     height: 800,
     xdpi: 217.71,
     ydpi: 216.17,
     size: 4.31,
     density: 1.5,
     fps: 60,
     secure: false,
     rotation: 0,
     url: 'ws://192.99.10.45:7400' },
  phone: { imei: '35300606087232', network: 'UNKNOWN' } }
INF/device:plugins:touch 13734 [localhost:5555] Touch origin is top left
INF/device:plugins:touch 13734 [localhost:5555] Requesting touch consumer to start
INF/device:plugins:touch 13734 [localhost:5555] Launching screen service
INF/device:plugins:touch 13734 [localhost:5555] Connecting to minitouch service
INF/device:plugins:touch 13734 [localhost:5555] minitouch says: "Note: device /dev/input/mice is not supported by libevdev"
INF/device:plugins:touch 13734 [localhost:5555] minitouch says: "Type B touch device lge_synaptics_touch (960x1600 with 5 contacts) detected on /dev/input/event0 (score 1100)"
INF/device:plugins:touch 13734 [localhost:5555] Reading minitouch banner
INF/device:plugins:vnc 13734 [localhost:5555] Starting VNC server on port 7402
INF/device:plugins:browser 13734 [localhost:5555] Loading browser list
INF/device:plugins:touch 13734 [localhost:5555] minitouch says: "Connection established"
INF/device:plugins:browser 13734 [localhost:5555] Updating browser list
INF/device:plugins:mute 13734 [localhost:5555] Will not mute master volume during use
INF/provider 13604 [*] Providing 0 of 1 device(s); waiting for "localhost:5555"
INF/device:plugins:forward 13734 [localhost:5555] Launching reverse port forwarding service
INF/device:plugins:forward 13734 [localhost:5555] Connecting to reverse port forwarding service
INF/device:plugins:connect 13734 [localhost:5555] Listening on port 7401
INF/device 13734 [localhost:5555] Fully operational
INF/provider 13604 [*] Providing all 1 device(s)
```

![openstf-disconnected](https://cloud.githubusercontent.com/assets/7329265/16357344/ee6ef92e-3ac1-11e6-85f3-928f9952c406.JPG)

thank you!
 I got the same issue, any resolution yet?
 I got the same issue, any resolution?  What about a view only mode? So if you have automated testing you can view what is going on w/o control the device.
 There is already a feature in which you can see see device screen without other controls. 

Shift + click on device name which you want to use
 relatedly, the feature behind shift-click is amazing and I think it might deserve an icon for discoverability.

but afaict, @tonatiuhromero is asking for blocking input to the viewed device to make sure any accidental hovers wont actually be sent to the device and interfere with the automation.
 Great! that also will allow to see some logs per device?
 @gunta "a screen showing multiple devices at the same time in realtime." seems a very great idea, it will help user easily to monitor devices, how about the progress now?
or can you have some idea for how to implement this.

thanks
  It's crazy good. seriously. Kicks the pants off Chrome devtools screencasting. :)

That said there appears to be something blocking a solid 60fps.

Here's what i'm seeing after profiling the full STF app using `about:tracing`
### one frame of work

![image](https://cloud.githubusercontent.com/assets/39191/8643213/c664bf52-28e5-11e5-80c2-239c8d04b414.png)

the real thing here is that we're in the resourcefetcher for the blob for a long ass time. that's really what's slowing down this process. 

Here's the start: https://code.google.com/p/chromium/codesearch#chromium/src/third_party/WebKit/Source/core/fetch/ResourceFetcher.cpp&q=%22%20TRACE_EVENT_ASYNC_BEGIN2(%22blink.net%22,%20%22Resource%22%22&sq=package:chromium&type=cs&l=901
Here's the end: https://code.google.com/p/chromium/codesearch#chromium/src/third_party/WebKit/Source/core/fetch/ResourceFetcher.cpp&q=%22TRACE_EVENT_ASYNC_END0(%22blink.net%22,%20%22Resource%22%22&sq=package:chromium&type=cs&l=797

what's interesting to me is that if i poke inside of the browser process... it reports finishing loading the blob at about halfway: 
![image](https://cloud.githubusercontent.com/assets/39191/8643444/c35e7304-28e8-11e5-8a74-3b2cb511331c.png)
(the actual "requestcomplete" on the browserthread is offscreen in the screenshot)

it's possible whatever is handling the blob URL is unimplemented, but right now it appears to be taking longer than I'd expect. might be a chrome bug.
### sometimes I see a missed frame

![image](https://cloud.githubusercontent.com/assets/39191/8643223/f3087d96-28e5-11e5-8c32-efa8b936bb7b.png)

In these cases we do two image decodes and throw one of them away immediately. 
Not sure yet why this is happening.

<hr>

Last thing, I'd consider trying out requestAnimationFrame, only because it provides the scheduler with a lot more information on when you're ready to paint a frame. It has a low-latency mode so you can call rAF immediately once the image has loaded and you should get an instant paint.

<hr>

Here's the trace file i'm looking at: https://dl.dropboxusercontent.com/u/39519/temp/trace_stf-screencapture.json.gz
 yeah no worries and no rush. i was just curious. nice to see you now can generate frames fast enough that the browser has to catch up. a good problem to have!
 cc @dmurph as this appears to be a decent real-world stresstest  for blob performance in Chrome.
  Not sure if this is related yet.... (and will fork to separate issue if neccessary).

I'd love to see a better **integration with Remote Debugging**. 

The ideal might be something like this:
- For the attached device, you have a listing of the open tabs under the input field to launch a new one.
- You have an inspect button for them, clicking them opens devtools, probably embedded into STF instead of a separate window. So I still get the minicap + interaction of stf but with the full devtools over debugger protocol

about:inspect isn't very hackable however @auchenberg knows of some work that can access the same data. 
(edit: ah he's using adbkit in [adb-devtools-devices](https://github.com/auchenberg/adb-devtools-devices)  :) 

And I think it may be possible to them do a iframe pointing to `chrome-devtools://devtools/bundled/inspector.html?ws=localhost:2015`
 > might make it browser-dependent 

Aye, I think it'd work where there's support. I'm not totally clear on the remote debugging story for Chromium forks, but one would imagine it'd be similar. :)  

> Does this kind of interaction would be possible without requiring the security permissions of a Chrome extension?

It doesn't sound impossible to me yet, but let me confirm these ideas with some engineers on my team first. :) We'll find out how far my ideal is from reality.
 Pitching in here: I've written a little node module that findes devtools targets on a given device via ADB, and setups for the port forwarding, and lists the available remote debuggable tabs. It's early days, but you can see the flow here https://github.com/auchenberg/adb-devtools-devices

It's basically what `chrome://inspect`does for Android devices.
  It was only added to play store a few months ago so no big deal.

APK is `com.chrome.dev`
https://play.google.com/store/apps/details?id=com.chrome.dev

(btw Googlers have access to com.chrome.canary too, but it's not public yet)

Screenshot: 
![image](https://cloud.githubusercontent.com/assets/39191/8641359/ab9273bc-28c8-11e5-928b-df33529b2ea4.png)
 canary icon: https://lh5.ggpht.com/7tY2G7vVx_XEkNFdx--CxConvVstBCNWZ3vMs9pWcn63UPvdsUGSvvItB4Vyudf2ww=w300-rw
  I had two devices up and running. Tried to do adb connect on one of them. It seemed to work but then I had a failure.
Looks like it came from minicap but STF disconnected as a result.

Feel free to close, but figured you'd appreciate the report.

Cheers guys. (This project is blowing my mind)

```
INF/device:plugins:connect 80128 [T076001226] New remote ADB connection from ::ffff:127.0.0.1
INF/provider 80100 [*] Found device "localhost:7403" (offline)
INF/reaper 80099 [reaper001] Device "localhost:7403" is present
INF/provider 80100 [*] Registered device "localhost:7403"
INF/provider 80100 [*] Providing all 2 of 3 device(s); ignoring "localhost:7403"
INF/provider 80100 [*] Device "localhost:7403" is now "device" (was "offline")
INF/device:support:push 80167 [localhost:7403] Sending output to "tcp://127.0.0.1:7116"
INF/device 80167 [localhost:7403] Preparing device
INF/device:support:sub 80167 [localhost:7403] Receiving input from "tcp://127.0.0.1:7114"
INF/device:support:sub 80167 [localhost:7403] Subscribing to permanent channel "*ALL"
INF/device:support:properties 80167 [localhost:7403] Loading properties
INF/device:support:abi 80167 [localhost:7403] Supports ABIs armeabi-v7a, armeabi
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (jni/minicap/minicap.cpp:176) Received SIGTERM, stopping"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (jni/minicap/minicap.cpp:478) Closing client connection"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:280) Destroying virtual display"
WRN/device:plugins:screen:stream 80128 [T076001226] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 80128 [T076001226] Disconnecting from minicap service
INF/device:plugins:screen:stream 80128 [T076001226] Stopping minicap service
INF/device:plugins:screen:stream 80128 [T076001226] Launching screen service
INF/device:plugins:screen:stream 80128 [T076001226] Connecting to minicap service
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "PID: 19794"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: Using projection 720x1280@377x670/0"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:236) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:239) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:246) Creating virtual display"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:252) Creating buffer queue"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:257) Creating CPU consumer"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:261) Creating frame waiter"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:265) Publishing virtual display"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 2766852 bytes for JPG encoder"
INF/device:plugins:screen:stream 80128 [T076001226] Reading minicap banner
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (jni/minicap/minicap.cpp:423) New client connection"
WRN/device:plugins:screen:stream 80128 [T076001226] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 80128 [T076001226] Disconnecting from minicap service
INF/device:plugins:screen:stream 80128 [T076001226] Stopping minicap service
INF/device:plugins:screen:stream 80128 [T076001226] Launching screen service
INF/device:plugins:screen:stream 80128 [T076001226] Connecting to minicap service
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "PID: 19843"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: Using projection 720x1280@377x670/0"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:236) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:239) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:246) Creating virtual display"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:252) Creating buffer queue"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:257) Creating CPU consumer"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:261) Creating frame waiter"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:265) Publishing virtual display"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 2766852 bytes for JPG encoder"
INF/device:plugins:screen:stream 80128 [T076001226] Reading minicap banner
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (jni/minicap/minicap.cpp:423) New client connection"
WRN/device:plugins:screen:stream 80128 [T076001226] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 80128 [T076001226] Disconnecting from minicap service
INF/device:plugins:screen:stream 80128 [T076001226] Stopping minicap service
INF/device:plugins:screen:stream 80128 [T076001226] Launching screen service
INF/device:plugins:screen:stream 80128 [T076001226] Connecting to minicap service
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "PID: 19892"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: Using projection 720x1280@377x670/0"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:236) Creating SurfaceComposerClient"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:239) Performing SurfaceComposerClient init check"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:246) Creating virtual display"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:252) Creating buffer queue"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:257) Creating CPU consumer"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:261) Creating frame waiter"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (external/MY_minicap/src/minicap_22.cpp:265) Publishing virtual display"
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (jni/minicap/JpgEncoder.cpp:64) Allocating 2766852 bytes for JPG encoder"
INF/device:plugins:screen:stream 80128 [T076001226] Reading minicap banner
INF/device:plugins:screen:stream 80128 [T076001226] minicap says: "INFO: (jni/minicap/minicap.cpp:423) New client connection"
WRN/device:plugins:screen:stream 80128 [T076001226] Shell keeping minicap running ended unexpectedly
INF/device:plugins:screen:stream 80128 [T076001226] Disconnecting from minicap service
FTL/device:plugins:screen:stream 80128 [T076001226] Frame producer had an error Error: Failed more than 3 times in 10000ms
    at FrameProducer._failLimitExceeded (/Users/paulirish/.homebrew/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:219:26)
    at FailCounter.emit (/Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/eventemitter3/index.js:73:35)
    at FailCounter.inc (/Users/paulirish/.homebrew/lib/node_modules/stf/lib/util/failcounter.js:29:10)
    at FrameProducer._outputEnded (/Users/paulirish/.homebrew/lib/node_modules/stf/lib/units/device/plugins/screen/stream.js:212:24)
    at RiskyStream.emit (/Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/eventemitter3/index.js:71:35)
    at RiskyStream.<anonymous> (/Users/paulirish/.homebrew/lib/node_modules/stf/lib/util/riskystream.js:13:12)
    at Socket.emit (events.js:129:20)
    at _stream_readable.js:908:16
    at process._tickCallback (node.js:355:11)
FTL/util:lifecycle 80128 [T076001226] Shutting down due to fatal error

INF/provider 80100 [*] Lost device "localhost:7403" (device)
INF/provider 80100 [*] Shutting down device worker "localhost:7403"
INF/provider 80100 [*] Gracefully killing device worker "localhost:7403"
INF/provider 80100 [*] Cleaning up device worker "T076001226"
ERR/provider 80100 [*] Device worker "T076001226" died with code 1
INF/provider 80100 [*] Restarting device worker "T076001226"
FTL/device 80167 [localhost:7403] Setup had an error FailError: Failure: 'device not found'
    at /Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/adbkit/lib/adb/parser.js:226:31
From previous event:
    at Parser.readError (/Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/adbkit/lib/adb/parser.js:225:31)
    at /Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/adbkit/lib/adb/command/host/transport.js:25:35
From previous event:
    at HostTransportCommand.execute (/Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/adbkit/lib/adb/command/host/transport.js:19:39)
    at /Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/adbkit/lib/adb/client.js:257:47
From previous event:
    at Client.transport (/Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/adbkit/lib/adb/client.js:256:32)
    at Client.shell (/Users/paulirish/.homebrew/lib/node_modules/stf/node_modules/adbkit/lib/adb/client.js:262:19)
    at devutil.listPidsByComm (/Users/paulirish/.homebrew/lib/node_modules/stf/lib/util/devutil.js:69:14)
    at devutil.killProcsByComm (/Users/paulirish/.homebrew/lib/node_modules/stf/lib/util/devutil.js:106:18)
    at /Users/paulirish/.homebrew/lib/node_modules/stf/lib/util/devutil.js:122:26
From previous event:
    at /Users/paulirish/.homebrew/lib/node_modules/stf/lib/util/devutil.js:121:15
From previous event:
    at devutil.killProcsByComm (/Users/paulirish/.homebrew/lib/node_modules/stf/lib/util/devutil.js:107:6)
    at /Users/paulirish/.homebrew/lib/node_modules/stf/lib/util/devutil.js:122:26
    at processImmediate [as _immediateCallback] (timers.js:358:17)
FTL/util:lifecycle 80167 [localhost:7403] Shutting down due to fatal error
INF/provider 80100 [*] Device worker "localhost:7403" has retired
```
 I gotcha. Yeah definitely using 1.0.3
In my case I'm running it all on my macbookair. I'll have a moto x and nexus 5 connected by default, maybe more. But then if i `adb connect` for one of these devices, both connections end up failing.  

I see the LOCALHOST entry in chrome:inspect briefly but about 3 seconds later STF dumps it and the `connect` instance is gone from both chrome:inspect and "Disconnected" on the STF device list.  

> I'm currently thinking about perhaps disabling localhost sources from being set up automatically without some command line option

ah no!  that would make it super hard for me.  plus these days the chrome remote debug doesnt need an ADB lock on the devices. so it can share with STF.

I would recommend that for a localhost device, in the Remote Debug block you leave out the `adb connect` field and just say: "hey go to chrome://inspect".  That'd work for me.

>   built-in support for adb connect in Chrome. 

can you point me to the ticket?  

(speaking of performance, the perf of minicap is amazing.)
 Cool. Thanks for working this out with me. I gotta run but will give this a shot tomorrow.

Cheers!
  A couple of typos in the excellent deployment docs. It may be worth bumping the embedded version number to 1.0.3 or a generic tag such as latest or stable? Using the mock auth provider I'm not able to log in, get 302'd to /undefined. Thanks!
 I didn't run a dev environment on my machine, jumped straight to trying to run v1.0.0 on coreos with systemd and docker. The setup was fun, just need to point nginx to an instance of app that's more accessible than the one running in the container. Once I'm there if I'm still stuck I'll open up an issue. Thanks Simo!
  ForbiddenError: invalid csrf token
    at verifytoken (/app/node_modules/csurf/index.js:269:11)
    at csrf (/app/node_modules/csurf/index.js:97:7)
    at Layer.handle [as handle_request](/app/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/app/node_modules/express/lib/router/index.js:312:13)
    at /app/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/app/node_modules/express/lib/router/index.js:330:12)
    at next (/app/node_modules/express/lib/router/index.js:271:10)
    at jsonParser (/app/node_modules/body-parser/lib/types/json.js:107:37)
    at Layer.handle [as handle_request](/app/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/app/node_modules/express/lib/router/index.js:312:13)
    at /app/node_modules/express/lib/router/index.js:280:7
    at Function.process_params (/app/node_modules/express/lib/router/index.js:330:12)
    at next (/app/node_modules/express/lib/router/index.js:271:10)
    at /app/lib/units/app/middleware/auth.js:36:13
    at tryCatcher (/app/node_modules/bluebird/js/main/util.js:24:31)
    at Promise._settlePromiseFromHandler (/app/node_modules/bluebird/js/main/promise.js:489:31)

met this problems when i test it in my environment. adb works and the whole log was attached.

root@ubuntu:/app# adb devices
List of devices attached
00445e524f8c5907    device

INF/device:support:sub 545 [00445e524f8c5907] Subscribing to permanent channel "_ALL"
INF/device:support:properties 545 [00445e524f8c5907] Loading properties
INF/device:support:abi 545 [00445e524f8c5907] Supports ABIs armeabi-v7a, armeabi
INF/device:resources:service 545 [00445e524f8c5907] Checking whether we need to install STFService
INF/device:resources:service 545 [00445e524f8c5907] Running version check
INF/device:resources:service 545 [00445e524f8c5907] STFService up to date
INF/device:plugins:service 545 [00445e524f8c5907] Launching agent
INF/device:plugins:service 545 [00445e524f8c5907] Launching service
INF/device:plugins:service 545 [00445e524f8c5907] Agent says: "Listening on port 1090"
INF/device:plugins:service 545 [00445e524f8c5907] Agent says: "InputClient started"
INF/device:plugins:display 545 [00445e524f8c5907] Reading display info
INF/device:plugins:phone 545 [00445e524f8c5907] Fetching phone info
INF/device:plugins:identity 545 [00445e524f8c5907] Solving identity
INF/device:plugins:solo 545 [00445e524f8c5907] Subscribing to permanent channel "S+KScTlq18iysOfuoUm6iN5WyIc="
INF/device:plugins:screen:stream 545 [00445e524f8c5907] Starting WebSocket server on port 7400
INF/device:plugins:browser 545 [00445e524f8c5907] Loading browser list
INF/device:plugins:browser 545 [00445e524f8c5907] Updating browser list
WRN/device:plugins:data 545 [00445e524f8c5907] Unable to find device data { serial: '00445e524f8c5907',
  platform: 'Android',
  manufacturer: 'LGE',
  operator: null,
  model: 'Nexus 4',
  version: '5.0',
  abi: 'armeabi-v7a',
  sdk: '21',
  product: 'occam',
  display:
   { id: 0,
     width: 768,
     height: 1280,
     xdpi: 319.7900085449219,
     ydpi: 318.7449951171875,
     fps: 60,
     density: 2,
     rotation: 0,
     secure: true,
     size: 4.679082154320592,
     url: 'ws://localhost:7400' },
  phone: { imei: '353918051433593', network: 'UNKNOWN' } }
INF/device:plugins:touch 545 [00445e524f8c5907] Touch origin is top left
INF/device:plugins:touch 545 [00445e524f8c5907] Requesting touch consumer to start
INF/device:plugins:touch 545 [00445e524f8c5907] Launching screen service
INF/device:plugins:touch 545 [00445e524f8c5907] Connecting to minitouch service
INF/device:plugins:touch 545 [00445e524f8c5907] minitouch says: "Type B touch device touch_dev (1535x2559 with 10 contacts) detected on /dev/input/event2 (score 1100)"
INF/device:plugins:touch 545 [00445e524f8c5907] Reading minitouch banner
INF/device:plugins:touch 545 [00445e524f8c5907] minitouch says: "Connection established"
INF/device:plugins:forward 545 [00445e524f8c5907] Launching reverse port forwarding service
INF/device:plugins:forward 545 [00445e524f8c5907] Connecting to reverse port forwarding service
INF/device:plugins:connect 545 [00445e524f8c5907] Listening on port 7401
INF/device 545 [00445e524f8c5907] Fully operational
INF/provider 487 [_] Providing all 1 device(s)
 Hi Sorccu,

i used the docker images openstf/stf to run as below,

docker run -t -i --privileged -v /dev/bus/usb:/dev/bus/usb -u root -p 7100:7100 openstf/stf /bin/bash

then i installed the rethinkdb/adb then run rethinkdb/stf local.  after that using firefox to open localhost:7100.

then i can see a disconnecting issue but i am not sure why?

Liang
 Hi Sorccu,

it works well on a Mac environemnt (no docker), thanks so much for open source it. 

Liang
 met same problem when I login to stf page  Thank you for a great app! Immediately, we are using.

When you start with "$stf local" command, you can use in the http://localhost:7100, for example, start at IP address, such as 192.168.1.100, and we would like to access from other PC.

The start-up command was some experience, but the connection to the DB is becomes to "127.0.0.1:28015", it can not be started.
*"rethinkdb" is, "- bind all" you have to start it with the option.

In order to use to share the STF is allowed to access from other PC, but I want to start with IP address, Could you tell me how?
 Thanks for the quick reply!
A result, I were able to use without problems.
Thank you!
  The documentation in your `README` for relevant hardware is excellent! You might consider adding another section, with advice on the physical setup of the device farm.

For example: what exactly is shown in the photo at the top of the `README`, with the aluminum(?) slats holding the devices? My initial reaction was a rackmount system, but I would think that we would see holes in the vertical supports, and such holes do not appear in the photo.
 Tks for your help
 Hi @sorccu , 

There are some news about this topic or when will be released?

Regards
 Ok, thanks for you anwser.
 hi @sorccu,

Can you send to me more pics from your shelf?
I want to build a similar , but with the photos who are on your site is complicated to see the details of it.
How is that cell phones are stuck in the support?

Regards
