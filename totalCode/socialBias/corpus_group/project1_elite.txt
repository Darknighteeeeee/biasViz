  Sounds like a server issue.

Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Please see #2138.  Hi @liuqiyuan,

That looks correct. You can always print out the curl command to debug further.

```swift
let request = Alamofire.request("http://backend.com:8080/user", method: .get, parameters: parameters, encoding: JSONEncoding.default, headers: headers)
    .responseJSON { response in
        debugPrint(response)
    }

debugPrint(request)
```

If you continue to have issues, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Alamofire isn't doing anything here. What you're seeing is the debug printout of a Swift Dictionary, which is what you get when you print a `Result<Any>` from `responseJSON` when the JSON is a dictionary. The fact that the request was successful shows that the JSON came back properly.  @anishparajuli555 You've hit a rather prickly use case for us. Right now `validate()` is only intended for simple validation scenarios. As you've seen, it doesn't really work that well for validating something in the response data. In fact, that's a highly inefficient use of it, since the response data may then be decoded twice. At the moment I would suggest any validation you need to perform on the response data be done in a custom response serializer and not `validate`. In the future we'll be reevaluating `validate()`s capabilities and how it fits into Alamofire.  StackOverflow is the proper forum for this issue.  Thanks for the PR, but Alamofire is compatible with both Swift 3 and 4, so we don't need this setting. Also, in the future, please fill out the whole PR template. Thanks anyway!  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  I would suggest using a proxy tool like Charles Proxy to check what you're actually sending vs. what you're seeing in the server logs. We have extensive tests around this scenario so it's unlikely there's an issue within Alamofire. However, if your investigation does reveal an Alamofire bug, let us know and we can reopen this issue.  Thanks for the PR! Before we add another parameter encoding, can you point us to some documentation regarding this standard? To me it seems strange, but if it's already a standard I'd like to learn more.  
## What did you do?
I add Almofire to my project ,and call    
     Alamofire.request(<#T##url: URLConvertible##URLConvertible#>, method: <#T##HTTPMethod#>, parameters: <#T##Parameters?#>, encoding: <#T##ParameterEncoding#>, headers: <#T##HTTPHeaders?#>) and all correct after  I add  realm pod  
 "Extra  argument ''method" Call" error is appeared 
how to solve this problem ?

## Alamofire Environment

**Alamofire version:4.5
**Xcode version:8.2.1
**Swift version:3.1
**Platform(s) running Alamofire:**
**macOS version running Xcode: 10.12.5

  You don't seem to be using the `backgroundManager` you setup to actually download the file you want. Plus, for file downloads you should use the `download` API, not the `request` API. Also, be aware that Alamofire currently cancels all outstanding tasks when the manager is `deinit`d, which will happen if your app is killed in the background. If this occurs, you may want to set up your background downloads outside of Alamofire, as we don't currently handle that case well.  The `result` you get in the `multipartFormData` version of `upload` is not the result of the request but instead the result of the multipart encoding process, so it contains nothing about the network request yourself. If you want to detect the networking errors you need to do so in the `responseJSON` of the `upload` value you pull out of the `success` case.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the PR! However, this is, in fact, functionally different, as it will return the same queue for each QoS level, not generate a new one like the original code. Since the intent here is to let the system manage what queues it gives us, this would fundamentally alter the behavior of this API. For that reason we won't be merging it. Cheers! :beers:  Swift 4 is supported by Alamofire 4.5.  Thanks for the PR! However, before we merge, it would be a good idea to make this encoding a little more elegant, as empty username or password fields aren't usually the best behavior in some scenarios. Can you look into how cURL handles various types of auth and how `URLCredential` conveys them and see if you can come up with a more general solution?  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Alamofire may be able to use `Encodable` types to help create requests. This will require some thought.  Alamofire should support both generic `Decodable` response parsing and specific `JSONDecoder` and `PropertyListDecoder` based response handlers.  Hi @Lves,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Yeah great idea to modify it  Hi @Dschee,

I can say we are certainly planning on adding `Decodable` support to Alamofire 5, possibly even Alamofire 4. We haven't completed nailed that down yet. As for the `Encodable` support, that will take some more investigation. It gets quite complicated when considering different encoding types as well as query parameters vs. the http body.

Once we nail down some more specifics, we'll make sure to update this ticket.

Cheers. üçª @Dschee I've broken this up into `Decodable` and `Encodable` parts in #2180 and #2181 respectively. We can move discussion and other ideas to them. I've also created an Alamofire 5 project to track our design and implementation of new features for the next version.  Hi @ranlor,

Would you mind sending us a sample project that reproduces the issue? Looks like it's a leak from the system. Unfortunately that means there's nothing we can do about it. Good news is that the leaks appear to be gone under iOS 11. Thanks for the report! Cheers! :beers:  Your mobile developer should be able to answer those questions already. However, here are some high-level answers:
1. No, there is no automatic retry. That has to be implemented manually. A simple error is returned by the system, which Alamofire returns as part of the response closures in that case.
2. Alamofire wraps underlying errors returned from the `URLSession` networking layer provided by the system. It also produces a few convenience errors produced by, say, a failure to decode JSON that aren't covered by the system.
3. Our documentation is extensive. Check our [README](https://github.com/Alamofire/Alamofire/blob/master/README.md) as well as our inline documentation in the source code.
4. There's no such thing as "trapping" for iOS (or Swift in general). There is an extensive error handling section in our README that any developer using Alamofire should read. Alamofire provides a thin convenience wrapper over the network APIs provided by the system, as I said, and provides a `Result` type useful for asynchronous programming that encapsulates a the response state.

In general, while Alamofire provides a convenience wrapper around the system network APIs, as well as other tools to make it easy to follow best practices when making requests and handling responses, it's up to the individual developer to determine how it will integrate with their overall application. Poor handling of network responses will lead to poor app behavior no matter the networking library used. If you have any other questions about best practices in using Alamofire, let us know.  Hi @mafer-bc,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others. Awesome!  Can you please provide full details including: versions of Xcode, Alamofire, Swift, CocoaPods, OS, etc? What platform are you trying to build against (iOS, macOS, tvOS, watchOS)? What version of iOS is the iPad running and which model of iPad is it? The more info you can provide us the better. Also, would it be possible for you to submit a sample project? Might help us narrow down the problem. This is a duplicate of #2164, please move any addition input to that issue.  Hi @goktugaral,

First off, I'd suggest you read through the entire [Security](https://github.com/Alamofire/Alamofire#security) section of the README. That should walk you through everything you need to know to get this up and running. If you still have questions afterwards, then I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

If you do end up finding the documentation lacking after getting things working, please consider putting a pull request together to help those out in the future.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others. @dvertovsek Please stop replying to closed issues. If you have an issue you consider a bug, please file it separately and attach a test project for us to look at.  

Hi @TannerS,

- https://github.com/Alamofire/Alamofire#uploading-multipart-form-data

In the future, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  ?  This is really only useful for CocoaPods, who are still deciding what to do with Xcode 9. We'll update this file if needed, if we need to publish a Swift 4 version to CocoaPods. Thanks anyway! üçª   We've seen errors like this previous for Xcode 9 beta 1. Clear your derived data and try again. #2142 was similar. Re-opening @jshier...we'll need to dig in here a bit to see what's going on. @AtomicCat @crucibond Is this still an issue for you with Xcode 9 beta 2? After investigating this further, I can replicate it on a variety of project configurations. Manually integrated and CocoaPods integrated projects fail the same way, but only on tvOS. My test projects for iOS or macOS work fine. I suggest we all file bugs with Apple and attach a test project. I'm guessing something might be wrong with the Foundation framework on tvOS. @AtomicCat What is the issue number of the bug you filed? I'd like to duplicate it. I was successfully able to run my test project using Xcode 9 beta 3, so I believe this issue has been resolved @AtomicCat @crucibond.   Hi @pete183,

This is not currently possible, but is something we're looking to improve upon in Alamofire 5. For now, you'll need to create your own `URLEncoding` type that uses the delimiters you need.

Best of luck! üçª  I supplied an answer, but that question really has nothing to do with Alamofire.  Hi @kingxt,

You need to specify a destination on all platforms other than iOS. This is clearly called out in our [documentation](https://github.com/Alamofire/Alamofire#downloading-data-to-a-file). If you only want to get the data, then you should use `request` instead of `download`.

Cheers. üçª  Hi @santhoshs5,

You'll need to create your own custom `URLEncoding` type that encoded the array however you need.

Best of luck! üçª  Hi @stealdre,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thank you for all the detailed information here @couchdeveloper. After much deliberation, @jshier and I have decided to back out the change and have done so in fb76d834.

Thanks for the help! üçª  I'm not sure what you mean. This can be treated like any other request failure error if you want, or you can do some other custom logic. If you don't care that you're getting empty or nil data, you can either manually ignore the error in your response handler, or write your own `ResponseSerializer` that handles all of the errors just the way you want. Hi @HWSTS,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  @Suksal If your server doesn't support download resumption, no `resumeData` will be saved. Also, not all failures can be resumed from, so your expectation is incorrect.  The Swift compiler still isn't the greatest when it comes to error diagnostics. I usually adopt a rule of "when it doubt, check the types", as type mismatches are the most common cause of bad diagnostics.  Make sure you're using the latest Xcode version with a clean environment, as this isn't an issue we see.  Thanks for the PR! However, we won't be merging it, as [RFC 7231, 6.3.2](https://tools.ietf.org/html/rfc7231#section-6.3.2) states that `Created` responses should contain the item(s) created, as simple best practice. We strive to support best practices where we can in Alamofire, so adding this code as an expected empty response isn't a good idea. Thanks though! :beers:  Thanks for taking the time to put this together @mayurdzk. We won't be merging this into the README though b/c we're planning on adding direct support for Xcode 9 much sooner. Therefore, we won't need separate CocoaPods instructions!

Thanks anyways! üçª  After some investigation, it appears that turning `POST` requests into `GET` requests for 301/302 responses is fairly standard behavior and something Apple handles at the core of their networking system. If you can, updating the backend service to return a 307 response should preserve the `POST` request. Otherwise, perhaps the backend can handle the load balancing internally and no expose it to the request? I suggest opening an issue with Apple if you'd like this default behavior. Otherwise you could try and recreate your `POST` request in the redirection delegate method you're already using, but Alamofire provides no support for such a thing.  Hi @bsarrazin, thank you for putting this together. Unfortunately, we're not going to be moving over to Fastlane or prebuilt frameworks right now. For more info, please refer to #383 and #588.  great  There is now an `xcode9` branch up that can build Alamofire for both Swift 3 and 4, so you can give it a try!  Hi @Arun30sep,

You need to encode the JSON as a body part to the multipart form data. I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire` to get help with this. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Alamofire will never support synchronous methods. We have examples of uploading files in our documentation. 

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Most likely you just need to clear your derived data. Otherwise, are you actually using the `stream` APIs through Alamofire or not?  @linqingmo Thanks! üçª 

@burakgunduztr At the moment we're not supporting Alamofire 4 under Swift 4. You should be able to use Alamofire 4 built using Swift 3.2 in a Swift 4 project. However, if you're using CocoaPods to integrate Alamofire, it likely doesn't handle the distinction yet. There is now an `xcode9` branch up that builds Alamofire 4.5 in a hybrid mode for Swift 3 and 4. Give it a try.   @ParanoiaWan @KarlZeo Alamofire builds under Xcode 9 beta 1 just fine in Swift 3.2 mode. In addition, you can use the Alamofire framework built in 3.2 mode in an app that builds using Swift 4, according to Apple, so a Swift 4 port isn't strictly necessary at the moment. If you really want to build Alamofire using Swift 4, the required source changes are very minor. We'll be announcing our future plans soon!

@Vinzius Thanks! üçª   A brief investigation indicates that this crash may be caused by a `nil` value for the `Data` passed into the delegate method. Then, when it tries to bridge the `NSData?` to `Data`, it crashes because of the `nil` value. Just speculation right now. @blixt Do you happen to know what requests are causing this? Or is it all requests for your app? Perhaps you're getting nil data back from the server somehow? No, this is a bridging issue from the Objective-C code of `URLSession` and Swift. As you can see, it's apparently trying to bridge an `NSData?` to `Data`, which will never work if the value is `nil`. Either they have an underlying bug that's returning `nil` when it shouldn't, or they need to update the bridging of this API. Please file a bug with Apple (and post the Radar number) and / or Swift (and post the SR link) so we can get them to look at it. In the meantime we'll see if there's anything we can do to prevent this. No, as you can see in the crash log, it's due to bridging from Objective-C to Swift with an unexpected `nil` value. I spoke with a `URLSession` engineer at WWDC and he said it was likely an underlying bug where `URLSession` was returning `nil` unexpectedly. 

@bhaveshbc @gneil90 @ibarisic05 To that end, please file bugs with Apple and post the numbers here so that we can file a bug for Alamofire itself and cite all of your bugs. That way we have the best chance possible to get Apple to fix it.  @blixt I'm not sure what gave you the impression that we didn't investigate this, but we have. The crash log is clear and the response from the Apple engineer was as well. Given the irregular nature of this bug, it's not really surprising that you're only seeing it for certain requests. Without a reproducible test case, it's difficult for us to investigate this beyond the crash reports from others. However, we are continuing to look at it, which is why I've left the issue open.

If anyone else is seeing this crash, posting a crash log and attempting to create a reduced test case would help a lot with our investigation as well as reporting the bug to Apple. It is, and it would be helpful to Apple as well, so be sure to add it to your bug report. Do you have any iOS 9 crashes (do you support it?)? Also, it's good that this shows up on iOS 11, as Apple may actually fix it then. @blixt For any of your sessions, do you change the number of simultaneous connections at all? Any idea how big the responses might be? I'm trying to setup a test app that executes many requests in parallel, so I'd like to match your behavior. @blixt Thanks. Do the crashes seem limited to any particular devices or other unique configuration? @gneil90 
I'm... surprised that works. I thought I had tried it before but got a compiler error. Now if only there was a way to disable that warning...  Sorry, there's not a lot we can do to debug your CI setup.  We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  That's Swift 2 code, so please update. Double check your closure types as well.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @AniOSDeveloper,

We do not have any examples that use the stream APIs. I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. You may also have some luck googling around on Stack Overflow directly.

Best of luck! üçª  Thanks for the PR! However, we're not going to merge it. As you said, there is no real standard for URL encoded collections, so adding levers to for every possible encoding is unfeasible. Creating your own encoding that does this is straightforward, and we'll look into enhancing `URLEncoding` in the future so that this sort of customization is easier.  Hi @EJSohn,

Thank you for putting this change together...much appreciated! üçª

Unfortunately, we will not be accepting this change into Alamofire for a couple reasons. First off, it doesn't work. You can only modify the `URLSessionConfiguration` before it is applied to a `URLSession`. After it has been set, the mutation of it no longer applies.

Additionally, we want to keep the top-level APIs as lightweight as possible. We don't want to introduce any new parameters into those APIs unless absolutely necessary. Instead of adding a timeout property, you should either set it on the `URLSessionConfiguration` when you are setting it up, or you should set the value directly on the `URLRequest` and use the `Alamofire.request(urlRequest)` API.

Cheers. üçª  Hi @c204303,

> 1. How do I solve this?

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests. I'd also suggest you add more detail to the question you ask. Right now you haven't posted much more than it used to work, and now it doesn't. It's pretty unlikely that anyone will want to, or be able to help you troubleshoot such little information.

> 2. Is it possible to use Alamofire 3 with Swift 3.

No it is not.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @howaisi,

Most likely the issue is that you've misspelled `parameter`. It should be `parameters` instead. In the future, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the PR! This looks like a nice little cleanup! Cheers! üçª   Thanks for the PR! However, we won't be merging it, as responses are unnecessary for our README and distract from the actual content.   Check out our [Security section](https://github.com/Alamofire/Alamofire#security) in our README for info about customizing your security settings.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  That curl option uses the `Range` HTTP header to request a range of bytes from the server. You can add the header to your requests yourself but Alamofire provides no direct support for it, as it's rare to need to request specific byte ranges. 

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Yes, you'll need to properly encode Korean characters for the URL. I suggest you review their [documentation](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/URLLoadingSystem/WorkingwithURLEncoding/WorkingwithURLEncoding.html) on the subject. 

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  All UIKit operations must be performed on the main queue, so your `reloadData()` call should be inside `DispatchQueue.main`, not `.global()`.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Overriding the `ServerTrustPolicy` is something that only needs to be done rarely and shouldn't be done at all without considered thought. In addition, we try to keep our top level APIs limited to the most common cases so it doesn't grow too far out of hand. This API is best where it is now.  That closure is strictly used for the successful read of data from a request. It's not intended to do any error handling. We'll be reevaluating our closure and stream APIs for Alamofire 5.  Your issue is likely the fact that `URLCache` doesn't have a functional empty initializer, so `URLCache()` returns a cache that can't actually store anything. I suggest you initialize it the documented initializer.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Yes, that's a bug that will be fixed as part of our 4.5 release.  @d0ye Changes to the `configuration` of an already initialized `URLSession` have no effect, per Apple's documentation. If you want a custom timeout, either set the value on your requests, or create a custom `URLSession` with a custom configuration, as outlined in [our documentation](https://github.com/Alamofire/Alamofire#session-manager).

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we're not responsible for Xcode's autocomplete issues. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  You'll need to provide us with more details for us to do anything here. What version of Xcode, Alamofire, and OS are you running this on? What is the content of the exception that was thrown there? Hi @OldCrab,

There's not enough info to go on here. We'll need a sample project that can demonstrate the issue and then we'll happily look into it further. I'm going to close this issue out until we get enough info to action an investigation or a sample project.

Cheers. üçª  Thanks for putting this together @Lutzifer! üçª  Hi @HuangWei201703,

Your URL string needs to conform to RFC 2396, otherwise Apple will not instantiate it. If you provided that URL directly, then you need to percent escape the query string values when it includes unicode characters. In the future, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  This is exactly what our `ResponseSerializer` protocol and various `*ResponseSerializer` types are for. Please read our [documentation](https://github.com/Alamofire/Alamofire#custom-response-serialization) which outlines how to write a custom response serializer. I also have a [gist](https://gist.github.com/jshier/f356bfb5b6dc634b67b14ddb75bd7279) I wrote which is the generic response serializer I wrote which wraps Argo, for generic type serialization.  If the certificate was pushed to the device and accepted by the user, it should be part of the default evaluation chain automatically, so Alamofire shouldn't need to do anything. Is that not the case? Note that iOS 10.3 changed the way certificates are accepted by users, so you'll need to make sure it's active. We do not have direct support for client certificates in Alamofire at this time. You have a couple options. The first is to set the `taskDidReceiveChallenge` override closure while the other would be to subclass the `SessionDelegate` and override the task challenge API.

Once you've done that, you'll need to check for if the challenge's protection space auth method is `NSURLAuthenticationMethodClientCertificate`. If it is, then you'll need to build a `URLCredential` from your certificate and pass that off to the completion handler. This [thread](https://stackoverflow.com/questions/40335827/client-certificate-and-nsurlsession) walks you through the basics.

Best of luck! üçª  As you saw, validation handlers aren't intended to be used outside of the `request.validate().response()` chain. If you want custom validation once you've processed a response, creating a custom response serializer and / or using a `RequestRetrier` will accomplish what you want much more easily. We'll work on updating the documentation to reflect this fact.  Thanks @mtrudel! üçª  You'll need to ensure you're properly linking the Alamofire framework into your project. Or use a dependency manager.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  For now you'd be limited to `ServerTrustPolicy.customEvaluation((_ serverTrust: SecTrust, _ host: String) -> Bool)` case, as you'd be able to use the TrustKit APIs in that closure. We hope to redesign these APIs for Alamofire 5, both to increase their capabilities and abstract them away enough to work on Linux.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the PR!  Hi @agnosticdev,

IMO, the jumpbar is pretty clear as to the separation by simply reading the names of the test cases. The MARKs are added to make it easier to read the jumpbar quickly. Is that not sufficient? We've used that approach in many places throughout the tests to split them up. The MARKs you've added here really just duplicate what's already in the name of the test case. I'd also argue that if we were to make such an addition, we'd need to make it throughout the test suite for consistency.

On a different note, we're going to be restructuring the entire test suite at some point in the near future. When we do that, we'll certainly take a pass at making the test case names as clear as possible and using MARKs where applicable.

Thanks anyways. üçª  Closing this issue out in favor of #2091.  Unfortunately that error comes from the underlying security library we use for the various SSL utilities, so there really isn't anything we can do to improve it ourselves. What we may be able to do is wrap it in higher level error so there's a bit more information available to you. 

Development of Alamofire 5 hasn't started yet. In the meantime I suggest you add handling for that particular error if you need a special error message.   Thanks for the PR! However, we don't support Objective-C interop in this library, so why would we want this? Secondly, if we were to do this for one error type, it seems like we should do it for all of them.  Without a strong case for why this needs to be done, I'm going to decline this PR. Thanks anyway!  Latest Carthage is 0.20.1. You should probably update.

Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  From looking around, it seems that issue popped up again in iOS 10.3. There doesn't seem to be a workaround. File a bug with Apple mentioning your error.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  From Apple's documentation, you will only get resumption if:
```
A download can be resumed only if the following conditions are met:

The resource has not changed since you first requested it

The task is an HTTP or HTTPS GET request

The server provides either the ETag or Last-Modified header (or both) in its response

The server supports byte-range requests

The temporary file hasn‚Äôt been deleted by the system in response to disk space pressure
```

As for killing the app, I'm not sure why you'd expect anything different. When you kill the app the system doesn't have a chance to prepare your resume data, as downloads occur in a temporary area and are then moved when the download is complete.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the example project. I'll give it a shot on my iPhone 4S. One immediate issue is your use of `responseData`, which will read the entire contents of the file into memory. A bad idea on low memory devices. So the crash isn't on file move but during file read into memory. That's why you see the file moved when you relaunch. Yeah, I'm getting a crash with:
```
Downloader(198,0x1f421000) malloc: *** mach_vm_map(size=888762368) failed (error code=3)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
```
which is an allocation failure. I'll try again without the `responseData` usage and see if it makes a difference. I think it will. Yes, using just `response` let the download complete successfully. We'll look into if there's anything we can do to make `responseData` safer for downloads, but ultimately it's up to developers to make sure they don't try to allocate an inordinate amount of memory at once.  Thanks for the PR!  Hi @MMizogaki, thank you for taking the time to put this together...much appreciated! üçª I made a few modifications to your PR and pushed them up in a356cc24 while maintaining your attribution. These changes will go out as part of the AF 4.5 release.

Thanks again! üçª  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  It supports Swift 3.1 right now.   Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  I suggest you look at what you're actually getting and check the differences between your Postman request and the one you're making from code.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the report! @cnoon, any clarity here? Hi @GaryDUK,

The server should not be redirecting on a `POST` or `PUT` for security reasons. Please see #2149 for more information.

Cheers. üçª  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @ericdesa,

Thanks for putting this change together...much appreciated! This will be part of the AF 4.5 release shortly.

Thanks again! üçª  Hi @webmaster128, thank you for putting this change together! üçª

After some debate, we've decided to accept this PR and use `curl -v` moving forward. If anyone finds it to be a bit much, then you can always switch back to `curl -i` when pasting back into terminal.

Thanks again!  Hi @fanglichun,

You must provide a [download destination](https://github.com/Alamofire/Alamofire#download-file-destination) on iOS if you are trying to download the image to a file. If you just need the image data, then switch over to the `Alamofire.request` API instead.

In the future, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @megifernanda,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @rajeshsonu,

I'd suggest you rebuild your `upload` call here again using Xcode's autocomplete functionality. Just plug in each closure one-by-one. You can also use our [test suite](https://github.com/Alamofire/Alamofire/blob/master/Tests/UploadTests.swift#L240-L690) for reference as to what could be wrong.

In the future, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the report! However, I can find no documentation in [RFC 7231](https://tools.ietf.org/html/rfc7231#section-5.3.5) that officially states these combinations. Can you point us to any? Otherwise it seems likely we'd need maintain a static map of possible combinations to acceptable ones, which isn't likely something we want to do. Hi @simonliotier,

Thank your detailed report here...much appreciated. What we all need to keep in mind is that while your use case does not want to receive `fr-US`, others may. You can always convert `fr-US` to `fr-FR` on the server side to do a proper mapping, but you'd never know how to reverse `fr-FR` to what the user actually has their locale set to which is `fr-US`.

Alamofire only sets the `Accept-Language` by default, but you're more than welcome to override it for your particular use case. I don't feel that it would be correct for us to try and make the user's locale more generic.

Cheers. üçª  If the underlying `URLSessionUploadTask` never produces an error Alamofire will never return one. Are you perhaps using a background session? That will give you different error responses than a foreground session.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Alamofire requires no changes to build without warnings under Swift 3.1.  Using the Router pattern from our documentation it's trivially easy to set timeout values on a per-request basis. This should allow you to set a reasonable timeout for a given request while keeping all others at the 45s default. Otherwise you can check the particular error returned to see whether its a timeout or a response error. 

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  No problem, it's a Travis issue (still). @MarcoSantarossa We're still reviewing changes for our 4.5 release, we'll likely review and merge soon. Thanks for putting this together @MarcoSantarossa...much appreciated! üçª I've made a few small tweaks to your PR and have pushed it into `master` in 68f4eb3f while maintaining your attribution. This change will go out shortly in the AF 4.5 release.

Thanks again!   Thanks for putting this together @dusek...much appreciated! üçª  #2025 has been merged. Apparently `httpbin.org` made this change on their side.  It's likely you're blocking the main queue in some way, but there's no way to know without some code to looks at. If you can post the code that causes this issue, we can take a look. A sample project would be even better.  Alamofire fully supports IPv6, just like the underlying frameworks. When this comes up it's usually something along the lines of 1) a reachability check performed before requests failing, which is an antipattern and should be removed, 2) misconfiguration of the reachability API (make sure to use just your domain name, no scheme), or 3) the API endpoints you're talking to not supporting IPv6 themselves. Also, AFAIK, there are no changes in this regard for iOS 10.3.


In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the report! We'll take a look! A PR would be great! Closing this issue out in favor of #2060. Please direct all further comments to #2060. üçª  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  @Silvering You'll need to rebuild all of your dependencies and your app with the latest version of Xcode so that all of the built frameworks are using the same version. How to do so depends on how you integrate Alamofire.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Even with Photos permissions you can't directly access files outside of your sandbox.

Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  In my view this is redundant, as JSON is, by definition, already UTF-8. Using it with any other encoding is non-standard and not supported by Alamofire or the underlying `JSONSerialization` API it uses for JSON. @cnoon, what do you think? Thanks for putting this together @2h4u! 

I agree that this should be added since JSON defaults to UTF-8, but can also be encoded in UTF-16 and UTF-32. There are some good details in this [thread](http://stackoverflow.com/a/9254967/1342462) and you can also check out [RFC 7158 - Section 8.1](https://tools.ietf.org/html/rfc7158#section-8.1) for more info.

I've made some additional changes to your PR @2h4u and pushed them into `master` in c8700ac7 while maintaining your attribution. This change will ship in the next release.

Thanks again! üçª @cnoon From RFC 7158:
```
Note:  No "charset" parameter is defined for this registration.
           Adding one really has no effect on compliant recipients.
```
As mentioned in the SO thread you linked, servers interested in supporting UTF-16 or -32 can just check the first four bytes of the response to determine both the encoding and endianness (which can be either big or little), or any other standard algorithm for the same result.

So it still seems redundant. Just as a heads up here, after much deliberation, @jshier and I have decide to revert this addition from the AF 4.5 release. I just pushed up the reverted commit into `master` in fb76d834. The main reasoning is that the `charset` parameter is not defined and there are already ways described in detail in the links posted on this thread on how to determine the encoding.

Thanks everyone for all their help on this particular issue. Cheers. üçª Also, please refer to the write-up in #2157 for more info.  You can't do this with a single request unless your server wraps up directory contents into a single file for your automatically. You'll have to get the directory contents and download each file individually or perhaps come up with a solution on the server.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Looks like this was taken care of #2031. Thanks anyway! Cheers! üçª   Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  @ryanzl @LaurentiuUngur Can you both please post the code that causes this leak? Better yet, please post sample projects which replicate these leaks so we can investigate. @Afsarunnisa Those `_NativeDictionaryStorageImpl` leaks are from the underlying Swift libraries themselves, and are fixed in Xcode 8.3 / Swift 3.1.

@ryanzl @LaurentiuUngur If you could retest using Xcode 8.3, we can see if any of the leaks were underlying issues or false positives fixed in the new version. If they do appear, please upload a project that replicates the leaks you see and we'll look into it. Thanks for confirming @ryanzl...I'm going to go ahead and close this issue out for now. Please feel free to add additional info if you continue to see issues on Xcode 8.3 and we'll happily re-open and investigate further.

Cheers. üçª  Rather than doing this strictly at the `Request` (or subclasses level), I'd do it at the `URLRequest` level. That, combined with a router (perhaps a `pagedResults` route), should be able to give you the sequence of `URLRequests) needed to get all of the pages. Making them sequentially using the standard Alamofire APIs should be pretty straightforward after that.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the report! Yes, you must be careful when using background sessions, as Alamofire doesn't currently do any validation of usage for background vs. foreground sessions. We'll be reevaluating background `URLSession` usage through Alamofire in the future.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others. Mostly likely you need to follow our documentation regarding how to customize the headers sent in the request. Neither of the methods implements in the original post would work how you'd expect. Besides which, the easiest way to see what could be wrong is to use a proxy tool like Charles Proxy to intercept your requests and see exactly what they look like.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the PR! Good catch! Cheers! :beers:  Looks like this was taken care of by #2031. Thanks anyway! Cheers! üçª   Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  The `response.response?.statusCode` is the HTTP status code in the response. If you never receive a response it will be `nil`.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Update to Alamofire 4 and these APIs are much safer. Otherwise ensure your URL is properly encoded before attempting to request it.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  No, you don't need to set a delay.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Response handlers are called on the main queue as a convenience, as the most common usage is updating UI or view controller state, which needs to be on the main queue. If you don't want that behavior, you can pass a queue to `response` which is used to dispatch your completion handler and manually call back to the main queue if necessary. All other Alamofire work is already on background queues, per best practice.

As for your tests, I suggest using [`XCTest`'s asynchronous capabilities](https://developer.apple.com/library/content/documentation/DeveloperTools/Conceptual/testing_with_xcode/chapters/04-writing_tests.html) to properly test it, rather than using manual group management. `XCTest`'s asynchronous testing works fine with Alamofire, as that's what we use to write our own tests.

The `Timeline` behavior is intentional, as performing work in the completion handler is considered part of serialization process. We'll be reevaluating these APIs for Alamofire 5, so we may be able to change something then.  There is no direct conversion for such a setting. It depends on what you're actually trying to do. I suggest you evaluate your requirements and go through [our parameter encoding documentation](https://github.com/Alamofire/Alamofire#parameter-encoding) and see where your requirements can be met. You may need a custom parameter encoding, depending on your particular situation.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  There is nothing in Alamofire that treats different cell networks any differently. Also, your parameters are both redundant, as those are the default values, and wouldn't work in the first place, as the `URLSessionConfiguration`s can't be modified once they're part of a `URLSession`.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Can you be more specific? There are some known leaks that show up that are false positives (some of which are fixed in Xcode 8.3 / Swift 3.1), but unless you provide a detailed report there's nothing we can do here. What versions of Xcode, Swift, and OS are you using? Can you post the leak report? I'm closing this issue for now. If you can provide some documentation for this issue, I'll gladly reopen it.  There isn't much for us to do here. Make sure your optimization and SDK levels match and you're using the latest Xcode and Alamofire versions. If you can create a test project that reliably replicates the issue we may be able to investigate further. Otherwise this looks like a low level issue from Apple's side. I'm closing this report for now, but please comment with a test project if you get this to reliably reproduce.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Looks like you got it fixed in the Moya issue. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Unfortunately Alamofire relies on the underlying system frameworks to return these errors. If the error contains no additional information there isn't much we can do about it. Also, this is the only error Alamofire sees on failure as well, so to add more information we'd have to implement all of the same validation we rely on the underlying frameworks for ourselves. Obviously that's a bad idea, so I don't think there's much we can do here. Feel free to open another issue if you find something specific we can implement to help. Cheers! üçª   Thanks for the report. I agree that should be something that handled more elegantly, as it makes sense to me that an attempt to pin to certificates from the app bundle should expect at least one certificate. We'll be refactoring `ServerTrustPolicy` for Alamofire 5 and should be able to make such a change then.  @cnoon Can you look into this? Hi @reitzig,

Thank you for putting this issue together. I agree with you that this is an unfortunate requirement. We will be relaxing this rule in AF5 since it cannot be done in a backwards compatible way right now. We've added the issue to our Trello backlog and will be fixed in AF5 which will ship roughly in October 2017.

> Until then, you'll need to subclass and implement your own solution as a workaround.

Cheers. üçª  `Default*Response` and `*Response` are not related because they're just different enough to not be the same type while we didn't want to make them class types, so as to keep the value semantics.

We'll be taking another look at response handling for Alamofire 5. In the mean time it looks like your protocol should be pretty easy to implement yourself.
 We may make them visible once actually start Alamofire 5 planning and development.  We'll take it into consideration. However, given the lack of support from `URLSession` directly and the mismatch with how most developers use Alamofire, it will be low priority.  I'm not sure why you block the main thread like that when `XCTest` has asynchronous waits, but it's fairly well known that you shouldn't block the main queue. Using `sync` there is even more dangerous for production code. If anything ever calls that code using `sync` as well you'll get a deadlock. I suggest you update your testing code to use expectations and waits. 

In any case, we'll be reevaluating the various queue usage and the `MultipartFormData` APIs for Alamofire 5. The queue you reference there is the background queue used internally by Alamofire, so it can never be the main queue. So while there's a risk of deadlock if we were to sync back to it from within the closure, it's easy to see it isn't, as we have visibility into our of our usage of that queue.   Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  @davidseek You need to setup your `URLSessionConfiguration` by creating a new instance. Modifying values on the current configuration doesn't have any effect, as per Apple's documentation. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  There's is nothing built into Alamofire to do this. Also, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  There doesn't seem to be anything Alamofire related here. I will say that having JSON body data in `.get` requests can cause issues in some servers, so make sure you're properly creating the requests you need.

Otherwise, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Yes, this is a known false positive. If the declaration of the `NSLock` is moved to the top of the `SessionManager` file, I've heard that "fixes" the leak. I also believe this false positive is fixed in Xcode 8.3 / Swift 3.1, which will hopefully be released soon. But you can take a look at that in the meantime. We've already filed a radar for this issue @xmollv and it was closed out as a duplicate.  Aside from the occasional warning against casting optional parameters to `Any`, it works just fine to pass optional values in `Parameters`. However, you're right, it should likely be an actual optional value there. However, such a change wouldn't be backward compatible with current use and so will have to wait until Alamofire 5. I've added it to our backlog for that work. Thanks.  Thanks for the PR! Looks good! Cheers! üçª   Thanks for the PR! While this could just be a change to `var`, preserving `let` semantics is better. Cheers! üçª   How big of a file are you downloading? Is it happening only on certain devices or all of them? What versions of iOS, Alamofire, and Swift are you using? I've been able to successfully test large file downloads using a background `SessionManager`. Your issue may stem from your `responseData` usage, as doing so reads the entire downloaded file into memory, which may cause a failure to read it from disk. Using `response` instead, and checking if the `DefaultDownloadResponse`'s error is `nil` will let you take action when the download completes without attempting the read the file into memory.

A few things to note:

1. Alamofire doesn't reconnect to your background session if your app is killed, so you'll lose track of progress and the `response` handler. You'll need to handle that yourself.

2. Your `timeoutInterval*` properties aren't doing what you think they are. Timeouts are only used for the time between server responses, not for the total duration of the download. Keeping those at the default values should work fine.

3. Checking for reachability before making a request is an anti pattern and Apple specifically says not to do it.  Thanks for the PR! Looks good! Cheers! üçª   Thanks for the PR! A nice little change. Cheers! üçª   You can create a custom `ParamterEncoding` that's similar to `URLEncoding` but encodes parameters using whatever method you want. Our documentation [outlines how to proceed](https://github.com/Alamofire/Alamofire#custom-encoding).  Thanks for the report! You're saying that, even if the cert has been installed and trusted on device that SSL connections won't work? I hope that's a bug, otherwise tools like Charles won't work without ATS workarounds. @rsaeks Thanks for keeping on top of this. I'm closing now that the issue seems to have been resolved. Please let us know if anything changes.  If you haven't noticed yet, Xcode's Swift support breaks a lot, leading to issues with syntax highlighting and autocompletion. I suggest you clear your projects Derived Data and start clean.

Also, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the PR! However, we won't be landing it, as the types are unnecessary. However, it did prompt me to fix another issue, which as fixed in #2058. Thanks! üçª   `.authenticate` is meant as a response authentication mechanism and is not part of the request chain. Most header authentication is not intended to be used that way. Plus, there are several different header authentication methods available to users, with no real good default implementation. So there's really no way for this suggestion to work well. However, we will reexamine the authentication flow in both cases for future versions of Alamofire.  Hi @LupoDiRoma,

First off, thanks for filing an issue on Stack Overflow. Next time please post a link if you end up having to open the issue on our GitHub project.

Overall, there's nothing in Alamofire that is causing the delay you're seeing. We have 1000s of apps shipping with Alamofire that do not have this problem that fire many requests at app launch or foreground event. We've also seen this type of issue filed before, and it always ends up being something in the client implementation that is a bit off.

The only thing I can see in your code sample here that seems a bit odd is that you're calling `resume` on your `task` which is technically the `request` vended by the session manager. Did you purposefully set `startRequestsImmediately` to `false` on your session manager? If yes, then the `resume` call is necessary, if not, then you should remove it. I don't think this is part of your problem, but I noticed it and thought I'd point it out for you.

Other than that, I'd suggest you remove portions of your app to simplify the use case as much as possible, or create a separate test app that just calls your login functionality to isolate what the delay could be caused by. I know this is quite a bit of work, but it's sometimes necessary to figure out what the underlying issue actually is.

Best of luck! üçª  Hi @TofPlay,

This type of feature does not exist in the core Alamofire library. In AlamofireImage, we have the concept of a reordering queue allowing you to specify whether the queue has LIFO or FIFO behavior. You could very easily extend this queue to support priorities as well. Now monitoring bandwidth limitations would be a bit trickier but could also be done. You'd need to specify the allowed bandwidth on a request, then monitor the returned content size and cancel the request if it gets too large. You could look at the `stream` implementation on `Request` to get an idea of how this could be done.

Best of luck! üçª  Good catch here @pbartolome...thanks for putting this together! üçª  Answered on Stack Overflow.  Other than suggesting you create a custom singleton instance of `SessionManager`, as outlined in our docs, rather than modifying the default, there isn't a lot of Alamofire here. Perhaps you'd have better luck asking this question on  [Stack Overflow](https://stackoverflow.com) and tagging `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  FYI, this can be set at the `URLSessionConfiguration` level, though I don't know how useful it would be with a typical RESTful backend.  @cnoon Perhaps you can answer this? Hi @reitzig,

Great question here as there is tons of complexity around streaming big chunks of data up to a server. 

To start off, how do you envision the `OutputStream.write` method to work if it doesn't write to RAM or to the file system? I don't see how that's possible offhand, but maybe I'm missing something obvious. To be able to convert all the body parts into an output stream, you actually have to write the data into the output stream which is either going to be loaded into memory (RAM in a buffer) or written out to disk.

Now as for directly streaming the data from multiple body parts from various locations (file, in-memory, input stream, etc.) one could create a subclassed `InputStream` that reads data on-the-fly from the `MultipartFormData` object. This is the approach that was used in AFNetworking. This approach is a very hacked together solution that barely works in AFNetworking. When we went to try to build a similar type of approach in Swift, `NSInputStream` couldn't even be subclassed as it through compiler errors. I believe that issue has since been resolved, but the complexity around the low level bridging required is something that we decided to avoid at the time and couldn't even implement if we wanted. After Mattt and I had a very long conversation about it, we both decided it was best to try to use an in-memory solution for small payloads and move to an on-disk solution for larger ones.

Now that I believe you can actually subclass `InputStream`, it should be possible to create a `MultipartFormDataStream` or something like that that subclasses `InputStream` and reads the data on-the-fly for each read. This is something that I haven't had time to investigate myself but would be awesome to have in Alamofire. I think it would probably be as simple as adding a `stream` or `inputStream` property to the `MultipartFormData` object that vended the custom subclassed stream with all the appropriate implementation. If you wanted to take this one I think it would be a really good addition. If not, then at least you have the history of why the feature is currently designed as it is.

Just let me know what you think here @reitzig. I'd be happy to help try and guide you through the implementation more in-depth if necessary, but I don't have time right now to build out the feature myself. I'm going to leave this issue open for a few days for you to get back to us with your thoughts and we'll decide from there.

Cheers. üçª Hi @reitzig,

I'm going to close this issue out for now. If you're still interested in reviving this effort, please feel free to open a PR.

Cheers. üçª  Also, reading the code of the library itself can go a long way to filling in any misunderstanding or confusion you may have from the documentation. 

Like the compiler (and the documentation) says, using `upload(data, string)` isn't going to work, not least of which is because you need the `to` label for the destination. `upload(data, to: "https://httpbin.org/post")` works just fine.

For typical REST usage, `request` is what you need. Something like `request("https://httpbin.org/post, method: .post, parameters: parameters, encoding: JSONEncoding.default)` will work just fine. 

If you have actual examples of inaccurate documentation, feel free to open a new issue pointing it out specifically.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Can you upload a sample project that replicates this leak? Also, what version of Xcode and what OS are you seeing this on?  There's nothing immediately obvious that's causing a crash, but from the stack it's probably in your retrier, as I assume you're doing some sort of auth handling there. But from your code I have a few recommendations:
1. Don't modify the default `SessionManager` every time you make a request. Create a new `SessionManager` in a singleton or the like and use that customized instance for every request to your API. This should prevent a lot of configuration and `URLSession` churn when making requests. The `default` `SessionManager` isn't really designed to be used like this.
2. I'm not sure what you're trying do with your timeout handling, but calling `invalidateAndCancel()` on the default `session` isn't necessary for anything. Once the `SessionManager` is `deinit`'d it will cancel anything outstanding for you, not that that's usually necessary.
3. Your error handling in general can be simplified down to creating your `errorMessage`, nothing else you're doing there is adding anything.
4. I'm not sure why you're using a `responseObject` method there when you're not creating a generic return type from the JSON. Take another look at our documentation to see how much more useful a generic `response` method is over just returning the JSON from the response. I'm not entirely sure why you're seeing that crash. If you're using an adapter / retrier, that's one possible avenue as @jshier mentioned. If you're not, then I would assume it's something odd to do with the challenge being answered after the request has already timed out.

I think a different question to answer here is how are you authenticating against Kerberos? I don't see any auth logic in your code sample. Possibly one approach would be rather than waiting for the request to issue a challenge, you could require the user to enter their credentials before issuing the request at all. Anyways, trying to think outside the box a bit.

I'm going to go ahead and close this issue out. If you comment back with more info that warrants additional investigation from @jshier or myself, we'll happily re-open and continue.

Best of luck! üçª  By default Alamofire doesn't do any determination of success or failure by response code, due to the huge variety of desired behavior there. You can either put such logic in your custom response serializer, if you write one, or add a `validate()` call to your request chain.  Alamofire defaults to this behavior to allow developers the flexibility of adding whatever sort of behavior they want for different error codes, as a single default behavior may not be wanted or desired by everybody. It also forces the developer to handle such situations in the way that's most appropriate for their app. If you want such a behavior our documentation outlines how to do it.  This isn't an Alamofire issue, we're just the first framework alphabetically. 

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  @adasoft-dev Well, first of all, you're not even trying to encode your parameters correctly, so it's not surprising your Alamofire request doesn't work. I suggest you review our various `ParameterEncoding` types to see if any would work for you. Second, the various parameters types supported by Alamofire by default are there because they're most common, not as an exhaustive list of possible types. If you need to move beyond them, generating your own request, like you've done, and using Alamofire to issue is directly support. Also, generating requests using the router pattern, or creating your own parameter encoding are both outlined in our documentation.  Hi @vietstone,

Thanks for putting this PR together...much appreciated! With that said, I don't really see the use in duplicating the entire task state at the request level. Could you speak to that a bit? I think we'd all need a really good reason to justify adding this logic into Alamofire when you could simply use `request.task.state` instead.

I'm going to decline this PR for now. If you have a good justification for this and we decide to re-open the PR, then we'll need documentation and tests before we merge the PR in.

Thanks again! üçª  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  This is tracked in #1896.  I suggest you reference Apple's documentation.  why are you using: self.apiserver.alamoFireManager! instead of importing Alamofire and using 
Alamofire.download.  I suspect its this manager class that you have created that is causing the extra complexity, instead of saving time.  Error messages like this usually mean that there's a type mismatch in the function being called, whether in parameter types or attributes like `@escaping`.

 In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  [Removed due to resolution in Swift] Hi @AliTariqPL - it was down to the way the api was taking the url query parameters for me.  The easiest way is to print out the request url before its called and run it through a browser/ Rest client to surface the problem.  
  Hiya- its not really clear, can you share an example/ simple project to demo the issue?
 @XueChenChen This code has changed in Alamofire 4, I suggest you update. There's also better error handling around request generation as well in that version.   `upload` is intended for file upload, you don't need to use it otherwise. Your initial function call was also generally incorrect. That's an example of using `upload` with a `.post` method type. You can use the same method just fine with `request`, as our documentation shows. `upload` and `download` are intended for files, not general REST usage.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  AFAIK, CocoaPods still doesn't support framework dependencies for framework targets. You could try importing your framework into your app as a development pod, I've seen it work that way.  I would try change to change your Json object to single quotes - and also unwrap the image data in case thats causing issues
 Error 3840 means that the response wasn't proper JSON, so you need to investigate that further.

Also, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @djmadcat,

Thanks for putting this PR together...much appreciated! Unfortunately though, we won't be accepting this set of changes at this time. The `@escaping` was left out of the property declarations on purpose because closures captured as properties are `@escaping` by default. As far as I can tell, `@escaping` and `@nonescaping` should only be used in function parameter declarations.

If you could point us to some documentation that states otherwise, then we'll be happy to reconsider this change.

Thanks anyways! üçª Now that's what I call a justification @djmadcat! I really appreciate the thoroughness of that reply, not to mention I learned a thing or two along the way...much appreciated. üçª  Like @NikKovIos said, you can access the response data from the request's delegate. You'll need to run your decoding again, potentially, but it should be easy, especially if you've already separated your custom parsing into your own `ResponseSerializer`. 

We'll look into enhancements for `RequestRetrier` for the future.  Yes, you should not have the scheme on the string you're checking for reachability.  I've seen leaks like this before, they're usually a false positive or something from the underlying Swift standard library, so there's a not a lot we can do about it. It will likely be fixed in a future version of the tools.  This is a false positive. Every `SessionManager` will appear to leak it's `NSLock`, and just the lock. Moving the variable declaration to the top of the class fixes it.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Can you clarify your use case? Signing certain requests vs. others is a pretty straightforward use case that can be handled using an adapter or a router, so what's your issue? Unless the signing depending on keys returned by previous requests it seems like a router would be an ideal way to handle this. My basic question is why can't accomplish what you need with Alamofire's current capabilities. Can you please explain your use case in more detail? Which can be easily done using the [request router pattern](https://github.com/Alamofire/Alamofire#routing-requests) outlined in our documentation. If that doesn't work for you, please explain why in as much detail as possible. You still haven't outlined in any detail what it is you're trying to do here. I'm not sure why you insist on using a request adapter for this, but if you follow the router example in the README it should be pretty clear. Just add an additional parameter based on the route and use it to sign your requests. Since you haven't outlined what signing your requests looks like I can't really help you any further until you do. Hi @SanjoDeundiak,

My apologies for just catching up on this thread now. Your initial assessment is correct in that you would need to use multiple session managers with multiple adapters to easily accomplish this. This is exactly what we do in a large networking library we've built at the company I work at. In ours you create a separate session manager and adapter / retrier for each authentication system you use. It also gives you the ability to customize each session manager based on the needs of that authentication system. Works great!

I'm curious as to why you feel this isn't elegant? At some point, you have to make a decision as to what type of authentication you're going to use for your request. IMO, that should be made way before actually making that request in a big networking library. You don't want to have to make that decision when you're actually calling your request, you'd much rather do it when you define the request and how you actually call it as @jshier mentioned either in your Router pattern (not preferred here), or by assigning the request to be made on a specific session manager whose adapter handles the authentication (preferred).

Another option would be to use a single session manager and adapter, then inspect the request to decide which type of authentication to apply to it, but this seems like a much worse alternative to me. Generally you should only need to call at max a handful of different authentication schemes so using a session manager and adapter / retrier per authentication scheme works out fairly well.

As for attaching an adapter to a request, I've been thinking through this quite a bit and while I do believe it would be possible, it seems messy. Why would I want to define my authentication scheme for each request when I could define it at the session manager level? As I mentioned before, most apps don't use that many authentication schemes, so why add more complexity to creating a request? On top of this, it seems problematic to allow session managers (potentially multiple session managers) to be hopping all over the place calling into adapters and retriers in an inconsistent way. By attaching them to a single adapter / retrier, you certainly limit your scope for testing purposes.

With that said, it's probably possible though to switch the adapter / retrier pattern over to being a per-request type of design, but I don't see the merit there over attaching them to the session manager. Separating your auth per session manager has many other advantages that IMO outweigh the flexibility of attaching them to the request.

Hopefully that helps clarify things here. I'm going to go ahead and close this issue out, but feel free to continue the conversation.

Cheers. üçª  Please don't create new issues just to tell us to look at an existing issue.  `URLRequest` is the Swift-ified version of `NSURLRequest`, new in Swift 3. You use it instead of `NSURLRequest`/`NSMutableURLRequest`.  No, that's just Apple's shitty documentation. It's supported on all systems Swift 3 supports, as it's part of Swift 3, not Apple's libraries.  `NSURLRequest`/`NSMutableURLRequest` are no longer necessary as part of the upgrade to Swift 3. The new `URLRequest` type is a native Swift type that works like other Swift types, which works much better in Swift.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Can you post the leaks output or the lines it points to as responsible? While a demo project would be appreciated, being able to examine the leaks you've seen would be helpful in the meantime. The lock leaks are a false positive. As for the background leaks, I'm not sure what's happening there, but it looks like you're leaking the world almost. If you can get a test project to us that would greatly help with our investigation. @unusuallyreticent Thanks for the investigation, it helped narrow this down quite a bit. It turns out that, when the `taskDidComplete` closure is set, AF isn't calling it's own `TaskDelegate`, which means we lose all of the machinery in there that takes care of task completion. So not only would it leak but any `response` handlers attached would never be called. I've put up a tentative fix on the `bug/1938` branch, pull it down with CocoaPods and see if it works for you. I still need to add some tests but it should fix the issues you're seeing. Hey everyone,

Sorry for being late to the party here. @jshier and I discussed the changes that he put up in the `bug/1938` branch. I'm not surprised that fixed the issue for you @unusuallyreticent. You have to be very careful right now with the session override closures to make sure you don't shut off some of the functionality.

The change that @jshier made is switching that `taskDidComplete` closure over to a hook instead of an override. After quite a bit of debate, we realized that there shouldn't be any harm in this change since it was impossible to get the queue resumed without a huge amount of work. Therefore we're fairly confident this change won't break any clients out there now.

We're going to look to unify the override closures in AF5 or just remove them completely with the goal being to make sure their usage is clear and not easy to mess up. There is enough inconsistency right now that it can lead to issues like you experienced.

As for the NSLock leak, I've actually filed a radar against that specific leak and it was closed as a duplicate. That is not something we can do anything about right now unfortunately.

I've pushed up @jshier's bug fix into the `master` branch in d64afca3 and it will go out as part of the Alamofire 4.4.0 release here shortly.

Cheers. üçª  If you take a look at [our documentation for `validateCertificateChain`](https://github.com/Alamofire/Alamofire#validating-the-certificate-chain) you can see that it won't work will self-signed certificates. Setting that to false will likely fix your issue.  We are making good progress towards getting Alamofire building on Linux (checkout the `linux` branch to see) but we've run into a big issue. Aside from a few constants and other minor changes that can be worked around, the Linux version of Swift is missing the `Security` framework from Apple's platforms entirely. So all of the functionality that Alamofire's `ServerTrustPolicy` depends on does not exist on the Linux platform. There are a few options here:

1. Refactor Alamofire to decouple `ServerTrustPolicy` from `SessionManger`. This will be a bit of work (meaning time) and will mean the the Linux version doesn't have any SSL verification beyond what `URLSession` provides.
1a. In addition to decoupling `ServerTrustPolicy` and `SessionManager`, abstract `ServerTrustPolicy` enough that Linux devs could implement it themselves using whatever dependency they wanted.
2. Adopt an external dependency for Linux to provide said features and abstract the `ServerTrustPolicy` to use either implementation depending on the running platform.
3. Similar to 2, but also replacing the implementation of `ServerTrustPolicy` on Apple platforms to use the dependency on all platforms.
4. Nothing. No port of Alamofire to Linux until the Swift team can provide a useful dependency that comes with the language or default Swift installs.

Personally I lean towards 1, as we've always worked to not have any external dependencies in Alamofire. However, this would be a major refactor and may not ship until Alamofire 5. 2 or 3 have the benefit of being a behind the scenes change but would likely be even more work than whatever changes we want for AF5 and so may take even longer.

However, we wanted to open this discussion up to public feedback to gather input and suggestions from the community before we choose a path and move forward. Not AFAIK, but they are working on server side libraries that may cover some of the same things. Whether those would be suitable for what we need I don't know and it's unlikely those libraries will be usable until after WWDC this year. I'm going to email the Swift users list and see if anyone wants to add anything. That is certainly something we're hoping to avoid. We'd like to avoid any dependency as well, so we may just refactor and abstract `ServerTrustPolicy` at the same time so anyone who's interested could provide their own implementation of the functionality on Linux. The only explicit interaction Alamofire has with SSL is through the `ServerTrustPolicy`, which can be used the validate the certificate chain or pin a certificate. If you don't enable one everything is handled automatically through `URLSession`. Under Linux it would be the same thing. We'd just like to have community buy in on whatever solution we choose. `URLSession` supports the standard SSL validation that's required. `ServerTrustPolicy` goes beyond that by allowing for cert and public key pinning, revocation checking, and others. It's in progress, given that we haven't rectified the dependency on `ServerTrustPolicy` yet. It's up only for public review and perusal.  I've added option 1a based on @SlaunchaMan's suggestion. @IOOI-SqAR Thanks. That sort of framework is what we would need but I doubt it will be production ready very soon.

At this point it looks like we're going to abstract `ServerTrustPolicy` behind a protocol and offer an implementation on Apple platforms. Eventually we may be able to offer a cross platform solution using the planned Swift Security framework, but until then making it protocol based will at least allow non-Apple platforms to build their own implementations even if we don't ship it.

I'll leave this issue open for now, to track the progress, but it doesn't look like this work will happen until Alamofire 5 this summer.  Most likely this is a false positive or underlying Swift issue, but in the case that it isn't it appears to be triggered in your code, not Alamofire's. Alamofire only shows up in the call stack because the leaking code was called during response serialization. Perhaps letting Swift manage the intermediary array in your `initArrayFrom(data:)` method would help?
```swift
class func initArrayFrom(data: JSON) -> [ReservationSchedule] {
    return data.arrayValue.map(ReservationSchedulre.init(data:))
}
```
As an aside, the leak mentioned in the SwiftyJSON issue is different from the one your reported in your StackOverflow question, and is a false positive.  @gperdomor You can clean up your response parsing by using `guard`s in that statement. But really you should be writing a custom serializer to better encompass your logic, as I demonstrate in [this gist](https://gist.github.com/jshier/f356bfb5b6dc634b67b14ddb75bd7279) or as you can see in our documentation. I also suggest not using so many implicitly unwrapped optionals, you'll get unexpected crashes that way.   Hi @akkuprin,

This is not a change that should be part of Alamofire itself. The `$` character is a supported ASCII character which [should be supported](http://stackoverflow.com/a/4410331/1342462) by servers. Here's a quick example of sending headers with `$` embedded in both the header fields and values.

```swift
func testDollarSignsInHeaders() {
    let expectation = self.expectation(description: "request should succeed")
    let headers: HTTPHeaders = [
        "foo": "b$r",
        "currency": "$for$dollars",
        "$momoney$": "$$$cash$$$"
    ]

    Alamofire.request("https://httpbin.org/headers", headers: headers).responseJSON { response in
        debugPrint(response)
        expectation.fulfill()
    }

    waitForExpectations(timeout: 20, handler: nil)
}
```

What you should do instead in this case is pre-encode your headers before adding them to Alamofire. If they need to be escaped, it needs to be you who does this because Alamofire can't know whether or not you need to actually escape the `$` symbol.

Thanks anyways! üçª  This doesn't seem like a good idea, as any API call you make before pinning the public key could be intercepted and an malicious hash returned. I'd be very careful here @sagarpatkar with this type of approach as @jshier mentioned. Accepting new certificates from the server to use for future request pinning is a pretty big security risk, even when cert pinning that original request.

With that said, you should be able to use TrustKit with Alamofire if you override the challenge closure and evaluate the certificate chain using TrustKit. This would allow you to evaluate the cert chain returned by the server against an HPKP pre-generated hash even though we don't directly support that in Alamofire.

Cheers. üçª  It's not built into the top level APIs but you should be able to pass a `URLRequest` through two different encodings with no issue. I'd recommend encapsulating such logic inside a [router](https://github.com/Alamofire/Alamofire#routing-requests) as described in our documentation.  Hi @WillBishop,

There's an example right in the [README](https://github.com/Alamofire/Alamofire#download-file-destination) on how to do exactly this.

If you continue to have issues, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @donpironet,

You're calling the method incorrectly. Instead, you should use:

```swift
self.request("someurl", method: .post).responseJSON { response in
    debugPrint(response)
}
```

If you continue to have issues, please read through the [README](https://github.com/Alamofire/Alamofire/blob/master/README.md), then I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Alamofire does no string encoding of it's own, it just uses `JSONSerialization` to create the `Any` value from the returned JSON. This may be something strange with `print` or even something with your server's response.

Also, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Closing this to move discussion into #1935.  Hi @zhukexiang,

The `destinationURL` is not cleaned up by Alamofire unless a new file is downloaded to replace it. If you're certain it was successfully placed there by Alamofire, then I'd suggest looking through the rest of your code to see what could be going on.

If you continue to have issues, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the report. This may or may not be related to the extension issues. While I see a different in the response of the two session types, both eventually return an error, though the background session took longer. With my internet offline, the foreground session returned:
`FAILURE: Error Domain=NSURLErrorDomain Code=-1009 "The Internet connection appears to be offline."`
The background session returned:
`FAILURE: Error Domain=NSURLErrorDomain Code=-1001 "The request timed out."`
I'm not really surprised they respond differently, as background sessions are pretty different.

Here are my communicators:
```swift
struct Communicator {
    
    static let shared = Communicator()
    
    let manager: SessionManager = {
        let policy: [String : ServerTrustPolicy] = ["httpbin.org" : .pinCertificates(certificates: ServerTrustPolicy.certificates(), validateCertificateChain: true, validateHost: true)]
        let configuration = URLSessionConfiguration.default
        configuration.httpAdditionalHeaders = SessionManager.defaultHTTPHeaders

        return SessionManager(configuration: configuration, serverTrustPolicyManager: ServerTrustPolicyManager(policies: policy))
    }()
    
}

struct BackgroundCommunicator {
    
    static let shared = BackgroundCommunicator()
    
    let manager: SessionManager = {
        let configuration = URLSessionConfiguration.background(withIdentifier: "com.jonshier.AlamofireTest.ShareUpload")
        configuration.httpAdditionalHeaders = SessionManager.defaultHTTPHeaders
        configuration.sharedContainerIdentifier = "group.com.jonshier.AlamofireTest"
        
        return SessionManager(configuration: configuration)
    }()
    
}
```
Perhaps you just need to wait a little longer? Hi @ened,

Background sessions have completely different behavior as @jshier eluded to. They have all sorts of internal handling for retrying failed requests over super long periods of time in situations where there are challenges, redirects and especially connectivity errors. What you're seeing right now is that when connectivity is lost, the background session's request won't actually throw an error. It will wait until the `timeout` specified on the `URLRequest` is reached before returning the timeout error as @jshier pointed out.

If you MUST use background session downloads and you need to tell the user more abruptly when connectivity is lost, you could use the `NetworkReachabilityManager` to cancel the background request or you could shorten the `timeout`. I think I'd recommend shortening the timeout for now and seeing if that can get you where you need to be. But keep in mind that in other parts of the world (especially China) there can be significant connectivity lag that could trigger false / positive failures if you shorten it too much.

Best of luck! üçª @quhaoran007
If you've seen the WWDC sessions or read the updated documentation for the `URLSession` changes in the new OS versions you've seen that they introduced the notion of delaying requests while waiting for connectivity. Turns out, background sessions had this functionality all along, and that's what you're seeing here. Unfortunately Apple hasn't really documented all or even any of the other behavioral differences you might see in background sessions, so there's not a lot of help we can provide at the moment. We do hope to improve our background integration some time this year.  Yes, background sessions are still background even if your app is in the foreground. They don't change behavior. The way Apple explained it when introducing the `waitingForConnectivity` functionality is that your timeouts only apply once the session has been able to reach the server once, at which time the request timeouts would take effect. If the device is offline when the request starts, the request timer will never start as the background session waits for connectivity. 

Unfortunately there's not a lot we can do here, as background sessions are largely a black box. They have a variety of different behavior that isn't documented. I suggest you rethink how you're making requests and consider how you want to be using background sessions, as they're really only designed for downloads or uploads you need to continue even if the app is suspended in the background.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks @fulldecent...that was definitely wrong. I had to tweak your changes a bit and pushed them up into `master` in f3e250ab while keeping your attribution. This should go out shortly as part of the Alamofire 4.3.0 release.

Thanks! üçª  Thanks for the report, we'll look into this. This may or may not be related to #1851. @nickvelloff @0xc00010ff I was able to create a project which uploaded images from disk from a share extension. Initially, when declaring the `SessionManager` locally, I was getting the uploads cancelled as well. However, moving my `SessionManger` into a singleton so that the reference stays alive allowed my uploads to complete. Now, I don't know how long the share extension process stays alive after posting, but it was offscreen for a few seconds before the upload finished without completely killing the share process. 
```swift
struct BackgroundCommunicator {
    
    static let shared = BackgroundCommunicator()
    
    let manager: SessionManager = {
        let configuration = URLSessionConfiguration.background(withIdentifier: "com.jonshier.AlamofireTest.ShareUpload")
        configuration.httpAdditionalHeaders = SessionManager.defaultHTTPHeaders
        configuration.sharedContainerIdentifier = "group.com.jonshier.AlamofireTest"
        
        return SessionManager(configuration: configuration)
    }()
    
}
```
But in general, yes, a `SessionManager` needs to live as long as its transfers do, if only because, when it's `deinit`d it cancels its outstanding tasks. This is, perhaps, technically incompatible with background sessions, but it should suffice for any scenario where the containing process lives long enough.

I'll keep this issue open for now to see if this solution works for you. I agree here with @jshier's assessment. The only thing I'd like to add is that I'm not sure if you're extension will be relaunched in the background once the transfer completes after it has been terminated by the OS. I would assume it would, but I'm not positive. You'd have to test this on a device to know for sure with an upload that was big enough to make sure the extension was actually shut down.

Another approach here would be to have the client application make the request on your extension's behalf if you can't get the background sessions working correctly with the extension. Background sessions certainly work correctly in the app, but may have different behavior in the extensions. Just something else to consider.

I'm going to close this issue out for now since there's nothing actionable here for the AF team. Feel free to continue to comment on this issue and we'll happily re-open if anyone finds anything that needs further investigation.

Cheers. üçª @nickvelloff Do you have any documentation you can point us to regarding the lifetimes and environment of extensions? I'm not sure what you're talking about here. Using a singleton (or any long lived instance) just ensures that the `SessionManager` doesn't cancel the requests until much later. It's still `deinit`d when the extension is exited. But yes, Alamofire would need some fundamental behavioral changes for background sessions to support this sort of use properly. Not the least of which is not cancelling background tasks when the `SessionManager` is `deinit`'d. We'll take a look at this more in the future.  I'm closing this. If someone in the community wants to help out @TannenBiff, then feel free to continue the conversation through this issue.  Hi @Bouke!

Without more detail on your "typed requests", I think you can accomplish what you want much more simply by following the patterns we lay out in our `README`. I'm guessing that you've been able to get your response methods working, which is great, so I'll focus on your request methods. 

Rather than subclassing, perhaps you can start by extending. In my current project I've created a couple protocols to help encapsulate the routing and parameters of each request. It's easy to hook this into Alamofire with the following extension:
```swift
extension SessionManager {
    
    func request<T: URLRequestRoutable>(_ parameters: T) -> DataRequest {
        return request(parameters.route)
    }
    
}
```
By combining this with a [`Router`](https://github.com/Alamofire/Alamofire#routing-requests) or some other sort of `URLRequestConvertible`, a proper `ParameterEncoding` to generate your SOAP requests, and a custom `ResponseSerializer` to generically serialize your responses, you should be able to accomplish what you need with subclassing at all. 

Does this give you an idea of a different approach to take?
 What I was trying to point out is that your wrapper is largely unnecessary and really goes against the grain of Alamofire's architecture, which you've already felt. Everything you're doing is already doable using the protocols and functions built into Alamofire. Now, I'm not really familiar with the requirements of a SOAP API (thankfully), but looking at your code, you need just a few things. But first, some general design philosophy.

As you noticed, chaining is at the core of Alamofire's design philosophy for the top level APIs. The ability to pipe a single request through multiple response serializers, or generally, any request to any supported serializer is key to the success of the framework. This is also one of the reasons why Alamofire's various `*Request` types are not generic. Fundamentally the request you make shouldn't impact the type you serialize from its response. This way you can chain whichever response serializers onto the request you want and all of them will take the same response data and return whatever types they need. The `Request<T>` type you've shown has really nothing to do with the various requests types used by Alamofire.

So, like I said, there are few things you specifically need here. Protocols for your requests and responses (perhaps `SOAPEncodable` and `SOAPDecodable`).  A `ParameterEncoding` generate your requests (usually inside a router of some type), or some combination of `SOAPEncodable`, a router, and a `ParameterEncoding`, let's call it `SOAPActionConvertible`. Also, a generic response serializer, `SOAPSerializer<T>` would serialize the responses. Then you'd ultimately have extensions, like I've show, that would result in functions like this:
```swift
func perform<T: SOAPActionConvertible, U: SOAPDecodable>(_ action: T, completionHandler: @escaping (_ response: DataResponse<U>) -> Void) -> DataRequest {
    return Alamofire.request(action).responseSOAP { response in
        completionHandler(response)
    }
}
```
Where `responseSOAP` is a generic extension to `DataRequest`:
```swift
func responseValue<T: SOAPDecodable>(completionHandler: @escaping (_ response: DataResponse<T>) -> Void) -> Self {
        return response(responseSerializer: SOAPSerializer(), completionHandler: completionHandler)
    }
```
Then, you'd generate your `SOAPActionConvertible` types and your `SOAPDecodabe` types based on your WSDL. You can then use this single path through Alamofire to perform your requests.   The HTML you received probably contains information about the error the server is returning. I suggest you investigate that.

Also, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @liangquandeng,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @Ingibjorg,

It looks to me that your app is running out of memory. I would venture a guess that you're making a data request to a resource that is too large to download in-memory. If this is the case, you should switch over to using a DownloadRequest so the data is streamed to disk rather than being stored in memory. You're app is only allowed so much memory and things like download giant images or small videos to your in-memory store using `Alamofire.request` instead of `Alamofire.download` can quickly get you into trouble.

Hopefully that helps get you going in the right direction.

Cheers. üçª  Hi @monish152,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @faisalrasbihan,

The only obvious issue I see if that in both cases of getting a new access token you're calling `completion` with a value of `false`. It should be `true` when `accessToken` is not `nil`. Other than that, I don't see anything obvious. It's most likely an order of operations issue or you have threading issues in you `retrieveNewToken` logic or `retrieveNewToken` is being called multiple times. You'll just need to continue to debug further.

If you continue to have issues, then I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  @cyberdude This looks fine. Is there someplace where changes like this are tracked? I'm not seeing anything in the SPM docs about it being required now.  Hi @yjb94,

If there's no content-length being returned for that image URL, then progress reporting won't work. iOS defaults to `-1` when it doesn't know what the total image size will be.

If you have further questions, then I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @sathamkhussain,

I'd follow @sahandnayebaziz's advice here and open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Can you post the code that's causing the crash, along with the versions of Alamofire, Xcode, the operating systems you're seeing the crash on? @suniljakhar we need a working example here that demonstrates the issue in order to continue to investigate. I'm very doubtful here that the issue is Alamofire itself, however, I want to give you the opportunity here to have us help you investigate further. We just need to do your part and give us more to work with.

I'm going to leave this open for a few days for you to get us more info. What do you mean by you created a `URLSessionDownloadTask` and then you use `moveItem` and everything is working fine? Does that mean you created an example that doesn't use Alamofire and there are no memory constraint issues like you're seeing in Alamofire? @jshier would you be able to investigate this issue to see what's going on? @suniljakhar I've created a test project using Xcode 8.2.1, Alamofire 4.3, and an iPhone 4S running iOS 9.3.5 (only other iOS device I have) and I can't reproduce your crash. I was able to successfully download a 1.4GB file on the device and move it to my documents folder. Please retest using the latest versions of Alamofire and Xcode. If you still get a crash, please post the crash log. @cnoon Only other thing I can think of is an iOS 10 issue, do you have an older iOS 10 compatible device to test with? I'm in the process of acquiring one but it'll be a week. Hmmm...I might @jshier. Could you post your sample project here so I have it just incase? We could also just try the sample project on a newer device running iOS 10 and monitor the memory usage. It shouldn't have to crash for us to be able to detect a memory spike. Here's my test project, though it has a lot of different test bits, and my original download file was local, since the sites I found that do simple test file downloads were pretty slow. 

[AlamofireTest.zip](https://github.com/Alamofire/Alamofire/files/802400/AlamofireTest.zip)
 @suniljakhar I've run my test project on an iPhone 5s running iOS 10.2.1 and it worked without issue. I'm closing this issue, as we can't reproduce it. If you come up with a test project that reliably reproduces the issue, let us know.  Hi @appmagnetics,

Most likely the issue is due to you converting your data types over to Objective-C, then trying to implicitly covert them to `Any`. Instead, get rid of your `NSNumber` and `as AnyObject` casts and things will probably start working.

If that doesn't fix things up, then I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Error 3840 is `JSONSerialization`'s way of telling you that it didn't receive valid JSON. Most commonly this is caused by the server returning an HTML error page of some kind.

Also, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Alamofire isn't that big of a library and should only take a few seconds to build. However, the cost of supporting prebuilt binaries isn't that big, assuming we can get our TravisCI setup to do it automatically. That refactor likely won't be easy, as we don't have anything like it at the moment. Luckily Carthage does have some documentation for it.

@cnoon I'm marking this up for now and assigning to us both. Let me know if you don't think we should do it, otherwise I may be able to get around to it eventually. That's rather absurd as it takes less than 10 seconds on my local machine.  Hi everyone,

Thanks for the healthy discussion here and the willingness to help get things implemented. I feel it's very important for everyone to read through #588 before reading the rest of my reply. 

I still feel like this is a slippery slope that I'm not willing to dive into just yet. The Alamofire team spends a tremendous amount of time on CocoaPods and Carthage build issues. We've managed to narrow down some of the Carthage issues, I'm sure, by not supporting this in the past per [Apple's recommendation](https://developer.apple.com/swift/blog/?id=2).

IMO we're still not that far from where we were in the Swift dependency management world when #588 was initially filed. I think we'll still run into Swift compatibility issues as soon as we start deploying those pre-built binaries. Once Apple starts shipping the swift runtime as part of the OS, I'd be much more keen on supporting this feature. From what I've been able to find there are alternative ways to grab pre-built binaries from your own hosted solutions to use with your CI instances.

Once Apple starts shipping Swift with the OS, we will look to re-open this issue and get it implemented. But until then, let's hold off.

Cheers. üçª  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  As you can see, this is a CocoaPods error. It should be taken care of in 1.2 (it is for me), but there's nothing for Alamofire to do here.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Make sure your version of CocoaPods is updated to at least 1.1, as previous versions didn't know about the `SWIFT_VERSION` setting, but after 1.1 it will use the project's setting for the Pods and should work fine.  A `401` error is the standard `Unauthorized` HTTP error code. However, Alamofire does not provide a translation of codes to standard descriptions, mainly because it wouldn't be that useful for most people and also because some servers use different response codes to mean different things. Plus, not all possible codes have good descriptions.

If you want you can wrap the errors returned by Alamofire in your own errors, which gives you a chance to add your own descriptions to be printed. I've used that behavior myself. Would that accomplish what you want? It's easiest if you're already using your own custom `ResponseSerializer` and could be a good reason to create your own (they're straightforward). It hasn't been updated for Alamofire 4, but [this gist](https://gist.github.com/jshier/f08f08e05d994b5bdc7d) should show you what I mean. As you can see, at each step of the process I wrap the possible errors in different cases of my own `Error` conforming `enum`. Then within that `enum` you can parse out the errors and provide your own `localizedDescription` for them. Yes, the particulars of the generic serialization are up to your implementation. In my example I'm using the Argo library to decode my JSON responses, hence the use of its `Decodable` protocol. If you don't already have custom serialization you may want to start simple and just duplicate the existing `responseJSON` function, but with your own error handling. Custom response serializers really start to shine when you create your own generic decoding into strong types, as [demonstrated in our README](https://github.com/Alamofire/Alamofire#custom-response-serialization). @jshier Hi- I have hit a brick wall with this. Have spent ages googling for the answer - and it seems a lot of people are just as confused as I am.  Would be massively greatful for some more  guidance. 

It seems that the implementation that is done in the Readme does not match up with the implementation. in 'ResponseSerialization.swift' file.  

I have tried copying the current implementation for ResponseJSon, renaming it to "ResponseJsonSimple" and adding a switch statement to the error code however the only property that xcode says is has is error.localized Description.  I can't seem to get the error codes to add them to the return statement. 

Here is the Gist: https://gist.github.com/grantkemp/bb00419f8a84c2698d56fcf64b127ba0

Can you run through the exact steps I should follow in order to add these custom error codes in for these common error codes like 404, and 403.  It feels like something that should be quite basic to add in - and a common use case.  Ignore what I said above.  I think I have cracked it.  I also think I might be in love with Custom Serializers..  Even though I haven't fully got to grips with them - I really see the promise now..  Very painful getting to this point- but it was completely worth it.   These don't seem to have anything directly related to Alamofire. I suggest you report these crashes to Apple and see what they say. Also, asking a question on StackOverflow will get more eyes on these issues than you'd get here. I'm closing this, but please let us know if you learn anything more about this apparent increase in crashes on iOS 10.2.  @Dschee I appreciate your work on this. However, I'm not sure this scenario is common enough to need top level APIs dedicated to it. Once Alamofire usage has reached this level of complexity (covering an entire JSONAPI setup), users should really be adopting a variation of the `Router` pattern. This can fairly easily cover the scenarios you require by using multiple encoders. Ultimately, it seems like there are few options here:

1. Add top level API for encoding both URL and body parameters into a request, as demonstrated in this PR.
2. Add a specialized `ParameterEncoding` conforming type that can take both url and body parameters as well as their encodings and generates a request.
3. Both 1 and 2.
4. Nothing, and let users add their own particular implementations.

I think perhaps 2 is the way to go if we want to support this, as I really don't think this is common enough to need the additional complexity of adding and refactoring the top APIs for it.

@cnoon, what do you think? I'm not particularly sold on any solution (or not) here. Hi @Dschee,

Thanks again for your efforts here. We greatly appreciate new ideas on how to make improvements. @jshier talked it through while we like some of the ideas here, we don't think they have a place directly in Alamofire for a couple different reasons.

The first reason is that the top level APIs are designed for convenience for the common use cases. We try to have as few as possible to make it easy to decide what you're looking for. As soon as you start adding query parameters, query encoding and http body parameters in the same top level APIs, you're outside of the normal cases for sure. So that's the first problem. We don't want another top level API. Not to mention a top level API that needs two more parameters.

The second problem is that even if we did allow the API with the additional parameters, it's really easy to misuse the encodings. If you mix up either of the encodings or the parameters you're in trouble and it won't be very easy to debug what's going on. For example, if you accidentally use `URLEncoding.default` for your query parameters (which I believe you did you your PR), you're in for a world of hurt with a `.put` or `.post` because the parameters will be encoded in the body in those cases then potentially replaced by the body parameter encoded data.

Overall, we don't really want to add another top level API, and if we did, it would need to be very difficult to misuse.

Thanks again. üçª  Unfortunately, at no point in the request process do we have a chance to change the headers added by the `URLSessionConfiguration`. Additionally, changing the `URLSessionConfiguration`'s `httpAdditionalHeaders` on a per request basis is a bad idea for many reasons, not least of which is the difficulty of keeping such a thing thread safe. As we suggest in our README and Apple does in their documentation, you should set `httpAdditionalHeaders` at the time you create the `URLSessionConfiguration`. If you need headers that aren't always in requests I suggest you do so at the time you create your `URLRequest` or using a `RequestAdapter`.  Thanks, we'll take a look @Dschee. However, you can already accomplish this by using the `URLEncoding` `ParameterEncoding` on the `URLRequest` and then passing that `URLRequest` into `request()` as you're doing, where the body will be `JSON` encoded. So really this is just a slightly more convenient version of that. Perhaps a more general solution would be to create a `ParameterEncoding` that can take sets of encodings and parameters and applies them to a request all at once? Hi @Dschee,

Thanks for taking the time to put this together. I'm afraid this addition isn't something we'd like to have in Alamofire. It is confusing to parameters going into both your `QueryURL` and into the top level APIs.

With that said, feel free to use this all over in your own projects. There's nothing wrong with doing what you are doing, it could just lead to misuse and confusion among the AF community.

Thanks again. üçª  Your code samples seem to be identical.

However, we've seen this before, as some servers don't like `bodyData` in `GET` requests. Make sure you're using the correct parameters encoding for `GET` requests on your server.  @reshadf Agreed, we should add SPM directions to our `README`. However, I wouldn't suggest using it if you're developing for Apple platforms unless you're prepared for the integration burden it presents. @reshadf @indrajitsinh @AndrewSB 
I've opened #1898 to add brief instructions to the README, let me know what you think. I really don't think SPM is very useful at the moment, but our current integration works and I was able to create a simple test project pretty easily. Resolved by #1898.  Anything you're comfortable with. I took care of it myself, but small issues like #1871 are a good place to start. Also, documentation editing is a good way to introduce yourself to the codebase without having to worry about writing code. Thanks for the interest!  As you can see in the header documentation, this error is returned when the response unexpectedly return nil or zero length data. I suggest you investigate.

However, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  @ssam2000 It seems likely you've got an issue with creating your requests. However, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  @cnoon designed this API, but I believe it was to match the previous `enum` implementation and assist people in transitioning to the new version. It also establishes the general pattern of convenience static properties for preset values. You're right, these could (and likely should) be singleton values, rather than generating a new one every time, but that rather minor refinement can be made at any time. @cnoon, anything to add? Closing this for now. @cnoon, if you have anything else to add please do so.  A good idea. I've opened #1880 to take care of this.  It sounds like you tried to upload just a framework or something else.

However, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Issues like this aren't generally Alamofire specific issues. I suggest you redo your Carthage integration and go from there. Otherwise, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com).

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  It looks like the server isn't properly returning an `Expected-Length` value for HTTPS requests. You can confirm this by inspecting the headers returned for your request. I suggest reaching out to the server administrator to see if they can fix the issue. If you can find an issue in Alamofire itself, please open another issue and we can investigate.  @SkyMatt70 It sounds like you may not have the appropriate version of Alamofire installed. Perhaps there's an old build product around?

@laurent-humbert Make sure all of your types are appropriate (perhaps drop the `responseJSON` until the rest compiles), as it may just be a bad compiler error. 

However, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com).

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Awesome...thanks @ulugbekrozimboyev! üçª  This PR modifies the `DefaultDataResponse` and `DefaultDownloadResponse` initializers to be `public` instead of `internal`. This allows you to rebuild the responses if necessary in client code to do things like wrap the `error` in your own custom error or modify the server data or possibly inject a missing header, etc. The main use case is to wrap the `error`.

This PR also adds convenience properties to the `DataResponse` and `DownloadResponse` structs for accessing the `value` and `error` in the result. Both of these computed properties are merely for convenience. @groue I think the functional approach your PR creates is great, and I'm sure many developers will be comfortable there, but there is an argument for the straightforward use of an initializer. Depending on whatever else there doing, one approach may be more readable than the other or fit better with their other code.  Thanks for the feedback @groue! I agree with @jshier that both are useful. Apologies for your PR being left out there without feedback. We got pretty busy with the holidays and haven't been able to keep up with all the great work coming in.  Thanks @brow! üçª  Hi @yigitserin,

First off, AF 4 will not crash with an invalid URL string, but AF 3.x and below certainly will. In AF 4, we now throw an AFError.invalidURL error in the response handlers.

Secondly, you should use the built in URLEncoding in Alamofire, `URLComponents` and `URLQueryItem`s  or use the percent escaping APIs to ensure your URLs are properly encoded. If you have issues using any of these approaches, then I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  If you look at [the source](https://github.com/Alamofire/Alamofire/blob/master/Source/SessionDelegate.swift#L112), the screen shot you've posted doesn't match, so your Alamofire installation is out of date. Update and it should work fine.  As you can see [in the source](https://github.com/Alamofire/Alamofire/blob/master/Source/SessionManager.swift#L56), `defaultHTTPHeaders` is a `static` method, not an instance one.

Your error is usually due to some type mismatch that the Swift compiler can't give a good diagnostic about.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com).

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.   You're likely falling afoul of some URL encoding issues, as your server may not expect raw Korean in the query.

Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. Feel free to open another issue if you find a reproducible bug in Alamofire.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Right now the best way to accomplish that is to put such error handling inside your response serializer. That way you can share code between your normal response handling and the special error handling. We're hoping to revisit the `validate` vs. `response` functions in the future, but for now this should work. Attaching the response body to the error is unlikely to happen, as the data could very large, even if we refactor the `validate` vs. `response` handling. I suggest you look into customizing your response serializer. This error is used for any response code outside the valid range, which could be customized in ways we can't anticipate, including use in a backend system that includes large responses, intentionally or not. There is no single standard practice here so we must be conservative when offering default behaviors.

Like I said, customizing the response handler is appropriate place to put this logic for now. Our response handling is [well documented](https://github.com/Alamofire/Alamofire#response-handling), even for [custom cases](https://github.com/Alamofire/Alamofire#custom-response-serialization).  Hi @sonysum,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  I've verified this is in fact a bug. Should be a simple fix. I just put up PR #1864 to address this issue. I'm going to close this issue out. Please direct all future comments to #1864. Thanks @ejensen for filing! üçª  The `URLSession` APIs have a max concurrent limit of tasks being executed. It is set to 4 per host by default on iOS. See the [`URLSessionConfiguration`](https://developer.apple.com/reference/foundation/urlsessionconfiguration/1407597-httpmaximumconnectionsperhost) docs for more info.

Cheers. üçª  Hi @adrianbrink,

What I'd suggest here is that you turn off the pinning for now just to try to get things working. If you do, can you get calls through? Can you make calls from the Today Extension to something like `httpbin.org`?

I haven't tried to use Alamofire in a Today Extension, but everything should work properly. The most common issue we see with cancellation errors is that the session manager is going out of scope. Are you positive yours isn't being deallocated?

Is there any chance you could post a sample app? I can't really help you investigate further without one. Could either of you answer my questions above? There's not anything we can do without some more information. @subhajit1609 I've tested your scenario with the `ServerTrustPolicy` and it worked fine. It's possible your issues stems from the fact that your policy URL includes the scheme, which it shouldn't. Remote that and it should work correctly. 

@adrianodiasx93 I've tested your scenario and I was receiving the `-999` error when I was trying to pin a certificate that wasn't in the proper format. If you've downloaded a certificate as a `.pem`, you need to convert it to `DER` format before being able to pin against it. Once I did that I was able to run request from my app and today extension using the same setup.

It seems like both of these issues come down to a misconfiguration of certificate pinning, so I'm closing this issue. If either of you can come with a specific Alamofire issue we'll be glad to take a look. Just create a new issue with an example project.  This is just the way things work on Apple platforms with the `Authorization` header. The reason (we think) that Apple doesn't automatically pass that header through is that some servers will reject the redirected request if it contains the `Authorization` header and shouldn't.

We actually already have a [test](https://github.com/Alamofire/Alamofire/blob/master/Tests/SessionDelegateTests.swift#L418-L470) for this behavior as well as the implementation for how to modify the session delegate to actually pass that header through. If you implement something similar to that logic in your app, you should be good to go.

Cheers. üçª  There's no logic that I'm aware of to stop `JSONEncoding` in a `GET`. Here's what the `encode` method on `JSONEncoding` looks like in Alamofire 4.2.0.

```swift
public func encode(_ urlRequest: URLRequestConvertible, with parameters: Parameters?) throws -> URLRequest {
    var urlRequest = try urlRequest.asURLRequest()

    guard let parameters = parameters else { return urlRequest }

    do {
        let data = try JSONSerialization.data(withJSONObject: parameters, options: options)

        if urlRequest.value(forHTTPHeaderField: "Content-Type") == nil {
            urlRequest.setValue("application/json", forHTTPHeaderField: "Content-Type")
        }

        urlRequest.httpBody = data
    } catch {
        throw AFError.parameterEncodingFailed(reason: .jsonEncodingFailed(error: error))
    }

    return urlRequest
}
```

Am I missing something?  This is most likely due to some issue you have in your logic @sergiocg90. Many of us have apps shipped on AF 3.5.1 and aren't seeing this issue. Any chance you could post some sample code for us to better understand how you're making requests? The top of your crash stack, which contains `assertionFailed` and `StaticString` almost alway indicates the forced unwrapping of a nil value. In your code there are a variety of locations that could be causing that, so I suggest you audit your code for implicitly unwrapped optionals and make it a bit safer. Symbolicating your crash stack properly would probably help you find it as well. In any event, if can narrow the crash down to something caused by Alamofire and can create a sample project that replicates the issue, feel free to file a new issue with the sample project. Until then, there isn't enough here to narrow down a cause, but there's enough in the code you posted for me to say that it likely isn't caused by Alamofire itself.  Sounds like some local setup issue and not something directly related to Alamofire. I'm going to close this issue out for now, but feel free to continue to discuss here.  Thanks @zhongwuzw for putting this together. I made a small tweak and pushed it up into `master` in 05c9bcdc. It will go out in the 4.3.0 release most likely. Thanks again! üçª  Hi @black-lotus,

The `response` method signature has changed. Just comment out your old code and use auto-complete to rebuild your logic. Please check out our [AF 4 migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md) for more info. 

If you continue to have issues, then I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  It is possible to set the concurrent count on a `URLSessionConfiguration` to 1 using the `httpMaximumConnectionsPerHost` property, but that's still not going to be what you want. It won't have enough thread safety for you to deal with JWTs.

Instead, you should check out our `RequestRetrier` example in the [README](https://gist.github.com/cnoon/fa26a5059ecddfb6756a#requestretrier). It breaks down all the thread safety needed to refresh your JWT and restart the requests. While that example doesn't handle all the cases needed for thread safety, it certainly gets you started in the right direction. We use a VERY similar design with our internal networking library at Nike that's built on top of the `RequestAdapter` and `RequestRetrier` protocols.

Cheers. üçª  The general fix for this issue is to ensure all of your dependencies have a `SWIFT_VERSION` of `3.0` and not the `3.0.1` that Xcode 8.1 may have entered. We'll update the Alamofire projects to make sure they work, but if you're using CocoaPods, setting your main project to `3.0` should set all of the pods to that version as well. There's nothing to change here for Alamofire, as I've verified that it builds fine in Xcode 8.2. Ultimately the solution here is to edit your app project files and replace every instance of a `SWIFT_VERSION` of `3.0.1` with `3.0`.  Closing with the same response as #1839.  There's no rfc spec around collection URL encoding. What you're seeing in Alamofire is our default implementation. If you need the indices, you'll need to create your own custom `ParameterEncoding` to add the indices. This can be accomplished by using the `URLEncoding` implementation as a guide.

For more info on creating a custom `ParameterEncoding`, please refer to our [example](https://github.com/Alamofire/Alamofire#custom-encoding) in the README. For more info on the current `URLEncoding` implementation and reasoning, please refer to the [docstrings](https://github.com/Alamofire/Alamofire/blob/master/Source/ParameterEncoding.swift#L62-L69).

Cheers. üçª  Hi @Insofan,

It works fine when things are setup correctly. If you're having trouble with autocomplete, I'd suggest you take your question to [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. Someone should be able to help you get to the bottom of your issue. Most likely you need to clean your project and possibly delete DerivedData. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  We'll certainly look into this and get back to you @Khalian. Thanks! üçª Hi @Khalian,

I've just created an `Alamofire/Alamofire` chatroom with public permissions and I've just invited you to it. I'm going to add the badge to the README as well. We'll see if it ends up getting some use or not. Thanks for the suggestion!

Cheers. üçª  I'm researching what `flatMap` does to the `Result` types of other languages, but for now this use looks fine.

One thing I would also like to see, even if it's not strictly part of the functional paradigm, are closures which can access the `Result`'s error without transforming them. I've defined the following extensions in my last few projects:
```swift
@discardableResult
func onSuccess(_ success: (_ value: Value) -> Void) -> Result {
    if case let .success(value) = self { success(value) }
    
    return self
}

@discardableResult
func ifSuccess(_ success: () -> Void) -> Result {
    if isSuccess { success() }
    
    return self
}

@discardableResult
func onFailure(_ failure: (_ error: Error) -> Void) -> Result {
    if case let .failure(error) = self { failure(error) }
    
    return self
}

@discardableResult
func ifFailure(_ failure: () -> Void) -> Result {
    if isFailure { failure() }
    
    return self
}
```
I think something similar could be helpful, perhaps in combination with `.mapError` and `.flatMapError` or something.

@cnoon Any input here? My main concerns with `dematerialize` vs. `unwrap` are 1) translation between other `Result` types in Swift and ours, namely antitypical/Result, which already use `dematerialize`, and 2) supporting the symmetrical operation of `materialize`, which I'm not sure works well if it's just `wrap`. But that's fine.

We want this functionality, we just have to iron out the naming and how far we want to go. Because while it may be about better response handling for you @groue, making it easier to use `Result` in any scenario is a good idea. Thinking about it more, it would probably help interop if we used `wrap`/`unwrap` and let antitypical/Result use `materialize`/`dematerialize`, so I think I've just convince myself we're good there. Mostly naming at this point, as we want this functionality. We're already using a `Result` type, so its existence is beyond question, so this is mainly about what other functionality it should have. Hi @groue,

My apologies for not getting back to you sooner. I wanted to make sure I had time to dig through this before giving you some direction. üòâ 

I think you're right on point here. The only thing I've found that I "think" is incorrect is this code sample from your original post. Wouldn't this return `Int` or throw rather than returning a `Result<Int>` from the `unwrap`?

```swift
func f(_ data: Data) -> Result<Int> { ... }
let result: Result<Data> = ...
result.flatMap { try f($0).unwrap() } // Result<Int>
```

> Just making sure...

## Unwrap vs Dematerialize

As for unwrap vs. dematerialize...I'm much more of a fan of unwrap. Much more straightforward. Sounds like that's where all of you have landed anyways, so yay!

## Factory Method vs Initializer

As for the factory method or initializer, I'd vote initializer just like you posted in your last example.

```swift
let result = Result(value: { try Stuff(json: json) })
```

## Steps to Getting Merged

Now there are a few things we'll still need to get into this PR to get it merged.

### Result initializer

As mentioned before, let's get this added along with tests.

### Tests

Could we get tests for the `DataResponse` and `DownloadResponse`? You can just throw them into new test cases in the `Response.swift` for now.

> We're going to reorganize the test suite here at some point.

### Documentation

Let's also get the documentation added to the README. I think you need to be extra careful here though in regards to threading. You're example you posted is nice and convenient, it could be a huge bottleneck for large payloads being serialized on the main thread.

```swift
func getStuff(_ completionHandler: @escaping (DataResponse<Stuff>) -> Void)) {
    Alamofire.request("https://httpbin.org/get").responseJSON { response in
        completionHandler(response.flatMap { json in try Stuff(json: json) })
    }
}
```

While convenience is great, bad performance due to lack of understanding of what's running where is the last thing we want. Please be careful to point out these types of considerations when putting your documentation together.

Once you get the PR updated, please rebase on top of `master` (just to catch up) and we'll work to get this merged as part of the Alamofire 4.4.0 release.

Thanks again for all the hard work here and again our apologies for this being as delayed as it has been. üçª Okay @groue, I just squashed your PR down and made a few formatting and documentation tweaks and pushed it up into `master` in 7f8fe9c7 while maintaining your attribution. We can't thank you enough for all your great work here and persistence given the fact that it took us a long time to get this feature added in. I think it all paid off very well though given the final result.

These changes will ship as part of the Alamofire 4.4.0 release here shortly.

Thanks again! üçª  Hi @jakjothi,

Could you provide more data? Is it a specific type of request you're making? What version of Alamofire are you using? What does your `Podfile.lock` say? I've never seen anyone report that generating the metrics can fail, so I wonder if there's something unique that you're doing that is producing the issue.

Like I said, any more info you could provide could really help. Right now there's just not enough info to go on. If more people do end up having this issue though, we could make task metric generation optional in Alamofire. Okay @jakjothi, could you please give me a very clear, very descriptive breakdown of exactly what you're doing with the time settings to produce this error? The more description the better. Also, do you see this issue when you don't mess with the time settings? Since the core issue here seems to have been resolved in iOS 10.2, I'm closing this. Definitely something from the underlying networking frameworks here. If this crash recurs with the latest Alamofire and SDK version, please let us know.  Hi @payalbaldota,

I'm not really sure what to tell you here. We have [tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/DownloadTests.swift#L485-L544) that verify cancelling a download and resuming it works as expected in Alamofire 4.x. I'd check out that test to see if you can identify what you may be doing wrong in the cancel / resume logic.

If that doesn't help, then I'd suggest you take your question to [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @LYM-mg,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  As [noted in our documentation](https://github.com/Alamofire/Alamofire#modifying-the-session-configuration), adding `Authorization` headers at the session level is not recommended. However, we'll investigate whether we need change anything. I was unable to replicate your results with this simple test:

```swift
let communicator: SessionManager = {
    var headers = SessionManager.defaultHTTPHeaders
    headers["Authorization"] = "Token"
    
    let configuration = URLSessionConfiguration.default
    configuration.httpAdditionalHeaders = headers
    
    return SessionManager(configuration: configuration)
}()
    
let goodSite = "https://httpbin.org/get"
let badSite = "https://httpbin.org/get"

communicator.request(goodSite, encoding: JSONEncoding.default).responseJSON { response in
    print(response)
}

communicator.request(badSite, parameters: ["key" : "value"], encoding: URLEncoding.default).responseJSON { response in
    print(response)
}
```
Both requests kept the `Authorization` header.

In any event, there's nothing Alamofire can do to the headers added through `httpAdditionalHeaders`, which is why we and Apple recommend adding the `Authorization` header a different way. 

Also, see my code for a more proper way to add custom headers to the `URLSession` while keeping the headers Alamofire generates for you, like `User-Agent`.  Thanks @muescha! üçª  Your observations are completely correct here @cmyers78. We've also found that challenges are not supported with background configurations. This is most likely so the daemon doesn't need to call back to the app each time a challenge is issued. This is not an Alamofire limitation, but a URL session one. If you'd like to see this behavior change, then I'd suggest filing a radar with Apple.

Cheers. üçª  Any support for `keep-alive` would come from the underlying `URLSession` APIs. Look into how to set it up there and applying those findings to Alamofire should be straightforward. Alamofire has no specific code for `keep-alive` support from the server. All of that would come from the underlying `URLSession` implementation, which should have support for it automatically, as it's part of the `HTTP` standard. Feel free to open a new issue if you run into any issues you can trace back to Alamofire. Otherwise, sites like StackOverflow or Apple's dev forums would be good sources of support for the underlying `URLSession` in regards to `keep-alive`. Yes, the Swagger code gen tool that's built on top of Alamofire is pretty poor quality and doesn't use Alamofire correctly in many ways. (The version built on top of AFNetworking has issues as well.) Modifying the generated code isn't really a solution, but perhaps you can modify the generator itself?  `eTag` is part of the underlying `URLSession` APIs used by Alamofire and we don't expose any high level APIs to interact with them directly. If you need direct control, I suggest you look into how they're normally exposed to the `URLSession` APIs and how they work in general. Supporting them should really be automatic or as simple as attaching a header like any other. Feel free to open a new issue if you run into issues that may be Alamofire bugs, otherwise general support from something like StackOverflow will probably answer the questions you have.  It depends on the `RequestEncoding` that you're using. If you're using `JSONEncoding` with a `GET` request, your parameters are being encoded into the `bodyData` as `JSON`, which sets the `Content-Type` header. If that's not the behavior your server expects, change `ParameterEncoding` you're using for those requests.  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Hi @WataruSuzuki,

Could you provide a detailed writeup of this set of changes, the problems you were trying to solve and how the tests verify the behavior? The more detail the better. This will not only be for our own knowledge, but for those in the future to refer back to this ticket.

Thanks! üçª Hi @WataruSuzuki,

First off let me apologize for taking so long to go through this. Your patience is appreciated. I can also say that I'm very glad I waited until I had enough time to go through this throughly. The tests took me forever to understand exactly what's happening across all the versions of all platforms.

With that said, thank you so much for your efforts here on this PR. It's greatly appreciated! I've picked this PR apart into a bunch of different commits to test all the functionality and for my own understanding. Here's a breakdown of what I've added and modified in this PR.

- 22fec473 - Added TLS evaluation tests for revoked certs for no policy and default policy.
  - Contributed by me
- 52fc15e1 - Added revoked evaluation server trust policy to check for revoked certificates.
  - Contributed by you (refactored a bit by me)
- e8282c98 - Added server trust policy tests for revoked evaluation with varied host validation.
  - Contributed by you (refactored revocation flag by me)
- 74f64733 - Added TLS evaluation tests for revoked evaluation against revoked certificate.
  - Contributed by you (tweaked by me slightly with revocation flag)
- 2fd49975 - Updated TLS tests for tvOS 10.1 and added expiration test for revoked evaluation.
  - Contributed by me

What I was amazed to find is that it appears Apple has started enabling automatic revocation testing in the latest platforms (iOS 10.1+), but the test suite is so finicky that I had to disable the tests. Thankfully on all platforms, enabling revocation testing directly does result in consistent behavior.

Through most of my testing, I think you really want to weigh the tradeoffs of using `kSecRevocationUseAnyAvailableMethod` and `kSecRevocationRequirePositiveResponse` depending on what type of certificates you have deployed. If you have certs signed by a valid certificate authority, I think I'd recommend using the more secure `kSecRevocationRequirePositiveResponse`. You'll see in the ServerTrustPolicy tests that I switched over to the `kSecRevocationUseAnyAvailableMethod` flag since all the certs being tested were self signed which will always fail when trying to hit the server since they're not deployed.

> Sadly the documentation here is terrible and isn't very helpful. Take what I said above with a grain of salt. That's my best guess interpretation of all these tests and the limited documentation I could find.

Overall, thank you so much for bringing the revocation testing to our attention and going the extra step to implement it. I think this is a great addition to the Alamofire core library and we really appreciate you taking the time to put this all together. Great work!

Just FYI...these changes will ship as part of Alamofire 4.3.0 here shortly.

Cheers. üçª  This should be working correctly. How are you checking that the headers are sent properly? Relying on the server response isn't enough, you should use a tool that can show you the raw request sent (like the `curl` output of the `request.debugDescription`) to see whether the headers are actually being attached. This behavior works correctly @aronmoles, we have several tests ([test1](https://github.com/Alamofire/Alamofire/blob/master/Tests/RequestTests.swift#L59-L74), [test2](https://github.com/Alamofire/Alamofire/blob/master/Tests/SessionDelegateTests.swift#L418-L470)) verifying this behavior. Many of us also have libraries built on top of Alamofire that pass common headers through all the time and everything works as expected.

If you continue to have issue, then I'd suggest you take your question to [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. There someone can help you investigate further. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  There are many ways you could solve this. One of the simplest would be to use `.validate`, as described in [our documentation](https://github.com/Alamofire/Alamofire#response-validation) to ensure the response type is an image rather than the type of the error page.  You need to figure out what your server expects for a parameter encoding during a `GET` and use the included `ParameterEncoding` type to encode your requests, or write your own if none of our provided encoders meet those requirements.

Also, if you all could post what types of servers you're connecting to, it would be interesting to see what servers/configurations can't handle body data in `GET`s. Okay everyone,

Just to clear the air here, you can absolutely send JSON parameters on a `GET` request with Alamofire if you really need to. Here's an example of it in action.

```swift
func testJSONParametersAreSentInHTTPBodyOfGetRequest() {
    let parameters: Parameters = [
        "key1": "value1",
        "key2": "value2"
    ]

    let expectation = self.expectation(description: "Get should succeed")

    let request = Alamofire.request("https://httpbin.org/get", parameters: parameters, encoding: JSONEncoding.default).responseJSON { response in
        if let body = response.request?.httpBody, let json = String(data: body, encoding: .utf8) {
            print("JSON sent in httpBody: \(json)")
        }

        print("Response: \(response)")

        expectation.fulfill()
    }

    debugPrint(request)

    waitForExpectations(timeout: 10.0, handler: nil)
}
```

Now, whether your server actually supports this or not is a different story. As you can see in the example, `httpbin.org` does not accept the parameters in the `httpBody` with a `GET` request. However, the data is still sent along with the request.

99.9% of the time your server will support `URLEncoding` instead. However, there are some servers out there that do require the parameters to be sent as JSON in the `httpBody` of a `GET` requests, but this is pretty rare and is generally only used in really complicated cases.

For more info, please see #1847 and #1530. Hopefully that helps clarify things a bit.

Cheers. üçª  You need to specify the `destination` closure. Otherwise the file isn't moved out of the temp directory and you don't have access to the data outside of your sandbox after the `SessionDelegate` API is called. See our [README](https://github.com/Alamofire/Alamofire#download-file-destination) for more info.

I just pushed up ffaa0718 which updates the README to hopefully make this more clear.

Cheers. üçª  You can't use frameworks using Swift 2.3 and 3.0 in the same project. Make sure your project is set to use Swift 3.

Otherwise, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the work here, this is really interesting. We'll take a look and see how we'd like to integrate this sort of task.  Hi @skydivedan,

Given that the `AVAssetDownloadURLSession` must be initialized with a background configuration, I'd recommend steering clear of Alamofire for this logic right now. The current design of Alamofire makes it quite difficult to work with background sessions in any useful way if your app is being backgrounded and will be woken up when the app has been terminated in the background. There's no way to rewire up the closures you attached previously.

As to your more specific implementation issue, none of your tests will work because background sessions do not work in test suites as of Xcode 8.2.1. We've had to disable all our background session tests in Alamofire because of this bug. This has been the case with all the Xcode 8.x releases which our team pointed out to the Apple engineers at WWDC but it still has not been resolved.

I pulled down your project and ran the test and I see the same issue you're running into. I can't really explain why that `as?` check doesn't work. What I'd try at this point is to create a sample app that runs essentially the same test since the background session stuff doesn't work in test targets. I would guess that you'll have more luck there.

I've added a task to our Trello backlog to investigate this more for AF5. This is something that I think could be useful in Alamofire core, but we need to come up with a better design and strategy for background sessions in general before adding support here.

I'm going to close this issue out for now, but if you would be so kind as to post your findings back here if you make any headway I'd greatly appreciate it. Then we may be able to use some of your findings if we decide to implement this directly into Alamofire in the future.

Cheers. üçª  Could you provide some more detail here @AndrewSB? What exactly would you like to discuss? What exactly is holding you up from the Moya perspective?  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Handling of `204` (and `205`) response codes are done at the `ResponseSerializer` level. If you need to customize that behavior, you can write your own type that conforms to the `ResponseSerializer` protocol. However, the core of the `Result` type (and others) are the notion that requests either succeed or fail and do not fall into some strange third state. That's a fundamental part of Alamofire's response architecture and won't be changed. I suggest you just add special logic to your `.success` case to handle the `204`s unless you want write your own `ResponseSerializer`. I'm not sure what you're talking about here. There is no `default` case when using Alamofire's `Result` type. Or are you implementing some sort of switch around the `HTTPURLResponse` received as part of the `DataResponse`? While you can use that value, it's much better make use of the `Result` that's returned instead. What's your actual calling code?  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  Thanks for the report, we'll try to get this fixed soon. üçª  @jshier any chance you could take a look at this? I remember we had some issues with this in the past. Looks like they crept back in. @benediktreichert Looks like a regeneration was all it needed. It should be working now.

@cnoon Were there any doc related changes you wanted to make? Looks like we're good here, as it was an internal CocoaDocs issue as far as I can tell. No Alamofire changes needed.   I just verified that this change is not necessary in Xcode 8.2. If there is something that I'm missing here, please let me know. For now though I'm going to close this out.

Thanks anyways! üçª  While I question the need to do you own testing on a class Alamofire provides, since we already have testing for it, thanks for the report. We'll investigate. Cheers! üçª  Thanks for letting us know @SlashDevSlashGnoll. You are absolutely right, it was not set up correctly at all. Upon further investigation, we realized we never should have made the class `open` in the first place. This is not a feature that we really want people customizing. Therefore, I moved it back to a `public` ACL in 779930c3.

If you need to "proxy" the functionality for testing, you'll want to create a proxy protocol and have the `NetworkReachabilityManager` conform to it. Then you can customize everything you need for your own internal testing.

This change will go out as part of the 4.3.0 release here shortly. 

Thanks again! üçª  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.  We'd need more code context to be sure, but unexpected cancellation is usually caused by your manager going out of scope and being deallocated, causing any active requests to be cancelled. However, that doesn't appear to the the case here. Without more context it's hard to be sure. Hi @gaoshanyu,

I think you're misunderstanding how cancellation and resumeData work together. Just because you cancel a request does not mean that `resumeData` will be generated. It is only generated if iOS is at a point where the resume data can actually be generated. For example, if the request hasn't received a response and started receiving the stream of data, then iOS won't generate resume data for the request.

In these cases, you need to hold onto the resume data if it was generated, or simply restart the entire request if it doesn't exist.

Hopefully that helps clarify things.

Cheers. üçª  The appropriate place to set these values are on your `SessionManager`'s `sessionDelegate` property, not the individual delegate classes.  If you can find a way to replicate this issue beyond that one device, we'll be happy to take a look. Otherwise it seems like an issue with that device or a bug in Apple's underlying networking implementation.  Thanks @lucatorella! üçª  `Download` and `Data` tasks from the underlying `URLSession` APIs are siblings, no descendants, so it makes the most sense for our requests types to do the same.   Which type of authentication? It's a known limitation of Basic-Auth that there is no standard for encoding usernames or passwords beyond the `ISO-8859-1` character set. Therefore, server and client implementations differ on accepted character sets. Alamofire is limited by Apple's underlying network library in this regard.  Most likely you need to update your CocoaPods specs repo by do a `pod repo update` or updating Alamofire using `pod update Alamofire`.   We're most likely going to decline this PR, as allowing the swapping of `SessionManager`s could break the entirety of Alamofire, but we are interested in exactly what extension points are desired here. That way we can evaluate where such extension should be happening.   Good call @pontus-andersson! I made some small formatting tweaks to your PR and pushed them into `master` in ab0c7679 while keeping your attribution.

Thanks again! üçª
  Hi @noear,

When you get redirected, you can get the original URL from the `response.request` and the redirected URL from the `response.response`.

``` swift
let redirectURLString = "https://www.apple.com/"
let urlString = "https://httpbin.org/redirect-to?url=\(redirectURLString)"

Alamofire.request(urlString).response { response in
    let originalURL = response.request?.url
    let redirectURL = response.response?.url
}
```

Hopefully that helps answer your question. If Google Translate utterly failed me and I didn't answer your question, please translate into English so we can better understand.

Cheers. üçª
  Okay @rastersize, thanks for making the time to put this together! 

I squashed your changes, made a few minor tweaks and pushed them into `master` in commit 19e5012a. I also removed your change to make the `AdaptError` public. That error should definitely not need to be public which led me to investigate some more as to why you thought you needed to do that.

Once I dug in more, I realized that throwing an `Error` in the adapter wasn't working quite right. The retrier was being called correctly, but was being sent the `AdaptError` instead of the underlying error like it was supposed to. The idea is that if you throw an `AuthenticationError.expiredAccessToken` in your adapter, then the retrier error will also be an `AuthenticationError.expiredAccessToken`. You should NEVER see an `AdaptError` in any of the public Alamofire APIs. If you do, it is a bug. I've fixed the underlying issue and added tests to ensure everything is working properly in d2826a11. This should resolve the need for you to ever need the `AdaptError` to be public.

If there's still something I'm missing here, please don't hesitate to reach out. This logic is brand new and it's possible there's still a kink or two. I "think" at this point the logic should be pretty solid. Regardless, if you see anything that seems a bit odd, just assume it is and please file an issue. On a different note, these changes should be released within the next few days.

Thanks again! üçª
  Hi @bschron,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @soxjke,

I'm sorry that your use of Alamofire led you to a rejection with Apple. In Alamofire, we've strived to support the same functionality as Apple does in their [Reachability](https://developer.apple.com/library/content/samplecode/Reachability/Introduction/Intro.html) example app which **IS** IPv6 compliant as is clearly called out in their [README](https://developer.apple.com/library/content/samplecode/Reachability/Listings/ReadMe_md.html#//apple_ref/doc/uid/DTS40007324-ReadMe_md-DontLinkElementID_11). There's a lot of history around this particular logic and it being IPv6 compliant in #1228.

We've also tried to clearly call out exactly what you're calling out in this ticket in our [README](https://github.com/Alamofire/Alamofire#network-reachability) section covering reachability. It is important for anyone using the Alamofire reachability system to understand how it should be used, and we've tried to do our best with that in the documentation. Unfortunately, we can't "make" everyone read the documentation before they start using Alamofire and that can lead to these types of issues.

If you don't mind me asking, did you read the documentation about reachability before implementing it? If yes, was it not clear? Is there something else we can do better there? We don't want anyone to get rejected, but there are legit uses of the zero address approach so we'd rather not remove it.

Cheers. üçª
  You need to define `destination` on all platforms except macOS. Otherwise you won't be able to access the file's data since it is outside of your sandbox. Moving it into the Documents directory before you use it should work fine.

Cheers. üçª
  Any particular reason you aren't using the `MultipartFormData` support built into Alamofire already? That would certainly make this much easier for you. As for your image count issue, I have no idea. There's nothing that Apple is going to do with the above request to make it "not work". The only thing it "might" do is kill your app because you are using too much memory, although that does not sound like the case here.

You'll need to debug with your platform to see why sending 2 images works and 3 doesn't. There's no kind of limit specifically in Alamofire to stop you from doing this.

Best of luck! üçª
  Good observation @rastersize. You have some really good suggestions here and I agree that all your assumptions are correct. I'm actually working through essentially the same exercise you are right now for my company's network stack. I have a few different ideas here on what you can do.

## Solution

First off, I think the correct solution here is to override the `Request` `request` property in the subclasses by doing something like this:

``` swift
class DataRequest: Request {
    open override var request: URLRequest? {
        let taskRequest = super.request

        guard taskRequest == nil else { return taskRequest }
        guard let originalTask = originalTask as? Requestable else { return nil }

        return originalTask.urlRequest
    }
}
```

This will give you access to the upcoming `urlRequest` when the task is actually created which should solve your problem. I'll try and get that put together today into a PR for you to try it out.

## Other Approaches

### Different Session Managers

What I'd also suggest you think about is using a different `SessionManager` and `Adapter` / `Retrier` per authentication system. That way you don't actually have to inspect the incoming request if it's coming into your `Retrier`. You just know that it needs to be refreshed since that request is paired with your retrier.

### Pass the Host through the Error

If you don't want to split them up like that (that's how I'm doing it in our library), then you will need to pass the host through with your `missingAccessToken` (maybe consider `expiredAccessToken`?) error like you posted. That will certainly work for now until I can get the `request` properties overridden. 

Would that be something you'd like to take on and put in a PR for? I'm pretty swamped right now and might struggle to get the changes made today. I'd really appreciate if you could take a stab at this if that would be possible. We'll need to override the Data, Download and Upload Request properties and then write some tests to verify they work as expected.

Cheers. üçª
 Closing this issue out since PR #1792 has been submitted. Please direct all further comments to #1792.

Cheers. üçª
  You could use Alamofire's parameter encoding in this case, but it's certainly overkill. If you don't have any user provided data and you know `data` is properly URL encoded, then you can just build your URL exactly as you are.

If you need to encode `data` prior, then it's probably easier to use `URLComponents` and `URLQueryItem` to do the escaping. It also saves you an Alamofire dependency.
  You need to use `www.apple.com` as the host. It gets all screwed up when you throw the scheme in there.

Cheers. üçª
  Alamofire 4 supports Swift 3 and has for months.
  You cannot at the moment. We're bringing back iOS 8 and macOS 10.10 support in Alamofire 4.1.0 which should release today or tomorrow due to Apple removing Swift 2.3 support sooner than we expected.

Cheers. üçª
  This issue is fixed in the `master` branch and will be released shortly as Alamofire 4.1.0.

Cheers. üçª
  We have several [integration tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/DownloadTests.swift#L133-L175) that verify this behavior works correctly @liudanking. I can't see anything obvious off-hand as to what's not working here, but I'd definitely look at that example for guidance.

If you continue to have issues, I'd suggest you either open a question on Stack Overflow, or you post up a sample project that demonstrates your issue so we could help you debug the problem.

Best of luck! üçª
  Hi @samirae,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @llliang,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This PR reverts back to deployment targets of iOS 8.0 and macOS 10.10 due to Apple dropping Swift 2.3 support post Xcode 8.2. We still need to update some of the documentation to support this change, but all the test suites are passing on all supported platforms. Great catch @jjulian! Fixed in a352f1fb.
  We added such a feature in Alamofire 4, please read our [documentation about it](https://github.com/Alamofire/Alamofire#adapting-and-retrying-requests) if you'd like more information.
  Wouldn't the low latency itself be an indicator that it came back from cache? I suggest you ask this on [Stack Overflow](https://stackoverflow.com), you'll likely get better ideas there.

Cheers. üçª
 @Khalian I just realized that, if you're running on the latest OSes, the `URLSessionTaskMetrics` contained one each response will have the information you're looking for. See our [Migration Guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#task-metrics) for more info.
  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Your custom manager is being deallocated when it goes out of scope, leading the request to be cancelled and the response nil. Ensure you're keeping a reference to your manager somewhere, such as a singleton, like the `default` `SessionManager`.
  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  That depends entirely on why the server is returning a 500 response, you'll need to get more information there.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  The generic error parameter was removed from the `Result` definition because all underlying errors from the Apple frameworks and Alamofire itself are captured as the `Error` type (a change required by Swift 3). So you can still use your custom error type just fine, you just have to extract it by casting to the appropriate type when you want to interact with it. I'm guessing with the appropriate generics it will still work.

Otherwise, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Yes, you need to keep a reference to the manager you're using, as when it falls out of scope and is `deinit`d all of your pending requests are cancelled, leading to the error you see.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for helping @eimantas. Cheers! üçª 
  Hi @DrAma999,

First off, there's no way we will be porting Alamofire 3.x to Swift 3. That wouldn't make sense for us to do and would be a huge amount of work. Instead, we've decided that we're going to add support for iOS 8 and macOS 10.10 in Alamofire 4 since Apple is going to deprecate Swift 2.3 sooner than we thought. Please see #1774 for more info.

I'm going to close this issue out. Please redirect all further comments to #1774.

Cheers. üçª
  These types of compiler errors are usually caused by type issues, so double check the types of all of your parameters.

However, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @julien-c! üçª
  Alamofire does not currently support `multipart/mixed` formatting @tylerlong. It's in our backlog, but is not very high on the priority list unfortunately. If you end up making some progress here and would be interested in pushing it back into Alamofire, we'd certainly be open to that!

Cheers. üçª
  Errors like this are usually caused by the `SessionManager` you created falling out of scope and being `deinit`d, causing your requests to be cancelled. Keep a reference to it, like the singleton used by the `Alamofire` methods, and it will work just fine.
  I would suggest creating your own response serializer that does that string remapping for you, as [outlined in our documentation](https://github.com/Alamofire/Alamofire#custom-response-serialization).

Please note that we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This is the same leak as seen in #1717. It's likely an underlying Swift library leak that we can't do anything about but we're investigating.
  Sorry, @amjad401 but we can't diagnose integration issues like this, Stack Overflow is the best place for these types of issues.
  @CompassCanJV You shouldn't need to point to a specific tag, `pod 'Alamofire'` should work just fine. 

In general, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @kakilan,

You can't load that much data into your app at once. You're app is being terminated by iOS because you're running out of memory. Instead, you need to add the video to the multipart form data using a URL. That way the data is streamed into a temporary file before it's uploaded to the server.

``` swift
if let video = self.avPlayerItem?.asset as? AVURLAsset {
    multipartFormData.appendBodyPart(
        fileURL: video.URL, 
        name: "video", 
        fileName: "video", 
        mimeType: "video/mp4"
    )
}
```

Cheers. üçª
  @dipsvaishnav By your errors it's clear you're either trying to build Alamofire using Xcode 7 or Xcode 8 using Swift 2.3. Update your Xcode or switch your project to the appropriate version.
  See #1367 for our reasoning as to why we dropped iOS 8 support.
  @preraksola Please review our [Security](https://github.com/Alamofire/Alamofire#security) documentation, as it should have the info you need to allow self signed certificates.
  Without more info, it's hard to tell what's going on here. Most likely though, this error indicates an issue with the response from the server, at a lower protocol level than Alamofire has anything to do with. 

Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @michallaskowski, we're looking to tag AF 4.1.0 on Monday at the latest.

Cheers. üçª
  There isn't a lot Alamofire can do for you here aside from supporting automatic request retries and adaptation. There are a variety of frameworks out there for building asynchronous architectures. It just depends on what other features you may want. But this isn't the place for overall app architecture questions, unfortunately.

Perhaps asking this question on [Stack Overflow](https://stackoverflow.com) would help.

Cheers. üçª
  I'm going to close this issue out since #1735 has been merged. The 4.1.0 release will be released shortly. Thanks for everyone's patience here.

Cheers. üçª
  Can you point to any sort of standard the defines the behavior we should see with this?
 Hi @xspyhack,

Thank you for all the information here. I didn't realize this was such a problem in China. While I completely understand your approach, this is a bit too specific for us to put directly into Alamofire. What I'd recommend instead is subclassing the `ServerTrustPolicyManager` and creating a mapping between your certificate hostnames and ip address it maps to. Then use the ip address to define the policy to use for evaluation. Here's a quick example of how this could work:

``` swift
class IPServerTrustPolicyManager: ServerTrustPolicyManager {
    let hostToIPMap: [String: String]

    init(policies: [String: ServerTrustPolicy], hostToIPMap: [String: String]) {
        self.hostToIPMap = hostToIPMap
        super.init(policies: policies)
    }

    override func serverTrustPolicy(forHost host: String) -> ServerTrustPolicy? {
        guard let ip = hostToIPMap[host] else { return nil }
        return policies[ip]
    }
}
```

Then you can use it like so:

``` swift
class BaseTestCase: XCTestCase {
    func testPolicyManager() {
        let manager = IPServerTrustPolicyManager(
            policies: [
                "192.168.0.1": .performDefaultEvaluation(validateHost: true)
            ],
            hostToIPMap: [
                "*.example.com": "192.168.0.1",
                "test.example.com": "192.168.0.1",
            ]
        )

        let sessionManager = SessionManager(serverTrustPolicyManager: manager)

        // TODO: make some requests...
    }
}
```

Hopefully that all makes sense. Please let me know if that won't actually work for your use case, but I'm pretty confident that it will.

Cheers. üçª
 Okay @xspyhack I think you want to read between the lines here a bit. My example was simply showing you how you could start to provide a more robust lookup system. These use cases are way outside of what Alamofire has committed to supporting directly, but Alamofire does not stop you from being able to handle these cases.

You'll need to create a custom `ServerTrustPolicyManager` to allow you to map the `host` to the `ServerTrustPolicy` that you want to use. This might be pretty complicated in your use case. From there, you need to customize the evaluation as necessary by toggling certain evaluations. For example, `.performDefaultEvaluation(validateHost: false)` would probably be what you're looking for. Although you obviously have to be REALLY careful about these types of things since you can really be opening yourself up.

You could also switch over to using your own custom evaluation based on your use case. Overall, you have all the tools in front of you. Alamofire will not support such a complex use case directly, but it absolutely supports the ability for your to extend the base functionality to accomplish this.

Best of luck! üçª
  Hi @ricardopereira,

Thanks for opening up this issue. I've just pushed up 9688b16f into `master` which automatically removes the temp file from disk after the upload completes. This will be part of the Alamofire 4.1.0 release which should be out by Monday.

If you're not using the latest version of Alamofire, you could manually delete the file like so in a `response` handler.

``` swift
Alamofire.upload(
    multipartFormData: { multipartFormData in
        multipartFormData.append(unicornImageURL, withName: "unicorn")
        multipartFormData.append(rainbowImageURL, withName: "rainbow")
    },
    to: "https://httpbin.org/post",
    encodingCompletion: { encodingResult in
        switch encodingResult {
        case .success(let upload, _, streamFileURL):
            upload.responseJSON { response in
                debugPrint(response)

                // This is how you can remove the file
                if let streamFileURL = streamFileURL {
                    do {
                        try FileManager.default.removeItem(at: streamFileURL)
                    } catch {
                        print("Failed to remove stream file at URL: \(streamFileURL) - error: \(error)")
                    }
                }
            }
        case .failure(let encodingError):
            print(encodingError)
        }
    }
)
```

Cheers. üçª
 Great call @ricardopereira! I just pushed up e68bfdcc which will automatically delete the temp file in the event of a failure. Unfortunately there's no way to do this in the 3.x version of Alamofire.
  We're not seeing this issue anywhere. From the linked SwiftyDropbox report, it looks like the crash is actually occurring in `DispatchQueue`'s `init` method, with some sort of `objc_msgSend`. We'll investigate.
 This is not something we've been able to reproduce on our end with our Alamofire sample app running iOS 10.1.1 on device against Xcode 8.1 in a release build. At this point, we're going to need someone to post up a sample project that demonstrates the issue since there's nothing else we can do here. We can't reproduce the issue no matter how hard we try.

I'm going to close this issue out for now. If someone can post more information or a sample project, we'll happily re-open and investigate further.

Cheers. üçª
  Looks like an underlying issue in the Swift standard library, likely what we saw in #1686. We'll investigate and decide what to do. @cleverliz Could you provide more info? Alamofire version, optimization settings, device, etc. A full stack trace that we can use in a report to the Swift project would be great too. 
 Hi @cleverliz and @WishWei, we have been unable to reproduce this crash on our end at all. Would either of you be able to create a sample app that reproduces the issue? Without it, we don't have anything else left to investigate. I've tried debugging this in the simulator and on a device with varying optimization levels to no avail.

I don't want to submit a bug to the Swift project until we have a way to definitively reproduce it on our end first. If you could provide us with a sample project, then we'll be happy to investigate this further.

I'm going to close this issue out for now. If you provide more info, then we'll happily re-open and investigate further.

Cheers. üçª
  As @phoney mentioned @JunDang, just comment out the closure and rebuild it using the new AF4 syntax. For more info, please refer to the [migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#data-request---complex-with-url-string).

In the future, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Sorry, no SOAP support in Alamofire. I'm truly sorry if you have to use such a service.

We use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This PR fixes the one new warning in Xcode 8.1 that was due to the new handling of optionals implicitly cast as `Any`. It also adopts the new project settings suggested by Xcode.
 This looks @jshier! üçª
 There aren't warnings in the project anymore. You must have something else going on. Possibly clean and wipe derived data? What are you seeing as an error @Harmonium? Screenshot? What version of Xcode are you running? We only support Xcode 8.1 currently. If you're running a beta that is producing those errors, then that's the problem. There are no warnings using Xcode 8.1 and the latest Alamofire release. If you see any new ones, please open a new issue with the exact warnings you're seeing and the lines in Alamofire that trigger them Cast them as `Any` and be done with it or put them into string values that are then printed.  Thanks @carlosmcevilly! üçª
  We're going to need a lot more context here. What OS? What does the call site look like? Can you create a demo project that replicates the issue? What's the full crash stack? Why does that screenshot show so many threads?
 We don't need your exact code, but an example of your calling code would be very helpful, especially showing how you're doing the polling, so we can try to replicate your issue. That would be the biggest part. 

Running with additional diagnostics enabled may help you narrow it down, like the thread sanitizer or memory sanitizer, to ensure there isn't some other issue occurring here. It would be unusual for something in Alamofire to trigger a `EXC_I386_GPFLT` error.
 Thanks for getting back to us @dmontay. üçª
  This will be fixed once #1735 is merged.
 I'm going to close this issue out since #1735 has been merged. The 4.1.0 release is forthcoming.

Cheers. üçª
  Sorry, this isn't meant as a public API, just a convenience internal to Alamofire. You can replicate the effect by using `DispatchQueue.global(qos: .utility)`. I've updated the migration guide in #1736.
  There is no `JSON` type in Swift. If you want to return your own `JSON` type or one of the various `JSON` types from third party libraries, you can do so by creating a custom response serializer, as [our documentation lays out](https://github.com/Alamofire/Alamofire#creating-a-custom-response-serializer). 
  Thank you everyone for helping each other out here. In the future I'd suggest moving this type of question to Stack Overflow. I'm going to go ahead and close it out for now since there's no actionable Alamofire issue here.

Please feel free to continue your investigation here.

Cheers. üçª
  You need to update your spec repo: `pod repo update`. Or just run `pod update`.
 You can follow those directions to diagnose your issues. Most likely the specs repo is a bit overloaded at the moment and GitHub is timing it out. 
  This looks more like a CocoaPods issue and we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com).

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 It's not a problem with Alamofire, many people can install from CocoaPods just fine. You need to update your specs repo. 
  That's incorrect, that file is only necessary for projects publishing podspecs with Swift 3 code. For pod consumers, CocoaPods uses the Swift version defined in your project to set it for the Pods project. 

@nikkibeats Makes sure you're using the `*.xcworkspace` file created by CocoaPods and not your `*.xcodeproj`.

If that doesn't work, I'm sorry but we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @ILI4S...much appreciated! üçª
  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I am having an issue with my HTTP request using Alamofire. When I try to reproduce the issue with the XCode debugger it does not crashes but when I archive the app and run the .ipa file on my iPad with ios 10.0.2 I always get a crash.

This is an example of a call that crashes when running the arhived app:

```
#static func loginOnServerUrl(serverURL: String, user: String, password: String,
        successCallback: ((JSON) -> Void)? = nil, failureCallback: ((Error) -> Void)? = nil){

            let params = [
                ApiParams.ACTION : "login",
                ApiParams.LoginParams.USER : user,
                ApiParams.LoginParams.PASSWORD : password,
            ]

        Alamofire.request("http://\(serverURL)/AppSrv", method: .get, parameters: params).responseJSON { response in
                switch response.result {
                case .success(let value):
                    //JSON raiz
                    let json = JSON(value)

                    for (key, value) in json.acceptingSigleValueAsArray {
                        log("\(key) : \(value)")
                    }


                     if let successCallback = successCallback {
                         successCallback(json)
                     }


                case .failure(let error):
                    log(error.localizedDescription)
                    if let failureCallback = failureCallback {
                        failureCallback(error)
                    }
                }
            }
    }
```

This is one of the crash logs I am getting:

```
Incident Identifier: ****
CrashReporter Key:   *****
Hardware Model:      iPad5,2
Process:             ****
Path:                ****
Identifier:         ****
Version:             1.42 (1.2.3a)
Code Type:           ARM-64 (Native)
Role:                Foreground
Parent Process:      launchd [1]
Coalition:           ****


Date/Time:           2016-10-21 10:16:08.9811 +0200
Launch Time:         2016-10-21 10:16:06.2504 +0200
OS Version:          iPhone OS 10.0.2 (14A456)
Report Version:      104

Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Subtype: KERN_INVALID_ADDRESS at 0x000000059480bec8
Termination Signal: Segmentation fault: 11
Termination Reason: Namespace SIGNAL, Code 0xb
Terminating Process: exc handler [0]
Triggered by Thread:  0

Filtered syslog:
None found

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libswiftCore.dylib              0x0000000100e19b6c 0x100c38000 + 1973100
1   myapp                           0x00000001000c4d88 static ServerManager.(pingOnServerUrl(serverUrl : String, successCallback : (Int64) -> ()?, failureCallback : (Error) -> ()?) -> ()).(closure #1) (ServerManager.swift:0)
2   Alamofire                       0x00000001003aca84 specialized DataRequest.(response<A where ...> (queue : DispatchQueue?, responseSerializer : A, completionHandler : (DataResponse<A.SerializedObject>) -> ()) -> Self).(closure #1).(closure #1) (ResponseSerialization.swift:0)
3   libdispatch.dylib               0x00000001889f1200 _dispatch_call_block_and_release + 24
4   libdispatch.dylib               0x00000001889f11c0 _dispatch_client_callout + 16
5   libdispatch.dylib               0x00000001889f5d6c _dispatch_main_queue_callback_4CF + 1000
6   CoreFoundation                  0x0000000189b15f2c __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__ + 12
7   CoreFoundation                  0x0000000189b13b18 __CFRunLoopRun + 1660
8   CoreFoundation                  0x0000000189a42048 CFRunLoopRunSpecific + 444
9   GraphicsServices                0x000000018b4c5198 GSEventRunModal + 180
10  UIKit                           0x000000018fa15628 -[UIApplication _run] + 684
11  UIKit                           0x000000018fa10360 UIApplicationMain + 208
12  myapp                           0x00000001000bf024 main (AppDelegate.swift:16)
13  libdyld.dylib                   0x0000000188a245b8 start + 4

Thread 1:
0   libsystem_kernel.dylib          0x0000000188b36a88 __workq_kernreturn + 8
1   libsystem_pthread.dylib         0x0000000188bf936c _pthread_wqthread + 1452
2   libsystem_pthread.dylib         0x0000000188bf8db4 start_wqthread + 4

Thread 2:
0   libsystem_kernel.dylib          0x0000000188b36a88 __workq_kernreturn + 8
1   libsystem_pthread.dylib         0x0000000188bf936c _pthread_wqthread + 1452
2   libsystem_pthread.dylib         0x0000000188bf8db4 start_wqthread + 4

Thread 3:
0   libsystem_pthread.dylib         0x0000000188bf8db0 start_wqthread + 0

Thread 4:
0   libsystem_pthread.dylib         0x0000000188bf8db0 start_wqthread + 0

Thread 5:
0   libsystem_kernel.dylib          0x0000000188b36a88 __workq_kernreturn + 8
1   libsystem_pthread.dylib         0x0000000188bf936c _pthread_wqthread + 1452
2   libsystem_pthread.dylib         0x0000000188bf8db4 start_wqthread + 4

Thread 6 name:  com.apple.uikit.eventfetch-thread
Thread 6:
0   libsystem_kernel.dylib          0x0000000188b1816c mach_msg_trap + 8
1   libsystem_kernel.dylib          0x0000000188b17fdc mach_msg + 72
2   CoreFoundation                  0x0000000189b15cec __CFRunLoopServiceMachPort + 192
3   CoreFoundation                  0x0000000189b13908 __CFRunLoopRun + 1132
4   CoreFoundation                  0x0000000189a42048 CFRunLoopRunSpecific + 444
5   Foundation                      0x000000018a550b1c -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 304
6   Foundation                      0x000000018a57160c -[NSRunLoop(NSRunLoop) runUntilDate:] + 96
7   UIKit                           0x000000019038ac7c -[UIEventFetcher threadMain] + 136
8   Foundation                      0x000000018a64e50c __NSThread__start__ + 1024
9   libsystem_pthread.dylib         0x0000000188bfb860 _pthread_body + 240
10  libsystem_pthread.dylib         0x0000000188bfb770 _pthread_body + 0
11  libsystem_pthread.dylib         0x0000000188bf8dbc thread_start + 4

Thread 7 name:  com.apple.NSURLConnectionLoader
Thread 7:
0   libsystem_kernel.dylib          0x0000000188b1816c mach_msg_trap + 8
1   libsystem_kernel.dylib          0x0000000188b17fdc mach_msg + 72
2   CoreFoundation                  0x0000000189b15cec __CFRunLoopServiceMachPort + 192
3   CoreFoundation                  0x0000000189b13908 __CFRunLoopRun + 1132
4   CoreFoundation                  0x0000000189a42048 CFRunLoopRunSpecific + 444
5   CFNetwork                       0x000000018a22fcec +[NSURLConnection(Loader) _resourceLoadLoop:] + 336
6   Foundation                      0x000000018a64e50c __NSThread__start__ + 1024
7   libsystem_pthread.dylib         0x0000000188bfb860 _pthread_body + 240
8   libsystem_pthread.dylib         0x0000000188bfb770 _pthread_body + 0
9   libsystem_pthread.dylib         0x0000000188bf8dbc thread_start + 4

Thread 0 crashed with ARM Thread State (64-bit):
    x0: 0x0000000170246c30   x1: 0x0000000170246c30   x2: 0x0000000000000008   x3: 0x0000000188b7c250
    x4: 0x0000000100e099a4   x5: 0x0000000100df14f8   x6: 0x0000000000000065   x7: 0x0000000170287c78
    x8: 0x000000059480bea8   x9: 0x0000000ffffffff8  x10: 0x0000000000000001  x11: 0xbaddc0dedeadbead
   x12: 0x0000000000000177  x13: 0x0000000000000177  x14: 0x0000000100be6a30  x15: 0x0000000000000000
   x16: 0x0000000100e19b54  x17: 0xb000000000000003  x18: 0x0000000000000000  x19: 0x0000000000000000
   x20: 0x0000000100e94060  x21: 0x00000001ae195ef8  x22: 0x000000017046cf40  x23: 0xb000000000000003
   x24: 0x0000000000000000  x25: 0x0000000000000000  x26: 0x0000000000000004  x27: 0x0000000100be6a30
   x28: 0x0000000170246c30   fp: 0x000000016fd46b60   lr: 0x00000001000c4d88
    sp: 0x000000016fd46870   pc: 0x0000000100e19b6c cpsr: 0x20000000
```
 I am getting EXC_BAD_ACCESS(code=1, address=...) in ResponseSerialization.swift (line 159)

`(queue ?? DispatchQueue.main).async { completionHandler(dataResponse) }
`
 same as
https://github.com/Alamofire/Alamofire/issues/1637
 By default, frameworks integrated using CocoaPods get an optimization level of `-O`, whereas Swift apps now default to `-O -whole-module-optimization`. Perhaps this mismatch is causing issue? I make all of my pods have whole module optimization by using this post install hook:

``` ruby
post_install do |installer|
  installer.pods_project.targets.each do |target|
    target.build_configurations.each do |config|
      if config.name != 'Debug'
        config.build_settings['SWIFT_OPTIMIZATION_LEVEL'] = '-Owholemodule'
      else
        config.build_settings['SWIFT_OPTIMIZATION_LEVEL'] = '-Onone'
      end
    end
  end
end
```

Let us know if this fixes the issue for you.
 Finally was same of https://github.com/Alamofire/Alamofire/issues/1637
I solved it by setting the Release optimization level to same as the main target (`Fast, Single-File Optimization`)
 Hi @Tindi 

Inside XCode>project settings>Build Settings. Try to find the keyword 'optimization'. 
Then change the value for key 'Optimization Level'>'Release'. You have to put the same level in your project target and in the module Alamofire.

For testing that it works correctly run your app with 'Release' scheme (same as when it is uploaded to AppStore).

![upload](https://cloud.githubusercontent.com/assets/10388796/20560380/56b77320-b179-11e6-9981-30076202f234.jpg)
  Thanks for the report! I can see the same leaks you are. However, they appear to be in the underlying Swift libraries and not strictly from Alamofire's code, so I don't think there's much we can do about it. But I'll look into it further.
 These are also leaks that aren't detected by the Instrument's Leaks template, so I'm not entirely sure they're real. 
 I've been able to detect @hammyhamza's leaks using the Leaks instrument now (strange). However, I don't see anything like what @windyit08's screen shot shows. @windyit08, can you open a new issue with those leaks, if you can trace them to Alamofire's code? When you do, please state what OS, version of Alamofire, and version of Xcode you're using.

I'm not sure there's anything to do here, as these leaks seem to be in the Swift core libraries. @cnoon?
 @jshier and I chatted in Slack about what to do here. He's going to file a bug with the Swift project.
 @jshier could you file this bug when you get a chance? I want to make sure we get this filed with the Swift team. Hopefully they'll be able to fix it.
 I've confirmed from other projects that this is a false positive from the leaks tool. I'm working to see if I can workaround it like they did by reordering the variable declarations as well as filing a bug with Apple. I can no longer replicate these leaks using Xcode 8.2. Please, anyone who saw such leaks, please retest using the latest tools and open a new issue if you believe you've found a new leak.  No, Alamofire supports the same compression formats as the underlying `URLSession` networking APIs, which I don't believe includes Brotli.
  Sorry, we use our GitHub project for bug reports and feature requests. In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  The below head request was throwing following error   

**responseSerializationFailed(Alamofire.AFError.ResponseSerializationFailureReason.inputDataNilOrZeroLength)**

```
  Alamofire.request(AppConstants.musicFileURL + musicFilename, method: .head, parameters: nil, encoding: JSONEncoding.default, headers:headers)

            .responseJSON { responseStr in

                print("HEAD \(responseStr)")

                //print FAILURE: responseSerializationFailed(Alamofire.AFError.ResponseSerializationFailureReason.inputDataNilOrZeroLength)

                guard responseStr.result.isSuccess else {
                    return
                }
        }
```
 Thanks for the report! HEAD requests are just rare enough to get through our testing in this instance. We'll work on an update this weekend.
 @jshier has put together #1775 to address this issue. We're not going to pull this PR into the Alamofire 4.1.0 because we still have some backwards compatibility issues to work out. However, I'd like to close this issue out and have everyone redirect all further comments to #1775.

Thanks everyone! üçª
  Yes, it appears `lldb` prints the raw string, making it unusable in the terminal. You can either strip the raw newlines or use: `expr print(request.debugDescription)` to get usable output. Unfortunately there's no flag (that I know of) for `lldb` to print the "rendered" version of a string.
  There's no real list of all possible underlying network errors like the one you posted. Those errors don't come from Alamofire but the underlying `URLSession` networking APIs. You can take a look at `URLError` to see all of the cases possible, but Apple doesn't provide a simple list that I know of. Alamofire's errors all live in [`AFError.swift`](https://github.com/Alamofire/Alamofire/blob/master/Source/AFError.swift).
  @joedaniels29 Looks like you're trying to build for an OS which doesn't support `URLSessionStreamTask`. Update your project to meet the minimum deployment requirements of Alamofire 4 and it should work.
  I'm sorry, but there's no data structure in Swift which allows duplicate keys like this, much less JSON encoding which does the same. In fact, [RFC7159](https://tools.ietf.org/html/rfc7159#section-4) states `The names within an object SHOULD be unique.` So there's nothing for Alamofire to do here.
  Thanks for the report, this definitely looks incorrect. We'll try to get a fix out this weekend.
 This will be fixed when #1723 lands.
  There is no `swift3` branch anymore, Swift 3 compatibility was released as part of Alamofire 4. Update your `Podfile` and then run `pod update`.
  This will be addressed in #1722.
 This has been merged into `master`.
  @honbolau The Swift Package Manager is a bit of a moving target right now, especially if you're using development versions instead of the one included with Xcode. We're going to need a lot more information to properly diagnose an issue here. Like @skyline75489 said, check #1544 for up to date directions.
  I'm not sure I understand what you want Alamofire to do here, @grantkemp. Swift has no order preserving dictionary type, and even if it did, `JSONSerialization` wouldn't understand it, so there's no way for Alamofire to preserve ordering in the parameters passed in. In that case, I would suggest creating your `URLRequest` ahead of time or creating your own `request()` function that operates on whatever order-preserving collection you come up with. 
 @grantkemp Anything more to add here? I'm still not sure what you're asking for Alamofire to provide here, as custom body encodings can already be done in a variety of ways.
 @grantkemp If you have something more concrete to suggest or, better yet, a PR, feel free to comment. Otherwise I'm closing out this issue for now.
  @hzektser Errors like that usually indicate some sort of syntax error in the function being called. I recommend double checking the call to make sure all of the types and labels match up.

However, like @skyline75489 said, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @Mapamatician It seems like you have an issue with your local setup, as Alamofire does not produce timeout errors itself, those are from the underlying networking library. But like @skyline75489 said, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @marcusleon @Daltron Support for retry counts was added to `master` recently but has not yet been released officially. Once #1682 has been finalized and merged, we'll do another release. Otherwise yes, you'll need to ensure the retries stop yourself, even after we add the retry count to the framework. I'm closing this for now, but @cnoon, anything to add, give you wrote this feature?
  @travisday If you find any underlying Alamofire issue here, feel free to open another issue. Otherwise, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @yogesh2209  Like @thebluepotato said, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Just FYI but that fork doesn't properly workaround any of the issues iOS 8 had, which is one of the reasons we dropped support for it in Alamofire 4. Our recommendation is that anyone requiring iOS 8 support should use Swift 2.3 and Alamofire 3.5.1. See #1367 for more information.
  @fishcharlie This is due to `URLSession` providing authentication handling by automatically retrying failed requests. #1425 is another example of this issue. 
  Looks like this should largely be fixed by [`SE-140`](https://github.com/apple/swift-evolution/blob/master/proposals/0140-bridge-optional-to-nsnull.md). But yes, you can't use `JSONSerialization` (and therefore `JSONEncoding`) to encode Swift collections with nil, you must convert them to `NSNull()`. This isn't any different than previous versions of Swift or Objective-C. If you're suggesting that Alamofire should do this for framework consumers, I'd disagree, as that's a fundamental change in the types passed in which users may not expect. That, combined with the upcoming Swift change, means I don't think there's anything for Alamofire to do here. @cnoon?
 If you want that behavior, you can use `(value as AnyObject?) ?? NSNull()`. That should work until Apple ships Swift 3.0.1 in Xcode 8.1.
 @sssilver Anything more to add here? Like I said, I expect this to become a non issue once Xcode 8.1 ships.
 My main point was that the discussion should become moot once Apple ships Swift 3.0.1 and the language properly handles the conversion for us.
 @sssilver Testing in the Xcode 8.1 GM (which includes SE-140), this code works where it didn't before:

``` swift
let string: String? = "string"
let parameters = ["what" : string]
let any = parameters as Any
func encodeParamters(_ parameters: [String : Any]) {
    do {
        let json = try JSONSerialization.data(withJSONObject: parameters, options: [])
    } catch {
        print(error)
    }
}

encodeParamters(parameters)
```

Previously it would crash in the `JSONSerialization` call. So it look like we're good here.
 Works fine as well, once it's properly typed (can't infer a value type when it's just `nil`).
 No, the compiler still allows optionals as `Any`, but produces a warning, forcing you to explicitly cast to `Any` if you want that behavior. But that only applies for direct declarations: 

``` swift
let string: String? = "string"
let parameters: [String : Any] = ["what" : string]
```

Produces a warning `Expression implicitly coerced from 'String?' to 'Any'`. However, it's not a problem when passing to a function.
  The `.authenticate()` function is proper way to add basic auth credentials, but you can take a look at our [AuthenticationTests](https://github.com/Alamofire/Alamofire/blob/master/Tests/AuthenticationTests.swift) file to see how we test this functionality. First, though, I would check and make sure your requests are being made as you expect and the server is seeing the credentials. 

If you find an issue with Alamofire, feel free to open a new issue, otherwise these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) with tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Were you able to see any request logs to see if the `.authenticate()` method was adding the basic auth correctly? I don't think there's anything for Alamofire to do here, as our authentication support goes through the system libraries, but it would be interesting to know what the exact issue was just in case.
 @danipralea Anything more to add? We'd like to narrow down why this wasn't working, but all of our tests pass. Perhaps your server didn't accept typical basic-auth? I've manually verified Alamofire works correctly, both in our tests and against [HTTPBin's basic-auth endpoint](https://httpbin.org/basic-auth/username/password).
 @danipralea I'm mostly interested in what the request difference was that made your requests not work. That is, what was different between the requests returned by `.authenticate()` and you manual header addition.
 Hi @danipralea,

Have a look at this [authentication test](https://github.com/Alamofire/Alamofire/blob/master/Tests/AuthenticationTests.swift#L112-L141). It demonstrates how to use the `authorizationHeader` API when creating a `Request`.

Cheers. üçª
  Hi @taflanidi, thank you for taking the time to put this together and to state your reasoning. While we understand your point of view, we don't agree that Alamofire should be falling back to other types of parameter encoding when the specified one doesn't necessarily make sense.

In most cases, using JSON parameter encoding for a `GET` is going to be incorrect, but not always. There could be some crazy set of services that decided to deviate from the norm (we've all been there sadly). We want Alamofire to clearly do what it is you're instructing it to do. If a user is saying "I want a GET request with some JSON encoded in the HTTP body", well then that's what we want to them.

Additionally, who's to say that falling back to URL encoding is actually correct? We don't want to allow users to write the wrong code and accidentally get the correct result. This hides the fact that they made a mistake in the first place. Instead, we'd rather error on the side of Alamofire doing exactly what you instructed it to do.

We'd like to encourage everyone to consider using the Router pattern to construct their requests in production applications. This pattern is very powerful in Alamofire 4 with the ability to passthrough construction errors all the way to the response handlers. Because of this, each request should be choosing the appropriate parameter encoding type for the request it needs to make.

Hopefully that helps clarify our opinion here. Please feel free to keep the conversation going if you wish.

Thanks again. üçª
 I'm not sure what you're talking about. `GET` requests with body data work just fine, it's just that the backend server may not expect requests to pass parameters that way. We've never observed or had reports of freezing because of this issue, just servers not receiving parameters. Also, contrary to the AFNetworking serialization architecture, Alamofire's serializers are intended to be simple, single purpose, and for users to switch serialization type based on request, rather than having a single serializer that serve all requests. And like @cnoon said, baking this fallback behavior into the serializers themselves limits the ultimate flexibility of the framework.
 @taflanidi you can create your own custom JSON encoding type that behaves exactly as you would like. This is why we modified the AF4 design to be more flexible when it comes to parameter encoding. While we completely understand your reasoning here, we simply disagree. 

You are also making several contradictory arguments to your own statements here around the design. If you'd like to see things improve in Alamofire, then let's work together on doing so. Simply ranting about bad design and bad code doesn't help you or anyone else. In the future, if you have an idea on how to improve things, please open an issue and let's discuss it before you modify major parts of the framework in something that we ultimately wouldn't agree belongs in Alamofire. We don't want to waste your time and we'd certainly appreciate that you don't waste ours.
  The memory will automatically be cleaned up when there is no longer a reference to it. You don't have to worry about actually releasing it unless you're retaining it with a strong reference in your code.
  Hi @najmul-csebuet,

You're looking for `URLEncoding.default`.

In the future, you should open questions like this on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Please see https://github.com/Alamofire/Alamofire/issues/1544 for a full breakdown of using SPM with Alamofire.

Cheers. üçª
  Sorry, we won't be able to look into this until we have devices with iOS 10.1. In the mean time, can you retest on the latest beta. This looks like it could be an underlying Swift issue.
 I am getting my app rejected due to this issue :C
 @AleyRobotics @pixelfreak @adrimarti I'm sorry, but I can't reproduce this issue at all. Our tests pass on a variety of simulator types with each optimization level. We're going to need to see the calling code that leads to this crash to be able to reproduce it. @pixelfreak You mentioned "using the same parameters", can we get a code sample with those parameters that causes this issue for you?
 @pixelfreak I'm sorry, but like I said, I tried to replicate on both device (iPhone 7, iPhone 4S) and the simulator. Can you put together a sample project that reproduces the issue, even if it's on device?
 Hey everyone,

I'm going to close this issue out because there's nothing for us to really go on here. We have been unable to reproduce this issue through numerous attempts and no one has posted a sample project that can reproduce the issue.

In the future, please provide more information so we're able to help you debug the issue. We want to help, but there's nothing here for us to actually help with.

Best of luck. üçª
  An unexpected error `-999` almost always means your `SessionManager` was deallocated, cancelling any ongoing requests. I suggest you create a singleton value for your custom `SessionManager`, or perhaps just reevaluate if you really need one.
 I would recommend not subclassing unless you need behavior that can't be accomplished using the public APIs. Also, following Swift naming conventions. But yes, a singleton in a type is generally how you'd use a custom `SessionManager`. 

@cnoon Perhaps we need a best practices or common issues section in the README. This, and other issues, come up fairly often. 
  This PR was created to allow errors thrown in the adapter to call the retrier before starting up the request's internal dispatch queue. 
## Problem

The reason this is necessary is if you want to be able to throw an `ExpiredAccessToken` type of `Error` in your `RequestAdapter`. This would allow you to do things like preemptively refresh you token before sending any requests to the server even though the public APIs had already started up the request. The adapter would be able to intervene.

> See #1674 for the a more in-depth explanation of the issue.
## Solution

Okay everyone (especially @jshier), I need a sanity check here. I don't think this is too hackish, but I want to make sure everyone else agrees. This was really tricky to implement since there are so many different things going on.

The biggest decision was whether or not to wrap the errors in the `AdaptError` or not. It all boils down to whether we should call the retrier for things like invalid URLs and parameter encoding failures. IMO, we should not. I feel like calling the retrier in those scenarios could cause all sorts of problems where people are accidentally getting themselves into endless retry scenarios without realizing it.

Instead, I created an `AdaptError` to wrap any `Error` that's thrown by the `RequestAdapter`. This is only used internally by Alamofire to figure out whether the encountered error was actually thrown by the `adapter` or not. If it is an `AdaptError`, extract the underlying `Error` and call the `retrier`. If it isn't an `AdaptError`, then the request isn't going to succeed and just start up the request queue.

We could instead actually expose an `AFError.adaptError` that people are required to throw to get this behavior, but that seems a bit odd and easy to misuse. Instead, I think people are going to want to throw all types of errors from the adapter and we should just wrap them up internally to figure out whether or not we should call the retrier. Once we make that decision, we extract the underlying error and continue on.

I haven't actually built any tests around this yet because I wanted to get everyone's thoughts first. I've dug into the download and upload requests a bit and this is definitely possible to support in a similar manner.

Thoughts?
 cc @jshier and @kcharwood for a sanity check üòâ
 Looks pretty good, though I'm still worried about the growing complexity. I did have some questions about the error and the unwrapping, and how it was being used. I agree with the `AdaptError` solution, it's just the handling I'm concerned with.
 üëç Looks good.
  Thanks @hardikdevios! üçª
  Hi @MarcOConnor,

The issue is with your `handleCallbackWithResponse` API as @hardikdevios alluded to. It most likely needs to take a `DataResponse` instead of a `Response`. Just comment out that line of code and slowly start adding things back in.

For more info, please see #1560, #1597, #1650 and #1661.

In the future, I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire` for this type of question. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @Goule,

I'd suggest you open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You need to update to CocoaPods 1.1.0 (`gem install cocoapods --pre` or using Bundler) for it to properly set the Swift version.

In the future, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @hanneshallen,

These are all AWESOME points and you can do "exactly" what you proposed without any changes to Alamofire. It's already all setup to handle this, you just need to implement it. In your `RequestAdapter`, just check if the `expires_in` parameter has actually expired. If it has, throw an `Error`. It can be some custom error you create just for this case such as `CustomError.expiredAccessToken` or something like that.

Then in your `RequestRetrier`, you can check the `error` to see if it's an `.expiredAccessToken` and trigger a refresh. This will make sure the original request is NOT sent and goes immediately to your `RequestRetrier` where you can refresh the access token, then retry the request.

Cheers. üçª
 Interesting...thanks for pointing that out @tholo. Re-opening to investigate further.
 Yep, you're certainly correct @tholo...it's going to take some creativity to make that work. Let me see what I can come up with.
 Okay @tholo and @hanneshallen, please check out #1682. I'd love to get your thoughts.
 I'm going to close this issue out. Please redirect all further comments to #1682.

Cheers. üçª
  Hi @gerrypower,

@hardikdevios is right. You can't use a `responseJSON` serializer with that `status` API because it doesn't return any data. When you do, you'll always get an `Alamofire.AFError.ResponseSerializationFailureReason.inputDataNilOrZeroLength` as @hardikdevios has already pointed out.

The reason your test times out is because you don't have a `asyncExpectation.fulfill()` in your `failure` case. That causes both the `XCTFail` to fail as well as the timeout.

The reason the `204` status call works is that the `responseJSON` handler has logic to handle a 204 or 205 gracefully without failing. They are special HTTP status codes that do not return data so we have special logic in Alamofire to handle them in the default response handlers.

A better way to test this is the following:

``` swift
func testThatShowsSuccessHeadDoesNotTimeOut() {
    let asyncExpectation = expectation(description: "Wait for response")

    Alamofire.request("http://httpbin.org/status/200").response { response in
        debugPrint(response)
        asyncExpectation.fulfill()
    }

    waitForExpectations(timeout: 20)
}
```

In summary, if you don't `fulfill` your expectation in **ALL** cases, you'll always time out. Also, you can't use the default response handlers without receiving an error with no data unless you get back a 204 or 205.

Cheers. üçª
  Hi @Footjy,

There are all sorts of ways you could handle this. I'd start simple and write some check in your `RequestRetrier` that doesn't allow you to run more than say 3 refreshes within a 10 second timeframe. If you do, then stop retrying the request.

Once you get this check in place, you can slowly modify it over time to be more and more robust. If you post a link to the SO question I'd be happy to answer it there as well.

I also just pushed up PR #1681 which adds a `retryCount` property to a `Request` which would allow you to stop retrying a `Request` after it had been tried once or twice. These options should be more than enough to get you going.

If you have other ideas, please don't hesitate to post them. This system is brand new so we don't know all the ways everyone will be using it.

Cheers. üçª
  When I updated to Alamofire v4 I get this error from my file upload function: unresolved identfier Manager

Reading form the docs I can see: Manager is now SessionManager

So I changed the name but now I get the error: SessionManager has no member MultipartFormDataEncodingMemoryThreshold

<img width="918" alt="er1" src="https://cloud.githubusercontent.com/assets/10579811/19119262/7f53ae46-8b1f-11e6-8908-4de0e6f072c7.png">
<img width="910" alt="er2" src="https://cloud.githubusercontent.com/assets/10579811/19119270/83689852-8b1f-11e6-9811-ddc58e4e96e9.png">
  Yep...thanks for the fix @Lutzifer! üçª
  Hi @badeleux,

This is really an awesome question. Let me take a stab at walking you through how you could accomplish this.

## Problem

There's no such policy provided by Apple because it ultimately results in two requests which the `URLSession` APIs just aren't designed to do. However, you can definitely accomplish this behavior, but not the way you are intending.

By default, Apple is going to cache the result of a data request in most cases. I'd suggest reading through the [docs](https://developer.apple.com/reference/foundation/urlsessiondatadelegate/1411612-urlsession) on the `URLSessionDataDelegate` protocol to get familiar with the `willCacheResponse` behavior. In almost all cases, Apple and Alamofire will cache the response in the shared URL cache.

## Solution

Now I've thought through quite a few different ways to do this, and the best approach I could come up with was the following:

``` swift
let request = Alamofire.request("https://httpbin.org/get").responseJSON { response in
    let data = response.data
    // Use data to do whatever you need
}

if let urlRequest = request.request {
    let cachedResponse = URLCache.shared.cachedResponse(for: urlRequest)
    let data = cachedResponse.data
    // Use data to do whatever you need
}
```

This logic isn't quite perfect, but it's close. Let's walk through the three success case scenarios that exist here.

### Scenario 1 (no cached response)

The network request is sent with the default cache policy meaning it will first try to load from the cache if not expired, otherwise it will go hit the network. In the event that there's no cached response, the cache will be checked and it will not return a response, so the request will head to the network to download the response. The subsequent check then to extract the cached response while the network request is in-flight will fail since there's no cached response. Then, once the network request succeeds, the response is cached and you can use the data returned by the server. Yay!

### Scenario 2 (expired cached response)

Now the logic is a bit different when the data is cached and expired. The network request will find the cached response, but ignore it since it's expired and will head to the network to get a fresh copy. The URL request is then used to load the cached response from the URL cache while the network request is in flight. Thus you use the expired data while the request is inflight, then replace it once the network request succeeds. Yay!

### Senario 3 (valid cached response)

The final scenario is that the response is cached and is not expired. Now what's going to happen here is that the network request is going to load the cached response since it isn't expired. But before it is returned, you will actually fall into the URL request logic that directly fetches the cached response and uses it because the network request has to hop a few different queues before it can call your completion closure. Once the hops are complete (nano-milliseconds), your cached response is returned for the network request which is the same cached response you just loaded. You could parse the response twice and use it, or you could add some state tracking comparing the previous data against the new data to make sure they're different. Either way, you have to add your own state tracking there which is a bit of a bummer, but it can be done pretty easily.

---

## Summary

Hopefully that helps shed some light on what's all going on there. You could always implement your own logic to determine whether the cached response has actually expired, but that's going to be really difficult to do while matching the exact same behavior that Apple uses. It's unfortunately that Apple doesn't expose an `expired` Bool on a `CachedURLResponse`. It would certainly make this type of issue much easier.

Again, remember this is just one approach. There are MANY different ways you could solve this problem, but I think this is probably the simplest.

Cheers. üçª
  Hi @JordanOsterberg,

You should wipe `DerivedData` for starters. Then make sure you're running against Alamofire 3.5.1 if you're building against Swift 2.3 and Alamofire 4.0.1 for Swift 3. You also need to make sure you're using CocoaPods 1.1.0-rc.2 which can be installed with `gem install cocoapods --pre`.

Cheers. üçª
  You can use CocoaPods just fine, just using the `3.5.1` version, which is Swift 2.2 and 2.3 compatible.  If you really want to install manually you can download the `3.5.1` tag and use the manual installation instructions from our README. 
  @vishal-algoworks Make sure you transition your main project to Swift 3 before using CocoaPods 1.1.0 to install pods, as CocoaPods uses your project's Swift version setting to set the Swift version for all of your pods. Without that transition your project will trigger Xcode's update warning every time you open the project.

@jorgecasariego Like @hardikdevios said, you'll need to update your CocoaPods spec repo to pick up the latest spec versions, or just run `pod update`, in addition to running CocoaPods 1.1.0. 
  Hi @omidkh68,

My guess is that the issue is actually in your implementation, not in the chained method signature...that looks correct. I'd take @hardikdevios's advice here and just rebuild the method and you'll spot your mistake.

In the future, for questions like this, you should instead open a question on [Stack Overflow](https://stackoverflow.com) and tag `alamofire`. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @quiKsilverItaly,

The success case is called because that's the success of the multipart form data encoding. It also exposes the actual upload request allowing you to chain onto it. Your `responseJSON` closure should be called eventually, but it may take a while depending on how much data you're uploading. You could add `uploadProgress` and `downloadProgress` closures to the `upload` to monitor the progress more closely.

Cheers. üçª
  Hi @umeshjavastar,

You're validating that the response status code is 200...299 and it's 400. That's why you're getting an unacceptable status code error. Instead of opening an issue for this on our GitHub project, you should instead open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @hardikdevios. üçª
  Hi @gsujathap, 

These types of questions should be opened as a question on [Stack Overflow](https://stackoverflow.com) with an `alamofire` tag. We use our GitHub project for bug reports and feature requests.

Thanks! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @hardikdevios. üçª
  Hi @yuchenglin,

You need to remove the `public` ACL declaration and add the `@escaping` to the `completion` closure. In the future, I'd suggest you open a question like this on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Don't trust the Xcode autoformatting or converters. Always assume there's an issue there first. It will save you a BUNCH of time at some point. üòâ
  Hi @leizard,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @kalvish21,

There's nothing you're missing. You'll need to look at what's going on server-side to troubleshoot. You can also inspect the encoded data by looking at the data blob directly if you manually encode it. You could do that like this:

``` swift
let multipartFormData = MultipartFormData()

multipartFormData.append(UIImagePNGRepresentation(tempImage!)!, withName: "file", fileName: "picture.png", mimeType: "image/png")
multipartFormData.append((UserDefaults.standard.value(forKey: Email) as! String).data(using: .utf8)!, withName: "email")
multipartFormData.append("png".data(using: .utf8)!, withName: "type")

do {
    let encodedData = try multipartFormData.encode()
    print(encodedData)
} catch {
    print("Encountered encoding error: \(error)")
}
```

We have all sorts of [tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/MultipartFormDataTests.swift) around this in the Alamofire test suite. I really doubt there's any issue in Alamofire and the issue is server-side.

I'm going to close this issue out for now. If you post more info here that leads us to believe this could be an Alamofire error, we'll happily re-open and investigate further.

Cheers. üçª
 Could you provide a test demonstrating the behavior?
  Not completely sure what you're getting bit by since I don't have a full file to compile. I'd guess you need to `import Foundation` or remove the `Progress` declaration like this:

``` swift
upload.uploadProgress { progress in
    print(progress)
}
```

Other than that I'd suggest you compile out parts of your declaration and slowly add it back in to find your mistake. We have all sorts of tests around this in the test suite that don't have the issue.

Best of luck! üçª
  I'd suggest you take your question to [Stack Overflow](https://stackoverflow.com). We use our GitHub project for bug reports and feature requests. 

Also, we are not in the business of writing people's apps for them. Nor suggesting how they should build them. Please do some research on your own before asking questions like this.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @Zfr21,

Please read through the [AF 4 Migration Guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md). It has all the info you need to get up and running.

Cheers. üçª
  Make sure you are using the latest beta version of CocoaPods which is `1.1.0-rc.2`. You can install the latest beta version using `gem install cocoapods --pre`. Here's an example of a sample project that compiles without issue.
- [PodsTester.zip](https://github.com/Alamofire/Alamofire/files/504696/PodsTester.zip)

If you continue to have issues, I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com). We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @emrekilic,

Check out my [answer](http://stackoverflow.com/a/34193782/1342462) on Stack Overflow.

Cheers. üçª
  Thanks @grosch! üçª
  This is no longer needed with the `.swift-version` file and CocoaPods 1.1.0-rc.2. Thanks anyways! üçª
  Thanks @hardikdevios! üçª
  I'd check out @hardikdevios's suggestion and also our [example](https://github.com/Alamofire/Alamofire#uploading-multipart-form-data) in the README. From there, comment out things until it does compile, then slowly add them back in and you'll find your issue.

Best of luck! üçª
  The `NetworkReachabilityManager` is a simple way to tell what the current reachability status is, but more importantly, when your device reconnects to the internet. When it reconnects, you then know you can start up some previously failed requests that failed because connectivity was lost. There's no system in Alamofire that automatically keeps track of all this and just restarts your requests. That type of logic is left for you to implement.

Cheers. üçª
  Hi @kavoskhajavi,

This type of question is best suited for [Stack Overflow](https://stackoverflow.com). We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 I'd also recommend you read through the [Background Transfer Considerations](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/URLLoadingSystem/Articles/UsingNSURLSession.html#//apple_ref/doc/uid/TP40013509-SW44) documentation from Apple.
  Alamofire 4.0.0+ is released on Swift 3. The `swift3` branch has been deleted.
  You need to use the CocoaPods 1.1.0-rc.2 release to use Alamofire 4.0.0+. You can install this version using `gem install cocoapods --pre`.
  Sorry @kakilan, there's nothing here to really go on. If you can produce more info, we'll happily investigate further. Sample app? Stack trace with crash description?

Cheers. üçª
 How did you resolve the issue? What Optimization level did you choose?
  First off, you opened this issue in the wrong repository. Secondly, you need to add way more detail here for us to help you investigate.
  Thanks @bot2600! üçª
  You want to use `URLEncoding.queryString` instead. That will leave your `httpBody` intact. I'd definitely suggest reading through the [docstrings](https://github.com/Alamofire/Alamofire/blob/master/Source/ParameterEncoding.swift#L62-L122) for `URLEncoding` to get a better feel for the options available to you.

Cheers. üçª
 What is the empty JSON you would expect to send @ilandbt...let's start there. What would you like to send up to the server. By empty do you mean nothing? I'm assuming not, but have to ask. I would "assume" you're trying to send an empty dictionary `{}`. Is that correct?
 Thanks for posting that @ilandbt...I've found a few issues in your expectations. First off, the JSON you just posted isn't valid. You are encoding arrays as dictionaries which results in invalid JSON. The valid form of the dictionary in your original question is:

``` swift
import Foundation

let parameters: [String: Any] = ["and": [["id": ["inq":["1", "2", "3"]]], [:]]]

do {
    let data = try JSONSerialization.data(withJSONObject: parameters, options: [])

    if let utf8 = String(data: data, encoding: .utf8) {
        print("JSON: \(utf8)")
    }
} catch {
    print(error)
}

// Outputs: {"and":[{"id":{"inq":["1","2","3"]}},{}]}
```

This is certainly your core issue "if" the invalid JSON you posted is actually what you need to send. In case you just posted the JSON wrong, I went a step further to make sure the empty JSON dictionary is actually encoded when using JSONEncoding.

``` swift
func testEmptyJSON() {
    let urlRequest = URLRequest(url: URL(string: "https://httpbin.org/get")!)
    let parameters: Parameters = ["and": [["id": ["inq":["1", "2", "3"]]], [:]]]

    do {
        let httpBody = try JSONEncoding.default.encode(urlRequest, with: parameters).httpBody

        if let httpBody = httpBody, let utf8 = String(data: httpBody, encoding: .utf8) {
            print("JSON: \(utf8)")
        }
    } catch {
        print(error)
    }
}

// Outputs: {"and":[{"id":{"inq":["1","2","3"]}},{}]}
```

As you can see, it outputs the same JSON as the other example and DOES include the empty dictionary.

What I'd recommend is using the `debugPrint(request)` approach to print out the [cURL command](https://github.com/Alamofire/Alamofire#curl-command-output) for the request. That will show you exactly what's being sent to the server.

If you are debugging on the server, then I'd try to figure out if the server is stripping off the empty dictionary although I really doubt it. You could also use the cURL command and something like Charles Proxy to continue to debug.

At this point, this is on you to investigate because Alamofire is working exactly as it should in this case. If you do need to encode the invalid JSON that you posted, then you'll need to implement your own `ParameterEncoding` type because Alamofire does not encode invalid JSON.

If you continue to have issues, please take your question to Stack Overflow.

Cheers. üçª
  You need to switch over to using the new `downloadProgress` API on a `DownloadRequest` documented [here](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#download-request---complex-with-url-string) in the migration guide and [here](https://github.com/Alamofire/Alamofire#download-progress) in the README. 

Cheers. üçª
  Alamofire 4.0.0 supports Swift 3. The `swift3` branch was removed after it was rebased onto `master`.
  Hi @iosdevben,

I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com) for questions like this. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @J4awesome,

I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com) for questions like this. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Alamofire 3.5.0 requires Swift 2.2 or 2.3 and Alamofire 4.0.0 requires Swift 3.0. If you're installing with CocoaPods, you need to make sure you're running CocoaPods 1.1.0-rc.2 by using `gem install cocoapods --pre`. If you continue to have issues, please take your questions to [Stack Overflow](http://stackoverflow.com).

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @jshier...could you take a stab at investigating this one? We should be able to debug this in the sample app. @bkrijgsman could you answer the following?
- What type of URL session configuration are you using?
- What operating system are you running on? Is it `macOS 10.11.6`? Or are you running in the iOS simulator?
- Would it be possible for you to submit a sample app demonstrating the issue?
 Could you run instruments over the `iOS Example` app to see if you see the same issues? That might be the best way to start. If that doesn't exhibit the issue, then you could build a sample app after that.  That would also give us way more info to go on. 

Just an idea...
 @bkrijgsman These memory leaks were a result of an underlying Swift runtime issue that was [fixed for Swift 3](https://github.com/apple/swift/pull/2326) but not 2.3. We've landed some workarounds for it and another leak that was found in Alamofire 3.5.1. Cheers! üçª 
  Sweet! Thanks @vishrutshah! üçª
  Thanks @grosch! üçª
  Hi @puhgeh,

To be honest, I don't really understand your question. I'm not sure what you mean by an optional prefix. However, I "may" have an idea, so I'm going to roll with it.

I "think" you're asking why `Parameters` is optional in the `ParameterEncoding` protocol. The reason this is optional is that we treat `nil` differently than an empty dictionary. A `nil` dictionary just simply returns the `URLRequest` with no actual parameter encoding since there weren't any parameters. An empty dictionary is however encoded by setting the `Content-Type` header and sometimes setting the `httpBody` of the `URLRequest` to empty `Data`.

If this was not your question, please rephrase and I'll try again.

Cheers. üçª
 Hmmm...I'd guess you're passing in optional String parameters instead of making sure the `client_id` and `grant_type` are actually strings and not optional strings.
 Actually, the values are probably being passed through string interpolation when being added as parameters, as the `Parameters` type of `[String : Any]` won't accept optional values. @puhgeh Don't run your parameter values through string interpolation just to make them non-optional values, you need to actually unwrap them like @cnoon said.
  Thanks for reporting back @rudian. In the future, please take questions like these to [Stack Overflow](https://stackoverflow.com).

Cheers. üçª
  See #1367 for more explanation.
  @Dbigshooter Are you sure your JSON is properly encoded? It sounds like it hasn't been properly encoded into UTF-8, which JSON requires. In any event, Alamofire doesn't do anything special with JSON payloads, it just uses `JSONSerialization` to decode the `Any` value out of the response data. If you find something that might be a bug in Alamofire, feel free to open a new issue with a sample project or at least a code sample that replicates the issue.

Otherwise, these types questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You can encode an `Any` using `JSONSerialization` and get a `Data` value out. Is that what you want? There doesn't seem to be anything Alamofire related here.
 I agree with @jshier, you should use `JSONSerialization` @it99ts. If you continue to have issues, please open a question on [Stack Overflow](https://stackoverflow.com).

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You need to use the following:

## CocoaPods

You need to use `CocoaPods 1.1.0-rc.2` which can be installed with:
- `gem install cocoapods --pre` 

Then your Podfile should include:
- `pod 'Alamofire', '~> 3.5'`

## Xcode

You should be using Xcode 8 (the official release) and Swift 2.3. Make sure you project is updated accordingly.

## Summary

If you're continuing to run into issues, the last thing you can try is to wipe DerivedData. From there, you'll need to open a new question on Stack Overflow for additional help.

Cheers. üçª
  Thanks @vishrutshah! üçª
  Make sure you are using CocoaPods 1.1.0-rc.2 and that your project is set up to compile against Swift 3. You can install the rc version of CocoaPods using: `gem install cocoapods --pre`.
  There's nothing that Alamofire does to speed up or slow down requests. The only advice I have is to check your network connection and also whether you have the network link conditioner enabled accidentally.

If you continue to have issues, I'd recommend opening a question on Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @vishrutshah! üçª
  We're going to need a bunch more detail here @kit24. What type of encoding are you using? What was the previous version where it was working, and which version are you using now? Could you also please provide sample code demonstrating the issue?
 Sweet! Glad to hear it.
  Did you try reading the [Making Requests](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#making-requests) or [Parameter Encoding Protocol](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#parameter-encoding-protocol) sections of the [AF 4 Migration Guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md)? We spent a tremendous amount of time putting that migration guide together to help you with these types of issues. 

> It's very important that you read the AF 4 migration guide in order to successfully convert your pre-existing Alamofire logic correctly and easily.

What you need to do is to switch over to using the `JSONEncoding` instead. Here's an example of [Manual Parameter Encoding](https://github.com/Alamofire/Alamofire#manual-parameter-encoding-of-a-urlrequest) from the README. All you have to do is switch over to using `JSONEncoding` instead.
  Hi @zhangfogao,

This type of question is best suited for [Stack Overflow](https://stackoverflow.com). We use our GitHub project for bug reports and feature requests. Most likely you're issue is due to a mismatch in CocoaPods version or how you have your project configured.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Make sure you are running CocoaPods 1.1.0-rc.2 and you will no longer need to `post_install` hook.
  Hi @Bigboocheng,

I'd suggest you take this question to [Stack Overflow](https://stackoverflow.com). We use our GitHub project for bug reports and feature requests. We have many people successfully using CocoaPods 1.1.0-rc.2 and Alamofire 4.0.0 together without issue.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @bakemecookies! üçª
  Thanks for helping out @skyline75489. Try using `responseString`, `responseData` or `response` @alexfigueroa to figure out what the issue is.

Best of luck! üçª
  I'm unable to reproduce the compiler error @CodeEagle, but this addition of the `Foundation` import certainly won't hurt anything. Thanks for the PR! üçª
  Apologies for the response in #1425 @filippovdev. After further investigation, I found that the challenge is actually called a second time. This is the default behavior of iOS. It will always try to continue without providing a response to the challenge. This is clearly documented in the [Authentication Challenges](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/URLLoadingSystem/Articles/AuthenticationChallenges.html) documentation from Apple.

> I'd highly recommend you checkout that article. It walks you through all the reasoning for why challenges work the way they do.

Alamofire follows the exact same logic as Apple when deciding how to handle challenges. If you insist on modifying the behavior (we would recommend you don't), then you will need to override the `taskDidReceiveChallenge` closure with your own custom logic, or subclass `SessionDelegate` and provide your own implementation for the task challenge API.

Again, I would strongly recommend against this since Apple has built a fairly sophisticated fallback system to attempt to fulfill challenges across multiple protection spaces. However, if you feel that the second call MUST be eliminated, you can certainly do so. This just isn't something we're interested in having directly in Alamofire.

Cheers. üçª
  Thanks @abunur! üçª
  I'm guessing this is in an extension on `Request`? Move the extension to `DataRequest` and see if that fixes it.
  Thanks @thebluepotato. @Jayvd, please don't open duplicate issues. It won't help you get your issue resolved any faster.
 Hi @Jayvd,

I put together a little sample app that demonstrates that making an Alamofire request immediately when your app is opened after unlocking does in fact succeed. I don't know exactly what is going on with your app, but it doesn't seem to be an issue with Alamofire directly.
- [Relauncher.zip](https://github.com/Alamofire/Alamofire/files/491428/Relauncher.zip)

> You'll need to set the team to debug the app on a device. 

I'm not quite sure what to tell you from here. You'll need to investigate your own app further to figure out why your requests are failing. 

I'm going to close this issue out since there's nothing that appears to be wrong with Alamofire. If you do end up finding something specific to Alamofire that seems problematic, please post your findings back on this ticket and we'll happily investigate further.

Cheers. üçª
  You need to make sure you migrate your pre-existing project to Swift 3 before you can use Alamofire 4.0. If you need help migrating your project, you should take your questions to Stack Overflow.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Here's a small example of how you can send headers in a request.

``` swift
let urlString = "https://httpbin.org/get"
let headers = ["Authorization": "123456"]

Alamofire.request(urlString, parameters: ["foo": "bar"], headers: headers).responseJSON { response in
    print(response.result.value)
}
```

I would strongly recommend you take the time to read our [AF 4 migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md). We spent a tremendous amount of time detailing all the changes to make the transition much easier for you.

Best of luck! üçª
  Thanks @YeralYamil! üçª
  We do...it's right in our README for both [Alamofire 3.5.0](https://github.com/Alamofire/Alamofire/tree/3.5.0#requirements) and [Alamofire 4.0.0](https://github.com/Alamofire/Alamofire/tree/4.0.0#requirements).
  Thanks @thebluepotato. @Joanlove526 make sure you're using AF 4 and the latest version of CocoaPods or Carthage. Also make sure to wipe your DerivedData folder.

If you continue to have issues, please seek additional help on Stack Overflow or those particular dependency manager projects.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This is a duplicate of #1594. I'm going to close this issue out. Please direct all future comments to #1594.
  Thanks @thebluepotato. üçª
  Not sure about the `responseObject` response handler, but the rest should be as follows:

``` swift
Alamofire.request(apiURL + "users", headers: headers)
```

The `method: .get` is now the default.

In the future, I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com) for questions like this. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Thanks for helping out @thebluepotato! üçª
  This is a duplicate of #1544. I just commented on that issue as to why the SPM cannot currently compile AF 4.
  Hi @raugustinas,

The code you posted `["Term":]` doesn't even compile. You could pass empty parameters in a `POST` like so:

``` swift
let urlString = "https://httpbin.org/post"
let parameters: Parameters = ["foo": ""]

Alamofire.request(urlString, method: .post, parameters: parameters).responseJSON { response in
    debugPrint(response)
}
```

Cheers. üçª
 Also, in the future, please don't directly tag users on an issue that is opened. It won't help you get your issue resolved any quicker.
  Thanks for the confirmation @michael-mckenna. I'm going to close this issue out.

Cheers. üçª
  There's no longer a `swift3` branch. Instead you want to use:

``` ruby
pod, 'Alamofire', '~> 4.0'
```

Cheers. üçª
  Thank you @ikesyo! üçª

For anyone still having issues, please refer to @ikesyo's solution.
 Wipe your DerivedData folder @amirpervaiz086. If you continue to have questions then you should move your question to Stack Overflow.
  The README has been fully updated for Alamofire 4 and all of our code examples build just fine, so it's not a reliability issue. Please take a look at the [Migration Guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md) for some of the renames the framework has gone through. Otherwise, yes, you'll need to read the header documentation, or if browser reading is better for you, the [documentation at CocoaDocs](http://cocoadocs.org/docsets/Alamofire/4.0.0/index.html) is up-to-date with our latest header docs.
  Please see #1367 and #1490.

Cheers. üçª
  This is fixed in CocoaPods 1.2.0, so there should be no need for that workaround anymore.  Hi @MarshallYang,

This type of question is best suited for [Stack Overflow](https://stackoverflow.com). We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You must use `AlamofireImage 3.0.0` and `Alamofire 4.0.0` along with `CocoaPods 1.1.0-rc.2` if you want to use AlamofireImage on Swift 3. I just created a small sample project demonstrating both working together.
- [AFTester.zip](https://github.com/Alamofire/Alamofire/files/491315/AFTester.zip)

If you are having trouble with the response error documented by @sjmueller...please see his comments to resolve your compilation issue.

Cheers. üçª
  Thanks @leinadoknilik! üçª
  We will not be adding dependencies to Alamofire @pawel-sekara. Please see #1167 for more information.

Cheers. üçª
  For everyone on this thread, especially those blindly up-voting, has anyone actually looked at the Alamofire 3.5.0 release? Seriously, have you looked at the [documentation](https://github.com/Alamofire/Alamofire/tree/3.5.0#requirements)?

It CLEARLY states that Alamofire 3.5.0 DOES support iOS 8. It supports iOS 8, 9 and 10 on both Swift 2.2 and 2.3. Everything that has been requested in this issue is already completely supported.

I'm going to close this issue out since everything has already been addressed.

Cheers. üçª
 No. See #1367 for why.
  Without any details regarding the crash, there's not much we can do here. We'd need the Alamofire, Xcode, and iOS versions at the least, preferably with the crash log. But by just looking at it I'd say you're hitting the implicitly unwrapped optionals when the response isn't quite what you expected. There are 3 crash points in the code you posted alone.
  Please don't spam issues. See #1367 for a full explanation of our decision to drop iOS 8 support.
  This type of compiler error is usually caused by something in your call to `response` no lining up with the compiler's type expectations. I would make sure everything in your codes has the type you think it does.

Otherwise, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  `Any` is not `AnyObject` and you cannot use subscripting on it. Just like you has to use `as AnyObject` to access the count, you'll need to do that same to subscript it. But really you should be using a real type and not `AnyObject`.
  @duanyicanyuan Be sure to clear your derived data after doing an update, it seems like maybe you have some build products in there that haven't been rebuilt.

Otherwise, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Alamofire 3.5.0 supports iOS 8 - 10 and is compatible with Swift 2.2 and 2.3, as well as Xcode 7.3 and 8.0. 
 Either people are copy pasting comments or this issue is getting spammed. Either way, I'm locking it.
  @cnoon I think you're the best one to handle this.
 Thank you for reporting this issue @amosavian. I've added a test in acc7361c that verifies the behavior works correctly in the official Xcode 8 release on iOS 10 and iOS 9. Looks like the issue has been resolved in the underlying URLSession logic.

Cheers. üçª
 Thanks for letting me know @amosavian. I'm going to re-open and see if I can reproduce the behavior in a sample app since background session configurations no longer work in the simulator in Xcode 8.
 Hi @amosavian,

Thank you for bringing the error to our attention. After much debate, we've decided to leave this out of Alamofire due to the instability of this type of solution. Apple has really made a huge mess here and we're not sure about what all the permutations of various uploads and downloads could actually be. We also wouldn't be able to test any of the logic since the background URL sessions are broken in test targets. Because of all these issues, we're not comfortable taking ownership of such a fragile solution for a black box Apple feature.

With that said, we fully support the approach you've put in place for users that "have" to solve this issue. We just won't be implementing the solution directly into Alamofire. We have updated our docstrings and README in 4af61a69 to reflect the current state of resume data on the latest platforms. Hopefully this gets people started in the right direction.

Thanks again. üçª
 @amosavian Are you able to share the official workaround?
  Yes, the real solution here is to ensure you're running CocoaPods 1.1.0, as it's the only version that knows what to do with the `SWIFT_VERSION` flag. Also, it gets that setting from the target you're linking pods against, so make sure you've updated your project for Xcode 8.
  Thank you everyone for all the detailed information. 

@asynchrony-ringo is certainly correct. The core issue stemmed from the validation closures not marking each internally stored closure as `unowned self`. I've pushed 32b0ae9c into `master` which will be released shortly that addresses the issue. Validation no longer causes the request to leak. Also @StephaneGarnier, the `download` and `upload` progress APIs do not cause any leaks.

## Background

To give a bit of backstory, any closure that executes on the TaskDelegate's operation queue MUST capture a reference to `self`. Without this, the `Request` will actually be deallocated before the closure can be run which will result in no-ops for things like response handlers. The reason for this is that once the `URLSessionTask` completes, Alamofire no longer holds a strong reference to the `Request`. It is released by the `SessionDelegate` as soon as the task completes.

> This behavior is slightly different when using a `RequestRetrier`, but let's assume for now you're not using one.

Once the task completes, the `Request`'s internal operation queue is resumed and the `Request` is released by Alamofire. The only thing still holding a reference to the `Request` at this point is any closure that was dispatched onto the operation queue. GCD holds onto the operation queue (dispatch queue underneath) until all the closures on the queue have completed. Then GCD will cleanup the queue which is roughly the same time the `Request` will be deallocated.

## Alamofire 4

In Alamofire 4, we moved all validation to be stored directly by the `Request` so we can run validations off the operation queue. This allows us to support the `RequestRetrier` before actually starting the internal operation queue in case we need to retry the request before running the response handlers. The mistake we made when we did this was that we forgot to mark the validation closures as `unowned` so that we wouldn't create a retain cycle. The changes in 32b0ae9c remove the retain cycle.

We'll look to get this fix deployed as soon as possible. Thanks again everyone for all your help here.

Cheers. üçª
  Alamofire 3.5 an 4.0 both support tvOS 9, yes.
  Make sure you're updated to the latest Carthage and are running Xcode 8 (and that it's selected as your default Xcode, if you have multiple versions installed). You could also try clearing out your Carthage checkouts and reinstalling.

Otherwise, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @romk1n You can see issue #1367 for our full reasoning behind dropping iOS 8 support. 
  When you update your project to Swift 3, you need to run the conversion tool on your project first (not the CocoaPods, just your project). This is in the Edit menu -> Convert -> "To Current Swift Syntax...". This will update your project to require the Swift version you select (2.3 or 3), in addition to attempting to transition your apps code to that version of Swift as well. Once that's done and your project file has been modified to contain the `SWIFT_VERSION` setting, running `pod update` will use that setting to generate a new `Pods` project integration that uses that setting to set the Swift version for all of your pods. That should fix issues with the `SWIFT_VERSION` setting being required and such. 

However, since this is entirely an Xcode and CocoaPods integration issue I'm closing this issue out. If you have further issues, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 There is not solution beyond what I've described. A project that has properly upgraded to Swift 3, CocoaPods 1.1.0, and Alamofire 4 should build just fine, barring any updates that must be made in the app's code to support the Alamofire 4 changes. Your issues are not with Alamofire, they're with something in your integration process that's preventing Xcode from seeing and building your app and it's dependencies as Swift 3 code. That is far beyond the purview of Alamofire.
  You need to update the Swift syntax of your app to match the Swift 3 and Xcode 8 requirement of Alamofire 4.0. Once that is done, and you do a `pod update` using CocoaPods 1.1.0, it will work just fine.
  Unfortunately this isn't an Alamofire issue, as Alamofire doesn't interact with raw sockets at all. All of Alamofire's networking is done through the `URLSession` APIs, so if there's an issue there I'd suggest opening a bug with Apple.

Otherwise, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  From those errors it appears you aren't using Xcode 8. Alamofire 4 requires Xcode 8. If you need to keep using Xcode 7, please use Alamofire 3.5.0.
 Hi everyone,

I agree this issue was closed pre-maturely without a proper response. With that said, please cut @jshier some slack. He's been plowing through 50+ issues every day since we've released. We all make mistakes from time to time.

As for this particular issue, the problem is that the SPM automatically uses a deployment target of 10.10 which doesn't work with AF 4 since AF 4 requires 10.11+. That's why you see all the `URLSessionStreamTask` errors when trying to compile. 

I've reached out to `swift-users` to see if there's any way to customize this, but from what I can tell, there isn't. I'll file a feature request under the Swift bug reporter if this ends up being the case. If you can actually override it, I'll post back here with instructions.

Cheers. üçª
 So I've spent some time on `swift-users` trying to get to the bottom of how this all is supposed to work and I think I have it pretty much figured out. Although there are still some serious shortcomings, you can at least get things to work. If you follow these steps, you can get things working.

## Using SPM with Alamofire

1) Clone Alamofire locally and tag the `master` branch as `4.0.2`

> This is necessary to pick up a change I made in the `Package.swift` file that hasn't been released yet

2) Create an example project
3) Create a `Package.swift` file for your project similar to the following:

``` swift
import PackageDescription

let package = Package(
    name: "SPMTester", 
    dependencies: [
        .Package(url: "/Users/cnoon/Desktop/Alamofire", "4.0.2")
    ]
)
```

4) Create your `main.swift` file in `Sources`

``` swift
import Alamofire
import Foundation

Alamofire.request("https://httpbin.org/get").responseJSON { response in
    debugPrint(response)
    exit(0)
}

RunLoop.current.run()
```

5) Create a `Configuration.xcconfig` file to override the deployment target

``` bash
SDKROOT = macosx
MACOSX_DEPLOYMENT_TARGET = 10.11
```

6) Generate the Xcode project for your new example

> $ swift package generate-xcodeproj --verbose --xcconfig-overrides ./Configuration.xcconfig --output ./SPMTester.xcodeproj

7) Open the Xcode project, navigate to the project (not target) settings and delete the `MACOSX_DEPLOYMENT_TARGET` setting so the xcconfig value can be picked up by the project
8) Build and run

Here's an example of a small `SPMTester` project that I put together.
- [SPMTester.zip](https://github.com/Alamofire/Alamofire/files/505238/SPMTester.zip)

---

## Summary

Now this is certainly still WAY more painful than it should be, but at least it's actually up and running. Once the community adds more features this process should get easier and easier.
  You can see issue #1367 for a full explanation of why we aren't. 
 That is not why. See #1367 for more details and be forewarned, your fork likely isn't reimplementing the various workarounds we had for iOS 8 bugs.
  You can see issue #1367 for a full explanation as to why we dropped iOS 8 support.
  Please ensure you are using the appropriate version of Xcode for the version of Alamofire you're trying to use. Alamofire 4 requires Xcode 8, Alamofire 3.5 is compatible with both Xcode 7.3 and Xcode 8 with the "Use legacy Swift version" setting set to true.
  Nothing you've posted points to an Alamofire issue. (You should update to Alamofire 3.5, there have been many bug fixes since 3.1). 

These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 I'll just say, I have seen errors like this when I was using CocoaPods to try and embed frameworks inside a framework target which I then used in my main app. CocoaPods can't properly do that right now, so while the autocomplete and stuff may work, the overall build would fail because the symbols weren't properly exported through the various layers of frameworks to my call site in the app. Other than that I think StackOverflow will give you a better chance of finding a fix.
  Alamofire 4 requires Swift 3, which has renamed `NSTimeInterval` to `TimeInterval`. You need to use Xcode 8 to properly compile this project. Please see our README and Migration Guide for more info.
  Yes, `Response` has been split into some specific types. Please see the README and Migration Guide for more info.
  Thanks for putting this together @ThibaultVlacich!
  @qgliu `sharedInstance` has been renamed `default` in accordance with Swift 3's new naming guidelines. You'll find what you want there.
  Yep, it appears we definitely did! Thanks for putting this together @Toldy...much appreciated! üçª
  @xiaopn166 The answer to your question was right there in the CocoaPods output: `Specs satisfying the Alamofire (~> 4.0) dependency were found, but they required a higher minimum deployment target.` Alamofire 4.0 has higher OS requirements than 3.5, so make sure your deployment target meets the minimums specified in our README.

@amolgupta That workaround should not be required if you update to CocoaPods 1.1.0.
  @gcjg Please provide a sample project that replicates what you're seeing. We have many tests, examples, and demo projects that demonstrate that the code you posted does work. If you do, feel free to open another issue with a more in depth analysis and said sample project and we'll be happy to investigate further.

One thing to note, though, is that `JSONEncoding` encodes your parameters as JSON and put it in the `httpBody` of the `URLRequest` created. When used with a `.get` method, the server may not expect this, as `GET` requests usually encode parameters in the URL itself.
 If you can provide a test project that can replicate the behavior you're seeing, feel free to add it to this issue and I'll reopen or open a new issue. Until then, I've verified the scenario you've described works fine, both in our tests and in a demo app I set up fresh. My only point in bringing up the details of `JSONEncoding` was to ensure you knew about this behavior, as some servers don't parse body details from GET requests (like `httpbin.org`). 
  @rakeshbiswalmobileprogrmming There is quite a bit in our README about adding authorization headers or using our `.authenticate()` function. Please read it and I think your questions will be answered.

@cnoon Perhaps this is related to #1553? 
 Hi @Tulleb,

Apologies for not getting back to you sooner. The example @katopz is not the same type of request. That example demonstrates how to use a data task, not a download task. If you don't wish to download the file, you can instead do the following:

``` swift
Alamofire.request(url).responseData { response in
    guard let data = response.result.value else { return }
    let image = UIImage(data: data)
    print(image)
}
```

However, to answer you're original question, you're running into a sandbox permissions issue. We allow you to use the `download` APIs without specifying a `destination` closure for operating systems like `macOS` where you can access files outside of your own sandbox. However, on iOS, you cannot directly access the data of a file that is outside of your sandbox. That's why you are seeing the `.inputFileReadFailed` error.

There are a couple ways you can solve this issue. 

## Option 1

You can download the data using the `request` API as shown above which downloads the image data into memory, not to disk.

## Option 2

You can move the file into your sandbox before accessing the data using a `destination` closure. Here's an example of how to do that:

``` swift
let destination: DownloadRequest.DownloadFileDestination = { _, _ in
    let documentsPath = NSSearchPathForDirectoriesInDomains(.documentDirectory, .userDomainMask, true)[0]
    let documentsURL = URL(fileURLWithPath: documentsPath, isDirectory: true)
    let fileURL = documentsURL.appendingPathComponent("image.png")

    return (fileURL, [.removePreviousFile, .createIntermediateDirectories])
}

Alamofire.download("https://httpbin.org/image/png", to: destination).responseData { response in
    debugPrint(response)

    if let data = response.result.value {
        let image = UIImage(data: data)
        print(image)
    } else {
        print("Data was invalid")
    }
}

// Outputs:

// [Request]: https://httpbin.org/image/png
// [Response]: <NSHTTPURLResponse: 0x170032940> { URL: https://httpbin.org/image/png } { status code: 200, headers {
//     "Access-Control-Allow-Origin" = "*";
//     "Content-Length" = 8090;
//     "Content-Type" = "image/png";
//     Date = "Sat, 24 Sep 2016 21:34:25 GMT";
//     Server = nginx;
//     "access-control-allow-credentials" = true;
// } }
// [TemporaryURL]: /private/var/mobile/Containers/Data/Application/25612024-9A05-4ED5-AF3B-A98E22DEAD7A/tmp/CFNetworkDownload_fD9sXf.tmp
// [DestinationURL]: /var/mobile/Containers/Data/Application/25612024-9A05-4ED5-AF3B-A98E22DEAD7A/Documents/image.png
// [ResumeData]: 0 bytes
// [Result]: SUCCESS: 8090 bytes
// [Timeline]: Timeline: { "Request Start Time": 496445664.792, "Initial Response Time": 496445665.651, "Request Completed Time": 496445665.655, "Serialization Completed Time": 496445665.655, "Latency": 0.860 secs, "Request Duration": 0.863 secs, "Serialization Duration": 0.000 secs, "Total Duration": 0.864 secs }
// Optional(<UIImage: 0x17008bc20>, {100, 100})
```

You MUST use a destination closure if you need to download the file to disk. The temporary file can only be accessed inside the delegate callback which is handled internally in Alamofire. If you do not specify a destination closure on iOS, the `temporaryURL` will always point to where the temp file was previously stored, but has been cleaned up.

## Summary

So in summary, if you don't need to download the data to disk, then you want Option 1. If you do want to save the file on disk, then you want Option 2.

Cheers. üçª
  @lawgimenez We have quite a few tests and apps using this behavior, so it's unlikely that this is an Alamofire issue. Mostly likely it's an issue with your underlying app code. However, if you can narrow down a cause and create a reproducible test case, feel free to open a new issue so we can investigate further.
  There is something seriously wrong with your build environment if your Xcode can't find the `Error` type. Perhaps your project is set to use Swift 2.3 and you tried to install Alamofire 4? 3.5 is the only version compatible with Swift 2.3.
  @ostatnicky's workaround should not be necessary if you're using CocoaPods 1.1.0, as it adds that setting to your `Pods` project automatically. As with any upgrade of Xcode and dependencies, clearing your DerivedData folder is always a good idea.
  Thanks for providing your test project. It builds successfully for me, as do my own Alamofire-from-CocoaPods test projects. So it just seems to be a general build issue with your environment.

These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You can find a full explanation of the decision to drop older iOS and macOS version in issue #1367. 
 If you wish to use Xcode 8 and Alamofire while targeting iOS 8, please use Alamofire 3.5.0 and Swift 2.3.
  Apologies @radar, it is certainly not our intention to ever publish examples that produce ambiguity compiler errors. We'll look into this and get things corrected. Stay tuned.
 Okay @radar, thank you for your patience here. 

First off, the issue in your code sample is that you need to remove the `data:` parameter when appending the `imageData`. This will compile just fine:

``` swift
let imageData = UIImageJPEGRepresentation(photo.image, 1.0)

Alamofire.upload(
    multipartFormData: { multipartFormData in
        multipartFormData.append(imageData, withName: "unicorn")
    },
    to: "https://httpbin.org/post",
    encodingCompletion: { encodingResult in
        switch encodingResult {
        case .success(let upload, _, _):
            upload.responseJSON { response in
                debugPrint(response)
            }
        case .failure(let encodingError):
            print(encodingError)
        }
    }
)
```

> It is unfortunate that the error message is so bad. Sadly we can't do anything about that. üòî

As for our [multipart form data sample code](https://github.com/Alamofire/Alamofire#uploading-multipart-form-data) in the README, it compiles just fine without ambiguity.

``` swift
Alamofire.upload(
    multipartFormData: { multipartFormData in
        multipartFormData.append(unicornImageURL, withName: "unicorn")
        multipartFormData.append(rainbowImageURL, withName: "rainbow")
    },
    to: "https://httpbin.org/post",
    encodingCompletion: { encodingResult in
        switch encodingResult {
        case .success(let upload, _, _):
            upload.responseJSON { response in
                debugPrint(response)
            }
        case .failure(let encodingError):
            print(encodingError)
        }
    }
)
```

@paulrobinmanson it looks like you have the same issue. You need to remove your `data` parameter in the `append` method, then it will compile correctly.

Cheers everyone. üçª
 @paulrobinmanson you use it the same way as in v3. Tack the `uploadProgress` closure onto the `upload`.

``` swift
Alamofire.upload(
    multipartFormData: { multipartFormData in
        multipartFormData.append(unicornImageURL, withName: "unicorn")
        multipartFormData.append(rainbowImageURL, withName: "rainbow")
    },
    to: "https://httpbin.org/post",
    encodingCompletion: { encodingResult in
        switch encodingResult {
        case .success(let upload, _, _):
            upload.uploadProgress { progress in
                print(progress.fractionCompleted)
            }
            upload.responseJSON { response in
                debugPrint(response)
            }
        case .failure(let encodingError):
            print(encodingError)
        }
    }
)
```
  @Canmmy If you are integrating Alamofire through CocoaPods, make sure you update to CocoaPods `1.1.0` and run `pod update`. Also, remember that you can only use Alamofire `3.5` and Swift 2.3 on iOS 8.
  This is awesome, thanks for putting this together @JustinJiaDev...much appreciated! üçª
  You should make sure you're using CocoaPods `1.1.0.rc.2`, as that version of CocoaPods will generate the `Pods` project with the correct settings so Xcode won't say you need an upgrade. Plus, make sure you use Alamofire 3.5, as that's the only version compatible with Swift 2.3.
  All of the examples in the README, including [the router example](https://github.com/Alamofire/Alamofire#crud--authorization) have been updated to use the new protocol.
  @ka05 Please don't use 3.4.2. The last supported version for iOS 9 and Xcode 7 is 3.5.x. 
  As you can see in our [migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#namespace-changes), `Manager` has been renamed `SessionManger`.
  Thanks @glennrfisher!
  There are the `totalUnitCount` and `completedUnitCount` properties you can use. We had to remove the other version of the `progress` API because of a compiler issue and we'll try to add it back once the compiler is okay with both versions.
  You most likely don't want to use the `stream` APIs here, but that's just a guess.

These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Absolutely @chunlea...that was completely my fault. We'll have this fixed shortly.
 Hi @chunlea,

Thank you so much for figuring out this was the core issue! I had actually been having this happen to me several times while working on AF4 and somehow I never realized it was actually running the test suite on OS X that was the root problem.

I've pushed up commit 8f370a23 that fixes the issue. We now only write files to the temp directory in the test suite.

Cheers. üçª
  Hi @Urkman,

We have quite a few unit tests verifying this behavior works correctly. I just ran the [`testThatUploadingMultipartFormDataWhileStreamingFromMemoryMonitorsProgress`](https://github.com/Alamofire/Alamofire/blob/master/Tests/UploadTests.swift#L331-L333) test and added the following debug output:

``` swift
// When
Alamofire.upload(
    multipartFormData: { multipartFormData in
        multipartFormData.append(loremData1, withName: "lorem1")
        multipartFormData.append(loremData2, withName: "lorem2")
    },
    usingThreshold: streamFromDisk ? 0 : 100_000_000,
    to: urlString,
    encodingCompletion: { result in
        switch result {
        case .success(let upload, _, _):
            upload
                .uploadProgress { progress in
                    print("Upload Progress: \(progress.fractionCompleted)")
                    uploadProgressValues.append(progress.fractionCompleted)
                }
                .downloadProgress { progress in
                    print("Download Progress: \(progress.fractionCompleted)")
                    downloadProgressValues.append(progress.fractionCompleted)
                }
                .response { resp in
                    response = resp
                    expectation.fulfill()
                }
        case .failure:
            expectation.fulfill()
        }
    }
)
```

What it ended up logging out is the following:

```
Test Case '-[Alamofire_iOS_Tests.UploadMultipartFormDataTestCase testThatUploadingMultipartFormDataWhileStreamingFromMemoryMonitorsProgress]' started.
Upload Progress: 0.0450805914626429
Upload Progress: 0.135241774387929
Upload Progress: 0.135241774387929
Upload Progress: 0.135241774387929
Upload Progress: 0.135241774387929
Upload Progress: 0.135241774387929
Upload Progress: 0.202862661581893
Upload Progress: 0.202862661581893
Upload Progress: 0.202862661581893
Upload Progress: 0.360644731701143
Upload Progress: 0.360644731701143
Upload Progress: 0.360644731701143
Upload Progress: 0.360644731701143
Upload Progress: 0.360644731701143
Upload Progress: 0.360644731701143
Upload Progress: 0.360644731701143
Upload Progress: 0.383185027432464
Upload Progress: 0.428265618895107
Upload Progress: 0.428265618895107
Upload Progress: 0.450805914626429
Upload Progress: 0.47334621035775
Upload Progress: 0.495886506089072
Upload Progress: 0.540967097551714
Upload Progress: 0.540967097551714
Upload Progress: 0.653668576208322
Upload Progress: 0.653668576208322
Upload Progress: 0.653668576208322
Upload Progress: 0.676208871939643
Upload Progress: 0.676208871939643
Upload Progress: 0.766370054864929
Upload Progress: 0.766370054864929
Upload Progress: 0.766370054864929
Upload Progress: 0.766370054864929
Upload Progress: 0.766370054864929
Upload Progress: 0.78891035059625
Upload Progress: 0.856531237790215
Upload Progress: 0.879071533521536
Upload Progress: 0.879071533521536
Upload Progress: 0.879071533521536
Upload Progress: 0.924152124984179
Upload Progress: 0.924152124984179
Upload Progress: 0.991773012178143
Upload Progress: 0.991773012178143
Upload Progress: 0.991773012178143
Upload Progress: 1.0
Download Progress: 0.044996896576347
Download Progress: 0.0888458010403335
Download Progress: 0.13384269761668
Download Progress: 0.178839594193027
Download Progress: 0.223836490769374
Download Progress: 0.268833387345721
Download Progress: 0.313830283922068
Download Progress: 0.359975172610776
Download Progress: 0.359975172610776
Download Progress: 0.404972069187123
Download Progress: 0.448820973651109
Download Progress: 0.493817870227456
Download Progress: 0.538814766803803
Download Progress: 0.538814766803803
Download Progress: 0.58381166338015
Download Progress: 0.763799249685538
Download Progress: 0.763799249685538
Download Progress: 0.763799249685538
Download Progress: 0.763799249685538
Download Progress: 0.808796146261885
Download Progress: 0.808796146261885
Download Progress: 0.898789939414579
Download Progress: 0.943786835990926
Download Progress: 1.0
Download Progress: 1.0
Test Case '-[Alamofire_iOS_Tests.UploadMultipartFormDataTestCase testThatUploadingMultipartFormDataWhileStreamingFromMemoryMonitorsProgress]' passed (1.514 seconds).
```

So from what I can tell, everything is working exactly as expected. If you can produce some failing test that proves otherwise, I'll gladly take a look and re-open if necessary.

Cheers. üçª
  Thanks @a2!
  You need to upgrade to CocoaPods 1.1.0 to properly use Swift pods with Xcode 8.
  @otherbuns Take a look at our [migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#parameter-encoding-protocol) you'll see that our parameter encoding methods have radically changed for Alamofire 4. You no longer need to use the ugly `.custom` syntax. Instead you can wrap your encoding logic in a type conforming to `ParameterEncoding`. 
 Hey @kevinlee85, the easiest way to fix your issue is to comment the code out and rebuild it with auto-complete. The error is usually pretty obvious when you do it that way.
  @kthotav You can run `pod cache clean --all` to make sure you'll pull the appropriate Alamofire source. You can also run `rm -rf Pods` from your project directory to make sure CocoaPods properly reinstalls everything. After that your project should build fine.
 @EtienneLem That issue is fixed in the Xcode 8 GM. None of the issues here are Alamofire issues, they all seem related to integration, whether through CocoaPods or not.
  This would definitely be a worthwhile change. We'll need to make it across all three libraries though.
 PR #1520 has been merged. Thanks for putting this together @JustinJiaDev! üçª
  Good catch! Thanks @JustinJiaDev. üçª
  Thanks @thebluepotato. üçª
  Good catch! Thanks for the fix. üçª
  You need to update to CocoaPods `1.1.0` to properly support Xcode 8.
 @Gargo There is no version 4.0 yet, as it hasn't been pushed to CocoaPods. We're working on it now and hope to have it pushed up this weekend.
 AF 4 is now available!
 Installation instructions in the README should not work fine, as we've been able to publish the pod and tag the 4.0.0 release.
 If you're writing a new project and are using Swift 3, use Alamofire 4.0.0, otherwise use 3.5.
 CocoaPods works fine, your installation just seems messed up. But yes, Carthage and manual integration also work fine, as laid out in our README.
 1.1.0 is required if you are using Xcode 8, as stated in our README.
 @Gargo...many of us are now using Alamofire 4 with CocoaPods 1.1.0-rc.1 with the Xcode 8 GM. Our documentation did not match up with the official release for a couple days which certainly caused some people some issues. We're sorry for that. It wasn't our intention to cause confusion. However, that branch was not yet released, so to expect all the documentation to be exactly right is not really realistic.

If you continue to have issues, then as others have mentioned, I'm sure you have an issue with your CocoaPods setup. I'd recommend taking this to Stack Overflow or to CocoaPods.

With all that said, I'm going to lock this conversation down. Several people have tried to help you here and you're not being particularly respectful of their assistance. Please, in the future, use better judgment when asking for help.

Best of luck. üçª

---

# Code of Conduct

The Code of Conduct governs how we behave in public or in private
whenever the project will be judged by our actions.
We expect it to be honored by everyone who represents the project
officially or informally,
claims affiliation with the project,
or participates directly.

We strive to:
- **Be open**: We invite anybody to participate in any aspect of our projects.
  Our community is open, and any responsibility can be carried
  by any contributor who demonstrates the required capacity and competence.
- **Be empathetic**: We work together to resolve conflict,
  assume good intentions,
  and do our best to act in an empathic fashion.
  By understanding that humanity drops a few packets in online interactions,
  and adjusting accordingly,
  we can create a comfortable environment for everyone to share their ideas.
- **Be collaborative**: We prefer to work transparently
  and to involve interested parties early on in the process.
  Wherever possible, we work closely with others in the open source community
  to coordinate our efforts.
- **Be decisive**: We expect participants in the project to resolve disagreements constructively.
  When they cannot, we escalate the matter to structures
  with designated leaders to arbitrate and provide clarity and direction.
- **Be responsible**: We hold ourselves accountable for our actions.
  When we make mistakes, we take responsibility for them.
  When we need help, we reach out to others.
  When it comes time to move on from a project,
  we take the proper steps to ensure that others can pick up where we left off.

This code is not exhaustive or complete.
It serves to distill our common understanding of a
collaborative, shared environment and goals.
We expect it to be followed in spirit as much as in the letter.
  @WERUreo, we're updating the documentation now. Please stop commenting on various issues about it. We're fully aware that the documentation does not "exactly" reflect the current state of the unreleased `master` branch.
 No worries @WERUreo...we've had a long past few days and have been updating docs tirelessly. Unfortunately you bore the brunt of my frustration of users jumping on `master` without understanding what the current state of it is. My apologies.
  Alamofire 3.5.0 only supports Swift 2.3. You need to use HEAD of master for Swift 3. We haven't released Alamofire 4 yet with Swift 3 support.
 We're actively updating the documentation now @WERUreo. Please understand that Alamofire 4.0.0 is not released. If you are looking at unreleased branches, you cannot expect all the documentation and everything to be perfectly up-to-date.
  Alamofire 3.5.0 supports Swift 2.3. If you're trying to build a project using Swift 3, you need to use the HEAD of `master` right now.

Cheers. üçª
  Thanks @lostincode.

In the future, I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com) for questions like this. We use our GitHub project for bug reports and feature requests.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You're missing the necessity to use the `master` branch for Swift 3 compatibility or `3.5.0` for Swift 2.3, and update to CocoaPods `1.1.0.beta.2` to properly support Xcode 8 (mostly). 
  Thanks @thebluepotato. üçª

In the future, I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com) for questions like this. We use our GitHub project for bug reports and feature requests.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  The `destination` closure signature has changed. You now need to return the `DownloadOptions` along with the URL to allow you to custom how the file is moved.

``` swift
public typealias DownloadFileDestination = (
    _ temporaryURL: URL,
    _ response: HTTPURLResponse)
    -> (destinationURL: URL, options: DownloadOptions)
```
  This PR is an alternate approach to solving the issue identified in #1488. Overall, I think this is a better approach to solving the problem. This allows us to keep the same public APIs, but allow the compiler to catch all the places where the problem wasn't previously identified.

Overall, I don't think it is necessary to keep the `URLRequest` API conforming to `URLStringConvertible`. We don't actually use it for anything anymore and it's misleading and problematic. I actually almost removed it before but didn't have a strong reason to because I hadn't realized what @tremblay did.
 cc @jshier and @kcharwood for review.
 Looks good to me. 
 Awesome, thanks @jshier.
 Thanks for the heads up @adamwaite...we'll get AlamofireImage fixed up as well.
 AFI is a bit out-of-date with AF at the moment. We're wrapping the AF 4 release right now. Once that is out, AFI will be next.
  Hi @steveatinfincia,

Thanks for putting together this issue. It's well thought out and makes a very good case against our current deployment target choices. Let me do my best walk you through being on the other side of this ask.

## Background

Alamofire currently supports 4 platforms each across two MAJOR versions of each of them. It also supports three different versions of Swift, not to mention we maintain three different libraries. All of this put together is a huge effort to maintain and keep bug free. We've managed to do a pretty good job on this front, but it's not scalable if we move to supporting 3 MAJOR versions at the same time.

It's very important for us to keep our MAJOR versions supported bundled together across platforms. What I mean by that is that if we decided to support macOS 10.10, then we should really support iOS 8 since they are more or less the same version of the underlying frameworks. Since tvOS and watchOS (debatable) weren't around then, they don't fall into this camp. This helps keep the supported versions more cohesive and also helps us keep in mind the limitations and bugs in these different versions of the underlying frameworks.

There have been some pretty nasty hacks we've had to put in place to workaround various bugs on some of the older frameworks. We've also had to put in place a bunch of workarounds to get around various differences between the platforms across MAJOR versions. All of this creates a VERY large amount of maintenance headache, especially when it comes to testing. We want to make sure we're providing a top notch library with everything covered (as much as possible) in unit or integration tests. And not only do we want to make sure we have full coverage across our feature set across all platforms and versions, we also want to make sure they all pass and continue to pass!

## Testing

Thankfully we're able to leverage Travis CI for testing which has been a huge help, even if it is a little unstable at times. The biggest gap we have here though is actually when trying to test the macOS builds. We don't have the ability to run the test suite on older versions right now. [Travis-CI](https://docs.travis-ci.com/user/osx-ci-environment/) has amazing support for older versions of Xcode, but not on varying OSX versions. This means that we'd be able to get things compiling, but wouldn't be able to run the test suite against macOS 10.10 which is a super high risk proposition. Especially when that's the oldest platform and the one that we've forgotten the most about.

## Decision

Given all these things, we've decided that it's the best overall decision for the community for us to drop both iOS 8 and macOS 10.10 support in Alamofire 4. Please don't think we made this decision lightly. It actually took us several days to come to a consensus. Now what we also don't want to do is leave users in the dark. This is why we released Alamofire 3.5.0 supporting both Swift 2.2 and 2.3 (not a small task) supporting iOS and tvOS 8-10, macOS 10.10-10.12 and watchOS 2-3. We also managed to get the Travis-CI yaml file working across both Xcode 7 and 8 so we have the coverage in the test suite that we're looking for. This allows anyone out there that needs to support macOS 10.10 or iOS 8 to at least have the option to do so while migrating over to Swift 3.

## Options

Now in the worst case scenario that someone is building a new macOS app in Swift 3 and needs to support macOS 10.10, then they'll need to do so in a fork. I just did it to see what would be required and it would just need availability checks around all the `StreamRequest` support. There are probably some other oddities in the test suite that would need to be addressed as well. But this is really worst case scenario if the Alamofire 3.5.0 release just cannot work for you.

I really hope that helps explain our point of view on this matter. Again, it wasn't an easy decision, but we stand by it being the correct one for the community as a whole.

Cheers. üçª
  Absolutely! Great call @rastersize. This was always the intent, but we missed this change when the GM dropped.

Cheers. üçª
  This is a great catch @tremblay! I don't really like modifying the public API that way though. The core issue is that `URLRequest` conforms to `URLStringConvertible` and I'm really leaning towards removing that functionality for the exact reason you posted. I'm going to try this out and see how it feels. Not sure of all the implications of removing the conformance there.

Stay tuned.
 Man, great catch @tremblay! I just put together #1491 that takes a different approach to solving the same problem. I'd love to get your thoughts there. We spent forever (literally hours) trying to get the public APIs just right and to be consistent across different request types. I think #1491 accomplishes this nicely by simply removing conformance where it isn't necessary.
 Thanks again for finding the issue @tremblay! 

We've decided to go with the approach in #1491 which has been merged into the `master` branch. I'm going to go ahead and close this PR out. If you have any feedback on the approach, please direct all future comments to #1491. We're getting really close to release, so please get your feedback in asap if you have any.

Cheers. üçª
  It will be removed once we officially release Alamofire 4.0.0 @CedricEugeni. We're working tirelessly to wrap up everything to make AF 4 as awesome as possible! We're almost 100% code complete and just need to update the docs. 

Your patience is greatly appreciated. üçª
  Hi @dylan,

II suggest you take this question to Stack Overflow. We use our GitHub project for bug reports and feature requests. I doubt there's anything that's actually wrong with Alamofire. With that said, if that does end up being the case, please post the info back on this ticket and we'll happily re-open and investigate further.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Looks like you're all squared away @adamn. üëçüèº
  Very odd...all our tests prove otherwise here. Could either of you put together a small sample app that demonstrates this issue?
 Perfect, thanks for the heads up @timgcarlson. We'll keep this open until we hear back from you.
 Awesome, thank you both for confirming.

Cheers. üçª
  @cyurtbil Alamofire works fine with the `use_frameworks!` flag, as that's the only way to build Swift pods in the first place. 

However, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  The changes for Alamofire 4 are rather extensive so you'll have to explore a bit until we get the migration guide updated. Once everything is officially released it should be there.
  It's recommended that you use the `3.5.0` tag until we can get it officially released.
  Alamofire 3.5.0 only supports Swift 2.2 and 2.3. We are working on a 4.0 release which will support Swift 3. In the meantime, for Swift 3, use the `master` branch.
  A migration guide is coming but the changes for Alamofire 4 have been extensive. Until the guide is released, checkout the recently landed PRs to see what they are. Namely, there is no longer a `ParameterEncoding` enum but rather a protocol, so you'd use `JSONParameterEncoding` there. For the second, the upload progress methods have been renamed to `uploadProgress` and `downloadProgress` to properly separate them out.
  It's best to use the `master` branch for Swift 3 at the moment and we'll be releasing it as soon as the migration guide is done and CocoaPods can actually publish Swift 3 pods.
  There is an official `4.0.0` release coming with significant changes over `beta.1` and `beta.2`. Until then you can use the `master` branch and continue modifying the plist generated for the framework.
  `3.5.0` is the last of the 3.x line and Swift 2.2/2.3 compatible. `4.0.0` is coming with Swift 3 compatibility. 
 `master` is now the Swift 3 branch.
 Make sure you're using an updated version of CocoaPods.
 The `3.5.0` tag only supports Swift 2.2/2.3. For Swift 3 use `master`. Both build just fine.
 I'm going to close this issue out. The `3.5.0` tag builds just fine with the Xcode 8 GM. If it's not building correctly for you, you don't have things set up correctly. The `3.5.0` podspec is now available in the public spec repo.

Cheers. üçª
  It looks like you're using Alamofire 3.x, so in that case you'll need to create a `.Custom` encoding case and build the http body on your own. We don't support JSON arrays directly in Alamofire since there's no standard around them. But you can easily use a `.Custom` parameter encoding to do it yourself.

Cheers. üçª
  We've just released Alamofire 3.5.0 which is fully Swift 2.3 compatible.

Cheers. üçª
  Thanks for putting this together @nickplee! I ended up merging a more cohesive set of updates from our own @jshier in 418b0fc1.

Thanks anyways! üçª
  This was resolved in 418b0fc1. Cheers. üçª
  Interesting...thanks for reporting @thebluepotato!

Any chance you could put together a unit test or post sample code here that code reproduce the ambiguity warning? I haven't seen this error yet and I'd like to be able to avoid it without having the specify the `Progress` type in the single parameter closure case. I'd much rather get this fixed now since we're looking to release a bunch of things today.
 Cool, thanks for reporting @thebluepotato...we'll certainly dig into it.
 Thank you for opening this issue and providing the failing test @thebluepotato! Much appreciated!

After much investigation, there was nothing we could do that would allow us to keep both variant APIs without having to specify the type on the `progress` closure parameter. Because of this, I decided to remove the `Int64` variants for both upload and download progress. These changes have been pushed in `master` in commit 7925a0a7.

Thanks again for all your help here! üçª
  Hi @MillerJiang538,

This type of question should be opened on [Stack Overflow](https://stackoverflow.com). We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This PR splits up validation between `Request` subclasses and adds `Data?` or `URL?` parameters to the `Validation` closure.
## Motivation

Previously, the Validation closure only exposed the optional request and response parameters making it difficult to customize validations in inline closures that were not custom extensions in the `Request` class. You didn‚Äôt have access to the actual response data. This was limiting in certain cases where you want to create a custom validation error that includes the error message buried in the server data. The only way you could do this previously was to write an extension on `Request`.

Another limitation was that the `Validation` closure did not expose the `destinationURL` for a `DownloadRequest` incase you needed to inspect the data in some special scenario.

One final reason to change up the design was that all `validate` methods could be chained on any `Request`. This doesn't make sense for `StreamRequest` types.
## Solution

Modifying the validation system to accomplish all the goals stated above meant rethinking the majority of the design and splitting it up between subclasses.
### Data Request

The `Validation` closure exposed on the `DataRequest` class is now as follows:

``` swift
extension DataRequest {
    public typealias Validation = (URLRequest?, HTTPURLResponse, Data?) -> ValidationResult
}
```

By exposing the `Data?` property directly in the closure, you no longer have to write an extension on `Request` to access it. Now you can do something like this:

``` swift
let urlString = "https://httpbin.org/get"

// When
Alamofire.request("https://httpbin.org/get", withMethod: .get)
    .validate { request, response, data in
        guard data != nil else { return .failure(ValidationError.missingData) }
        return .success
    }
    .response { response in
        debugPrint(response)
    }
```

> This will be helpful in those cases where you would like to create a custom error that includes the error message from the server that's buried in the `data`.
### Download Request

The `Validation` closure exposed on the `DownloadRequest` class is now as follows:

``` swift
extension DownloadRequest {
    public typealias Validation = (URLRequest?, HTTPURLResponse, URL?) -> ValidationResult
}
```

The `URL?` parameter allows you to access the response data downloaded from the server and stored in the `destinationURL`. This allows you to inspect the data inside the file if you've determined you need to in order to create a custom error.

``` swift
let fileURL = URL(fileURLWithPath: FileManager.documentsDirectory + "/test_response.json")

Alamofire.download(urlString, to: { _, _ in fileURL }, withMethod: .get)
    .validate { request, response, fileURL in
        guard let fileURL = fileURL else { return .failure(ValidationError.missingFile) }

        do {
            let _ = try Data(contentsOf: fileURL)
            return .success
        } catch {
            return .failure(ValidationError.fileReadFailed)
        }
    }
    .response { response in
        debugPrint(response)
    }
```
### DRY by Design

Since the default validation methods supported in AF are the same between data and download requests, I decided to DRY things up by pulling the validation logic out into a `fileprivate` set of extensions on `Request`. This is very similar to how the response serialization logic was DRY'd up as well.
## Session Manager

I also snuck in commit c46bc01f into this PR that updates the `SessionManager` to leverage the new `TaskConvertible` conformance to generate the `URLSessionTask` instances. This cleans up a bunch of duplicated logic that I should have caught in the earlier PRs. This commit doesn't change any functionality, just DRYs things up a bit.

---
## Summary

These changes allow inline validation closures to be much more powerful, eliminates chaining validation APIs on `StreamRequest` instances, and exposes the `destinationURL` directly to the inline closure. We'll want to update the Validation section of the README to include examples of best practices here.

> We need to make sure people understand they shouldn't parse the response data unless they know they're in a failure case where they want to dig the error message out.
 cc @jshier and @kcharwood for review.
 @cnoon Review complete. Great changes! Just some minor comments.
 Thanks for the review @jshier! All the comments have been addressed, I'm going to go ahead and move this one through.
  Thanks for the PR @dhanushram, but we won't be accepting this change for the same reasons we rejected it in #1056.

Thanks anyways. Cheers. üçª
 My apologies here @dhanushram...I completely misunderstood what you were doing. Too many late nights. I'm going to re-open and investigate further.
 This seems like what Argo had to deal with in properly detecting `Bool` from `JSONSerialization`. Their solution was to [drop down to CoreFoundation](https://github.com/thoughtbot/Argo/blob/841979f8b8341b7818a15e67662157c4580151f1/Argo/Extensions/NSNumber.swift) and use those APIs to properly detect that an `NSNumber` contained a `Bool`. I think that's the solution we need here. We can cast to a a `Bool` then check if it's an `NSNumber`. If it isn't we're good, it's a `Bool`. Otherwise check to see if the `NSNumber` contains a `Bool`.
 Thanks for putting this together @dhanushram...much appreciated! @jshier is certainly right and it required a more robust check. We had to do something similar in Elevate. I've implemented a `fileprivate` NSNumber extension in the `ParameterEncoding.swift` file and leveraged it in the `queryComponents` API. I've also added failing (now passing) unit tests. I pushed up the fix to `master` in 72958d0e.

Thanks again! üçª
  Thank you for the feature request @tobiasoleary!

While I understand where you're coming from, I don't think that's quite how we want to try to handle that case. If validation is failing, then validation is what should generate the error causing your response serializer to not be run b/c an error had already occurred. What this means is that if you encounter a validation error, you should extract the error message from the server data directly in the validation closure. This is not currently possible in Alamofire 3 unless you write an extension on `Request`.

In Alamofire 4, we've made it easier to parse errors out of the server data if necessary by adding the `data` or `temporaryURL` and `destinationURL` to the respective `DataRequest` or `DownloadRequest` validation closures. More details can be found in the [migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#response-validation). What this ultimately allows you to do is:

``` swift
Alamofire.request(urlString)
    .validate { request, response, data in
        guard let data = data else { return .failure(customError) }

        // 1) Validate the response to make sure everything looks good
        // 2) If validation fails, you can now parse the error message out of the
        //    data if necessary and add that to your custom error if you wish.

        return .success
    }
    .response { response in
        debugPrint(response)
    }
```

If you do share the exact same response serializer to parse out the error message as you use in the response handler, then you can just reuse the serializer in the validation failure case. In many cases though the payload for the failure will be different than the success so you'd need to use different parsing logic.

Hopefully that helps clarify things and get you pointed in the right direction.

Cheers. üçª
  Issue has been fixed in 72958d0e. Thank you for reporting @dhanushram!
  Fixes #1452 

This PR updates our `User-Agent` string generation to not only fix the issue reported but bring it more in line with [RFC7231](https://tools.ietf.org/html/rfc7231#section-5.5.3) in regards to where the various bits of information live. It now looks something like this: `iOS Example/1.0 (com.alamofire.iOS-Example; build:1; iOS 9.3.0) Alamofire/3.4.2`. This more closely matches the `User-Agent` strings returned by browsers and now includes the Alamofire version.
 Thanks for putting this together @jshier! I made some small modifications (formatting and doc clarification) and pushed commit 68ddac4d into `master` while keeping attribution. I'll also take care of cherry picking this into the `swift2.3` and `swift3` branches right now.
  This PR splits up the `Request` class into `DataRequest`, `DownloadRequest`, `UploadRequest` and `StreamRequest` subclasses.
## Motivation

There were several reasons why the `Request` class could greatly benefit from being split up. 
### Progress

The first reason is that the progress APIs were stomping on each other and were confusing the users. For example, the upload progress behavior was very ambiguous considering that the same `Progress` instance was used to report both upload progress and then download progress after the upload was complete.
### Session Manager Duplication

The `feature/adapter-and-retrier` PR added the `TaskConvertible` enumeration to the `Request` class. Unfortunately, there is a large amount of duplication between the `TaskConvertible` implementation and the `Downloadable`, `Uploadable` and `Streamable` enumerations inside the `SessionManager`. Not only is there duplication, but the `Downloadable`, `Uploadable` and `Streamable` enumerations don't really belong in the `SessionManager` anyways. They're really the pieces required to construct a concrete `Request`.

By splitting up the `Request` into subclasses, we could move the `Downloadable`, `Uploadable` and `Streamable` implementations into their respective subclass and eliminate the duplication with the `TaskConvertible` enumeration in the `Request` class.

In the previous PR where the `TaskConvertible` enumeration was added, the `Downloadable`, `Uploadable` and `Streamable` enumerations
### Response Serializers

Another awesome reason for splitting up the `Request` class is to associate response serializers with a particular request type. For example, right now you can chain a `responseData` closure onto a `Request` that is backed by a `URLSessionDownloadTask` or a `ULRSessionStreamTask`. However, if you do this, what's the behavior? It currently gets really weird in all these cases when you start to consider resume data. 

Also, how does one get the destination URL of a download? Great question, right now it is WAY more difficult than it should be. By splitting up the `Request`, we can extend only certain subclasses to support specific response serializers that are tailored to the underlying type of task. These changes will be coming in a future PR.
## Solution

So now that we have some background as to why these changes would be useful, let's dig into what had to change to make this work.
### TaskConvertible

By pulling the `Downloadable`, `Uploadable` and `Streamable` enumerations into their respective subclasses and adding a `Requestable` enumeration to the `DataRequest` subclass, I was able to get rid of the `TaskConvertible` enumeration and make it a protocol. The protocol now creates a `URLSessionTask` from a session, adapter and queue. This allows the subclassed enumerations to construct the tasks directly without having to do this in the `SessionManager`. This greatly simplifies the `SessionManager.retry` method.
### Progress

The progress APIs have been completely rebuilt from scratch. You can now monitor `downloadProgress` on data, download and upload requests. You can also monitor `uploadProgress` on an upload request. There are variants for both the `Progress` object and the broken out `Int64` values. Each variant can also call the progress closure on a specified queue.

Here's a quick example of how you can use the new APIs.

``` swift
Alamofire.upload(data, to: urlString, withMethod: .post)
    .uploadProgress { progress in
        // Called on main dispatch queue by default
        print("upload progress: \(progress.fractionCompleted)")
    }
    .uploadProgress(queue: DispatchQueue.utility) { bytesSent, totalBytesSent, totalBytesExpectedToSend in
        // Can customize the dispatch queue for background operations if needed
        print("Sent: \(bytesSent), Total Sent: \(totalBytesSent), Total Expected: \(totalBytesExpectedToSend)")
    }
    .downloadProgress { progress in
        // Called on main dispatch queue by default
        print("download progress: \(progress.fractionCompleted)")
    }
    .downloadProgress { bytesRead, totalBytesRead, totalBytesExpectedToRead in
        // Called on main dispatch queue by default
        print("Read: \(bytesRead), Total Read: \(totalBytesRead), Total Expected: \(totalBytesExpectedToRead)")
    }
    .response { response in
        debugPrint(response)
    }
```
#### Download Progress

The download progress is now being tracked in the `DataTaskDelegate`. This allows the data, download and upload requests to leverage it. I debated for a long time as to whether to call this `progress` or `downloadProgress`. I would rather error on the side of verbosity here I think. I ultimately decided upon `downloadProgress` because `progress` is REALLY ambiguous when it comes to an upload request.

> If anyone strongly disagrees here, please voice your concerns. I'm still on the fence on this one, but right now lean towards `downloadProgress` and `uploadProgress` APIs to completely avoid ambiguity.
#### Upload Progress

The upload progress is all managed by the `UploadTaskDelegate` and is only exposed publicly through the upload request subclass. The stream request cannot chain `downloadProgress` or `uploadProgress` APIs because it no longer inherits them.
### Top-Level Stream APIs

I added the top-level stream APIs to `Alamofire.swift` because they were missing. Just wanted to callout that this random change made its way into this PR as well.

---
## Summary

These changes vastly improve the `progress` APIs and open up the ability to greatly specialize the available chained methods for each subclass. This will help avoid confusion and will allow for better customization for each request type.
 cc @jshier and @kcharwood for review.
 @cnoon Review complete. Not much feedback here, looks great!
 All changes have been addressed @jshier. I'm going to merge this bad boy.
  Like @tobiasoleary said, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for the PR!

First, this is unnecessary, as CocoaPods as of `1.1.0.beta.1` (which you need to be using for Xcode 8 compatibility anyway) will set the `SWIFT_VERSION` of the generated `Pods` project to whatever the target project specifies. Second, it doesn't fix our current issue with publishing the `4.0.0-beta.2` spec, which you can read more about [here](https://github.com/CocoaPods/CocoaPods/issues/5796). To fix that issue requires a change on the CocoaPods side. Once we have a resolution to that issue we'll make the necessary changes, if any. Until then, using the CocoaPods beta works fine for consumers of the framework.

Cheers!
  Thank you for reporting @sureshven. This issue has been resolved in PR #1456 and commit 68ddac4d. It's also been cherry picked into the `swift2.3` and `swift3` branches and will be released very soon.

Cheers. üçª
  You need to use the CocoaPods `1.1.0` beta series.
  This PR adds a couple powerful protocols, `RequestAdapter` and `RequestRetrier`, that open up all sorts of possibilities including:
- Easing `Request` modifications for `Authorization` headers
- Retrying requests that encountered an error with a custom exponential backoff retry policy
- Completely thread-safe refresh systems for web services behind OAuth2 authentication

I'm sure there are all sorts of other cool things you could do with this, but these are the main things I had in mind when putting this together.
## RequestAdapter

The `RequestAdapter` protocol allows each `Request` made on a `SessionManager` to be inspected and adapted before being created. One very specific way to use an adapter is to append an `Authorization` header to requests behind a certain type of authentication.

``` swift
class AccessTokenAdapter: RequestAdapter {
    private let accessToken: String

    init(accessToken: String) {
        self.accessToken = accessToken
    }

    func adapt(_ urlRequest: URLRequest) -> URLRequest {
        var urlRequest = urlRequest

        if urlRequest.urlString.hasPrefix("https://httpbin.org") {
            urlRequest.setValue("Bearer " + accessToken, forHTTPHeaderField: "Authorization")
        }

        return urlRequest
    }
}

let sessionManager = SessionManager()
sessionManager.adapter = AccessTokenAdapter(accessToken: "1234")

sessionManager.request("https://httpbin.org/get", withMethod: .get)
```
## RequestRetrier

The `RequestRetrier` protocol allows a `Request` that encountered an `Error` while being executed to be retried. When using both the `RequestAdapter` and `RequestRetrier` protocols together, you can create credential refresh systems for OAuth1, OAuth2, Basic Auth and even exponential backoff retry policies. The possibilities are endless. Here's a short example of how you could implement a refresh flow for OAuth2 access tokens.

``` swift
class OAuth2Handler: RequestAdapter, RequestRetrier {
    private typealias RefreshCompletion = (_ succeeded: Bool, _ accessToken: String?, _ refreshToken: String?) -> Void

    private let sessionManager: SessionManager = {
        let configuration = URLSessionConfiguration.default
        configuration.httpAdditionalHeaders = SessionManager.defaultHTTPHeaders

        return SessionManager(configuration: configuration)
    }()

    private let lock = NSLock()

    private var clientID: String
    private var baseURLString: String
    private var accessToken: String
    private var refreshToken: String

    private var isRefreshing = false
    private var requestsToRetry: [RequestRetryCompletion] = []

    // MARK: - Initialization

    public init(clientID: String, baseURLString: String, accessToken: String, refreshToken: String) {
        self.clientID = clientID
        self.baseURLString = baseURLString
        self.accessToken = accessToken
        self.refreshToken = refreshToken
    }

    // MARK: - RequestAdapter

    public func adapt(_ urlRequest: URLRequest) -> URLRequest {
        if urlRequest.urlString.hasPrefix(baseURLString) {
            var mutableURLRequest = urlRequest
            mutableURLRequest.setValue("Bearer " + accessToken, forHTTPHeaderField: "Authorization")
            return mutableURLRequest
        }

        return urlRequest
    }

    // MARK: - RequestRetrier

    public func should(_ manager: SessionManager, retry request: Request, with error: Error, completion: RequestRetryCompletion) {
        lock.lock() ; defer { lock.unlock() }

        if let response = request.task.response as? HTTPURLResponse, response.statusCode == 401 {
            requestsToRetry.append(completion)

            if !isRefreshing {
                refreshTokens { [weak self] succeeded, accessToken, refreshToken in
                    guard let strongSelf = self else { return }

                    strongSelf.lock.lock() ; defer { strongSelf.lock.unlock() }

                    if let accessToken = accessToken, let refreshToken = refreshToken {
                        strongSelf.accessToken = accessToken
                        strongSelf.refreshToken = refreshToken
                    }

                    strongSelf.requestsToRetry.forEach { $0(succeeded, 0.0) }
                    strongSelf.requestsToRetry.removeAll()
                }
            }
        } else {
            completion(false, 0.0)
        }
    }

    // MARK: - Private - Refresh Tokens

    private func refreshTokens(completion: RefreshCompletion) {
        guard !isRefreshing else { return }

        isRefreshing = true

        let urlString = "\(baseURLString)/oauth2/token"

        let parameters: [String: Any] = [
            "access_token": accessToken,
            "refresh_token": refreshToken,
            "client_id": clientID,
            "grant_type": "refresh_token"
        ]

        sessionManager.request(urlString, withMethod: .post, parameters: parameters, encoding: .json).responseJSON { [weak self] response in
            guard let strongSelf = self else { return }

            if let json = response.result.value as? [String: String] {
                completion(true, json["access_token"], json["refresh_token"])
            } else {
                completion(false, nil, nil)
            }

            strongSelf.isRefreshing = false
        }
    }
}

let baseURLString = "https://some.domain-behind-oauth2.com"

let oauthHandler = OAuth2Handler(
    clientID: "12345678",
    baseURLString: baseURLString,
    accessToken: "abcd1234",
    refreshToken: "ef56789a"
)

let sessionManager = SessionManager()
sessionManager.adapter = oauthHandler
sessionManager.retrier = oauthHandler

let urlString = "\(baseURLString)/some/endpoint"

manager.request(urlString, withMethod: .get).validate().responseJSON { response in
    debugPrint(response)
}
```

---
## Tests

I've added tests around the `RequestAdapter` to make sure all the `SessionManager` APIs actually  call the `adapter` if set. I also added tests verifying the `retrier` is called when errors occur and that the `adapter` will be called again when the request is retried.
## Internal Modifications

There are several internal changes that are worth calling out to make this work.
### Validations

The first is that `Validation` is no longer run on the delegate's `OperationQueue`. In order to determine whether a `Request` encountered an error, we need to make sure we run all the validations first, otherwise the error won't be set and the `retrier` won't be called. This was a trivial change to implement, but is an important callout.
### TaskConvertible

The `TaskConvertible` enum nested in the `Request` class allows us to store the un-adapted version of the `Request` before it is adapted and turned into a `URLSessionTask`. The `retry` method on the `SessionManager` uses the new `originalTask` property to extract the original urlRequest, adapt it if necessary, then create the new task and apply it to the `Request`. By setting a new task on the `TaskDelegate`, it automatically resets all the data tracked in the `TaskDelegate` as though it is a brand new task.
### SessionDelegate

The `SessionManager` must be passed down to the `SessionDelegate` as a `weak` property in order to allow the `SessionManager` to retry the `Request` from the `SessionDelegate`. I originally had the retry logic in the `Request` class, but it became problematic when trying to figure out how to lock down the task creation on the `SessionManager` queue. While I don't love having to store the parent reference in the child, it's not so bad since it's not exposed publicly and it doesn't result in a retain cycle since it's a `weak` reference. 

> I'm very open to suggestions here on a better approach, but I think this is about the cleanest way to do it.
## README Updates

I've added a `Adapting and Retrying Requests` section to the README to walk users through some of the ways you could use these protocols. I also created a fairly detailed `OAuth2` example to demonstrate how to start to build a thread-safe refresh system that could be shared across multiple session managers.

---
## Summary

Overall I think these are two very powerful protocols that will open up all sorts of possibilities for the Alamofire community. I'd love to see custom `RequestRetrier` implementations for linear and exponential back-off policies for things like background sync operations. Can't wait to see what everyone comes up with!
 cc @jshier and @kcharwood. I'd love to get your guys thoughts here.
 @cnoon Initial review complete. We discussed some of the general issues I had but it looks great otherwise!
 Thanks for all the awesome comments here @jshier. Everything has been addressed at this point so I'm going to merge it in to keep the ball rollin'. üëçüèº
  Hi @tib,

You can speed up your builds using Carthage by specifying a single platform using the `--platform` flag.

``` bash
$ carthage build --platform iOS
```

Now as far as moving to a universal framework, this is not something we're going to do at this time. Until it's officially support by Apple, we'll continue to use our current approach. There are enough edge cases and complexities around testing that the pros do not outweigh the cons in our opinion. This is something that will continue to investigate and re-evaluate. But at this time we'll continue to to use the four target approach in AF and AFI.

Cheers. üçª
  Come on @datomnurdin...how about actually reading the information you just posted?

Please follow the three helpful bullet points that CocoaPods is already giving you. If you continue to have issues, please take you question to Stack Overflow or to the CocoaPods team.
  Hi @SIT3131,

First off, there's not a question here. Secondly, questions like these should be asked on [Stack Overflow](https://stackoverflow.com). We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @iAviatorJose,

This type of question is best suited for [Stack Overflow](https://stackoverflow.com) with an `alamofire` tag. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @iamjono Thanks for the report. It looks like they've fixed several issues they had with the switch from escaping to non-escaping as the default. We'll be sure to issue a new build when those changes make it into a shipping Xcode. Unfortunately we don't support building Alamofire against development toolchains. Cheers!
  Thanks @donnywals! üçª
  Hi @JustinJiaDev,

Thank you for the suggestions. The reasons why there's currently a mismatch is that we have not updated the documentation for the Swift 3 / Alamofire 4 release. We're still working on some fairly large changes to the library. Once the changes are in, we'll update the documentation and put together an Alamofire 4 migration guide before the release. Until then, you'll need to look at the actual logic in the repo and adjust the code samples accordingly.

Cheers. üçª
  Hi @ptaking,

You're looking for `.ReloadIgnoringLocalCacheData` and `. ReturnCacheDataDontLoad`. Please refer to the [documentation](https://developer.apple.com/reference/foundation/nsurlrequestcachepolicy?language=objc) for more info or this excellent NSHipster [article](http://nshipster.com/nsurlcache/).

In the future, I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com) for questions like this. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @RahulKatariya Alamofire 4 adopts Swift 3's new `Error` based error handling. What were once `NSError`s in the `NSURLErrorDomain` can now be cast to `URLError`, which has specific codes that cover what you want. I'd suggest that route rather than casting to an `NSError`.
  Thanks @trichner...you'll need to pass a `name` @pangpingfei even if it's just some made up name that the server ignores. It's part of the spec.

Best of luck! üçª
  @cosmo1234 I'm not sure why the printing is relevant here, but the debug output of a dictionary will differ from the representation sent as JSON, that's just how `print` works.

These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You are completely right. I'm working on fixing the issue now.
 I reverted d480f4d8 which is what introduced the issue, then applied the actual change to `SessionManager` in 62e82422 and released it as `4.0.0-beta.2`.

Thanks for reporting this right away!

Cheers. üçª
  @Noobish1, please see #1367 for more info on iOS 8 support. @leebros we won't be merging the `swift3` branch into `master` until the Xcode 8 GM is released.
  We've completely changed the APIs in the `swift3` branch. You'll need to adjust your app code accordingly. Nothing has been officially released, so our documentation is still out-of-date on the `swift3` branch. We're waiting to update it all until we finalize all the code changes.

Cheers. üçª
  Hi @Igor-Palaguta...thank you for the feedback. Your assessment here of the behavior is spot on. We've completely redesigned the download and upload progress system in Alamofire 4. You can take a look at the new updates in our [Migration Guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#download-and-upload-progress).

Cheers. üçª
  Thanks @MainasuK. üçª

We'll be cutting the beta.1 releases shortly once we get the `AFError` PR through. Until then, you can use @MainasuK's solution. You could also point to a specific commit hash on the `swift3` branch rather than the `swift3` branch itself in the Podfile to save yourself from a future breaking update.

Cheers. üçª
 @JaviSoto AFI hasn't been fully updated for `4.0.0-beta.2`, so you'll need to lock your Podfile to the last compatible commit.
  As mentioned in [our documentation](https://github.com/Alamofire/Alamofire#server-trust-policy-manager) you need to keep a reference to manager you've created around somehow. If you don't it will be deallocated once it leaves scope an you'll see your observed behavior.
  @yuweipei If you're having trouble with AlamofireImage, please open an issue on that repository. Thanks!
  So to all of you convinced "the data is gone"...it's not. 

## Response Struct

The data is ALWAYS passed back to you in EVERY response serialization closure as part of the `Response` object in AF 3. Take a look at the `Response` struct:

``` swift
/// Used to store all response data returned from a completed `Request`.
public struct Response<Value, Error: ErrorType> {
    /// The URL request sent to the server.
    public let request: NSURLRequest?

    /// The server's response to the URL request.
    public let response: NSHTTPURLResponse?

    /// The data returned by the server.
    public let data: NSData?

    /// The result of response serialization.
    public let result: Result<Value, Error>

    /// The timeline of the complete lifecycle of the `Request`.
    public let timeline: Timeline
}
```

Is the `data` property not clear? Did anyone think to check it? Notice the `[Data]: 83 bytes` that keep getting printed out when you use `debugPrint` @tylerlong and @gchaturvedi? Come on guys, help yourselves out a bit here...

## Validation

To your last point @tylerlong:

> It does contain some quite useless message like Response status code was unacceptable: 400 which is not the message from the server at all.

How is that "useless"? The error tells you "exactly" what went wrong with the request. You told Alamofire to validate the request, it did and told you why it failed.

## History Lesson

If you don't run validation on the response, you're saying that as long as the request didn't encounter an error, I consider the request a success and I'm going to handle the result in my response serializer. However, the validation APIs exist if you decide that you'd prefer to have Alamofire hand you an error in your response serializer if the response wasn't formatted the way you wanted. This has always been a choice up to the user.

Now at some point in the Alamofire releases, we realized that you always want to have access to the data that came back from the server in a success or failure case for the exact reasons you have all put in here. It can be useful! So as you can see, all the response serializers hand you back the server data directly regardless of what the result type is.

Hopefully that helps.

Cheers. üçª
 @tylerlong...see @tobiasoleary's comment. Also re-read mine again. You're not looking at the `data` property, you're looking at what's being printed out.
  Hi @srinadh588,

There's an example of posting JSON to a server in our README which can be found [here](https://github.com/Alamofire/Alamofire#post-request-with-json-encoded-parameters).

``` swift
let parameters = [
    "foo": [1,2,3],
    "bar": [
        "baz": "qux"
    ]
]

Alamofire.request(.POST, "https://httpbin.org/post", parameters: parameters, encoding: .JSON)
// HTTP body: {"foo": [1, 2, 3], "bar": {"baz": "qux"}}
```

In the future, I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com) for questions like this. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @mattnedrich,

This is not an issue with Alamofire. We have many people using Alamofire with CocoaPods without issue. I'd recommend opening a question on [Stack Overflow](https://stackoverflow.com) for questions like this. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  If you MUST have the `Request` returned from `hackSociety` (bonus points for Mr. Robot refs), then you could create the `MultipartFormData` on your own, encode it, then pass that off to the `upload(data:)` API instead. This would allow you return the `request` immediately rather than having it be an async operation.

Now let me stress here that unless you're dealing with super small payloads, you don't want to be doing this on the main thread. The multipart form data upload APIs are designed to be async because generally they need to be.

Cheers. üçª
  Hi @Shunzi007,

This type of question is best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @kemchenj. üçª

There are a bunch of changes in the `swift3` branch @Urkman. We're working on Alamofire there, so you'll need to dig into each compiler error with the assumption that the APIs may not be the same anymore.

Cheers. üçª
  Hi @filippovdev,

The only way the request will be made a second time is if you're either providing a credential through something like the `authenticate` method, or there's a credential being picked up from the `URLCredentialStorage`. If there's no credential, then the request will immediately fail and won't be retried.

If you absolutely want to disable this functionality, you can, but I'd advise you not to. How you would turn this off would be:

``` swift
let delegate = Alamofire.SessionManager.shared.delegate

delegate.taskDidReceiveChallengeWithCompletion = { session, task, challenge, completion in
    completion(.performDefaultHandling, nil)
}
```

Again, I wouldn't recommend you do this as this will disable other functionality in Alamofire such as the ability to do certificate or public key pinning.
  Methods are now lowercase: you need to use `.post`. 
  You need to use:

```
let parameters: [String: Any] = ["key": "value"]
```

Swift 3 in beta 6 now switches to using `Any` instead of `AnyObject` for most serialization APIs.
  This is intentionally the build number, though I guess the variable name is incorrect. The actual app version is built in the later lines, where we query `NSProcessInfo`.
 @antrix1989 Looking at it again, you're correct. However, both the app version and build number are useful bits of information, so they should likely both be in the user agent. Something like this:

``` swift
let userAgent: String = {
    if let info = NSBundle.mainBundle().infoDictionary {
        let executable = info[kCFBundleExecutableKey as String] as? String ?? "Unknown"
        let bundle = info[kCFBundleIdentifierKey as String] as? String ?? "Unknown"
        let version = info["CFBundleShortVersionString"] as? String ?? "Unknown"
        let build = info[kCFBundleVersionKey as String] as? String ?? "Unknown"

        let osNameVersion: String = {
            let version = NSProcessInfo.processInfo().operatingSystemVersion
            let versionString = "\(version.majorVersion).\(version.minorVersion).\(version.patchVersion)"

            let osName: String = {
                #if os(iOS)
                    return "iOS"
                #elseif os(watchOS)
                    return "watchOS"
                #elseif os(tvOS)
                    return "tvOS"
                #elseif os(OSX)
                    return "OS X"
                #elseif os(Linux)
                    return "Linux"
                #else
                    return "Unknown"
                #endif
            }()

            return "\(osName) \(versionString)"
        }()

        return "\(executable)/\(bundle) (\(version)/\(build); \(osNameVersion))"
    }

    return "Alamofire"
}()
```
 Thanks for the changes @antrix1989! We made some small modifications to your PR and pushed them into `master` in commit [`31b882`](https://github.com/Alamofire/Alamofire/commit/e84a9aae9d6c2b9db68268c51102ad3b0031b882) while maintaining your attribution. Thanks again!
  Hi @shahdhiren,

You absolutely can, but this type of question is best suited for [Stack Overflow](https://stackoverflow.com) with an `alamofire` tag. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  To use Xcode 8, please use the `swift3` branch. If you're using CocoaPods, you must be using version 1.1.0.beta.1.
  Hi @chaocharleswang,

These types of questions are best suited for Stack Overflow with an `alamofire` tag. We use our GitHub project to bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @martinkaplan,

The issue I think you're running into is that Alamofire cannot encode your `parameters` as valid JSON. Most likely something is wrong with your `parameters` dictionary. I don't see anything obvious in the sample code you posted. I also answered the Stack Overflow question you posted about the `NSDate` encoding.

What I'd recommend you do is try to encode that `parameters` object using `NSJSONSerialization` directory to figure out why the decoding is failing. Once you have that figured out, it should just start working in Alamofire.

In the future, I'd recommend opening a question on Stack Overflow for questions like this. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for putting this together @littleowl. We've completely the port to beta 6 in #1413. Additionally, we won't be modifying the deployment targets for the Alamofire 4.0.0 release.

Cheers. üçª
  If you're trying to validate that you received a `image/jpeg` content type and you actually received `html/text` content, wouldn't you expect the validation to fail?

It seems to me that you enabled content type validation for `image/jpeg`, but then realized it was failing so you wanted to suppress the error rather than figure out why the validation was actually failing.

You cannot comment out that line of logic. It is there for a very good reason. It's saying that if you didn't get any data back, then you shouldn't produce a content type validation error because the content type doesn't apply to the non-existent data.

I'm going to close this issue out as support for now. If you continue to have issues, then I'd suggest you take this question to Stack Overflow.

Cheers. üçª
  We've managed to get all the refactoring done and pushed up into the `swift3` branch in #1413. I'm going to go ahead and close this issue out. Please redirect any further questions or feedback to #1413.

Cheers. üçª
  Please see #1367 for a full description of the Alamofire 4.0.0 and 3.5.0 releases.
  You're likely running into an issue with ATS. Please check Apple's documentation for more details.

These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @thomstark This doesn't seem to be an Alamofire specific issue.

These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @patricks Using the `ParameterEncoding` `.Custom` should allow you to accomplish this. If that doesn't have the flexibility you require, writing your own method of request serialization isn't that hard, it just requires you to operate outside of the methods provided for you by Alamofire. Take a look at the different `ParameterEncoding` method and you should be able to create your own pretty easily and integrate it into your request creation. Our parameter encoding documentation starts [here](https://github.com/Alamofire/Alamofire#parameter-encoding).
  @mengheangrat Error 3840 is a JSON encoding error, which means there's something wrong with a response you expected as JSON.

However, these types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  We'll be merging the `swfit3` branch into `master` at some point in the future, but not until closer to the Xcode 8 release date.
  Updates the podspec to version 4.0.0 and sets the deployment targets to match the project‚Äôs new deployment targets.

Also fixes a build issue with the iOS Example app.
 Looks good to me @jshier. 
 You cannot use Alamofire 4 with a deployment target of iOS 8.0 @rs10693.
  @mltk96 If you're using Xcode 8, you'll need to update to CocoaPods 1.1.0 beta 1, following the instructions on their site. After that, make sure you're using either our `swift2.3` or `swift3` branch.
 Okay, what version of everything are you using and how are you integrating Alamofire into your project?
  Hi @JourneyWind,

We won't be merging into `master` until the Xcode 8 GM drops. At that time, we'll be releasing both the `swift2.3` branch as AF 3.5.0 and the `swift3` branch as AF 4.0.0. This is our current plan, but we're trying to squeeze in some pretty big changes for AF 4.0 that may cause us to delay slightly.

Cheers. üçª
  Gzip compression is automatically handled by iOS when downloading data from the server if you supply the `gzip` encoding in the [Accept-Encoding](https://github.com/Alamofire/Alamofire/blob/master/Source/Manager.swift#L50) header.

When uploading data, you will need to Gzip the data on your own if you need that functionality. We currently do not support Gzipping data for `MultipartFormData` uploads.

If you do end up building out a solution for this, I'm sure we'd consider adding such a feature to Alamofire directly. The one callout I have is that it will need to use Apple only frameworks if it is going to be part of Alamofire.

Cheers. üçª
  Indeed it would, but the `ParameterEncoding` type supports other encoding methods which wouldn't support `AnyObject` very well. If you need to create more custom encoding types, you'll need to use the `.Custom` case.

Cheers. üçª
  Hmmmm...that's odd. I wonder if we need to add the availability checks back in that I removed. We'll need to investigate more here @Urkman...thanks for reporting. üçª
 This has been fixed by #1401. Create a new issue if you have an further problems.
  Thanks for putting this together @jhudsonWA! It looks like we just missed this in the refactor.
  You'll need to pull from the `swift2.3` or `swift3` branches to compile in Xcode 8, as it only supports those two versions of Swift.
  @ZetrixWeb-iOS As you can see in [our documentation](https://github.com/Alamofire/Alamofire#http-headers), you can add headers to requests very easily. You can also add headers to every request in a `NSURLSession` by modify the `NSURLSessionConfiguration`, as show in our documentation [here](https://github.com/Alamofire/Alamofire#modifying-session-configuration). 
  Current `swift3` branch is up to date with beta 5.
  The `swift2.3` branch is up to date with beta 5.
  It's likely you're issue is the encoding of the data into a string in the source file in the first place. What I'd suggest is perhaps Base64 encoding your certificate, putting the resulting string in your source, and then decoding that into data for the trust policy. 
 @cnoon Perhaps this is a scenario we need to account for in the docs?
 This won't work @mendesbarreto. The `SecCertificateCreateWithData` API only supports `DER` encoded X.509 certificates. It says so right in the [docs](https://developer.apple.com/reference/security/1396073-seccertificatecreatewithdata?language=objc).

> Returns: The newly created certificate object. Call the CFRelease function to release this object when you are finished with it. Returns NULL if the data passed in the data parameter is not a valid DER-encoded X.509 certificate.

If you're going to use cert pinning, currently in Alamofire you'll have to embed the certs in the bundle. There's no other way to do it currently.

Cheers. üçª
  I suppose it all comes down to whether calling `suspend()` on task already in progress disconnects from the server. If it keeps the connection open, it makes sense that other tasks wouldn't start, as the connections are still at maximum. I'll do some investigation, but this is likely an underlying `NSURLSession` issue that Alamofire may not be able to do much about. If you're downloading large files, one option is to use `download` instead of `request` to start the process, when then makes it much easier to resume with partial data already on disk. That way you can just [`cancel(byProducingResumeData:)`](https://developer.apple.com/reference/foundation/nsurlsessiondownloadtask/1411634-cancel) and then resume later, rather than `suspend()`ing the task.

@cnoon Any ideas here? I'm not sure about the behavior of `NSURLSession` here.
 There's no code here to go off. You've speculated a bunch here @jshier on the what-ifs where we have no idea how @ahmad-atef is actually "cancelling" the request. We also don't know if these are download or data requests. Everything you've stated is spot on.

I'm going to close this issue out @ahmad-atef. If you end up getting us some more info, we could investigate further if needed.

Cheers. üçª
  @janhalousek We'll need more information to try and diagnose this. What versions of Alamofire, operating system, and Xcode are you using? 
 Looks to me like it's crashing when the download is complete and executing the `destination` closure to figure out where to move the file. Nothing else to go on here. Doubtful there's an actual issue here with Alamofire. Most likely there's something but implemented in the destination closure.

I'm going to close this issue out since there's nothing else we can do with the info we have.

Cheers. üçª
  @mrubin We've made this change for Alamofire 4, which can see if you use our `swift3` branch. Please give it a try and let us know what you think. If you have any issues with the new APIs as AF4 development progresses, please file another issue.
  The `NSHTTPURLResponse` is actually fairly straightforward, as it will be `nil` if, say, you created a `Request` that wasn't automatically `resume()`d and then `cancel()`d it. There was no response in that case. 

As for the `NSURLRequest`, if the request can't be `encode()`d before being sent to the underlying `NSURLSession`, then it will be `nil`, in which case the `NSURLSession` will return an error and the final `request` will be `nil`.

@cnoon Anything to add?
 The response is also going to be `nil` if you're offline. Then you'll just get a connection error and no response.

The URL request is generally only `nil` when creating stream tasks.
  These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You can use `pod 'Alamofire', git: "https://github.com/alamofire/Alamofire.git", branch: "swift2.3"`. 
  @kshysius As part of that error message, the URL you were attempting to upload should have been printed as well. Make sure that URL matches your expectations and that it actually starts with `file:`. That error message is produced by Alamofire when checking to make sure the URL provided is a file URL. However, the logic is provided by the underlying `NSURL` value, so it's highly unlikely there's an issue with that logic. Please investigate and let us know if the URL being passed in was actually a file URL.
 Thanks @jshier...I'm going to go ahead and close this issue out. If anyone ends up posting anything here that leads us to believe there's an issue with Alamofire, we'll gladly re-open and investigate further.

Cheers. üçª
  Thanks for this! Unfortunately I was nearly done with my own version of this update, so I'll have to decline yours. In the future, make sure to also commit the suggested project changes from Xcode and update the iOS Example target.

I ended up adopting your use of `Swift.Error` for generic parameters, but renamed the `Error` struct to `Errors`. Relatively minor, and will likely change with future refactoring but lets us minimize any confusion at the call sites. Also, rather than dropping or changing the expected result of the test I made the test call the function that was really being tested before.

Thanks again! üëç üöÄ 
  Hi @jrlanders,

These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @mojidabckuu A good question. It comes down to the fact that a multipart request can be very large and the encoding of this data can take more time than should be spent on the calling queue, so it's offloaded to a background queue. At the same time, Alamofire's `Request` type has no notion of an asynchronous `encoding` state, so there's now way for it to represent it's state before it's request is properly encoded. These two facts lead to the current implementation.

 In order to remedy this, Alamofire would either have to make all request encoding asynchronous, in which case `Request` would have to gain the notion of an encoding state and change it's behavior, or it would have to break different types of `Request` into their own subclasses, in which case only the type returned by the multipart encoding methods would know anything about an asynchronous state. 

We're considering changes along these lines for future updates. However, due to the breaking nature of such a change and all of the other changes that are already planned for Alamofire 4, it's unlikely to happen soon. However, if it's something you'd like to see, we'd consider a PR along these lines after Alamofire 4 is released.
  Hi @zkh90644,

This is something that you need to keep in your own logic. The `URLRequestConvertible` protocol clearly calls out in the documentation that your `NSURL` instances MUST conform to RFCs [1738](https://tools.ietf.org/html/rfc1738) and [1808](https://tools.ietf.org/html/rfc1808) to be used safely inside Alamofire. Since there are MANY different ways to safely escape your URLs, we leave this to the client implementations.

Cheers. üçª
  Hi @maxprig,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @duraiganesh0,

The problem is more likely that you're getting back a `500`. You're most likely getting back a default error message from the server that just happens to be HTML. You'll want to print out the `data` returned by the server as a string to see if that can help you figure out what you're doing wrong.

In the future, I'd recommend you open questions like this on Stack Overflow. We use GitHub for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @granoeste,

In approach 1, you need to create a custom `Manager` instance if you want to use custom HTTP headers. You can use approach 2 if you don't mind passing the headers in each `Request`.

In the future, I'd recommend you open this type of question on Stack Overflow. We use GitHub for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @arnaudlamy,

You need to convert the `NSData` returned by the server to a `String` most likely using `NSUTF8StringEncoding`. Then you can print it out. What you're seeing is how `NSData` objects are always printed out in the debugger, byte by byte in hexadecimal format.

``` swift
if let data = data, serverResponse = String(data: data, encoding: NSUTF8StringEncoding) {
    print("DATA: \(serverResponse)")
}
```

In the future, I'd encourage you to open this type of question on Stack Overflow. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @kumold,

You need to check the `error` that comes back in the `Response`. It will most likely be a cancellation or timeout error.

In the future, I'd recommend you use Stack Overflow for this type of question. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  The `swift3` branch now requires Xcode 8 beta 3+. We've made these changes on purpose. Please update to the beta 3 build and everything will work properly.

Cheers. üçª
  Thank you for all the reasoning you put together in this issue @tieleman. 

While we completely understand you point of view (believe me, we have discussed this at great length), we respectfully disagree with this approach. Apple recommends that developers always support the two latest operating systems. With a library as large and widely used as Alamofire, we need to make sure we are continually re-evaluating our tech debt and moving the needle forward while maintaining the best test suite possible. Because of this, Alamofire 4.x (Swift 3 only) will support iOS 9.0+, macOS 10.11+, tvOS 9.0+ and watchOS 2.0+. This allows us to continue to clean up our tech debt and run our test suite against all supported versions.

With that said, we're absolutely committed to still supporting iOS 8.x for some time. The Alamofire 3.x releases will fully support both Swift 2.2 AND 2.3 for the foreseeable future. The Alamofire 3.x versions will continue to receive bug fixes and security patches while the main focus of the team will be on Alamofire 4.x from here until the GM drops. When app developers are ready to embrace Swift 3, we feel that the majority of apps will be leaving behind support for iOS 8 deployment targets ([mixpanel](https://mixpanel.com/trends/#report/ios_9) currently reports iOS 9 adoption at over 92%). Now we realize that not everyone will do this, but we strongly believe that the majority of Alamofire users will. Even if you're one of the few, you do still have options.
1. You can continue to use Alamofire 3.x with Swift 2.3 until you're ready to drop iOS 8.x support. (this is our recommendation)
2. You could fork Alamofire 4.x and drop the deployment target until you're ready to move.

Alamofire is already segmented across three versions of Swift and 2-3 major versions of 4 different platforms spread over 3 different libraries. This is a tremendous amount of logic to support as well as keep the test suites up and running day-to-day while we try to iterate on Alamofire 4. With our small team, we need to draw the line eventually. There are always trade offs, and we've tried to make the best decisions for the community.

We're also working on publishing an Alamofire 4 evolution document with the proposals we'd like to see make it in over the next few weeks. Hopefully between the info provided in this response alongside the evolution doc, our team will have provided enough transparency and guidance to help the community move between Swift and Alamofire versions successfully and without difficulty.

Cheers. üçª
 The recommendation came from Apple in "I believe" WWDC 2014 in one of the bigger talks. I searched around [ASCIIWWDC](http://asciiwwdc.com), but I couldn't find what I was looking for. 

If I do end up tracking it down, I'll be sure to post the link here. If anyone else in the community was at the same talk I was and knows which one it was and could post the info here, it would be much appreciated.
 iOS 10 will be released one week from today. Additionally, anyone running iOS 8 can upgrade to iOS 9 for free, which they should be doing anyway, due to the rather severe security issues patched in 9.3.5. Finally, you can continue using Alamofire with the upcoming 3.5.0 release which will support iOS 8 - 10 by use of Swift 2.3.
 No, targets must be all 2.3 or all 3, due to ABI incompatibility. I think you may be able to run a Swift 2.3 app with a Swift 3 watch app but not within the same app.
 @vfn If you're going to maintain a fork with iOS 8 compatibility, you should also port over the various bug fixes and workarounds that were put in for bugs in for 8.1 and 8.2, as well as proper testing support for them as well.
 I'm going to lock this thread down. We've given many justifications as to why the deployment targets have been set to what they were in several different tickets. Please read through the justifications of all the tickets linked to this one if you're having issues.
  Looks like you've got a code signing issue. The occurrence of Alamofire in your error is merely because it's the first in the alphabetical list of dependencies which failed signing. There is a lot of help on this issue to be found elsewhere online, especially on StackOverflow. Good luck!
  Answered on Stack Overflow.
  Hi @vishnu-mee,

I'd check to make sure your `urlString` is valid and that the request is actually being sent. Then I'd set a breakpoint in your completion closure and also add some logging. If you still have trouble, I'd encourage you to open a question on Stack Overflow. That's really where this type of question should be asked. We use out GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @flypaper0 This isn't currently built into Alamofire or the underlying `NSURLSession` classes. What is your use case here? We would need a fairly convincing reason to add such a feature when `NSURLSession` doesn't already have it, especially when the use case would be so rare (most requests are never redirected). In the meantime, you can track this information yourself by providing the appropriate closure to your `Manager`'s `delegate`. `taskWillPerformHTTPRedirection` is called whenever a redirect is performed.
 Thanks @jshier.

I'm going to close this issue out @flypaper0. If you have additional questions, feel free to ask.

Cheers. üçª
  Thanks for letting us know @grosch! This issue has been resolved in 913f98a4 where we bumped the deployment targets eliminating the need for the check.

Cheers. üçª
  Hi @thaoth58,

It appears that `NSJSONSerialization` is failing to parse your response into JSON. That's why I would debug on your end. In the future, I'd encourage you to ask these types of questions on Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 There's no need to set an encoding value because you don't need to convert to a `String` before using `NSJSONSerialization`. The `NSURLSession` already hands you back a complete `NSData` object from the server which can then be handed directly to `NSJSONSerialization`. There's no need to transform the `NSData` into a `String` before `NSJSONSerialization` gets it.
  As you can see in the error message, you can't use `==` on parameters of `ParamterEncoding` and `ParamterEncoding?`, due to one being optional. Unwrap the optional and it should work fine.
 The `ParameterEncoding` enum does not conform to the `Equatable` protocol because it uses associated values. Creating `Equatable` conformance for a set of associated value cases is a slippery slope. Mainly because you need to decide whether or not to just compare the case, or the associated values inside the case.

With that said, you should be able to use a switch statement instead.

``` swift
let isEqual: Bool

switch (encoding, expectedEncoding) {
case (.JSON, .JSON):
    isEqual = true
default:
    isEqual = false
}
```

Cheers. üçª
 @RafaelPlantard Sorry about that. You can try what @cnoon suggested or something like this:

``` swift
let equalEncodings: Bool = {
    if case .JSON = encoding {
        return true
    }

    return false
}()
```

A bit more compact.
 @RafaelPlantard If all you want to do is ensure that your encodings are the correct type, optionally casting them should work. i.e. `if let encoding = someEncoding as? JSONEncoding`. Otherwise you'd have to implement `==` for all of the types specifically.
  Hi @dahuangfengda, without any sample code to go on here, we can't reproduce the leak you're seeing. I'm going to close this issue out for now since there's not enough information to investigate. If you end up posting a sample project that can reproduce the leak, we'll gladly re-open and investigate.

Cheers. üçª
  This is all handled internally by iOS. The `9037` value is never reported in the `NSURLSession` delegate callbacks. Alamofire doesn't modify any of these values, just simply reports them back in the progress closure.

> If you feel strongly about this behavior, I'd encourage you to file a radar.

Cheers. üçª
  I agree, this has long been an annoyance for me as well. I'll look into getting it done. I think it's something that can be done without making any breaking changes, since it's just a convenience for developers. However, I don't know how this will be impacted by [Swift Evolution proposal 111](https://github.com/apple/swift-evolution/blob/master/proposals/0111-remove-arg-label-type-significance.md) for Swift 3.
 Due to the changes in Swift 3, this isn't something you can actually do. However, we've modified all the `response` APIs in Alamofire 4 to only take a `response` object rather than the four listed above. That should make things easier.

Cheers. üçª
  You'll need to provide more information for us to help here, such as what the "make-table signal" is and how you expect to use it. What behavior are you expecting?
 Custom JSON parsing behavior is outside the scope of Alamofire. I'd encourage you to take your question to Stack Overflow. If you end up finding that there would be some benefit to extending Alamofire with some custom logic, then please feel free to open up a PR at some point and we'll certainly consider it.

Cheers. üçª
  Thanks for the work here @uny, but I was in the middle of this myself. Branch has been updated. Turns out the test failure is only on the iPhone 5 simulator for me, the other platforms expect the original version.
  @grosch We'll discuss what it would take to do this.
 No progress at all @grosch. We have however implemented a new `RequestAdapter` and `RequestRetrier` system to support auth flows like OAuth2. You can check it out in our Alamofire 4 [migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#new-features). But this will certainly not ship in Alamofire 4, if at all. We haven't had time to discuss it yet in detail.
 Hi @grosch,

I just looked through your implementation and I think it makes sense. As long as you're able to get the handshake to succeed, you should be good there. üëçüèº

Now as to whether or not we'll be adding direct support for x.509 certs in Alamofire, I'd say at this time we most likely won't add direct support for them. You're the only person that has requested support and it doesn't seem super common in the mobile world. If we end up having more people request support for client certs, we'll certainly reconsider. But for now, we'll leave client side cert authentication up to each client to implement in a manner similar to what you've posted above.

With that said, I've added a card to our Trello backlog to investigate this again in a future release. But if there isn't that much of an appetite from the community for this feature, I doubt we'll end up supporting it since it's a difficult feature to test.

Cheers. üçª
  Hmmm...good question @gordinmitya. 

The only way I know to clear out the `connection pool` you mentioned would be to `invalidateAndCancel` your current `Manager` (and underlying url session), then create a new `Manager`. Then should clear out the connection pool. 

Any chance you can give that a go?
 Awesome @gordinmitya! Glad we got to the bottom of it. üçª
  This isn't an Alamofire issue. I suggest you look at your build settings to find the difference between your Crashlytics builds and the build that is failing. Failing any obvious difference you'd be better off asking this question on StackOverflow, where more people can see it.
  There could be all sorts of issues as to why autocomplete wouldn't work correctly such as indexing is not complete, Xcode cache is corrupt, not installed correctly, machine needs to be rebooted, Alamofire hasn't been compiled in the project, etc.

With that said, it looks like autocomplete is working. Look at the 5th item down...`AlamofireVersionNumber`. That symbol comes from Alamofire. Instead, try some of the methods in our [README](https://github.com/Alamofire/Alamofire#usage).

Best of luck! üçª
  If you are using CocoaPods 1.0, `pod install` no longer updates the spec repo, so you may not see the latest version of pods. You can run `pod repo update` or just `pod update`. As was indicated in the message printed by CocoaPods.
 As the message from CocoaPods states, your pod repo is out of date. Run the command suggested to get the latest specs, in which Alamofire 3.4.1 should be found.
  Hi @ebbnormal,

It was definitely intentional to have `result.value` be optional. The `value` exists in a `.Success` case and not in a `.Failure` case. The property is merely for convenience. You certainly need to handle it being optional.

Cheers. üçª
  Hi @vishnu-mee,

Questions like these are best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @girishghoda,

You need to use the `error` to check whether or not the download was successful when using the `download` APIs. Here's an [example](https://github.com/Alamofire/Alamofire#downloading-a-file-wprogress) in our README.

The `data` parameter will only be non-nil when the download fails and resume data was generated. The reason for this because of the way download tasks work with an `NSURLSession`. If you are downloading small amounts of information and need to access the data directly in-memory, then you should probably look at using the `request` APIs instead.

Cheers. üçª
 You need to read the data from the `NSURL` you provided in the `destination` closure.
  Hi @renjithr,

These types of questions are best suited for Stack Overflow. We have hundreds of tests verifying everything in Alamofire is working correctly. I'd also recommend you add a bunch more detail if you would like someone to spend time helping you with your issue.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  According to [Apple's docs](https://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLSession_class/index.html#//apple_ref/occ/instp/NSURLSession/configuration), changes made to the configuration after session initialization don't affect the current session. To customize the underlying `NSURLSession` with a different configuration, [following the instructions in our documentation](https://github.com/Alamofire/Alamofire#modifying-session-configuration).
  Thanks, but there are already active `swift3` and `swift2.3` branches. 
 The branch certainly does compile with Xcode 8, as there is no other way to update to Swift 3. Have you updated to Xcode 8 beta 2? 
  Thanks, but our `swift2.3` has been updated.
  It could also be a bug with `httpbin.org` not responding to the basic auth request correctly. We'll have to do more testing.
 This is all URLSession here. Alamofire just hands the `URLCredential` off is there's an auth challenge that requests it. I'd file a radar if you would like to see it fixed. I'd also encourage you to try using the authorization header instead which will base64 encode the credentials before applying them to the `Authorization` header.

Cheers. üçª
  Issues of this sort are nearly always due to failing to keep a reference to your `Manager` alive. Usually you'll want a singleton value that lives outside of any view controller or other structure in the app. For more information, questions like this are a good idea for StackOverflow, where you can get implementation help. If you find a bug with Alamofire, feel free to open another issue with a code sample and we'll take a look.
  As you can see, Alamofire doesn't currently support this. We'll keep it in mind for the future though.
  This is a great suggestion. I personally haven't spent much time working with the SPM yet. Would anyone out in the community want to take a stab at this?
 I'm going to close this out for now until we have the bandwidth to properly support the SPM.
  Thanks for reporting this @fer662! I just pushed up b73893d0 which wraps the creation in a serial queue so the creation can't be done in parallel. This will be released as part of Alamofire 4.

Thanks again! üçª
  Changing the values of the configuration in a session that's already active has no effect. According to Apple's documentation on `NSURLSession`:
`Changing mutable values within the configuration object has no effect on the current session, but you can create a new session with the modified configuration object.`

I suggest you create your manager instance and customize its configuration, as [per our documentation](https://github.com/Alamofire/Alamofire#modifying-session-configuration).
 @jshier is absolutely correct here @giulio92. Your code will not end up doing anything. Instead, you need to do what @jshier suggested and either create a custom `Manager` instance, or set the values on each `NSURLRequest` you make, but then you won't be able to use the top-level APIs.

Cheers. üçª
  Alamofire already provides APIs that offer complete control over request and response serialization. What feature would the interceptor paradigm offer that isn't already achievable?
 Given the chainable nature of Alamofire's functionality, you can write those bits of functionality yourself and others can use that code. For instance, you could create a custom request method that adds the header but otherwise just exposes the normal API. A custom validator that contains the behavior you want to delete the token can be chained in as well. 

Given that, I thinks there's still some room for improvement. 
 @tobiasoleary is correct. The concept of the "interceptor" is essentially the combination of the `RequestAdapter` and `RequestRetrier` protocols added in #1450. There is a fairly detailed [example](https://github.com/Alamofire/Alamofire/tree/swift3#requestretrier) in the README right now that demonstrates how you could build an OAuth2 refresh system using it. This functionality will ship in AF 4.

I'm going to go ahead and close this issue out since those changes cover this request.

Happy refreshing! üçª
  Thanks for putting this together @passchaos...I couldn't agree more! I made some changes to your implementation and pushed it to `master` in bb55b866 while maintaining your attribution.

Thanks again! üçª
  Given that this is more of a web browser feature and Apple hasn't already done this automatically, we're going to have to be somewhat careful about implementing this outside of official `NSURL` support. 
 This is not something that we should support in Alamofire. You'll need to modify the URL before passing it into Alamofire so that it is a properly encoded, valid URL. These are the same requirements Apple has with the NSURL APIs.

``` swift
public protocol URLStringConvertible {
    /// A URL that conforms to RFC 2396.
    ///
    /// Methods accepting a `URLStringConvertible` type parameter parse it according to RFCs 1738 and 1808.
    ///
    /// See https://tools.ietf.org/html/rfc2396
    /// See https://tools.ietf.org/html/rfc1738
    /// See https://tools.ietf.org/html/rfc1808
    var urlString: String { get }
}
```

Cheers. üçª
  Hi @kshysius,

You'll need to encode the array (that's actually a dictionary by the way) into whatever data format you wish to add into the multipart form data object. I'd recommend using JSON if you don't know what to use. Your platform team should be able to tell you what they expect. Anyways, once you have it encoded into a data object, you can then use the `appendBodyPart(data:name:)` API.

Cheers. üçª
  I would suggest asking this question on StackOverflow, as this seems more like an `xcodebuild` issue than one with Alamofire, given the sheer number of apps using the framework that are successfully archived every day.
  Hi @gauravds, thank you for putting this PR together...much appreciated!

While I completely agree the whitespace should be cleaned up, I don't agree with some of the formatting changes in this PR. Because of this, I've added a `Cleanup Whitespace` aggregate target to Alamofire that will remove all the extra tabs and spaces at the end of any line. I added the target in 7789baaa and ran it in c5fe5da0. I'll be adding this new target to both AFI and AFNAI as well to keep things tidy moving forward.

Thanks again. üçª
  Questions like this are best suited to StackOverflow. If you create a question and tag it `alamofire`, the whole community can take a look for you. Generally, though, you can add headers by using the `request(_:headers:)` function. See [our documentation](https://github.com/Alamofire/Alamofire#http-headers).
  You probably need to delete `~/Library/Developer/Xcode/DerivedData` to clear out your old build products.
  It's straightforward to create your own `response` function that provides a queue. For example:

``` swift
func responseJSONOnQueue(completionHandler: (response: Response<AnyObject, NSError>) -> Void) -> Self {
    return response(queue: dispatch_get_global_queue(QOS_CLASS_DEFAULT, 0), responseSerializer: Request.JSONResponseSerializer(), completionHandler: completionHandler)
}
```

Of course you could provide your own queue.
  This is also different in iOS 10 as well.
 Thanks for putting this together @marius-serban! I wish I would have done it this way in the first place...would have saved us a bunch of headaches. Anyways, I've made a few small tweaks to this logic and pushed it into `master` in 32ecfd16 while keeping your attribution. I'm also going to make sure these changes get cherry picked into the `swift2.3` and `swift3` branches.

Thanks again @marius-serban! üçª
  # Alamofire - Swift 3.0

The initial migration to [Swift 3.0](https://swift.org/migration-guide/) has been completed, and can be found in the [`swift3`](https://github.com/Alamofire/Alamofire/tree/swift3) branch. Many thanks to the Apple Engineers in the labs at WWDC who assisted with some of the migration issues. :beers:

Please file Github issues for any problems discovered while using this branch.

This branch should be considered a work in progress, and will be updated as future Xcode 8 and Swift 3 seeds are released by Apple.

Official support for Swift 3.0 and Xcode 8 will be not available until the fall when Apple releases both.
## Migration Notes
- Many Foundation types are now value types, instead of reference types. Please audit your code to ensure all references to `NSMutableURLRequest` are now properly handled as `var` and are of type `URLRequest`.
- Due to the Swift 3.0 naming conventions, many Alamofire API parameters that referenced an object in the URL Foundation loading system and began with capital letters now begin with lowercase letters. For example, `URLRequest` parameter names are now `urlRequest` to prevent confusion.
  
  More notes will be added as issues are discovered.
## Radars

The following radars were filed as a result of this migration and are currently being tracked by the ASF team.
- **[26850776](rdar://26850776)**: `CharacterSet` crashes when attempting to remove an item from the set in Swift 3.0
- **[26849668](rdar://26849668)**: `NSURLProtocol` APIs still contain `NSMutableURLRequest` parameter types and do not support the Swift 3.0 value types
- **[26870455](rdar://26870455)**: `NSURLSession` with background configuration does not function on the iOS simulator inside of test targets
## TODO
- [x] Update Project Recommended Settings
- [x] Update Example
- [x] Travis CI Support
- [ ] Update Documentation/README
 Branch has been updated for beta 3.

@dipang90 You likely need to update your version of Xcode 8 to the latest beta. 
 Make sure you do a `pod update` to pull the latest code. Then, if your app has already been converted to Swift 3, you can skip any conversion prompt that comes up. You'll also want to be using the CocoaPods 1.1.0 beta that was released last week, as it knows how to more properly deal with generating Xcode 8 compatible projects.
 The Swift 2.3 branch will most likely be released as Alamofire 3.5.0 and will support iOS 8 - iOS 10 on both Swift 2.2 and Swift 2.3. Alamofire 4.0.0 will only support iOS 9+. Please see #1367 for a more in-depth explanation.
 #1401 has been landed and the `swift3` branch should be fully compatible with Xcode 8 beta 5. Please note, however, that the `swift3` branch has become our Alamofire 4 development branch, so you'll likely see some breaking changes as we develop towards the AF4 release.
 Not for iOS 9, but for 10.10, yes. Latest 2 OS version, as Apple recommends.
 Continue using Swift 2.3, as Alamofire 3 will continue supporting the current versions, just with no new features.
 Not yet, the changes in beta 6 are extensive and will require a bit of work to get right. I'll see if I can get the changes up tonight or tomorrow.
 The `swift3` branch has been updated for beta 6. Be aware there have some refactors, as `Any` is now favored over `AnyObject`.
 We haven‚Äôt updated AFNAI to beta 6 yet @jmbeneUF.
 @jmbeneUF AFNAI has been updated for beta 6. Make sure you integrate it using the `swift3` branch.
 Make sure you've updated your checkout of the `swift3` branch and are using beta 6.
 Ensure you are using the latest CocoaPods beta (1.1.0.beta.1) and clear your derived data.
 @Lawris you need to use beta 6 in order to build the `swift3` branch right now.
 Instead of doing that, which you shouldn't need to, ensure you're using the latest beta and do a `pod update` so that it regenerates your project integration. If that still doesn't work you can do `pod deintegrate` and then `pod update` to redo the integration.
 I'm going to go ahead and close this issue out. Thank you everyone for all your feedback and reporting and especially you @kcharwood üçª for kicking all this off in the first place! We're getting really close to having everything locked down and will be starting on all the documentation updates here shortly.

AF 4 is coming!!! üéâüéâüéâ
 @mychaelgo `Method` has been renamed to `HTTPMethod`, to disambiguate it from the type you're seeing.
  Thanks for putting this together @adrianbrink! I made some small tweaks to your commit message and pulled the change into `master` in a53cc42b while keeping your attribution.

Thanks again! üçª
  Hi @kumangdeal,

That's the standard HTTP 1.1 response format. Looks like you received an `1102` status code from your server (that's not a valid status code) and you did actually receive JSON at the end. Most likely you haven't setup the `Request` quite right. You could use [debugPrint(request)](https://github.com/Alamofire/Alamofire#debugprintable) to help figure out what's different between your Alamofire request and your POSTMAN one.

In the future, I'd encourage you to use Stack Overflow for these types of questions. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This PR fixes some of the issues identified by #1312. This is going to need a lot of #availability wrappers, but thought I'd put it up here in case any one was curious how the rest of their code was doing on Swift 2.3
# Code Changed

The following changes were made aligned with the issues in #1312:
1. Explicitly unwrap NSURL as needed. I don't like doing this, but not sure what else to do.
2. Moved to the Enum type.
3. Explicitly unwrap SecPolicy creations. It appears that arrays with nil objects will not bridge to AnyObject's, that CFType expects to be an array.
# Unknown's

I'm not sure what the proper fix is for Swift 2.3. Changing the project file will prevent this project from supporting 2.3 and 3.0 without a branch. I imagine a lot of people will be thinking about the best solution here, the easy quick fix was to change the project file.
# New Test Failures

There are a few new test failures that need further investigation.
1. Three redirection tests are failing
2. testThatUploadingMultipartFormDataOnBackgroundSessionWritesDataToFileToAvoidCrash fails
3. testThatBackgroundConfigurationHeadersAreSentWithRequest fails

Brian
 This is a great start @KingOfBrian...thanks for putting all this together! The `NSURL` changes are really rough. We'll need to spend some time getting familiar with the failure cases of the new optionality to understand if force unwrapping is really the correct solution.
 I had a coworker ask about the nullability at the labs. I'm not sure it's a complete or correct answer, but I thought I'd include it for reference.

```
File reference URLs persist while the file moves. 
Trying to do append or other operations on a file reference URL will return nil if the file has been deleted. 
The only times the NSURL methods can return nil: dealing with reference URLs, or sometimes with an empty path.
```

Honestly the persist while-moving doesn't make sense to be, but it appears a file reference URL has some magic which forced these changes.  Given that this is the case, it appears http/https URL objects don't have this concern. But the 'sometimes with an empty path' doesn't instill too much confidence.
 @brentleyjones I just pushed up a branch named `swift2.3` that uses the `#if swift` macros.

I think its important we do this for the AF 3.x branch so people can easily transition to swift 2.3 if they choose, with the same version of Alamofire.

Obviously, that won't be possible with Swift 3.0 given the huge diff.
 > There are a few new test failures that need further investigation.
> 
> testThatUploadingMultipartFormDataOnBackgroundSessionWritesDataToFileToAvoidCrash fails
> testThatBackgroundConfigurationHeadersAreSentWithRequest fails

@KingOfBrian  Both of these are in relation to a radar I filed. 

```
26870455: NSURLSession with background configuration does not function on the iOS simulator inside of test targets
```
 Thanks for everyone's amazing work throughout this issue...very much appreciated! üçª

We now have our `swift2.3` branch is tip-top shape, building against Swift 2.2 and 2.3. We also have our travis-ci tests running against both Xcode 7 and Xcode 8 properly. At this point, I'm going to go ahead and close this issue out. We'll open new issues if necessary when the next round of betas come out.

Thanks again everyone!
  Turns out there are a few nullability changes that are causing build failures with Swift 2.3.

1 - A number of `NSURL` functions return nullable `NSURL` instead of nonnull. 
2 - `SecTrustResultType` moved to an enum from a collection of global Ints.
3 - `SecTrustSetPolicies(trust, policies)` no longer compiles: `Argument type '[SecPolicy?]' does not conform to expected type 'AnyObject'`
 Branch has been updated for beta 2 compatibility.
 You can pull the CocoaPod from the `swift2.3` branch. 
 `swift2.3` branch has been updated for beta 3, but there are no real changes.
 @Lukaz32 Solution for what?
 Can you be a bit more specific? What errors are you seeing? The `swift2.3` branch should build fine.
 @Lukaz32 That's a known CocoaPods issue. You need to update to CocoaPods 1.1.0.beta.1 and/or Xcode 8 beta 3.
 Thanks everyone for all the great work and investigation throughout this issue. We know have our `swift2.3` branch in tip-top shape, compiling against both Swift 2.2 and 2.3 successfully. We also have our Travis-CI yaml file building against Xcode 7 and Xcode 8 properly in the same branch. We've pulled all the latest changes from `master` in and everything is looking good.

At this point I'm going to go ahead and close this issue out since everything has been resolved. We'll open new issues with the next round of betas if necessary.

Again, thanks everyone so much! üçª
 Yes, no more Swift 2.3 branch. The Alamofire 3.5.0 release supports Swift 2.3 and is what you should be using from now on @tal-sh.

Cheers. üçª
  Hi @rafsouzap,

Not to worry, you have a few options here. First off, let's understand why this is happening.

The `+` character is being percent escaped according to RFC 3986 - Section 3.4 which is well documented in the [escape](https://github.com/Alamofire/Alamofire/blob/master/Source/ParameterEncoding.swift#L205-L218) docstrings. This is the common convention that most services will follow. However, as we're all fairly aware, not all services follow all the standards. üòï

If your server won't accept the `%2B` percent escaped variant, then you can override it by placing that parameter in the URL and not passing it as a parameter. Something like this:

``` swift
let URLString = "https://api.github.com/search/issues?q=repo:repo+is:status+type:pr"
```

This would be your easiest approach. Another option would be to use a `.Custom` parameter encoding, but I think that would be overkill here in this case.
  Luckily Xcode 8 might be able to use Alamofire as-is under Swift 2.3. We will be uploading a `swift3` branch as soon as possible. I have to get the new stuff downloaded first. Plus, I'm not sure how big of a job it will be, considering they've changed how a lot of the Foundation stuff (`NSURLSession` APIs) are imported into Swift. Hopefully the auto migrator will work well.
 Please everyone be patient here. We'll certainly get a `swift3` branch up as soon as possible. Unfortunately this year it's not going to be as easy as it has in the past. We need to make sure we update everything correctly to avoid causing everyone more harm than good. 

> If you find any helpful tips when trying to work through this yourself, please post them here! The more help the better.
 Please see #1316!

üçª 
  Hi @CiniCraft,

You cannot use the `responseData` serializer with the `download` API. You instead need to use the `response` API and check the `error` parameter. Then you need to read the data our of the filePath that you moved the file to in the `Destination` closure. Here's a [link](https://github.com/Alamofire/Alamofire#downloading-a-file-wprogress) to the README that demonstrates how to do this.

Cheers. üçª
  Hi @CelpanDmitrii,

Thank you for putting together this pull request...much appreciated! 

In this case, you'll want to use a `.Custom` parameter encoding since we don't want to change the default behavior. Since there's no documented spec on how to encode collection types with URL encoding, Alamofire uses one of the most common approaches. Anything outside this approach MUST be handled with a `.Custom` encoding. This is documented in the ParameterEncoding [docstrings](https://github.com/Alamofire/Alamofire/blob/master/Source/ParameterEncoding.swift#L41-L47).

Thanks again. üçª
  Hi @girishghoda,

These types of questions are best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests. I'd also encourage you to provide more info when creating the Stack Overflow question, otherwise it is really difficult for people to help you out.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for reporting this @mrubin. We already have some tests put together around this use case, but not for MultipartFormData requests. I'll add one and see if I can get to the bottom of this.
 Okay @mrubin, I've added a test in 53e25d59 that verifies the `debugDescription` on a `Request` works correctly even for `MultipartFormData` requests. At this point I'm going to close this issue out. If you could provide a sample project (or better yet, a test) that can reproduce the behavior you are seeing, then I'll be happy to re-open and investigate further.

Cheers. üçª
  Hi @jsl303,

I'd encourage you to checkout our [README](https://github.com/Alamofire/Alamofire#usage). It contains all the details you need to chain methods together on a `Request`. In the future, I'd encourage you to ask this type of question on Stack Overflow. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @remirobert,

In this case, you'll want to drop down a level in the APIs and first construct the multipartFormData. Once you have it encoded, you can then figure out the length of the data, and use that for your header. After gathering all the data, then you can build the request using the `upload` API without multipartFormData.

``` swift
func uploadMultipartFormData() {
    let multipartFormData = MultipartFormData()
    multipartFormData.appendBodyPart(data: imageData, name: "picture")

    var encodedData: NSData?

    do {
        encodedData = try multipartFormData.encode()
    } catch {
        print(error)
    }

    guard let data = encodedData else { return }

    Alamofire.upload(.POST, URLString, headers: ["ContentSize": data.length], data: data)
}
```

Just FYI...I didn't test any of that code. It's purely to demonstrate how you could solve this problem. Hopefully that helps. 

Cheers. üçª
  Hi @kovallux,

Alamofire is going to handle the request the same way that `NSURLSession` does because Alamofire is built ontop of `NSURLSession`. When you say `dataTaskWithRequest` works, what do you mean by that? Could you provide a code sample? That data task will stay open until you actually cancel the request.

Here's an example of how you could use the `stream` api to stream the data directly to a closure that you control to process the image data as it is downloaded from the server.

``` swift
func testMJPGDataFormat() {
    let expectation = expectationWithDescription("Video image should succeed")
    var gatheredEnoughImageData = false
    let imageData: NSMutableData = NSMutableData()

    let request = Alamofire.request(.GET, "http://wmccpinetop.axiscam.net/mjpg/video.mjpg")
    request.validate(statusCode: 200..<400)
    request.stream { data in
        guard !gatheredEnoughImageData else { return }

        imageData.appendData(data)

        print("New data: \(data.length), total image data: \(imageData.length)")

        if imageData.length > 300_000 {
            gatheredEnoughImageData = true
            request.cancel()
            expectation.fulfill()
        }
    }

    waitForExpectationsWithTimeout(timeout, handler: nil)

    print("Final Image Data Length: \(imageData.length)")
}
```

Hopefully this helps give you some ideas on how this could work. I'm going to close this issue out for now. If you end up providing some more info that leads us to believe there's an issue with Alamofire, we'll happily re-open this issue and continue to investigate further.

Cheers. üçª
  Hi @vsching,

You'll want to read up on how the [URL Loading System](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html#//apple_ref/doc/uid/10000165-BCICJDHA) works from Apple. You're question requires quite a bit of background knowledge on how the default URL session configuration works vs. a background URL session configuration. I'd encourage you to open a question on Stack Overflow rather than our GitHub project. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @marxcheckito,

These types of questions are best suited for Stack Overflow. We use our GitHub project or bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 You can try the sample app I just created for a rdar @cescoferraro [here](https://github.com/Alamofire/Rdar-StringInterpolationMemoryLeak). That makes a request with Alamofire upon launch. You can see if you see the issue there...
 Thanks for reporting back @marxcheckito. üçª
  Hi @borek2,

I just created a test verifying that everything is working as expected.

``` swift
func testDeleteWith204ResponseStatusCode() {
    let expectation = expectationWithDescription("204 should succeed")

    Alamofire.request(.DELETE, "https://httpbin.org/status/204")
        .validate(statusCode: 200..<400)
        .responseJSON(options: .AllowFragments) { response in
            print(response.response)
            print(response)
            expectation.fulfill()
        }

    waitForExpectationsWithTimeout(timeout, handler: nil)

    print("Yay...204 works as expected with responseJSON serializer")
}
```

If this does not demonstrate your use case, then please provide a different example that replicates the behavior you're seeing. We have custom 204 handling in the [JSON serializer](https://github.com/Alamofire/Alamofire/blob/master/Source/ResponseSerialization.swift#L210) which should ensure you receive a `.Success` case when using the `responseJSON` serializer.

I'm going to close this issue out for now. If you provide more info that leads us to believe there may be an issue in Alamofire, we'll happily re-open and investigate further.

Cheers. üçª
  Not really sure what to tell you here. From what I can tell, you're linking very different things together. The dev forums post points to issues with using an `NSURLProtocol` where the AFN issues you linked are crashing due to the CFNetwork implementation of `NSURLCache` from what I can tell. I'm fairly certain the two issues are completely different.

If I were you, I'd follow the Eskimo's advice if you're using `NSURLProtocol`s in your code. I'd also encourage you to consider removing the `NSURLProtocol` implementation altogether. They are fairly clunky these days when integrated with `NSURLSession`. If you're not using `NSURLProtocol`, then you'll need to continue to investigate what's happening. There's nothing here that points to any issue in Alamofire itself, but rather the underlying Foundation and CFNetwork implementations.

I'm going to close this issue out for now. Feel free to continue to add more info to this issue. If we end up finding anything specific to Alamofire, we'll happily re-open and continue to investigate.

Cheers. üçª
 Thanks for the info @xozyain. I would be very surprised if this issue has anything to do with Alamofire. I'm much more inclined to say this is an issue with the core networking logic in Foundation and CoreFoundation. There's nothing obvious in any of the stack traces posted on the AFNetworking [#2866](https://github.com/AFNetworking/AFNetworking/issues/2866) that leads to anything specific to AFN. They're also quite different when you look through each one. For right now, there's just not enough info to go on. 

If anyone finds any repro case or has any idea on what scenario could lead to this type of crash, please post it here and we'll investigate further.

> Please try to avoid just pasting your low level networking stack traces here without any ideas on how they could be caused. It just creates noise. Instead, try to reproduce the issue. If you do post stack traces, please provide descriptions on exactly how you are using Alamofire to at least provide us some context.
  Please see #1289.
  Hi @mrubin,

Great questions. Let me try to clarify for you.

> If I have multiple .responseJSON() handlers installed on a given request, does each one deserialize the JSON from the underlying data?

Each one will deserialize the JSON from the `NSData`.

> Is there any mechanism by which I could pass the deserialized JSON AnyObject along to further responseJSON handlers?

There is nothing built directly into Alamofire at the moment to support this. You would need to build a custom response serializer. @jshier has built a good example of how this could look [here](https://gist.github.com/jshier/f08f08e05d994b5bdc7d). This is also the best way to handle any custom threading model you need to use. The underlying `response` method takes an optional `queue` parameter to allow you to continue running your custom response serializer on whatever `dispatch_queue_t` you want.

Instead of trying to think of how to pass objects between chained request methods, I would encourage you to think of how to split your response serializer into multiple steps like @jshier does in his example.
  Thanks @huy-le! üçª
  Fixes #1269. Updates the user agent‚Äôs OS version to use non-localized sources. It also includes the actual OS name in the string.
 Okay so I've spent some time making sure that we get this exactly right. Here's a few examples of what we get if we don't change anything.

**English**
- Process Info: `Version 9.3 (Build 13E230)`
- User Agent: `appname/bundle_id (1606122225; OS Version 9.3 (Build 13E230))`

**Japanese**
- Process Info: `„Éê„Éº„Ç∏„Éß„É≥ 9.3Ôºà„Éì„É´„Éâ 13E230Ôºâ`
- User Agent: `appname/bundle_id (1606122229; OS bajon 9.3(birudo 13E230))`

**Spanish**
- Process Info: `Versi√≥n 9.3 (Fase 13E230)`
- User Agent: `appname/bundle_id (1606122227; OS Version 9.3 (Fase 13E230))`

**Russian**
- Process Info: `–í–µ—Ä—Å–∏—è 9.3 (–í—ã–ø—É—Å–∫ 13E230)`
- User Agent: `appname/bundle_id (1606122226; OS Versia 9.3 (Vypusk 13E230))`

**Thai**
- Process Info: `‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 9.3 (‡∏ö‡∏¥‡∏•‡∏î‡πå 13E230)`
- User Agent: `appname/bundle_id (1606122228; OS wexrchan 9.3 (bi ld 13E230))`

Therefore, we definitely need to make this change! 

Now what's interesting is that we no longer need to run the `CFStringTransform`. It's not possible to have a non-latin character come through as the app name or the bundle id. I spent some time trying this out, and Apple replaces any non-latin characters in the app name or bundle id with nothing or a `-`. Therefore, we no longer need to run the `CFStringTransform` on this string to be safe. I'll update the PR based on this info.
 Removed the `CFStringTransform` logic in 3591bfac and then rebased.
 Hi @bgerstle,

One of the apps I work on is localized in 20 languages. All I did was drop some log messages into our `AppDelegate` printing out the `operatingSystemVersionString` values and ran it in the different languages posted above as an experiment. 

You can easily add additional localizations to a sample project by adding a new localization in your project's `Info` settings. Here's a [link](http://www.appcoda.com/localization-tutorial-ios8/) to get you started if you haven't done this before. Then you can switch between locales when launching by switching Scheme's runtime language which can be done by `Edit Scheme` -> `Run` -> `Options` -> `Application Language`.

Cheers. üçª
  As soon as your code leaves `callService()`, there is no longer any reference to your `alamoFireManager` variable and it is deallocated, cancelling any pending requests you have. You're also redundantly setting `alamoFireManager` to the `sharedInstance` and then to a newly allocated instance later on.

What the [documentation about custom `Manager`s](https://github.com/Alamofire/Alamofire#manager) doesn't state is that you need to keep the manager around somehow. I like to use a static property in a `struct`:

``` swift
struct APIManager {
    static let sharedManager: Manager = {
        let configuration = NSURLSessionConfiguration.defaultSessionConfiguration()
        configuration.timeoutIntervalForRequest = 10        
        return Manager(configuration: configuration)
    }()
}
```
  Wrong project @mQ92. You'll want to file this in the AFI project instead. Also, if you could spend some time properly formatting your question, that would be much appreciated. Also consider whether or not this question should be opened on AFI, or Stack Overflow. We only use GitHub for bug reports and feature requests.

Cheers. üçª
  Hmmm...not really sure on this one @eriktelepovsky. The [tech note](https://developer.apple.com/library/ios/qa/qa1788/_index.html) leads me to believe that the Alamofire project settings are setup correctly.

How did you add the Alamofire framework as a dependency to your app target? Maybe that's more to blame than the project configuration itself.
 Thanks everyone for reporting back here. Due to all the issues everyone is having (myself included with a different weird set of warnings), I'm going to assume this is an issue on Apple's end. I'm going to go ahead and close this issue out for now since it seems we're all pretty sure this isn't an Alamofire specific issue. 

Feel free to keep commenting on the thread. I'll happily re-open and investigate further if anyone finds any specific Alamofire project issue.

Thanks again for all the help everyone! üçª
 I had this on an app as well but it was accepted without issue.
  Thanks for putting this together @lferro9000!
  We will start an official Swift 3 branch once Apple officially releases the Swift 3 tools at WWDC.
  This sounds like an issue with Carthage, not Alamofire. I believe both of those commands should pick up Alamofire 2.0.2. From past experience, I'd say make sure to use the latest version of Carthage. Additionally, you may want to consider moving to Alamofire 3.4. The AF 2.x release is now getting fairly out-of-date given how fast the Swift language is moving.

Cheers.
  Hi @satyamub,

Hopefully #441 can get you started in the right direction. We also have pretty detailed documentation on how to do this in our [README](https://github.com/Alamofire/Alamofire#manually). In the future, these types of questions are best suited for Stack Overflow. We use GitHub for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @chashmeetsingh,

I'd suggest you continue to debug on your end what the actual issue is. If you end up finding a specific issue in Alamofire itself, please provide more info and I'll be happy to re-open and help investigate further. If you need additional help debugging your issue, then I'd suggest you open a question on Stack Overflow.

Cheers. üçª
  Hi @gmarm,

I like the example you put together. It certainly makes the simple cases easier to read and more consistent. I'm a bit on the fence as to whether this belongs in Alamofire itself, but in general, I certainly like the approach!

With that said, I would probably think about changing a couple of things if we were to bring it in. First off, I would create a `URLRequestConfiguration` struct to contain all the values instead of using a `typealias`. That would actually allow you to use default parameters in a bunch of your `Router` cases which would make it even more condensed! üòâ

I'd also encourage you to think about the same concept for download and upload tasks as well. Could the `URLRequestConfiguration` struct handle all the various types of tasks with optional parameters? Possibly.

What's your take @jshier, @AnthonyMDev, @kcharwood?
 It doesn't seem like much of a win to me. 

While it might be easier to work with in some scenarios, it leads to a huge amount of redundancy in others. What if the vast majority of my endpoints use the same HTTP method? It would be duplicated in every case rather than being the result of a single switch default. So it seems like it makes some of the complex cases easier to express, it also makes the simple cases require more boilerplate. The suggestion of a `URLRequestConfiguration` struct would help with that since it can have default values, but really that would only help if those default values happened to coincide with what was actually required.

Readability is also a hugely subjective trait. I find the typical `enum` router to be perfectly readable, as it's rare that I need to know every property of an endpoint at a glance. Rather, I'm usually looking to make sure a particular property of an endpoint is set correctly. And once those values are set, I never look at it again, so it's not code that I read every day.

However, I do think this is a place where Alamofire could be enhanced. Rather than something immediate, though, my thought was to wait until WWDC and see everything Apple is going to do with Swift 3 (most is already revealed, but their presentations can provide good ideas too) and then start working on Alamofire 4 to take advantage of the new features as soon as possible at the core of the framework. Seeing how protocols have advanced could give us a better idea of what we could do in the framework to make it easier for users to create routers, among other things. 

So while I think some users will find this a useful enhancement on top of `URLRequestConvertible`, I don't think it's something to be included in the framework right now.
  Hi @lalitkumarchoudhary,

You should store the `upload` reference as a property that you can call cancel on.

``` swift
class NetworkManager {
    private var uploadRequest: Request?

    func startUpload() {
        Alamofire.upload(
            .POST,
            "https://httpbin.org/post",
            multipartFormData: { multipartFormData in
                multipartFormData.appendBodyPart(fileURL: unicornImageURL, name: "unicorn")
                multipartFormData.appendBodyPart(fileURL: rainbowImageURL, name: "rainbow")
            },
            encodingCompletion: { encodingResult in
                switch encodingResult {
                case .Success(let upload, _, _):
                    uploadRequest = upload

                    upload.responseJSON { response in
                        debugPrint(response)
                        uploadRequest = nil
                    }
                case .Failure(let encodingError):
                    print(encodingError)
                }
            }
        )
    }

    func cancelUpload() {
        uploadRequest?.cancel()
        uploadRequest = nil
    }
}
```

Hopefully that helps. In the future, I'd encourage you to ask this type of question on Stack Overflow. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @gerdogdu,

You're going to have to be MUCH more specific for us to be able to help you out. You provide the `NSURL` in the `Destination` closure, then Alamofire uses the `NSFileManager` from there to move the file once it's finished downloading. If there is any possible mismatch between the filename you're specifying in the `Destination` closure and the final result, I don't see how that can be an issue in Alamofire.

I'm going to close this issue out for now. If you provide more info to go on, then I'll be happy to re-open and investigate further.

Cheers. üçª
  This is the intended behavior @romk1n. The `.URL` encoding will encode parameters in the URL for certain HTTP methods such as GET and DELETE, and in the HTTP body for other methods such as POST and PUT.

The `.URLEncodedInURL` case was created to support encoding query parameters in the URL for all HTTP method types. All of this functionality is called out in the [docs](https://github.com/Alamofire/Alamofire/blob/master/Source/ParameterEncoding.swift#L41-L50).

Cheers. üçª
  Hi @Dershowitz011,

In the future, I'd suggest you open this type of question on Stack Overflow. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for your PR @jlalvarez18. Unfortunately we won't be pulling this in. Please refer to #1273 for more info.

Cheers. üçª
  Hi @startupthekid,

Thanks for the suggestion. This issue has already been discussed at great length in #1167, #1072 and #764 among others. You can easily resolve the issue by namespacing with `Alamofire` in your method declaration.

Cheers. üçª
 Thanks for providing that info @nubbel. üçª

@startupthekid thanks for providing all your info. I will answer each of your questions in turn, but please respect the opinion of the ASF. We always try to do what's best for the community, not just those using Result and Alamofire together.

> 1) The answer you gave is incorrect.

Please cut us some slack. I was referring to the implementation that @nubbel posted. There have been various workarounds posted in the tickets that I linked.

> 2) There have been multiple issues opened about this.

There definitely have, and all the debate in all of them has been healthy, yet ultimately led to the same conclusion. The pros of adding a dependency don't outweighs the cons in our opinion. You're free to disagree, but in the end, it's a decision that the ASF needs to make together. And we have...unanimously...over and over.

> 3) Anittypical's result is objectively better

There is certainly extra functionality built into the antitypical implementation that we've already started working on building into Alamofire. More on this coming later in future PRs.

> 4) Dependencies are a good thing, not bad

This is where we disagree. IMO, dependencies can be good if your team controls them. If they don't, they can be a nightmare. For example, we try to maintain branches for cutting edge Apple releases right after they are announced. By adding a dependency, we limit ourselves to only be able to support anything our dependency already supports. We are also held up by any issues with the project settings or dependency management files of the dependency. As I stated before, if you completely control the dependency, it can be a good thing. If you don't, it can be a huge problem and limitation for your community of users. You mention ReactiveCocoa. If you look at the list of maintainers between ReactiveCocoa and Result, you'll see there's certainly overlap which is exactly what I'm referring to.

Thanks again for putting your thoughts out there. I really appreciate the time you took to craft your argument. Please understand that we're taking your suggestions very seriously. We've had multiple discussions about this particular feature over the past year as a team, and continue to come to the same conclusion.

Cheers. üçª
  Hmmm...not sure on this one @duanyicanyuan. We'll have to investigate. Does anyone in the community have experience using the Reachability APIs on a VPN?
 Hi everyone,

My apologies for not addressing this issue sooner. Thank you for your patience. We've been swamped with Alamofire 4. 

I've managed to get to the bottom of the problem here. The core issue is that you're including the `https://` as part of the host when it should actually be `www.apple.com` as documented in our [README](https://github.com/Alamofire/Alamofire#network-reachability).

I've also spent some time putting together a sample app to test the behavior on a VPN. I've tested it on various VPNs all over the world and it behaves perfectly on iOS 10 as long as you set the `host` correctly. I haven't tested on iOS 9 since I don't have an iOS 9 device at the moment. If someone could test this on iOS 9, I'd appreciate it.
- [Connectivity.zip](https://github.com/Alamofire/Alamofire/files/491459/Connectivity.zip)

Hopefully this helps resolve future issues.

Cheers. üçª
  Great question @onmyway133! We'll have to do some investigation here and get back to you.
 cc @jshier, @AnthonyMDev, @kcharwood 
 Probably not a good idea, as Apple's docs explicitly call out not using the value for parsing. Manually creating the version string from `operatingSystemVersion` seems like a better solution. 
 I agree @jshier. I'll work on putting together a fix.
 I'm going to close this issue out since @jshier has put together a fix in #1292. Please redirect all future comments to #1292.

Cheers. üçª
  You could `debugPrint(response)` in any of the response serializers or optional bind the response data like so:

``` swift
responseJSON { response in
    if let 
        data = response.data, 
        utf8String = String(data: data, encoding: NSUTF8StringEncoding) 
    {
        print(utf8String)
    }
}
```

In the future, I'd encourage you to use Stack Overflow for these types of questions. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Updated commit message and rebased in f4ccfeda while keeping attribution. Thanks for pushing this up! üçª
  Hi @Tom29,

Good question. Let me try to provide some details.

#### TimeoutIntervalForRequest

The max time interval to wait between server responses before cancelling the request. All session tasks use this value, but it is really designed for tasks running on a default or ephemeral session. Tasks running on a background session will automatically be retried.

> Unless you are using background sessions or download massive payloads, this is most likely the only property you need to worry about.

#### TimeoutIntervalForResource

The max time interval allowed for downloading a request payload. The default value is 7 days. While this can be used for default and ephemeral sessions to specify something like no request should take more than 5 minutes to complete, it's really intended for upload and download tasks running on a background session. Background URL sessions will automatically retry failed tasks behind the scenes until the `timeoutIntervalForResource` is reached. You won't receive a failure until this interval is reached for background sessions.

Hopefully that helps clarify things. 

Cheers. üçª
  If the default collection formatting does not meet your needs, you should instead use the `.Custom` parameter encoding type to create your own. We've opened up the APIs in `ParameterEncoding` to make it as easy as possible to roll your own solution.

Cheers. üçª
  Hi @laddiexu,

I'd suggest you open a question on Stack Overflow to get help you out with your deadlock situation. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @bclausdorff,

Thank you for taking the time to put this together. I'm going to go ahead and close this out since there's nothing we can do here. Please see my reasoning in #1122 for further details.

Cheers. üçª
  This PR opens up the static error methods that @0xced added in #1166.

> It also addresses #1240 and #1258.

While I completely get why @0xced was trying to lock down the ability to create errors with the Alamofire domain that don't use custom AF error codes, it's not really possible to guarantee this no matter how much we lock down the public APIs. Anyone could still create an `NSError` with the AF domain if they wanted, it would just be a bit more complicated to do so.

What types of errors a client should throw is their decision. IMO we should make it as easy for those clients to create errors as we can. It's their decision as to whether they should use the AF domain or their own. Either way, this isn't something that we can (or should) try to enforce. Because of this, I've opened up the new `error` APIs to allow clients to create errors by default under the AF domain, and easily customize with their own if they choose.
 cc @jshier, @AnthonyMDev, @kcharwood, @0xced for feedback
 I think it boils down to whether you think errors created inside custom response serializers should use the Alamofire errors or use their own. Seems like @0xced is definitely of the mindset that anything outside the Alamofire framework should always use a different domain and not use the AF error codes, even if the error code is applicable. I can definitely see and respect that POV.

> This is really the main question to answer. Once we make a decision here, then all the API decisions will be fairly easy to make.

I also get that it's not AF's job to provide convenience APIs for creating `NSError`s. I agree that it's not the job of AF to do this, but it is certainly convenient to allow this. Since we need to do this inside AF quite often, I don't see the harm in exposing this to the public as well. My main point is that we cannot stop people from doing this, so why not provide them the APIs to make error construction easier? 

I could see the argument that we should take out the default parameter value in the second API that takes an `Int` for the error code instead of an `Error.Code`. 

Thoughts???
 I agree that this functionality isn't something Alamofire needs to provide. It's okay to keep convenience functionality internal to the framework, as it reduces the responsibilities of the framework as well as the cost of changing internal functionality. Personally, I dislike using `NSError` at all, as it's not very Swifty, but it's the easiest way to produce error info unless we wanted to vend our own `ErrorType`. It's trivially easy for users to create their own error type and use it in custom serializers, as I demonstrate in [this gist](https://gist.github.com/jshier/f08f08e05d994b5bdc7d). 

So while developers could still creates errors in the Alamofire domain, we don't need to make it easy for them. Also, removing this public functionality will hopefully encourage developers to create their own error types, as I believe is best practice.
 Cool. Thanks for all the feedback here guys. I figured everyone would have a pretty strong opinion on this one. Let's keep the logic as is. I'll go ahead and decline this PR and most likely re-open the one where the README was updated with custom errors.

Cheers. üçª
  Your URL is invalid. It should probably be something like `"https://abc.com/api/v1/search"`. In the future, you should open a question on Stack Overflow instead of GitHub for this type of question. We use our GitHub project for bug reports and Feature Requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for putting this together @ajanauskas...much appreciated! üçª Instead of going this route, we've decided to open up the internal APIs in #1261. I've also updated the documentation to reflect the change. Thanks again.
 Reopening due to #1261 being closed.
 Another approach we could take is to recommend projects use their own error types. Whether that takes the form of something that can be turned into an `NSError` or not is another choice to make, but I think changing the example code to reflect this fact more clearly (i.e without referencing `Error.Code`) would be a good idea.
 I'm with ya @jshier. Would you be able to put something along those lines together?
 I'll try to put something together this afternoon. 
 @cnoon I've created #1273 with a first draft of recommended error usage. This moves away from using `NSError` at all, except from underlying code.
 I'm going to go ahead and close this out @ajanauskas...thanks again for putting this together. Please direct all further comments to #1273.

Cheers. üçª
  I think this is a great improvement @raphaeloliveira...thanks for putting this together! I rebased your change and pushed in master as dae3ed1b while keeping your attribution.

Cheers. üçª
  Sorry but Alamofire 3.3+ requires Xcode 7.3. If you're stuck on Xcode 7.2, use version 3.2.1.
  Let's hold off until we see what's announced at WWDC and what comes with the initial Xcode beta. We certainly want to support this, but it's quite a bit of work to maintain a separate branch for months on end. Once we see what's announced, we'll get a plan together for how we plan to support Swift 3 until the official release.

Cheers. üçª
  `NSCocoaErrorDomain` with code `3840` is a JSON parsing error from `NSJSONSerialization`. So while your backend returned a `200` response code, it did not return valid JSON. 
  Closing as duplicate of #1254.
  Hi @grizzly,

I'm not really sure what is going wrong with your logic, but there were no changes in this area that should have caused a regression. I just put together the following test to verify everything is working as expected:

``` swift
func testResponseJSON() {
    // Given
    let URLString = "https://httpbin.org/get"
    let expectation = expectationWithDescription("GET request should succeed: \(URLString)")
    var response: Response<AnyObject, NSError>?

    // When
    Alamofire.request(.GET, URLString, parameters: ["foo": "bar"])
        .responseJSON { closureResponse in
            response = closureResponse

            switch closureResponse.result {
            case .Success:
                print("SUCCESS")
            case .Failure:
                print("FAILURE")
            }

            expectation.fulfill()
        }

    waitForExpectationsWithTimeout(timeout, handler: nil)

    // Then
    debugPrint(response)
}
```

My guess is that there's something going wrong with your logic causing the success case to not be called. If you continue to have issues, I'd encourage you to open a question on Stack Overflow.

Cheers. üçª
  The singleton `Manager` instance uses the shared cookie store and automatically sends cookies with each response. However, in your case since you're switching domains, you most likely need to send the cookie through a `Cookie` header.

In the future, questions like these should be opened on Stack Overflow. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Version 3.2.1 works with Xcode 7.2.1.

I suggest installing that pod using this syntax `pod 'Alamofire', '~> 3.2.1'`.
 Do what it says. Though I would suggest running `pod update Alamofire` to make sure you pull everything correctly.
  Hi @jamaalalleyne,

It is not valid to try to encode an `NSDate` using `NSJSONSerialization`. Instead of adding support like this into Alamofire, you should instead encode the date into a string, then pass that string into the parameters argument.

Cheers. üçª
 No, you need to convert the `NSDate` into a `String` using whatever format you need to send to your server, then pass that `String` into Alamofire to encode it into JSON.
  These [tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/URLProtocolTests.swift) demonstrate how you could use an `NSURLProtocol` with Alamofire if you wanted @Yannmm.

Best of luck! üçª
  Nothing in this issue has anything to do with Alamofire. I'm going to close this out for now. If you end up posting more info that leads us to believe there could be an issue with Alamofire, we'll happily re-open and investigate.

Cheers. üçª
  Hi @smoi,

These types of questions are best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  If you update to the latest version of CocoaPods, you'll no longer see this issue. The latest version of CocoaPods builds Alamofire with the deployment target specified in the podspec. 

Cheers. üçª
  There is definitely an opportunity here for some more robust handling @saiimons. Let's rope in some of the other team members for some ideas.
 cc @jshier, @AnthonyMDev, @kcharwood 
 What's really interesting is that you can almost do everything you need in the `destination` closure itself. You could clean up the file system directly in the `destination` closure, then if the `move` operation fails, the error is already captured and reported in the `response`.

However, you cannot set your own error if something in the `destination` closure fails. There are a few ways we could do this (none of which I love):
1. Open up the `error` property on the task delegate. I don't think this is necessary, but is always an option.
2. Rethink the `Destination` closure signature to possibly handle this case better. This would not be a backwards compatible change and would have to be done as part of AF 4.
3. Extend `Request` to have an alternative to the `Destination` closure that was more robust. We could introduce this in a backwards compatible way, but it would be clunky. You'd still have to set the `Destination` closure in the `download` API, then chain on the override or something like that.

Thoughts? Other options?
 Right now I lean towards modifying the `destination` closure to throw an error in AF4, but the problem I see with that approach is that it would need to be an `NSError` which we can't enforce with the compiler. 

We could allow an `ErrorType` to be thrown and catch it and convert it to some type of generic destination closure error, but that seems pretty clunky to me.

Thoughts @jshier and @kcharwood?
 We've redesigned the entire destination system in Alamofire 4 @saiimons to account for this use case and many more. For more details, check out the [migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#download-file-destinations).

Cheers. üçª
  Hi @grosch, sorry for not getting back to you sooner. I've just opened up #1261 to attempt to resolve this issue. If you could check that out, I'd appreciate it. I'm going to go ahead and close this issue out for now. Please direct all further comments to #1261.

Cheers. üçª
  Make sure you manager isn't being deallocated before the request has a chance to finish.
  You could be getting a cached response back.

These types of questions are best suited for Stack Overflow. We use out GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You can set it on the [NSURLRequest](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLRequest_Class/#//apple_ref/occ/instp/NSURLRequest/timeoutInterval) or on the [NSURLSessionConfiguration](https://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLSessionConfiguration_class/#//apple_ref/occ/instp/NSURLSessionConfiguration/timeoutIntervalForRequest) when it is created.

In the future, you should open this type of question on Stack Overflow instead of on our GitHub project. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  They were deprecated in #1166 to stop encouraging users to create their own errors with the Alamofire domain. The code the @rafalkitta posted will work, but we'd encourage you to use your own custom domain to have a clear separation between the custom errors you're creating and the ones that Alamofire creates.

The solution to fix the warnings is to stop using the `errorWithCode(_:failureReason:)` API and instead create your own `NSError` objects directly.

Cheers. üçª
 @DavidGagne I'd actually recommend that developers create their own `ErrorType` not based on `NSError`, since `NSError`'s `domain` and `code` and rather useless. Instead, an enum, as described in that article, would work well, with each case capturing whatever state it needs to to be able to present errors to the user. But the article does outline an approach that makes this change less painful.
  We're not officially supporting SPM until it has been officially released. If you find a direct issue with our Package file, please submit a PR to help us fix things up!

Cheers. üçª
  Hi @scobbe,

#### Question 1

The reason that `download` works with `NSURL`s instead of `NSData` objects is that `download` is generally used for larger files. If you had to load the large file's data into memory every time to use it, you would certainly run your app out-of-memory. This is why the `download` APIs exist. To allow you to download large amounts of data and stream them to a file rather than have to collect them in memory. This is really the only difference between `request` and `download`. The `request` API does it all in-memory where the `download` API will stream the data to disk.

#### Question 2

This is a great question, and I don't actually have an answer. I've never tried to do it before. It's downloading to the `tmp` directory which is cleaned up by Apple automatically from time-to-time. Therefore, I've never worried about the abandoned files since they'd generally be very small. However, if this works for you, then I'd say roll with it!

Cheers. üçª
  Thanks!
  Hi @sosng,

Thanks for putting this issue together along with the sample project. I'm able to reproduce the leaks you're referring to. They have to do with leaks in string interpolation for building the `debugDescription` strings. I should have a fix in for this over the next few days.

Thanks again for reporting! üçª
 I've opened up PR #1262 to address this issue. Please direct all future comments to #1262.
  You can run up to 4 downloads in parallel on a single session on iOS @zsybupt. Additionally, you can create other sessions by creating your own `Manager` instance. More info in the [README](https://github.com/Alamofire/Alamofire#manager).
  Hi @totomo,

Thank you for submitting this PR...much appreciated! Unfortunately, we cannot accept this PR at this time b/c it's not backwards compatible. I have however added a task to our Trello backlog for Alamofire 4.0 to reinvestigate whether we would like to go this route.

Thanks again! üçª
  Hi @haoxins,

Thanks for submitting this pull request...much appreciated! I completely agree with you, that was not a good header to use as an example. Rather than remove the second header altogether as you have in this PR, I decided to change it to `Accept: application/json` instead in 20bc682d. Thanks again!

Cheers. üçª
  Your concerns here are perfectly valid @racer1988. The problem is that Apple isn't clear on whether apps supporting iOS 8 are going to be held to these same rules. If you check out #1086, you'll see that the reachability APIs don't work correctly on iOS 8 with IPv6. Therefore, I rolled back to the IPv4 APIs for iOS 8. I can certainly undo that change, but that will break reachability for anyone running on iOS 8.

An alternative approach would be to only make the `NetworkReachabilityManager` available to iOS 9 and above, but I'd rather not do that.

I'm going to leave this issue open for now. Maybe the community can help us decide on what the best solution is here.
 cc @kcharwood, @jshier, @kylef, @AnthonyMDev.
 That's exactly what we do now @racer1988 in the [NetworkReachabilityManager](https://github.com/Alamofire/Alamofire/blob/master/Source/NetworkReachabilityManager.swift#L123-L145).
 Unfortunately, it's just a running theory right now @AnthonyMDev...we don't have a definitive answer yet. I tend to agree with @dgatwood, but I'd much rather be certain.
 Pretty sure you posted on the wrong project @cezheng.
 Ah, I misunderstood your original post @cezheng. I didn't realize you were posting a code sample from the Reachability project.
 Thanks for posting all the documentation info @cezheng. That sample code was actually updated by Apple right after this ticket was opened. We need to re-evaluate our implementation based on the new sample code and description provided by Apple. Seems like there are a few opportunities for us to improve our logic.
 I've just opened #1308 which should bring Alamofire inline with Apple's recommendations when it comes to Reachability. I'm going to close this issue out. Please direct all future comments to #1308. Thanks for everyone's help getting to the bottom of this. We really appreciate everyone helping out here!

Cheers. üçª
 My guess is that this has something to do with the Facebook calls. Alamofire 3.4.1 should be fully IPv6 compliant. We have multiple apps in the AppStore right now built with that exact version.
 I reviewed this code with the Eskimo at WWDC and he said it was also good. He also explained that there are all kinds of nuances with connecting to IPV6 networks that could cause a failure.

He said testing the with fake IPV6 network on your mac is NOT a good test. You need to be on a true IPV6 network. I've seen a client where we got rejected for IPV6 and could not repro the problem, but on the WWDC true IPV6 network it was easily reproducible. We tracked it down to it being a problem with one of our API servers that didn't play nice with a direct IPV6 connection. It had nothing to do with our code. 
 How can I remove the reachability check?
I am getting my app rejected by Apple cause of this issue.
 @hellmund Yes you should definitely not be using reachability has a pre-flight check.

It may be best to open up a dev forum discussion and get Quinn involved. I chatted with him about this at WWDC, and there is just a lot of confusion here.
 @hellmund You should also confirm that your backend is accessible through a pure IPv6 network, as we see that a lot, as many backends still require an IPv6to4 bridge for connectivity. Otherwise, recommended best practice is to allow requests to fail and then check reachability to determine your next steps.
  This can certainly happen. The `NSURLSession` APIs are all asynchronous in nature. Calling `cancel` does not ensure the request is actually cancelled before it is able to complete.

Cheers. üçª
  Thanks for this @broccolii. I modified the commit message and pushed into `master` in d3211ea9 while maintaining your attribution.

Thanks again! üçª
  We're certainly very interested in this possibility! Once we get closer to seeing exactly how the linux Foundation is implemented, we'll start investigating how we'll need to modify Alamofire to support it.

Cheers. üçª
 Yes, all Linux discussion is now in #1935.  This is an Xcode issue. Clear your DerivedData and try again. If you have further issues, check StackOverflow for more recommendations. 
  This has been suggested several other times @LuoLee and is not something that we want to modify due to all the other potential issues this could introduce. Please see #755, #1073, #1076, #1098 for more info.
  That would be 3.2.1. Staying up to date is always recommended.
  I'm not entirely sure what issue you're running into, but the destination closure is definitely being called. You can easily reproduce the behavior by adding the following test to a test target that has Alamofire imported.

``` swift
func testDownloadExample() {
    let expectation = expectationWithDescription("destination closure should be called")

    Alamofire.download(.GET, "https://httpbin.org/stream/100") { temporaryURL, response in
        let fileManager = NSFileManager.defaultManager()
        let directoryURL = fileManager.URLsForDirectory(.DocumentDirectory, inDomains: .UserDomainMask)[0]
        let pathComponent = response.suggestedFilename

        expectation.fulfill()

        return directoryURL.URLByAppendingPathComponent(pathComponent!)
    }

    waitForExpectationsWithTimeout(20.0, handler: nil)

    print("Made it!")
}
```

I just verified the `destination` closure is called as expected.
  Thanks @gemmakbarlow! I rebased and tweaked the commit message and pushed in `master` in 743c9fb8 while keeping your attribution. Thanks again!

Cheers. üçª
  Hi @raginggoat,

These types of questions are best suited for Stack Overflow instead of GitHub. We use our GitHub project for bug reports and feature requests. If you tag `alamofire` on your question, I'm sure the community will be able to help you out.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I'm sorry, but you should seek support through the framework provider. Unless you can narrow some issue down to being an Alamofire bug, there's not much we can do here. If you can't get support there, StackOverflow may be a good place to ask a question about it.

As for the design overall, I don't know what your requirements are, one request at a time is generally a bad idea unless you have some very specific API requirements to that end. 

If you want, post your overall requirements and I can tell you what I'd recommend as far as methods and frameworks, but otherwise there's nothing for Alamofire to do here.
  Removing the header is not a good solution to this problem. If you want `curl` to decompress the response, just pass the `--compressed` flag into the `curl` command and it will decode the `gzip` for you. Unfortunately there is no general solution here, as the mere presence of the `Accept-Encoding` header says nothing about what the server's response will actually be.  
  Hi @janglesdev,

Apologies for the confusion. Thanks for the description. I agree with the majority of your assessment (with the exception of Alamofire being useless without `validate`). Therefore, I moved the `Validation` section above the `Response Serialization` section in the README in b54f0185. I also added a `.validate()` call to all code samples in the `Response Serialization` section. Hopefully that will help someone avoid the same frustrations in the future.

Cheers. üçª
  You need to use Xcode 7.3 to compile the latest version. Cheers. üçª
  Hi @CodeEagle,

These types of questions are best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Given the amount of variability between `bash` and `tcsh` quote escaping (amazing how painful this is), there's no one solution that solves this problem correctly. I just spent 2 hours trying to work out a solution to no avail.

While your suggestions do stop throwing errors in `tcsh`, the JSON is not able to be parsed correctly server-side. Coupled with the fact that `bash` is the default shell on OS X, we're going to leave the implementation as is. If you MUST use a `tcsh` shell when debugging, you'll need to modify the cURL output directly before using in your shell.

With that said, I realized there was actually an issue with `bash` output as well where the JSON contained single or double quotes. I've pushed up f443cd8a to `master` to resolve the issue.

Sorry this can't work for both shells. We're certainly open to supporting both, but I don't see how it's possible. If you're willing to spend a bunch of time here trying to figure out a better alternative, by all means.

Cheers. üçª
 Apologies @grosch, I realize now that in my reply I didn't provide nearly enough detail. In your simple example, it certainly works. The problem is when keys or values in the JSON contain single or double quotes. I cannot find any possible combination of escaping that works between both shells because of the differences in the way they escape strings.

If you would really like to see this feature support both shells, then I'd encourage you to find a way to make this [test](https://github.com/Alamofire/Alamofire/blob/master/Tests/RequestTests.swift#L565-L596) work in BOTH bash and tcsh. We could also consider having two different methods for building the `cURL` command. Then possibly a way to set your shell preference on a Request.Shell enumeration or something along those lines.
  Replied @marcmatta. You'll need to provide more info.

Cheers. üçª
 You'll have to troubleshoot with the server team. Unfortunately, there's nothing we can really do to help here @marcmatta.
  Hi @khanshakeeb,

You will need to use Alamofire 2.0.2 if you're still building against Swift 1.2. I'd encourage you to update to the latest version of Swift ASAP because 1) Swift 2.2 is awesome and 2) we have made many great improvements to Alamofire over the past 6-7 months that you will be missing out on.

Cheers. üçª
  If you wish to validate that you got a response code in some range, you must call `validate()`, as noted in our documentation. 
 Without calling `validate()`, you'll see any lower level network errors in there (e.g. internet connection offline, connection lost, connection timeout), or errors when trying to deserialize into whatever `response` method you're using (e.g. JSON deserialization errors). You can add your own validation rules through `validate()`, or if that's not flexible enough, through a custom response serializer. 
  Can you share your request code? It will help us narrow down where in the process you'd have to customize your encoding to get the behavior you want. 
  This has nothing to do with Alamofire, this is how the underlying `NSURLSession` works. If you wish to remove the `tmp` file, you'll need to delete all files within that directory. Although I'm not sure why you'd want to do this given that iOS will purge these directories automatically.

Cheers. üçª
  Hi @dtorreci4ejg,

You most likely need to override the [taskDidReceiveChallenge](https://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLSessionTaskDelegate_protocol/#//apple_ref/occ/intfm/NSURLSessionTaskDelegate/URLSession:task:didReceiveChallenge:completionHandler:) closure instead. Kerberos challenges are part of the [NSURLAuthenticationMethodNegotiate](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLProtectionSpace_Class/#//apple_ref/c/data/NSURLAuthenticationMethodNegotiate) protection space auth type. The `taskDidReceiveChallenge` should be called as soon as a challenge is issued by the server. It will be called again if the challenge is not successfully authenticated. Alamofire by default will reject the protection space after a failed attempt. However, if you're overriding the default logic, the behavior is up to you.

Cheers. üçª
  Hi @buzzllc,

I can't be certain with the info you provided, but most likely you need to do the following instead:

``` swift
let headers = ["Authorization": "Bearer \(someAuthToken)"]
```

If that doesn't fix your issue, then I'd encourage you to ask a question on Stack Overflow since that's a better place for this type of question. We use our GitHub project primarily for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I'm fighting with a leak problem!
Any ideas / fixes ?

iOS 9.0 xcode 7.3

![screen shot 2016-04-21 at 14 59 34](https://cloud.githubusercontent.com/assets/4609982/14709584/b4b79182-07d1-11e6-9126-9c1ee31d4b88.png)

``` swift
class ViewController: UIViewController, getDataDelegate {

   override func viewDidLoad() {
      super.viewDidLoad()
      Services.delegateData = self
      Services.getData()
   } 
   func finishedDownloading(data: Data) {
      //do something...
   } 
}
```

``` swift
import CoreLocation
protocol GetDataDelegate : class {
    func finishedDownloading(data:Data)
}
class Services {
   weak var delegateData:GetDataDelegate?
   func getData() {

        let urlString = API_URL + "url/"
        let headers = self.setHeaders()

        Alamofire.request(.GET, urlString, headers: headers)
            .validate()
            .responseJSON { response in
                switch response.result {
                case .Success:
                    if let value = response.result.value!["data"] as? NSArray {
                       self.delegateData?.finishedDownloading(self.setData(value))
                    }
                case .Failure(let error):
                    print(error)
                }
        }
    }
}
```
 Hi @enricopiovesan,

Could you update your example so it would compile? How are you initializing the `Services` object in the `ViewController`? Is the `getData` method actually a static method?
 Hi @cnoon,

this is the base code, do you need other?

``` swift

class ViewController: UIViewController, getDataDelegate {

   override func viewDidLoad() {
      super.viewDidLoad()
      Services.delegateData = self
      Services.getData()
   } 
   func finishedDownloading(data:Data) {
      //do something...
   } 
}
```

``` swift
import Alamofire
protocol GetDataDelegate : class {
    func finishedDownloading(data:Data)
}
class Services {
   weak var delegateData:GetDataDelegate?
   func getData() {

        let urlString = API_URL + "url/"
        let headers = self.setHeaders()

        Alamofire.request(.GET, urlString, headers: headers)
            .validate()
            .responseJSON { response in
                switch response.result {
                case .Success:
                    if let value = response.result.value!["data"] as? NSDictionary {
                       self.delegateData?.finishedDownloading(self.setData(value))
                    }
                case .Failure(let error):
                    print(error)
                }
        }
    }
   func setData(dictionary: NSDictionary) -> Data {
       let name =  dictionary["name"] as! String
       let color =  dictionary["Color"] as! String
       return Data(name: name, color: color)
   }
}
```

``` swift
class Data() {
    var name: String
    var color: String
    init(name: String, color: String) {
       self.name = name
       self.color = color
    }
}
```
 I modified with a static function, but the problem still persist.

``` swift

class ViewController: UIViewController, getDataDelegate {

   override func viewDidLoad() {
      super.viewDidLoad()
      Services.delegateData = self
      Services.getData()
   } 
   func finishedDownloading(data:Data) {
      //do something...
   } 
}
```

``` swift
import Alamofire
protocol GetDataDelegate : class {
    func finishedDownloading(data:Data)
}
class Services {
   static weak var delegateData:GetDataDelegate?
   static func getData() {

        let urlString = API_URL + "url/"
        let headers = self.setHeaders()

        Alamofire.request(.GET, urlString, headers: headers)
            .validate()
            .responseJSON { response in
                switch response.result {
                case .Success:
                    if let value = response.result.value!["data"] as? NSDictionary {
                       self.delegateData?.finishedDownloading(self.setData(value))
                    }
                case .Failure(let error):
                    print(error)
                }
        }
    }
   func setData(dictionary: NSDictionary) -> Data {
       let name =  dictionary["name"] as! String
       let color =  dictionary["Color"] as! String
       return Data(name: name, color: color)
   }
}
```

``` swift
class Data() {
    var name: String
    var color: String
    init(name: String, color: String) {
       self.name = name
       self.color = color
    }
}
```
 That leak is in `NSJSONSerialization` @josete89, not Alamofire. Given that, I'm going to go ahead and close this issue out. If someone can provide a sample project that demonstrates the leak is actually in Alamofire, then I'd be happy to investigate further.

Cheers. üçª
  Hi @crash-wu,

Your error message is encouraging you to use `options: .AllowFragments` instead of `options: .MutableLeaves`. That will allow whatever valid JSON object that isn't currently a collection to be parsed successfully.

In the future, I'd encourage you to instead open a question on Stack Overflow. We use our GitHub project with bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I would not recommend subclassing `SessionDelegate` just to add logging. I've been able to get satisfactory logging in my projects by putting it in my custom `response` method.
  Thanks @Piyush08! üçª
  You certainly can use the `request` method to do this, but I would encourage you to use `upload` instead. The reason is that the `request` method progress tracking only reports downloading progress of the response data. It will not report upload progress. 

The `upload` APIs will report the upload progress to the server and do not report download progress of the server's response data. Because of this, I'm sure you'd prefer the `upload` APIs in this situation.

Cheers. üçª
  Hi @kakilan,

I'm a bit surprised that doesn't work. What I would try instead is to set the `NSURLCredentialPersistence` in the `authenticate` method to `.None`. That's the only other thing I can think to do here while keeping your same approach.

``` swift
.authenticate(user: userName , password: password, persistence: .None)
```

If that still doesn't work, you have a few other options.
1. Create a new `Manager` each time you logout
2. Use an `ephemeral` session to avoid the problem altogether
3. Use a base64 encoded basic `Authorization` header that wouldn't get cached

One of these approaches should resolve your issue.

Cheers. üçª
  Hi @keisyrzk,

Are the headers missing when using curl @keisyrzk? That's the only thing we can really suggest to try to help out here. Alamofire does not handle building the [allHeaderFields](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSHTTPURLResponse_Class/#//apple_ref/occ/instp/NSHTTPURLResponse/allHeaderFields) dictionary in the response. That's all handled internally by Apple's APIs.

The only thing we can really do here is suggest you try to reproduce the issue with curl and try to get the results to your server team. Additionally, you could consider why your needing to extract that header in the first place. Aren't you sending up the accessToken already? Why do you need to check the header in the response?

Best of luck! üçª
 Hi @Quintasan, your comments are a bit confusing. Could you please put names to the libraries you are mentioning? Are you saying that you were previously NOT using Alamofire, and things were always working? And now you are using Alamofire and they don't work? 

If that's true, that's still not much to go on...
 @Quintasan I think Christian's point was that merely providing a link to a library doesn't really help us understand your requirements. I think there was also some confusion about whether you were having issues with the request or response.

As far as I understand it, however, you seem to be having an issue where the `access-token` field doesn't appear in the `allHeaders` property of the `NSURLResponse` returned when getting a response. Is that correct? Unfortunately Alamofire has no control over the parsing of the response headers, at that is handled by the lower level networking libraries provided by Apple. You can see if we're getting the appropriate headers through `NSURLSession` by setting a breakpoint in Alamofire where the `NSURLSession` delegate methods are implemented. 
  Alamofire 3.3 requires Xcode 7.3. Update and it will build fine.
  Update to Alamofire 3.3, as that release fixed the Swift 2.2 warnings you're seeing. We do not yet support Swift 3. 
  These were never intended to be used publicly. They are only implemented to allow internal customization of Alamofire handling. You already have the ability to override everything at the session level through the `Manager.SessionDelegate`. If you can come up with some examples of what you can't currently do because of this design, then we'll certainly consider the proposal. But at this time we have no intention of opening up those APIs.

Cheers. üçª
  Thanks for putting this together @0xced!
  Thanks for putting this together @0xced! I made a few small changes to the API and pushed into `master` in c2a282cc while still keeping your attribution. Thanks again!

Cheers. üçª
  Thank you for putting this together @chrisrichards! Your turnaround time was amazing...apologies that ours was not.

I made a few tweaks to your submission and pushed it into `master` in d2b85f43 while still giving you attribution. Thanks again!

Cheers. üçª
  Hi @edopelawi,

Thanks for your PR, but unfortunately we won't be pulling it in. The test passes without this change. By adding the declaration you have added in this PR, you defeat the purpose of the test in the first place. Thanks anyways!

Cheers. üçª
 I just pushed up https://github.com/Alamofire/Alamofire/commit/8d16d492f670a2cb86ff2fe5e707204ac5c92964 to address the Travis CI failures prior to iOS 9.0. If they pass, I'll go ahead and merge them into `master`.
  Thanks for reporting @jerarts!

It looks like we have a bit of a bad assumption in the `CustomDebugStringConvertible` logic. Right now we're extracting all the `NSURLRequest` headers, then the `NSURLSessionConfiguration` headers. Instead, we should collect them in the opposite order and have any duplicates in the `NSURLRequest` replace the previous value since that's the actual behavior when the request is sent.
 Would anyone in the community like to help out to fix this issue? Should be easy to collect the headers then append them to the `components`. We'll also want to write some unit tests to verify this behavior.
 Issue has been resolved in d2b85f43 thanks to @chrisrichards. I'm going to go ahead and close this out.
  Thanks @Mycose! üçª
  You just need to add the `Alamofire` prefix to the `Method` type. That will resolve the issue. The following compiles:

``` swift
public class SubManager: Manager {
    public override func request(
        method: Alamofire.Method,
        _ URLString: URLStringConvertible,
          parameters: [String: AnyObject]? = nil,
          encoding: ParameterEncoding = .URL,
          headers: [String: String]? = nil)
        -> Request
    {
        return request(NSURLRequest())
    }
}
```

In the future, I'd encourage you to ask these types of questions on Stack Overflow. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  The `Unity4XC` plugin will not cause the build to fail. In order to build Alamofire 3.3.1, you need to use Xcode 7.3, xcodebuild 7.3, and Carthage 0.16. After you have everything updated, I'd suggest wiping DerivedData and the Xcode cache. Then reboot Xcode. After you have all this completed, Alamofire should build properly.
  Hi @shenjiayu!

This seems like a logic issue, not an issue with Alamofire. I'd recommend opening a question on Stack Overflow for this problem. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @marckaraujo,

If you ever have issues getting the syntax right, I'd first check out the unit tests. We have over 300 tests that demonstrate how to use pretty much every single API available in Alamofire. For example, in our [UploadTests](https://github.com/Alamofire/Alamofire/blob/master/Tests/UploadTests.swift), there are 17 tests with 766 lines of code demonstrating how to use the `upload` APIs that you're having trouble with.

In the future, I'd recommend opening a question on Stack Overflow instead of here on GitHub. We use our GitHub project for bug reports and feature requests. It helps us focus on the core features and allows the community to help out with support questions.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hmmmm....we'll need to look into this @Mycose. Is there any chance you could put together a failing test to demonstrate the issue? That would make it much easier for us to troubleshoot.
 Thanks for all the info you provided here. 

We have a fairly large set of `CacheTests` to help verify this type of behavior. If you open up the test suite and run [this](https://github.com/Alamofire/Alamofire/blob/master/Tests/CacheTests.swift#L255-L284) test on iOS 8.x or iOS 9.x and set a breakpoint in the [URLSession(_:dataTask:willCacheResponse:completionHandler:)](https://github.com/Alamofire/Alamofire/blob/master/Source/Manager.swift#L606) method, you'll see that the breakpoint is being called each time.

I then added your `delegate.dataTaskWillCacheResponse` override to the test's `manager` and re-ran. Both the delegate method and the override closure are being called as expected.

The only difference may be that I'm running Alamofire 3.3.1 and you are running 3.2.1. We have made some changes in the 3.3.1 release that fixed some bugs around some of the delegate methods being called, but this particular session delegate method should not have been affected. Additionally, the bugs there should have only affected the 3.3.0 release, not the 3.2.1 release. Either way, I'd encourage you to dig into the tests that I've linked in this comment to see the behavior working for yourself. Then I would update to 3.3.1 and see if that fixes your issue.

If 3.3.1 does not fix your issue, then you'll need to figure out why your logic is different than the logic in the tests. I don't see anything obvious from the code you posted, but that doesn't mean that you don't have something else set that is affecting the behavior that isn't in your example.

At this point, I don't see an issue in Alamofire. All the behavior you've reported is not working seems to be working correctly from what I can tell. Because of this, I'm going to close this issue out for now. If you do still continue to have issues, then please provide a failing test or sample project for us and attach it to this issue. Then we'll gladly re-open the issue and continue to help you investigate further.

Best of luck! üçª
 Cool...thanks for the update!
  First make sure you're running the latest version of Carthage and Xcode 7.3. Also make sure you're `xcodebuild` is updated to 7.3. Then you need to clean the project, wipe derived data and possibly the Xcode cache. If you're still seeing issues, reboot. After all this, you will see that Alamofire 3.3.0 and 3.3.1 do compile successfully with Xcode 7.3. 

> It will not compile with Xcode 7.2.1 and below.

Cheers. üçª
  Thanks @dersvenhesse!
  We made the decision to drop iOS 7 a LONG time ago (as in over a year ago). It does not support frameworks which causes all sorts of issues when maintaining a library of this size. We also cannot test any of the iOS 7 logic without having to maintain two different test suites.

Our general approach will be to maintain Alamofire against the currently released version of iOS and the previous one. At some point after iOS 10 has been released, we'll be looking to remove support for iOS 8.

Cheers. üçª
  This PR removes the `final` keyword from the `SessionManager` declaration. These changes allow advanced users to subclass the `SessionDelegate`, but should only be used when absolutely necessary. A simple example of such a use case would be to use a proxy pattern to emit notifications or log messages when certain APIs are called. The override closures do not allow you to do this and still use the default implementation.

I also added a section to the README detailing the different ways to use the override closures vs. subclassing. Hopefully this provides enough info to allow users to make the best decision for their use case.
 cc @taquitos, @AnthonyMDev, @jshier, @kcharwood, @kylef 
 :+1: On this, though an actual example of improper `subdelegates` usage might be a good idea, if it can be such an issue.
 Okay awesome guys, thanks for all the feedback! I'll go ahead and merge this now and put together another PR with the example of improper usage.
  Try deleting your DerivedData folder and Xcode cache and rebooting Xcode. If this doesn't work, then possibly reboot your machine. Beyond that, make sure you're using the latest version of CocoaPods.

If you continue to have issues, I'd recommend you open a question on Stack Overflow. We use GitHub for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Great question @sealz! 

What you'll need to do for now is to create a custom response serializer that essentially does two passes. The first pass would have to validate the HMAC, if it fails, call the completion with a `.Failure` response. If it succeeds, go ahead and decode the `NSData` however you wish. If the decoding succeeds, call the completion with a `.Success` response, and `.Failure` if it fails.

I've also added an item to our backlog for Alamofire 4 to consider adding the `NSData` value to the `Validation` closure to allow you to do this type of validation with a custom validate method.

Cheers. üçª
  It is part of the [release notes](https://github.com/Alamofire/Alamofire/releases/tag/3.3.0) for 3.3.0. But you're right, the general README and other documentation should be audited to reflect this requirement.
 Apologies for not getting this updated properly with the `3.3.0` release @PattyHarris. This has been corrected in 3b1edd80.

Thanks! üçª
  Hi @timothyarmes,

Given your needs here, I'd recommend using your own NSURLSession and NSURLSessionDelegate, then using Alamofire to help create the `MultipartFormData` objects to upload. This will end up being much easier in the long run because Alamofire currently does not support these complicated background session use cases very well. This is something we'd like to attempt to address in Alamofire 4.

Best of luck! üçª
  We will not be adding a dependency to Alamofire @itchingpixels. This issue has already been discussed in detail in #764 and #1072.

Cheers. üçª
 @itchingpixels All Swift frameworks are automatically namespaced. You can disambiguate by using `Alamofire.Result` or `Result.Result` already. Now, if you aren't using your dependencies as frameworks, there's not much we can do to help you, as frameworks are Swift best practice for independent dependencies. 
 Thanks @jshier, well said.

@itchingpixels, we won't make the `Result` type more difficult to work with in any way for users that aren't using a second `Result` type that conflicts. You MUST understand that point of view. You're suggestions are attempting to make your use case easier without considering the effect it would have on the community. For those not familiar with the `antitypical/Result` library, the Alamofire design would seem very odd.

We're always open to suggestions to make Alamofire better, but it must be better for the community. Not for individuals. Adding a third party dependency to Alamofire that we don't control is certainly not in the best interest of the community. Renaming `Result` to something not result is not in the best interest of the community. Wrapping an additional extension around `Result` is not in the best interest of the community.

Are you planning on telling every third party library out there that they can't create their own `Result` type? It just doesn't seem realistic, nor considerate. This is a common pattern that the Swift community needs to use in various places, especially when async operations are involved. Most likely, these libraries will be creating their own Result types, unless they decide to couple to one of the Result libraries out there. But if they choose one that isn't the one you're using, you still have the same problem.

Please take @jshier's advice and use namespacing when you're working with both types. You could also consider not trying to use the two together.
  I really like this approach @0xced! I made a few alterations to your PR and pushed 8d9f79a8 and 2b91b8fc while maintaining your attribution.

Thanks again! üçª
  There was a bug that was fixed in the `3.3.1` that was causing the `taskWillPerformHTTPRedirectionWithCompletion` closure to not be called @onmyway133. If you update to the latest release, everything should work as expected.

I'm going to close this issue out for now. If this doesn't actually solve your problem, please provide some additional info and I'll be happy to re-open.

Cheers. üçª
  This looks good @0xced...thanks for putting it together! üçª
  Hi @vimask,

This issue is most likely going to be in your custom implementation of the `sessionDidReceiveChallenge` closure, not with any Alamofire specific logic. The error leads me to believe there's a mismatch between your client identity and the cert data your providing back to the server in your credential. You'll need to continue to debug further. I'd also recommend handling the specific type of challenge rather than considering them to all be the same. This [thread](http://stackoverflow.com/questions/26721546/using-nsurlsession-with-nsurlcredentialstorage-and-nsurlauthenticationmethodclie) may provide some useful info.

If you do end up finding any Alamofire specific issue, please provide more info and I'll be happy to re-open and investigate further.

Cheers. üçª
  Not entirely sure what you're asking. Regardless, questions like these are best suited for Stack Overflow. We use GitHub for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Declining this in favor of #1172. Please redirect all future comments to #1172.
  Hi @lucatorella,

Thanks for reporting the issue. After investigation, I realized that test was bad in all sorts of ways. I have rebuilt the test to properly demonstrate how to use an `NSURLProtocol` with an `NSURLSession` in 8e3990b3. The test will fail if you do not use the `NSURLProtocol`, and passes when you do.

Thanks again! üçª
  Hi @grosch,

These types of questions are best suited for Stack Overflow. We use GitHub for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Okay everyone, apologies for closing this out prematurely. Moved through the issue too quickly. Reopening.

As you have all clearly pointed out, this is certainly worth investigating further to see if there's a better way we can bubble this back to the user. AFN has been working on a solution for when cert or public key pinning evaluation fails, but I'm still a bit weary of such a change. IMO, if we're going to give custom errors for cert or public key pinning failures, we should certainly do the same for other authorization challenge types.

For anyone that feels strongly, I'd encourage them to first ramp up on the efforts from AFN, just so that you have all the proper context. Then, let's discuss the possible options here in this issue.
- [AFN Background](https://github.com/AFNetworking/AFNetworking/issues/3165)
- [AFN Server Trust Error PR](https://github.com/AFNetworking/AFNetworking/pull/3425)
 @0xced has resolved this issue in #1164. I'm going to close this issue out for now. Please direct all future comments to #1164.

Cheers. üçª
  Everything is working as expected. The original request made by Alamofire (NSURLSession) does not include the credential info. That's why you're seeing the 401 behavior with the cURL command. What happens instead is that the original request is made, then the server issues an auth challenge back to the client. When this happens, Alamofire will provide the credential back to the server, and then the request is successfully made. After the connection has been authenticated, the server trusts subsequent requests. If not, it will issue another challenge and Alamofire will provide it.

Cheers. üçª
  Looks like everything is still working on our end. If you check out this [test](https://github.com/Alamofire/Alamofire/blob/master/Tests/DownloadTests.swift#L162-L255) and print out the expected bytes like so:

``` swift
download.progress { bytesRead, totalBytesRead, totalBytesExpectedToRead in
    let bytes = (bytes: bytesRead, totalBytes: totalBytesRead, totalBytesExpected: totalBytesExpectedToRead)
    byteValues.append(bytes)

    print(totalBytesExpectedToRead)

    let progress = (
        completedUnitCount: download.progress.completedUnitCount,
        totalUnitCount: download.progress.totalUnitCount
    )
    progressValues.append(progress)
}
```

Everything is working properly. You'll need to continue to debug what's going on on your end with your server. Just FYI, Alamofire doesn't do anything special with this value. It's either provided by Apple's APIs or it isn't. Alamofire just passes it on.

If you do end up finding a bug in Alamofire, please provide more info and I'll be happy to re-open this issue and investigate further.

Cheers. üçª
  You'll need to debug the `error` being returned. Since you are not receiving a URL response, that means you're not actually able to hit the server and your request is not being formed properly. You should try using the following to debug further:

``` swift
let request = Alamofire.request(.GET, URL, ...).responseJSON { response in
    print(response)
}

debugPrint(request)
```

In the future, you should open a question on Stack Overflow. If you do end up finding an actual issue in Alamofire, please comment back with more info and I'll be happy to investigate.

Cheers. üçª
  Please update to the latest version of Carthage, Alamofire and Xcode and everything should work as expected. Questions like this are best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Cheers. üçª
 I just used the latest Xcode, latest Carthage and latest Alamofire release and built successfully with no issues.

``` bash
cnoon:~/Desktop/CarthageTester$ carthage update
*** Fetching Alamofire
*** Checking out Alamofire at "3.3.0"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.QdM6Sa.log
*** Building scheme "Alamofire watchOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire OSX" in Alamofire.xcworkspace
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire tvOS" in Alamofire.xcworkspace
cnoon:~/Desktop/CarthageTester$ 
```
  Right now we don't have any custom handling of the stream session task delegate APIs in Alamofire. At the moment you'll need to implement event handling yourself. If you end up coming up with some nice patterns that you think may be useful to the rest of the community, we'd love it if you'd take the time to submit a PR back. Even if it is just a set of ideas.

Cheers. üçª
  Also in https://github.com/Alamofire/Alamofire/issues/1136. Thanks @aemengo!
  Hi @veena-experion,

This type of issue is best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @esokullu!
  You likely pulled down Alamofire 3.3, which is only compatible with Xcode 7.3. Either lock your Cartfile to `~> 3.2.0` or update to Xcode 7.3.
 Thanks @jshier!
  Hi @balazsgerlei,

Thank you for your detailed feature request. I understand that async operations can make things more complicated, but we also don't want to hold up queues (or threads) while the async operation takes place. Since Apple removed the ability to execute synchronous API calls in the `NSURLSession` APIs, you can see that they are forcibly moving in the direction of making network calls asynchronous. We aren't interested in moving backwards to replicate the `NSURLConnection` APIs.

With that said, we have made some improvements to make the concept of thread-safety and synchronous calls easier. In 4c7bf391, we added the `queue` parameter to all the response serializers making it really easy to make a request, and specify the queue to call when it is complete. This is essentially a synchronous API if you handle the response on the same queue that you made the request on. The nice thing is that it allows the queue to process other things with the request is being made.

While I understand synchronous APIs may make things easier, they could also make things much worse. We will not be adding synchronous APIs to Alamofire, but we will continue to try to make the async APIs easier and easier to use.

Cheers. üçª
  Not sure exactly what your issue is, but most likely you just need to clean and wipe derived data and possibly the Xcode cache. If you are still experiencing issues, then I'd suggest you open an issue on Stack Overflow. We use the GitHub project for bug reports and feature requests.

Cheers. üçª
  Hi @taquitos, my apologies for not getting back to you sooner.

Your use case here is completely valid, and is definitely something that you can't do with the current implementation. Essentially you'd like to be able to proxy a `SessionDelegate` API or two somewhere to perform some additional operations, yet still be able to use the default logic. The problem is that you can't actually do this with the basic closures or even the closures with completion.

Now I'm not entirely sure I follow what you're attempting to do in your PR, but I do have a simple solution here. I have been debating this for quite some time, and I think it might just be time to do this. If we remove the `final` signature on the `SessionDelegate`, users are free to subclass the `SessionDelegate` and proxy the delegate APIs as much as necessary for the use case. Here's what that "could" look like:

``` swift
public class SessionDelegate: 
    NSObject, 
    NSURLSessionDelegate, 
    NSURLSessionTaskDelegate, 
    NSURLSessionDataDelegate, 
    NSURLSessionDownloadDelegate 
{
    // All the current implementation...
}

public class CustomSessionDelegate: Manager.SessionDelegate {
    public override func URLSession(
        session: NSURLSession, 
        dataTask: NSURLSessionDataTask, 
        didReceiveData data: NSData) 
    {
        print("I received some data!")
        super.URLSession(session, dataTask: dataTask, didReceiveData: data)
    }
}
```

This would give a power user complete control over the process if they really needed. What I also like about this is that you can still use the more convenient override closures without having to subclass which is generally what you'd do in most cases. IMO, this seems like the best approach. Let's see if we can gather some feedback from some of the rest of the Alamofire team.

cc @jshier, @kcharwood, @kylef, @AnthonyMDev 
 The `misuse` I was referring to @AnthonyMDev was around the `subdelegates` and making sure they're still created and deallocated appropriately. I really hesitate to make them public. I just opened #1172 which should address all the concerns in this issue.

I'm going to close this issue out for now. Please direct all future comments to #1172.
  Thanks @ludoded! üçª
  Thanks for reporting @rmarczynski. It looks like @kcharwood has a fix in for this issue already in #1141. I'm going to close this issue out for now. Let's direct all further comments to #1141.

Thanks again! üçª
  If you post a link to the Stack Overflow question, I can help point you in the right direction there.

Cheers. üçª
  No, since that feature is only available in Swift 2.2. 
  You need to update to Xcode 7.3 to build Alamofire 3.3.0.
  @jschmid - this should not be a MAJOR version upgrade according to semver. @phroggyy - you are absolutely right, this info should have been included in the release notes. That has been corrected in fad7390a. Hopefully that helps clarify the reasoning for going with 3.3.0 instead of 4.0.0.

Cheers. üçª
  Hi @LuoLee,

Xcode 7.3 is now required for the latest Alamofire 3.3.0 release. The README has been updated accordingly to reflect that.

Cheers. üçª
  Alamofire 3.2.1 does not support Swift 2.2. Please use the `swift_2.2` branch until we release 3.3.0.

Cheers. üçª
  http://stackoverflow.com/a/34193782/1342462
  Hi @gitunhub,

These types of questions are best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Alamofire 3.2.1 is not Xcode 7.3 compatible. For now, you'll need to use the `swift_2.2` branch. We're aiming to have out a release today that resolves this issue.
 Quit Xcode, clear derived data, wipe your Xcode cache, then relaunch. That should fix everything up. Sometimes you also need to reboot your machine as well.
  Alamofire does not yet build on Xcode 7.3. This is something we are aiming to resolve today. For now, you can use the `swift_2.2` branch.

Cheers. üçª
 Alamofire 3.4.0 builds against Xcode 7.3.
  Thanks @nickskull, we're hoping to get these fixes incorporated into Alamofire today and a release cut.
 Thanks for putting this together @nickskull...much appreciated! I made some slight variations to your changes and pushed them up in 38606315 while still giving you attribution. I made some other modifications in 22c81a3b to the Travis yaml file. I still don't have all the Travis problems worked out, but everything is looking good locally across all platforms.

Thanks again! üçª

> These changes will be released shortly...
  Thanks @florentmorin!
 @borut-t You may be able to use the value of the "Content-Length" header fields of the response to get the data length before decompression.
  Hi @orkenstein,

You'll need to convert the `Bool` value to a `String` in the case of `.URL` parameter encoding. This works correctly for JSON, but not for `.URL` encoding. Unfortunately you need to convert the value yourself. There are a bunch more details in #1056 explaining why.

Cheers. üçª
 It adds a bunch of complexity to add that check and wouldn't be backwards compatible. There are already thousands of people using this logic as is. Therefore, if you need a bool to be a string as a query parameter, you'll need to handle the check at the client layer before passing it into Alamofire.

All the best.
  Most likely the memory persists due to the in-memory `NSURLCache` behavior or various other types of caching that UIKit could be doing. If you do end up finding a specific Alamofire leak, please comment with more info and I'd be happy to re-open and investigate.

Cheers. üçª
 I have the same problem
  Thanks @oursevendev. 

@skerkewitz, you can definitely use both in the same project. If you're in the process of moving to Swift, it would certainly be ideal to replace AFN with Alamofire in one big change, but you can certainly do this in smaller steps leveraging both. You'll just need to use the AFN session for certain APIs, and the Alamofire session for others.

Best of luck!
  This is a great question @matthiaslau. Personally I haven't tried to use cert pinning yet with a background session. If anyone else has any info here, please share!

Are you running into this problem when the app is running in the background, or when it's running in the foreground? There are some obvious problems right now with the Alamofire design working with background sessions. Such as trying to reconnect your session and all the response closures being dropped.

Could you give me a more detailed explanation of your use case?
 Hey @matthiaslau, have you made any progress here? 

Have you been able to successfully use cert pinning with your server without using background sessions? That is the first thing you should probably try to get working. To do this, you'll want to switch to a `defaultURLSession` and try to get everything working. I'm fairly confident that you're probably running into an ATS issue or maybe you have your server trust set up incorrectly. Starting here will guarantee you have ATS and cert pinning configured correctly. üëçüèº

Once you get everything working on a default URL session, then I'd suggest moving to a `backgroundURLSession` and troubleshoot. I'm fairly confident that this will just work for you after you have everything working for a default session. I think your issue is with ATS or your server trust and not actually with background session.

I'm going to close this issue out for now. If you end up finding that there is actually an issue in Alamofire for this case, please provide some more info and I'll happily re-open and help you investigate further.

Best of luck! üçª
 Hi @mattcantstop,

Sounds like this could use some additional investigation on our end. From what I'm hearing though, it sounds like background sessions are not respecting auth challenges in the same way as a default session. That's potentially problematic since Alamofire doesn't control any of that logic. It just reacts to it.

Would you be willing to put together a test case that can produce this behavior? It would much easier for us to help you debug if you could. Then we can try to dig in around the passing case and failing case and see if we can figure out what's going on.

Thanks!
 @matthiaslau are you still planning on putting together a sample app for this issue? If not, I'm going to go ahead and close this out.
 Hi @matthiaslau and @bclausdorff,

Sorry for not digging into this sooner. I finally found some time to really dig into this issue. I've scoured all the Apple docs and I can't find any definitive answer on the subject as to whether the background session configuration automatically evaluates a server trust challenge for you. Because of this, I decided to build a sample app to test it out.

What I found in the sample app is that with background sessions, server trust challenges are automatically evaluated. You'll never get called when performing the TLS handshake. iOS is just going to evaluate the cert and establish the connection if the cert chain is valid and fail if it's not. I tested both cases with `https://httpbin.org/get` and `https://expired.badssl.com/`. The challenge delegate API just isn't called in either case running on a device or in the simulator. I am assuming this is for performance reasons. If you end up needing to do something like cert pinning or allowing a connection if the cert is invalid (self-signed certs), then you just can't use a background session.

What was interesting is that the delegate is called on a basic-auth challenge. Now from what I can gather from the [Handling Authentication](https://developer.apple.com/library/prerelease/content/documentation/Cocoa/Conceptual/URLLoadingSystem/Articles/UsingNSURLSession.html#//apple_ref/doc/uid/TP40013509-SW16) docs is that `basic-auth` challenges are non-session-level challenges. I can only assume that these types of challenges are not automatically evaluated on background sessions, where session-level challenges are.

Long story short, there's nothing we can do here. Server trust challenges are automatically handled by iOS with background session configurations. As such, I'm going to go ahead and close this issue out since there's nothing we can actually do about it in Alamofire.

Thanks everyone for being patient here until we had time to get to the bottom of the behavior.

Cheers. üçª
  Hi @krezzoid,

Thanks for putting this PR together. Unfortunately we don't think this is a good set of changes to include in Alamofire itself. This deviates greatly from the delegate queue serial processing pattern leveraged heavily by the method chaining pattern. If you need this type of functionality, then I'd suggest you create your own extensions on the `Request` object to do this.

Cheers. üçª
 Ah ic. In this case I think you'll want to create a custom response serializer that takes in the queue you want to run the serialization on and does it that way. For example, just execute something like `responseData` on the `TaskDelegate` queue, then process the data into your Realm model object on your provided queue. That should allow you to do what it is you're trying to accomplish.
  Hi @Windsooon,

You probably need to use the parameter encoding `.URLEncodedInURL` instead of `.URL`. Your POST is putting the payload in the HTTPBody and not the query parameters. Additionally, you can use the following in the future to help you debug this type of problem.

``` swift
let request = Alamofire.request(.POST, URLString, parameters:parameters, encoding: .URL)
debugPrint(request)
```

This will print out the cURL command making it MUCH easier to see what's actually going on.

In the future, I'd suggest opening a question on Stack Overflow instead. We use the GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @BculeMB,

This type of question is best suited for Stack Overflow. We use the GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for putting this together @lucatorella! You are absolutely right, these should have always been exposed. For some reason, I've always used the `response` method and passed my custom queue along with the response serializer I needed. I'm not really sure why I didn't think to add them to the top-level APIs. Thankfully you did!

Cheers. üçª
  Can you explain this a bit more? I'm not sure what problem you're referring to, but I'm seeing some intermittent encoding errors that could occur from a deadlock.
 Yea, I see what you're saying. I don't see any reason to schedule the stream in the runloop either. Not sure it will actually cause problems, but there's no reason for it. There's a good chance the runloop doesn't even notice that it was added. 

I removed the runloop scheduling and all the unit tests still passed.
 @wizzardchao could you post a link to the docs you're referring to?
 Thanks for the due diligence here @wizzardchao. You are absolutely right that it is currently implemented incorrectly. Thanks for pointing us towards the Apple docs. Those were really helpful. Since it looks like @KingOfBrian has already done all the work for us to fix this in #1121, I'm going to close this issue out. Please redirect all further comments to #1121.

Thanks! üçª
  Yep, definitely a typo. Great catch @topchul! And thanks for putting together the PR to fix it. üçª
  Thanks @vsouza. We currently aren't closely supporting SPM since it's still in beta. If anyone out there with more experience with SPM would be willing to help get Alamofire ready, it would be greatly appreciated!

Cheers. üçª
  The line is enforced for safety. It's to make sure you aren't trying to provide a `SessionDelegate` that isn't actually the delegate of the `NSURLSession` you're passing in. Otherwise, Alamofire won't really do much of anything for you.

Thanks for the answer @wizzardchao. You're spot on. In this particular use case @binkdotli, it's probably not worth trying to force your `SecurityLib` session and delegate into Alamofire. However, you could certainly still use parts of Alamofire to help build `NSURLRequest` objects such as `ParameterEncoding` and `MultipartFormData`.

Best of luck! üçª
  Marking as a duplicate of #1086.
 I'm going to close this issue out since it's a duplicate of #1086 @IvanZhouGitHub. Please redirect all comments to that issue instead.

Thanks! üçª
  Hi @wgywgy,

You'll want to use the [request.cancel()](https://github.com/Alamofire/Alamofire/blob/master/Source/Request.swift#L177-L190) API to generate the `resumeData` which you will then extract as shown in this [example](https://github.com/Alamofire/Alamofire#accessing-resume-data-for-failed-downloads) in the README. Then you'll need to use the `resumeData` and the [resume](https://github.com/Alamofire/Alamofire/blob/master/Source/Alamofire.swift#L366-L368) API to resume the request the next time you hit `startDownload`.

In the future, these types of questions are best suited for Stack Overflow @wgywgy. We use our GitHub project for feature requests and bug reports.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 The `resumeData` is not guaranteed to actually resume @jdleung. You want to try it, and if the OS cannot resume the download, it will restart it instead.
 @tiagoaap If the user kills your app there is no way to take any action, much less save resume data. At best you could manually write the download data to disk periodically during the download, but that's a lot of work for a user who doesn't care if your app completes the download.   Hmmmm...nothing obvious jumps out. I'd recommend trying to print out the `cURL` command to see if that leads you in the right direction.

``` swift
let request = Alamofire.request(.POST.rainForest.URL, ...)
debugPrint(request) // print out cURL command
```

In the future, questions like this are best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  https://github.com/Alamofire/Alamofire#uploading-multipartformdata
  It's failing to convert the `NSData` into a UTF-8 String on [these lines](https://github.com/Alamofire/Alamofire/blob/master/Source/ResponseSerialization.swift#L222-L228). You should instead try the `responseData` serializer and print it out to try and figure out why you cannot decode it. You could also try to write it to a file to debug it further. Long story short is that you're failing to decode the data as UTF-8.

In the future, questions like these should be asked on Stack Overflow. We use GitHub for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hmmmm...doesn't seem possible @shlowdy. The type on `userAgent` is `String`, not `String?`. Also, I haven't seen the optional arguments in the `User-Agent` header before.
 Ah...thanks for clarifying @shlowdy. I definitely see what you mean. The logic works fine as is, since it's using either the `AnyObject` coming from the dictionary or defaulting to a `String` which is then stored as a `String`. Then, when substituting into the new mutable string, each `AnyObject`'s `description is used to build the final String. All this logic works correctly, but can be a bit misleading.

In order to simplify, I just pushed 30525873 to make things a bit easier to digest. Hopefully that helps clarify things.

Cheers. üçª
  This PR extends the `SessionDelegate` override closures to include variants that contain the `completionHandler` parameter. In certain cases, such as reported in #1095, Alamofire was not providing enough flexibility to allow a user to override the implementation and perform some async operation before calling the `completionHandler`. These changes allow users to fully override the entire set of functionality inside any of the `SessionDelegate` APIs.

> For more details about a specific use case, please refer to #1095.

An alternative approach to this PR would be to remove the `final` modifier from the `SessionDelegate` declaration. This would allow users to subclass the `SessionDelegate` which would remove the need for these variant closures. I feel though that this is not a good idea since the `SessionDelegate` does not publicly expose the subdelegates and opening this up could lead to misuse when subclassing.

cc @jshier, @kcharwood, @kylef, @AnthonyMDev 
 @AnthonyMDev and @JoachimK, thanks for the healthy debate here. I think it always helps improve functionality when looking at approaches from many different angles. You have both certainly helped do that.

With that said, I tend to agree with @AnthonyMDev on most all the discussion here @JoachimK. You've made many interesting statements here, and I'll do my best to reply to the ones that I think could use some additional clarification.

---

> How about giving the session- and task-delegate each a delegate of same kind that users of Alamofire could implement. If a method is implemented, call it, if not use Alamofire's default implementation.

This is exactly what the override closures allow you to do. The difference is that this approach let's you override only one of the methods, not all. The approach you are suggesting is relying on @objc protocols which we're obviously going to try to avoid in Alamofire. Especially given all the changes currently taking place in Swift 3.0.

> Why not allow an NSURLSessionDelegate instead of a SessionDelegate to be passed to the Manager initializer. What is special about Alamofire's SessionDelegate that would take much work to reproduce in an own delegate and everyone needs?

Look at the implementation of the `SessionDelegate`. It does MUCH more than simply act as an `NSURLSessionDelegate`. It stores a bunch of state as well as a special `TaskDelegate` for each request. There's much more going on in there.

> Also, if I see it correctly, I could implement my own delegate and make it instantiate an instance of SessionDelegate itself to forward methods to that if I don't want to provide a custom implementation. This way, the implementation of the SessionDelegate wouldn't even be lost, but could be reused.

You can absolutely do this, but again I'd question why. Most of the time, you just want to use the override closures. There are other things that happen in those methods (such as cleanup) that you'll have to do yourself if you completely override the method.

> Another thing about the challenge/authentication specifically: If we are going to provide our "own" API (be that in blocks or as delegate) instead of using Apple's declared delegate protocols, we could try to seize the opportunity and improve upon it.

Generally I agree with this philosophy. However, I don't think it is wise in this particular case. The reason is that the delegate APIs are so complicated and come with so much documentation, that I hate to deviate too far from them. We don't want to have to re-create all the documentation that already exists for all the `NSURLSessionDelegate` protocols and all the more specific ones. Instead, Alamofire strives to provide a layer of convenience so the general user never even has to know about the delegate calls. Yet for power users, they have the ability to customize all the `NSURLSessionDelegate` calls if absolutely necessary.

---

Overall, thank you for all your feedback here @JoachimK. You've certainly helped us improve Alamofire significantly by exposing all the completion handlers directly in the override closures.

Cheers. üçª
  This has been raised in many different issues @maximveksler (#755, #1073, #1076). As stated in all those other issues, this behavior is by design. You need to make sure your URL is properly escaped before passing it into Alamofire. We don't want to automatically modify the URL you pass in because that would lead to confusion amongst the community.

Cheers. üçª
  Hello 
    I'd like to add the ability to retry requests transparently on token authentication failures, and wanted to check to see if it was functionality that might be accepted before going off and writing it. This is not a request to add oauth support, but functionality that could be used to easily add oauth support. The public API I see (names are probably not great) would look like:

``` swift
extension Request {

    public typealias RetryCallback = NSURLRequest? -> Void
    public typealias RetryCheck = (NSURLRequest?, NSHTTPURLResponse?, RetryCallback) -> Void

    func check(check: RetryCheck) -> Self {
    }
}
```

This would be consumed by the client like:

``` swift
request.check() {HTTPRequest, HTTPResponse, callback in
     if let HTTPResponse = HTTPResponse where HTTPResponse.statusCode == 401 {
         self.refreshAuthenticationToken() { token in
            let newRequest = HTTPRequest.mutableCopy()
            newRequest?.allHTTPHeaderFields["Authorization"] = "Bearer \(token)"
            callback(newRequest)
         }
     }
     callback(nil)
}
// Normal response handler
request.responseObject(completion)
```

_Background:_
Transparent token refresh is almost always desired when interacting with OAuth. This forces every request to re-implement painful token refresh that has to recapture all of the inputs and perform the logic above. It would be awesome to easily add this refresh behavior to the existing chain.

_Implementation Approach_
I believe this would be relatively easy to implement. First the operation queue would be suspended. If nil is passed to the callback, the operation queue would be resumed, and the remaining response chain would run. If a request was passed to the callback, all of the state of the request object would be cleared out and the new request would over-write the old one. The request would then be ran again with a new token, and hopefully succeed.

I was hoping to be able to create a request copy and copy over all of the response chain, but the response chain is built by grabbing the request via operation block closures, so I don't think that approach can work.

Any thoughts?

Thanks!

Brian
 So, I was looking through the implementation approach above, and it looks pretty bad. A request really doesn't want to retry, it's one request.

However, it may be easy to make the responder chain copyable. Right now it appears that the NSOperationQueue that represents the responder chain grabs the request state via closures. If that relation ship was stored as arrays of `ResponderChain` objects that conformed to a protocol like `func respondWithRequest(request: Request)`, a retry could move the responder chain to a new request and function as though it was one request from the API consumer perspective.

It appears that the use of the NSOperationQueue as a responder chain happens in 4 places, so this should be a relatively small change. Good chance that there's another shortfall I'm un-aware of though!
 Hi @KingOfBrian,

Thanks for putting together your thoughts on this. It's certainly an issue that a vast majority of iOS developers face these days. After looking through your suggestions, I think your looking at a greatly simplified example of what's generally happening. When a token has expired, generally that means the user hasn't used your app in a while. When they open it up, you probably have 10 different requests you need to make to sync back up. Unfortunately ALL those requests are going to hit a 401, not just one of them, and they are all going to hit it at slightly different times.

If you don't consider all the requests that are racing towards a 401, you're going to be in a world of hurt. Most OAuth servers aren't going to allow you to have 10 different access tokens all at the same time. Generally, you can create a few, but creating new ones tends to invalidate old ones. Therefore, creating new ones for each request can end up invalidating other ones that are already in flight. You can get into some really bad scenarios here.

Rather than thinking about the problem as refreshing a token for a single request, you need to think about refreshing a token for a group of requests. Because you don't know which scenario you are going to hit and you definitely need to handle both. Therefore, I'd recommend reading my much more in-depth answer that @glennrfisher pointed out (thanks @glennrfisher).

With that said, I would LOVE to be able to move my OAuth2 wrapper library out into the OSS community. Unfortunately, it requires you to move away from method chaining and into higher level, more powerful, but less flexible APIs. I haven't created an OAuth2 library yet under the Alamofire org b/c it's going to be very tricky to get right and will take a significant amount of time to build. However, that doesn't mean I'm not going to. It's certainly on my roadmap to build, but I haven't had enough time to start putting it together yet. For now, I'd recommend reading through the Stack Overflow answer and trying to roll your own using the approach and sample code documented in that thread.

Best of luck! üçª
 Thanks for the response @cnoon. I totally agree with this not being a complete retry / oath implementation, but it's easy to add to this once the response chain can be copied. I'd like to be able to gather more input from the Alamofire team as to what the desired retry implementation would look like and what the requirements are. I have seen you mention that it's in the feature backlog.

I work with a lot of projects doing consulting that all do their own abstraction on top for authentication which is frustrating, since A) Different project, different API. B) The Alamofire API is so much more expressive. I think getting some retry support into Alamofire will help a lot more than you might picture!

Here's my OAuth implementation, which has some internal abstractions, but addresses your concerns. Let me re-write it without my internal abstractions to give a better picture of what it would look like.

```
    func reauthenticateRequest(request: Alamofire.Request) -> Alamofire.Request {
        guard let HTTPRequest = request.request else { fatalError("Invalid Request") }
        // swiftlint:disable force_cast
        let authorizedHTTPRequest = HTTPRequest.mutableCopy() as! NSMutableURLRequest
        // swiftlint:enable force_cast

        if var headers = authorizedHTTPRequest.allHTTPHeaderFields, let bearerToken = self.bearerToken {
            // Add the bearer token and retry
            headers[Constants.Authorizaton] = Constants.Bearer(bearerToken)
            authorizedHTTPRequest.allHTTPHeaderFields = headers
            let authorizedRequest = Alamofire.request(authorizedHTTPRequest)
            authorizedRequest.copyResponseChainFromRequest(request)
            return authorizedRequest
        }
        else {
            // There is not enough information to authenticate, return the original request, which will 401.
            return request
        }
    }
    // APIEndpoint encapsulates headers, parameters, encoding, fetch type to help cluster like API's. It's purpose is similar to URLRequestConverable, without having to define a hostname (which always has to be static storage in the URLRequestConverablePattern)
    func request(endpoint: APIEndpoint, authenticated: Bool = true) -> Alamofire.Request {
        let headers: Dictionary<String, String>?
        let request: Alamofire.Request
        let needsAuthentication: Bool
        var requestIsReady: Bool = true

        if let bearerToken = bearerToken where authenticated == true {
            headers = [Constants.Authorizaton : Constants.Bearer(bearerToken)]
            needsAuthentication = false
        }
        else {
            headers = nil
            needsAuthentication = authenticated
        }
        request = manager.request(configuration.baseURLString, endpoint: endpoint, headers: headers)

        if needsAuthentication {
            if let authorizationRequest = authenticationRequest {
                // A re-authorization is in progress, retry when it's done
                authorizationRequest.delegate.queue.addOperationWithBlock() {
                    self.reauthenticateRequest(request).resume()
                }
                requestIsReady = false
            }
            else if canReauthenticate {
                // There is enough information to re-authenticate
                authenticateClient() {
                    self.reauthenticateRequest(request).resume()
                }
                requestIsReady = false
            }
        }
        else if authenticated {
            // If an authenticated request has a 401, reauthenticate and retry.
            request.checkForRetry() { request, completion in
                if request.response?.statusCode == 401 && self.canReauthenticate {
                    self.authenticateClient() {
                        let newRequest = self.reauthenticateRequest(request)
                        completion(.Retry(request: newRequest))
                        newRequest.resume()
                    }
                }
                else {
                    completion(.Continue)
                }
            }
        }
        if requestIsReady {
            request.resume()
        }
        return request
    }
```
 @p2 Take a look at our new [`RequestRetrier` feature](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%204.0%20Migration%20Guide.md#request-retrier) in Alamofire 4. 
  My guess is that your request you're making with Alamofire is not the same as the POSTMAN call. If they were the same, you should get a response in the completion block with the 401 status code. You should try to use the `debugPrint` functionality on the `Request` type to help you troubleshoot.

In the future, I'd suggest going to Stack Overflow with this type of question. We use the GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @JoachimK,

Thanks for the very detailed writeup! I completely understand your frustration here and agree with you overall. Because of this, I've just created PR #1099. If you could check it out and provide feedback, that would be really helpful. That PR solves not only the challenge API problem, but many others as well. I'd love to get your feedback.

I'm going to close this issue out. Please direct all further comments to #1099.

Thanks! üçª
  Yes, you will need to delete the tmp file yourself if you're concerned about leaving it in the tmp directory. Alamofire does not clean up that file after the upload completes. I'm going to put a task into our backlog to consider whether it should or not.

Cheers. üçª
  These changes have already been applied to the `swift_2.2` branch @glennrfisher. We'll merge these changes into `master` once the official Xcode 7.3 has been released.

Cheers. üçª
  Looks like you've already [roped in the Eskimo](https://forums.developer.apple.com/thread/39454) for help here. I doubt this is directly related to an issue with Alamofire, so I'd encourage you to continue debugging with Quinn and report any issues directly related to Alamofire back to this ticket.

I'm going to close this out for now since there's no action item for Alamofire. If you post any additional info here that leads us to believe there is an issue in Alamofire itself, I'll be happy to re-open and investigate further.

Best of luck! üçª
 Cool...thanks for getting back to us @fancy42!
  We publish VERY detailed release notes for each release.
- https://github.com/Alamofire/Alamofire/blob/master/CHANGELOG.md#321
- https://github.com/Alamofire/Alamofire/releases

If you continue to have issues, I'd suggest you open a question on Stack Overflow. We use GitHub for bug reports and feature requests.

Best of luck. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  If you're running the latest version of Alamofire, passing in an empty dictionary `[:]` will set the `Content-Type` to `application/json`. A parameter value of `nil` will earlier out of parameter encoding altogether.

Cheers. üçª
  Ha! Good catch @theovoss...thanks for the change!
  Interesting. This will take some investigation on our end. I don't have access to an iOS 8.x device right now, so I'll only be able to test with the simulator which isn't as helpful.
 Okay @kchromik, I've switched over to using IPv4 on iOS 8.x in ef756b00. Would you be able to test against the latest changes on `master` to see if they resolve your problems?
 Also, can we test that on an iOS8 device built on the iOS9 SDK? I don't think you want the compile-time check, but a runtime check (Which is why I thought it would be better to stick  with ipv4 for all).
 The `#available` check does provide a runtime check as well @KingOfBrian. The availability checks provide both compile time checks for API usage as well as runtime logic branching behavior.
 Ah sweet, I did not know that! Takes time to un-learn my obj-c ways.
 Okay, I finally managed to track down an iOS 8.2 device. Looks like the IPv4 changes for iOS 8 were the correct solution. Reachability monitoring is now working as expected on both iOS 8 and 9. üëçüèº
  Thanks for the offer @korzonek, but I think we'll pass on adding a badge to the top of our README that gives our project a `B` rating.
  Hi @Sahilberi, these types of questions are best suited for Stack Overflow. We use our GitHub project for bug reports and feature requests.

Best of luck. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  1) You need to use Alamofire to make your requests.
2) You need to make sure your requests are taking at least 1 second to complete, otherwise the indicator won't actually display due to the activation timer.
3) Set the activation timer and completion timer delays to zero to see them display on any request.

Hope that helps. In the future, please open issues against the actual AlamofireNetworkActivityIndicator project.

Cheers. üçª
  Thanks for the suggestion here @nicktrienensfuzz, but we'll keep the logic as is. It was originally written to ensure all three variables were available before processing the request.
  Hi @KhaledAld,

You are failing to parse the response JSON that's coming back. I would venture a guess that most likely no response data is coming back at all. Either way, you need to spend some more time debugging this issue on your own. If you're still stuck, please open a question on Stack Overflow instead of here on our GitHub project. We only use the GitHub project for bug reports and feature requests.

Best of luck. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  We won't be merging these changes into `master` until Xcode 7.3 is officially released. If you need to have these changes right now, then please continue to use the `swift_2.2` branch for now.

Cheers. üçª
  Also closed in #1085.
  You cannot change this easily @nahouto. The NSURLSession is going to choose the chunk size for you automatically. Here's a decent [thread](http://stackoverflow.com/questions/20131900/ios-how-to-increase-chunk-size-for-nsurlsession-upload-task) explaining why. 

With that said, it is probably possible to create a different buffer size if you want to go to the effort of creating a custom `NSInputStream`. Here's a [thread](http://stackoverflow.com/questions/22864565/upload-with-buffer-ios-7) detailing how you might go about it. However this is quite complicated and can lead to many unexpected issues.

> I'd highly recommend not going this route.

Cheers. üçª
  As @abunur mentioned, you need to make sure your URLs do not contain whitespace. The `URLRequestConvertible` protocol clearly states that any methods in Alamofire using the protocol as a parameter MUST conform to [RFCs 1738 and 1808](https://github.com/Alamofire/Alamofire/blob/master/Source/Alamofire.swift#L31-L42). In simple terms, this means you need to make sure your URL is valid before passing it into Alamofire.

If you use the `ParameterEncoding` enum to encode your URL, Alamofire will make sure to encode all your spaces properly for you. In the future, these types of questions are best suited for Stack Overflow. We use GitHub for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I'm not really sure what to tell you here @groovz. At this point, I can't see any actual Alamofire calls being made. Therefore, it's difficult for me to say exactly what's going on. It appears as though you've managed to deadlock the session delegate queue for a URL session (`com.apple.NSURLSession-work`), but that's just a theory at this point. Without a solid code sample or a sample project, there's very little to go on.

I'm going to close this out for now since I can't see any further action I can take. If you provide more info, I'd be happy to re-open and investigate further.

Cheers. üçª
 Hmmmm...thanks for all the info, but I still can't pinpoint any actual issue here with Alamofire. We haven't had a single report of deadlocking with parallel uploads and downloads. With the way the logic is constructed, I'm very doubtful the issue itself lies in Alamofire.

In all my networking experience, I've generally found it to be a bad idea to use a concurrent URL session delegate queue, mainly because it can lead to deadlocks. The problem is that the queue doesn't call the delegate for a single request on the same thread, it will jump threads. So two delegate callbacks you would expect to receive serially will actually happen in parallel. This can lead to really odd runtime logic and can easily lead to deadlock scenarios.

> Generally, avoid concurrent session delegate queues if possible unless you really have an extremely good reason to do so. It's much easier to keep a serial session delegate queue and then dispatch immediately when you receive the delegate call. Then you have full control.

As for what's actually causing your deadlock, I cannot be certain. As I mentioned before, I really doubt it's an issue with Alamofire because we haven't had a single report of this until now. Additionally, with what you've mentioned about changing out the session delegate queue and also making pubnub requests at the same time, I'm fairly certain this is a deadlock scenario you've created on your own end. Unfortunately, there's not much I can do to help you debug any further. The only other thing I can think of to help you is to turn off all the pubnub logic and use a serial session delegate queue and try to resolve your deadlock. You most likely won't be able to trace the root cause of it until you start eliminating some of the possible options.

Best of luck! üçª
 Cool...glad you figured it all out! üëçüèº
  You'll need to get rid of those spaces at the beginning and end of your URL string, as those are not valid URL characters. I also suggesting using our latest version, 3.2.0, to begin learning the Alamofire APIs. Your API usages appears to be out of date.
  Could you put together a quick code sample demonstrating your use case? That would make it much easier for us to come to a decision.

Thanks!
 We will not be adding a third party library as a dependency @fchaillou. That has already been discussed in great detail throughout other issues.

@KingOfBrian, I'm going to close this issue out for now. If you post feedback here, then I can gladly re-open later.

Cheers. üçª
 Sorry for the late follow up, but this is the sort of behavior that I'd like:

``` swift
request.responseJSON() { response in
    let modelResult = response.result.map { value in
        guard
            let json = value as? Dictionary<String, AnyObject>,
            let token = json["token"] as? String,
            let refreshToken = json["refresh_token"] as? String
            else
        {
            return .Failure(ServiceError.errorWithCode(.InvalidResponseContent))
        }
        return OAuthResponse(token, refreshToken)
    }
```

It's just slightly nicer than checking for error in this case, but as there are multiple transformations reads much better. I agree with you on project dependencies btw, but I think the map behavior in the atypical result object could be copied over here pretty easily.
 @KingOfBrian First, some of what you're trying to accomplish there would be better off as a custom response serializer and using the already provided API for creating your own `.response` methods. That said, I've implemented something similar as an extension on `Result` in my own app, and without further abusing `map`.

``` swift
extension Alamofire.Result {
    typealias SuccessClosure = (value: Value) -> Void
    typealias FailureClosure = (error: Error) -> Void

    // TODO: Change back to onSuccess once compiler stops being dumb.
    func ifSuccess(@noescape success: Closure) -> Result {
        if isSuccess { success() }

        return self
    }

    func onSuccess(@noescape success: SuccessClosure) -> Result {
        if case let .Success(value) = self {
            success(value: value)
        }

        return self
    }

    func ifFailure(@noescape failure: Closure) -> Result {
        if !isSuccess { failure() }

        return self
    }

    func onFailure(@noescape failure: FailureClosure) -> Result {
        if case let .Failure(error) = self {
            failure(error: error)
        }

        return self
    }
}
```

This allows the unwrapping to be chained, and has the `if` variants without capturing the underlying value. (They're named that only because the compiler couldn't tell the difference if they were overloads of the `on` functions.) 

We'll look at adding more functionality to `Result` in the future.
 I wouldnt call the map functionality abuse. It's standard result behavior across many languages, and it has come to be expected. It allows you to change the type in each chain step which is very powerful. But I agree, a custom response handler is what the code turned into.

It will be great to add more functionality to map though. If you want me to take a stab adding the standard functional methods, I'd love to!
 I'm certainly not opposed to adding this functionality @KingOfBrian. I think it could be a good addition for the functional crowd out there. If you want to take a stab at putting this together into a PR, that would be great! 

> Please make sure to add unit tests covering the common use cases.

Cheers. üçª
  In order to upload photo data, you need to extract the data out of the Photos or ALAssetsLibrary framework first, then append a body part with the image data. The fileURLs do not work the same way as files in your sandbox.

Cheers. üçª
  Hi @dalu93!

You can already do this with custom response serializers or manually parsing the response data yourself. Since responses can vary so widely for various error status codes, we cannot generalize the handling in Alamofire much more than we already have. If you have specific cases you need to handle, you'll need to use more advanced techniques to handle the errors gracefully. Please check out the [Custom Response Serializers](https://github.com/Alamofire/Alamofire#creating-a-custom-response-serializer) section of the README for more info.

Cheers. üçª
  I'm assuming you need to base64 encode your image data before uploading it. Just attaching the hash probably isn't what you're looking for. Either way, this type of question is much better suited for Stack Overflow. We use the GitHub project for bug reports and feature requests. If you already have a Stack Overflow question open, please attach a link to the question in this thread, and hopefully someone will be able to help you further.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Again, these questions belong only on Stack Overflow. We don't work through support questions on GitHub.

Best of luck. üçª
  Hi @jasminpethani,

I would suggest updating to the latest versions of CocoaPods and Xcode. That will most likely solve your issue. In the future, these types of questions are best suited for Stack Overflow. We use GitHub for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @acecilia, Alamofire does not support iOS 7 and hasn't for some time. If you need to support iOS 7, then you'll need to maintain your own Alamofire fork.

Cheers. üçª
  You need to add `upload.validate()` before `upload.responseJSON` in the `.Success` case. In the future, these types of questions are better suited for Stack Overflow. We use GitHub for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @DenHeadless,

Generally I'm against moving to a universal framework. We've had all sorts of issues with this in the past. Here are some other obvious downsides that I can see.
- Example project doesn't seem to work (obviously this is a huge problem if true)
- Another issue could be in other frameworks that use Alamofire as a dependency (such as AlamofireImage)
  - We've run into all sorts of weird dependency issues with Xcode and multiple OS's
- Can no longer not include certain files in certain targets and everything would need to be managed by `#if os()` flags.

@kylef, I'd love to get your take on this if possible.
 Thanks for putting this PR together @DenHeadless, but we've decided to not accept these changes. We're going to continue using multiple targets due to all the OS specific code in Alamofire.

Thanks again. üçª
 Just complexity. We already have all the kinks worked out by having multiple frameworks nested through several layers of dependencies. I'm not sure how using this approach would affect other libraries like AlamofireImage and all the other libraries out there that use Alamofire as a dependency and support multiple OS's.
  Hi @codesdk,

If you don't call this logic twice, it won't print out twice. I realize you don't think you are, but you must be. We have 100s of tests around this logic and have never had anyone report this behavior before. Please debug further and if you do end up feeling strongly that there truly is an issue in Alamofire, please submit a sample project to demonstrate the behavior and I'll happily re-open and investigate.

Cheers. üçª
 If you could submit a PR with a test reproducing the problem @liltimtim, I'll be more than happy to investigate. However, with the code formatting above and the PDFs, I can't possibly recreate the behavior you're seeing.
 Awesome, thanks @liltimtim! And yes, by PR I meant "Pull Request".
 Excellent! Thanks for letting us know @liltimtim. üëçüèº
  Hi @citrusbits,

First of all, none of the code you posted is calling any Alamofire APIs, so that doesn't help us. If you check out these [tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/ResponseSerializationTests.swift#L318-L356), you'll see this error is sent when using a JSON response serializer with `nil` or empty data.

In the future, please open a question on Stack Overflow. We use the GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  https://github.com/Alamofire/Alamofire#security
 Oh man @grosch...you need to chill out. Your reply here is certainly not appreciated.

I pointed @alessiofx to the docs to make sure he knew they were available. There is not nearly enough detail in the question to even know where to begin to help troubleshoot. In those cases, we generally point people to the docs, and they will ask additional questions if they still don't have the info they need.
 Thanks @grosch...the Stack Overflow question was MUCH better. I put together an answer on there. If you end up getting that working and feel it's something that really belongs in Alamofire, I'd love it if you'd open up a feature request with as much info as possible. I already have some ideas on how we could support it, but I really just need a way to test the implementation.

Cheers. üçª
  Thanks!
  You should print out the `response.data` in the failure case using:

``` swift
if let data = response.data {
    let json = String(data: data, encoding: NSUTF8StringEncoding)
    print("Failure Response: \(json)")
}
```

In the future, please open these types of questions on Stack Overflow. We use GitHub for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @yniesp, everything is building properly. Here's the output from the Alamofire 3.2.0 release:

``` bash
cnoon:~/Desktop/Tester$ carthage update
*** Fetching Alamofire
*** Checking out Alamofire at "3.2.0"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.NXtvLt.log
*** Building scheme "Alamofire OSX" in Alamofire.xcworkspace
*** Building scheme "Alamofire tvOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire watchOS" in Alamofire.xcworkspace
cnoon:~/Desktop/Tester$
```

And here's the output from HEAD on `master`:

``` bash
cnoon:~/Desktop/Tester$ carthage update
*** Fetching Alamofire
*** Checking out Alamofire at "59ef4f5da3fdba44649026603c6512fd6c5dabd0"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.4pVzap.log
*** Building scheme "Alamofire OSX" in Alamofire.xcworkspace
*** Building scheme "Alamofire tvOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire watchOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
cnoon:~/Desktop/Tester$
```

These were both built with `xcodebuild 7.2.1` and `carthage 0.12.0`. As for the Travis builds, something is going on with Travis. It's extremely unstable right now, so I wouldn't rely on Travis to tell you anything useful.

Cheers. üçª
  This question has been asked and answered many times. We only support one common form of collection encoding. For other types, you need to use the `.Custom` encoding. The `ParameterEncoding` methods have been publicly exposed to make it easier to do so.

For more info, please see https://github.com/Alamofire/Alamofire/issues/589 and https://github.com/Alamofire/Alamofire/issues/965.

Cheers. üçª
  This isn't true. What happens is the `Bool` bridges to an `NSNumber` when converted to an `AnyObject`. When you print out an `NSNumber` created from a `Bool`, it prints out `0` or `1`. However, once you run it through `NSJSONSerialization`, it encodes it as either `false` or `true`.

Cheers. üçª
 Oh my apologies, I missed the `.URL` encoding parameter type. I'm going to re-open this and investigate further.
 Okay @pheuberger, I managed to dig into this a bit more. The behavior you are seeing is intended. The reason has to do with the fact that all the parameters bridge over to Objective-C. The parameter encoding logic for URL encoding relies on the `CustomStringConvertible` protocol to covert the `AnyObject` to a string representation. In the case of an `NSNumber`, this will always default to `0` or `1` in the case of a `Bool`.

``` swift
let boolValue = true
print(boolValue) // outputs `true`

let bridgedBool: AnyObject = true
print(bridgedBool) // outputs `1`
```

In order for us to change this to `true` or `false`, we'd have to implement some fairly complicated and fragile logic into the ParameterEncoding enum that I'm not comfortable doing. Additionally, this is the behavior that all other users currently expect, so it wouldn't be a backwards compatible change in any way. For now, I'd recommend you continue using your current solution to turn the `Bool` values into Strings before encoding.

Once Swift 3 is released, we'll re-investigate as to whether parameters should come in as `[String: AnyObject]` dictionaries or `[String: Any]` dictionaries allowing everything to stay 100% swift.

Cheers. üçª
 @AppsTitude The unfortunate fact of the matter is that there is no single standard for encoding parameters in a URL query. Some of the standards that do exist (largely server implementations) vary between `true`/`false` and `1`/`0`. Also, when implementing the new workaround for Swift 3, we matched our old behavior that used `1`/`0` so as not to break backward compatibility.   If you'd like to validate the response codes, add `.validate()` to your `Request` chain. Check our docs for info on how to customize this function. 
  These changes started with me experimenting with the ideas in #1029, then became something pretty awesome!

This PR adds the ability for Alamofire to track the timings of a `Request` throughout it's entire lifecycle with virtually zero overhead. The `Timeline` object stores all the timing info about the `Request` and is delivered as part of the `Response` object. The timings are collected at various points throughout the lifecycle of the request.

Alamofire can now report the latency, request duration and total duration of any `Request`. I also added `CustomStringConvertible` and `CustomDebugStringConvertible` conformance to the `Timeline` to make it really easy to print out the info.
 cc @jshier, @kcharwood, @kylef for review
 I'll add a section to the README about this once everyone is on board that this is a good set of changes to put in.
 Thanks @alimoeeny! It was definitely fun to put together.
 :+1:

@alimoeeny I do logging in my custom `.responseObject` extension, taking the closure that comes in, adding my logging call, and passing the result the actual serializer. I imagine you could do the same, especially if you have a custom response closure already.
  This PR adds the `NetworkReachabilityManager` class to the project along with full coverage of the APIs. All public APIs have docstrings and I also added a section to the README with tips and tricks. The class is fully available on `iOS`, `OSX` and `tvOS` but not `watchOS`. The podspec has been updated to reflect the `watchOS` omission.

One important callout is that the default socket address uses IPv6. Other than that, the logic is fairly similar to `AFNetworking`. I added a bit more functionality around the `Listener` closure by allowing you to specify the `dispatch_queue_t` the closure is called on.
 cc @jshier, @kcharwood, @kylef for review
  Hi Ronak,

These are all fantastic questions. At the moment, Alamofire does not have very strong support for background downloads. You observations are all perfectly valid. Let me try to answer your questions one-by-one.
1. Yes, this is a realistic case. You need to be able to handle this case properly, otherwise you can end up in a strange app state when you relaunch.
2. If you want to use Alamofire for background downloads, you need to override the `SessionDelegate` task closures. When your app gets relaunched, you need to recreate your `SessionDelegate` and wire up the closures, then recreate the background URL session with the same identifier. This is more or less what you would do if you weren't using Alamofire. What you MUST remember is that you cannot rely on `response` closures that were attached to a `Request`. Since your app was terminated and relaunched, the `Request` objects no longer exist.
   
   > To use Alamofire with background downloads, you currently need to not use the `response` closures and override the `SessionDelegate` closures.
3. You don't need to do this. You only need to recreate your background URL session when your app delegate is notified to `application:handleEventsForBackgroundURLSession:completionHandler:`. An easier approach may be to recreate the background URL session when your app is launched. But some people may feel that you should instead create the URL session lazily. Your call either way.

So, in summary, you can absolutely use background URL sessions with Alamofire. There is not as much convenience yet as there could be, but it can certainly be done. You need to make sure you don't use the `response` closures, and you need to override the task override closures in the `SessionDelegate`.

> _Full Disclosure:_ If you are just downloading files in the background, I'd recommend you just create your own `NSURLSession` and `NSURLSessionDelegate` and wire it up yourself. The URL requests are easy to build since you really only need to pass a URL. There's just too much overhead on Alamofire for this use case. The Alamofire APIs are also designed around closures chained to the `Request` which doesn't work with background sessions.

Additionallly, this is already being worked on in #981. I'd encourage you to check it out and provide some feedback. I haven't had time to review that PR yet myself.

Thanks for the awesome question. Hopefully that helps clear some things up. Cheers. üçª
 I don't understand your reasoning here @ronak2121. First off, I don't understand what you mean by multiplexing in #1. As for #2, I don't understand what that accomplishes. Additionally, recreating requests is only easy if you have them completely abstracted and all callbacks are done using a delegate pattern, not closures.
 While I appreciate your feedback here, I respectfully disagree. There are MANY other complex things going on here. As mentioned before, we've put this into our backlog slated for Alamofire 4.0 to make sure we handle things properly. We'll take all this feedback into consideration when we start working through our actual solution.

Cheers. üçª
  Alamofire does not support web sockets. However, it does support `NSURLSessionStreamTask` which could be used to implement web sockets. There are currently no plans to add support for this.

Cheers. üçª
  Thanks for putting this together @vivid-cieslak! I cherry picked it into `master` in 59ef4f5d.

Thanks again! üçª
  These are all very valid points @popwarfour. This particular behavior has a lot of history, but your description and reasoning here is spot on. We're discussing this right now and will get back to you shortly. Thank you for the detailed write up!
 Okay @popwarfour, thanks for your patience. We had a good discussion on Slack about this topic and have decided to revert the changes in 75c269ae. Instead, we are now properly handling the case of an empty query string in URL encoding. This has been fixed in 8b618c76 if you want to check it out. These changes will be available in the 3.2.0 which we are working on right now.

Thanks again for your excellent description here. We've been fighting this issue ever since that change was made. You managed to get to the root issue which made it much easier to work out the proper solution.

Cheers. üçª
  You are most likely being hit by ATS. Please see this [section](https://github.com/Alamofire/Alamofire#app-transport-security) in our README. Also, these types of questions are best suited for Stack Overflow. We use GitHub for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This future will be added to Alamofire in our next release. It is not currently available.
  Why not use a ServerTrustPolicyManager instead here? Much easier to work with. Additionally, these types of questions are best suited for Stack Overflow. We use GitHub for feature requests and bug reports.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @oflannabhra!
  Hi @katunch,

I just verified that everything is working properly with the latest release of Carthage and Xcode 7.2. Here's the output using the same `Cartfile` you have.

``` bash
cnoon:~/Desktop/Tester$ carthage update
*** Fetching Alamofire
*** Checking out Alamofire at "3.1.5"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.kj6RLc.log
*** Building scheme "Alamofire OSX" in Alamofire.xcworkspace
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire tvOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire watchOS" in Alamofire.xcworkspace
```

What you need to do is update your installation of Carthage and try again. All you need to do to do that is the following:

``` bash
cnoon:~$ brew update ; brew doctor
cnoon:~$ brew upgrade carthage
```

Best of luck! üçª
 You also want to make sure you're running the latest version of Xcode and that `xcodebuild -version` reports that latest version as well.
 I believe this ends up happening when you don't have an iOS simulator installed with a connected watch simulator. Please see this [thread](https://github.com/Carthage/Carthage/issues/790) for more info. If you are still experiencing issues, I'd suggest filing an issue with the Carthage project.
 Excellent @mmizutani üëçüèº
  Hi @terenzeyuen,

Short answer is no. You'll need to make the requests one-by-one and manage to completion of all downloads at the client level. With that said, I'd recommend you check out [AlamofireImage](https://github.com/Alamofire/AlamofireImage). It does have the ability to batch download a list of images.

Cheers. üçª
  This is the expected behavior @foffer. You need to make sure your `URLString` conforms to RFCs 1738 and 1808. Otherwise you will not be able to construct a valid `NSURL` as you have seen. This is documented clearly in the [URLStringConvertible](https://github.com/Alamofire/Alamofire/blob/master/Source/Alamofire.swift#L31-L42) docstrings.

``` swift
public protocol URLStringConvertible {
    /**
        A URL that conforms to RFC 2396.
        Methods accepting a `URLStringConvertible` type parameter parse it according to RFCs 1738 and 1808.
        See https://tools.ietf.org/html/rfc2396
        See https://tools.ietf.org/html/rfc1738
        See https://tools.ietf.org/html/rfc1808
    */
    var URLString: String { get }
}
```

I'm not completely sure what you're use case is, but if you can, you should leverage the `ParameterEncoding` enumeration encoding which can handle all this for you to ensure your URL is properly encoded.

Cheers. üçª
  Hi @gaganpsinghkrishnais, these types of questions are better suited for Stack Overflow. We use GitHub for feature requests and bug reports.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Alamofire is a wrapper around the Cocoa URL Loading System, as mentioned in the [advanced usage](https://github.com/Alamofire/Alamofire#advanced-usage).

I think what you are looking for is already available there:

> ## Advanced Usage
> 
> > Alamofire is built on `NSURLSession` and the Foundation URL Loading System. To make the most of this framework, it is recommended that you be familiar with the concepts and capabilities of the underlying networking stack.
> 
> **Recommended Reading**
> - [URL Loading System Programming Guide](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html)
> - [NSURLSession Class Reference](https://developer.apple.com/library/mac/documentation/Foundation/Reference/NSURLSession_class/Introduction/Introduction.html#//apple_ref/occ/cl/NSURLSession)
> - [NSURLCache Class Reference](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLCache_Class/Reference/Reference.html#//apple_ref/occ/cl/NSURLCache)
> - [NSURLAuthenticationChallenge Class Reference](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLAuthenticationChallenge_Class/Reference/Reference.html)
 Hi @skington, what you are asking us to document is not even possible. You cannot make your own requests. The `Manager` instance is responsible for creating `Request` objects and vending them back for inspection. The reason for this design is the fact that Alamofire wraps the URL Loading System as @kylef mentioned earlier.

I would recommend reading the docs that @kylef posted, then read through the Alamofire README a second time. All the information to make all different requests is in there. You cannot dive straight into Alamofire without understanding the URL Loading System and how it works. Alamofire is a convenience layer on top of the Apple APIs making networking easier and more convenient, but it is not a replacement. The APIs work very closely together which is why it's important to learn both.

I'm going to close this issue out for now. If you have some more specific requests that you would like to see us add, I'd be happen to re-open if they seem like a useful addition for the community.
  @donpironet You'll need to keep a reference to your manager around. You requests are being cancelled because the manager you're using is being deallocated. I like to use a `static let sharedManager` in my `Manager` subclass to maintain a single instance.
 Because it's not static. A `private let` is just an instance variable, one that's deallocated with the instance. Create a `static let sharedManager = RegisterManager()` and use it for your request calls (i.e. `RegisterManager.sharedManager.request()`).
  Everything actually works as you would expect once it goes through `NSJSONSerialization`.

``` swift
import Foundation

var params = [String: AnyObject]()
params["test"] = "testString"
params["b1"] = true

print(params)

let data = try! NSJSONSerialization.dataWithJSONObject(params, options: .PrettyPrinted)
let json = String(data: data, encoding: NSUTF8StringEncoding)
print(json)
```

What you're seeing when you print the dictionary is the result that the bridged `NSNumber` returns from `description`. All is good. üëçüèº
  You need to pass the headers in the `request` method directly, not set them on the configuration. You can also set them in the configuration if you create a custom `Manager`. But your best bet is to use the `headers` parameter in the `request` method.

Best of luck! üçª
  Hi @dinya007, thank you for your willingness to contribute! I think at this time that we'd rather not add this particular change since we'd rather direct everyone to leverage the `ParameterEncoding` types, but please keep the ideas coming!

Cheers. üçª
  Excellent @eriktelepovsky! 

I'm going to close this issue out @pradeep-chauhan. There isn't much to go on here and our test suite is working fine. If you can provide some more details on this particular issue, I'll be happy to re-open.

Cheers. üçª
  Thanks!
  Hi @adamjweaver, the reason that it is no longer being called is that we no longer call the `.Custom` closure in the event that there are no parameters being passed in. This was changed in the `3.1.4` release. However, due to several issues being opened on this topic, we're debating as to whether reverse the logic. Please hold tight for now while we figure this out. For now, you'll need to stay on the 3.1.3 release unless you can find another workaround.

We don't intend the `.Custom` encoding to be used unless you actually have parameters to encode. However, we've had multiple reports of users using this for other things than what it was intended.
 Okay @adamjweaver, thanks for your patience. We've decided to revert the changes in 75c269ae and instead handle the case of an empty query string properly for URL encoding. I've fixed up the issue in 8b618c76 if you want to check it out. These changes will be available in the 3.2.0 which we are working on right now.

Cheers. üçª
  Hi @viri, my apologies for not getting back to you sooner. I'm glad you found a workaround. As for your authentication issue, I'm not quite sure what the problem was. You didn't post enough code for me to be sure you weren't making the request wrong. My best guess is that your credentials created by calling the authenticate were failing when the challenge occurred which was triggering the error. However, without some more code to investigate, I can only speculate.

I'm going to close this out for now since you were able to resolve your issue. Cheers. üçª
 Alright @viri, could you please post a full code sample (not just the `responseData` closure) and also the error you are seeing? We need more info to go on here.
 Thanks for all the info here @virl. Now I understand exactly what your concerns are and why you are seeing the behavior you are. This is NOT a bug. This is the exact behavior you should see. What happens when there is an authentication challenge is the following:
- Request is made
- Server sends back authentication challenge for basic auth
- Alamofire provides credentials provided by `authenticate`
- Credentials are sent back to server
- Server rejects credentials and sends back authentication challenge again
- Alamofire cancels the request since authentication has failed
- The request is completed with a cancellation error and no response

There is never a response generated in this scenario, which is why you won't see one when an authentication challenge fails. Hopefully that helps clarify things.

Cheers. üçª
  Thanks for putting this together @Baza207! I cherry picked the commit into the new `swift_2.2` branch in 3cf3614c. We'll maintain this separate branch until Xcode 7.3 is officially released.

Thanks again! üçª
  Hi @alimoeeny, thanks for the awesome idea! I started playing around with different ways to make something like this to work and it turned into PR #1054! If you could check that out, I'd certainly appreciate it.

I'm going to close this issue out for now. Please redirect all comments to #1054 from here on out. Thanks! üçª
  Please update to 3.1.5 and try to reproduce again, as I was unable to reproduce using 3.1.5 on the 9.2 6s simulator. I get the result: `T%C3%BCrkiye`.
 Hi @ergunkocak, I'm going to close this out since we cannot reproduce. If you can create a good repro case I'll be happy to re-open.

Cheers. üçª
  Alamofire will escape your parameter strings if you pass your parameters to one of the `.URL` `ParameterEncoding` types. Or you could call the parameter escaping used by Alamofire manually by calling `ParameterEncoding.URL.escape()`

You can also pre-escape your URL strings using the non-deprecated `.stringByAddingPercentEncodingWithAllowedCharacters()` and one of the [URL character sets](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSCharacterSet_Class/index.html#//apple_ref/doc/uid/20000157-SW12). Depending on what part of the URL your escaping, you'll use a different character set.
  Thanks for letting us know. We'll get this fixed ASAP.
 @jshier has already created one approach in #1027. I'm going to close this issue out for now. Please direct all future comments to #1027. üëçüèº
  Your `Content-Type` header is being overwritten by the one generated by the `.JSON` encoding type. To set the header while still using the result of `.JSON` encoding, use the `.Custom` encoding, like this:

``` swift
request(.POST, URLString, parameters: parameters, encoding: .Custom({ (inRequest, parameters) -> (NSMutableURLRequest, NSError?) in
            let JSONEncodedRequest = ParameterEncoding.JSON.encode(inRequest, parameters: parameters).0
            JSONEncodedRequest.setValue("application/vnd.api+json", forHTTPHeaderField: "Content-Type")

            return (JSONEncodedRequest, nil)
        }), headers: nil)
```

This should accomplish what you want. And if you have more than one or two requests in your app, I would recommend following the `URLRequestConvertible` router pattern [mentioned in our documentation](https://github.com/Alamofire/Alamofire#crud--authorization) so that you don't need to keep replicating this logic. 
 Thanks @jshier!
  Yes, you'll need to remove or move the old file first. Alamofire plays it safe and doesn't do it automatically.
  I have answered this question [on StackOverflow](http://stackoverflow.com/questions/34934369/alamofire-serial-requests).
  If you're seeing a crash, a code sample which reproduces it would be a good starting point for us to start investigating this issue. As well, the actual crash report would help in determining what lead to the crash.
 Your example doesn't compile, as parameters is `[String : AnyObject]`. I tried this and it didn't crash:

``` swift
request(.GET, "https://httpbin.org/get", parameters: ["data" : NSData()], encoding: .URLEncodedInURL, headers: nil).responseString { response in
            print(response)
}
```
 Hi @fulldecent, unfortunately in this case there's nothing we can do to help you. You are passing in parameters that cannot be represented in JSON. You cannot store raw data like that in JSON. It needs to be in the form of a valid JSON object type. It's really a bummer that `NSJSONSerialization` does not handle this case better, especially considering it throws in the event of encountering an error. I just verified that your parameters will crash.

I'd suggest you do two things. 1) Make sure you only create valid JSON objects as parameters. 2) File a radar with your sample code. This should not crash but should throw an error.

Cheers. üçª
  Such a large feature requires careful planning and consideration, so it's certainly not a short term feature. However, we are tracking it internally and will take it into consideration for future versions.
 In the meantime, here's a [post](http://stackoverflow.com/questions/28733256/alamofire-how-to-handle-errors-globally/28748683#28748683) where I documented how you "could" implement OAuth2 yourself.
  If you're having such an issue, and can't cut down on the amount of data to be serialized, you can always create your `NSURLRequest`s asynchronously before issuing the Alamofire `Request`. A quick and dirty version might be: 

``` swift
dispatch_async(dispatch_get_global_queue(QOS_CLASS_DEFAULT, 0)) {
    let request = Router.GET(parameters: bigParameters).URLRequest
    Alamofire.request(request)
}
```

However, we'll keep this request in mind in the future.
 Hi @Joost-Elements, if you're encoding a giant payload, you need to either handle it asynchronously yourself and then hand it over to Alamofire, or call Alamofire asynchronously like @jshier documented. Serializing this asynchronously would require ALL the public APIs for `Request` creation to use completion closures which would seriously complicate things. It's certainly best for this rare case to push the responsibility down to the clients.

Cheers. üçª
  Without more detail about what you've tried and the specifications of you backend service, it's hard to say where the issue is here. To get a broader audience for you question, use StackOverflow and tag Alamofire while providing as much context and detail you can about your backend service.

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Could you be more specific? Alamofire provides both a `.progress` property on `Request` as well as the `.progress()` closures which can provide the progress details usually provided by `NSProgress`. We're also tracking additional progress report features in our backlog. However, a more precise explanation of your requirements would help us refine what users are looking for in this area.
 Hi @fulldecent, thank you for your suggestion. This is not a change we will be making though for a couple reasons. 

First off, that protocol is only for objects reporting a single progress object. A manager is going to be reporting progress on all network activity. If each request creates a child progress object, you won't be able to track the progress on a per request basis anymore. Everything just gets MUCH more complicated.

Additionally, the progress APIs from `NSURLSession` don't work this way either. Progress is measured per request and reported back in that same manner. Collating the progress is not something Alamofire knows how to do since it doesn't know the relationship between requests.

Cheers. üçª
  Your code sample is too incorrect to tell what type of parameters you're actually trying to POST. Asking this question on StackOverflow with a full code sample and tagging Alamofire may provide you better answers.

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @iDuke I'm closing this issue for now, as you have an answer. If you need more help, feel free to open a question on StackOverflow and tag Alamofire. 

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  The mysteries of Xcode's UI are likely a better question for StackOverflow, but I believe the README is a bit misleading in this instance, as it may not have been updated for the watchOS and tvOS targets. So I think it's referring not so much to the top or bottom group, but merely the spatial relationship between the iOS and OS X frameworks in a single one of those lists. I'll make a note to get that updated.
  Thank you for the pull request @hwittland. Unfortunately, we don't think this is a good change to make to the core Alamofire logic. It already defaults to the main queue when a custom one is not provided. Additionally, the queue can easily be overridden already by calling the `response` method with a queue and response serializer.

Thanks again. üçª
  I believe you're technically correct, which is the best kind of correct, but such a change in vocabulary would have a rather wide ranging impact on this project, given that the term isn't just used in documentation but the names of classes and functions, both currently and historically (and shared with the AFNetworking library). Having both terms, some in documentation and others in code would likely be more confusing than clarifying. So this is unlikely to change, but we'll keep it in mind for the future.
 This is not the first time this question has been asked. More details in https://github.com/Alamofire/Alamofire/issues/674.
  @MarcSteven You'll need to provide the full code for your `MSGistRouter` type, as well as the compiler error given, for anyone to have success in diagnosing your issue. 
 Glad you got it working.
  Build configurations and external dependencies can be tricky to get right in Xcode. You'll likely have better luck asking such a question on StackOverflow, tagging Alamofire, and providing more detail, like how you're integrating Alamofire and whether you have other dependencies. 

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @samirGuerdah...thanks for the pull request! Unfortunately, these changes are too heavy handed and should not be merged. This attribute is only to be used in cases where you actually want to throw up a warning if the return value is not used. For example, we don't want to throw a warning on the `Alamofire.request()` method if you don't use the returned `Request`.

Thanks again. üçª
  You seem to be having trouble properly communicating with whatever backend you're using. Asking such a question on StackOverflow, tagging Alamofire and providing some code showing how your request is being issue with likely lead to better results. If you do find a bug with Alamofire, please open a new issue and provide a code sample that shows the issue.

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You'll need to provide more detail for anyone to be able to answer your question. You'll also have better luck asking such a question on StackOverflow and tagging Alamofire.

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  The line `queue ?? dispatch_get_main_queue()` uses Swift's nil coalescing operator, [as described in Swift's documentation](https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/BasicOperators.html), to use the main queue if none is provided. We also have many tests around this feature and in fact the library wouldn't even function if the completion handler was never called. So it's likely this is an issue with your code, in which case you'll likely have better luck finding a solution using StackOverflow and tagging Alamofire, as recommended by our Contributing document. If you do think you've found a bug in the library, feel free to open another issue with code that shows the bug.

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  It looks like you're having trouble figuring out how to communicate with your backend (or really, a local version of such). You'll likely have much better luck asking such a question on StackOverflow, as recommended in our Contributing document. If your issue is a bug in Alamofire, feel free to open another issue with as much detail as you can provide so we can try to debug the issue.

# 

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  In order to diagnose or trouble shoot this issue, we'll need your crash log and your calling code. 
 You cannot provide an invalid `NSURL` when using the `download` API. Alamofire will try to move the temp file to the file URL you have provided. You are intentionally providing a bad URL which is crashing NSFileManager most likely.
  Add some delay to your loop, or perhaps use `dispatch_after` or an operation queue so you're not sending requests really quickly?
 I'm with @kylef on this one @Jonovono. When receiving a 429, you should retry using an exponential back off implemented with `dispatch_after`.

Also, these types of questions are generally better suited for Stack Overflow. Cheers. üçª
  @Chatatata I think that "NS'ish" class you mention belongs in Foundation, and should be implemented there and not inside Alamofire. In particularly over at https://github.com/apple/swift-corelibs-foundation/blob/master/Foundation/NSURLSession.swift and https://github.com/apple/swift-corelibs-foundation/blob/master/Foundation/NSURLProtocol.swift.

Apple mention on the [Swift corelibs Foundation README](https://github.com/apple/swift-corelibs-foundation#part-of-swift-30) that they aim for implementation parity with Darwin's Foundation for Swift 3.0: 

> Our primary goal is to achieve implementation parity with Foundation on Apple platforms. This will help to enable the overall Swift 3 goal of portability.

Alamofire also uses libdispatch which is not yet available on Linux [from swift.org](https://swift.org/core-libraries/#libdispatch):

> libdispatch is currently available on all Darwin platforms. This project aims to make a modern version of libdispatch available on all other Swift platforms. To do this, we will implement as much of the portable subset of the API as possible, using the existing open source C implementation.
 Well said @kylef. I'm going to close this issue out since support needs to be built into Swift Foundation, not Alamofire directly. 

Cheers. üçª
  Hi @ski081,

I can't spot anything obviously wrong in your sample code. I'd recommend checking out the [tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/ManagerTests.swift#L202-L280) we have verifying this behavior. If that doesn't help you spot your issue, then I'd suggest opening a question on Stack Overflow with more info.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @renatop7 What does  `.description` print for your `Request`? That should tell you what method is being used.  Using `.debugDescription` will give you a curl command you can run to see any behavioral differences.
 If you take a look at the difference between what's printed when using your router and when using the direct call, you should be able to see any differences that are causing your backend to behave different. As you can see, Alamofire is generating the correct method type. 

I'm closing this issue for now. If you need more support, create an issue on [StackOverflow](http://stackoverflow.com) and tag `Alamofire` and the community there will help you out. However, if you find an Alamofire issue, feel free to open another issue here.
  Hi @Hokila,

Questions like these are best suited for Stack Overflow. We use the GitHub project for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  @itchingpixels Thanks for this! However, we'll need to do a much more comprehensive investigation to support this feature. We are tracking automatic retry as a feature in our backlog, so it's possible we'll support this in the future.
  I put together a fairly detailed [code sample](http://stackoverflow.com/a/28748683/1342462) on Stack Overflow documenting this. Hopefully that helps get you going in the right direction. If you need further assistance, then I'd suggest opening a new question on Stack Overflow.

Cheers. üçª
  There certainly is.

``` swift
Alamofire.upload(
    .POST,
    "https://httpbin.org/post",
    multipartFormData: { multipartFormData in
        multipartFormData.appendBodyPart(fileURL: unicornImageURL, name: "unicorn")
        multipartFormData.appendBodyPart(fileURL: rainbowImageURL, name: "rainbow")
    },
    encodingCompletion: { encodingResult in
        switch encodingResult {
        case .Success(let upload, _, _):
            upload.progress { bytesWritten, totalBytesWritten, totalBytesExpectedToWrite in
                print(totalBytesWritten)
            }
            upload.responseJSON { response in
                debugPrint(response)
            }
        case .Failure(let encodingError):
            print(encodingError)
        }
    }
)
```

üëçüèº
 Your best bet would be to try to [suspend](https://github.com/Alamofire/Alamofire/blob/master/Source/Request.swift#L154-L156) the `Request` which in turn calls [suspend](https://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLSessionTask_class/#//apple_ref/occ/instm/NSURLSessionTask/suspend) on the `NSURLSessionTask`. The docs for the `suspend` method on the task state as follows:

> A task, while suspended, produces no network traffic and is not subject to timeouts. A download task can continue transferring data at a later time. All other tasks must start over when resumed.

While this will technically pause the upload, I don't believe it will be able to resume the upload where it left off. It will inherently restart the upload from the beginning when it is resumed. I've never actually tried this myself, so I'd be interested to see how it works.

With that said, you can certainly resume uploads if your server supports it. There's just not any simple built-in way in Apple's or Alamofire's APIs to do so. Check out this [thread](https://developers.google.com/youtube/2.0/developers_guide_protocol_resumable_uploads) for more info.
  You need to extract the parameters from each case in the `Router`, then pass them into the `encode` method. Right now, you are passing `nil` into your `encode` method which is why it won't work properly.

In the future, you should ask these types of questions on Stack Overflow. We use our GitHub project for feature requests and bug reports.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 That code shouldn't even compile. You need to change this:

``` swift
let request = NSURLRequest(URL: URL!.URLByAppendingPathComponent(result.path))
```

to this:

``` swift
let request = NSMutableURLRequest(URL: URL!.URLByAppendingPathComponent(result.path))
```
 Yep...that would do it! Glad you figured it out. üëçüèº
  Hey thanks!

As for your issue, have you considered not using the Alamofire shared instance of the `Manager`? That is really only intended for simple use cases and for demonstration purposes. In general, I would expect production ready apps to configure a custom `Manager` with all the bells and whistles (customized URL session configuration, custom URL cache, etc.). Would it be possible in Moya to create a custom `Manager` instance that takes a configuration flag as to whether `startRequestsImmediately` should be set to `true` or `false`?

Setting up a custom instance of the `Manager` to match the shared instance is as simple as:

``` swift
let configuration = NSURLSessionConfiguration.defaultSessionConfiguration()
configuration.HTTPAdditionalHeaders = Alamofire.Manager.defaultHTTPHeaders

let manager = Alamofire.Manager(configuration: configuration)
manager.startRequestsImmediately = false
```

That seems like the best option to me at the moment. Adding the `startRequestsImmediately` to the top-level APIs certainly would work, but seems heavy handed. We're trying to keep those top-level APIs as simple as possible by avoiding any additional parameters.
 Sounds good @ashfurrow. I think it's also a great choice to use DI in this case and have Moya be able to take in a pre-configured `Manager`. That gives Moya users the flexibility to configure everything they should need. üëçüèº
  It was closed by the original creator of the issue. If you having issues, please open a question on Stack Overflow. If you have found a potential bug in Alamofire, please open a new issue on GitHub.

I'm going to lock this issue down.
  Hi @tokorom,

This behavior is intended. The `.Custom` parameter encoding case should only be used for creating a custom parameter encoding for the URL request, nothing else. It doesn't logically make sense to be customizing all different parts of the URL request inside of a parameter encoding method. It should only customize the parameters.

> Please see #954 for more info about the change.

Instead, you should create your own URL request manually and customize as needed. You can still use the `ParameterEncoding` encode method, then customize the returned mutable URL request as needed. Once you are finished, you can pass it to the `Manager.request` method to execute the request.

Hopefully that all makes sense.

Cheers. üçª
  Thanks for putting this together @tokorom...much appreciated! I merged a slightly modified variation of your changes in 08cf2695 while still giving you attribution. Thanks again for putting this together! üçª
  Thanks for putting this together @dapenggao! I merged a slightly modified version of your changes in fa5a10d2 while still giving you attribution. You need a `prefix(6)` to maintain the same logic. I also pulled the `quality` into a separate local variable to make it a bit easier to understand.

Thanks again! üçª
  Thanks for putting this together @mwoollard! This is going to take me a while to dig through everything you have put together and wrap my head around everything. Please be patient with us while we evaluate this PR. Thanks!
 I haven't forgotten about this @mwoollard. Hope to get to it soon!
 Okay @mwoollard, I finally managed to make it through your PR. Unfortunately, I don't think these changes or this approach should be adopted into Alamofire. These changes are quite involved and don't solve the core issue which is that all the closure logic is still being dropped.

When we add better support to Alamofire for background sessions, we have to address the fact that all the public APIs currently only serve `default` and `ephemeral` configurations. Closures simply don't work with background sessions. Just FYI, we've slated better background session support for Alamofire 4 in our Trello backlog.

Thanks again for all your work here. All the best. üçª
  That is the expected behavior. It explicitly calls that out in the documentation.
  Hmmmm...not sure off the top of my head. I really doubt it's actually an issue with the Alamofire framework. I would be more inclined to guess it has to do with the way you added the Alamofire framework to your framework target and/or your test target. I would guess you don't have the linked frameworks set up quite right.

If you can verify that everything is configured as expected, then I would suggest filing an issue with the Carthage project. They would certainly be better equipped to help you troubleshoot. If you do in fact find an actual issue with our project settings for the framework, please provide more info and I'll be happy to re-open this issue and continue to investigate.

Cheers. üçª
  Hi @dickwu,

My guess at this point is that you're getting bit by ATS. Here's a few tips:
- Check out our documentation in the [README](https://github.com/Alamofire/Alamofire#app-transport-security). This will most likely fix up your issue.
- Dig through all the info in #876. There's a TON of great info in that issue about ATS and how to wield it.
- Finally, you should stop using self-signed certs. Check out Let's Encrypt like @ntnmrndn mentioned. üëçüèº

If you still cannot figure it out, I'd suggest opening a question on Stack Overflow.

Best of luck! üçª
  At the moment, there are no plans to build this type of feature. With that said, I just added a card to our Trello backlog to discuss this further with the ASF.

Cheers. üçª
  Hi @MarcSteven, I'm sorry you were receiving the error. Since there are thousands of people using Alamofire and CocoaPods together without issues, I'm going to assume you were running into an issue with your local setup and possibly your project.

We have fairly detailed instructions in our [README](https://github.com/Alamofire/Alamofire#cocoapods) that should help you iron out your issue. Another useful tip is to make sure your CocoaPods installation is up-to-date and that your Xcode Command Line Tools is set properly. Beyond that, I would encourage you to open a question on Stack Overflow to get further assistance. We use our GitHub project for bug reports and feature requests.

Cheers. üçª
  Version 1.3.1 and below support iOS 7, you may use the 1.x versions as mentioned in the 1.x READMEs: https://github.com/Alamofire/Alamofire/tree/1.3.1

Version 2.0 and onwards is iOS 8+.
  I'm going to close this issue out. Please provide more details in the future @cloudjanak so we know what it is you are actually asking or suggesting. Cheers.
 You cannot reuse the session after you have invalidated it. You will have to create a new Manager after invalidation to continue making requests.
 I've already answered your question on Stack Overflow. You need to invalidate the session, then you need to create a new `Manager` instance and make requests through that.
  Hi @sebastienvermeille,

We have many tests and thousands of users that are not experiencing this problem. Most likely this is an issue with the way you are forming your response or with your server. In general, these types of questions are best suited for Stack Overflow. We use the GitHub project for bug reports and feature requests.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Agreed @ntnmrndn. 

Alamofire does not actually modify the data coming back from the server in any way @sebastienvermeille. If it is changing, it is not Alamofire that is doing it. The sample code you posted simply makes the request using an `NSURLSession`, and uses `NSJSONSerialization` to parse the response data. There's nothing Alamofire would be doing to modify the data out from under you. 

As @ntnmrndn suggested, if you need further assistance, we need a sample project to go on. Additionally, these types of questions are best suited for Stack Overflow. I can almost guarantee you the issue here is not Alamofire. If you open a question on Stack Overflow and post the link here, we could continue to help you there.
  Hi @rjong,

Questions like these are best suited for Stack Overflow. We use GitHub for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I respectfully disagree. If you are using the `.Custom` parameter encoding without parameters, you are misusing the API. There are many other ways to assemble an `NSURLRequest` to create your requests. The top level APIs already allow you to specify the HTTP Method, URL, parameters, parameter encoding and headers.

If these options are not sufficient, then you need to drop down a level and assemble your `NSURLRequest` manually before creating an Alamofire `Request`.

Cheers. üçª
  Thank you for putting this together @DavdRoman. We always appreciate updates from the community. 

With that said, I'm afraid we won't be adopting these changes into Alamofire. The main reason is complexity. There is no official RFC spec for any of the collection formatting. Our official Alamofire position is that we support one of the most commonly used formats when it comes to URL encoded collection formatting. If you need to customize the format in a different way, then you need to use a `.Custom` parameter encoding.

The main reason for this is to make it easy for the community to adopt, yet flexible enough to handle any use case. This is our philosophy when designing any of the Alamofire APIs. These changes make things more complicated without a high enough ROI to consider it a worthwhile change. Additionally, these changes are not in any way backwards compatible and would require a major version bump.

Thanks again. üçª
  I'm going to go ahead and close this issue out. Please see my comments in #966. Cheers. üçª
 Just to be clear, at no point did I claim that the PR was declined because "it's not commonly used". I declined it for other reasons which were very cleared documented. Additionally, I think you are assuming a bit too much here. At no point have we claimed we'll never support this feature. It's actually in our Trello backlog and has been for a while. I think I could have done a better job explaining that in my previous comment to avoid confusion...my bad there.

We completely understand there's a need for such a feature and want to support feature requests the best we possibly can. With that said, we have a very large community that we always need to consider when adding complexity into our APIs. This is definitely one of those features that we need to be careful how we introduce. 

Please be patient because there are many features here we are actively supporting. If you feel that you would like to see this feature added sooner than we will be able to, then by all means submit a complete, well thought out pull request. We'll be more than happy to consider it. But please understand that it is certainly in the community's best interest for us to decline PRs once in a while that aren't up to our standards or designed in a way that we deem suitable.
  Hi @yarneo,

We have many MANY tests around all possible Alamofire use cases. Without seeing some code, there is no way to pinpoint what exactly is going wrong. I have yet to see a stack trace reported by anyone else similar to this. I'd encourage you to open a question on Stack Overflow with code samples demonstrating how you are making requests. If you do end up finding an issue in Alamofire itself, please open a new issue or provide more detail on this issue and I'll be happy to re-open.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 It appears that you are using SwiftyJSON to parse the response. You're unwrapping of the JSON data is completely unsafe and is most likely the cause of your issues. You should use optional binding or optional chaining to safely extract the JSON data, rather than assuming it is always there.

On a side note, the Alamofire names are mangled because of Swift, not because of Alamofire itself.

And finally, please use Stack Overflow in the future. By doing so, it let's others in the community help out with these types of support questions and let's us focus more on building new features and maintaining Alamofire itself.

Cheers.
  Hi @phatmann...thanks for putting this together. Unfortunately, that section of the README is only for promoting libraries officially supported by the [AlamofireSF](https://github.com/Alamofire/Foundation). We want to avoid promoting libraries in which we don't have any control over.

Thanks anyways! üçª
  Thanks for the PR @nvh. Unfortunately, I don't think this change is the correct way to go with the `responseJSON` serializer. The statement you made about the `response` method being hidden doesn't seem to be true. The following compiles without any issues on the `master` branch:

``` swift
Alamofire.request(.GET, "https://httpbin.org/get")
    .response(
        queue: dispatch_get_main_queue(),
        responseSerializer: Request.JSONResponseSerializer(),
        completionHandler: { response in
            print(response)
        }
)
```

If you need to use a custom queue, this is the recommended way to do it. This is also a great example of why the `ResponseSerializerType` protocol exists making it easy to swap serialization logic.

Thanks again! üçª
  Hi @lemarian,

These types of questions are better suited for Stack Overflow with an `alamofire` tag. We generally use GitHub for bug reports and feature requests.

Cheers. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for putting this together @jacobjennings...much appreciated! I made a few small formatting changes to your PR and pushed it up in 234568d4 still giving you attribution.

Thanks again! üçª
  I like it!
  Hi @AnthonyMDev, 

Thanks for putting this together...much appreciated! Overall I really like the goal of this change that you broke down nicely in your description. However, I think there's a MUCH easier approach. What about the following?

``` swift
public func encode(
    URLRequest: URLRequestConvertible,
    parameters: [String: AnyObject]?)
    -> (NSMutableURLRequest, NSError?)
{
    var mutableURLRequest = URLRequest.URLRequest

    guard let parameters = parameters where !parameters.isEmpty else { return (mutableURLRequest, nil) }

    var encodingError: NSError? = nil

    // etc. etc.
}          
```

That's probably what this method should have been doing all along. If your down with this approach, do you think you could rework this PR to handle the change this way while keeping the test as part of the PR?
 Thanks for putting this together @AnthonyMDev...much appreciated! I also pushed b0c6a9bf to fix up a failing custom parameter encoding test case. Normally I wouldn't modify a test like this so a change that did break the test suite could move though. However, when looking at the failing test, it wasn't really a good test. Therefore, I updated it.

Thanks again!
  Hi @jedlewison, thanks for putting this together! Unfortunately, we won't be merging these changes in. The project was definitely configured this way by design. We want to support Carthage as well as always have the project compile the test code with any code changes. It helps ensure we never introduce compiler issues in the test suite when fixing bugs or developing new features. I understand that this introduces a slight overhead when using Carthage to compile Alamofire, but IMO I'd always error on the side of stability here rather than Carthage performance.

Thanks again. üçª
 Okay, thanks for all this info @jedlewison. I'm going to re-open this and investigate further. I wasn't aware that flag prohibiting the compiler optimizations. It makes sense now that I'm thinking about it that way.

Thanks for pressing on us here. üëçüèº
 Okay @jedlewison, after digging in further, I think your change is overall the best course of action. The reason I've been so hesitant on this change is that it requires us to disable the Travis-CI builds for the release configuration. Apple doesn't allow you to have an optimized build with the `ENABLE_TESTABILITY` flag disabled and still use `@testable` in your test target.

While that's certainly a bummer, it's not a blocker. I ended up finding another workaround for this in 39ca953d. What I did was create a `ReleaseTest` configuration that is configured exactly like the `Release` configuration, except has the `ENABLE_TESTABILITY` flag enabled. Since Carthage defaults to the `Release` configuration, this should be a sufficient way to attack the problem. This allows us to run our test suite against the `ReleaseTest` configuration on Travis-CI, while still allowing all our Carthage users to optimize their Alamofire frameworks.

Thanks again for your due diligence here. Alamofire is certainly much better off for it!

Cheers. üçª
 That's awesome! Glad to hear it. üëçüèº
  Thanks for putting this together @ntnmrndn! I merged a slightly modified version of your changes in 9ef1602f. Thanks again! üçª
  Check the [README for version 1.3.1](https://github.com/Alamofire/Alamofire/tree/1.3.1#installation)

> Embedded frameworks require a minimum deployment target of iOS 8 or OS X Mavericks

It's not possible to use CocoaPods or Carthage to integrate Alamofire on iOS 7 since they use frameworks to integrate and thus require iOS 8 onwards.

Check the instructions at https://github.com/Alamofire/Alamofire/tree/1.3.1#source-file
  You can definitely do this in Alamofire. Check out the [source code](https://github.com/Alamofire/Alamofire/blob/master/Source/Manager.swift#L329-L330) for the override closures in the `SessionDelegate`. üëçüèº
  Thank you for your PR @sun-fox-cj!

Unfortunately, we think this is probably not the best change for the community. The `escape` method is intended only for escaping query parameter key value pairs. It is not for escaping other parts of a URL. If you find the need to customize the escaped characters, then you will need to use your own custom implementation. We have MANY tests around this functionality to ensure we're following the spec as closely as possible for everyone.

Thanks again. üçª
  You are looking for `response.data`. That will be all the original data returned by the server.

In the future, these types of questions should be opened as a question on Stack Overflow with an Alamofire tag. We use GitHub for bug reports and feature requests. 

Cheers. üçª
  This is not something that I think is a good addition to Alamofire. This is merging the validation and response serialization operations into a single one. Validation is intended to validate the response header data to ensure the response and status code match what you expect. The second step is to serialize the response data in whatever means necessary. There is a clear separation of concerns here in the current design.

More specifically, why are you trying to force JSON serialization up a level? Why can you not accomplish what you need with the current response serialization design?

I'm going to close this issue out...but I'm happy to continue the conversation. As with any issue, if something comes up that warrants re-opening, I'm always happy to do so.

Cheers. üçª
 Oh man that's a bummer. Makes more sense now why you were trying to do what you were doing. I think both your approach and the custom response serializer approach are valid approaches to solving the problem for your use case. But I don't think it's something that should live outside your very specific use case.
 @s0meone I'm dealing with the same issue you are: my backend returns 200 for (nearly) everything, meaning I have to parse JSON to find the actual response code and boolean fields to determine whether the request succeeded. I was able to do this using a custom response serializer. Given that I was writing one anyway to deal with generic object deserialization, adding the deserialization of the base response from JSON was no more difficult. You can see an example of this [here](https://gist.github.com/jshier/f08f08e05d994b5bdc7d).
 Awesome...thanks @jshier!
  Hi @abinop,

These types of questions are better suited for Stack Overflow. If you could open a question there with an `alamofire` tag and post a link back to this issue, that would be preferred. We use GitHub for bug reports and feature requests.

Cheers. üçª
 Apologies @abinop...I just [replied](http://stackoverflow.com/a/34193782/1342462) to your question. Cheers. üçª
  Okay, let me clear up some things here. @Neku, the `data` is available in the `response` object. Therefore, it is always available, if it was returned from the server, as `response.data`.

@tomekh7, you can absolutely use `responseJSON` with SwiftyJSON. You can initialize a `JSON` object from `NSData` or from an `AnyObject` that has already been parsed by `NSJSONSerialization`.

If the future, these types of questions should be opened as a question on Stack Overflow. We use GitHub for bug reports and feature request.

Cheers. üçª
  Not really sure why you opened this...either way, I'm going to close it out.
  Hi @AlexNikov,

Please see my comments on #876 on how to proceed. Once you get through those, if you could comment back on this issue with your findings, we can go from there. Apologies for commenting on the other issue, I didn't realize you had opened this one.
 Hi @AlexNikov, 

Sorry for the delay in getting back to you on this. I'm almost positive you're getting bit by ATS. The certificate you are trying to workaround is not valid due to a host mismatch. The certificate host is `meduzaradio.com` and does not contain the `instore` subdomain. What I believe you need to do here is update your exception domain to `meduzaradio.com` and then you should at least see your `ServerTrustPolicyManager` getting called. Then the following should kick in:

``` swift
let serverTrustPolicies: [String: ServerTrustPolicy] = ["instore.meduzaradio.com": .DisableEvaluation]
```

I'm going to go ahead and close this issue out since I think I've identified the root issue. If you post any info back on here to the contrary, I'd be more than happy to re-open and continue to investigate.

Cheers. üçª
 We'll certainly keep this in mind @Leshich. For now, I'd recommend you subclass the `ServerTrustPolicyManager` to customize the behavior exactly as shown above.

Cheers. üçª
  Customization on this level can be accomplished by creating your own custom response handler, as outlined in our documentation [here](https://github.com/alamofire/alamofire#response-serialization-1). Specifically, if you want to, say, log all errors and only handle valid responses:

``` swift
extension Request {
    func responseSimpleJSON(options options: NSJSONReadingOptions = .AllowFragments, completionHandler: AnyObject -> Void) -> Self {
        let fullCompletionHandler = { (response: Response<AnyObject, NSError>) in
            switch response.result {
            case let .Success(object):
                completionHandler(object)
            case let .Failure(error):
                debugPrint("\(self) failed: \((error as NSError).localizedDescription)")
            }
        }

        return response(responseSerializer: Request.JSONResponseSerializer(options: options), completionHandler: fullCompletionHandler)
    }
}
```

Which can be used like this:

``` swift
Alamofire.request(.GET, "https://httpbin.org/get")
    .responseSimpleJSON { object in
        print(object)
    }
```

I'm going to close this issue for now but feel free to reopen if you find this solution or the flexibility of the current response serializer architecture to limiting for what you want to accomplish.
  Hi @jacobjennings, thanks for all the info here...nice work. üëçüèº

I think you have a valid point and the `certificatesInBundle` and `publicKeysInBundle` should pick up `cer`, `crt` and `der` file extensions. As for failing silently, I disagree because you can check the number of returned certificates returned by the method. Now it may be a bit difficult to figure out which one was missing, but at least you would know one was.

Would you be willing to put together a PR that updates the behavior here along with a test or two verifying the functionality?
 Ping here @jacobjennings...would you be willing to help put this together?
 I'm going to close this issue out...please redirect all comments to #956.
  I'm going to assume you are using CocoaPods. The issue has been fixed by the CocoaPods team, but the fix has not yet been released. Please see https://github.com/Alamofire/Alamofire/issues/871 for more info.
  Answered on Stack Overflow. üëçüèº
  Alamofire is limited to the HTTP/2 support offered by the underlying iOS system frameworks, specifically `NSURLSession`. Unfortunately, at this time `NSURLSession` offers no exposed support for either `PUSH_PROMISE` or the HTTP/2 stream functionality. Only iOS 9, watchOS 2, tvOS (9), and OS X 10.11 offer any support for HTTP/2, and this functionality is implemented as an invisible layer for existing `NSURLSession` and CFNetworking clients.

As for whether Alamofire will reuse existing connections: as with HTTP/2 support, Alamofire is at the mercy of `NSURLSession`. Fortunately, in this case connections can be reused, at least in the case of HTTP/2 connections, since that is part of the protocol specification. On compatible OSes and connections, HTTP/2 will be used automatically, so you should see connection reuse. However, you should always test to ensure your server is compatible with the HTTP/2 implementation provided by the system frameworks, as no manual control is provided by the frameworks.

As to polling vs. push, if at all possible polling is to be avoided. Unless you need the lower latency of native HTTP/2 push, Alamofire can be combined with Apple's push notification service (APNS) to provide asynchronous support for long running tasks. In fact, APNS was recently converted to HTTP/2 itself, so it's entirely possible they're using some of its abilities in the new implementation. 

For more information about the system networking frameworks and their capabilities, Apple's WWDC sessions are especially helpful. See: [Networking with NSURLSession](https://developer.apple.com/videos/play/wwdc2015-711/) and [What's New in Notifications](https://developer.apple.com/videos/play/wwdc2015-720/).

I'm going to close this issue, as there's not a lot we can do here before Apple exposes the required APIs. If you have more questions regarding hybrid APNS/Alamofire architectures, feel free to ask on StackOverflow and tag Alamofire.
 @johndpope I'm not sure how that's relevant here. Alamofire wraps the underlying `URLSession` APIs, so users of either level of APIs will never see raw HTTP/2 requests, per design. 

@danielrhodes Looks like `URLSession` gained support for HTTP/2 push in Apple's latest OS releases. Support is automatic, so there's nothing to be done by Alamofire or even users of `URLSession` directly to gain support. It essentially acts like a cache preheat, where the pushed response is stored in the associated `URLCache` instance and then used as the response when a request is made for the pushed data.
  The problem @marathoner1234 is that your `master` repo is messed up, or is not able to pull properly since you probably have some unstaged changes in your repo. All you need to do is remove the `master` repo and set it up again.

``` bash
rm -rf ~/.cocoapods/repos/master
pod setup
```

That should get you back in business. üëçüèº
 Anytime man...glad to help! üôåüèº
  The Swift compiler has a tough time with the misuse of generic classes. You can fix the issue by adding the generic parameter conformance:

``` swift
class Foo {
    func bar(response: Alamofire.Response<AnyObject, NSError>) {
        // winning üëçüèº
    }
}
```
  The app doesn't crash, you're merely hitting the breakpoint you have set. It's rather common for those of Apple's frameworks that use C++ underneath to use exceptions in ways that Objective-C and Swift don't and so you may hit those exceptions with that breakpoint. That's why I usually run with the exception breakpoint set only for the language I care about. For Swift you can set the Swift error breakpoint in Xcode 7.1 and higher. 

I'm going to close this issue. Feel free to open another issue if you find a crash that can be traced to Alamofire's code. 

Also, thanks for the sample project. It made seeing this issue very easy. :+1: 
 Since Swift doesn't use exceptions (though the C++ that underlies much of its implementation might), you'd have to use the Swift error breakpoint like I said. That will break on any thrown error, including those wrapped from Objective-C `NSError`s. Whether that's actually useful to you is up to you to determine.
  @CapeFurSeal Can you post the string you tried to encode (redacted for any special information), the string you got after encoding, and the string you expected? It would make it much easier for us to diagnose your issue.
 We are simply RFC 3986 - [Section 2.1](https://tools.ietf.org/html/rfc3986#section-2.1) and [Section 3.4](https://tools.ietf.org/html/rfc3986#section-3.4). The `+` character should be encoded as `%2B` as demonstrated in our ParameterEncoding [tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/ParameterEncodingTests.swift#L281-L290).
 I'm going to close this issue out @CapeFurSeal. If you end up finding an actual bug in the logic, please provide some additional information and we'll be happy to re-open. Cheers. üçª
 You bet! Glad you got it all figured out. üëçüèº
  I don't see anything obvious. Seems strange that you're getting a `-1005` here. You should try to first debug this by using `debugPrint(request)` after your `request.responseJSON()` call to generate the `curl` command. Then you can try to hit the service using `curl` to see if you see the same issue there. That at least would be a start.
 @codywinton I'm going to go ahead and close this issue out. If you continue running into issues, please open a question on Stack Overflow. We try to use GitHub for bug reports and feature requests. If you end up finding the issue is something inside Alamofire, please provide some additional info and I'll be happy to re-open the ticket.

Best of luck! üçª
 Looks like you're calling different APIs and you're using different HTTP methods. If the bottom cURL works, then you should just use the in your Alamofire code.
 Not sure off the top of my head since you are using `.JSON` parameter encoding. As I mentioned before, these types of questions are best suited for Stack Overflow. If you open a question there and post the link, we may be able to continue to help out there.

Cheers. üçª
  Agreed @toby78. This is an incredibly complicated feature to build, but I've just placed a card in our Trello backlog. Once the tech spike around this work starts up, I'll be sure to comment back on this issue.
  Hi @cesar-oyarzun-m,

I don't see anything obviously wrong. You should use the `debugPrint` functionality on `Request` to attempt to pin down what the issue is through `curl`. Most likely the `Request` isn't being sent correctly. Also, disabling evaluation won't help with the 401. That's only for disabling TLS evaluation.

On a different note, questions like these are best suited for StackOverflow. We use GitHub for bug reports and feature requests. If you could open a question there and post the link to that question back in this issue, that would be appreciated.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You cannot modify the `Request`after it has been resumed. With that said, don't cry...there's still a way. üòâ

Once the `Request` has been resumed, you need to let it fail, then rebuild it with the new access token and resend it. You also need to make sure to keep the closure around so you can execute it after the second request completes. You also need to make sure you don't call the closure twice.

I've actually built an OAuth2 library for my company ontop of Alamofire that does exactly this. While that library cannot be open sourced, I've detailed the overall solution in this [thread](http://stackoverflow.com/questions/28733256/alamofire-how-to-handle-errors-globally) on StackOverflow. Hopefully that helps get you going.

Best of luck! üçª
 First off, there's no quick solution to handling the OAuth2 race conditions. It is a very tricky problem to solve that I've tackled more than once.

With that said, you could add your own extension to an `NSURLSessionTask` if you need to store some additional info on it. There's nothing stopping you from doing this since Alamofire exposes all that logic publicly. As for those two properties being read-only, that not an Alamofire decision, that was Apple's.

If you end up finding a solution that works really well for you and think it might be a good addition to Alamofire, please submit a PR and we'll gladly check it out!
  Most likely the result of `host + requestURL` is not a valid URL, causing the unwrapping to crash. Please ensure you're passing a valid URL.
 I'm going to close this for now, let us know if fixing the backslashes and quotes doesn't fix the issue.
 Hi @YilunLiu, you need to use parameter encoding to properly escape the query string parameters instead of building the query string yourself. This is exactly why the entire `ParameterEncoding` enumeration exists. This is NOT a problem with Alamofire, you are misusing an `NSURL`.
  Alamofire does not support multi-platform frameworks to allow it to work seamlessly with CocoaPods AND Carthage with the same Xcode project. If you are attempting to make a new podspec that attempts to create a multi-platform framework and are having issues, please open an issue with the CocoaPods project. You'll receive much better assistance there.
  Unfortunately we're going to need more information before being able to offer an assistance. First of all, what versions of Alamofire and Xcode are you using? How are you making the call to Alamofire? Can you post some of your code? It should be farther down in your stack trace.
 Is any part of `http + domain + path` dynamic or provided by the user? You mentioned Saudi Arabia; is it possible for the user to input, say, Arabic characters that are used in the URL? 2.0.2 does force unwrap the `NSURL` it expects from your request string, which is really the only thing I can see causing a crash in that section of code. I suppose it could fail if invalid characters are entered. Is it possible for you to validate the string you make the request with beforehand?

That being said, it's always a good idea to keep up to date with the latest Alamofire version, as there will be no bug fix 2.0.x releases. If this does turn out to be an issue with Alamofire, it would only be fixed in the latest version, so an update would be necessary on your part anyway.
 Sounds good. I'm closing this for now but feel free to open a new issue if you continue to see crashes on 3.x after you validate your URL input.
  Hi @kohdesmond,

As you have already pointed out, this question is much better suited for Stack Overflow. We use GitHub for bug reports and feature requests. If you open a question and post the link here, someone from our team may be able to help you debug your issue.

> Also, you will certainly be able to attract more help by formatting your code nicely. Much easier to dig through.

Best of luck! üçª
 Glad you figured it out @kohdesmond. Could you elaborate on why ATS was putting you in an endless redirect scenario? Your explanation could possibly help someone else out there that finds this thread. üëçüèº
  Handling whether to display the activity indicator is much more complicated than this solution supports. This implementation will result in all sorts of flickering of the activity indicator which is not what you want. We already have a card for this feature in our Trello backlog as a result of #670. This is certainly high on our priority list, but we want to make sure we do this properly before rolling it out.
  Hi @lorenzoferrante,

Questions like this are best suited for Stack Overflow. We use GitHub for bug reports and feature requests. Best of luck. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I would recommend you both use the `debugPrint` functionality on the `Request` to help you figure out your issue through `cURL`.

``` swift
let request = Alamofire.request(.GET, "URLString")
    .responseString { response in
        debugPrint(response)
    }

debugPrint(request)
```

Then debug the issue through `cURL` to see if you can track down the problem easier. Most likely the issue is not Alamofire, but how you are making the request.
 I'm going to close this issue out for now. If either of you provide any other information that leads us to believe there is an actual issue with Alamofire, we'll happily re-open the issue.
  Hi @aryaxt,

This doesn't look like Alamofire activity to me. The call stack starts off with an `NSURLConnection` call and then many very low level calls in CFNetwork. I really doubt any of these calls are actually coming from Alamofire. I'd recommend you dig through the rest of your dependencies and try to figure out which ones could be making these calls. Something like Charles Proxy could also help you track down the network traffic.

Best of luck. üçª
  Any chance you could provide a sample project that demonstrates this?
 Additionally, how did you install Alamofire and which version did you install?
 Please try to wipe your DerivedData and Xcode cache and try it again. We cannot reproduce this issue. If you end up not being able to fix the issue, please provide more info and possibly a sample project and I'll happily re-open the issue.
  We've merged an alternate plist in #913 which should fix the issue for those installing Alamofire using submodules or Carthage. For those using CocoaPods, it will require a new release of CocoaPods. It appears they have already fixed the root issue in [CocoaPods #4539](https://github.com/CocoaPods/CocoaPods/pull/4539/files).
  From what I can see here, it looks like the Swift standard library is leaking the structure it uses to check the OS version when we use `if #available` in `encode`. Can you post the project you used to reduce this issue? It would allow us to replicate it more easily and confirm my suspicions. 
 Okay @jshier, I put together a small sample app that demonstrates the leak. Unfortunately I'm having major issues with `Leaks` where I cannot see anything other than the symbol addresses on iOS 8.3. I'm definitely able to repo the leak, but I cannot tell what the leak actually is the same way that @mruvim has demonstrated. I'm wondering if you could pick this up from here? I've pushed up a small sample project making it easy to debug.
- https://github.com/cnoon/AlamofireLeakage

I'm almost certain there's a leak in the availability checks which means we just need to file a radar. But without being able to dig into this any further, I'd hesitate to file the radar myself.
 @cnoon I've attempted to replicate the leak using multiple version of Xcode and I'm suffering from the same missing symbol issue you are. Leaks may be broken on El Capitan, because the Time instrument works fine.

In any event I think it's fine to report the issue to Apple, as any memory leak in Swift is a compiler or system library issue, and there are more than just this leak visible when you run the demo app. However, they probably won't fix the issue as it doesn't affect iOS 9.1. I'm sure a radar with with a link to this issue and the demo project would be appreciated though.

@mruvim It seems unlikely we'll be able to fix this issue directly or through a workaround, as the platform check is necessary to work around another framework bug, as noted in the code comment. We could drop the platform check and use the workaround code on all platforms but that would lead to an unacceptable performance regression on all platforms.
 Thanks everyone for the help here. I just opened [rdar://23689364](https://openradar.appspot.com/radar?id=4980581951602688) which hopefully will bring this to Apple's attention. I'm going to go ahead and close this out @mruvim. Thanks again for reporting. üçª
  Hi @mikewalkerjr,

Questions like this are best suited for Stack Overflow with an `alamofire` tag. We use GitHub for bug reports and feature requests. If you do end up submitting a question on Stack Overflow, please post the link back to this thread and I'm sure someone will be able to help you out.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for this @simonbs!
  Thanks @tmnb
  Man I don't think there's anything we can do on that one. The only option I see is to file a rdar which you already have done. Cheers. üçª
  You should convert your `useCredit` parameter to an `Int` before placing it into your `params` dictionary.

Questions like this are better suited for Stack Overflow. In the future, if you could ask your questions there, that would be great! We use GitHub for bug reports and feature requests.

Cheers üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Nope, see [RFC 3986 - Section 3.4](https://tools.ietf.org/html/rfc3986#section-3.4). It is recommended that both the `?` and `/` are not percent escaped in query string parameters. Below is our actual percent escaping logic for `.URL` encoding with additional documentation.

``` swift
/**
    Returns a percent-escaped string following RFC 3986 for a query string key or value.

    RFC 3986 states that the following characters are "reserved" characters.

    - General Delimiters: ":", "#", "[", "]", "@", "?", "/"
    - Sub-Delimiters: "!", "$", "&", "'", "(", ")", "*", "+", ",", ";", "="

    In RFC 3986 - Section 3.4, it states that the "?" and "/" characters should not be escaped to allow
    query strings to include a URL. Therefore, all "reserved" characters with the exception of "?" and "/"
    should be percent-escaped in the query string.

    - parameter string: The string to be percent-escaped.

    - returns: The percent-escaped string.
*/
public func escape(string: String) -> String {
    let generalDelimitersToEncode = ":#[]@" // does not include "?" or "/" due to RFC 3986 - Section 3.4
    let subDelimitersToEncode = "!$&'()*+,;="

    let allowedCharacterSet = NSCharacterSet.URLQueryAllowedCharacterSet().mutableCopy() as! NSMutableCharacterSet
    allowedCharacterSet.removeCharactersInString(generalDelimitersToEncode + subDelimitersToEncode)

    var escaped = ""

    //==========================================================================================================
    //
    //  Batching is required for escaping due to an internal bug in iOS 8.1 and 8.2. Encoding more than a few
    //  hundred Chinense characters causes various malloc error crashes. To avoid this issue until iOS 8 is no
    //  longer supported, batching MUST be used for encoding. This introduces roughly a 20% overhead. For more
    //  info, please refer to:
    //
    //      - https://github.com/Alamofire/Alamofire/issues/206
    //
    //==========================================================================================================

    if #available(iOS 8.3, OSX 10.10, *) {
        escaped = string.stringByAddingPercentEncodingWithAllowedCharacters(allowedCharacterSet) ?? string
    } else {
        let batchSize = 50
        var index = string.startIndex

        while index != string.endIndex {
            let startIndex = index
            let endIndex = index.advancedBy(batchSize, limit: string.endIndex)
            let range = Range(start: startIndex, end: endIndex)

            let substring = string.substringWithRange(range)

            escaped += substring.stringByAddingPercentEncodingWithAllowedCharacters(allowedCharacterSet) ?? substring

            index = endIndex
        }
    }

    return escaped
}
```
  It's a bit tricky if you use the `suggestedDownloadDestination` method. 

If you use the `suggestedDownloadDestination` method to retrieve the `destination` closure, you'll need to pass the `response` to the `destination` closure in your `response` closure to figure out where the file was moved.

``` swift
let destination = Alamofire.Request.suggestedDownloadDestination(
    directory: .CachesDirectory,
    domain: .UserDomainMask
)

Alamofire.download(.GET, "http://www.adobe.com/devnet/acrobat/pdfs/pdf_open_parameters.pdf", destination: destination)
    .progress { bytesRead, totalBytesRead, totalBytesExpectedToRead in
        print(totalBytesRead)
    }
    .response { request, response, _, error in
        print(response)
        print("fileURL: \(destination(NSURL(string: "")!, response))")
}
```

This should always give you the right value, as long as your `directory` and `domain` are valid on iOS. If not, you'll get the temporary location which is actually accurate as well. If you truly want full control over where the file is moved to, don't use the `suggestedDownloadDestination` method and use your own custom `destination` closure that returns the fileURL you want.
 The downloaded file path isn't going to be in the header. You need to load the data using the `NSData` initializer to load the contents of `fileURL`. Then you'll be in business.
 The file isn't moved into the temp location @chlebta, that's where the data is written while the download is in progress. Once completed, it will attempt to move the new file to the location provided in the `destination` closure. You need to make sure your folder structure is in place before attempting to move the temp file to it's final location.
  Most likely parameter encoding is failing when trying to encode the JSON in the HTTP body of the URL request.

I would suggest taking this question to Stack Overflow. We use the GitHub project for reporting bugs and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I just created a new Swift project and added Alamofire 3.1.1 using CocoaPods 0.39.0 and Xcode 7.1. Everything works properly. I'm going to close out. In the future, I'd encourage you to take these types of questions to Stack Overflow.
  Thanks for putting this together @cotsog! This has been a really tricky problem for us to track down. I can see how this solution would in fact fix the problem. The one caveat that I would like to point out is that this solution is NOT thread-safe. Anywhere where this solution is used, we need to make sure the async callback is executing on the main thread. Otherwise, we can run into a race condition where the callback is trying to call the expectation while the time is expiring.
 Okay so I ended up unwinding the merge and squashing the commits into e4320bd5. Thanks again for putting this together!
  Thanks for this @JRHeaton! I merged a slightly modified version of your changes in cbac897b and also put together 2159ce3c for `watchOS` and `tvOS`. Both are available in `master`.
  Hi @EslamAbo,

We use Stack Overflow for general usage questions and GitHub for bugs and feature requests. If you could open an issue on Stack Overflow with an `alamofire` tag, that would be preferred.

Good luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  First, I'd suggest updating directly to the latest version, 3.1.0. 

Second,if you take a look at the [download documentation](https://github.com/Alamofire/Alamofire/blob/master/README.md#downloading) you'll see that the destination closure has a different signature than what you're attempting. Specifically it take two parameters and requires you to return an `NSURL`. Once you meet those requirements you should build just fine.
  Alamofire doesn't have any built in SOAP or XML support, so you'd have to write your own. Fortunately it's straightforward to [create a custom response serializer](https://github.com/Alamofire/Alamofire/blob/master/README.md#response-serialization-1), but the XML parsing is up to you.

As for the parameters, take a look at the [documentation](https://github.com/Alamofire/Alamofire/blob/master/README.md#parameters) and see which of the built in encoding match your use case. 
  If you don't want to serialise the request parameters as a JSON body, why are you setting the encoding parameters to `ParameterEncoding.JSON`? Surely you just want to leave this at it's default value of `.URL` to URL encode these parameters?
 JSON encoded data needs to be set in the HTTP body. You cannot pass JSON data in the query string.

> You technically can as `.URL` encoded value data, but that's besides the point here.

In the future, please open a question on Stack Overflow and tag `alamofire`. We use GitHub for bug reports and feature requests.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for the PR @paulthorsteinson. Rather than merging this in, I removed the playground completely in 7582758d due to instability reasons. Thanks again.
  You aren't validating the response status code, so it is possible that a 404 will return you a `.Success` case. All that the `responseData` serializer does is validate that there wasn't an error (which there won't be since you aren't validating the response status code) or that the data exists.

``` swift
public static func dataResponseSerializer() -> ResponseSerializer<NSData, NSError> {
    return ResponseSerializer { _, _, data, error in
        guard error == nil else { return .Failure(error!) }

        guard let validData = data where validData.length > 0 else {
            let failureReason = "Data could not be serialized. Input data was nil or zero length."
            let error = Error.errorWithCode(.DataSerializationFailed, failureReason: failureReason)
            return .Failure(error)
        }

        return .Success(validData)
    }
}
```

In your case, you are receiving a 404 which isn't throwing an error, and the server is returning data. Therefore, your `responseData` serializer succeeds. If you expect a 404 to always throw an error, you should additionally use the `.validate(statusCode: [200])` method before the `responseData` serializer. More info in the [Validation Section](https://github.com/Alamofire/Alamofire#validation) of the README.

In the future, questions like this are better suited for Stack Overflow with an `alamofire` tag. We use GitHub for bugs and feature requests. üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This is quite clearly a CocoaPods issue. I suggest you try running the command suggested to update the master repo and consult with the CocoaPods project if you aren't able to get that working. 
 You may want to just delete the `master` repo @zuil7 in ~/.cocoapods/master and then run `pod setup` and possibly `pod repo update master`.
  You won't be able to refresh the headers before `.responseArray` is executed. You'll instead need to start the refresh request, then re-execute your original request after the refresh has succeeded.

In the future, this type of general usage question is better suited for Stack Overflow with an `alamofire` tag. We use GitHub for bugs and feature requests.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for this @3lvis! I've just pushed up a new branch that removes the code necessary to work around the core issue that was filed in that radar in 563dc0d0ab6610e46c9c5f1ae2b40cb08f10d7fe. Once the Travis-CI tests are all verified to pass, I'll merge this PR into master as well as 563dc0d0ab6610e46c9c5f1ae2b40cb08f10d7fe.
 Alright, everything looks good. Thanks again man!
  We've been tracking this closely in our Trello project. Alamofire could greatly benefit from better 204 support. Therefore, we've been discussing the options in how to actually handle this. This PR puts forward the most sensible, non-invasive support for this behavior IMO.

The only other thing I question about this approach is whether we should require validation on the 204 as an acceptable status code before allowing this check in the response serializers. That would better help identify intent. I also hate to require that though as I feel it is a bit heavy handed.

I'm very interested to get everyone else's thoughts on this change. Anyone out there that has had to work through a 204 use case, please get your feedback in now!
 cc @jshier, @kcharwood, @kylef 
 That's exactly right @damienrambout. These changes have a big set of tradeoffs. I'm not a huge fan of having to return the `NSData()` and `NSNull()` objects either, but that's the only option without making MAJOR changes to the other underlying types.
  TONs of info in [Carthage #859](https://github.com/Carthage/Carthage/issues/859) to help you solve your validation issues. This is not actually an issue with Alamofire itself. Carthage and Xcode 7.1 have some major challenges that are very well detailed in that issue.
 Ah bummer. Well I'd suggest starting with an issue on the Carthage project. If it does end up being some type of issue with the Alamofire project settings, please provide more info with a link to the Carthage ticket and I'll be happy to re-open this issue or investigate the new one if you go that route.
  Thanks!
  You would need to create your own `response` serializer if you would like this behavior. You could certainly use the `responseJSON` serializer for now, but you'd need to handle the `.Failure` case and parse the server data using `NSJSONSerialization`.

All the default response serializers are written in a manner that when any error occurs, the serializers will not run their serialization logic. This is certainly the most common case which is why they are written in that manner. When deviating from this logic, it's quite easy to create your own custom response serializer tailored to your use case.
  It's never too much of a nitpick @Nirma! Always always always submit a PR or open an issue with a question if you notice anything that could be improved. Thank you for doing so! 

I'm fairly certain these have not already been changed because this didn't used to work in Swift 1.2. Somewhere along the Swift 2.0 or 2.1 releases the Foundation extensions on String from NSString were implemented properly. Either way, this is a great change. Thanks for putting it together!

Cheers üçª
  Hi @sourcebit,

This means your `URLString` is invalid. Using the `URLStringConvertible` protocol requires your `URLString` to conform to the RFC 1738 and 1808 specs.

``` swift
/**
    Types adopting the `URLStringConvertible` protocol can be used to construct URL strings, which are then used to 
    construct URL requests.
*/
public protocol URLStringConvertible {
    /**
        A URL that conforms to RFC 2396.

        Methods accepting a `URLStringConvertible` type parameter parse it according to RFCs 1738 and 1808.

        See https://tools.ietf.org/html/rfc2396
        See https://tools.ietf.org/html/rfc1738
        See https://tools.ietf.org/html/rfc1808
    */
    var URLString: String { get }
}
```

Your query string doesn't look like it was formed correctly which means you most likely didn't use the `ParameterEncoding.URL` encoding type which will handle this all for you correctly.
  Hi @omkar0001,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!
 Hi @omkar0001,

I promise you that's the best way to ensure no one ever helps you. Our team works very hard to provide the highest quality libraries we possibly can. Additionally, everyone on our team does this purely on their own time. In order to help us focus on the library and less on support, we direct support questions to Stack Overflow since there are more people there to help answer support types of questions. This allows us to focus on Alamofire, and less on your individual problem of parsing JSON. Comparing our small team's approach to corporate giant of Microsoft is simply an idiotic comparison and is certainly not appreciated.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Could you try running the `iOS Example` project in the Alamofire workspace under the same conditions to see if you run into the same problem? I just ran the example with the exact setup that you mentioned and everything works exactly as expected. I'm curious if you see the same crash in that example app.

Additionally, as @AndrewBarba mentioned, any source code or sample project you could post would be VERY helpful.
 Hey that's awesome! üéâ Glad you got things figured out @slynglen.
  Closed as a duplicate of #878, please search existing issues before opening new ones in the future.
  Need more info here @istvanelekes. 
- How did you install it? 
- What version or commit hash are you building against? 
- Are you using Xcode 7.1 or one of the betas?
 Thanks @ikesyo!
  Hi @vigyanhoon,

Please check out Stack Overflow before opening an issue with Alamofire. There are MANY questions that have already been answered on this topic.
- https://stackoverflow.com/questions/33169739/how-to-set-different-expiration-timeout-for-each-nsurlrequest
- https://stackoverflow.com/questions/27135735/setting-client-side-timeout-per-request-with-alamofire-swift/27259082#27259082
- https://stackoverflow.com/questions/31095070/alamofire-does-not-respect-timeout-interval

Best of luck!
  You should just need to include the port number:

``` swift
let serverTrustPolicies: [String: ServerTrustPolicy] = [
    "localhost:3000": .DisableEvaluation
]
```

If that doesn't work, please add more detail and I'll gladly re-open the issue. üëçüèº
 Could you provide your full curl command? Additionally, would it be possible for us to be able to hit the server to try and debug the issue? I'm wondering if there's some additional challenge we're running into with self-signed certificates.
 Thank you for providing all that info and setting up the test server @iMoritz. So much easier to debug the problem on our end. I was able to get to the bottom of your issue. The following test case successfully makes a request to your test server using Alamofire.

``` swift
func testSelfSignedCertificate() {
    // Given
    let manager: Alamofire.Manager = {
        let serverTrustPolicies: [String: ServerTrustPolicy] = [
            "api.moritzsternemann.de": .DisableEvaluation
        ]

        let configuration = NSURLSessionConfiguration.defaultSessionConfiguration()
        configuration.HTTPAdditionalHeaders = Alamofire.Manager.defaultHTTPHeaders

        return Alamofire.Manager(
            configuration: configuration,
            serverTrustPolicyManager: ServerTrustPolicyManager(policies: serverTrustPolicies)
        )
    }()

    let expectation = expectationWithDescription("request should succeed")

    var request: NSURLRequest?
    var response: NSHTTPURLResponse?
    var data: NSData?
    var error: NSError?

    // When
    manager.request(.GET, "https://api.moritzsternemann.de:3000")
        .response { responseRequest, responseResponse, responseData, responseError in
            request = responseRequest
            response = responseResponse
            data = responseData
            error = responseError

            expectation.fulfill()
        }

    waitForExpectationsWithTimeout(defaultTimeout, handler: nil)

    // Then
    XCTAssertNotNil(request, "request should not be nil")
    XCTAssertNotNil(response, "response should not be nil")
    XCTAssertNotNil(data, "data should not be nil")
    XCTAssertNil(error, "error should not be nil")
    XCTAssertEqual(response?.statusCode, 200, "response status code should be 200")
}
```

I was incorrect when I said that the server trust policy should include the port number. It appears with this URL, the challenge host does not include the port number. If you add this test into the Alamofire test suite or into your own test suite, you'll see that it passes successfully.

```
Test Suite 'Selected tests' started at 2015-10-25 12:57:12.588
Test Suite 'BaseTestCase' started at 2015-10-25 12:57:12.589
Test Case '-[Alamofire_iOS_Tests.BaseTestCase testSelfSignedCertificate]' started.
Test Case '-[Alamofire_iOS_Tests.BaseTestCase testSelfSignedCertificate]' passed (0.460 seconds).
Test Suite 'BaseTestCase' passed at 2015-10-25 12:57:13.050.
     Executed 1 test, with 0 failures (0 unexpected) in 0.460 (0.461) seconds
Test Suite 'Selected tests' passed at 2015-10-25 12:57:13.050.
     Executed 1 test, with 0 failures (0 unexpected) in 0.460 (0.462) seconds
```

The key to figuring out what is going on is to add a breakpoint to the `ServerTrustPolicyManager.serverTrustPolicyForHost(:)` method. That will allow you to see what the `host` is associated with the challenge. There are several other ways to debug this, but that is certainly the easiest.

Hopefully this issue will help others in a similar position. Thanks again for all the info to help us debug! üçª
 Roger...I'll investigate further @iMoritz! Re-opening.
 Thanks for all the awesome feedback here. I definitely want to make sure all this is working properly. üëçüèº
 Thanks for all the info here @iMoritz and @4np. It may take me a couple of days before I can dig into this problem deeply just as a heads up.
 Okay, so this was a tricky one to figure out. Long story short, you are both being bit by ATS and need to configure it just right to allow the challenge APIs to be called. Here's an example of the ATS settings you need:

![ats settings](https://cloud.githubusercontent.com/assets/169110/10866234/33411c3e-7fe3-11e5-846a-c4e1fa1a0456.png)

Now I'll dig in here a bit more to try and share what I was able to find out. First off, I can't believe the awful lack of documentation around ATS from Apple. Their original ATS technote has been completely pulled offline. If anyone can find a valid link to the actual Apple docs, PLEASE PROVIDE A LINK!

With that said, I was able to piece this together from a few different links. First off, you should read [this](http://cutecoder.org/programming/server-ready-ios-9-el-capitan/) entire article. Most of the info you need is in there. This walks through the basics of `NSExceptionRequiresForwardSecrecy` and `NSExceptionAllowsInsecureHTTPLoads` but doesn't explain them very well at all. I was able to find a bit more info about the cipher relaxation of `NSExceptionRequiresForwardSecrecy` [here](https://forums.developer.apple.com/thread/13472).

From what I can tell, your server must not be using a valid cipher suite, because the request automatically errors out without the `NSExceptionRequiresForwardSecrecy` flag set to `NO`. Additionally, it appears that the `NSExceptionAllowsInsecureHTTPLoads` is a flag to override the entire challenge callback system. If you don't set it to `YES`, your challenge will NEVER be called.

Once you get these settings set correctly, then the challenges are called and you can debug whether your server trust policy objects are set up correctly.

I'll be updating the README shortly with this information to make it easier for people to work with self-signed certificates in the future.

Thanks everyone for helping figure this out! üçª
 Just want to point out, on El Capitan machines you can use `nscurl` command to attempt to diagnose ATS issues.
`nscurl --ats-diagnostics https://api.moritzsternemann.de:3000`
However, in this instance it wouldn't have helped at all since all of the scenarios it tests for succeed, so it really gives you nothing to go on. 
 Added ATS section to the README in 55cfc16b.
 Hi @AlexNikov,

Set a breakpoint in the `serverTrustPolicyForHost` method in the `ServerTrustPolicyManager` class to see if it's getting called. If it is, then you have ATS most likely configured correctly. If it's not getting called, then your ATS configuration is still not correct.

If it is getting called, then check to make sure your `host` matches yours exactly. If you still can't get to the bottom of the issue after verifying all this, please open a separate issue with enough info for us to continue to debug the problem. Also please read through all the very detailed info in this post. There's a ton of good info here to help you solve the problem.

Cheers.
 Couldn't agree more @4np! üéâ
 That should not actually be true @Link-. You should certainly be able to disable evaluation without having to mark the self-signed cert as a trusted cert. Can anyone else out there confirm this? We have many tests verifying this behavior, but none that deal with ATS at an app level.
 I would NEVER recommend doing the above in production @tvich1! For everyone thinking this is a good solution, I can't stress enough that you should never actually do this. Instead, use something like [Let's Encrypt](https://letsencrypt.org) to generate a valid cert.
 Ah. So your `Manager` instance was being deallocated in the middle of the inflight request @emilynswanson?
 Hi @tejasverixo, make sure you're `defaultManager` instance is not being released. Other than that, please file a question on Stack Overflow. We use our GitHub project for bug reports and feature requests.  There's a `tvOS` branch up at the moment. We'll be cutting a 3.1.0 release with full `tvOS` support most likely this evening.
  Hi @dashugege,

This type of question is best suited for [Stack Overflow](https://stackoverflow.com) with an `Alamofire` tag per our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md). The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!
  It does not directly. You will need to create your own SOAP interface around Alamofire.
  Thanks for your detailed write up @drichardson. Hopefully this helps someone else fighting a similar issue.

I'm a bit confused though as to whether you're asking a question, or just reporting behavior. The use case you detailed behaves exactly the way I would expect it to. For a default session configuration, the request should fail eventually since you aren't using a background session configuration. If you expect the request to complete successfully even when being backgrounded, then you need to switch over to using a background configuration.

Your proposed solution to the problem doesn't actually solve the connection closed error from occurring, it simply buries it from being reported by deallocating the original URL session and replacing it with a new one. Therefore, I'm not really sure what else to say. IMO, this is behaving exactly as expected.
 Yeah in this case you'll need to reload your table view cell or reload the `UIImageView`. There's not really anyway around it at the Alamofire or AlamofireImage level. Best of luck!
  How did you add Alamofire to your project? Did you use CocoaPods, Carthage or manual installation by downloading the source and adding the Alamofire Xcode project as a dependency to your project?
 Yeah I don't really know if there's a workaround for this particular issue. The availability methods are a bit annoying in this respect. The problem is that they need to be included in the project to get everything to compile with a deployment target of iOS 8.0. When you install using CocoaPods with a deployment target of 9.0, the availability methods will trip the warning.

I'll think on this some more and possibly file a radar. If anyone has any suggestions in the community on a way to get around this while maintaining an iOS 8 deployment target, I'm all ears!
 cc @kylef to see if there's any magic he knows of to workaround this problem.
 I don't know of the top of my head.

@sendoa I'd suggest filing a bug on CocoaPod's if there ware warnings that are not being inhabited by `inhibit_all_warnings!`. There might be something we can do, but this may be an Apple bug and may need to be raised further upstream as a radar if the bug lies with Apple.
 Thanks for the feedback @kylef. I assumed this was actually an Apple bug and we'd need to file a radar. This will make the 3rd or 4th radar I've filed around availability so I'm not surprised. Once I get it filed, I'll post the link to Open Radar and close this issue out.
 Thank you for filing [CocoaPods #4423](https://github.com/CocoaPods/CocoaPods/issues/4423) @sendoa. I've added additional comments about a [sample project](https://github.com/cnoon/AvailabilityWarningRadar) I created to demonstrate the problem. Hopefully we can get this issue resolved for all Pod libraries. 

Given that this is not actually an issue with Alamofire that we can solve, I'm going to close this issue out. I will update this issue periodically as we learn more about 4423.
 On second thought, I think I'll leave this one open until we get a confirmation from the CocoaPods team as to how they want to proceed.
 Yes, and for tracking purposes there is a PR at https://github.com/CocoaPods/CocoaPods/pull/4320 which would solve this.
 Awesome! Thanks @segiddins.
 Yep, that change is not part of CocoaPods 0.39.0. It will be available in the next pre-release.
 @pavankataria The next pre-release of CocoaPods, as this is a CocoaPods bug not Alamofire. CocoaPods 1.0.0.beta.1 contains the fix and can be installed via:

``` shell
$ gem install cocoapods -v 1.0.0.beta.1
```
  Thanks @ay8s.
  Hi @tomvlk, would you be able to submit us a sample project that exposes the issue? I can't think of any reason why you would see this behavior. Is the request timing out?
  @rephiscorth That specific test case is to ensure that the JSON (or any data) serialiser raises an error when the data is nil since we we're expecting JSON body (or data).

If you're not expecting a body you shouldn't be using the JSON serialiser.

You should instead use the `response` method instead of `responseJSON` when you're not looking for JSON.

``` swift
Alamofire.request(.GET, "http://httpbin.org/get", parameters: ["foo": "bar"])
         .response { request, response, data, error in
             print(request)
             print(response)
             print(data)
             print(error)
          }
```
 Thanks @kylef.
 Thanks for your detailed feedback here @dilizarov and @damienrambout!

I understand where you are coming from, but what you are saying @dilizarov is not entirely true. The `responseJSON` serializer has ALWAYS thrown an error when the data returned from the server is empty. How the error is thrown has changed a bit, but even the original version would throw the `No Value` error from `NSJSONSerialization` when trying to deserialize the empty server data. Now we have some additional checks prior to running `NSJSONSerialization`, but the end result is still the same.

With that said, I don't think there's a way to cleanly handle this behavior without creating a custom response serializer. Trying to handle this use case in the common `responseJSON` serializer will just make the complexity too difficult understand for the general user. You need a serializer that first checks for the 204 response code. If it is a 204, return a Success result (probably with a `Void` type). If it is not a 204, run JSON parsing over the server data and extract out the custom error message. This is VERY different behavior than the current `responseJSON` implementation which is why I would encourage you to roll your own solution here.

Another way to do this without creating a custom response serializer would be to use the status code validation logic in conjunction with the `response` serializer. If the error comes back as a validation error, then run the JSON serialization over the server data if it exists and extract the exact error message.

To reiterate, the `responseJSON` serializer is not a solution for anything JSON. It's simply for the VERY common case that you know an API will return JSON in the event that the request is successful.
 @dilizarov and @damienrambout, after much internal debate, we've decided it would be best to add better support for the 204 use case. Please check out #889 if you get a chance. This is our first stab at proper 204 support directly in the response serializers.
  This is a known CocoaPods issue when trying to archive watch apps. See CocoaPods issues [4178](https://github.com/CocoaPods/CocoaPods/issues/4178) and [4369](https://github.com/CocoaPods/CocoaPods/issues/4369). If you continue to have issues, please raise an issue with CocoaPods.
  You need to delete the file first before you re-download it. The [moveItemAtURL(:toURL:)](https://github.com/Alamofire/Alamofire/blob/master/Source/Download.swift#L200) is failing.
  Hi @bkawakami,

Github is for reporting issues and new feature requests. Questions like these belong on [Stack Overflow](https://stackoverflow.com) with an `Alamofire` tag.

Cheers.
  The reason it is not exposed is that we didn't think there should ever be a need to specify your own value. The current implementation follows the RFC specs which are a bit vague. Could you shed some more light on what the server is doing so we can better understand the use case? Opening this up is something I'd rather avoid unless there is a valid reason to do so.
 Hi @FrankJaeger, I'm going to close this PR for now. If you end up posting a valid case for making this change, I may re-open and merge. Cheers.
  Could you post your code you are calling that is tripping this crash? There's not enough info here yet to diagnose the issue.
 Could you post a sample project that can demonstrate this? It's very difficult to diagnose this type of crash through screenshots. A sample project or test that can demonstrate the behavior would be VERY useful.
 Hi @CodeEagle, I'm going to close this issue out for now. If you post a sample project or an actual code sample that we can run to help debug, I'll be happy to re-open.
  This is all documented in the README [examples](https://github.com/Alamofire/Alamofire#uploading-multipartformdata). You need to grab the `upload` object out of the encoding result to chain.
  Thanks @cristeahub!

@mirzadelic In addition to the documentation linked by @cristeahub, see the [3.0 migration guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%203.0%20Migration%20Guide.md).
  Hi @kalyansriram,

Github is for reporting issues and new feature requests. Questions like these belong on [Stack Overflow](https://stackoverflow.com) with an `Alamofire` tag.

Cheers.
  There could be a few reasons from your example, why I think you may be seeing this:
- Your example may be inaccurate since you are blocking the main thread which could cause any other tasks to block and stay in memory.
- You are performing a new request every 0.1 seconds, which may be quicker than it takes to handle the responses. If this is the case, new requests will be happening and as time goes on, the amount of requests happening at any time will be more and more.

We can alter your example to no longer block the main thread, and instead dispatch from the main thread after a delay which is a little higher allowing the request to finish. For example:

``` swift
class AppDelegate: NSObject, NSApplicationDelegate {
  func applicationDidFinishLaunching(aNotification: NSNotification) {
    performRequest();
  }

  func performRequest() {
    let delayTime = dispatch_time(DISPATCH_TIME_NOW, Int64(1 * Double(NSEC_PER_SEC)))
    dispatch_after(delayTime, dispatch_get_main_queue()) { [weak self] in
      print("Performing Request")
      Alamofire.request(.GET, "https://httpbin.org/")
      self?.performRequest()
    }
  }
}
```

With this updated example, you can see the memory usage is constant and not increasing:

![screen shot 2015-10-13 at 16 58 39](https://cloud.githubusercontent.com/assets/44164/10471609/a80b03ec-71cc-11e5-9761-be7b9b1daf1b.png)
  Works fine for me in Alamofire 3.0.0 in a unit test.

``` swift
class ResponseJSONTestCase: BaseTestCase {
    func testThatResponseJSONReturnsSuccessResultWithValidJSON() {
        // Given
        let URLString = "https://httpbin.org/get"
        let expectation = expectationWithDescription("request should succeed")

        var response: Response<AnyObject, NSError>?

        // When
        Alamofire.request(.GET, URLString, parameters: ["foo": "bar"])
            .responseJSON { closureResponse in
                response = closureResponse
                expectation.fulfill()

                if let err = closureResponse.result.error as? NSURLError where err == .NotConnectedToInternet {
                    print("Cannot connect to the internet")
                }
            }

        waitForExpectationsWithTimeout(defaultTimeout, handler: nil)

        // Then
        if let response = response {
            XCTAssertNotNil(response.request, "request should not be nil")
            XCTAssertNotNil(response.response, "response should not be nil")
            XCTAssertNotNil(response.data, "data should not be nil")
            XCTAssertTrue(response.result.isSuccess, "result should be success")
        } else {
            XCTFail("response should not be nil")
        }
    }
}
```

I'm going to close this out for now. If you end up finding an actual issue in Alamofire, please post some additional info and I'll be happy to re-open. Otherwise, I'd suggest in the future you open questions like these on Stack Overflow.

Best of luck!
  First, please update to the release version of Alamofire 3 so we can rule out an issue with the older version. 

Second, your definition of the response serializer, `public static func objectSerializer() -> ResponseSerializer` needs to include the types of the value and error to be returned. It's likely that by adding those your code will build successfully. 
 Here's a much more condensed version of your logic that compiles fine on Alamofire 3.0.0:

``` swift
protocol MTLModel {}
typealias MTLError = NSError

extension Request {
    static func objectSerializer <T: MTLModel> () -> ResponseSerializer <T, MTLError>  {

        return ResponseSerializer <T, MTLError> { request, response, data, error in
            let failureError = NSError(domain: "", code: 0, userInfo: nil)
            return Result<T, MTLError>.Failure(failureError)
        }
    }

    func responseObject<T: MTLModel> (queue: dispatch_queue_t? = nil, willStart: (() -> Void)? = nil, didStop: (() -> Void)? = nil, completionHandler: Response<T, NSError> -> Void) -> Self {
//        willStart?()
//        UIApplication.sharedApplication().networkActivityIndicatorVisible = true

        return response(responseSerializer: Request.objectSerializer(), completionHandler: { (response: Response<T, NSError>) in

            dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), { () -> Void in

                print(response)

                dispatch_async(queue ?? dispatch_get_main_queue()) {
                    didStop?()
                    UIApplication.sharedApplication().networkActivityIndicatorVisible = false
                    completionHandler(response)
                }  
            })
        })
    }
}
```

If this doesn't end up working, please comment exactly why and I'll be happy to re-open.
 @cnoon  it would be epic if you can add some blog post or improved documentation about customer serializers. Its quite hard to implement for those of us learning, and the various articles on the internet seem to have wildly different ways of implementing it.  
Can we have one siimple way as an example that doesn't rely on 3rd party libaries and just shows the basics?  By default Alamofire registers any response that makes it through the response serializer (in your example, the `dataResponseSerializer` used by `.responseData`) as a success. If you wish to validate the response code of your request, just add a `.validate()` to your request chain. This will ensure that your response code is between 200 and 299, inclusive. You can also customize validation using the [methods described in the documentation](https://github.com/Alamofire/Alamofire#validation).
  In these cases, you need to use the `response` serializer instead of the `responseXXX` serializers. All others throw errors if the data is not valid. This is something that we're continuing to investigate to see if there is a better way to handle it. It's already being tracked in our backlog.
 @Ysix please check out #889 if you get a chance. This is our first stab at proper 204 support directly in the response serializers.
  Hi @a6475593,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!
  Hi @gkss,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!
  You need to make sure you keep a strong reference to your new `manager` instance, otherwise the requests are cancelled as soon as the `manager` is deallocated.
 I'm going to close this out @cwack-letsdev. I'll be happy to re-open if you do find an issue in Alamofire.
  `response.response.statusCode`.
  By default Alamofire registers any response that makes it through the response serializer (in your example, the `JSONResponseSerializer` used by `.responseJSON`) as a success. If you wish to validate the response code of your request, just add a `.validate()` to your request chain. This will ensure that your response code is between 200 and 299, inclusive. You can also customize validation using the [methods described in the documentation](https://github.com/Alamofire/Alamofire#validation).

In your case:

``` swift
Alamofire.request(.GET, Constants.Path.rootUrl + "/api/users", parameters: ["username" : usernameString, "limit":3] , headers: ["tb-token" : userToken!])
            .validate()
            .responseJSON { response in }
```
  Hi @lukeg01,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Additionally, I believe this question has been asked multiple times on Stack Overflow. I'd search there first. It usually ends up being an issue with DerivedData or with the way you have it installed.

Best of luck! üçª
  Hi @jdoes,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!
 Okay @jdoes. If no one answers or comments on your question, that generally means your question needs to have more detail and be very clear. It also needs to show the steps you've taken to already debug it. Otherwise the community may think you haven't spent the adequate time to debug it. Try to take another pass adding any details you can think of, and I'll take a look.
  Thanks @mkral!
  Thanks @Ashton-W!
  @felipeflorencio This is because Alamofire depends on iOS 8.0 (this is required to integrate Swift frameworks). You will either need to find other ways to integrate Alamofire (without CocoaPods), or drop support for iOS 7.

There is a better error message for this in the upcoming version of CocoaPods (0.39).

``` shell
$ pod install --no-repo-update --no-integrate
Analyzing dependencies
[!] Unable to satisfy the following requirements:

- `Alamofire (= 1.3.1)` required by `Podfile`

Specs satisfying the `Alamofire (= 1.3.1)` dependency were found, but they required a higher minimum deployment target.
```
  I don't think it would @AnthonyMDev.

The `Request` object already has some really good debugging functionality built in. If someone needs additional logging, I'd say that lends itself to a `Manager` subclass. Logging is a complicated beast and I'd rather avoid coupling a logging library directly to Alamofire. Additionally, everyone has their own opinions on how a logging system should work...problem is that most people always disagree. Therefore, I'd rather leave network request logging out of Alamofire altogether.
 @AAverin You can `debugPrint` the `Request` you made to get a `curl` command output, which will let you see the URL, parameters, and headers that were part of the request. Any response logging will have to be written custom by you.
  That's a great question! The answer is quite complicated so let me split it up.

## Short Version

We don't want users to have to cast response serializer errors from `ErrorType` to `NSError` every time just to allow custom error types for `Validation`.

## Long Version

All Alamofire errors encountered when making a request are stored in a request's `TaskDelegate` instance. That error then propagates to all the responser serializers. Since the majority of errors that can be encountered when making network requests are actually generated by `NSURLSession` rather than Alamofire, it makes sense to have Alamofire also generate NSError objects to maintain consistency. This makes the response serializers much less complicated.

In Alamofire 2.0, we made the unfortunate decision to switch the `TaskDelegate` error to an `ErrorType` rather than an NSError. This forced all users to have to cast the error in the response serializers to an `NSError` even if they didn't implement custom `Validation` closures. Not a great tradeoff considering we have thousands (maybe hundreds of thousands) of people using the response serializers and only hundreds creating custom Validation closures.

There are also many more details in #791 if you'd also like to check that out.
  Just FYI...we're aware that there is a fairly large issue with 204 response handling which is why #889 exists. Please check it out if you get a chance before we merge to make sure we're covering your use case properly! üçª
  Thanks @AnthonyMDev.
  Hi @thomasbaldwin, please put yourself in our shoes. Your comment is incredibly unhelpful. 
- Which code samples are incorrect?
- Which version of the README are you looking at? 
- Which version of Xcode are you using? 

Most likely the code samples work just fine if you are using the version of Xcode the README specifies.
 @thomasbaldwin If you want the documentation for 2.0.2, view the 2.0.2 tag on GitHub. Current master is for 3.0.0. 
 Good call @seigel! Fixed in afc8cdb3.
  The carthage build works properly on 3.0.0-beta.3.

``` bash
cnoon:~/Desktop/CarthageTester$ carthage update --platform iOS
*** Fetching Alamofire
*** Checking out Alamofire at "3.0.0-beta.3"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.eI0AZs.log
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
cnoon:~/Desktop/CarthageTester$
```

Support questions like this are better suited for Stack Overflow. If you do end up finding an actual issue in the Alamofire project, please comment back on this issue and I'll be happy to re-open if necessary.

Best of luck!
 Thanks for adding more detail @silver619. You original question simply did not have enough info to go on.

After digging in to understand what's going on, I tracked down [Carthage #535](https://github.com/Carthage/Carthage/issues/535) which contains quite a few details about the required change. It appears that bitcode support is compiled differently between normal builds and archived builds. To allow Carthage to work properly, I have added the `BITCODE_GENERATION_MODE` user defined setting with a value of `bitcode` to all three framework targets in f6e19674.

This should fix up the issue. If you could possibly test this @silver619, I'd really appreciate it. Thanks again!
 You would use:

``` bash
github "Alamofire/Alamofire" "master"
```
 Yeah that makes sense. Updated all frameworks in 4a213ebe and 373293c0.
  I'm not really sure. This is way outside our general usage. I'm not sure if you can compile a Swift 2.0 framework or app against the 10.10 SDK in Xcode 7. I'd encourage you to take this question to Stack Overflow since this is much more of a Swift and Xcode question than an Alamofire question.
  @dms90 There is no official version 3.0 for CocoaPods yet, you'll have to use `pod 'Alamofire', '~> 3.0.0-beta.3'`.
 Thanks @jshier! üçª
 Updated in 8a3c5256 @ScheerMT to avoid confusion until the official 3.0 release.
 It is very stable. I would anticipate there will be almost no changes other than documentation at this point between the latest commit in `master` and the tagged 3.0 release. We're looking to release Alamofire 3.0 this weekend.
  We will not be directly supporting sockets. We do however already support `NSURLSessionStreamTask` usage.
  You need to use the `response` serializer with a download since no data is actually returned. The data is instead written to a file. If the `error` is `nil`, the download completed successfully.
  This is not something that is directly supported. You can use the `.Custom` parameter encoding to accomplish this. See this [thread](http://stackoverflow.com/a/32031315) for more info.
  While, it used to take 3 arguments, it takes one argument as of https://github.com/Alamofire/Alamofire/pull/792 in Alamofire 3.0.
  Thanks @jshier.
  Thanks for your PR @Screon! I merged a slightly modified version of your PR in 401e76a9. Thanks again!
  Thanks @neugartf!
  The error makes me think you are running one of the Alamofire 3.0 betas. What commit hash or tagged version are you building against?
 If you are just now pulling down the library and building against it, I would suggest starting right off with the Alamofire 3.0 betas. I would also encourage using CocoaPods. The instructions can be found right in the [README](https://github.com/Alamofire/Alamofire#cocoapods). Once you switch over, please check out the [3.0 Migration Guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%203.0%20Migration%20Guide.md) for more information to get rolling. Between the README and the Migration Guide, you should be up and running making requests in no time.

If you do still run into legitimate issues, please comment back on this issue and I'll be happy to re-open.

Best of luck! üçª
  Any service call that should NOT return data needs to use the `response` serializer at the moment. All the others expect data to exist, otherwise it will return a `.Failure` result. I'll think some more on the idea of having a generic response serializer that supports the concept of `No Data`. Maybe a `responseNoData` serializer?
 @tkrajacic please check out #889 if you get a chance. This is our first stab at proper 204 support directly in the response serializers.
  @chrene Which platform? Has anyone else ran into this issue that could help @chrene troubleshoot? I would certainly open a question on Stack Overflow as well to get more visibility to this problem @chrene. This is the first time I've heard of this issue, so I'm very doubtful this is an issue with Alamofire itself.
 Okay thanks for getting back to me @chrene.
  First problem you need to switch to return `NSMutableURLRequest` instead of `NSURLRequest`. The second is that it needs to be `responseJSON { request, response, result in`. See the [README](https://github.com/Alamofire/Alamofire/tree/2.0.2#response-handling) for version 2.0.2 for more details.
  What is not released? Could you be MUCH more specific?
  Hi @idrisyildiz7,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!
  What version of Alamofire are you using?
 You need to set the domain to `www.anexamplehost.cn` instead of `anexamplehost.cn`. If you want to implement wildcarding, you'll need to create a subclass of `ServerTrustPolicyManager` and override the [serverTrustPolicyForHost](https://github.com/Alamofire/Alamofire/blob/master/Source/ServerTrustPolicy.swift#L56) method.

Best of luck! üçª
 In the case that you're an IP address instead of a domain, the string should most likely be just the IP address. You'll need to debug the [serverTrustPolicyForHost](https://github.com/Alamofire/Alamofire/blob/master/Source/ServerTrustPolicy.swift#L56) method to make sure.
  It depends on what version of Alamofire you are using, but you can always get the original server data in the event of an error if you are using either the Alamofire 2.x or 3.x releases.

#### Alamofire 2.x

``` swift
Alamofire.request(.GET, "http://httpbin.org/get")
         .responseJSON { request, response, result in
             print(result)
             debugPrint(result)

             print(result.data) // original server data if .Failure case
         }
```

#### Alamofire 3.x

``` swift
Alamofire.request(.GET, "http://httpbin.org/get", parameters: ["foo": "bar"])
         .responseJSON { response in
             print(response.request)  // original URL request
             print(response.response) // URL response
             print(response.data)     // server data
             print(response.result)   // result of response serialization

             if let JSON = response.result.value {
                 print("JSON: \(JSON)")
             }
         }
```
 You can print out the error in `result`. That will give you additional info.
  Your static serializer uses an optional value while the response serializer does not. That is your issue. In the future, please post sample code and not screenshots. It's much easier for us to debug and for others to code scan.

Good luck!
  You have MANY options to handle this case...several of which you've already mentioned in your post.

The best option IMO for this case would be to create a custom response serializer to handle the various parsing options. Continue to validate the response status codes, then in your custom response serializer, switch on the error code and use different parsing schemes depending on what type of error you received. Then you can validate your response codes and fork the parsing all within a single response serializer that gets re-used over and over. The [README](https://github.com/Alamofire/Alamofire#generic-response-object-serialization) goes into quite a bit of detail in how to create your own custom response serializer.

Best of luck!
  This issue is much better suited for Stack Overflow. If you end up finding an actual issue in the Alamofire project, please comment back on this issue and I'll be happy to re-open it.

Best of luck!
  There is no built in support for this. You need to look into the documentation of the Security framework and possibly override the `taskDidReceiveChallenge` closure on the `SessionDelegate`. See the `ServerTrustPolicy` for more information.
  You need to update to the official Xcode 7.0 release.
  You should be using the `tvOS` branch. We won't be supporting tvOS in the `master` branch once Xcode 7.1 is out of beta.
  You can validate status codes in MANY ways. Here are a few examples:

``` swift
Alamofire.request(.GET, "http://httpbin.org/get", parameters: ["foo": "bar"])
    .validate(statusCode: 200..<300)
    .validate(statusCode: Set([200, 206]))
    .validate(statusCode: [200, 206])
    .validate(statusCode: [200])
    .response { response in
        print(response)
    }
```

Whatever you pass in just needs to conform to `SequenceType`.
  Thanks for your PR @dfmuir! I merged a slightly modified version of your changes into `master` in 13925497.

Cheers üçª
  Thanks for all the info here @ldiqual. I was actually looking into this myself and came to the same conclusion about the queue issue. There's no published documentation that I've been able to track down about the queue behaviors on UI Tests. If you ever find any, please comment on this issue to update us.

For now, I'd say that the workaround is to use a different queue for the response serializers. I also do not want to add hooks into Alamofire for attempting to detect whether it is a UI test or not. Nor do I think it would be possible to do that.

Cheers.
  Thanks for all the info. I'd say everything is working exactly as expected based on the info provided. If you need a successful 401, don't `validate`, and use the `response` or `responseData` serializer.
  Thanks @AnthonyMDev for helping out here! üçª
  Hi @thiphariel,

Alamofire will never change the HTTP method on the request. It is maintained throughout `ParameterEncoding` as well as when the `NSURLRequest` is sent to the URL session.

For more assistance, I'd suggest you ask your open a question with sample code on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I don't think this is something that we'll directly support in Alamofire because 1) it's fairly OS specific and 2) we wouldn't know which upload method you would need to use to send the data to the server. There is some useful information [here](http://stackoverflow.com/questions/12138484/how-to-upload-image-that-was-taken-from-uiimagepickercontroller) and [here](http://stackoverflow.com/a/12121605/1342462) that should help you implement this functionality.
  You need to make sure your "custom" manager is initialized properly with the background session identifier before setting the `backgroundCompletionHandler`. If you are calling this on the `Alamofire.Manager.sharedInstance` then it will have no effect. Without knowing what `manager` is, I'd say that's most likely your issue.

For more info, I'd suggest checking out some of the examples in the [URL Loading System](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/URLLoadingSystem/Articles/UsingNSURLSession.html#//apple_ref/doc/uid/TP40013509-SW26) docs.
 Let's move it to Stack Overflow @paulyoung. If you post a link to the question in this issue, I'll try to help you out there.
  Thanks for helping out here @jshier. üëçüèº

@ballerabdude I would suggest you drop down to the Alamofire 2.0.2 branch where we have all the sample code updated in the README and a migration guide put together. The Alamofire 3.0.0-beta.1 is a pre-release. I don't anticipate we'll cut the official 3.0 release here for at least another week, maybe two.
  There is not nor do I think that makes sense to put into Alamofire directly. Instead, I would suggest putting that logic a layer above Alamofire. You always need to construct the parameters, URL, encoding types, etc. before you actually call Alamofire to automatically create the request and execute it. Before you call into Alamofire, you should run your validation.

If you need to first perform parameter encoding and get the `NSURLRequest` all set up, then you'll want to stop using the global convenience `request`, `download` and `upload` methods that take the `Method`, `URLString`, `parameters`, `headers`, etc. and drop down to start calling `ParameterEncoding.encode` directly. Then you can manually assembly your `NSURLRequest` and validate it prior to executing on an Alamofire session.

Does that all make sense?
 Thanks @AnthonyMDev...best of luck!
  Your sample code does not match your description. You are using the `response` method which deals with the 4 tuple values, not a `Result` type. Yet in your description, you are claiming that you are getting a `.Failure` case. Please update your description and sample code to match. Otherwise it is impossible to help you diagnose your issue.
 Could you post your sample project on GitHub or somewhere else so I can try to debug it?
 Thank you for creating that sample project @nonec. After digging into this some more, it appears that it's not an Alamofire bug, but an Apple bug. The following logic reproduces the same issue whether you are using Alamofire or `NSURLSession`:

``` swift
@IBAction func buttonTapped() {
    let testURLString = "http://jsonplaceholder.typicode.com/users/3"

    // NSURLSession Approach
    let URLRequest = NSURLRequest(URL: NSURL(string: testURLString)!)

    let request = session.dataTaskWithRequest(URLRequest) { data, response, error in
        if let data = data, let text = NSString(data: data, encoding: NSUTF8StringEncoding) {
            print(text)
        } else {
            print("failed")
        }
    }

    request.resume()

    // Alamofire Approach
    Alamofire.request(.GET, testURLString)
        .responseJSON { response in
            print(response.result.value)
        }
}
```

I would suggest you file a [radar](http://bugreport.apple.com) to bring it to Apple's attention.
  You guys really need to read through the commits if you're running off master instead of the official "Latest Release". Otherwise you run the risk of the documentation being a bit out-of-date. Considering that `master` currently contains the Alamofire 3.0.0-beta.1 pre-release changes, the docs are significantly out-of-date. This will be resolved over the next couple of days.

If you are running on 2.0.2, @peteclark3's example will work. If you are running on `master` or `Alamofire 3.0.0-beta.1`, you need to use the new response type:

``` swift
Alamofire.request(.GET, "https://httpbin.org/get")
    .responseJSON { response in
        debugPrint(response)

        if let JSON = response.result.value {
            print(JSON)
        }
    }
```
 The documentation is forthcoming gents. Please be patient. The Alamofire 3.0.0-beta.1 is a "pre-release", not an official release.
  Could you provide more info to go on?
- Full sample code showing how you're making the call
- Whether this is an iOS or OS X app
- What version of Alamofire you are using
- How you installed Alamofire into your project

This is the exact error that you get from ATS when you try to call a service over `http`.
 Thanks @Aghassi. This will take me a bit to figure out what's going on here. I haven't put together OS X app yet with Alamofire. 

Does anyone else in the community that works on OS X regularly have any idea what @Aghassi could be running into?
 You might also want to consider hitting the URLs with cURL commands, Paw, POSTMAN, etc. to verify things are working as expected.
  Thanks for filing this issue @eburi. I'll need to put some tests together to figure out exactly why the headers are being dropped. Are you overriding any of the session delegate closures?
 Okay @eburi, you're going to have to take this one up with Apple.

I've added a fairly robust test in cdeb5c19 that demonstrates the behavior. It appears that most headers are passed through from the original to the redirect request with the exception of the `Authorization` header. I can't find any documentation on this behavior, but the test verifies what is actually going on. If you need to pass the `Authorization` header through, you'll have to do it manually by overriding the closure.

``` swift
func testThatRedirectedRequestContainsAllHeadersFromOriginalRequest() {
    // Given
    let redirectURLString = "https://httpbin.org/get"
    let URLString = "https://httpbin.org/redirect-to?url=\(redirectURLString)"
    let headers = [
        "Authorization": "1234",
        "Custom-Header": "foobar",
    ]

    // NOTE: It appears that most headers are maintained during a redirect with the exception of the `Authorization`
    // header. It appears that Apple's strips the `Authorization` header from the redirected URL request. If you
    // need to maintain the `Authorization` header, you need to manually append it to the redirected request.

    Alamofire.Manager.sharedInstance.delegate.taskWillPerformHTTPRedirection = { session, task, response, request in
        var redirectedRequest = request

        if let
            originalRequest = task.originalRequest,
            headers = originalRequest.allHTTPHeaderFields,
            authorizationHeaderValue = headers["Authorization"]
        {
            let mutableRequest = request.mutableCopy() as! NSMutableURLRequest
            mutableRequest.setValue(authorizationHeaderValue, forHTTPHeaderField: "Authorization")
            redirectedRequest = mutableRequest
        }

        return redirectedRequest
    }

    let expectation = expectationWithDescription("Request should redirect to \(redirectURLString)")

    var response: Response<AnyObject, NSError>?

    // When
    Alamofire.request(.GET, URLString, headers: headers)
        .responseJSON { closureResponse in
            response = closureResponse
            expectation.fulfill()
        }

    waitForExpectationsWithTimeout(defaultTimeout, handler: nil)

    // Then
    XCTAssertNotNil(response?.request, "request should not be nil")
    XCTAssertNotNil(response?.response, "response should not be nil")
    XCTAssertNotNil(response?.data, "data should not be nil")
    XCTAssertTrue(response?.result.isSuccess ?? false, "response result should be a success")

    if let
        JSON = response?.result.value as? [String: AnyObject],
        headers = JSON["headers"] as? [String: String]
    {
        XCTAssertEqual(headers["Custom-Header"], "foobar", "Custom-Header should be equal to foobar")
        XCTAssertEqual(headers["Authorization"], "1234", "Authorization header should be equal to 1234")
    }
}
```

All you need to do is override the `taskWillPerformHTTPRedirection` closure on the delegate as shown in the test. If you feel strongly about this behavior being incorrect, then I'd suggest you file a [radar](http://bugreport.apple.com) with Apple.

Cheers. üçª
 It's most likely not implemented that way for security purposes, but more for usability. Forwarding on the `Authorization` headers can fail the redirected request on certain servers. Some servers can throw 400s if they are sent `Authorization` headers when they are not expecting it. Therefore, it's good to follow Apple's lead here. 

If you do need to append the headers to the redirected request, you'll need to do so manually as shown in the test logic above.
  You first need to create your own session configuration with your 3 second timeout, then create a custom `Manager` instance. More info can be found in the [README](https://github.com/Alamofire/Alamofire#modifying-session-configuration).
  What's the full code sample? Please paste the code in rather than taking a screenshot.
 I don't understand what you mean by `serialize the result anymore`.
 Although not displayed in this issue, it appears you temporarily posted the following code into here:

``` swift
        Alamofire.request(.GET, Constants.Path.rootUrl + "/api/users/" + userToShow, headers: headers)
            .responseData { _, _, result in
                print("Success: \(result.isSuccess)")
                print("Response: \(result)")


                if let arrayOfDicts : NSDictionary? = try NSJSONSerialization.JSONObjectWithData(JSON!, options:NSJSONReadingOptions.MutableContainers) as? NSDictionary  {


                        let secImageUrl : getPImages = getPImages()
                        secImageUrl.getProfileImageFromUser(self.userToShow, completionHandler: {

                            (url:NSURL!) in


                            self.profilePic.sd_setImageWithURL(url)

                        })


                        let nameString:String! = arrayOfDicts!.objectForKey("name") as! String
                        let surnameString:String! = arrayOfDicts!.objectForKey("surname") as! String
                        let roleString =  arrayOfDicts!.objectForKey("role") as! String
                        let bioText = arrayOfDicts!.objectForKey("description") as! String

                        let date:String = arrayOfDicts?.objectForKey("birth") as! String

                        let dateFormatter = NSDateFormatter()
                        dateFormatter.dateFormat = "dd/MM/yyyy"
                        let dateNS = dateFormatter.dateFromString(date)
                        let ageInt = self.calculateAge(dateNS!)

                        self.name.text = nameString + " " + surnameString
                        self.role.text = roleString
                        self.age.text = "\(ageInt)"
                        self.bio.text = bioText


                }
        }
    }
```

You have multiple problems in here. You need to wrap your try in a `do` / `catch` block. Additionally, you should use the `responseJSON` serializer for your case. Please refer to the [README](https://github.com/Alamofire/Alamofire#response-json-handler) and the [Migration Guide](https://github.com/Alamofire/Alamofire/blob/master/Documentation/Alamofire%202.0%20Migration%20Guide.md) since there are code samples for all this logic.

Best of luck.
  This PR opens up the `Manager` initialization to allow users to use dependency injection for both the underlying `NSURLSession` and `SessionDelegate`. 
#### Using Dependency Injection for the URL Session

This change was really made due to #794. While libraries like Mockingjay and OHHTTPStubs are one way to perform automation, Alamofire should also allow a bit more control over the URL session creation to allow approaches like DVR to be possible. This PR adds a failable initializer allowing this to be possible.
#### Using Dependency Injection for the Session Delegate

The current design of the `Manager` initialization is tailored to starting up your app, setting up a `Manager` instance and start making requests. It does not however support background session callbacks very well. 

The problem is that you need to configure the override closures on the `SessionDelegate` before actually creating the NSURLSession. Otherwise, you could start receiving delegate callbacks before you've had a chance to hook up the override closures. This PR adds the ability to use dependency injection to pass in a pre-configured `SessionDelegate` that already has the override closures set.
 cc @kylef and @kcharwood 
 :+1: 
 I don't understand why the second initializer doesn't do exactly what you need @dgdosen.

``` swift
    public init?(
        session: NSURLSession,
        delegate: SessionDelegate,
        serverTrustPolicyManager: ServerTrustPolicyManager? = nil)
    {
```

Just create a session delegate, then create your custom session, and pass both in. You have references to both the delegate and the session. Win win.
  You could also use something like [Mockingjay](https://github.com/kylef/Mockingjay) as that instead registers a custom NSURLProtocol to the `NSURLSession` that Alamofire would use.
 Hi @troya2, thanks for opening this issue. While Mockingjay and OHHTTPStubs certainly have their place and are good solutions in most cases, I don't think that relying on an `NSURLProtocol` should be the only way to perform this type of customization.

Therefore, I have made some changes in #795 to make this possible. I've actually been meaning to rework the initialization of the `Manager` for a bit anyways. You opening this ticket gave me enough of a push to dig in and get it updated. The changes in #795 now use DI to inject a custom `NSURLSession` or a `SessionDelegate`, depending on your use case. If everyone could take a look at that PR and give feedback, I'd greatly appreciate it.

I'm going to close this issue out. Please direct all future comments to #795.

Thanks again! üçª
  Run `pod repo update`. Then `pod search Alamofire` will display `Alamofire 2.0.1` as the latest release which fully supports Swift 2.0. You can always check what our latest release is in our [Releases](https://github.com/Alamofire/Alamofire/releases) section in GitHub as well.
  This PR creates a generic `Response` type to help simplify response serialization. Instead of returning a tuple with four different values, response serializers now return a single generic `Response` object. This makes it MUCH easier to use response serializers, and will help users avoid making mistakes such as incorrectly naming the tuple parameters.

I've seen MANY cases of people swapping the `request`, `response`, `data` and `result` parameters in the tuple. They constantly get misused with tends to lead to a large amount of confusion. Additionally, it can cause strange compiler errors that are quite difficult to debug. This PR attempts to address these issues by replacing the tuple with a generic `Result` type with a generic `Response` struct.
### Old Usage

``` swift
Alamofire.request(.GET, "http://httpbin.org/get", parameters: ["foo": "bar"])
    .response { request, response, data, result in
        print(request)
        print(response)
        print(data)
        debugPrint(result)
    }
```
### New Usage

``` swift
Alamofire.request(.GET, "http://httpbin.org/get", parameters: ["foo": "bar"])
    .response { response in
        debugPrint(response)

        // or

        print(response.request)
        print(response.response)
        print(response.data)
        debugPrint(response.result)
    }
```

This should really help alleviate misuse and should simplify response serialization usage with the concrete struct.
 cc @kcharwood and @kylef 
 Absolutely @cristeahub. I'd rework all the README code samples and put together another migration guide.
 :+1: 
 It was definitely intended @cristeahub. The `response` method simply forwards all the data collected from the `SessionDelegate` without any additional processing. The others are all customized to process the data in a specific way.
  This PR is a non-backwards compatible set of changes solving several shortcomings of the current `Result` and `ResponseSerializer` design. Here is a quick list of callouts:
- `Result` type now takes two generic parameters (Value and Error) where the Error conforms to `ErrorType`.
  
  > No longer stores the `data` in the `.Failure` case.
- All response serializers now return the original server data as an `NSData` optional.
  
  > This solves all the issues reported in #779.
- The `TaskDelegate` now stores the error as an `NSError` instead of an `ErrorType`.
  
  > This was changed in #732 and this should not have been. With these changes, consumers no longer need to cast the `error` to an `NSError`. 
- The `ValidationResult` failure case now requires an `NSError` and not an `ErrorType`.
  
  > This means that a custom `Validation` closure MUST return an `NSError`. The change made to address #732 should NOT have been made. All errors generated by Alamofire (including custom Validation) need to generate `NSError` types. Otherwise we force all consumers to have to cast all error objects returned from Alamofire even though they are not using their own custom validation error types.

For more details, please refer to #732, #757 and #779.
 cc @kcharwood and @kylef 
 I would also love feedback here from @jshier, @AnthonyMDev and @jschmid if you have time to check it out.
 Hi @jshier, you aren't missing anything. What you are proposing has never actually been possible. In Alamofire 2.0 your response serializer just isn't called if there was error that occurred prior to response serialization. 

Let me dig through this issue a bit more and see if there's something we can do to make this a bit easier. Off the top of my head I'm thinking that the delegate error (if one exists) should be passed through to the response serializer.
 Okay @jshier, after digging in a bit more, I realized that the issue was MUCH worse than I originally thought. Thank you for pointing that out! I owe you a beer for that one. üçª

I've addressed the issue using the approach I mentioned previously in 025f33bc. All response serializers now receive the delegate error as a parameter in the `serializeResponse` closure.

IMO, this has three major benefits. 1) It fixes the major bug that I introduced üòâ 2) Ensures all response serializers are always actually executed 3) Allows each response serializer to inspect the error and figure out how to proceed. Certain types of errors will actually cause the server to return different payloads. This abstraction would actually allow you to use different parsing schemes based on the error type.
 Awesome! Yes #792 is PR'd on top of this one. The combination of the two is what I'm thinking response serialization for Alamofire 3.0 looks like.
 Thanks @ziogaschr! I'm looking to get it merged into master today or tomorrow. Need to get the ASF to make a review pass here. Once #791, #792 and #795 are merged, I'll be cutting Alamofire 3.0.0-beta.1 to get testing going.
 @kcharwood awesome...thanks for digging through this! üëäüèº 

As for the migration guide, I'll be putting that together here in the next couple of days. I'll be sure to cover all your suggestions in detail.

@AnthonyMDev I'm in the process of merging all these PRs right now and cutting the Alamofire 3.0.0-beta.1 release. I won't have a migration guide put together for a couple of days, but I'm sure you can figure out the API differences from the PRs and the test code.

Everyone else, thanks for helping get this through! üçª
 Okay @jschmid, while I appreciate your feedback, you are using validation and response serialization incorrectly. You should not be creating a custom validation extension to validate the status code, that EXACT functionality already exists in Alamofire and all the error handling is taken care of by the response serializers. If you need to handle a validation failure in the response serializer completion, just switch on the error code like you do for all other types of errors.

Additionally, why would you want to start throwing your own custom errors when you aren't creating your own custom response serializers? That doesn't make sense to me. IMO you're just making your life more difficult...on purpose! Instead, keep all the errors coming out of Alamofire as NSErrors and you can just switch on the error code. Why would you want to have to switch on NSError codes AND your custom error type? That's actually MORE complicated.

By locking down the error type stored in Alamofire to ALWAYS have to be an NSError, it allows all response serializers to be strongly typed which means you don't have to cast the error to an NSError every time you need to access it. This is the 99% case for the Alamofire community. Power users are like @jshier are certainly going to create custom response serializers tailored to their own needs, but the common usage pattern should be as simple as possible. This fits with our overall design philosophy which is to cater Alamofire to the masses by making it as simple and easy to use as possible, while flexible enough to serve the power users.

Locking down the NSError internal type allows us to support some powerful features and more consistent APIs:
- Strongly typed NSError returned by the no-op response tuple method
- Strongly typed errors returned by all generic response serializers
  
  > No more casting to NSError
- Custom response serializers can specify their own strongly typed error encapsulating the NSError being produced by Alamofire if necessary (see @jshier's sample code)
- Consistent generic usage patterns between ResponseSerializer, Response and Result types

Hopefully that helps clear up any possible confusion as well as shed some light on the big picture.
  Remove the `Alamofire.xcodeproj` project from your Xcode project. This will automatically remove all associations to Alamofire from your Xcode project. Then remove the [submodule](http://stackoverflow.com/questions/1260748/how-do-i-remove-a-git-submodule).
  `Authorization` headers should not be set in the `HTTPAdditionalHeaders` dictionary on the `NSURLSessionConfiguration`. Instead, an `Authorization` header should be appended to each individual request. This is the recommendation of both the ASF as well as Apple.
 @eburi which version of Alamofire are you using? Alamofire 2.0.1 contains a fix that should solve this issue for you.
 @phiberjenz and @simonnarang: please refer to the info in #798 for more info on these findings. It walks you through the various options available to you when this happens.

Cheers. üçª
  When making a data request, you receive progress callbacks on the download data, not on the upload data. You should be using `Alamofire.upload` instead. Check out the documentation on [NSURLSessionUploadTask](https://developer.apple.com/library/prerelease/ios/documentation/Foundation/Reference/NSURLSessionUploadTask_class/index.html) for more info.
  The recommended way to send an `Authorization` header is to NOT use the `NSURLSessionConfiguration` `HTTPAdditionalHeaders`, but instead to pass it along with each individual request. This is both the recommendation of the ASF (Alamofire Software Foundation) and Apple. The main reason for this is that the header value tends to change over time.
  I cannot reproduce this issue. I followed the [Adding Frameworks](https://github.com/Carthage/Carthage#adding-frameworks-to-an-application) instructions in the Carthage README and had no issues. Here is some additional info about my setup:

### Cartfile

``` bash
github "Alamofire/AlamofireImage" ~> 1.0
```

### Carthage Version

``` bash
$ carthage version
0.8.0
```

### Xcode Build Version

```
$ xcodebuild -version
Xcode 7.0
Build version 7A218
```

### Building Frameworks

```
$ carthage build --platform iOS
```

Since everything is working as expected, I'm going to close this issue out. If you continue to have issues after all the info I've just posted, I would encourage you to consider opening an issue with the Carthage project or on Stack Overflow to help you continue further. If you do end up finding an issue in the Alamofire project itself, then I'll be happy to re-open this issue.

Best of luck!
  Fair enough. Updated the documentation in 71a26d64 to be more clear. Thanks!
  There is no `swift-2.0` branch anymore, please follow the installation instructions for CocoaPods in the [README](https://github.com/Alamofire/Alamofire/#cocoapods):

``` ruby
pod 'Alamofire', '~> 2.0'
```
  Thanks for the PR @nickygerritsen! I'm not exactly sure how that managed to get messed up in 8873379, but I'm glad it's fixed!

Thanks again! üçª
  Could you both give me a bit better description of what you are trying to do and why the current design of the `.Success` case doesn't give you the flexibility that you need?
 Thanks for your feedback @jshier and @rafaelc0sta...much appreciated! I've just pushed up #791 which should solve all these issues. If you could check it out and provide feedback, I'd greatly appreciate it. I'm going to close this issue out. Please redirect all future comments to #791.
  Swift 2.0 has been supported since the day it was announced.
  The `Content-Type` header is set for you automatically. You don't need to generate your own.
 You can if you encoded the data yourself by creating your own `MultipartFormData` object, encoding the data, then manually creating a `Request`. The convenience method does this all for you.
  Hi @tobiasolofssonevry,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thank you for your feedback @grantjbutler. 

This is a great question. Long story short is that your [HTML 4.01 spec](http://www.w3.org/TR/html401/interact/forms.html#didx-applicationx-www-form-urlencoded) (created in 1999) is outdated. All the Alamofire logic and tests are driven from the much newer [RFC 3896](https://www.ietf.org/rfc/rfc3986.txt) spec published in Jan 2005. We have MANY [tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/ParameterEncodingTests.swift#L38-L235) around this behavior as well as some fairly verbose [documentation](https://github.com/Alamofire/Alamofire/blob/master/Source/ParameterEncoding.swift#L192-L216).

Cheers. üçª
  I can't spot anything obvious. Could you post the `debugPrint` output of the `Request` you are creating with `Alamofire.request` call? That would certainly help. Also, you should try to use that cURL to see if you can hit your server as expected.

Another thing I would suggest is to open a question on Stack Overflow. You'll get many more people to help you debug your issue.
 I'm going to close this issue out. Please open an issue on Stack Overflow @mikewalkerjr. If you post the link in this issue, I'm sure either @jshier or myself will be able to continue to help you out there.

Best of luck.
 @PurviJani Posting on old issues is not a good way to get support. These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @Baza207! üçª
 I ended up resetting the merge and just cherry picking your change in 2d8466cd. In the future, if you could rebase before you push up your PR, that would be greatly appreciated. 

Thanks again!
  Hi @Jayvd,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Thanks!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 The solution is already there @cloudjanak. You can use the other `appendBodyPart` methods to accomplish the same thing.
  It supports Swift 2.0. Please take the time to read the [documentation](https://github.com/Alamofire/Alamofire#requirements) in the future. Thanks!
  Hi @cczufish,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for your PR @bscarano...much appreciated! 

I merged a slightly modified version of your PR in 8873379b. I wanted to make sure all the settings were correct, so I created the framework and test targets myself going through each step carefully. I still gave you attribution for the change. I also want to keep this separated from the `master` branch until it's officially released.

Thanks again! üçª
  The `debugPrint` output is printing out the `description` of the successfully parsed JSON `AnyObject`. It's not printing out the JSON itself. This works as expected.
  Thanks for your PR @Baza207...much appreciated! I ended up merging a modified version of #767. Thanks again!
  We will not be adding a dependency to the core Alamofire framework. Adding a dependency has many risks and greatly increases complexity for those adopting it. The fact that the two Result types collide is something you can easily resolve on your end by adding the framework namespace. 

The Alamofire `Result` type does not contain all the same complexity due to the fact that it does not need it. If you feel there are certain cases that our current implementation does not handle properly or as well as it could, then please open a pull request with a good explanation of why the additional logic is necessary, and we'll take a look.
 Looks like there are radars filed @marcelofabri and there's also an acceptable workaround to the problem. While I understand it's not as convenient as you would like, I don't think it's appropriate for us to rename our classes due to other third party library collisions.
 @Rupert-RR it is a very unwise decision to couple to any dependency that you do not control for large open-source projects. Anyone that has been responsible for such a library knows exactly what I mean by this. As soon as you add the dependency, you are forever bound by that dependency if there are new Swift beta releases, bugs, changes that don't conform to semver, etc. This is not something we're interested in exposing ourselves or the community to.

Additionally, the `Result` type provided in Alamofire is tailored specifically to Alamofire use cases. It is not intended to be used as a solve all `Result` type outside of Alamofire APIs. It also includes an additional `data` associated value in the `.Failure` condition which the antitypical/Result library doesn't support.

Hopefully that clears up any confusion.
 Let's agree to disagree @Rupert-RR. I'm not interested in discussing this further.
  Your `Downloader` instance is probably getting deallocated which is deallocating the `mngr` instance.
  You cannot do this with asynchronous calls. 

The easiest way to explain it would be to have you create a playground where you `dispatch_async` to one of the global concurrent queues. Then try to throw inside the closure of the `dispatch_async`. This is the underlying issue with attempting to throw with async operations. Instead, you need to pass the error off to your `completionHandler`.
 Yes, you are missing the core problem. Try to throw inside a `dispatch_async` call in a playground and you'll start to see what the problem is.
 I cannot speak for Apple @kevinbelter but it is certainly a design flaw with the error handling system which is why we use the alternative concept of a `Result` type in Alamofire.
  @wizgod Could you please confirm which version of iOS you are having this problem?
 Also, could you let us know how you installed Alamofire into your project.
  Hi @RyanCodes...thanks for your PR. Unfortunately this doesn't properly add support for `tvOS`. We'll be putting together a branch to add proper `tvOS` support early next week. Thanks again!
  Not actually a duplicate, this is for Carthage not CocoaPods. #759 fixes this.

@imns Please use the following in your Cartfile:

``` odgl
github "Alamofire/Alamofire" ~> 2.0
```
  @AnthonyMDev thanks for your feedback. You are absolutely right and it should be implemented as a double generic `Result`.

For a bit of background, the `Result` type originally took an `NSError`. When working with @jshier in #732, I changed the `Result` to take an `ErrorType` 64a00447. Instead, I should have made the `Result` a double generic and forced the error to conform to `ErrorType`. 

I'm currently working with the ASF to figure out how to proceed here. I'll update the issue once we decide what we're going to do. Thanks again for bringing this to our attention.
 We will not be adding a dependency for a Result type @Rupert-RR. Please see #764 for more info.
 Okay @AnthonyMDev, we've finally landed on how to attack this issue and I've just pushed up #791 which addresses the core design flaw. If you could check it out and provide feedback, I'd certainly appreciate it. I'm going to close this issue out. Please redirect all future comments to #791.
  Thank you for your feedback @roymckenzie!

There is not currently a way to set the `ParameterEncoding` type for all requests, nor do we think it's in the community's best interest to add one. The most common case is certainly to use `.URL` encoding for `GET` requests. Adding an override into the `Manager` would not only complicate the implementation, but could (most likely would) lead to confusion.

Thanks again.
  I think this crash comes from `NSURL(string: URLString.URLString)!` since you're passing in an invalid URL (URLs may not contain spaces).

URLs should be urlencoded and thus any spaces should be replaced with `%20`. The second example you have shown is properly encoding and escaping characters and thus doesn't crash.
 @tosbaha If Alamofire URL encoded your input, it still wouldn't become a URL because the `:` and `/` would be escaped.

```
http%3A%2F%2Fwww.example.com%2Fabc%2Fdef.asp%3Fk%3Dabc%20def
```
 @tosbaha the docs state:

``` swift
public protocol URLStringConvertible {
    /**
        A URL that conforms to RFC 2396.

        Methods accepting a `URLStringConvertible` type parameter parse it according to RFCs 1738 and 1808.

        See https://tools.ietf.org/html/rfc2396
        See https://tools.ietf.org/html/rfc1738
        See https://tools.ietf.org/html/rfc1808
    */
    var URLString: String { get }
}
```

If you do not end up using the Alamofire `ParameterEncoding`, then you risk the possibility of certain characters not being escaped properly. This is exactly why we would recommend you always use the `ParameterEncoding` enumeration to do this. The `URLStringConvertible` protocol is merely convenience. It should not be used in cases where you are not confident that the URLString is valid. 

We do not want to combine the concept of character escaping with the `URLStringConvertible` protocol because as @kylef mentioned, there can be some very strange behavior that causes way more harm then good.

Best of luck.
  An `NSMutableURLRequest` is a reference type. You don't need to use an `inout` declaration on it. It will modify both instances. If that doesn't completely solve your problem, please open an issue on Stack Overflow.

Best of luck!
  Yes, iOS 7 is not supported in Alamofire 2.0. We're supporting current and previous versions of iOS (9.0 and 8.0)
  You need to use the Xcode 7 GM. Then everything will build properly. If you continue to experience issues (unlikely), then please open a question on Stack Overflow.
  Thanks @dwightwatson.
  Thanks @keith. I just updated the README installation instructions in 343e24073990172de3c55871762f68d49838a3ce @codebeaulieu. Cheers.
  Thank you for your PR @bojan. We are not going to support iOS 7 in Alamofire 2.0. Please see #554, #525, #523, etc. for more info.
  Interesting. The only thing that strikes me as surprising is the `encodingMemoryCompletion` being modified to such a large value. Could you put some timings around how long the encoding takes and how long the upload takes just to have more info to go on? Could you then drop the `encodingMemoryThreshold` to zero and run the same timings?

Other than that I cannot see any actual issues with your logic. Alamofire does not doing anything to throttle your upload.
 I'm not sure what to tell you unfortunately. This is not an issue with Alamofire, but is instead of issue with your network or device. I would suggest taking your question to Stack Overflow. Maybe they will be able to help out more.

If you do end up finding an actual issue with `MultipartFormData` uploading, then please add some additional info and I'll be happy to re-open the issue.

Best of luck.
  Thanks @paulyoung.
  Make sure to copy the example from the [swift-2.0](https://github.com/Alamofire/Alamofire/tree/swift-2.0#crud--authorization) branch and not `master`. The `URLRequestConvertible` protocol has changed between Alamofire 1.0 and 2.0. For more info about migrating to Alamofire 2.0, check out our [migration guide](https://github.com/Alamofire/Alamofire/blob/swift-2.0/Documentation/Alamofire%202.0%20Migration%20Guide.md).
  This has been a long withstanding problem that has been reported and questions many times on GitHub or Stack Overflow (#283, #374, #623, #646). Issue #374 has a wealth of information about the different options and a healthy debate between @mattt and @mxl. For this particular issue, I tend to side with @mxl.

Having personally had to deal with services constantly that require appending parameters to the query string for .POST and .PUT methods, I felt it was time to add support into Alamofire to make this situation more palatable for everyone. The main challenge is avoid complicating the `ParameterEncoding` enumeration to keep it simple even though we need to add another case or condition. I think this change strikes a nice balance.

I tried to update the documentation to make it as clear as possible to understand the differences between the two cases.

Other alternatives I consider were `.URLEncodedInQueryString` (too verbose), `.URLQuery` (too vague), and also adding a flag to the `.URL` case such as `.URL(encodedInURL: Bool)`. The problem with this approach is that you cannot specify a default parameter in an associated value.
 cc @kcharwood and @kylef 
  Thank you for your PR @dduan...much appreciated! 

Unfortunately, I've decided not to merge this change into Alamofire. I definitely see where you were trying to go with this, but I think the fact that you need to hand it the `session` and the `credential` are simply proof that it is trying to do too much. I also think that by `nil`ing out the parameters, users could get confused why their `cURL` commands aren't working properly when they're not getting an accurate representation of the actual request.

Thanks again.
  Hi @paulyoung, my apologies for not getting back to you sooner. I've been working on wrapping the AlamofireImage release over the past week. 

Your issue certainly seems to be a bug in the implementation of Alamofire. My best guess at the moment is that we always need to write to a file if the session configuration is a background configuration. I'll dig into this theory today and get back to you.

Thanks for all the hard work here debugging this. Much appreciated! üçª
 It's all good dude. No worries. I just managed to get a test case put together that reliably produces this crash 100% of the time. Should have a fix up soon! üëçüèº
 Fixed in 441a9dca. Thanks again for the awesome details! üçª
 There are. I haven't decided whether we're going to cut one this weekend or wait until the GM drops. If we end up cutting one this weekend, you'll see it go out over Twitter. üëçüèº
 You know what, you're right! I'll cut 1.3.2 here shortly.
 So unfortunately, this cannot be back ported. It looks like the nullability on the `identifier` property is set incorrectly in the iOS 8 SDK. It thankfully is fixed in the iOS 9 SDK. Since there's no other way that I know of to run this check, it looks like you'll have to work around this limitation on your own.

What your can do @paulyoung is set the `encodingMemoryThreshold` to zero which will cause the upload to always write the file to disk before the upload. That will certainly work for you for now until you update to Alamofire 2.0.

Sorry dude üòï
  @jshier is correct. If your `Content-Length` is unknown, this is the behavior you should see. I'm going to close this out. If you find that `Content-Length` is actually known and believe there is truly an issue, please provide more info and I'll re-open if necessary.

Cheers.
  Hi @genu1,

I just added tests around this behavior in 33dcfd4b demonstrating how to do this. I'm not exactly sure why you are crashing, but Alamofire can handle this case without issue. I'm going to close this issue out for now. If you provide more info that leads us to believe there is an issue in Alamofire, we'll be happy to re-open.

Cheers. üçª
  NSNull is still really burdensome to deal with, even in Swift.
 I actually have a pull request for this that is very similar
 #737 addresses this
 Hi @harlanhaskins, after much thought, this is not something we will be adding directly to Alamofire. 

The reason is that this has fairly serious performance implications for large JSON payloads. It is MUCH more performant to handle the `NSNull` values at your actual JSON parsing level. While it's not as convenient, there are certainly JSON libraries out there that can easily handle `NSNull` values.

Now with that said, you can still add this to your app or wrap it into your own custom response JSON serializers. If this is how you want to handle these, then by all means, go right ahead. We just aren't looking to add this functionality directly into Alamofire core.

Thanks for the suggestion!
  We'll do this once the GM is cut and not before. We're all over this.
  Hi @tryadelion,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Okay, next time you open an issue, please be a bit more specific. You just answered you own question which is why I pointed you to SO in the first place. Alamofire already supports your use case and is documented accordingly. It does not have your "exact" use case, but certainly walks through creating an `NSURLRequest` and passing that into the `request` method.

If you actually have a feature request (I think you might), then please open the issue as such with a well thought out case. More times then not, those cases actually get implemented in some form. Just please keep in mind that we want to build convenience layers for the common cases, yet remain flexible enough to cover all cases.
  Yep, you need to be on beta 6 for the latest `swift-2.0` branch commits or the Alamofire 2.0.0-beta.3 release.
  We have now transformed the `Result` type and all uses of it to use the `ErrorType` for exactly that reason. We continue to generate `NSError` objects inside Alamofire to guarantee that that is the only error type that will ever come out of Alamofire. Using the `ErrorType` though in the `Result` type gives all developers the freedom to wrap all Alamofire error in their own `ErrorType` enumeration.
 Those are all perfectly valid points @jschmid. Thanks for putting together all your feedback to make your case. To make a very long story short, I agree and I've updated all the logic around all result types in Alamofire to use `ErrorType` instead in 64a00447.

Originally @jshier and I worked through the changes on the `Result` type and we just missed the other cases. The validation case you are referring to is more-or-less the same issue @jshier and I were originally discussing. I think the changes in 64a00447 should completely remove this limitation.

Thanks again!
 Hey @jschmid and @jshier!

I've been reworking the error handling and response serialization logic and just pushed up #791. If you guys could check it out and provide feedback, that would be great! What we ended up doing here in 64a0044 was not the best decision.
  Is there any way you could provide a failing test for this change? That would help us debug to make a more informed decision.
 Thanks for your PR @cheolhee! 

After much investigation, I've decided to merge this change in 21040abd. I've also added a test around the POST behavior in ba6d3dd5.

With that said, I only made this change due to the fact you're seeing issues without the change. I cannot see any downsides to making the change. This [thread](http://stackoverflow.com/questions/16819502/application-x-www-form-urlencoded-and-charset-utf-8) makes me believe though that the `charset` should not really be required. Additionally, no actual unicode characters will ever make it into the HTTP body since all parameter key/value pairs are percent escaped prior to be encoded into UTF-8.

I'm assuming your server is requiring the `charset` when it actually shouldn't. Either way, as I mentioned, I cannot see any downsides to adding it.

For future reference, there's a good amount of information about the encoding algorithm [here](http://www.w3.org/TR/html5/forms.html#application/x-www-form-urlencoded-encoding-algorithm).
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @blixt,

Thank you for taking the time to put together this really well thought out issue. You have some very good feedback and use cases that others could learn from about the way Alamofire is intended to be used and is designed.

### Issue

I think the biggest issue you are fighting at the moment is that you are trying to funnel three very different types of requests through the same root method. Additionally, you're trying to build all three requests using the same `URLRequestConvertible` implementation. Now I completely get why you are trying to boil your API calls down, but you've passed the point of no return with reusability IMO.

### Splitting Up URLRequestConvertible

Why not create three different types of objects with their own implementations rather than trying to jam them all into one? You have three different types of requests to make, so have three different wrappers for these types of requests? This would certainly solve the issues you are fighting against at the moment. I think the code samples in the [API Parameter Abstraction](https://github.com/Alamofire/Alamofire/tree/swift-2.0#api-parameter-abstraction) and the [CRUD](https://github.com/Alamofire/Alamofire/tree/swift-2.0#crud--authorization) examples demonstrate how to sensibly encapsulate similar chunks of logic. What I would not encourage though is to use a single enumeration to work for EVERY single API. It gets too daunting to handle all the cases, especially when your request types are so drastically different.

### Don't Funnel into a Single Alamofire Call

Another suggestion I have is to not try to wrap your entire API into a single call into Alamofire. Instead, I tend to wrap APIs as follows:

``` swift
class SomeService {
    static func callFirstService(parameters: [String: AnyObject], completion: ModelObject? -> Void) {
         // Implement some Alamofire.request() call fully tailored to this service call
         // Attempt to parse the logic into the model object and serve it back to the callback
    }

    static func callSecondService(parameters: [String: AnyObject], completion: ModelObject? -> Void) {
         // Implement some Alamofire.request() call fully tailored to this service call
         // Attempt to parse the logic into the model object and serve it back to the callback
    }

    // So on and so forth
}
```

> This approach let's you tailor each `Request` to the service you are calling. Alamofire is MUCH easier to use with this approach rather than funneling these calls into a single call to execute the request.

### Embrace Chaining

The approach you've taken really goes against the idea of method chaining. Alamofire makes it really easy to customize the setup of a request, validation and response handling. It is not structured at all to handle all these cases in a single API. This is one of the most powerful parts of the Alamofire design, and you are really working against it rather than embracing it.

### Summary

I really appreciate all your feedback. It's very helpful to see where people are running into design issues when leveraging Alamofire to call their APIs. I would really encourage you to read through this feedback carefully and consider these design suggestions. Alamofire can easily achieve what you need, but gets complicated with the way your trying to funnel your calls through it.
 Hi @blixt,

Now we're narrowing it down. I couldn't agree more with your comments about the Facebook API. That's exactly the message I was trying to relay in my "Don't funnel into a single call" section. We're on the same page there. Alamofire makes that quite simple with the exception of `MultipartFormData`. I think my biggest take away here is your frustration with the two-step handling of `MultipartFormData`. 

It was designed that way because it has to be if you are uploading a large amount of data. The data needs to be encoded to disk before you can create the request. Since the request isn't actually created until the encoding completes, the method call cannot return the request to allow for chaining. The only way it could return a request to allow for chaining would be to encode the data in memory or on disk on the caller thread and directly create the upload request and return it. This has very problematic implications with blocking the caller thread for a significant amount of time. This is why uploading `MultipartFormData` was designed as a two-step process.

Now, you could certainly make this a one step process by pre-encoding the `MultipartFormData` manually, then handling off the already encoded data to the regular upload methods (data, file, stream). This would allow you to chain both approaches in the same manner. If you have other suggestions on how to handle the two-step problem in a more elegant manner, I'm all ears. IMO there isn't a better way to do this unless all NSURLSessionTask creation was deferred until `Request.resume()` was technically called. This however would require a complete re-write of the Alamofire core logic and would have MANY other downsides.

As for your last comment of controlling what data is put into the query string and what is put into the body, I tend to disagree. If you need fine grained control, create your own `NSURLRequest` objects with the `ParameterEncoding` enum and then pass that `NSURLRequest` into the `URLRequestConvertible` methods. The convenience APIs designed to do it all in one step (request, download, upload) are a bit too convenient for you. With that said, there is currently a PR open to add another URL encoding case that will at least allow you to specify that the encoded parameters should go into the URL and not the body regardless of the Method.

Great discussion...thanks for all the feedback. So far I don't have any actionable items here. If you can come up with some suggestions on the `MultipartFormData` design, I'm happy to revisit the design of the upload methods.
 Hi @blixt,

Your serializer suggestions are good, but lack the context around the limitations of this type of implementation on iOS. Subclassing `NSInputStream` is VERY fragile and simply not recommended. We've learned the hard way from our trials with AFNetworking. This is why we went with the approach we did in Alamofire. It is much more robust and reliable. You still aren't addressing the fundamental issue of encoding the data before creating the `Request`. You cannot do it after you create the `Request`. You're ideas are all really good, but they aren't possible to implement. Believe me, I considered them heavily before building the current implementation.

As for your challenges with using `ParameterEncoding` in both the query string and the HTTP body, you can still handle this case by using a combination of `ParameterEncoding` and `URLRequestConvertible`. Alamofire has always been designed to make the common cases as simple as possible, while being flexible enough to still allow you (the power user) to perform any operations that you need by having access to the underlying URL Loading System.

I appreciate all your feedback in this thread. I think it is very useful and well thought out. As a takeaway, I would challenge you with a couple things. 1) Try to work with Alamofire rather than working against it. It's not designed to be perfectly convenient for every use case. It's designed to be convenient for the common cases, yet give you the flexibility to control what you need. Layer the convenience levels around it in your own APIs to abstract the Alamofire complexities. 2) Open a pull request with your ideas and suggestions on how we can make improvements. We are in no means locked into any way of doing things. We take the submitted PRs very seriously and love it when new ideas and designs come in from the community.

Cheers.
  Hi @carlshimer,

I'm not sure where you see that the `completion` closure needs to be called on the main thread. I've dug through all the Apple [docs](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIApplicationDelegate_Protocol/#//apple_ref/occ/intfm/UIApplicationDelegate/application:handleEventsForBackgroundURLSession:completionHandler:) I can find and cannot find anything that references that. Additionally, I have several apps built ontop of Alamofire that do have functional tests around this behavior that do not call the `completion` closure on the main queue and I haven't seen any issues.

I'm going to closure this issue out for now. If you can provide some additional information that merits further investigation, I'll be happy to re-open.

Thanks! üçª
 Exactly what I was looking for and couldn't track down. I'll get this fixed asap. üëçüèº
 Addressed in 4264b9d5. Thanks for pushing back here!
  Not sure I understand your question.

> How can i force to append as an string?

All data placed into the HTTP body of the upload request needs to be encoded into `NSData` before being transmitted. It's a bit more complicated than that under-the-hood, but at a higher level, that is the easiest way to explain it. Therefore, you cannot append a string. You can only append a String encoded as `NSData`. 

Does that make sense?
  Thanks for your PR @jschmid! I pushed a slightly modified version of your changes in d4301808 giving you attribution.

Thanks again! üçª
  Thanks @cristeahub.
  Sweet! Thanks for the PR @dfmuir. üçª
  Thanks for the heads up @kodayashi. We will certainly get this fixed.
 Thanks for reporting @kodayashi! Your issue should be resolved with 8023191f.
  Hi @conradwt, thanks for your question and feedback!

At the moment, I think this is something that we should not support. The reason being that there are just too many assumptions that need to be made to write these types of "convenience" methods. 
- How do we know which `NSStringEncoding` to use? 
- How do we know which type of `NSDate` formatter you want to use?

Because of this ambiguity, I think it's best to leave these types of methods out of Alamofire. IMO, they should instead be created as extensions on the `MultipartFormData` class that internally creates the encoded data that you need, then calls the appropriate Alamofire method.

Does that make sense?
  Is there any possible way you could provide us sample code that we can actual run to help us debug the issue? We already authentication challenge tests that are passing as expected.
 Hi @avf, I need your help to debug this. I don't have a way to test NTLM authentication. If you could provide more information that would be really helpful. Would you be able to provide actual sample code that I could run? If you're worried about obfuscation, would you be willing to work with me through email or Slack?

We have tests around this for basic and digest auth that work just fine with that code change. Please get back to me asap. I'd like to get this tied off before the Alamofire 2.0 release.
 Thanks for getting back to me @avf. Unfortunately, since we don't have any way to test this, I'm going to have to close this out for now. If someone runs across this issue again, we can re-open or debug at that time.

Cheers. üçª
 Would you be willing to help me debug this issue @mubashirjavaid? It may take a bit of time to figure out the issue. I may need you to try some different branches to try out some different approaches. Also, would you be able to provide me with enough sample code that I could debug the problem myself. I'd be happy to work with you in a non-public facing way such as through Slack or email.
 Got some awesome info for debugging this from @mubashirjavaid! Once I have a chance to dig through the issue I'll report back what I find. Hopefully I'll have a fix.
 Okay...got to the bottom of the issue. Thank you so much @mubashirjavaid for helping me debug the problem. I wouldn't have been able to figure out what the root cause was without your help! üçª

The issue was in fact the commit b69959b. That was a very bad change on my part. I have reverted that change in a9480269 and made another bug fix in 6ac4ce17. I was able to verify that a9480269 does in fact fix the NTLM issue. It also fixes some other unwanted behaviors.

I'll be pushing out 2.0.1 here shortly that will include this fix. Thanks everyone for helping get to the bottom of this issue. Alamofire is much better off for it!
  Thanks @cristeahub.
 I'm not sure if there's an alternative. The main reason we've dropped support is that we cannot test it due to the fact that iOS 7 doesn't support frameworks. We'd need to duplicate our entire test suite which is just not reasonable. Therefore, to keep our quality as high as possible with full test coverage, we made the tough decision to drop iOS 7 support.

If you are willing, it would be quite easy to fork Alamofire and make the necessary fixes for iOS 7.
  Hi @kaelite, thanks for the suggestion! I completely agree and implemented the change along with tests in 4e633d6d.

Cheers. üçª
  Thanks for your PR @sai-prasanna! Much appreciated. This task was actually sitting in our Trello backlog. I pushed a modified version of your PR in 282eec67 while still giving you attribution. 

Thanks again for your changes! üçª
 @sai-prasanna, the only suggestion I have would be to look at the diff between what you submitted and what I actually committed. That will help you find the differences in phrasing, code structure, etc. Otherwise, just keep the PRs coming...best way to learn is to practice! üëçüèº
  You can get the decoded JSON payload from the result you've printed in your example.

``` swift
Alamofire.request(.GET, "https://api.someplace.com/", parameters: nil, encoding: .JSON, headers: headers)
    .responseJSON(completionHandler: { _, _, result in
             switch result {
             case .Success(let payload):
                 print(payload)
             case .Failure(_, let error):
                 print(error)
             }
    })
```
  Great catch! Just one comment and then we can get it merged.
  So after much thought I think we should leave this as is. The main reason is that in some cases, we aren't going to want to call the progress closures on the main thread.

For example, if you have some library that you are working on that handles asset downloads, you probably want Alamofire to call your library off the main thread so you can then handle some processing and then eventually bubble it up to the main thread. If we automatically dispatch the progress closures to the main thread, you'll have to then dispatch again to get off the main thread causing unnecessary dispatching.

The downside of not changing the behavior is that you must dispatch to the main thread if your progress closure needs to update some user interface values. While this is unfortunate, at least you still have full control over the behavior.

Thanks for opening the issue so we could investigate!
 Absolutely @grundid...I've added a task to our Trello project to get the docs updated before the 2.0 release. I'll update this issue once I've done so. Thanks again.
  Thanks @ikesyo.
  The 2.0.0-beta.1 release compiles on beta 5. The 2.0.0-beta.3 release compiles on beta 6.
  Hi @hengchengfei,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Dependencies in CocoaPods are have a locked commit/version, to update to the latest you may run `pod update Alamofire`.
  Hi @danwalkowski,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Both of you need to be on the Alamofire 2.0.0-beta.2 release with Xcode 7 beta 6.
  This looks great @mishagray! Thank you for putting this together...much appreciated! üçª
  Thank you for your PR @mackuba. Unfortunately I ended up merging the changes in #707 that fixed the iOS Example as well. Thanks again.
  Hi @telenc,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  While it is certainly possible to return multiple auth challenges, it is not recommended which is pointed out in [RFC 2617 - Section 4.6](http://tools.ietf.org/html/rfc2617#section-4.6). The following threads have more info.
- [Delimiters for WWW-Authenticate for multiple schemes](http://stackoverflow.com/questions/10239970/what-is-the-delimiter-for-www-authenticate-for-multiple-schemes)
- [WWW-Authenticate header - multiple realms](http://stackoverflow.com/questions/3576197/http-authentication-www-authenticate-header-multiple-realms)

Since this is not common case, your only option is to override the `taskDidReceiveChallenge` which you already have. I don't think it's a good idea to add further support to Alamofire for this case since it is not only not recommended, but is also quite rare. Thankfully, you can already override the behavior by overriding the session delegate's task closure. This is exactly why they were opened up in the first place.

It is unfortunate that you need to replicate some of the logic, but that's certainly a better alternative for the community when you consider the 100s of use cases that are not common behavior. We're trying to keep Alamofire simple to use for the common cases, yet flexible enough that power users can customize everything that they need.

Best of luck.
  The reason that `NSError` was originally used was not allow any Alamofire users to have to switch on the error types coming out of Alamofire. Since most of the errors are `NSError` objects generated by the URL Loading System, we decided to keep all errors generated by Alamofire logic to be `NSError` objects as well to make it easier for the consumer.

With that said, we did not spend enough time considering the power user that is creating their own response serializers. I think it is a great idea to wrap up Alamofire errors and then your own custom errors into your own custom enum to make it easier for yourself at the app level. For anyone that is willing to go to those lengths, the Result type was restricting you from doing that in a Swift-like manner. Because of this, I've updated the Result type to now take an ErrorType in the Failure case in e489c5fe.

Thanks for the awesome feedback! üçª
  Hi @AndriyGo,

This may be helpful: https://forums.developer.apple.com/thread/3653.

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for pointing this out. Would you be willing to put together a pull request for this and verify that the code compiles?
 Thanks for all the info @thebluepotato. I've updated the README with slight changes to your example code in eabd1734.
  Please see #588 and #383. Cheers.
  Hi @mudithsilva,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I agree with your assessment...but unfortunately this is not something we can control. You're setting the headers on the NSURLSessionConfiguration which is not an Alamofire object, but part of Apple's URL Loading System. Additionally, this behavior works in certain cases, and not in others. This is why we make the blanket recommendation.

Another reason we recommend not setting a `Content-Type` header in this way is that it should be set on a per request basis. The parameter encoding enum also sets this value directly on the `NSURLRequest` in most cases.

We've also run into odd behaviors with whether this works as expected on certain versions of iOS. If you do end up need to set the header in this way, make sure to set the values on the configuration before you create the Alamofire `Manager` instance.
  Is the intention to be able to subclass the `ServerTrustPolicyManager` and override this method to be able to support things like wildcarded domain names? If that's the case, do we also need to open up the `policies` dictionary so you can access it?

``` swift
public private(set) let policies: [String: ServerTrustPolicy]
```
 Thanks for this @jriehn. I pushed your changes into the `swift-2.0` branch in 6c38ad01 and into the `master` branch in 8d659cc0. I also opened up the `policies` dictionary and added docstrings in subsequent commits.

Thanks again! üçª
  We will not be renaming anything in Alamofire due to some collision with another third party library. We cannot let other outside libraries, in which we have no control or influence, govern our naming conventions. That would be a poor policy for our users.

In this case, I would consider continuing to work the problem and think of outside the box solutions. What about the possibility of typealiasing the `Result` from `antitypical` in your project and using that instead? I'm sure there are other options as well.

Best of luck!
  We just added tests in 10f94788 to verify that this is working correctly for all types of session configurations on iOS 9. Everything is working as expected with only Alamofire. Please check out the logic in that commit and see where you may be doing something different.

Are you using any libraries that mess with `NSURLProtocol`s?
 Cool...glad you got it figured out! üçª
 Yes @ADevelopStudio, that approach would certainly mitigate this issue. I just wanted to verify with @pvegh that there was some implementation issue and that he wasn't experiencing an issue that we don't have tests for.
  Fixed in bf86ff50.
  I just added some tests in 10f94788 to verify that this is working as expected. The tests are passing without any issues on iOS 9. I currently have an Xcode 7 issue where none of my iOS 8 simulators are working so I can't verify the tests there.

Could you provide some additional details around your issue?
- Which version of Xcode are you using?
- Which branch, tag or commit are you build Alamofire on?
- How did you build Alamofire?

Also, you should be adding the headers to the configuration before you create the `Manager`.
 Thanks for pointing the issue out @tkrajacic. I fixed the issue in bf86ff50. The fix was terrible to get right. The `#available` checks are not working as expected and I had to switch over to using an OS predefine. If anyone else can find a better solution here I'm all ears.
 @Jeanblanc88 I'm glad you figured out your `manager` instance was not being retained. 

As for your issue now, using an ephemeral background session does not disable caching. It only switches it over to using in-memory caching. To disable caching, you should set the [URLCache](https://developer.apple.com/library/mac/documentation/Foundation/Reference/NSURLSessionConfiguration_class/#//apple_ref/occ/instp/NSURLSessionConfiguration/URLCache) property on the `configuration` to `nil`.

I'm going to close this issue out since it has been resolved. If you have any further issues with the caching behavior, I'd encourage you to open a question on Stack Overflow.
  I just used your `Podfile` along with CocoaPods 0.38.2 and Xcode 7 beta 5 with no issues. I'm not sure where your problem stems from, but everything is working fine for me with all the info you have provided. I would also suggest you change your Podfile to the following:

``` ruby
platform :ios, '9.0'
use_frameworks!
pod 'Alamofire', '2.0.0-beta.1'
```
  Bitcode is enabled in both Debug and Release configurations for the watchOS target in the `swift-2.0` branch. I just built Alamofire on all three OS's using Carthage without any issues.

### Cartfile

``` bash
github "Alamofire/Alamofire" "swift-2.0"
```

### Carthage Version

``` bash
cnoon:~/Desktop/CarthageChecker$ carthage version
0.8.0
```

### `xcodebuild` version

``` bash
cnoon:~/Desktop/CarthageChecker$ xcodebuild -version
Xcode 7.0
Build version 7A176x
```

### `carthage update` output

``` bash
cnoon:~/Desktop/CarthageChecker$ carthage update
*** Fetching Alamofire
*** Checking out Alamofire at "9a1e321cf0a345b32142394446fa1a7e08cf6942"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.zLOTLA.log
*** Building scheme "Alamofire OSX" in Alamofire.xcworkspace
*** Building scheme "Alamofire watchOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
```

If you continue to experience issues, I would suggest opening an issue with the Carthage project.
 Hi @Sljux, I just filed [Carthage 790](https://github.com/Carthage/Carthage/issues/790) which hopefully will help resolve the issue. I was able to reproduce the behavior you're seeing.
 It appears that you MUST have an iPhone + watch simulator set up in Xcode before you can use Carthage to compile the Alamofire watchOS framework. Not entirely sure why, but at least know we know how to solve the problem.

Please refer to [Carthage #790](https://github.com/Carthage/Carthage/issues/790) issue for more details.
  Thank you for your PR @yanke-guo. Could you provide me a good description of why you feel this change should be made? At the moment I don't feel this is a good change to make for the project.
 Okay @yanke-guo, I'm going to close this out.
  Thanks @ikesyo.
  We will officially release 2.0.0 when Xcode 7 goes GM. At that time we'll merge the `swift-2.0` branch into `master`. Cheers.
  Any mismatch has been fixed in the `swift-2.0` branch and the Alamofire `2.0.0-beta.1` release.
  `swift-2.0` branch is targeted for the latest beta (Xcode 7 beta 5). You would need to pin to the commit bbdd0f8833113d3a7ec08dda59107b41f205edbe or such for beta 4 support.
  Great point. I updated the documentation in aff4311e. Thanks for letting us know! üçª
  I would guess your `manager` instance is going out of memory. You need to keep a reference to it so it doesn't get deallocated.
 Cool...glad we figured it out!

I hesitate to put that in the documentation. Hopefully this Issue will help others catch the mistake. 
 Fair enough. I pushed 9a1e321c to address this. Thanks!
  You need to be on the latest commit on the `swift-2.0` branch on Xcode 7 beta 5. You could also use the `Alamofire 2.0.0-beta.1` release from CocoaPods. It WILL NOT work any other way.
 You need to be on the latest version of CocoaPods and also confirm your command line tools are set to Xcode 7b5.
  Of course! Here's how you would do it:

``` swift
Alamofire.upload(
    .POST,
    URLString: "http://httpbin.org/post",
    multipartFormData: { multipartFormData in
        multipartFormData.appendBodyPart(fileURL: unicornImageURL, name: "unicorn")
        multipartFormData.appendBodyPart(fileURL: rainbowImageURL, name: "rainbow")
    },
    encodingCompletion: { encodingResult in
        switch encodingResult {
        case .Success(let upload, _, _):
            upload.progress { bytesRead, totalBytesRead, totalBytesExpectedToRead in
                print(totalBytesRead)
            }
            upload.responseJSON { request, response, result in
                debugPrint(result)
            }
        case .Failure(let encodingError):
            print(encodingError)
        }
    }
)
```
  Could you please post your `Podfile`?
 Glad everyone figured it out! üëçüèº
  Answered on Stack Overflow.
  The `fileURL` is in your `destination` closure. You are providing the URL, so make sure to keep a reference to it so you can access it in your `response` closure.
  @schickling Can you share a bit more code, perhaps an example to reproduce this?
 @schickling You've used `responseJSON` thus it returns a failure if there is no JSON. You could use `response` if you are not looking for a JSON body.

https://github.com/Alamofire/Alamofire/tree/swift-2.0#response-handling
 Great question @schickling. 

You can no longer use the `responseJSON` response serializer if there is no data returned. That will fail `NSJSONSerialization` which will in turn return a `.Failure` result. As @kylef mentioned, the way to handle this case now is to use the default `response` method that does not leverage a response serializer or return a `Result` type. This was all by design. 

You should not be using a response serializer if you are not expecting response data from the server.
  This is a great question @krummler. 

We've been discussing this in our Slack channel and we've decided to leave it as is. It could be both a serializer or deserializer depending on which way you look at it. Given the history of this naming convention spans over 4 years from AFN and AF, we've decided to leave the name as is to avoid any confusion.

Thank you for posing the question. Cheers.
  This is exactly what should happen if the request was cancelled. You are not going to receive an `NSHTTPURLResponse` in the event of a cancellation because the request didn't succeed. You are also never going to receive a valid `string` object if the request didn't succeed because you didn't receive any data from the server.

Additionally, we have test cases verifying this behavior works as expected.
  Couldn't agree more. Thanks for pointing that out. Change has been made in 6f3c72ce.

Thanks!
  I'm not sure what this issue is trying to point out or ask. Please provide more description in your issues or they are just going to be immediately closed. All the documentation has already been updated for the `Result` type response serializer usage.
  Okay everyone, this Issue is your chance to help us shape the future of Alamofire! üî•üî•üî•

We've been knocking out all the obvious features and we've finally made it to the end of the have-to-have list. Now we'd like to reach out to the community to take feature requests. You have just as important of a role as we do to help us shape our next feature set.

Please understand that this is simply a place to gather feedback. This is by no means a promise that the ASF will end up implementing any of the suggestions here. I can assure you though that we will take each suggestion seriously and consider adding it to our Trello backlog. Please take some time to clearly articulate your feature request so we don't have to pry the information out of you. Clarity will certainly make it much easier for your feature request to make it into our backlog. üòâ

I'm super excited to see what everyone comes up with...happy requesting!!!
 Yep, thanks for the feedback so far everyone. The activity indicator is certainly a reasonable request.
 @tkrajacic the UIImage/NSImage functionality is already on the list and is currently one of our highest priorities. üëçüèº
 @nskboy that certainly would be useful. However, that would be an incredibly difficult feature to build without clobbering the public APIs. We'll have to put some serious thought into whether something like that would be doable at the core Alamofire level.
 Thank you for the example @nskboy. We are on the same page about a possible approach. My previous point was that implementing retrying logic with our current set of global convenience APIs is not going to be possible. We want to avoid adding any more additional parameters to the global methods.
 @adamkuipers there are not currently any plans, but it would certainly be worth an investigation. I'm curious if anyone has come up with a solution using curried functions, or have wired in something like BrightFutures or PromiseKit. 

If there is an elegant solution using curried functions, that could possibly be something worth adding into Alamofire core, but the others would certainly be implemented as component libraries to Alamofire.
 Thank you everyone for all your feedback. Here's a list of feature requests along with notes from our perspective.
- Add support for network activity indicator
  
  > This will need to be done carefully. There are MANY complex issues with getting this correct that we've had to fight on AFNetworking. We don't want to go down the same route as we did there, so this will be a bit tricky to get right. No firm commitment here, but we're certainly going to try to come up with a solution.
- Add support for UIImage/NSImage response serialization
  
  > This is already taking place! üëçüèº
- Add support for auto-retrying with progressive back-off
  
  > This will need some serious investigation as to how this could be implemented. No promises that we can make this happen, but we're going to look into it.
- Add support for future/promise based API
  
  > We really want to investigate using curried functions in Alamofire core. Anything tied directly to any of the promise/future based APIs should be built by the community. We will certainly investigate this though.

Again, thank you everyone for all your feedback!
 Just FYI...we just released [AlamofireImage](https://github.com/Alamofire/AlamofireImage)!
 No updates yet...still in our backlog.
 Yep, already on the list @lucatorella.
 There are no short term plans to implement this feature directly in Alamofire core @bvankuik.
  Hi @codecowboy,

Unfortunately CocoaPods doesn't support integrating into Command Line Tools (for a number of reasons). See https://github.com/CocoaPods/CocoaPods/issues/3707.
  Are you writing your own response serializer? Could you post some more logic? I'm trying to understand what you're trying to do to figure out whether we should open that method up or not.
 Thanks for the explanation gents. That was oversight on my part. I've opened up both `errorWithCode:failureReason:` methods in 85b90fe1. This should resolve your issues. üëçüèº
  :+1: from me.
 Thank you for your PR @mackuba. 

These changes are only to support iOS 7 and introduce compiler warnings into our main project. The Alamofire 2.0.0 release is going to drop support for iOS 7 altogether since we can't test it and give it the proper support it needs. Since we don't want to introduce warnings into the project, we're not going to be able to make this change.

Thanks again for the PR.
 It's not a necessary check if your deployment target is 8.0.
 We're dropping support for iOS 7 with the Alamofire 2.0 release. Therefore, we don't want to introduce fixes for iOS 7 that generate compiler warnings for iOS 8 and iOS 9 users.
  Pull down the latest commits in the `swift-2.0` branch. This issue has already been resolved.
 This is not an issue in the Alamofire 2.0.0-beta.1 release @Prince2k3. Nor is it an issue in the latest `swift-2.0` branch. Please please please update to the latest commit.
  Thank you for your PR @johndpope. I merged a modified form of your PR in 2bffaf1b giving you attribution. Thanks again!
 It works fine for me. I've migrated the example over to use all HTTPS calls which should play nice with ATS. Could you possibly provide more info and open a new PR if necessary? Could you check against the Alamofire 2.0.0-beta.1 release?
  Anywhere where the `Result` is available, the `NSHTTPURLResponse` is also provided. Therefore, if you are not passing the `response` around where you may need it, that is an implementation problem on the client side, not an issue with Alamofire. This is exactly why it was designed the way it was. 

There are MANY other things in the `response` that may be useful besides the `statusCode`. Therefore we don't want to make a special exception to the `statusCode`. Here's a quick example of how you should attempt to handle this issue.

``` swift
Alamofire.request(.GET, "https://httpbin.org/get")
    .responseJSON { request, response, result in
        switch result {
        case .Success(let JSON):
            print(JSON)
        case .Failure(let data, let error):
            print(response?.statusCode)
            print(error)

            callFailureMethod(response: response, result: result)
        }
    }
```

or

``` swift
Alamofire.request(.GET, "https://httpbin.org/get")
    .responseJSON { request, response, result in
        debugPrint(result)
        print(response?.statusCode)

        callFailureMethod(response: response, result: result)
    }
```

Best of luck!
 If you didn't successfully make a request to the server, you most likely won't have received an `HTTPURLResponse` back from your server. The easiest way to check is to always print it out:

``` swift
debugPrint(response.response)
```
 The `-1009` is **NOT** the response HTTP status code, it is the `Error.code`. These are two very different things. If you don't have an HTTP status code, you'll most likely have an Error code which will generally tell you why you didn't receive an HTTP status code.
  You need to update to Xcode 7 beta 5.
  Thank you for your PR @maxgoedjen. 

In this case I think this is not a good addition for Alamofire. You are duplicating the `value: T?` computed property functionality and also introducing a `throws` that isn't necessary which just adds unnecessary complexity. A `Result` type should never have to `throw`. If you really want to keep this type of functionality, you can always use it as your own extension on the `Result` type.

Thanks again.
  Everything works as expected with Xcode 7 beta 5 which is all documented in the README. 

If you are experiencing other issues, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thank you for your input @calvintwr. We chose to use underscores to emphasize meaning and show intent just as @cristeahub mentioned. Since this is a VERY common pattern demonstrated all over the Swift language, we feel it is also a good pattern to use in the documentation in particular areas. If you are unfamiliar with the pattern, then I suggest you read up on Swift closures and usage patterns to get a better feel for what we're trying to demonstrate. Again, thanks for the feedback.

Cheers.
 Hi @calvintwr, thanks for the feedback. I definitely see your point, but respectfully disagree. We're not catering the documentation to users that are not familiar with Swift. I'd also discourage users from attempting to use Alamofire before getting familiar with all the ins and outs of the Swift language.
  Hi @Elmundo,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thank you for reporting @appsmonkey. I just pushed 61d6ddf9 that addresses this issue. Here's the output from just running against the following Cartfile.

### Cartfile

```
github "Alamofire/Alamofire" "fix/enabling_testability"
```

### Carthage Output

``` bash
cnoon:~/Desktop/CarthageChecker$ xcodebuild -version
Xcode 7.0
Build version 7A176x
cnoon:~/Desktop/CarthageChecker$ carthage version
0.7.5
cnoon:~/Desktop/CarthageChecker$ carthage update
*** Fetching Alamofire
*** Checking out Alamofire at "61d6ddf9c91da83a062cbe29dc6b7f6a0a5d8789"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.7T1Gz9.log
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire OSX" in Alamofire.xcworkspace
*** Building scheme "Alamofire watchOS" in Alamofire.xcworkspace
cnoon:~/Desktop/CarthageChecker$ 
```

Thanks again for reporting! I'm going to close this issue out. If you still have any issues, please comment on this issue and I'll gladly re-open it.

Cheers üçª
  Thank you for putting this together @mcudich...great work!

I merged a slightly modified version of your changes into a squashed commit in 62947d6d that still gives you attribution.

Thanks again! üçª
  Hi @henriquesobral,

You should try to override the following task override closure on the session to attempt to track down what's going on.

``` swift
/// Overrides default behavior for NSURLSessionTaskDelegate method `URLSession:task:willPerformHTTPRedirection:newRequest:completionHandler:`.
public var taskWillPerformHTTPRedirection: ((NSURLSession, NSURLSessionTask, NSHTTPURLResponse, NSURLRequest) -> NSURLRequest?)?
```

You can set this closure by:

``` swift
let manager = Alamofire.Manager()
manager.delegate. taskWillPerformHTTPRedirection = { session, task, response, request in
    print(request)
    return request
}
```

That should at least help you debug.
 Hi @henriquesobral, if you could get back to me by the end of the weekend I would appreciate it. Otherwise I'm going to close this issue out. 

None of this behavior should be caused by Alamofire itself. Alamofire let's the redirection happen exactly as Apple intended while exposing the `taskWillPerformRedirection` closure to override the behavior as I mentioned before.
 I'm going to close this issue out. @henriquesobral if you end up finding the root issue is actually a problem with Alamofire, please comment on this issue and I'll re-open it. 

Cheers.
  Hi @ErickB14,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  It works as designed. Please see this [thread](https://github.com/AFNetworking/AFNetworking/issues/179) for more detailed information.
  This is already in #616 along with including a target to actually build/test this. /cc @cnoon Are we plan to merge #616?
 Yep, I was planning on getting to #616 tonight @kylef. @neonichu thank you for your PR, but we're going to pull in all watchOS support through #616. Thanks again!
  This is most likely a bug in `AlamofireObjectMapper`, not in Alamofire itself. 

The Alamofire 1.3.0 release had a non-backwards compatible change that went into it which was documented in the [release notes](https://github.com/Alamofire/Alamofire/releases/tag/1.3.0). You are most likely running into a problem with the `AlamofireObjectMapper` that hasn't yet updated to match the response serialization changes in PR #593.

It was decided that it would be better to get the serialization change in before going to Alamofire 2.0. You are most likely one of the unfortunate ones that had their logic break due to this change.

What I would do if I were you would be to debug the simple case first. Try to pull out `AlamofireObjectMapper` and just make the requests with Alamofire 1.3.0 and print out the results. Make sure things are working properly. Then you'll know you've narrowed down the issue to `AlamofireObjectMapper`. Then you can dig into the response serializers in `AlamofireObjectMapper` and find the issue and submit a PR.

I'm going to close this issue out for now since we've never seen this type of behavior and I'm almost positive it's not an issue with Alamofire itself. If you do end up seeing the issue without `AlamofireObjectMapper`, please provide some more details (code samples) and I'll gladly re-open this issue and help you dig into it.

Best of luck! üçª
 Ah...that makes sense. I'm glad you solved it, and thanks for posting the solution here. Hopefully it helps someone else out that encounters a similar issue.

With that said, I would really like to discourage using any libraries in production facing apps that mess with Alamofire's underlying NSURLSession by using an `NSURLProtocol`. This is fine for things like stubbing, but the protocol usage does not respect all the properties of the session configuration which can cause some bad issues and strange behaviors. What you are reporting here is WAY worse than what I've seen so far. Therefore, I would keep your distance from something like `BigBrother` to ensure your networking logic doesn't go haywire.

Unfortunately I don't have an alternative at the moment to solve your activity indicator need. I can say though that we will be adding more support around UIKit most likely after the Alamofire 2.0 release. Until then, I'm afraid you're on your own in this area unless you want to roll the dice with something like BigBrother.
  Thank you @ikesyo. @cristeahub the documentation in the README for the `Result<String>` change is forthcoming.
  @abinop You should check if the result is a success, and then use the successful value or handle the failure.

``` swift
Alamofire.request(.GET, URLString, parameters: ["foo": "bar"])
    .responseJSON { request, response, result in
        switch result {
        case .Success(let JSON):
            print("Success with JSON: \(JSON)")

        case .Failure(let data, let error):
            print("Request failed with error: \(error)")

            if let data = data {
                print("Response data: \(NSString(data: data, encoding: NSUTF8StringEncoding)!)")
            }
        }
    }
```
  Hi @hadiz, PR #595 added support to directly access the `resumeData` on a download request. There are a couple of ways in which you can access the `resumeData`. The first is through the `data` object returned in the `response` serializer. It will automatically be populated with `resumeData` if `resumeData` is actually available. The second way is to directly access the `resumeData` property on the download request.

Both of these approaches are clearly demonstrated in the tests written in #595. The documentation for these updates is forthcoming.

Best of luck!
  Thanks @jankase...much appreciated!
  Thank you for your PR @jankase. I really hesitate to make this change because I feel it could be misleading to users to make a `Result<T>` conform to `BooleanType`. Here's a quick snippet that I put together to demonstrate why.

``` swift
func testResultConditionals() {
    let result1 = Result.Success("Testing")
    let result2 = Result<String>.Failure(
        NSData(),
        NSError(domain: Error.Domain, code: -1, userInfo: nil)
    )

    // Switching on cases
    switch result1 {
    case .Success:
        print("Result 1 is a success")
    case .Failure:
        print("Result 1 is a failure")
    }

    // Pattern matching in conditionals
    if case .Success = result1 {
        print("Success comparison works")
    }

    if case .Failure = result2 {
        print("Failure comparison works")
    }

    // Convenience methods
    if result1.isSuccess {
        print("Success check works...clear and concise")
    }

    if result2.isFailure {
        print("Failure check works...clear and concise")
    }

    // Leveraging `BooleanType`
    if result1 {
        print("Result conforms to BooleanType so it can be used like this...could be confusing")
    }
}
```

Could you make a more substantial case as to why you think it should be added? At the moment I'm leaning towards not making this change.

cc @kcharwood and @kylef...do you guys have an opinion here?
 I think I agree with @cnoon on this.

Apple discourage conforming to BooleanType when you're representing more than a simple boolean value, take a look at the [BooleanType protocol documentation](https://developer.apple.com/library/prerelease/ios/documentation/Swift/Reference/Swift_BooleanType_Protocol/).

> Only two types provided by Swift, Bool and ObjCBool, conform to BooleanType. Expanding this set to include types that represent more than simple boolean values is discouraged.

This is interesting approach @jankase.
 Ah yeah I didn't check the docs. That totally makes sense @kylef. Thank you for the PR @jankase, but I'm going to decline this PR. Thanks again!
  It's right in the [docs](https://github.com/Alamofire/Alamofire#http-headers). We added custom header support into all the global APIs in the Alamofire 1.3.0 release. Now it's super easy to tack on any custom header that you need.

Best of luck!

### EDIT

Whoops, I didn't read your post close enough...apologies. In order to build the header from the request body, you have a few options. The easiest would be to use the `ParameterEncoding` enum to generate an `NSMutableURLRequest`, then compute and attach your `Authorization` header. Once you've added the header to your `NSMutableURLRequest`, you can pass that directly into any of the global `request`, `download` or `upload` methods.
  Thank you for your PR @jankase. Unfortunately, we will not be merging this change. Please see #525 and #554 for more information. 

Cheers.
  Hi @bruceflowers,

It's not an actual issue with Alamofire but is instead some problem with some other kind of setup. Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You just need to update to Xcode 7 beta 4 and all your issues will be resolved.
  We're not going to merge the `swift-2.0` branch into `master` until we're ready to release Alamofire 2.0 which will roughly coincide with the Xcode 7 GM release date.
  Could you try updating to the latest version of CocoaPods (0.38.2) and report back?
 Okay thanks for the info. This is still on my radar @johndpope, I just haven't had time to check it out yet. Should be able to get to this in the next couple of days. Stay tuned...
  Hi @dromerobarria,

You most likely need to use a background session configuration when setting up your `Manager` instance. Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck!

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @4np, this is the Swift compiler giving you a VERY misleading error. The issue is actually in your `download` declaration. You are missing the `destination` parameter. We brought all the global `Alamofire` methods inline with the `Manager` methods which will cause these issues in certain places.

We also documented this issue in the [release notes](https://github.com/Alamofire/Alamofire/releases/tag/1.3.0) in the upgrade section at the bottom. Additionally, the logic is correct in the [sample code](https://github.com/Alamofire/Alamofire#downloading-a-file-wprogress) in the README.

In the future, when you have issues like this, please take your question to Stack Overflow as @cristeahub mentioned.

Cheers üçª
  This PR refactors the response serializers to leverage `Result` types and also creates customized validation errors to resolve Issue #447.
## Result Types

As I'm sure most people are aware, the double optional tuple scenario is Swift is a real problem resulting in us always having to check three cases even though there are really only two. `Result` types guarantee that you only ever have to account for the two situations.
### Previous Style

The major area of Alamofire that previously suffered from this issue were the response serializers. Here is an example of the previous pattern:

``` swift
Alamofire.request(.GET, URLString, parameters: ["foo": "bar"])
    .responseJSON { request, response, json, error in
        if let error = error {
            print("error occurred: \(error)")
        } else if let json = json {
            print("json response: \(json)")
        } else {
            print("something went really wrong b/c I didn't get json or an error")
        }
    }
```
### New Style

After several revisions, the new way of extracting response JSON will leverage a `Result` type eliminating the third case:

``` swift
Alamofire.request(.GET, URLString, parameters: ["foo": "bar"])
    .responseJSON { request, response, result in
        switch result {
        case .Success(let JSON):
            print("Success with JSON: \(JSON)")
        case .Failure(let data, let error):
            print("Request failed with error: \(error)")

            if let data = data {
                print("Response data: \(NSString(data: data, encoding: NSUTF8StringEncoding)!)")
            }
        }
    }
```

> The result success value is guaranteed to be returned as an actual value, not an optional. Additionally, in the case of a failure, the error is guaranteed and the original data returned from the server is returned as an `NSData` optional. All default response serializers have been refactored to ensure these cases are always upheld. The required reworking the error system in Alamofire.

There are also convenience computed properties on the `Result` type to make it really easy to check for things like a success or extract the success value out:

``` swift
Alamofire.request(.GET, URLString, parameters: ["foo": "bar"])
    .responseJSON { request, response, result in
        if let JSON = result.value {
            print("JSON Response: \(JSON)")
        } else {
            print("Error: \(result.error)")
        }
    }
```
#### Bonus Points

The coolest part about this set of changes is that the old `response` method was kept in tact. There are certainly cases where you may not want to use a response serializer, but you just want to hook into the `response` to know that the task delegate queue processing is complete. Therefore, the original `response` method still exists, but no longer includes a `responseSerializer` parameter. It simply calls the `completionHandler` immediately.

``` swift
public func response(
    queue: dispatch_queue_t? = nil,
    completionHandler: (NSURLRequest?, NSHTTPURLResponse?, NSData?, NSError?) -> Void)
    -> Self
{
    delegate.queue.addOperationWithBlock {
        dispatch_async(queue ?? dispatch_get_main_queue()) {
            completionHandler(self.request, self.response, self.delegate.data, self.delegate.error)
        }
    }

    return self
}
```

This allows you to simply tap into the completion of the task without running any extra processing as though you implemented the session delegate completion method directly.
## Validation Errors

Previously, if response validation failed, you simply received an `NSError` with a `com.alamofire.error` domain with a `-1` error code. This made it quite difficult to figure out whether content type or status code validation actually failed.

With the new structure, content type and status code validation have separate errors making it really easy to tell what actually went wrong.

``` swift
public struct Error {
    public static let Domain = "com.alamofire.error"

    public enum Code: Int {
        case InputStreamReadFailed           = -6000
        case OutputStreamWriteFailed         = -6001
        case ContentTypeValidationFailed     = -6002
        case StatusCodeValidationFailed      = -6003
        case DataSerializationFailed         = -6004
        case StringSerializationFailed       = -6005
        case JSONSerializationFailed         = -6006
        case PropertyListSerializationFailed = -6007
    }
}
```
## Summary

These changes should simplify the process of handling success and failure cases for responses. I would love feedback from the community here to see if there are any edge cases that I haven't thought of. Please keep in mind that we have MANY different edge cases to consider here before being to quick to recommend other solutions. As I mentioned earlier, this went through several revisions before being pushed up.
- There are data, download and upload tasks that the response serializers ALL need to support.
  - Downloads behave MUCH differently and don't return any data.
- You need to be able to access the original server data in the case that an error occurred.
- You want to avoid optionals at all costs in the case of a success or failure to avoid having to optional bind inside a switch.

Thanks in advance for taking a look!
 cc @kylef and @kcharwood 
 Okay, I'm going to merge this in. Thanks for the feedback @saniul and @kostiakoval!
 @cnoon This pull request doesn't update the examples/documentation in the README. Would you be able to do that in another PR? (re #641).
 Thanks for the heads up @kylef. I usually always do that as part of the original PR and this time I just forgot. It's definitely the next thing I'm going to work on. Should have it done today or tomorrow.
 Hey @kylef and @kcharwood, README updates for Result types are up in PR #648! üëçüèº
 The JSON error is going to be in the `.Failure` case of a result.
  Just tested everything with the exact setup.

### Carthage Version

``` bash
cnoon:~/Desktop/QuickTest$ carthage version
0.7.5
```

### xcodebuild version

``` bash
cnoon:~/Desktop/QuickTest$ xcodebuild -version
Xcode 6.4
Build version 6E35b
```

### Cartfile

```
github "Alamofire/Alamofire" == 1.3.0
```

### Carthage Update

``` bash
cnoon:~/Desktop/QuickTest$ carthage update
*** Fetching Alamofire
*** Checking out Alamofire at "1.3.0"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.RPRBhu.log
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire OSX" in Alamofire.xcworkspace
```

Everything builds exactly as expected. For further assistance, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Just ran the following...something you have configured is just incorrect:

### Carthage Version

``` bash
cnoon:~/Desktop/QuickTest$ carthage version
0.7.5
```

### xcodebuild version

``` bash
cnoon:~/Desktop/QuickTest$ xcodebuild -version
Xcode 7.0
Build version 7A165t
```

### Cartfile

``` bash
github "Alamofire/Alamofire" "swift-2.0"
```

### Carthage Update

``` bash
cnoon:~/Desktop/QuickTest$ carthage update
*** Fetching Alamofire
*** Checking out Alamofire at "5f2c29751b35069ec1452046e24dfba506cbc603"
*** xcodebuild output can be found in /var/folders/s7/qpm0b2pn3d56rjlpl7g3_4fh0000gn/T/carthage-xcodebuild.BUFS51.log
*** Building scheme "Alamofire iOS" in Alamofire.xcworkspace
*** Building scheme "Alamofire OSX" in Alamofire.xcworkspace
```

Everything builds exactly as expected. For further assistance, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Good luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Cool, glad to hear it! Thanks for posting your issue and the solution. üëçüèº
  Yep, you'll need to update to Xcode 7 beta 4 to use the latest commits in the `swift-2.0` branch.
 Try to run `pod update` again. I pushed a fix for this problem yesterday in fb8c54c86944516d0b838a33205d3a8e9809e539 that you may not have picked up.
  Hi @BasThomas,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 @jonauz you need to use the `.URLEncodedInURL` to encode the parameters in the `URL` for a `POST`.
  Now that is an awesome catch! Thanks for letting us know @unusuallyreticent. I just pushed 5f2c2975 to fix this issue. Thanks again for letting us know!
  Thanks for this @pcantrell. I just pushed a modified version of this change in fb8c54c8 with attribution to @robrasmussen. Thank you so much for helping out with this!
  This seems like an unnecessary addition to me because backwards compatibility is still maintained. For example, there is not any issue that I'm aware of with the following code block:

``` swift
import Foundation

func URLRequest() -> NSMutableURLRequest {
    return NSMutableURLRequest(URL: NSURL(string: "")!)
}

let request1: NSURLRequest = URLRequest()
let request2: NSMutableURLRequest = URLRequest()
let request3 = URLRequest()
```

Am I missing something obvious?
  Thank you for reporting @jeeftor. We're aware of the issue and are tracking it in #610 (thanks @ikesyo). Please redirect all further comments to that ticket. I'm going to close this out as a duplicate.
  Hi @cvlntn, clean all, wipe derived data, etc. You're running into common Xcode issues.
  Nice...thanks for this @tomco. I have a few other things that I'm working on completing in Alamofire at the moment but I'll get to this as soon as possible!
 Thank you for all your hard work here @tomco! I squashed your PR, tweaked it slightly and pushed it into the `swift-2.0` branch in b4cb7cc3 giving you attribution. Great work!

Cheers üçª
  Great question...totally possible already. You need to use the `URLRequestConvertible` in combination with an `NSMutableURLRequest` to override the `cachePolicy` for that particular request. Check out the documentation and you'll see what I mean.

Here's an example of a test that creates an `NSMutableURLRequest` and customizes it before starting a `Request` with it.
- https://github.com/Alamofire/Alamofire/blob/swift-2.0/Tests/ValidationTests.swift#L238-L260

Cheers üçª
  Closing this issue out. Please update to Xcode 7 beta 4. Cheers üçª
  Hi guys, could you please provide more info? Screenshots, configuration build, platform, etc.
 Cool, thank you for posting that @dickwu. Your issue is the same reported in #610. I'm going to close this issue for now. If you could redirect all comments to that issue, I'd appreciate it.

Cheers üçª
  Thanks for the PR @corinnekrych...merged!
  Thanks @ikesyo!
  This is exactly why I hate disabling Travis CI. We would have caught this if there was an Xcode 7 build. Either way, I have a completely packed day so I won't be able to look into this until this evening.

Could anyone else take a stab at figuring out what's causing the root issue?
 So @robrasmussen definitely wins the rockstar badge for the day! Thank you for tracking this down!

I pushed a modified version of #621 in fb8c54c giving attribution to @robrasmussen for the change. I have also filed [rdar://22024442](http://openradar.appspot.com/radar?id=6082025006039040) which I would encourage everyone to duplicate to help get this resolved.

You can now compile Alamofire in both Debug and Release on iOS and OS X without any issues. Hopefully this resolves the issue for everyone. If not, please comment on this issue and I'll re-open as necessary.

Again, thanks to everyone for helping out! üçª
  Hi @robskillington, as far as I can tell, these changes have already been made and are available in the `swift-2.0` branch. I thought I had already cleaned this all up. Looks like it all was changed in 78f155d8. Could you please confirm?

I'm not exactly sure why it's showing the diff b/c those changes have already been made in the branch your submitting the PR against. Seems strange to me.
 Okay, your changes are completely valid and definitely need to occur. However, it appears to me that everything has already been changed. Check out the code [here](https://github.com/Alamofire/Alamofire/blob/swift-2.0/Source/ServerTrustPolicy.swift#L161-L219) that is the current form of the evaluate method in the `swift-2.0` branch. You'll see that the changes are already in there.
 I feel like you're probably running into some out-of-date upstreaming issue.
  You would need to do it directly inside your `responseObject` implementation. If `data` is `null`, then your `responseObject` will be returned as a `nil`. If you do have `data`, then you attempt to parse it and return your fully initialized object if parsing was successful.
  Hi @SwiftFire,

The behavior works correctly. We have tests confirming this. The issue you are running into has been asked and answered many times before. Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Best of luck.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @Kam21,

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

Cheers.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Sweet...thanks @fewspider!
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Against which device and/or simulator?
 @BilalReffas please don't randomly post questions in already filed issues. You can either reach out to us on Twitter @AlamofireSF or open a new issue.
 Hey @zgosalvez I just figured out your issue. You cannot use the `feature/server_trust_policy` branch in Xcode 7 beta 3 because those changes do not yet support Swift 2.0, nor does that branch contain any of the Swift 2.0 changes that have been made in the `swift-2.0` branch.
 Well given that information you'll just have to figure it out on your own for now until we officially move it over for you. We should have that done in a week or so. Best of luck!
  You're running into [ATS](https://developer.apple.com/library/prerelease/ios/technotes/App-Transport-Security-Technote/). You can't use the HTTP protocol directly out of the box in iOS 9. Check out this [link](http://www.neglectedpotential.com/2015/06/working-with-apples-application-transport-security/) to resolve your issue.

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  I will once the 1.3.0 release is completed. We're VERY close to wrapping it. I would assume the 1.3.0 release will go out in the next few days. You can always check out the [milestones](https://github.com/Alamofire/Alamofire/milestones) page for more info.
  The webpage reflects the current version in `master`. If you want the README for the 1.2.3 release, then you need to check out the README for that release.
  This PR hopefully addresses Issue #510.
## Quick Problem Summary

The issue is described in detail [here](https://github.com/Alamofire/Alamofire/issues/510#issuecomment-112581617). The validation is failing if no `Content-Type` comes back in the response.
## Reproduction Attempts

I tried every http://httpbin.org trick in the book to recreate the issue they are seeing in #510, but was unsuccessful. I cannot trick the `NSHTTPURLResponse` into be so confused that it cannot guess what the `MIMEType` is. It always comes back valid. I would really like to have a test around this change, but just can't seem to get httpbin to do my bidding. If someone could provide a test, that would be amazing!
## Solution

The solution here seems pretty simple. A wildcard accept type `*/*` should always pass validation whether a `MIMEType` exists on the response or not. The current implementation will only pass if the MIMEType on the response is valid. Therefore, my change just adds a small condition that allows `Content-Type` validation to succeed if one of the acceptable content types was `*/*`. Additionally, I can't see any downsides of this change.

Since I can't get a test around this change, I'd love it if @allaire and/or @MartinRogalla could confirm that this change does in fact fix the issue they reported in #510.
 cc @kylef and @kcharwood 
 Thank you @allaire...much appreciated!
 Thank you for confirming @allaire! That makes me feel much better about this change. I'm going to go ahead and merge it.

As for your question about stubbing it, that's a pretty difficult thing to do that will require a custom `NSURLProtocol` which has all sorts of weird behaviors with `NSURLSession`s. Additionally, the validation gets registered as a closure into the task delegate queue which runs after the request completes, thus just making it difficult to simulate.

Once we have spent some time working through stubbing requests with Alamofire, it will make this a much easier thing to simulate. Until then, I'm just going to throw a ticket into our Trello project and we'll get to it later.

Thanks again for all the diligence...apologies for it taking a month for us to get it fixed.
 Hi @Jirka1111, if you are having a problem, please open a new issue and link back to this one if it is in fact related. I'm very confident in this change as well as being having it verified by @allaire who helped debug this issue for weeks.
 @Jirka1111, please take your question to Stack Overflow. I'm almost certain you just have an issue with the way you're formatting your request. This [thread](http://stackoverflow.com/questions/25986129/cocoa-error-3840-invalid-value-around-character-0-afnetworking) may help shed some light.
 @Jirka1111 please be a bit more mindful of our time. We point you towards Stack Overflow when we know there's not an issue with the library but instead an issue with your code. It's purely to allow the community to help us with support questions. If we just sat and answered support questions, we'd never have time to work on moving the library forwards.

With that said, you are not receiving a 204 but instead of 404. You are most likely not hitting the server properly. You need to use cURL debugging or some other form to figure out where your issue lies. Please  do not continue to seek advice through this closed issue.

Best of luck.
  Thank you very much for all your hard work here @forgot!

I'm very sorry but I need to decline this PR. I don't want anyone else picking up all these changes without them having been made by our TC. I want to go through each of the new features that have been added for the 1.3.0 release one-by-one to make sure they get ported properly.

With that said, I ensure you that this work is forthcoming. We're very close to wrapping the 1.3.0 release and this will be the very next thing we pick up.

Thank you for your patience...and apologies for declining. I don't like to flat out decline PRs...but I think it's the best course of action for Alamofire and the community for time being.

Cheers üçª
 In the future, before you take on such a large chunk of work, please reach out to us through our [@AlamofireSF](https://twitter.com/AlamofireSF) twitter handle or open an issue asking for guidance from the TC as to whether to proceed. That would have given us the opportunity to let you know our thoughts before you went to all the work.
  This PR addresses three issues:
1. When uploading `MultipartFormData` where appending body parts would fail, the encoding would succeed and the upload would take place without the failed body parts.
2. Added a method for appending body parts with data, name and mime type.
   
   > See #591 and #555 for more details.
3. Added a completely open `appendBodyPart(stream:length:headers:)` method that allows you to append any kind of data with any type of headers you wish.
## Problem

The upload methods for `MultipartFormData` are very convenient and make it very easy to construct the data and upload it. The problem though is that the file URL methods will return an error if something goes wrong when creating the `BodyPart`. This is a very easy case to forget to handle. Even worse, the encoding does not realize there was an error and will continue onwards.

For example, say you had the following logic:

``` swift
Alamofire.upload(
    .POST,
    URLString: "http://httpbin.org/post",
    multipartFormData: { multipartFormData in
        multipartFormData.appendBodyPart(fileURL: unicornImageURL, name: "unicorn")
        multipartFormData.appendBodyPart(fileURL: rainbowImageURL, name: "rainbow")
    },
    encodingCompletion: { encodingResult in
        switch encodingResult {
        case .Success(let upload, _, _):
            upload.responseJSON { request, response, JSON, error in
                println(JSON)
            }
        case .Failure(let encodingError):
            println(encodingError)
        }
    }
)
```

If `rainbowImageURL` is not a valid URL, appending the body part will actually return an error, but the encoding succeeds and only the unicorn image is uploaded to the server. This is very problematic and needs a better solution.
### Solution

Since it is clunky to have to handle the error each time you append a body part, I chose to handle the error internally and bubble it up when encoding takes place. What this means is that in the above example, you don't need to check if appending each body part succeeds or not, you just need to handle whether encoding succeeds which the `upload` methods already do for you automatically.

Another advantage is that encoding will fail immediately if there was an issue appending any of the body parts. This approach seems like the best way to solve the problem. Even when moving to Swift 2.0, we won't want to have to `try` each time we try to append a body part. It's much easier from the user's perspective to bubble up the error at the time of encoding.

We could also use both approaches and still return an error optional for the file URL methods, but that seemed redundant and not optimal.
 cc @kylef and @kcharwood 
 @Samback there is not. We'll port all the 1.3.0 changes over to the `swift-2.0` branch once we cut the 1.3.0 release.
 You'll have to roll your own @Samback for the next week or so if you absolutely have to have it now, or you'll need to use AFNetworking. There are some posts on Stack Overflow explaining how to put together a quick and dirty approach to generating the boundaries manually. Otherwise, I'd recommend you just hang on a bit longer.
  This PR adds much better support for resume data with regards to download requests to address #141.
## Problem

Previously, there were only two ways to get resume data out of a request.
1. Cancel the request using the `Request.cancel()` method and retrieve the resume data from the `AnyObject?` in the `response` method.
2. Extract the resume data from the `error` returned in any of the `response` methods from the `userInfo` dictionary using the `NSURLSessionDownloadTaskResumeData` key.

The downsides to this is that you could only get direct access to the resume data by canceling the request. It would never be directly returned in the `response` method if it was interrupted by say a loss of network connection. Additionally, you could only ever access the resume data in the `response` parameters through either the `data` parameter in the event of a cancelled request, or through the `error` by digging the data out from the `userInfo` dictionary. This made it impossible to fetch the resume data without the use of the `response` serializers.
## Solution

To improve the resume data support, I made a couple of key changes that should make it MUCH easier to work with resume data.
1. For any failed download request, the resume data is automatically extracted out of the `error` object if it is available.
2. Added a `resumeData` computed property on the `Request` to allow you to access that data outside the `response` serialization methods. For example, you can now access the `resumeData` in any of the chained `Request` methods if you so choose.
   
   > This change coupled with the changes in #590 should give you complete customization control of the behavior of download requests and how the serial queue executes after completion.

I also added several tests around this behavior to demonstrate the usage and verify the behavior.
 cc @kylef and @kcharwood 
  You are most likely running into an issue with [App Transport Security](https://developer.apple.com/library/prerelease/mac/technotes/App-Transport-Security-Technote/index.html) (ATS) introduced in iOS 9. Here's an [article](http://www.neglectedpotential.com/2015/06/working-with-apples-application-transport-security/) that details how to workaround your issue.

> Please note that we do not encourage disabling ATS in any fashion. That should always be a last resort.
  This PR addresses issue #296 by refactoring the response serialization logic to leverage the power of generics. With the addition of the `ResponseSerializer` protocol and the `GenericResponseSerializer` generic struct, it is now much easier to work directly with value types as well as get the actual type returned directly rather than having to cast the `AnyObject`.
## Improvements
- The four default response serialization methods now all return the most applicable type directly instead of an `AnyObject`. You no longer have to cast the result from an `AnyObject?` to `NSData`...Alamofire now handles this internally using generics.
  > JSON and PropertyLists still return an `AnyObject` since that is the most applicable type in those cases.
- Custom response methods can now support generic types directly without having to cast the result of the underlying `response` method implementation.
## API Changes

The coolest part about these changes is that they have almost the exact same public API. As you can see from all the test logic, the high level functions that everyone is consuming remain unchanged. The only difference is if you are using the underlying `response` method. In this case, the `serializer` parameter has been renamed to `responseSerializer` for clarity purposes.

Since the underlying `response` implementation previously returned an `AnyObject?`, those implementations will still "just work". What it will result in is that you will no longer need to cast the serialized object being returned.
 cc @kylef and @kcharwood 
  I've been using it in multiple projects and everything works properly. Here are a few troubleshooting tips:
- Make sure you have the latest version of Xcode 7 beta 3
- Update CocoaPods to the latest pre-release version
- Clean the project
- Wipe DerivedData
- etc. etc.

---

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @chrisco314, first off, my apologies for not replying to your Stack Overflow question. I've been focusing mainly on the 1.3.0 release and haven't been able to spend as much time on Stack Overflow as I would like. 

With that said, I'm fairly certain you should be able to do this already without any changes to Alamofire. Would it be possible for you to test a theory for me? Could you try to upload some JSON data to your server using the following approach?

``` swift
multipartFormData.appendBodyPart(
    fileData: data, 
    name: "name", 
    fileName: "filename.json", 
    mimeType: "application/json"
)
```

I'm fairly certain this method should do "exactly" what it is you are looking for. I'm also curious if your variation is the exact same call minus the `filename` argument in the `Content-Disposition` header. We've had a similar issue opened in #569 but we never heard back from @top2tech. 

If you could verify whether that method works for your case that would be great. Additionally, it would also be useful to know if you are finding that the `filename` argument is optional. I'm having a difficult time determining from the RFC specs whether the filename is optional or not.
 Okay @chrisco314, let's take a step back for a sec.

I need you to help me diagnose the problem you are having before I'm going to consider redesigning the APIs. Could you please answer my original questions? Can you directly pass in your `mimeType` to the following method and still have it work? If not, could you please walk me through why?

```
multipartFormData.appendBodyPart(
    fileData: data, 
    name: "name", 
    fileName: "filename.json", 
    mimeType: "application/json"
)
```
 Okay, so if I boil down your extremely verbose set of multiple answers, you are able to do what you need with either of the following methods:
- `appendBodyPart(fileData:name:fileName:mimeType:)`
  
  > If you provide a dummy `fileName` value
- `appendBodyPart(data:name:)`
  
  > If you override it and add a `mimeType` argument that would append a `Content-Type` header

As an initial takeaway, I'd say the `appendBodyPart(data:name:)` method most likely needs an optional `mimeType` parameter which will add the `Content-Type` header to the body part if it is passed in. That would certainly solve your main issue.

---

As for your proposed API changes, I really appreciate your feedback! 

When designing the current implementation, the one thing that didn't feel exactly right was the fact that you can easily bury the errors that occur when appending a new body part if you aren't careful. Only some of the methods can actually fail, but if they fail without you handling them, your body part won't make it up to the server.

As for providing the closure in the `upload` method, that is simply to be able to create the data inline with the rest of the request. I'll consider adding another alternative API where you pass the `MultipartFormData` object in directly rather building it on the fly with a provided closure.

Overall, you have piqued my interest here so I will probably be making some changes to address some if not all of these issues. Once I push up a PR I'd appreciate some more feedback if you have time.

Cheers üçª
 Okay @chrisco314, I just pushed up PR #596 which addresses all the issues presented in this ticket. Please check it out and redirect all further comments to #596.

### Proposals Implemented

I took about half of your suggestions in this ticket and implemented a variation of them. 
- Added an `appendBodyPart(data:name:mimeType:)` method which solves your root issue. 
- Added a base method that everything calls through that is completely wide open allowing for headers like `Content-Transfer-Encoding`. 
- Now internally tracking a body part error that is bubbled up immediately during encoding. This eliminates the possibility of uploading something to the server that is missing a body part.

### Proposals Not Implemented

Some of the suggestions that I did not incorporate were:
- Reordering the parameter names
  
  > The parameter names begin with either `data`, `fileURL` or `stream` to make it easier to work with autocomplete to narrow down your choices. Starting with `name` makes it difficult to pick out the one you are looking for. While I completely understand your logic, I disagree that this would be the best course of action.
- Variadic Initializer and/or Chaining Optionals

> Both of these approaches make the APIs clunky and more difficult to use IMO.
- Multiple Enumerations and Chained Headers
  
  > This approach presents way too many ways for users to make mistakes. It also does not provide any flexibility since you cannot customize the behavior by extending enumeration cases.

### Summary

Alamofire is intended to provide very clean, robust APIs to make networking easy, yet be flexible enough to allow users to customize any part of the networking stack, thus supporting a range of experience from novice to expert. Therefore, some of your suggestions aligned very well with our overalls goals which is exactly why they were implemented.

Thanks again for all your efforts here...Alamofire is certainly better for it!

Cheers üçª
 Hi @pavm035, multipart/mixed uploads are not supported at this time.
  There are a couple of changes here. 
## Removal of respondsToSelector

The first was to remove the `respondsToSelector` override in the `Manager` class. The only reason I could come up with as to why they were there in the first place was that the original `SessionDelegate` override closures were internal. Having this override would allow clients to "peak" into whether or not those internal closures were set. Since the override closures are now public themselves, this logic no longer seems necessary.

> If anyone can think of a good reason as to why these shouldn't be removed...please comment on this PR!
## Opening the TaskDelegate Queue

I originally set out to open up the `TaskDelegate` APIs completely. After a deep investigation of the way the task delegate override closures are implemented and abstracted, I think it's best to leave them as they are. They are extremely well designed and provide an amazing amount of abstraction that can be overridden by the `SessionDelegate` closures. If a user really needs to customize the default behaviors, the `SessionDelegate` override closures should be used instead. Opening the `TaskDelegate` override closures would not only be redundant, but I'm afraid it would open up an abundance of confusion to the general user.

With that said, there is still an opportunity to allow users to implement custom behaviors on the `TaskDelegate` queue. At the moment, you cannot customize any `Request` operation logic until one of the `response` serializers are called. This is problematic if you need to run any other operations prior to this. For example, if you wanted to run some pre and post operations around validation, you couldn't do so.

Because of this, I opened up the `TaskDelegate` and `queue` to allow for customization. I also added some unit tests around this behavior to ensure it works as expected. This should give users ultimate flexibility without exposing hardly any of the internal API. Win win win. I'm excited to see what users will end up doing with this new found freedom! üòÅ
 cc @kylef and @kcharwood 
  There is no error in the implementation. There is no spec around URL collection encoding and therefore Alamofire implements a [best practice approach](https://github.com/Alamofire/Alamofire/blob/master/Source/ParameterEncoding.swift#L48-L51). If your server expects a different syntax, please use the .Custom `ParameterEncoding`.
 @muzammil-hussain you should take Rob's advice in that thread and switch over to JSON. If that cannot be done in your case, you should implement a `.Custom` parameter encoding. Collections with URL encoding are not supported in an RFC spec and thus is not an encouraged practice. Finally, AFNetworking is simply another slightly modified version of the URL parameter encoding and is not a more accurate version of URL encoding even it is works with your server.
  Thanks for the suggestion @msanders! Would you be willing to take a stab at implementing this? Or anyone else that's a big Carthage fan?
 So after chatting with @kylef, we agreed that this is not something that we are going to support. Apple specifically recommends in the following article not to distribute 3rd party frameworks since they are tied to the specific version of Xcode and Swift.
- [Access Control - Apple Swift Blog](https://developer.apple.com/swift/blog/?id=5)

> Developers building frameworks to be used across their projects need to mark their API as public. While distribution and use of 3rd-party binary frameworks is not recommended (as mentioned in a previous blog post), Swift supports construction and distribution of frameworks in source form.

We want to support Carthage as much as possible while still ensuring the integrity of our releases. By not deploying prebuilt frameworks, we guarantee that an Alamofire release will continue to work even when the next version of Xcode and/or Swift drops.

> This is of course assuming the Swift enhancements still compile.
 I do not. I'll defer to @kylef here. He's really our running expert on frameworks and distribution.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This PR contains several changes:
1. Modified internal `URLRequest(method:URLString:)` method to accept an optional `headers` dictionary and also made the return value an `NSMutableURLRequest` to make it easier to work with.
2. Extended the `request`, `upload` and `download` methods on `Manager` to accept an optional `headers` parameter.
3. Extended the global `request`, `upload` and `download` methods to accept an optional `headers` parameter.
4. Modified the global `upload` and `download` method external parameters to match the `request` method structure.
5. Added initialization tests for `request`, `upload` and `download` methods to ensure we can now create requests with and without custom headers.

This has been a feature that has been requested by a large portion of our community. Please see the following issues for more info: #27, #32, #99, #111, #113, #119 and #490.
 Awesome! Thanks @kylef! üëäüèº
  The `upload` method in this case cannot directly return the upload `Request` object. It is available in the `encodingResult` object. You need to attach your `progress` closure to the `upload` object that you are extracting from the `.Success` case of the `encodingResult`.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You are absolutely right @mcudich. We are trying to finish up the 1.3.0 release before we starting porting all the changes over. There are some major features (MultipartFormData included) that will require a significant amount of work. We will start moving the changes over to the `swift-2.0` branch as quickly as we can.
  It definitely does. Please read through the [URL Loading System](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html) for more info.
 There is no support for this type of behavior nor do we have any plans to support it. Could you explain your use case a bit more so we could have a better understanding?
 Okay so let me clear this up a bit. For those of you that want to download in this manner, you'll need to roll the implementation on your own using [Range headers](http://httpwg.github.io/specs/rfc7233.html#range.requests). This will only work if the server you're trying to hit actually supports the `Range` header. If yes, you should be able to run several partial downloads in parallel. The number of downloads you can run in parallel will be capped by the total simultaneous downloads supported by the URL session configuration.

With that said, I seriously question whether this would be any more performant than using a single TCP socket to the server with resume data. The only case I can think of that it would would be the server capping the bandwidth on a single TCP socket. Not sure if that's common practice or not. If anyone has more info there I'd love to hear it!

Also, as mentioned before, I don't think this is something we'd like to support in Alamofire or AlamofireImage.
  This PR adds the ability to evaluate the validity of the TLS handshake in many different ways. It is not 100% complete, but is getting very close. I wanted to push it up to gather feedback from everyone before I finalize all the public docstrings and add documentation to the README (which will be extensive).
# Features

There are a whole bunch of new features added in this PR. I'll try to break down each of them one-by-one.
## Evaluation Policies
### Evaluation Policies per Host

Since different servers and web services have leaf certificates, intermediate and even root certificates, it is important to have the flexibility to specify evaluation policies on a per host basis. Otherwise, wouldn't be able to do things like use default evaluation for `host1`, certificate pinning for `host2` and public key pinning for `host3`.

The new `ServerTrustPolicy` enumeration and `ServerTrustPolicyManager` class help make this happen. You specify a policy for each host and Alamofire will handle the rest.
### Default Evaluation

The session delegate and task delegate did receive challenge callbacks both still use the `.PerformDefaultHandling` auth challenge disposition by default. This guarantees that anyone using Alamofire without a custom `ServerTrustPolicy` will get the Apple's default evaluation behavior. Therefore, you aren't getting any kind of custom behavior unless you actually specify you want it.

Here's a list of the custom types of things you can do with the new `ServerTrustPolicy` enumeration:
- The `.PerformDefaultEvaluation` case allows you to control whether you want to use host validation for the challenge. This could be helpful if you have a certificate with a DNS Name that doesn't match the host. It is certainly recommended though to ALWAYS validate the host.
  
  > We recommend that you always validate the host.
- You can now disable evaluation for a given host using the `.DisableEvaluation` case. This can be very helpful for self-signed certificates in development environments.
  
  > We would strongly advise against ever using this in a production environment.
- The `.CustomEvaluation` case allows you to provide an evaluation closure for your host to determine whether the challenge should be authenticated or not. This is syntactically much easier and safer to do than using the session and/or task delegate override closures. This also allows you to get all the default behavior for any other auth challenge type such as basic auth.
## Certificate Pinning

Certificate pinning is a useful way to guarantee that a certificate chain is not only valid, but also includes a certificate that you have provided. This is very helpful in mitigating a MITM attack. Here are some additional notes:
- You can provide multiple certificates for a given host. Each certificate is used as an anchor certificate in the evaluation of the server certificate chain.
- You can control the host validation as well when pinning certs.
## Public Key Pinning

Public key pinning has some additional advantages over certificate pinning. Public keys can be reused between different certificates after they expire. This makes it much easier to deal with revocation dates. The `ServerTrustPolicy` supports public key pinning and has some pretty powerful customizable options.
- Pin one or multiple public keys to a given host. This allows you to specify backup keys that can be used just in case your current keyset gets compromised.
- You can control whether host validation is ON or OFF.
- You can also specify whether to allow invalid certificates or not. This can be very useful in certain situations such as you have an expired leaf certificate or an intermediate certificate is missing.
  > These issues should be resolved on Production environments. We recommend using public key pinning in combination with host validation and full certificate chain evaluation.
#### Where's my SPKI (Subject Public Key Info) Pinning?

We are working very hard to make this happen, but it will not be part of this original feature set. Apple does not expose the SPKI through the Security framework which means we can't extract that chunk of data directly from the certificate data. In order to implement this, we're considering rolling our own DER decoder to do this on-the-fly. AFNetworking has already made some good progress on this front. Regardless, we won't add this feature unless we're 100% confident in our implementation. Please stay tuned. The TC is all over this.

---
## Tests Tests and More Tests

So I wrote more tests than I can possibly imagine. To give you a rough idea of how many tests I wrote, all the logic to support the `ServerTrustPolicy` is about 250 lines and the tests are ~1600 lines long. I'm sure there are still many more tests that I could write as well. Check out the `ServerTrustPolicyTests` and `TLSEvaluationTests` for more info. 

> Seriously...check it out. We need to make sure we have every possible case accounted for.
## Sidenotes
- The `NSURLSession` extension ended up being a MUCH cleaner approach than I originally had. It's fairly tricky to make the server trust policies available to the session and task delegate callbacks without any of them knowing about the `Manager`. It's great design, but presented some issues when trying to gracefully share around the server trust policies with everyone that needed them. The extension ended up being a nice way to pass it around since all the callbacks pass the `NSURLSession` in as an argument. Win win.
## TODO Before Merging
- [X] Gather feedback from the community
- [X] Finalize the public docstrings
- [X] Add section to the README covering `ServerTrustPolicy` usage

---
# Questions For You

So with this large of a change, I'm looking for the community to help give me some feedback. Security is VERY difficult to get right, and a ton of effort has gone into this original PR. However, that doesn't mean that it is all the way there. Please help me dig through this PR with a fine tooth comb so we can get all the issues ironed out before it gets merged. Here are a few questions I have for everyone.
- Are the `ServerTrustPolicy` cases clear? I have written over 10 variations of them and these were the ones that I felt were most clear.
- How about `ServerTrustPolicy`? I wanted to make sure it was specific to dealing with server trust auth challenges. I also wanted to remove SSL or TLS from the name to avoid confusion. I don't want to have to close out issues asking for us to add SSL pinning just b/c we named our APIs TLS something or other.
- What tests am I missing? I feel like I did a pretty solid job of covering all the possible cases for `ServerTrustPolicy`.
  - How about for TLS evaluation?
- Should certificate pinning have the option of `allowInvalidCertificates`? At the moment this is something that I didn't support, but I'm looking for feedback.

Thank you everyone as always for helping out!
 cc @kylef, @kcharwood
 I agree @vkedwardli. Thinking through it more it did seem to be a validate case. Support added in a1ea7318.
 I just pushed up another set of commits that completed the following:
- Refactored `allowInvalidateCertificates` to `validateCertificateChain` to be much more inline with the `validateHost` naming convention.
- Added ability to set whether to `validateCertificateChain` for certificate pinning.
- Added a bunch of tests around the new behavior.
- Added public docstrings for all public APIs.
- Added a Security section to the README.

At this point I feel really good about this set of changes. This should be good to go pending a full review from the TC.
 Thank you for the feedback @zgosalvez. 

I definitely thought about the use case of using a custom `ServerTrustPolicy` with the `Alamofire.Manager.sharedInstance`. The reason I chose not to support it is that you are always fighting a potential race condition. By opening up the ability to modify the `serverTrustPolicyManager` instance on the `session`, people could change this out while `Request`s are running which causing various threading issues.

I also think that if someone is going to go to the effort of setting up a custom `ServerTrustPolicy`, they are probably not using the `Alamofire.Manager.sharedInstance` object. They are most likely configuring a custom `Manager` instance anyways to change the default behavior such as using a custom `NSURLSessionConfiguration`.

I'll continue to think on this some more, but I'm definitely in the camp of not supporting this for now.
 Hi @crewshin,

Directly from the README updates in this PR:

---

### Security

Using a secure HTTPS connection when communicating with servers and web services is an important step in securing sensitive data. By default, Alamofire will evaluate the certificate chain provided by the server using Apple's built in validation provided by the Security framework. While this guarantees the certificate chain is valid, it does not prevent man-in-the-middle (MITM) attacks or other potential vulnerabilities. In order to mitigate MITM attacks, applications dealing with sensitive customer data or financial information should use certificate or public key pinning provided by the `ServerTrustPolicy`.

#### ServerTrustPolicy

The `ServerTrustPolicy` enumeration evaluates the server trust generally provided by an `NSURLAuthenticationChallenge` when connecting to a server over a secure HTTPS connection.

``` swift
let serverTrustPolicy = ServerTrustPolicy.PinCertificates(
    certificates: ServerTrustPolicy.certificatesInBundle(),
    validateCertificateChain: true,
    validateHost: true
)
```

There are many different cases of server trust evaluation giving you complete control over the validation process:
- `PerformDefaultEvaluation`: Uses the default server trust evaluation while allowing you to control whether to validate the host provided by the challenge. 
- `PinCertificates`: Uses the pinned certificates to validate the server trust. The server trust is considered valid if one of the pinned certificates match one of the server certificates.
- `PinPublicKeys`: Uses the pinned public keys to validate the server trust. The server trust is considered valid if one of the pinned public keys match one of the server certificate public keys.
- `DisableEvaluation`: Disables all evaluation which in turn will always consider any server trust as valid.
- `CustomEvaluation`: Uses the associated closure to evaluate the validity of the server trust thus giving you complete control over the validation process. Use with caution.

#### Server Trust Policy Manager

The `ServerTrustPolicyManager` is responsible for storing an internal mapping of server trust policies to a particular host. This allows Alamofire to evaluate each host against a different server trust policy. 

``` swift
let serverTrustPolicies: [String: ServerTrustPolicy] = [
    "test.example.com": .PinCertificates(
        certificates: ServerTrustPolicy.certificatesInBundle(),
        validateCertificateChain: true,
        validateHost: true
    ),
    "insecure.expired-apis.com": .DisableEvaluation
]

let manager = Manager(
    configuration: NSURLSessionConfiguration.defaultSessionConfiguration(),
    serverTrustPolicyManager: ServerTrustPolicyManager(policies: serverTrustPolicies)
)
```

These server trust policies will result in the following behavior:
- `test.example.com` will always use certificate pinning with certificate chain and host validation enabled thus requiring the following criteria to be met to allow the TLS handshake to succeed:
  - Certificate chain MUST be valid.
  - Certificate chain MUST include one of the pinned certificates.
  - Challenge host MUST match the host in the certificate chain's leaf certificate.
- `insecure.expired-apis.com` will never evaluate the certificate chain and will always allow the TLS handshake to succeed.
- All other hosts will use the default evaluation provided by Apple.
 Thanks for the feedback @vkedwardli. While you are certainly correct, I would strongly advise against making such a change. Anyone that needs to customize the behavior of Alamofire should be creating their own instance of a `Manager`. The `sharedInstance` is just the common case scenario. This gives you the freedom to modify the session configuration headers as well as create a ephemeral or more commonly, a background session. It also avoids the race condition of setting the `ServerTrustPolicy` after you have already started requests.
 Thanks for the feedback @briv! I couldn't agree with your comments about the documentation. I just pushed 0d8803e6 to hopefully address your concerns. Thanks again!
  Hi @kedardesai, the major of the work has already been completed, but has been de-prioritized to help us focus on the Alamofire 1.3.0 release. We will pick back up again shortly after that release is out. üëçüèª
 The majority of the functionality is already built into [AlamofireImage](https://github.com/Alamofire/AlamofireImage). Other non-image related features are currently in our Trello backlog.
  Thank you for your PR @kentya6! I merged a slightly modified version of your changes in e0dd9e84. 

Cheers. üçª
  Thank you for your feedback @joeljfischer. The `swift-2.0` branch is by no means complete. It has simply been ported to allow you to use Alamofire with Swift 2.0. We're going to rework all the error logic before the Alamofire 2.0 release goes out the door. We'll certainly consider your feedback when discussing the API changes.

Cheers üçª
  Thank you for reporting the issue. We have not been able to reproduce this issue in Travis CI or locally from our end. Could you possibly provide some more detail to the following questions?
- Is this reproducible 100% of the time?
- Are you running the iOS 8.3 simulator?
- Could you provide the full console output from running the test suite that produces a failure?
 Okay, we'll keep an eye on it but I'm going to close this issue out for now. I'll reopen it if anyone else reports this same behavior or we can track it in Travis CI. Thanks again.
  Thank you for your PR @avismarahl...much appreciated! üçª
  Of course! 

You need to post the data in the `HTTPBody` of an `NSMutableURLRequest` as XML and use the `response` serializer to parse the XML response `NSData` with an XMLParser of your choice. 

Here is an [example](http://stackoverflow.com/questions/21308227/how-can-you-use-afnetworking-2-0-to-make-a-request-of-a-soap-web-service) of how to do it with AFNetworking. The concepts are similar enough that it should translate to Alamofire.
  Perfect, thanks @kylef!

Quick question. Don't we want this change to go against the `swift-2.0` branch to target Xcode 7 instead of against `master`?
 Thanks @kylef. I added this change in 5b4a59b4.
  What version of CocoaPods did you install with?

``` ruby
pod --version
```

It's also listed in your Podfile.lock file. That will help us diagnose.

cc @kylef 
 Thanks @kylef! 

I'm going to close this issue out. @mikewalkerjr, if you still have an issue after trying @kylef's solution, please add some additional info to this issue and we can re-open it if necessary.
  Official support is now available in the `master` branch. See #539 for more details.
  Hi @Rfaessen, I'm almost positive this is not an issue in Alamofire. I just commented on the question in Stack Overflow. Let's track this issue there and we'll re-open this issue if there does end up being a problem. üëçüèª
  If you need to override the default behavior for URL encoding, then you need to use the `.Custom` case of the `ParameterEncoding` enumeration. There is no RFC spec that defines how collections should be encoded. Therefore, Alamofire provides a reasonable default, and also allows you to provide any other custom behavior you could need.

Best of luck.
  Hi @top2tech, @kylef and I spoke offline and both agree that this body part structure is something that we haven't seen before in any API / service. Could you provide us with some example APIs or usages to help us better understand your proposed changes? 

Otherwise I'm afraid we'll have to reject this change.
 @top2tech could you get back to us on this? I'm going to close this PR out tomorrow if I don't hear back from you. Cheers.
 Hi @top2tech, I'm going to close this PR out since I haven't heard back from you. If you really want to re-open this, please provide answers to the questions that have been posed in this thread. Cheers.
  Thank you for your PR @ikesyo...it is much appreciated! I combined your three commits down into one and pushed into `master` as a5c214ab.

Thanks again! üçª
  Is there any chance someone in the community that is doing a bunch of work with watchOS could help us figure out @jaybuangan's issue?
 cc @kylef, @tobiasoleary, @skywinder, @jhersh
 This issue has been resolved in b4cb7cc30ca5da25b7833e31d515ddef9acb97bc.
  This is just a guess but I think you may be missing the `use_frameworks!` in your `Podfile`. 

You should move your issue to Stack Overflow and tag `Alamofire` and `CocoaPods`. You will receive much better assistance from the community. Additionally, we don't use the GitHub project for support.

Best of luck.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @Ufosek, thank you for reporting your issue.

Without a full code sample, it is difficult to diagnose your issue. Additionally, the code sample you provided is canceling the `self.request` and then creating a new request on `self.request_`. I'm going to assume that that is a typo.

There should always be a slight delay between canceling a request and receiving the callback. The reason is that the request is running on a different queue. The cancellation needs to make it over to the other queue, then call back to the main queue to execute the serialization closure. This is certainly the expected behavior.

As for not receiving the callback, I would assume you have some sort of race condition occurring. Without a full code sample, it would be difficult to diagnose. Regardless, if you could post this question on Stack Overflow, it would receive much more attention. It also let's us focus more on core features and actual Alamofire issues rather than troubleshooting.

Best of luck.

---

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for helping out @sikhapol! üçª
  Seems like this is most likely an issue with CocoaPods at the moment. Please check out this [issue](https://github.com/CocoaPods/CocoaPods/issues/3661) for more information.
  Thanks for chiming in @polysyn, it is much appreciated. 

@njuri, please feel free to comment on this issue if that doesn't solve your problem. If there proves to be an issue with Alamofire, I'll be happy to re-open, but for now I'm going to close this out.

Cheers.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thank you for your PR @oanhof.

The `taskDidComplete` closure is exposed to allow you to completely override the default behavior if you so choose. It was not intended to allow you to hook into the `SessionDelegate` callbacks for notifications and still execute the default behavior.

As an alternative, you can use the `response` serializers to know once a task was completed. Additionally, we plan to open up more of the `Request` class in the 1.3.0 release to allow you to extend a `Request` to have additional hooks along with the already provided ones such as `validate`, `authenticate`, `response`, `responseJSON`, etc.

Hopefully this helps clarify things a bit. Cheers.
  Thanks for this PR @ikesyo! I have just a single comment that will require a few changes throughout the PR. If you could get those changes made, I'll gladly merge it.

Thank you for taking the time to clean up the logic.
 Great work @ikesyo...thanks for the changes! üçª
  It doesn't look like anything in that stack trace is crashing due to Alamofire logic. My best guess is that your `fileUrls` array is empty or the `URL` itself is invalid.

I'm going to close this out for now. If you provide some additional info that leads more towards it being an actual Alamofire issue, I'll gladly re-open it. Cheers.
 Ah cool, thanks for confirming.
  I would guess that when you are attempting to append the `fileURL` that it is actually failing. What happens if you do the following?

``` swift
    multipartFormData:
    {
        multipartFormData in
        multipartFormData.appendBodyPart(data:data!, name:"postdata")
        let error = multipartFormData.appendBodyPart(fileURL: fileUrls[0], name: "unicorn")
        println(error)
    },
```
 Ah that makes sense. See this [thread](http://stackoverflow.com/a/13523463) for more information. I'm going to close this issue out since this is the expected behavior.
  Thank you for the suggestion @sugarwyc. 

We will not be incorporating this change though since we are no longer supporting iOS 7 with Swift 2.0. Please see #525 for more information.

Cheers.
  Thanks for the feedback @top2tech...it is much appreciated!

I've addressed the core problem in f1557414 and am going to close this issue out. Please direct all future traffic to #539 so we can track it in a single place.

Thanks again! üçª
  Thanks @ikesyo.
  @kylef do you have any idea if this is an issue with CocoaPods or with the Xcode 7 migrator? Is there anything in the CocoaPods 0.38.0.beta.2 release that would help out with this?

@johndpope, what version of CocoaPods are you using?
 I was able to create a sample project and add Alamofire using your `Podfile` with Xcode 7 beta1 and CocoaPods 0.38.0.beta.2. Xcode 7 is not throwing any of the migrator warnings that you are seeing @johndpope. 

Could you possibly confirm? 

I will try with beta 2 once I have it installed on this computer.
 Again @johndpope, what version of CocoaPods did you do this with? Please run `pod --version` and post the results to help us out.
 I just created a new project in Xcode 7 beta 2 (7A121l) with CocoaPods 0.38.beta.2. I am not seeing the `Convert to Latest Swift Syntax` issue. @johndpope if you could provide some additional information or a sample project, then we can continue to debug this further. However, I'm going to close this issue out since I can't repro the issue with a clean project.
  Thanks for helping out here @NicholasTD07 and @ianp. 

I am able to compile the `1.2.3` release using `carthage update` without issue right now. I would encourage you to either open an issue with the Carthage project or open an issue on Stack Overflow. Both of those locations will be able to better help you solve your issue.

Cheers. üçª
  The `-1001` is a timeout error which is a bit different than the AFN issue you linked. Either way, the issue you are seeing is not directly related to Alamofire with what you have provided. I would encourage you to seek additional support on Stack Overflow.

---

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Check out the `swift-2.0` branch.
  @pdsavard, you need to pass `Authorization` headers as part of the `Request`. Not through the `NSURLSessionConfiguration`. See the [README](https://github.com/Alamofire/Alamofire#http-headers) for more info.
 IMO the statement is accurate @paulyoung. If you think there's room for improvement, then by all means, please submit and PR and we'll certainly take a look! üëçüèº
  Thanks everyone for chiming in.
  Thanks @katunch.
  Looks good dude!
  While that was not the original intent of the feature list, I can't think of any reason not to include it. Thanks for the PR @rojotek!
  What happens if you override the `taskDidReceiveChallenge` closure instead? Do you receive the callback then?
 Thanks @jshier. I'm going to close this issue out @dcunited001. If you provide more info that leads us to believe there is actually an issue, I'll gladly re-open the ticket.
 Thank you for documenting @dcunited001...much appreciated. Hopefully it helps someone else out that runs into the same issue. üëçüèº
  This pull request adds support for uploading `MultipartFormData` to Alamofire. I would love feedback from the community to make sure everything here is in tip-top shape before rolling it in. Any feedback would be much appreciated.
## MultipartFormData

The general idea is that you append body parts to the larger MultipartFormData object, then encode it when you want the cumulative result. Encoding can be performed in two different ways:
1. Encoding In-Memory
2. Encoding Data by Streaming to Disk
### Encoding In-Memory

Encoding in-memory should only be used with small datasets. If the `contentLength` of the `MultipartFormData` is too large, you run the risk of your app being terminated due to memory usage.
### Encoding Data by Streaming to Disk

Sometimes you need to upload a very large dataset to a server such as a bundle of large images or videos. In these cases, your dataset is too large to perform the encoding in-memory. For these cases, the `MultipartFormData` class supports encoding the data using a combination of input and output streams keeping the memory footprint very small.
## Uploading from Manager

The `upload` methods for uploading `MultipartFormData` support the idea of a memory threshold. To make it as easy as possible, the memory threshold is used to determine whether the `MultipartFormData` can be encoded in-memory or whether it needs to be written to disk first. The default value for the memory threshold is currently set to 10MB.

In order to make the encoding process asynchronous, the upload methods could not return a `Request` object directly. To handle this case, the `MultipartFormDataEncodingResult` enumeration was added and exposed in an `encodingCompletion` closure. The resulting `Request` object is contained as an associated value in the `.Success` case which can then be used to chain additional methods against. While this is a bit different than the other public APIs, it still is quite simple to use.

``` swift
Alamofire.upload(
    .POST,
    URLString: "http://httpbin.org/post",
    multipartFormData: { multipartFormData in
        multipartFormData.appendBodyPart(fileURL: unicornImageURL, name: "unicorn")
        multipartFormData.appendBodyPart(fileURL: rainbowImageURL, name: "rainbow")
    },
    encodingCompletion: { encodingResult in
        switch encodingResult {
        case .Success(let upload, _, _):
            upload.responseJSON { request, response, JSON, error in
                println(JSON)
            }
        case .Failure(let encodingError):
            println(encodingError)
        }
    }
)
```
## Summary

This was a fairly complicated feature to put together, so I'd really love to gather everyone's feedback. If you have a solid grasp of RFC 2388 and 2045, then please take the time to review these changes before we merge it in.
 cc @kylef and @kcharwood 
 We will definitely merge this into the swift-2.0 branch once this gets merged into master @kamoljan. 
 Thanks @orschaef and @kaelite. That's totally my bad. I simply forgot to set the `Content-Type` on the `URLRequest`. I'll have it all fixed up shortly and will also adds tests around it @kylef.
 @orschaef and @kaelite...the `Content-Type` issue should be resolved with f1557414. If you could give it a go I would really appreciate it.
 Thank you for confirming @orschaef. I'm going to go ahead and merge this. Thank you everyone for all your help getting this feature tightened up! üéâ üéâ üéâ
 Hi @damienrambout, thanks for your feedback. 

Just for anyone else reading through this, I'd like to clarify a bit. The `upload` function doesn't return a `Request` directly because it needs to encode the `MultipartFormData` before creating the `Request`. Since the encoding operation can be very small or extremely large, you really don't want to block the caller thread while executing this. Therefore, the encoding is asynchronous and the `encodingCompletion` closure returns the `Request`. This is all intentional and by design.

A second approach in AFNetworking is to subclass `NSInputStream` and provide a dynamic upload stream rather than encoding it prior to the upload. While this is more convenient, it is extremely error prone. Additionally, subclassing `NSInputStream` is a very difficult and quite finicky. It's backed by an opaque type that needs to have certain methods overridden when toll-free bridging. It's just not a very robust or maintainable solution.

Our goal with Alamofire is to provide the absolute highest quality networking layer on top of the URL Loading System that we possibly can. Therefore, sometimes we will choose to implement certain features differently than AFNetworking to continue to improve the overall quality of its successor, Alamofire.
 @ivangodfather you can either append them as query parameters to an `NSURLRequest` or you can add them as multipart form data values using the following method:

``` swift
func appendBodyPart(#data: NSData, name: String)
```
 You got it!
 Hi @robindoble, please check out the test [logic](https://github.com/Alamofire/Alamofire/blob/master/Tests/UploadTests.swift#L134-L552). My guess is that you just have a syntax issue. If you do end up finding a mistake in an example code snippet in the README or something like that, please submit a PR or file a new issue. Thanks!
 Hi @robindoble, the `Content-Type` header is set automatically for you. If you need to set additional headers, you can either set them in the `NSURLSessionConfiguration` when you create the `Manager` instance, or you can set them on the `NSURLRequest` before you pass it into the `upload:multipartFormData` method as a `URLRequestConvertible`.
 That's not how to go about this @ivangodfather.
 @SteveNewhouse you want to use the `ParameterEncoding.queryComponents` API to help you out here. Here's some sample code to get you on track:

``` swift
let imageData: NSData? = NSData()
let URLRequest = NSURLRequest(URL: NSURL(string: "https://httpbin.org/post")!)

Alamofire.upload(URLRequest,
    multipartFormData : { multipartFormData in
        if imageData != nil {
            multipartFormData.appendBodyPart(data: imageData!, name: "avatarImage", fileName: "blah", mimeType: "image/jpeg")
        }

        let user: [String: String] = [:]

        for (key, value) in ParameterEncoding.URL.queryComponents("user", user) {
            multipartFormData.appendBodyPart(data: value.dataUsingEncoding(NSUTF8StringEncoding)!, name: key)
        }
    },
    encodingCompletion: { result in
        // todo
    }
)
```
  Thanks @ikesyo. You are most likely running into ATS @excelsior. Here's an article with some good information about what's going on and how to get around it if you absolutely have to. 

Please note that we do not encourage you to use non-secure connections on iOS 9. We will be posting an in-depth security document with the release of the Xcode 7 GM along with Swift 2.0.
  Hi @jessecurry, thank you for your feedback.

There is a way to reset the credential, but it is pretty hidden. You could get the credential storage and remove the credential like so:

``` swift
let manager = Alamofire.Manager.sharedInstance
if let storage = manager.session.configuration.URLCredentialStorage {
    storage.removeCredential(credential: credential, forProtectionSpace: protectionSpace)
}
```

However, since this would be brutal to have to do each time and still utilize the convenience of the `authenticate` method, I think your proposal for exposing the `persistence` parameter is valid. 

I have incorporated your suggestion into cb9e11b9 and set the default value to `.ForSession`. Thus, the change is backwards compatible and still has the same default behavior as before.

Cheers üçª
  Thanks for helping out @jshier.

To start @alienxp03, let me give a bit of background. Alamofire was not designed to be a Swift port of AFNetworking. It was designed to be a new Swift approach to networking in general. Things like method chaining, powerful enumerations and generics were not possible when AFNetworking was built. Therefore, we can create MANY new design patterns making Alamofire much easier to use. Please do not expect Alamofire to work exactly as AFNetworking. The two are VERY different libraries.

With that said, you have an interesting PoV here @alienxp03. Why do you feel that a 401 should automatically trigger an error? Apple doesn't trigger an error for a 401, why should Alamofire? As @jshier mentioned, this is why the `validation` methods exist. It allows you, the user, to customize the behavior of all possible status codes. In certain cases, a 401 may mean there was a basic auth issue, or possibly a server call that was making an unauthorized request to another service. There are endless amounts of situations where a 401 could mean different things. In certain cases, it isn't even actually an error to the client. This is why we don't automatically generate errors at the Alamofire level. We require the user to tell us what the error conditions are. Does that make sense?

Now, to your last point that the validation error that is returned is not super helpful. I agree that it could be better, but it is still enough for you to know that you didn't pass validation. You can then check the status code to see why it failed validation if you like. In the Alamofire 2.0 release, we are going to be reworking all the error handling logic to accommodate the Swift 2.0 changes as well as make cases like this a bit easier to diagnose.

Hopefully that helps clear up any confusion. Cheers üçª
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thank you for your PR @marcelofabri. 

We are going to revisit all error handling logic for the Alamofire 2.0.0 release. We'll keep these changes in mind when we are considering alternatives for Validation handling, but for now I'm going to close out this PR since this would not be backwards compatible.

Cheers üçª
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Hi @joshuatbrown, thank you for your PR! The more people we have pointing out the flaws in our documentation, the better we can make it for everyone. 

I modified your commit slightly in fd2eeb7f and improved the overall example in 02625150. Everything is much better documented now and updated to Swift 1.2. 

Cheers üçª
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Looks like I missed the playground in the conversion. Thanks @terhechte!
  Thank you for your PR @berikv. As I mentioned in #528, this is something we're going to take a much larger approach to solving properly. Thanks again.
  Thanks for your feedback @berikv. This issue is a duplicate of #447 and I'm going to close it out as such. This is something we're planning on addressing in the 2.0.0 release.

For now, you can simply key off the domain and `-1` code if you like since validation is the only step that throws such an error.
  Thanks everyone for helping out here. I have modified the README in the `swift-2.0` branch in 6453f83b to hopefully eliminate this issue in the future.
  Alamofire caching works as expected and leverages all the default behavior of `NSURLSession`, `NSURLSessionConfiguration` and `NSURLCache`. We recently added a large amount of tests around this behavior to prove that it does work as intended. Please check out the [CacheTests](https://github.com/Alamofire/Alamofire/blob/master/Tests/CacheTests.swift) for more information.

In the future, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire` instead of creating a support issue on Github. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks for your PR @mishagray. We will not be supporting iOS 7 in the `swift-2.0` branch. It too difficult to maintain multiple test targets to ensure the quality of that OS. Please see #523 for more details.

Cheers.
  Thanks @3a4oT. We've already cut a `swift-2.0` branch which will not be officially released until Xcode 7 hits GM.
  Thanks for the PR @coverback. It is much appreciated!

The `swift-2.0` does not include this check on purpose. We are going to be dropping iOS 7 support here very soon. The reason is that we cannot properly test against iOS 7 in Travis-CI without rewriting our entire test suite. The separate test suite would need to import all the Swift files (since you cannot import frameworks in iOS 7) into the target and all the tests would need to be re-written and duplicated. Since this would be a huge effort and very difficult to maintain, we've decided that it is in the best interest of the project to keep moving forward and not bring iOS 7 support along with us.

You will see more formal updates about these changes take place in the README on the `swift-2.0` branch as well as `master` here in a future release.

Thanks again.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thanks @mathiasnagler!
  Thanks for the PR @joshuatbrown...this looks good to me!
  Hi @sai-prasanna, thankfully there is not a bug here. Unfortunately you are just misusing the API. Here's the signature of the global method you are calling:

``` swift
public func request(
    method: Method, 
    URLString: URLStringConvertible, 
    parameters: [String: AnyObject]? = nil, 
    encoding: ParameterEncoding = .URL) 
    -> Request
{
    // implementation...
}
```

You'll notice that the `mutableRequest` you are passing in conforms to a `URLStringConvertible`. In the implementation, the `URLString` for the convertible is extracted to create a new `NSMutableURLRequest` that will have the "default" cache policy. This is absolutely the intended behavior in this case.

Instead, you need the other `request` method which is as follows.

``` swift
public func request(URLRequest: URLRequestConvertible) -> Request
```

This method will use your `mutableRequest` directly keeping your cache policy in place.
  This is a great start @NicholasTD07! Thank you for putting this together. 

I'm going to dig into this tonight. I'll most likely pull in your changes and rework some of the error handling along with a few other minor things. I'll also most likely blacklist the `swift-2.0` branch from the Travis-CI yaml file until Travis supports the Xcode 7 beta.

Thanks again!
 Thanks again for your work on this @NicholasTD07. 

I ended up starting from scratch given the small but challenging complexities that were presented in some of the changes. There were a few API changes introduced in iOS 9 along with some different external parameter naming conventions that I had to go through individually. It was also a bit interesting migrating over to the new error handling logic both in Alamofire and the test targets.

Everything has been completed and Travis-CI has been disabled in the new `swift-2.0` branch. I really wish that we could run Travis-CI over this branch with all the different simulators, but it isn't supported yet and probably won't be for at least a month. If everyone in the community could try this out I'd really appreciate it. All the tests are passing on both iOS 9 and Mac OS X 10.10. I'm having trouble with my iOS 8 simulators and don't have another install of Mac OS X 10.11 to test with.

Thanks again everyone for your help on this!
  Hey everyone, thanks for all the feedback here! Apologies for not getting a chance to comment on all this until now. Busy week at WWDC.

I'm going to start working on Swift 2.0 support tonight. I'll be pushing up a new `swift-2.0` branch that everyone will need to use until Xcode 7 reaches GM. Once the GM is released, we'll pull the `swift-2.0` branch into `master` and cut another release, just like we've been doing in the past with Swift 1.1 and 1.2.

Cheers üçª
 Hi @dslysenko, believe me, we're aware. We've been hard at work pushing the 1.3.0 release out the door. All efforts are now being focused on porting each and every one of those commits over to the `swift-2.0` branch.
- https://twitter.com/AlamofireSF/status/624734484609368064

Stay tuned.
  Thank you for your PR @alexpls. I accepted your change with slight modifications in c40d7907.
  Hi gents...thanks for the info here.

In this case, I'd say Alamofire has the correct default behavior. If no data is added to the `HTTPBody` of the `NSURLRequest`, then the `Content-Type` header should not be attached. If you do need to attach the `Content-Type` header, you can do that manually for this particular case.

Adding custom headers will also become much easier in the Alamofire 1.3.0 release. Cheers.
  Hey @joshuatbrown, I think this is a great idea! Here are a couple Stack Overflow answers I have posted on that topic that should get you going in the right direction.
- http://stackoverflow.com/a/29752650/1342462
- http://stackoverflow.com/a/28519246/1342462

Just hit us up if you run into any issues putting it together. Thanks for taking the initiative here!
  Thank you for that very detailed write up @ibru. It is very much appreciated.

Unfortunately you have stumbled upon a nasty issue in CFNetwork. There is a known threading issue with `ensureParserFinished` that has already been filed with Apple. There is a massive thread full of fantastic information from the AFN community which can be found [here](https://github.com/AFNetworking/AFNetworking/issues/2334).

I would like to take the same approach as AFN on this one. If anyone finds any possible workaround for Alamofire for this issue, we'd be happy to adopt the fix. Until then, it may be wise to avoid using `debugPrintln(request)` on consumer facing builds. If you see this crash in your debug builds, at least now you'll know the root cause of where the issue truly lies.

Thanks again.
  Thank you for this PR @psobot! My apologies for not getting back to you sooner. Our TC has been really busy this week at WWDC. I'm really excited about this change but haven't had enough time to go through it in depth. I should be able to get to it here in the next few days.

Thank you for your patience! üçª
 This is great work @psobot! Thank you very much for your PR. I have pulled it into master in a combination of the following commits: a15dc1d6, 93df9fe2 and 922c1ca3.
  Duly noted. We've had some very interesting discussions / debates on AFNetworking around the usage of the Reachability APIs and how useful they truly are. I'll huddle the TC at WWDC and we'll see if this is something we want to get onto the roadmap.

I'll go ahead and leave this issue open for the moment for others to comment as they like.

Cheers üçª
 Thanks for the feedback @jshier. I agree that the usefulness is for handling the connectivity restored notification. As for it being out-of-scope for Alamofire, I don't entirely agree. We want Alamofire to be the best way to use NSURLSession in Swift. Dealing with connectivity issues and events is certainly a part of that story.
 Thanks for posting that @ashleymills. I'm going to go ahead and close this issue out. We're still debating this internally to figure out whether this is something we'd like to directly support. Once we make a decision, I'll update this issue. Thanks for everyone's input here. üëèüèºüëèüèºüëèüèº
  Hi @allaire, any chance you could provide some additional information (code sample or Github project) or even better, a set of tests that reproduce the issue and submit a PR?
 Any chance you could also throw up the output of `debugPrintln(request)` on that request? That would make it much easier to debug. My initial guess is that you are failing the response validation due to the `Accept` header not matching.
 Sorry about that @allaire, I should have been a bit more specific. Could you post the debug output for the original `Alamofire.Request`?

``` swift
let request = Alamofire.request(Router.CancelRequest(organizationId: myRequest.organizationId, id: myRequest.id))
request.validate()
request.responseJSON { (request, response, json, error) in
    if error != nil {
        ProgressHUDManager.serverError()
        println(response)
        println(json)
        println(error)
    } else {
        self.myRequests.removeAtIndex(indexPath.row)

        tableView.beginUpdates()
        tableView.deleteRowsAtIndexPaths([indexPath], withRowAnimation: UITableViewRowAnimation.Automatic)
        tableView.endUpdates()
    }
}

debugPrintln(request)
```
 Looks to me that the response is coming back with a 500 status code. The error leads me to believe that the response is being parsed as JSON even though it is not. The `Content-Type` header is not `application/json` as it should be.

At this point, I would try to debug this further just using cURL or whatever HTTP client you're most familiar with. Once you have the service working exactly as you would expect, then I would try with Alamofire again.

I'm going to close this issue out as it looks to me that everything is working as expected. Best of luck!
 If it is not a string or JSON, then you want `response`. If it is a string, then you most likely want `responseString`. If it is JSON, then you most likely want `responseJSON`. These are general guidelines for the common cases. You can certainly mix and match the various response serializers to meet your needs. I'd recommend carefully reading through the [Response Serialization](https://github.com/Alamofire/Alamofire#response-serialization) section of the README.

If you could direct all further questions to Stack Overflow it would be much appreciated. You'll have a much larger community to help you out there.

---

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Okay I'm going to re-open this gents.

Could someone possibly help me out here and write some failing tests to make it easier to debug the issue? We're in the middle of pushing through some giant features for the `1.3.0` release and it would save me a TON of time if there were already some tests that were failing demonstrating the issue.

The `httpbin.org/status/:code` endpoint should be very helpful here.
 Hey @allaire, @MartinRogalla and @Mistobaan! 

I just pushed up PR #598 that hopefully addresses this issue. I would REALLY appreciate it if you could test out this change to verify it does in fact fix your issue. Also, if you have any ideas on how I could add a test around this behavior I'd very much appreciate it.

Please redirect all further comments to PR #598 until we get this resolved.

Cheers üçª
 Closing this issue out since it has been resolved by PR #598. Cheers.
 @joshuaziering Yes, these changes have been merged for quite a while. Please open a new issue if you think there's a bug with Alamofire or open a question on StackOverflow and tag `Alamofire` if you're having trouble getting your content validation to work.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  We are adding support for multipart form data in the 1.3.0 [release](https://github.com/Alamofire/Alamofire/milestones). We have not started that work yet. Cheers.
  The previous tests were sporadically failing when pointing at `google.com` with an `NSURLErrorHTTPTooManyRedirects` error. I moved over to `httpbin` to have more stable behavior for our automated test suite. Other changes include:
- Added default behavior tests for redirects
- Added redirect tests for using task override closures to perform and cancel redirects
- Added tests for default behavior and task override closures around multiple redirects
 cc @kcharwood, @kylef, @mattt 
  I managed to re-enable our Travis-CI builds for Alamofire. This is really my first trial with Travis-CI so I'd appreciate it if others could look this over for me. Here's a list of changes that I made.
- Switched to the latest `osx_image` which is `beta-code6.3`
- Added xcodebuild phase for the OS X tests which are now passing
- Added a `gem install cocoapods` to make sure we're linting with the latest version
- Added a CocoaPods Compatible tag to the top of the README
- Added a Carthage Compatible tag to the top of the README
 cc @kcharwood, @kylef, @mattt 
  I added tests around common `NSURLCache` usage with `Cache-Control` headers. This is mostly to demonstrate that caching does work properly with Alamofire as well as the expected behavior with the common types of `Cache-Control` headers. These tests were a bit difficult to get written and I'd love everyone's feedback.

With how Apple has implemented this behavior under the hood, it makes it quite difficult to test whether a particular request hit the network or retrieved the response from the cache. The actual negotiation of checking cached response expirations and going to the network is completely hidden from us. You can start to inspect this behavior with something like Charles Proxy, but we don't have that ability from the public API side of the URL Loading System...more details [here](http://andrewmarinov.com/ioss-corenetwork-lying/). Therefore, the only thing that I was able to use to determine whether a response came from the cache or from the network was to check the response's timestamp. By introducing a 1 second delay, I was able to always confirm whether a response came from the cache or the network.

The initial commit demonstrates my first pass at the tests. This approach was pretty solid, but was too slow. Each test introduced two network calls with a second wait between them. This doesn't scale very well and we'd love to keep our testing times down as much as possible.

The second commit results in the same tests, but optimized for speed and readability. I've added a pretty hefty amount of documentation around the tests to explain how they work. While the code is fairly self documenting, it's still complicated how everything gets set up.

With the second pass, I was able to condense the entire set of cache policy tests into single tests. This makes it a bit more difficult to debug the tests, but makes them run much faster and is much easier to understand what the test is actually testing.

As mentioned before, I'd love everyone's feedback.
 cc @kcharwood, @kylef, @mattt 
 Looks like I've still got some work to do here. I'll investigate this tomorrow as to why we're seeing failures on Travis as well as why NSURLCache has different behavior for the `no-store` header value between platforms.
 Okay, problem solved...Travis is happy!
 I can now that I've gotten to the bottom of it! üòõ

It appears that there was a bug in the iOS 8.2 simulator which I was using when I wrote the tests. Switching over to the iOS 8.3 simulator fixed the issues and we're now seeing the same behavior between iOS and OS X. Thankfully both are producing the "expected" behavior as well at this point since a `Cache-Control` header with a `no-store` value certainly shouldn't cache that request. FWIW, I'm also seeing the wrong behavior in the iOS 8.1 simulator as well.

From what I can tell by scouring the Internets is that people have been reporting all sorts of caching inconsistencies across iOS 8 (including against Alamofire itself). It looks like Apple may have finally gotten iOS 8.3 back in line. I think for now, it's probably best to just move forward. I don't think it makes sense to file a rdar for something they've already fixed. I also don't think it makes a ton of sense to write tests to try to test the older broken behavior. At the moment, we're running Travis against the latest iOS Simulator and OS X x86_64 architecture.

My approach here was to simply get tests around the expected NSURLCache behavior on both platforms, and make sure we stay green here moving forwards. Does that sound reasonable?
 That sounds good @kcharwood. I'm going to merge this PR and start working on a separate PR to add simulators for all our supported OS's as well as branch the necessary tests.
  This PR originates from the discussion in Issue #497 and PR #500. I dug through all the past issues related to percent escaping characters and came across the following: #121, #155, #166, #206, #369 and #370. The percent escaping logic has progressed nicely and is solid and well tested.

To this end, I noticed a couple of things that could be improved.
1. It would be good to clarify in the `escape` function which characters we're escaping and why.
2. In the URL parameter encoding tests, give a description of the test cases and which specs they follow along with the exceptions that have been made.

All this PR does is add the "[" and "]" characters as well as split the legal escaped characters into `generalDelimiters` and `subDelimiters`. I think this makes it much easier to understand when referencing [RFC 3986 - Section 2.2](http://tools.ietf.org/html/rfc3986#section-2.2).

The final change was to update the README mismatch which was kindly pointed out by @joshuatbrown in PR #500. I simply corrected the character to `%2B`.
 cc @kcharwood, @kylef, @mattt 
 Great point about the comment. I'll update it accordingly. 

As for the tests, great question. I already see where you're heading with that. I did some more investigation to figure out exactly why they were passing before without the change, and they're still passing with the change.

After digging in, I found the root issue. The problem is that `CFURLCreateStringByAddingPercentEscapes` claims to adhere to RFC 3986, but considers `[`, `]` and `#` to be illegal characters. It's really difficult to understand why they consider them illegal characters because the spec itself doesn't refer to characters as legal and illegal. Instead it refers to them as reserved and unreserved characters. Additionally, we're not encoding the "entire" URL, but just the query parameters.

I'm going to investigate some more and probably add some additional tests.
 Okay so in 3c95af26, I added a bunch of tests and a public docstring on the `escape` method to make things as clear as possible. Now there shouldn't be any question why or how we percent escape our query string characters. 

Here's a fun little chunk of code to run in a playground that demonstrates the "legal" vs. "illegal" ASCII characters from the Core Foundation PoV.

``` swift
import Foundation

func escape(string: String) -> String {
    return CFURLCreateStringByAddingPercentEscapes(nil, string, nil, nil, CFStringBuiltInEncodings.UTF8.rawValue) as String
}

let asciiCharacters = [
    " ", "!", "\"", "#", "$", "%", "&", "'", "(", ")", "*", "+", ",", "-", ".", "/", ":",
    ";", "<", "=", ">", "?", "@", "[", "\\", "]", "^", "_", "`", "{", "|", "}", "~",
    "0123456789", "abcdefghijklmnopqrstuvwxyz", "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
]

asciiCharacters.map { println("\"\($0)\" = \"\(escape($0))\"") }

let nonLegalCharacters = " \"#%<>[]\\^`{}|"
```

Which outputs...

```
" " = "%20"
"!" = "!"
""" = "%22"
"#" = "%23"
"$" = "$"
"%" = "%25"
"&" = "&"
"'" = "'"
"(" = "("
")" = ")"
"*" = "*"
"+" = "+"
"," = ","
"-" = "-"
"." = "."
"/" = "/"
":" = ":"
";" = ";"
"<" = "%3C"
"=" = "="
">" = "%3E"
"?" = "?"
"@" = "@"
"[" = "%5B"
"\" = "%5C"
"]" = "%5D"
"^" = "%5E"
"_" = "_"
"`" = "%60"
"{" = "%7B"
"|" = "%7C"
"}" = "%7D"
"~" = "~"
"0123456789" = "0123456789"
"abcdefghijklmnopqrstuvwxyz" = "abcdefghijklmnopqrstuvwxyz"
"ABCDEFGHIJKLMNOPQRSTUVWXYZ" = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
```
 So for some reason I decided to look at the Core Foundation header this morning instead of Dash and low and behold, the answer was revealed. The header states that the `CFURLCreateStringByAddingPercentEscapes` method follows [RFC 2396](https://www.ietf.org/rfc/rfc2396.txt), not [RFC 3986](https://www.ietf.org/rfc/rfc3986.txt) like the Dash documentation states...(sad trumpet plays).

Not only is the mismatch rdar worthy, but it can cause a TON of confusion. This would be especially problematic for people working with IPv6 addresses. Support for them was added to RFC 2396 in the [RFC 2732](https://tools.ietf.org/html/rfc2732) amendment. Both of these were replaced with the latest version of these specs which is RFC 3986.

I think at this point, I'll file a rdar explaining the documentation mismatch and update the docstring accordingly along with adding the openradar link into it.
  @skywinder we are going to extend the `request`, `download` and `upload` convenience methods to support custom headers in the 1.3.0 release. We are also going to update the `ParameterEncoding` `encode` method to return an `NSMutableURLRequest`. These two changes should make it MUCH easier to add your own authorization header to a request.

For the time being, I'd like to avoid having special hooks into the `Manager` for appending certain "special" header. Before you know it we'll be supporting a handful of them when this could (and should) be easily handled by the client.

Thoughts?
 Thank you for your feedback @tomj. I agree that `Authorization` headers are a very popular authentication mechanism. We're trying to avoid adding too many APIs around auth and want to encourage users to "think" about and "understand" what it is they are really doing. Note the 20 [issues](https://github.com/search?q=setAuthorizationHeaderFieldWithUsername+language%3AObjective-C+language%3AObjective-C&ref=searchresults&type=Issues&utf8=‚úì) listed around `setAuthorizationFieldWithUsername:password:`. We want to avoid confusion and make it easy to understand the difference between how a `Request` is constructed and how auth challenges are handled.

The changes I mentioned earlier are a big step in that direction. Adding an `Authorization` header should take place when the `NSURLRequest` is being constructed. Now if you start thinking about how this would work in Alamofire, it gets a bit interesting. In AFNetworking, you have the concept of a `RequestSerializer`. In Alamofire, this does not exist. You need to add the header at the time of creation, which makes things much easier to understand. This may however make things slightly less convenient, but potentially saves people from their own mistakes.

Which leads me to my next point. @skywinder I don't think it would be wise to add a `setAuthorizationFieldWithUsername:password:` on a `Request` because you cannot modify the `Request` once it has been created. It's task has already been sent to the `NSURLSession` to be executed. This is not the case if you set the `startRequestsImmediately` flag to `false` on your `Manager` instance, but the majority of users will most likely use the default value.

This means that you can only attach the Authorization header at the time of construction, which is consistent for all headers and is simple to understand. Now there may be a way to expose a class method on a `Manager` instance to make it easy to generate an `Authorization` header, such as a class method like the following (don't hold me to the method signature):

``` swift
public class func authorizationHeaderWithUser(_ user: String, password: String) -> String
```

This would allow users to easily create a base64 encoded String to pass into the `request` function as an `Authorization` header. It's a similar idea to the `defaultHTTPHeaders` static property. I don't think it would be a good idea to add support directly in the convenience `request`, `download` and `upload` functions for a `Authorization` header. We're trying to keep those as light-weight as possible. Now I'm not advocating for this approach, I'm just throwing it out there as food for thought.
 @allaire, your approach is correct. You want to use the `URLRequestConvertible` to attach the header for now. In the 1.3.0 release, you will have a second option that will allow you to pass a `headers` dictionary into the `request`, `download` and `upload` global methods.
 @skywinder I'm going to close this issue out. We can revisit this after the 1.3.0 release if necessary. I would like to avoid specific header implementations directly in Alamofire with the exception of the `headers` parameter in those top level functions that we're adding in 1.3.0.
  Thank you for your PR @joshuatbrown! I've pulled a version of your change into #504. Cheers üçª
  It is outdated, but still stands. We are going to be adding Multipart Form Data support in the Alamofire [1.3.0](https://github.com/Alamofire/Alamofire/milestones) release. Until then, you'll want to follow the info in that thread to get started.
 Hey everyone, I just put up PR #539 which adds support for `MultipartFormData` uploads. I would love your feedback before merging it in. Cheers.
  That's a failed authentication challenge. Set the `sessionDidReceiveChallenge` property accordingly. See Apple's documentation on [Authentication Challenges and TLS Chain Validation](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/URLLoadingSystem/Articles/AuthenticationChallenges.html) for more details.
 Here's an [example](http://stackoverflow.com/a/30416865/1342462) of how you can dig into the `sessionDidReceiveChallenge` property.

> You should **NOT** use the implementation in that thread directly since it is disabling security checks. However, it should prove useful for debugging purposes.
 Hi @edasque, I'll give you a quick description of what's happening. Please redirect further issues with this to Stack Overflow. We just don't have enough time to troubleshoot everyone's TLS handshake issues.

With that said, @mattt mentioned that you are seeing a failed authentication challenge because that's exactly what's happening. The server is initiating a TLS handshake, and iOS by default is evaluating the challenge as a failure. This can be for several different reasons, some of which can include an expired certificate, an unsigned certificate or a certificate with a different domain than the `NSURL` that was requested. These are security checks automatically provided by the iOS Security framework to make your life easier.

Since some people need explicit control over these behaviors, we have opened up the ability to override the default Alamofire behavior. That's why I posted the response that I did to show you the basics in how to go about customizing that behavior. What you need to figure out is why the auth challenge is passing through cURL and failing in the iOS evaluation.

Best of luck!
  Thank you for your excellent discussion here @joshuatbrown and @tobiasoleary! It is much appreciated and allows others using Alamofire to learn from you. üëçüèª

I've dug through this discussion along with PR #500 and have combined everything into PR #504. If you could take a look I'd appreciate it. I'm going to close this issue out for now. Please direct all info related to this topic to #504 from this point.

Thanks again! üçª
  The object type of the `parameters` parameter is `[String: AnyObject]?`. Your `params` dictionary is of type `[String: String?]` which cannot be cast to the expected type. That is the problem. 

Also, you probably shouldn't be passing in a parameter if it doesn't exist. Otherwise you could always nil coalesce the `firstname` value into some default like so.

``` swift
let params = {
    "firstname": first.firstname ?? ""
}
```

For future issues, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire` instead of creating a support issue in Github. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Our prescribed approach is to use the built-in mocking capabilities of `NSURLProtocol`. This is not yet documented, but that's on our list of things to do.
 There are other libraries out there @vgatto such as [OHHTTPStubs](https://github.com/AliSoftware/OHHTTPStubs) that could assist for the time being.
 Hi @vgatto, I'm going to close this issue out. We do not have plans to modify the `Manager` or `Request` classes to allow for easier mocking. Instead, we will create documentation around using `NSURLProtocol` for mocking responses. It is already on our internal roadmap but has not been slated for an actual release yet. Cheers üçª
 This is still in our backlog @sohayb. No updates of a timeframe at the moment. There is a [small test](https://github.com/Alamofire/Alamofire/blob/master/Tests/URLProtocolTests.swift#L27-L81) that does demonstrate how to do this. That at least shows you the basics. Should be enough to get you going. üëçüèº
  From our Contribution Guidelines:

> # Asking Questions
> 
> We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on Stack Overflow instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  If you don't use `request_`, no, nothing really bad will happen. It acts like any other value assigned to an unused variable.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  This PR contains several major changes to the test suite including:
1. Refactors all tests to follow the `Given` | `When` | `Then` structure
2. All tests now succeed on iOS and OS X
3. Adds safeguards to all tests to prevent the test suite from crashing when tests fail

My apologies for the horrendous diff. I would suggest checking out the branch and reviewing it that way. None of the tests have been removed. They have only been refactored to follow the new structure and to be safe from potential crashes.
 cc @kcharwood, @mattt and @kylef for review.
 We need Travis CI to support Xcode 6.3 because we've moved over to Swift 1.2 which only ships in that version of Xcode.
 I dig it. Nice work, @cnoon.
  Thanks for the PR, @mustafaibrahim989, but this implementation is incompatible with our project design goals. Specifically, it creates a strong dependency on UIKit, making Alamofire incompatible with OS X. It also has tight coupling to a shared singleton instance and isn't thread-safe. We are looking into ways to incorporate this kind of functionality in the future.
  I'm not sure if this is a suggestion on how to improve the documentation or not, but without more information, I can't be certain. Since there's no actionable item here, I'm going to close this issue out.
  That's why there's an overload that takes a `URLRequestConvertible`. Just set `HTTPBody` to an `NSMutableURLRequest` and pass it into that.
  From the Contribution Guidelines:

## Asking Questions

> We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Please follow the instructions in the [README](https://github.com/Alamofire/Alamofire/blob/master/README.md#installation). The iOS example app runs on a device without any issues and many people in the community are using Alamofire on devices. The issue is specific to your project and you should ask your question on Stack Overflow as @mattt mentioned.
  Try encoding the parameters as `.JSON`.

``` swift
let parameters = [
    "arg1": [
        [
            "id": "001",
            "name": "person1"],
        [
            "id": "002",
            "name": "person2"
        ]
    ]
]

let request = Alamofire.request(.POST, "http://httpbin.org/post", parameters: parameters, encoding: .JSON)
request.responseJSON { request, response, json, error in
    println(request)
    println(response)
    println(json)
    println(error)
}

debugPrintln(request)
```
 @fanny303 No, this is intended behavior. From [the docs](http://cocoadocs.org/docsets/Alamofire/1.2.2/Enums/ParameterEncoding.html#/s:FO9Alamofire17ParameterEncoding3URLFMS0_S0_):

> A query string to be set as or appended to any existing URL query for GET, HEAD, and DELETE requests, or set as the body for requests with any other HTTP method. The Content-Type HTTP header field of an encoded request with HTTP body is set to application/x-www-form-urlencoded. Since there is no published specification for how to encode collection types, the convention of appending [] to the key for array values (foo[]=1&foo[]=2), and appending the key surrounded by square brackets for nested dictionary values (foo[bar]=baz).
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Thank you for your PR @skywinder. 

We're going to be reworking the entire test system in the `1.2.3` release coming very soon. We will be hardening the tests as well as adding safeguards around each test to ensure crashes cannot occur even if the tests fail.

I'm going to decline this PR because we're going to address this issue in a much bigger way. Thanks again. Cheers :beers: 
  Thank you for your pull request @SebastienMichoy! 

I have updated the iOS 7 instructions in 17bfcd1d. While I did not end up merging your PR directly, I thank you for bringing the documentation issue to our attention. Cheers :beers: 
  Apologies for not commenting on this earlier @skywinder. We really appreciate you submitting the PR! I merged a slightly modified version of your changes in 464e31b5 and credited you with the change.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Your code sample appears to be incorrect. `var manager` is not `self.manager`.
 > Only remedy is to initialize manager for each session or use custom encoding and delegate to set the headers

That sounds about right. There's not much to be done about API differences between iOS 7 and 8, so it's best to not rely on any particular behavior there.
 > But initializing manager for each request, defeats the purpose of having manager.

Don't do that, then. Managers manage a session, which can make many requests.
 > Also I think in README it should be noted that on iOS 7, once a manager is initialized, configuration is read-only.

The README already notes that Alamofire is built on top of the Foundation URL Loading System, and that an understanding of those APIs is invaluable.
 You can always attached your `Referer` header to the `NSURLRequest` that is actually making the request on iOS 7. That will certainly work as a workaround.
 Hi @tosbaha, something like that could work. Here's a post on [Stack Overflow](http://stackoverflow.com/a/29814524/1342462) with more info.
 I wouldn't go as far as this:

> Because creating URLRequest by hand defeats the purpose of having URLRequestConvertible

But I definitely see your point of view. This type of approach is currently on our internal roadmap to investigate adding this feature in a future release. If it makes it in, you'll see it appear on one of the roadmaps on the tracked milestones.
  From the header documentation for `URLStringConvertible`:

>  A URL that conforms to RFC 2396.
>  Methods accepting a `URLStringConvertible` type parameter parse it according to RFCs 1738 and 1808.
>  See http://tools.ietf.org/html/rfc2396
>  See http://tools.ietf.org/html/rfc1738
>  See http://tools.ietf.org/html/rfc1808

The API consumer is expected to percent-escape accordingly. Otherwise, valid pre-escaped URLs  would not work as expected.
  Thanks for bringing this behavior to our attention, but I don't really see how this is related to #185. Why would an `NSURLProtocol` need to be aware of a session's additional HTTP headers?
 Hi @jonah-williams, while I see where you are coming from, I don't think this very specific case is something the Alamofire should attempt to handle for all users. The client logic could append the additional headers to each `NSURLRequest` directly, rather than attaching them to the `NSURLSessionConfiguration`.

Additionally, we are going to add header support to the `request`, `download` and `upload` convenience methods in the upcoming 1.3.0 release. This should also make handling this edge case much easier until Apple corrects the underlying issue.

Thoughts?
 Thank you very much for your detailed assessment @jonah-williams. After digging into this, I completely agree with your overall frame of mind. The `NSURLProtocol` does not respect all aspects of the session configuration which can lead to all sorts of problems as you have already pointed out.

I created a `URLProtocolTestCase` to replicate this behavior in b92f4e05. This at least let's us track this behavior on all our tested platforms. I'm sure we'll end up adding more tests in the future here. If you can think of any other useful test cases here or would be willing to write some others, I would be much obliged.

With all that said, I think it is probably wise to no longer recommend using an `NSURLProtocol` with Alamofire for anything other than for mocking out test responses. I think it could be very useful here and this is something that we're interested in documenting in a future release. 
  Thank you for bringing this issue to our attention. We'll get it fixed up right away!
 Fixed in 768b71e8. Thanks again for reporting this @twmsh! üçª
 Not sure what you're referring to @btelintelo. There is no issue that is back. That check is needed and there is no iOS check needed since we're dropping support for iOS 7 in Alamofire 2.0.
  I broke the project up into multiple Swift files separated into `Core` and `Features` groups. I was very careful to split each major change into a separate commit so we didn't lose any of the critical ACL changes that were required.

I also took a stab at reworking some of the MARK statements to attempt to make it as easy as possible to quickly find the section you are looking for. I think it turned out pretty well, but I really would love some additional feedback if something doesn't seem quite right.

I also found some other minor things that I'd like to switch up, but I filed separate cards in Trello for each of them. That way this PR focuses only on the task at hand üëçüèª

> All the tests are passing on iOS. We have a separate Trello card for fixing up the OS X tests.
 This looks great, @cnoon. Thanks so much for taking the time to refactor things into something a bit more understandable for anyone less familiar with the library.
  Hi @subicura, thank you for your pull request. I am seeing the same deadlock/timeout behavior as originally reported by @jhersh on Xcode 6.3.1. Therefore, I won't be merging this PR in. We plan to bring this issue to the Apple engineers at WWDC in June.

In the meantime, I have added response status code checks in 7d644e07. Thanks again.
  I'm going to merge this in @subicura, but passing in `nil` at the moment is causing deadlocks. Please see #350 and #424 for more info. There is also additional documentation in the tests.
  Could not reproduce running Xcode 6.3.1 and CocoaPods 0.37.0.

![alamofirepods](https://cloud.githubusercontent.com/assets/169110/7456333/83e2ce82-f238-11e4-9d35-1175dbcefcba.png)

---

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 Getting a "Page Not Found". If you can get the link fixed, I'd be glad to help.
  Please check out #395. I've already posted a bunch of info there and on the linked Stack Overflow question.

---

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

> ## Asking Questions
> 
> We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Can you post a code sample that reproduces this behavior?
 `"http://www.domain.de/service.php?id=123&email=abcd@t√ºr.de"` is not a valid URL, as it needs to percent-encode the non-ASCII characters. This could be documented better.

Why not pass `["id": "123", "email": "abcd@t√ºr.de"]` as `parameters`? Alamofire will automatically escape that for you.
 eb4a945 documents the requirement for a `URLString` to conform to [RFC 2396](http://tools.ietf.org/html/rfc2396).
  We don't use Github as a support forum. Please open a question on [StackOverflow](http://stackoverflow.com) and tag `Alamofire`.
  A search through Alamofire's code does not show any mention of `OutputStreamType`.

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

> ## Asking Questions
> 
> We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  Cannot reproduce:

```
~ ‚ÆÄ pod search alamofire


-> Alamofire (1.2.0)
   Elegant HTTP Networking in Swift
   pod 'Alamofire', '~> 1.2.0'
   - Homepage: https://github.com/Alamofire/Alamofire
   - Source:   https://github.com/Alamofire/Alamofire.git
   - Versions: 1.2.0, 1.1.5, 1.1.4, 1.1.3 [master repo]


-> RACAlamofire (0.0.6)
   ReactiveCocoa extensions for Alamofire
   pod 'RACAlamofire', '~> 0.0.6'
   - Homepage: https://github.com/ararog/Alamofire-RACExtensions
   - Source:   https://github.com/ararog/Alamofire-RACExtensions.git
   - Versions: 0.0.6 [master repo]


-> TKAlamofire (1.1.4)
   Elegant HTTP Networking in Swift
   pod 'TKAlamofire', '~> 1.1.4'
   - Homepage: https://github.com/nicolastinkl/TKAlamofire
   - Source:   https://github.com/nicolastinkl/TKAlamofire.git
   - Versions: 1.1.4, 1.0.2 [master repo]
```

Try updating your version of the CocoaPods gem. Or perhaps you are confused by TKAlamofire? 
 This is not an issue with Alamofire. You should try asking the CocoaPods maintainers.
  Hi @aemreunal, apologies for not getting back to you sooner. At the moment, there is no direct support in Alamofire for trusting self-signed certificates or for SSL pinning. Support for this feature is already being discussed and is slated for the 1.3.0 release. We are taking security very seriously and it is at the top of our priority list. Please see #366 for more information.

---

With that said, you do have the option to implement your own pinning for the time being if you so choose. You would need to create your own `sessionDidReceiveChallenge:` closure to override the default `SessionDelegate` behavior.

``` swift
/// NSURLSessionDelegate override closure for `URLSession:didReceiveChallenge:completionHandler:` method.
public var sessionDidReceiveChallenge: ((NSURLSession, NSURLAuthenticationChallenge) -> (NSURLSessionAuthChallengeDisposition, NSURLCredential!))?
```

You could certainly dig through the [AFNetworking](https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/AFURLSessionManager.m#L815-L844) logic to see how this can be implemented as well as this [link](https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning#iOS). Both should help get you started in the right direction.

I'm going to close this issue out for now. Please feel free to reopen if necessary. If you do need help implementing your own SSL pinning, then please direct your questions towards [Stack Overflow](http://stackoverflow.com) as per our guidelines.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 There is not yet. We're still trying to lay out the roadmap. Once we have more info we'll be sure to start filling out the `Due Date` on issues and milestones. Cheers üçª
 No it should not be. Good catch!
  Looks good to me. Thanks, @cnoon!
  No, that's irrelevant. Just because Xcode 6.3 / OS X 10.10 is required to _build_ an app using Alamofire doesn't mean that those are the requirements to _run_ that app.
  When is Alamofire used with Carthage `--use-submodules` flag, folder `Carthage/Build` is automatically tracked as uncommitted change. But this is unnecessary in this case, so I think that is better to ignore it.
 For completeness, below are discussions about this topic:
- [Carthage/issues/420#issuecomment-95772555](https://github.com/Carthage/Carthage/issues/420#issuecomment-95772555)
- [jspahrsummers/xcconfigs/pull/37](https://github.com/jspahrsummers/xcconfigs/pull/37)
 Thanks @tomassliz!
 You're welcome, I'm glad to help.
  The `response` method always returns `NSData`. Use the `responseJSON` method instead.

This is not a support forum. In the future, please ask usage questions on Stack Overflow using the "Alamofire" tag.
  When I use Alamofire as [embedded framework](https://github.com/Alamofire/Alamofire#embedded-framework) and try to build with custom named scheme and configuration (e.g. `Test-Debug`) I get this error:

> No such module 'Alamofire'

So do the schemes and configuration names and its included embedded framework scheme names need to be the same?

Maybe this issue depends on settings `Per-configuration Build Products Path`, but I don't know if is ok to edit them.
 I asked this question on StackOverflow, but there was no answer after 14 days. I know that this is not directly Alamofire issue, but when @mattt describes how to use Alamofire as embedded framework, he might know the solution. I don't know anyone who could advise me.
 I deleted the question on StackOverflow, it deserved reformulation and example project. So I created this [new topic](http://stackoverflow.com/questions/29851269/dynamic-frameworks-and-project-configurations) on StackOverflow.
Sorry for creating this issue.
  :+1: 

Thanks, @siemensikkema.
  I just realized I haven't actually commented on this issue. Sorry for that gents.

@tobiasoleary, to your original question, yes, it would be nice to have a more verbose error system. We should have some better error handling logic around validation and anywhere else we can possibly throw an error. Since this will be a fairly large breaking change, we've slated this for the 2.0.0 release. We would also like to incorporate the new error handling logic from Swift 2.0 to make this process as simple as possible to use.
 Hey everyone!

I just pushed up PR #627 which adds much better support for validation error handling. If you could check it out and leave some feedback I'd really appreciate it! Please redirect all further comments to that issue since I'm going to close this one out.

Cheers.
  This is not an issue with Alamofire, but with your particular setup of Xcode. If you are still experiencing this problem, please try asking for help on Stack Overflow.
  Alamofire [has a passing test](https://github.com/Alamofire/Alamofire/blob/master/Tests/ResponseTests.swift#L53-L63) with essentially the same input. I suspect that the error returned is not actually related to the actual underlying problem.

For any further questions, please try asking for help on Stack Overflow with the "Alamofire" tag.
  @harshcs We've responded now twice to the same support request, asking that you please not do this again. Please respect @cnoon's and my authority on this project. Any code signing issues you're having cannot be related to Alamofire itself, as Alamofire is just a Swift file. It's all to do with how you're incorporating it into your project.
  Cannot reproduce. Try cleaning your project or re-installing from CocoaPods.

If you continue to experience problems and think that this might be an issue with CocoaPods, please open an issue with them. Otherwise, please ask a question on Stack Overflow with the "Alamofire" tag.
 @atulsha That is not a valid solution to this problem. Using an older, unsupported version of Alamofire is not a good idea. Alamofire 3.3 requires Xcode 7.3. @deck2osuab Try a cleaning your build environment after updating Alamofire and Xcode to the latest versions.
  I cannot reproduce.

Can you post the entire error / crash log?
 Maybe you're missing an `import Alamofire` statement?

If you have any further issues, please try asking on Stack Overflow with the "Alamofire" tag.
  Thanks, @cnoon.
  Your server is not sending an appropriate character set, so you need to specify UTF-8 explicitly. This can be done by passing `NSUTF8StringEncoding` as the `encoding` parameter of `responseString`.
  Thanks, @cnoon.
  Fixed by 6d1238d9ac9032980c27843fc27015d8db121cdd.
  Thanks, @cnoon.
  Don't wrap anything in a top-level struct. There is no need to change anything in the original source code. You'll just have to refer to things in the global module scope (e.g. `Request` instead of `Alamofire.Request`)
  Cannot reproduce. Everything works just fine for me with version 1.2.0.

![screen shot 2015-04-09 at 11 05 50](https://cloud.githubusercontent.com/assets/7659/7073452/70d1e5ec-dea8-11e4-8181-78dd5537475b.png)
  Thanks for this, @jhersh. I really appreciate it!
  Thanks for your PR, @swizzlr. I ended up merging in a few other things for 1.2.0, which is now available.
  I just tried to `pod trunk push`, but the pod won't validate since I've already upgraded to Xcode 6.3. @cnoon Do you still have 6.2 kicking around?
 @cnoon What's your CocoaPods collaborator email address? I'll add you on.
 Alright, added. Feel free to push 1.1.5 whenever you have a chance.
 Excellent! Thanks for saving the day, @cnoon!
 @Onetaway See https://github.com/CocoaPods/CocoaPods/issues/3389#issuecomment-92353876
  Version 1.2.0 is now available.
  Thanks so much, @natecook1000. Nice catch!
  Fixed by #420. Thanks for spotting that, @natecook1000.
  Thank you for your PR, @kiancheong. This should now be fixed in master, for the 1.2.0 release.
  Hi @skywinder, thank you for your pull request. Your generator seems very powerful, but we're still discussing how we'd like to format our CHANGELOG. We'll keep you posted üëçüèª
 We have completed our initial CHANGELOG in 34224b01. Thank you again for your pull request, but we've decided to roll our own manual solution for now to provide the highest quality info we can. Thanks again üçª
  Thanks for this, @getaaron.
  :+1: 
  Thanks again, @getaaron.
  Thanks, @getaaron, but the library is named "Alamofire", no internal capitalization. Any ideas on how this could be clearer? Seems a lot of folks make that mistake... (heck, if I had a nickel for every SWIFT or XCode question on Stack Overflow)
  The HTTP specification does not support a message body for `DELETE` requests. As such, the default behavior is to append parameters into the URL query. 

If your API insists on this convention, you can construct the request yourself.
 Ah, so they finally clarified that for RFC 7231. TIL.
  Thanks, @cnoon.
  Thanks for your careful consideration on this. I think you're entirely correct‚Äîthe best option is just to remove those "convenience" methods, which actually don't provide much utility on their own now (perhaps they were necessary in earlier versions of Swift; it's all such a blur now...)
  Hi @alivingston, my apologies for not getting back to you sooner. 

Thank you for your excellent assessment of the issue. After some investigation, I found that the progress closure would only be run on a `DataTask` if the `expectedContentLength` was able to be extracted from the `response`. Additionally, the `NSProgress` object (stored inside the `TaskDelegate`) was never being set for a `DataTask`.

This didn't feel like the correct behavior. If you tell Alamofire that you want to track the progress of the request, then track it you shall. The changes made in a285dd54 should be what you are looking for. They include:
- The progress closure on a data task will now always be executed when receiving data
- The `NSProgress` object will also be updated as well and now behaves exactly as the download and upload tracking

> The one caveat here is that it is possible for the `totalBytesExpectedToReceive` can be equal to `NSURLSessionTransferSizeUnknown`. This is the same behavior as the Download and Upload tasks, but I figured I should call it out.

If you could give these changes a spin I'd greatly appreciate it. Thanks again! üëçüèª
  Thanks, @pitiphong-p.
  Thanks for your PR, @inamiy, but I agree with @cnoon.

I was initially of the same opinion, and originally set their access level to `private`. However, as much as I'd prefer a non-leaky abstraction, where as much of the underlying `NSURLSession` APIs are irrelevant (as CFNetwork is to Foundation), there are just too many potential use cases (known and unknown) where _not_ exposing this would cause undue frustration.
  Makes sense to me. I'll tag a new patch release shortly.
  Thanks for looking into this, @cnoon. I'm just about to cut Alamofire 1.1.5. When that's released, can you please verify that things are working as expected?
  @Glagnar What you described is the URL Loading System working as intended. Credentials are only passed on an authentication challenge.
  Thanks, @cnoon.
  This is a CocoaPods or Carthage issue, and has nothing really to do with Alamofire. If you're annoyed by CI output, short of a real fix, you can always use `sed` or the like to filter out undesired warnings. 
  Thanks, @cnoon.
  Thanks, @mthole.
 SSL verification and customization has been part of Alamofire since the 2.0 release. If you have any concerns with that functionality, please use the Alamofire security email, security@alamofire.org, to contact us with your specific concerns.
  Fixed by 829fb1a.
  This is not a support forum. Please take usage questions to Stack Overflow.
  This is desired behavior. A valid URL does not contain whitespace, so attempting to construct an invalid one should fail immediately. Attempting to automatically remove whitespace may have unanticipated consequences.
 `NSURL` already has a failable initializer, which triggers an runtime error when force unwrapped. There are many different ways an invalid URL could fail to be initialized; I don't see a particular reason to call out any specific one‚Äîespecially if that behavior is not well-documented.
  Hi @nolanw,

Thank you for your Pull Request...it is much appreciated. I didn't end up merging your PR directly because the `APPLICATION_EXTENSION_API_ONLY` setting is already set properly.  

> The `APPLICATION_EXTENSION_API_ONLY` is set to `YES` in both framework targets. It is set to `NO` in the test and example targets.

I have updated all the deployment targets in ccc40a1a.

> Somehow these were reset when we merged the Swift 1.2 branch into master. Either way, ccc40a1a put us back on track.
  That's the `Content-Type` of the server response (note the 500 status code).

Please take usage questions like this over to Stack Overflow.
  This is not an issue with Alamofire. If anything, it's a CocoaPods issue. Perhaps open an issue with them?
  I cannot reproduce. Tests build and pass as expected on iOS and OS X with deployment targets of iOS 7 and OS X 10.9 with HEAD of master.
  I'm not entirely sure why this would be significantly more desirable than compiling from source for your target platform. Alamofire is a single, <1k SLOC source file. Building shouldn't take more than a second. 

Given the additional operational overhead of managing releases on GitHub in addition to normal tags, it's unlikely that this will be adopted.
  Thanks, @tosbaha. Fixed by 0cd66c2.
  Thanks, @skywinder.
  Beautiful. Awesome work, @kylef and the rest of the @CocoaPods team!
  Approved offline by TC.
  The addition of manager convenience methods for upload were made on master, and had not yet been downstreamed to this branch. 950eda9688c0e5538dcc4c97c2cdd45946a33f66 rebases against master to add the missing methods.
  [According to the RFC 2616 specification, the order of HTTP headers does not matter](http://stackoverflow.com/a/750338/157142). If your server is not accepting a request for this reason, there's very little that can be done, as ordering is not a capability guaranteed by software written to this specification.
  Thanks, @skywinder. However, an equivalent change was merged with #380.
  Fixed by #400 & #401
  Multiple parameter encodings isn't really a common convention for web applications, so it's not something I'd be interested to build any more specific support for. That said, `ParameterEncoding`, with it's `Custom` case and associated closure value can be used to compose a request without reimplementing either JSON body or URL query string encoding. The solution you described should work just fine.
 @mxl Why not? It's encoded in the URL for HTTP methods that do not support am message body, or in the body as `application/x-www-form-**urlencoded**` (emphasis added) for HTTP methods that designate a message body. That's just HTTP.
 @mxl Way too complicated for my tastes. The way it works now is flexible enough to handle any use case (including the one described by this issue), without exposing unnecessary API surface area.
 @mxl It's not a common case. And there is not going to be a one-size-fits-all solution; it's always going to be as hacky as the web service you're developing against. 

> By the way who puts url-encoded parameters in request body?

Every modern web framework supports this. It's convention.
 @mxl URL form encoding of parameters is a required feature for web services that do not support JSON encoding. Not everything an app might connect to is shiny and new.
 @mxl That's the thing‚ÄîAlamofire does support modern web services out of the box. That's what it was designed to do, and what it does. I'm not particularly interested in discussing this feature any further at this time.
 @Dschee An interesting point. However, this may be achievable right now by writing a custom `ParameterEncoding` that can take the additional `include`, `sort`, or `filter` parameters in a static function. e.g. `JSONAPI.include(_:sort:filter:)` that can then be passed in Alamofire's `request` functions or used to encode `URLRequest`s directly. However, concrete proposals or even PRs would help us further consider this request.

Personally, I don't like `JSON API` from an API design perspective, but I can see the usefulness of the functionality you described.   Core Data and NSCoding are orthogonal, and integration with either is left as an exercise to the user.
  I cherry-picked the specific change for escaped characters with 9075691ca5e2e53c7fcb6b286a19abee874e97d3. Thanks again, @slizeray!
  `stringByAddingPercentEncodingWithAllowedCharacters:` suffers from excessive memory consumption. See #206.
 @slizeray This is incorrect. According to [RFC 3986 ¬ß 2.2](http://tools.ietf.org/html/rfc3986#section-2.2), `/` is a general delimiter, and needs to be escaped.
 > Beware that some older, erroneous implementations may not handle such data correctly when it is used as the base URI for relative references...
> 
> ...it is sometimes better for usability to avoid percent-encoding [slash and question mark]

@slizeray That doesn't exactly inspire confidence. If it comes down to a question of usability concerns versus incorrect server-side handling, I'll err on the side of safety.
 @slizeray I wasn't aware of this specific difference in behavior previously, but knowing this now, I'm more comfortable keeping consistent default encoding behavior between Alamofire and AFNetworking. I understand how this might be inconvenient, which is why Alamofire offers two different ways to easily override this. First, you could use the `Custom` parameter encoding, supplying your own function to do the parameter escaping. Alternatively, you could bypass all of the URL encoding completely by passing a value of type conforming to `URLRequestConvertible` (`NSURLRequest` or a custom type) directly into `request`, `upload` and `download`.
  We removed the playground in the latest versions of Alamofire. Caused more problems than it was worth.
  This is not a support forum. Please ask usage questions on [Stack Overflow](http://stackoverflow.com/tagged/alamofire).
  Alright everyone, we've added this to the 1.3.0 milestone. Please stay posted üëçüèª
 @thegorgon The 1.3.0 release is currently slated for June 22nd which is only being used as a rough goal. The release will not ship until it's absolutely ready to go. There are some VERY important features rolling into the 1.3.0 release that we want to make sure we get exactly right.

Additionally, it is a pretty aggressive timeline and first requires us to get the 1.2.3 release out the door which we're currently right in the middle of. You can check out the [milestones](https://github.com/Alamofire/Alamofire/milestones) for more info.
 Okay all you plus ones...

PR #581 is up for all your pinning pleasure. If everyone could please help out with reviewing and testing, I would REALLY appreciate it. I'm going to close this issue out. Please redirect all further comments to #581.
  Thanks, @jspahrsummers.
  Thanks for your interest in contributing, @AnthonyMDev. This repository will remain focused on the fundamental networking use cases, but there is certainly room in the greater ecosystem to support specific web services. Please let me know when you complete this work.
  As @ssherar, this is resolved by #357. Thanks, @indragiek.
  Thanks for your PR, @kylef. I really appreciate you following up on #358 to find the underlying problem here.

We should definitely respect the server's character encoding, when provided. We should definitely follow the spec to use ISO-8859-1 by default. However, we should also provide a way to override this behavior for when the server is doing something wrong, and it's not possible to fix.

I implemented this with 6cffddcf150539daea674fa9367b63a1d46b0519, which should resolve the original issues. Let me know if I missed anything here.

Thanks again, @kylef.
  Fixed by 6cffddc. See #359.
 @staticdreams If you're expecting a JSON response (3840 is the error returned by `NSJSONSerialization`), you have to use UTF-8, as that's the only encoding supported by JSON. I'm not sure why you're suddenly seeing the error, but I would confirm that the string content of the response can be successfully decoded into a UTF-8 string.
 @staticdreams If you can take the data and, using `NSString(bytes:length:encoding:)`, try to create a string and make sure it looks correct. You can also try `canBeConvertedToEncoding()` on an existing string.
  Thanks so much, @rastersize. This is merged with 2f39b86.
  Hi @briv, thank you for all your work you've put in here! We have SSL/TLS Key/Certificate pinning slated for our 1.3.0 release. We're starting to discuss this now and will keep you posted. Thanks again for all your hard work here! üëçüèª
 At this point, I think it would be best to hold off. The technical committee (TC) has already decided that we need to build have one of us build out this feature. It is one of the most critical pieces of the library to get right and be able to provide top notch support for at all times moving forwards.

With that said, we greatly value your efforts here and this will certainly give us a head start when we get started!
 Hi @briv, I just pushed up a PR that implements TLS public key and certificate pinning. Thank you for all the hard work you put into this PR. It really helped get me going in the right direction. If you could please take a look at #581 I'd really appreciate it. I want to get everyone involved to make this feature rock solid.

I'm going to close out this PR. Please direct all further comments to #581.
  For usage questions, please try [Stack Overflow](http://stackoverflow.com/questions/tagged/alamofire). If you believe that this is a bug, please open a new issue with an example project that reproduces the behavior in question.
  Fixed by #400 & #401
  Thanks so much, @jhersh.
  Thanks, @tkrajacic.
  This is not a support forum. For installation and usage questions, please try Stack Overflow.
  Universal frameworks were an interesting idea, but due to incompatibility with other build tools, they were reverted with 36499d8f3d5e5ecf9c612a301c819c10baa402c2.
 @indragiek Yessir. 36499d8f3d5e5ecf9c612a301c819c10baa402c2 is on xcode-6.3 as well now.
  I cannot reproduce. There are [several passing tests](https://github.com/Alamofire/Alamofire/blob/master/Tests/ParameterEncodingTests.swift#L27-L218) that demonstrate parameter encoding working as expected. If you can, however, create a failing test case, please submit a PR.
  @rjjohnpatrickcruz This is not a support forum. Questions like this should be asked on Stack Overflow.
  Because this is a usage question rather than a bug in Alamofire itself, the best forum for this would be Stack Overflow. If anyone else is interested in this question, feel free to follow up on [this Stack Overflow question](http://stackoverflow.com/questions/28490129/alamofire-nested-json-serializer).
  For anyone targeting Swift 1.2, you can now use the [xcode-6.3 branch](https://github.com/Alamofire/Alamofire/tree/xcode-6.3). This will be merged in once Xcode 6.3 reaches GM.
  Thanks for the PR, @boek.

I ended up going through and porting the code to 1.2 making a few more idiomatic changes with d337018.

For anyone targeting Swift 1.2, you can now use the [xcode-6.3 branch](https://github.com/Alamofire/Alamofire/tree/xcode-6.3). This will be merged in once Xcode 6.3 reaches GM.
  Universal frameworks were reverted with 36499d8f3d5e5ecf9c612a301c819c10baa402c2.
  Unfortunately, there is very little that can be done without a reproducible test case, calling context, or stack trace. If you can provide any of these, please open a new issue describing your problem.
  Framework support is orthogonal to the base SDK API requirements, so I'm not sure what this really accomplishes. That iOS 7 targets cannot use dynamic frameworks should not have any impact on the declared SDK dependencies.
  Thanks, @obohrer. I'd been meaning to do an audit of the top-level and manager APIs. I appreciate you taking the time to make this patch.
  Thanks for your PR, @Reflejo, but there are no current plans to include UIKit extensions in the base project. AFNetworking's UIKit extensions work fine with Swift.
  Hi @florianwalter, our apologies for not getting back to you sooner. With that said, I've created a sample project called [AlamofireToday](https://github.com/cnoon/Alamofire-Example-Apps/tree/master/AlamofireToday) with your exact logic and it works as intended. I would encourage you to check it out. 

Hopefully you can spot the difference between what I've created and what you are doing. I'm going to close this issue out since I cannot reproduce it. If you are able to modify my project and produce your reported behavior, then please submit a PR against my example app and reopen this issue.

Cheers üçª
 Thanks @kcharwood, good catch. Will remove.
  Fixed by #394. Passing test added with 66587f700c5f6d453b0883f12a85de28e25d6272.
  I cannot reproduce following the instructions provided in the README. If your application target supports dynamic frameworks (iOS >= 8), I would strongly suggest using CocoaPods or Carthage.
  @JRG-Developer is correct‚Äîthis is intended behavior. Use custom parameter encoding if you need anything other than the provided options.
  Thanks, @tkrajacic.
  Thanks, @tkrajacic.
  I like this pattern a lot, and wasn't even fully aware that it was possible. Thanks so much for this, @kylef.
 Based on what @norio-nomura reports and the feedback from the Carthage folks, it looks like a universal framework is not the right solution for now. Thanks for your help though, @kylef. Reverted with 36499d8f3d5e5ecf9c612a301c819c10baa402c2.
  This sounds like something you should ask the @CocoaPods folks. Sorry, but I can't help you with this.
  Thanks so much for this, @yasuoza. I really appreciate it.
  I appreciate your contribution, but this PR is unnecessary.
  Thanks, @kylef.

@Reza-Rg This is not a support forum. In the future, please take usage questions to Stack Overflow.
  :+1:

Thanks, @astrabot.
  Thanks so much for your hard work on this, @cnoon. I merged everything into master, and am excited to have this all for the 1.2.0 release. :bread:
  Thanks, @cnoon.
  :+1: 

Thanks, @rborkow.
  Sorry, but this is not a support forum. If you have a specific question about troubleshooting, please try asking on Stack Overflow.
  @51cc You're using an out-of-date version of Xcode. Please follow the instructions in the README, ensuring that you have the necessary requirements.
  This should be fixed with the 1.1.4 pod.
  See #215.
  Fixed by #400.
  Thanks, @kylef.
  Thanks for your work on this, @mk. I cherry-picked 855e9c1 and setup my own OS X target, which is now on master.
  This is not a support forum. For usage questions, please try Stack Overflow.
  No. See #298.
  Thanks for raising this point, but I disagree that this would be preferred in a majority of cases. My primary objection is that the HTTP header is `Accept-Language`, so it's looking for languages, not locales. I think it would be, in many cases, indeed preferable to have an API send back responses according to the preferred language, even if not supported by the app bundle.

Of course, this is entirely contingent on the app and API themselves. The provided `Accept-Language` is just a default value, and can be overridden in one line of code.
  Thanks, @kylef.
  This is not an issue with Alamofire. For any questions about using CocoaPods, you should ask the good folks working on that project.
  We're looking to add better support for this in the 1.3.0 release. Please stay posted üëçüèª
 Hey everyone, thank you so much for your patience! I just pushed up PR #593 for Response Serializer Generics. If you could check it out and help with feedback I'd really appreciate it.

If you could please redirect all comments to #593 from here on out, that would be helpful. I'm going to go ahead and close this issue out.
  Closing out this PR since it won't ever be merged into Alamofire core. Please see #290 for more details.
  Awesome. Excellent work, @mk. I really appreciate you taking the time to do this.
  Caching indeed works, as part of the NSURLSession API. See [this Stack Overflow question](http://stackoverflow.com/questions/27785693/alamofire-nsurlcache-is-not-working).
 We're in the process of adding tests around this usage for the `1.2.3` release. Stay tuned...
  Sure. Thanks, @mrahmiao.
  Hey everyone, 

Now that news about the [Alamofire Software Foundation](https://github.com/Alamofire/Foundation) is out, we can get back to business here. I have the majority of this library completed, and am working with the rest of the TC to get everything in tip-top shape before releasing the initial version. I'm going to close out the PR for now since it will never be merged into Alamofire core. Still no solid release date, but feel free to comment on this issue with questions until the initial release is out.
 Hey @AnthonyMDev, this is definitely still in the queue. We've decided to first focus on the Alamofire 1.3.0 release and will then cycle back to AlamofireImage.
  > HTTP POST works fine through Java and PHP so I know there isn't anything wrong with the server.

That's not a safe assumption. I wouldn't trust every client library to correctly handle SSL.

Given that this behavior is reproduced with another library, this is not an issue specific to Alamofire. Rather, this is either a bug in the underlying Foundation URL Loading System, or‚Äîmore likely‚Äîincorrect  code on the client or server.

For specific usage questions, please try Stack Overflow. This is not a support forum.
  Maybe try `import Alamofire`?

I cannot reproduce this. Alamofire now supports distribution using CocoaPods and Carthage, so you might want to try using one of those instead.
 @MaxHasADHD I cannot reproduce this issue, and many others have successfully used Alamofire in shipping applications. Your decision not to use tools that automate installation is totally on you.
  Equivalent changes have since been applied. Thanks for the PR, @rynecheow.
  Alamofire is specifically not designed to be compatible with Objective-C. It is up to the API consumer to provide the appropriate bridging accommodations to integrate it within an application.

For apps using Objective-C, try AFNetworking instead.
  A functional approach to networking was considered at the very start of the design process, but was found to be fundamentally incompatible with the architecture of `NSURLSession`. Alamofire represents the best effort to maximize productivity and convenience when using existing Foundation URL Loading System APIs in Swift applications; unfortunately, that doesn't allow for the kinds of functional paradigms that I might have liked to explore had it made sense to roll a TCP stack from scratch.
  Fixed by #258. Appreciated all the same, @marcelofabri.
  POST requests don't send parameters in the URL. There are several passing tests that validate correct behavior for request sending.

This is not a support forum. Please take any specific usage questions to Stack Overflow in the future.
  What makes you think that Alamofire doesn't already do this? It's all just a wrapper on top of `NSURLSession`. Pass in the right configuration, and everything should work as expected, no?
 I'm sorry, but I don't really understand if this is an issue or not; whether this is a bug in Alamofire or a misunderstanding of how to use the `NSURLSession` APIs.

If this is an issue with Alamofire, please submit a PR with a failing test that demonstrates the issue. With that, I would be more than happy to work towards a solution.
  Please do not report questions from Stack Overflow. This is not a support forum.
  See #218.
  Thanks, @kylef!
  Looks good. Thanks so much for this, @astrabot.
  This is not a support forum. As stated in the README, general questions should be taken to Stack Overflow.
  Duplicate of #218.
  I'm sorry, but I don't understand what this accomplishes...

`NSURLSession` download tasks download to a temporary directory, and it's up to the API consumer to move the file to a permanent location upon completion. Files in temporary directories are not guaranteed to stick around beyond that first opportunity, so it doesn't make sense _not_ to enforce this (even if it is just moving to the same location, if that behavior is desired for whatever reason).
 The purpose of this method is to, in fact, download a file over a network connection. If you don't need or want the downloaded file, you should either remove the file afterwards or not make the request in the first place. I see no compelling reason to compromise the existing semantics to accommodate such a use case.
  Thanks, @technomage. Fixes #268.
  This is a question about using Git, not having to do with Alamofire specifically. If you continue to experience this problem, try asking on Stack Overflow or another appropriate forum.
  Duplicate of #266.
  This is not a support forum. As per the README, please take general questions like this to Stack Overflow, or another appropriate forum.
  Thanks for bringing this to my attention, @cnoon. It appears that the correct course of actions was to simply remove `deinit`, which is done with e356b9f, which is a squashed merge of your original PR. @corinnekrych's suggestion of trying `finishTasksAndInvalidate`  yielded the same results.

For lack of a more involved change, I've documented the requirement for session task invalidation before reinitialization with d41b8da.
  Sorry, but I'm not really sure what you're asking... Have you read through the [App Extension Programming Guide](https://developer.apple.com/library/ios/documentation/General/Conceptual/ExtensibilityPG/index.html)?
 Fixed by #273.
  As stated in the README, iOS 7 does not support embedded frameworks.
  `kCFURLErrorCannotParseResponse   = -1017`. For whatever reason, your server is not responding with a valid HTTP response.

However, this is not a support forum. For help on specific usage, please try Stack Overflow.
  >  How can I use them like strings (true or false).

There is no standardized representation of boolean values in URL-encoding, either on the client or server. Convert them to strings ahead of time.
  Thanks, @nathanborror.
  @mattt wrote up a good answer [here](https://github.com/Alamofire/Alamofire/issues/157). If the manager is not retained, the running task is cancelled while the underlying `NSURLSession` is being shut down. That is most likely your issue. If that does not fix it, please open a new question on Stack Overflow.
  Thanks, for the PR, @cnoon! I'd been considering this for a while myself.
  Since HTTP status codes are a closed set of constant values, an `enum` would be a more appropriate choice. That said, providing this in the framework seems unnecessary.
  Thanks, @slash7.

I cannot provide technical assistance for specific installations of Alamofire. If you have further questions, please try Stack Overflow or another appropriate forum.
  Thanks, @philipheinser!
  Ah geez. Thanks for pointing this out, @cnoon. I'll have to write a previously-failing test to make sure this doesn't happen again.
 Much appreciated all the same. I'll push out a new release in the morning.
  Thanks, @tkrajacic. You are correct‚Äîthe underlying Foundation URL Loading System handles this automatically.
  Thanks, @mowens. A new version has been tagged with this change.
  >  It would be nice to have methods that explicitly expects JSON Array or JSON Object and fails when it doesn't get such response.

That's already the default behavior. `NSJSONSerialization` will return an error if the root object is not a collection if `NSJSONReadingAllowFragments` is not set as the reading options.

Beyond that, it's up to you to determine how to interpret the `AnyObject` returned from `NSJSONSerialization`.
  As stated before:

> As for --compressed, this also feels unexpected. The point of the curl command output is to debug the request going out, rather than emulate the response. Any additional processing or logic should be left up to the end user, who can append additional flags or pipe / output as appropriate.

There are other reasons why this might not be a good idea. From the `man` page:

> `--compressed`
> 
> (HTTP) Request a compressed response using one of the algorithms curl supports, and save the uncompressed document. **If this option is used and the server sends an unsupported encoding, curl will report an error.**

If anyone wants or needs this behavior, it would be trivial to concatenate the necessary `--compressed` flag at the end of the command.
  As stated in the README:

> Since there is no published specification for how to encode collection types, the convention of appending [] to the key for array values (`foo[]=1&foo[]=2`), and appending the key surrounded by square brackets for nested dictionary values (`foo[bar]=baz`).

For now, any other convention of nested parameter serialization should make use of `ParameterEncoding.Custom`.
  Thanks for your contribution, @puls.

Generally, project maintainers prefer to have PRs (as well as individual commits) focused on one particular feature. Just something to keep in mind in the future.

Regarding empty JSON response serialization, I don't think this is a necessary change, as `NSJSONSerialization` already returns `nil` if its `data` parameter is zero length:

``` swift
NSJSONSerialization.JSONObjectWithData(NSData(), options: nil, error: nil)
// nil
```

And even if it weren't, it feels out of place to add a conditional before handing off to the designated serialization API. That is, someone might ostensibly depend on `NSJSONSerialization`, in this case, to return a particular value or to populate its `error`.

As for `--compressed`, this also feels unexpected. The point of the `curl` command output is to debug the request going out, rather than emulate the response. Any additional processing or logic should be left up to the end user, who can append additional flags or pipe / output as appropriate.
 > Given a RESTful web service endpoint that can return JSON or return nothing with an appropriate status code, a successful request can return an error or not return an error and the developer would be left trying to glean information from an NSError object, something you've previously advised against.

I was only advising against errors as a means of communicating validation failure. This is, however, necessary for `NSJSONSerialization` or `NSPropertyListSerialization`, which normally produce error objects.

> Finally, given that there's no documentation in the API that responseJSON uses NSJSONSerialization...

[This is incorrect](https://github.com/Alamofire/Alamofire/blob/master/Source/Alamofire.swift#L1356):

> >  Creates a response serializer that returns a JSON object constructed from the response data using `NSJSONSerialization` with the specified reading options.
  Can you provide any context for this change? Preferably in the form of a failing unit test? It's unclear what this is PR is attempting to fix...
 Perfect. Thanks so much, @sunnycows!
  "file was built for arm64 which is not the architecture being linked (armv7)"

You're building for the wrong architecture.
 Whatever the issue is, you can probably replicate it on a normal local build to the device or simulator by changing "Build Active Architecture Only" to NO for DEBUG mode.
 I cannot provide technical assistance for specific installations of Alamofire. If you have further questions, please try Stack Overflow or another appropriate forum.
  Thanks, @nsarno.
  Sorry, but you're entirely mistaken about how HTTP or Alamofire works. This is documented and expected behavior.

Collaboration is a virtue to be celebrated, but sending pull requests based on opinions and guessing do more harm than good, as they are a burden on project maintainers.
  Duplicate of #243. Please do not re-open closed issues like this.
  See #243.
  Could not reproduce in either Xcode 6.1.1 or latest Xcode 6.2 beta with latest version of Alamofire.
  I can't reproduce this. Alamofire uses [HTTPBin](http://httpbin.org) as a backing web service for both the example app and test suite, and both GET and POST requests echo back their respective form parameters as expected.

If problems still persist, please open a pull request with a failing test against HTTPBin that demonstrates the issue.
  Thanks, @flovilmart. Committed with a bit of refactoring in ae2ea5a. A new release is forthcoming.
  GitHub Issues is for reporting bugs or discussing features in the framework. Please take any specific usage questions or Xcode debugging questions to Stack Overflow or another appropriate forum.
  Cannot reproduce. Make sure you are using the latest version of Alamofire and Xcode.
  You have it backwards: adding Alamofire as a single file is what would be hacky. I'm not at all happy about the hoops necessary to distribute this as a shared framework, but that's ultimately the correct way to do so. Fortunately, CocoaPods and Carthage are working to make this process seamless, and should be GA soon.
  As per the README, please ask general questions on Stack Overflow or another appropriate forum, so that GitHub Issues can focus on bugs and feature requests of the framework.
  The blocks associated with each chained response handler are, in fact, being executed in order. However, because the `jwtJson` object takes longer to create than `string`, the `responseString` block finishes first.

There are no guarantees about the ordering of chained responses, save for the fact that `validate` acts like a barrier, with subsequent response handlers producing errors if invalid.

The reason no ordering is guaranteed by the framework is to avoid unnecessarily blocking for response handlers to complete. If you really need two separate response object types, you can use `dispatch_group` to manually execute behavior on processed objects in the desired order, or simply create a new response handler that produces both JSON and a string representation as necessary.
 You assumptions are correct @mrubin. If you don't specify custom `queue`s to run the `response` closures on, it will fallback to the main queue which will result in serial behavior for that request.
 So reading back through this thread is pretty interesting. The original response from @mattt clearly indicates that it was running the response serialization closures in parallel. However, when looking back at the codebase in b5d6f581 around the time of that response, I don't think that was possible. The `TaskDelegate` queue has always been a serial queue.

That same behavior was still maintained in aa6ea80b when we switched it from using a `dispatch_queue_t` to an `NSOperationQueue`. Nothing really changed except being able to cancel the operations in a forced shutdown scenario which allows the `Manager` instance to deallocate gracefully.

Now to really answer this question, we need to understand what's going on. Here's the order of operations that govern this behavior:
1. Create request
2. Add responseJWT implementation onto the Request's internal serial queue
3. Add responseString implementation onto the Request's internal serial queue
4. Request finishes, start up the serial queue
5. Executes the responseJWT implementation on the serial queue
6. Calls the responseJWT completion closure on whatever queue was provided (main by default)
7. Executes the responseString implementation on the serial queue
8. Calls the responseString completion closure on the provided queue (main by default)

There's no simple way to break the chaining here. You could couple your response serializers to depend on each other allowing the following ones to `early out` if certain conditions were met, but that seems a bit strange. I think that you'd instead want to build a single response serializer that could handle the multiple scenarios as a single, cohesive operation.

The custom response serializer could also take in multiple closures to chain together inside the response serializer. Either way, if you need to chain these operations together with the concept of breaking the chain, then the default behavior here is not going to work in your favor.
  In that case, you can validate only the content type and switch on successful status codes as necessary. Or, again, you can create a custom response handler that populates objects as desired.
 So just as a heads up...this is now supported in the `swift-2.0` branch through the in the default `response` serializers and also in the generic response serializers using the `Result` type. If there is ever an error that occurs anywhere in the request process, you will now receive the error and the original server data if it is available.

I'd encourage you to check it out. All the [documentation](https://github.com/Alamofire/Alamofire/tree/swift-2.0#response-handling) has been updated accordingly.
 Hi @ziogaschr, thanks for your feedback. In the future, please comment directly on the issues you are referring to. That way we keep the conversations going in the correct location. 

With that said, your suggestion is actually how it works in Alamofire 2.0. The `.Failure` case contains the `NSData?` from the server where the `.Success` case only includes the parsed object. While this is certainly the common use case, other outside the box features such as custom logging or DVR playback may need access to the original data, even in the `.Success` case. Therefore, in Alamofire 3.0, the original server data is ALWAYS returned in all the custom response serializers, not just in `.Failure` cases. If you don't need to use it, then don't. 

Additionally, in #792, the `Response` object encapsulates the fact that the `NSData?` is even available. Therefore, you don't need to access it if you don't actually need it.

Cheers.
 Are you running two parsing schemes? I don't quite understand your use case. Could you post some pseudo code or actual code of what you're attempting to do? I have a few different ideas, but I want to make sure I actually answer your question.
 Thank you for providing sample code. That makes it SOOO much easier for me to tell what you're trying to do. In this case, I would recommend working a bit more with Alamofire rather than against it. Let me explain.

Instead of trying to return a parsed JSON object in a failure case, take it one step further and convert the JSON object into a custom error that your app handles. In your example, rather than returning the `ResponseHandler` type, return a custom `RateLimit` error. You can use associated values on the `RateLimit` case if you need to keep any of that data. Although, I don't really think at the app level you need to know anything other than what the URL request was as well as the error that occurred.

You're already doing this in the second error case where you're catching invalid data prior to parsing the JSON and capturing it in a custom error.

Lastly, your final SwiftyJSON parsing case "could" use generics to attempt parse the JSON into a concrete model object. Then your `Result` type could return something like a `User` object rather than a vague `ReponseHandler` type.

Does that all make sense?
 No worries man, glad to help! üçª
  CocoaPods support is coming soon (See #218). Until that time, only the documented installation steps are supported. I unfortunately cannot provide any assistance in using Alamofire in an unsupported way.
  > From what I understand I have to use a shared manager for manipulating header configuration like this...

No, that's only for headers that are consistent across all requests. If it's for a single request, you'd pass an instance of `NSURLRequest`.
  At the time of writing, Swift did not yet have failable initializers, which is definitely something that would be desirable when interacting with unknown and potentially untrusted data from an external web service. b5d6f58 makes this change to add such a consideration.
  See #220
  Thanks for this, @ishkawa. Apologies for the delay in getting this integrated.
  From their README:

> CocoaPods projects must also have what‚Äôs known as a podspec file, which includes metadata about the project and specifies how it should be built. **Because Carthage uses xcodebuild to build dependencies, instead of integrating them into a single workspace, it doesn‚Äôt have a similar specification file.**

As far as I can tell, there are no additional steps necessary for Alamofire to be compatible with Carthage. If there is a specific change that needs to be made to the project workspace in order to support it, I'd be happy to review that pull request.
  Indeed, this changed in the latest version of Swift. Fixed by fb5592e01b1af5d657fd17a39a39ad6895b2173e.
  This functionality is not currently provided. There are no current plans to add this as a feature.
  Why not invoke a currying function or other kind of partially-applied callback in the response handlers of contingent requests? Alternatively, you could invoke a function in the response handlers for each request to check the number of active session data tasks.

An implementation on the manager itself is probably not a great solution, since it relies on mutable shared state (additional requests may be made or cancelled at any time). 
  Thanks for your suggestion, @cosminstirbu. This seems like something that would be better served by a separate `NSURLProtocol` subclass, which could intercept all networking traffic, regardless of framework. This isn't the route AFNetworking took, but it's probably what I'd recommend going forward.
  Alamofire builds against the iOS 7 SDK, but distribution through dynamic frameworks requires iOS 8.
  This is most likely related to server behavior rather than anything to do with Alamofire. Please take this over to Stack Overflow, or another appropriate forum.

If, however, you can provide an example project that reliably reproduces this behavior, I would be more than happy to investigate.
  See #218.
  Thanks for the PR, @puls.

Validation is one of the core value propositions of AFNetworking, at least as I see it. Unfortunately, it also appears to be a central point of confusion (or at least this feature in combination with a lack of understanding about HTTP). There are so many questions on Stack Overflow that ask "why doesn't his work?" when the error is, at least I thought, pretty explicit ("Unacceptable content type `text/html` when `application/json` was expected"). Even worse, I've seen apps even use these `NSError` objects verbatim to alert the user. Even for a savvy user, knowing that the app got a 404 is not actionable or useful. 

All of this leads me to believe that there's diminishing value in attempting to communicate anything through an `NSError` object. 

Validation is an opt-in feature in Alamofire, so the onus is on developers to respond to failure accordingly. In production, a validation error should be handled as a failure; any further logic like "if status == 500 but the JSON is formatted like this error message..." should be already handled by the response serialization.

As such, my recommendation to the end user is to treat a validation error as an opaque signal to signal a failure.
 > I'm not sure how providing less information at the API level forces better UI or fewer questions on Stack Overflow. If the onus is on developers to respond to failure accordingly, shouldn't they be able to respond better if they know why validation failed?

Information is only valuable if people know how to use it. An overwhelming amount of anecdotal evidence tells me that an error like the one used by AFNetworking is not something that people know how to interpret.

> (The scenario I envision: all client networking errors are reported back to a service out of band as a diagnostic; a spike in unacceptable content types is much more actionable than a spike in generic validation errors.)

Why not then create a new function `validateWithDiagnostics` that runs `validate` and logs the `request` and `response`?
  @mrackwitz Thanks for all of your great work in bringing Swift support to CocoaPods. I couldn't be more excited to be able to take advantage of this.

After reading through CocoaPods/CocoaPods#2835, I got the sense that official support might be a little ways off. If that's the case, I'd prefer to keep this unmerged until everything is good-to-go, so as to avoid any confusion. Would not merging this now be blocking you in some way? 
 @kylef Sounds good. Thanks, @mrackwitz for the PR. I'm really happy to do what I can to help drive CocoaPods adoption for Swift. This is going to be a huge improvement to how folks get started with Alamofire; I can't thank y'all enough for all of your hard work to make this possible.
  This is a non-issue. An empty string works and is semantically appropriate.
  Please do not cross-post questions from Stack Overflow.
  AFNetworking already processes response data on a background queue (using the main queue would be inappropriate). Occasions which would necessitate a custom queue are going to be relatively rare, and usually entail some other nontrivial accommodations. In those situations, I'm comfortable relying on the existing mechanism for specifying a custom response serialization handler.
  Please do not cross post [questions from Stack Overflow](http://stackoverflow.com/questions/26834293/swift-could-not-build-objective-c-module-alamofire).
  Thanks for the PR, @brandonroth. Doing a quick search through the README showed a few other cases where an `NSURL` initializer needed to be updated (d7f07d1). One other stylistic difference is that I prefer to have the `!` on the initializer itself, rather than add it on each use.
  This PR does not cleanly merge into master. Please resubmit with only the necessary changes.
  This is a question regarding NSURLSession, not Alamofire. Please take this over to Stack Overflow or another more appropriate forum.
  :+1: 

Thanks, @segiddins.
  Thanks so much for the thoughtful writeup of this issue. It's really surprising that `stringByAddingPercentEncodingWithAllowedCharacters` would have such a glaring memory consumption issue. If you haven't already, I would strongly encourage you to file a radar about this.

Since this behavior is not produced in AFNetworking, it makes sense to just adopt the approach used there. dc1fd5c does exactly this, by porting over the same CFURLCreateStringByAddingPercentEscapes call used by AFNetworking.

Please let me know if this does not resolve your issue.
 @TheWalkingDead1024, if you are having an issue in AFNetworking, then please open a new issue in that project.
 cc @kcharwood 

Thank you for reporting this issue @TheWalkingDead1024. My apologies for first pointing you towards the AFNetworking project. This issue actually spans both projects.

The approach previously taken to use the `CFURLCreateStringByAddingPercentEscapes` Core Foundation call was perfectly fine until the call was deprecated in the iOS 9 SDK. Therefore, we needed to move off that call back to `stringByAddingPercentEncodingWithAllowedCharacters` to get away from the deprecation. Unfortunately, when that change was made, we forgot about this previously closed issue.

After much debugging, I was able to track this issue down to only occurring in Alamofire on iOS 8.1 and 8.2 using the iPhone 4S and iPhone 5 simulators. It is 100% reproducible, but is crashing in different ways depending on the size of the Chinese string that is passed in. It's always some form of a `malloc` error. The following sample code will reproduce the issue in the iOS Example app.

**AppDelegate.swift**

``` swift
import Alamofire
import UIKit

@UIApplicationMain
class AppDelegate: UIResponder, UIApplicationDelegate, UISplitViewControllerDelegate {

    var window: UIWindow?

    // MARK: - UIApplicationDelegate

    func application(
        application: UIApplication,
        didFinishLaunchingWithOptions launchOptions: [NSObject : AnyObject]?)
        -> Bool
    {
        dispatch_after(
            dispatch_time(DISPATCH_TIME_NOW, Int64(2.0 * Float(NSEC_PER_SEC))),
            dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0))
        {
            self.runLargeChineseCharacterEncodingTest()
        }

        return true
    }

    func runLargeChineseCharacterEncodingTest() {
        let repeatedCount = 20_000
        let URL = NSURL(string: "https://example.com/movies")!
        let parameters = ["chinese": String(count: repeatedCount, repeatedString: "‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅ")]

        let start = NSDate()
        print("starting parameter encoding")
        ParameterEncoding.URL.encode(NSURLRequest(URL: URL), parameters: parameters)
        print("finished parameter encoding: \(NSDate().timeIntervalSinceDate(start)) seconds")
    }
}

extension String {
    private init(count: Int, repeatedString: String) {
        var value = ""
        for _ in 0..<count { value += repeatedString }
        self = value
    }
}
```

I've also added a unit test in 4f6b2956 to verify that the encoding works as expected. The test will fail 100% of the time without the solution in place. Unfortunately it causes the test suite to crash rather than fail without the solution implemented, but that's the way it is due to the nature of the issue.

**Unit Test**

``` swift
func testURLParameterEncodeStringWithThousandsOfChineseCharacters() {
    // Given
    let repeatedCount = 2_000
    let URL = NSURL(string: "https://example.com/movies")!
    let parameters = ["chinese": String(count: repeatedCount, repeatedString: "‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅ")]

    // When
    let (URLRequest, _) = encoding.encode(NSURLRequest(URL: URL), parameters: parameters)

    // Then
    var expected = "chinese="
    for _ in 0..<repeatedCount {
        expected += "%E4%B8%80%E4%BA%8C%E4%B8%89%E5%9B%9B%E4%BA%94%E5%85%AD%E4%B8%83%E5%85%AB%E4%B9%9D%E5%8D%81"
    }
    XCTAssertEqual(URLRequest.URL?.query ?? "", expected, "query is incorrect")
}
```

## Solution

As reported originally by @PrideChung, the only workaround is to limit the encoding calls to a character limit by splitting the operation into a batch call. This is the approach I used in 4f6b2956 which does in fact fix the problem. I've also added documentation to the `escape` implementation to remove the batching once iOS 8 is no longer supported by Alamofire. 

For now, I've set the batchLimit to 50 which tends to add about a 20% overhead. This overhead is negligible in most cases until the parameter to encode gets extremely large. In the event of extremely large parameter data, the encoding should be done asynchronously.
 It was only found to crash for iOS 8.1 and 8.2, hence our workaround only affects those OSes. There shouldn't be any further issue here. If you are seeing a new crash, please open a new issue.  This is not an appropriate forum for asking this. As stated in the README, this should be asked on Stack Overflow or the like.
  GitHub Issues is not the correct forum for discussing specific implementations. For that, try Stack Overflow instead.
  CocoaPods doesn't support Swift yet, as stated in the README. When it is, Alamofire will certainly add support for it.
  Check that you have the latest version of Alamofire downloaded, meet all of the requirements, and install exactly according to the instructions. For any further questions, try Stack Overflow.
  Thanks, @powerje.
 Just FYI, we just released [AlamofireImage](https://github.com/Alamofire/AlamofireImage)!
  > I'm not sure why this occurs, but it's probably not Alamofire.

It's not Alamofire. None of the methods you listed are at all related to Alamofire.

I'm sorry that you're experiencing this issue, but I hope you reach a resolution soon.
  This is a consequence of the implicit conversion when storing `lon` in `parameters`:

``` swift
println("parameter values: \(parameters.values.array))") 
// parameter values: [42.358056, -71.06361099999999, bar])
```

There is nothing that Alamofire can do to work around this limitation. To ensure a particular level of precision of floating point numbers, use the `NSString` formatting functions.
  Thanks again, @cnoon.
  This is an issue with the Swift compiler, not anything specifically to do with Alamofire. Please try asking on the Apple Developer Forum or Stack Overflow.
  I cannot reproduce. All tests pass and the example project works as expected on master using Xcode 6.1.

If your project isn't recognizing `dispatch_suspend`, you have more serious issues...
  I'm making the following request:

```
        Alamofire.request(.GET, "\(self.url)/cities")
            .authenticate(user: self.user, password: self.password)
            .response {(request, response, _, error) in
                println(response)
        }
```

but i get 

Optional(<NSHTTPURLResponse: 0x7fb6d46089a0> { URL: https://.../v1/cities } { status code: 404, headers {
    "Access-Control-Allow-Origin" = "*";
    Connection = "keep-alive";
    "Content-Encoding" = gzip;
    "Content-Length" = 369;
    "Content-Type" = "text/html; charset=UTF-8";
    Date = "Wed, 22 Oct 2014 18:05:35 GMT";
    Server = "nginx/1.1.19";
    Vary = "Accept-Encoding";
} })

a 404 because the basic auth token header isn't being included... what am I doing wrong?
 @adamwaite Yes I'm sure. I can cURL using the same url and everything works as expected.

curl -i -u <user>: -H "User-Agent: Stayful/com.stayful.stayful-iphone (1; OS Version 8.1 (Build 12B411))" -H "Accept-Encodin: gzip;q=1.0,compress;q=0.5" -H "Accept-Language: en;q=1.0" "https://.../v1/cities"
 @adamwaite but I don't think .authenticate is working because I don't see auth headers being passed to the endpoint at all
 @macu i'm not sure what you mean but i'm simply expecting the basic auth headers to be sent along with my request because I've set the .authorize(user:pass:) on the request obj
 @troypayne That's not how authentication challenges work. Read the URL Loading System Programming Guide for more information.
  Thank you for your pull request @ivanmoskalev. Apologies for not getting back to you sooner. You can actually get the resume data from the code sample I posted in #141. Also, we're going to add better support for resume data in the 1.3.0 release. Please follow the progress of #141 for future updates.
  Yes. This is explicitly documented.
  :+1: 

Thanks, @johnbeynon.
  Ugh. Sorry that didn't work out as expected. What I meant to say was "wrap everything in a `struct Alamofire { ... }` to simulate a namespace. See 8e2e525.
 @joshuatbrown Yeah, nothing like that in Swift. Even if such a macro did exist, that wouldn't work, since Only the top-level type declarations would be wrapped. All of the extensions would need to be left as they are.
  You are correct‚ÄîAlamofire does not directly implement this functionality. My current thinking is that this should be handled entirely by a separate `NSURLProtocol`-based mechanism, which could be shared between AFNetworking and Alamofire.
  The existing Xcode 6.1 branch was merged in with 959fb5ea53fd128e877c9bb4fec964794730d877. If there are any outstanding changes from this PR that you would like to incorporate, please add them in a new PR.
  It's all in the example. OAuth tokens are set in a request header.
  The existing Xcode 6.1 branch was merged in with 959fb5e. If there are any outstanding changes from this PR that you would like to incorporate, please add them in a new PR.
  Fixed by #167.
  Exposing the initializer for `Alamofire.Request` is a no-go. Objects initialized in this fashion are not connected to an owning manager, which is necessary for actually getting requests to work. It'd be irresponsible to expose an incomplete interface for the sake of dependency injection.

A much better solution would be to stub and mock the requests themselves, using `NSURLProtocol` (or any of the off-the-shelf solutions for HTTP mocking / stubbing). 
  For general questions like this, please use [Stack Overflow](http://stackoverflow.com/questions/tagged/alamofire) instead. GitHub Issues are for reporting bugs and discussing features.
  Thanks, @johngibb!
  Xcode 6.1 is not officially released yet. Alamofire will merge this branch and require Xcode 6.1 once it is.
  CocoaPods does not yet support Swift dependencies. This is specifically noted in the README.
  Thanks for the PR, @parto. I ended up taking it a step further in 923c009 by changing the queue to concurrent and using a barrier async on the setter.
  :+1: 

Thanks, @mac-cain13.
  Hi,

Is there support or will there be support for timeouts? I'd like my request to die out if it doesn't return within 4 seconds.
 Timeout interval is a configurable parameter of `NSMutableURLRequest`.
 @mattt How would I do this in code using Alamofire?
  Like the compiler warning says, `UserNetworkModel` needs to be `final`:

``` swift
final class UserNetworkModel: ResponseObjectSerializable, ResponseCollectionSerializable { ... }
```
  Great work, @parto. Thanks for the PR.
  Fixed by #174
  Cannot reproduce. Please follow the installation instructions exactly. For any additional assistance, please try Stack Overflow.
  :+1: 
  Thanks, @nvh!
  @VadimDez I'm having the same problem, let me know if you figure it out!
 ![screen shot 2014-10-10 at 2 27 08 pm](https://cloud.githubusercontent.com/assets/3412692/4597175/2fa261cc-50ab-11e4-8c11-41510cdca9f7.png)
 @nvh Me? I'm on Yosemite 10.10 (14A386a), Xcode: 6.1 Base SDK iOS 8.1 (Deployment target iOS 8.0)
  Looks like something was mis-merged from master. This is fixed by 6b6facc0ac407bc37e6c71f5d93d11f21894b8ba.
  Error code -1005 for `NSURLErrorDomain` means "The connection failed because the network connection was lost." (Additional information [here](http://nshipster.com/nserror/)).

There are a number of reasons why this could happen, whether it's your internet connection or `httpbin.org`'s cutting out, or sabotage by some proxy or firewall. If you're still having trouble getting this to work, I'd recommend consulting Apple's Developer Docs or asking a question on Stack Overflow.
  Fixed by 942cf29. Looks like spaces weren't being encoded.
  Cannot reproduce. Make sure that you are using the latest version of Alamofire.
 I don't know what to tell you. [`validate` exists and works just fine on the HEAD of the xcode-6.1 branch](https://github.com/Alamofire/Alamofire/blob/xcode-6.1/Source/Alamofire.swift#L832-L842). If your local copy doesn't have it, your local copy is out of date.
  .DS_Store is something that should be put in a global .gitignore. A project's .gitignore should be specific to that particular development environment.
  Thanks, @parto.
  See #153.
  The difference here is that the initialized `manager` is not owned, and is deallocated shortly after it goes out of scope. As a result, any pending tasks are cancelled.
  +1 except i'm getting this error:

![screen shot 2014-10-09 at 10 37 33 am](https://cloud.githubusercontent.com/assets/3412692/4578067/f57bf34e-4fc1-11e4-9b9c-0bc54fc51149.png)
  See #153.
  Thanks for the kind words, @rlimberger.

Alamofire is built on the Foundation URL Loading System, and can therefore be integrated with custom `NSURLProtocol`s.

Unfortunately, I can't provide any support for this. I'd recommend contacting a technical account manager at Shibboleth for support, or asking around on Stack Overflow.
  Thanks, @kaphacius. Fixes #146.
  The README has been updated with installation instructions that specifically deal with targets that do not support embedded frameworks. Apologies if any of this was unclear. Hopefully this should resolve things.
  What are the exact parameters that cause this behavior?
 Fixed by 942cf298364e4244a65478d8a5f7b025ee78e056. See #162.
  `upload` does not accept a `parameters` parameter, since the body of a request is a factor of the data, file, or stream being uploaded. Any necessary configuration can be achieved by using the version of the method accepting a `URLRequestConvertible` argument.
 Hi @albincr, it depends on your service. Most likely you'll want to upload the data as [MultipartFormData](https://github.com/Alamofire/Alamofire#uploading-multipartformdata). You may also need to pass the parameters in the [query string](https://github.com/Alamofire/Alamofire#manual-parameter-encoding-of-an-nsurlrequest) and supply the image data for the [upload](https://github.com/Alamofire/Alamofire#uploading-a-file).
 You probably have some conflict. You could try `Alamofire.Method.POST`. Otherwise please take your questions to Stack Overflow.

Instead of creating a support issue in Github, please open a question on [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. The Alamofire community is very helpful and supportive. Stack Overflow is the best place to get your question answered quickly and correctly.

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
  You can't send GET requests as JSON, because GET requests don't have a message body.
  Thanks for reporting this, @techxplorer. Indeed, this was the incorrect behavior.

d28f0c0 adds a fix, as well as a previously-failing test.
 @codeblooded Thanks for your offer to contribute. The reported behavior was a bug, rather than an example of some desired behavior that should be afforded by an additional feature. 

Out of curiosity for other permitted query string characters, e495cae adds a test to explicitly check to make sure question marks are encoded properly, which they are.
 Fixed by #153.
  Thanks for the PR, @stuntdouble. I always appreciate it when changes accompany new tests.

I wonder if this is the correct behavior, though. With this change, an empty array would be indistinguishable from a single element array containing a blank string.

Unfortunately, as noted in the documentation, there is no specification governing what the behavior should be. Is this change based on behavior you observed in a conventional web application framework?
 Given the potential for ambiguity with this change, I'm deciding to close the PR. 

I'd be happy to take another look if anyone could show this behavior in the wild (again, lacking any firm specification).
  It's `Alamofire`, not `AlamoFire`.
  Thanks, @nduplessis!
  Alamofire can be compiled against a minimum deployment target of iOS 7. How it is distributed within a project is an entirely separate concern.
  We're looking to add better support for this in the 1.3.0 release. We'll keep you posted üëçüèª
 Hey everyone, I just posted a PR #595 that adds much better resume data support for downloads. If you could all check it out I'd appreciate it. Please direct all further comments on resume data to that issue.

Cheers üçª
  Indeed it should. Thanks for the PR, @rynecheow.
  Thanks, @orta!
  D'oh. Following rules of precedence, I should have merged this instead of the #139. Descending sort order strikes again.

Apologies, and thanks for the PR, @rosskimes.
  The wording was changed as a consequence of c99e9ff6c1161f7b7ee4452d4110da8daeb13a2e. Thanks for your contribution, @tomlokhorst.
  Cannot reproduce. It's likely an issue installing or integrating the framework. 

da237ff adds two tests specifically for `progress`, which both pass.
  > I am suppose to get an error only if the statusCode is not 200..<300 right?

No. If there was an error in the request itself, that will be the error returned in the response handler. Or, if there is an error serializing the response object (as is the case here, since content-length = 0, `NSJSONSerialization` fails with an error).
  As noted in the README, just use the AFNetworking UIKit extensions. There's really no benefit in rewriting all of that in Alamofire.
  Thanks for the PR, but the `switch` is in place to accommodate the soon-to-be-implemented download and upload requests.
  Alamofire itself will be free of external dependencies, but as @tangplin mentions, this functionality can be added very easily.
  Based on your explanation, a few possible reasons come to mind. It could be that your code in response handlers are blocking the main thread, or that the process of creating and sending a request is blocking in some way. `NSURLSession` automatically manages its own connection pool, so it's unlikely that the network IO itself is the root cause of what you're describing.

Would you be able to create a small example project that reproduces this?
  An `import` statement was added in bb112f07e430c487e75ad3e9f059e9e27705597a. Thanks for your contribution, @twe4ked.
  Apologies for the delay in responding. I agree with your sentiment, and have cherry-picked bae253fb0a50143b3c2012ad6894693656e0362f (the other patch was made moot by changes in the meantime).
  I can't reproduce, but this is almost certainly a duplicate of #55. The solution explained there didn't work?
  Thanks, @adamhartford, but this doesn't go quite far enough, and breaks a few tests. 52b0086 makes the necessary changes.
  I'm not sure what the issue would. [This test](https://github.com/Alamofire/Alamofire/blob/master/Tests/ManagerTests.swift#L27-L45) demonstrates this API in use.
  :+1: 

Thanks, @iUtvikler.
  >  I send a search request "apple" and seconds later...

A few seconds later? You're probably not getting any tasks back because that task already finished.

Regardless, I would recommend against this approach. Keep a reference to your `Alamofire.Request` object and cancel directly instead.
 @ingouackaz 

[Alamofire.Request -cancel()](https://github.com/Alamofire/Alamofire/blob/master/Source/Alamofire.swift#L655-L663).

That you're getting an "Unrecognized selector" exception is troubling. You're using Alamofire in Swift, right?
  I appreciate your PR for this, @jonandersen, but I'm not sure if this belongs in the README for this project. 

There's a slippery slope argument one could make about whether we should also include instructions for installing Git, or creating a new project in Swift, or installing Xcode... but really, it's just that this is probably an inessential detail for a majority of folks.

As a compromise, 2b10607 adds a link to the Git submodule documentation, so anyone (blissfully) unfamiliar with submodules have a point of reference.

Thanks, @jonandersen.
  Installation instructions (until CocoaPods supports Swift) are provided in the README. The only required file is Alamofire.swift. If there's any mention of `XCTest`, you're loading or linking against the testing target  somehow.
  Indeed, the HTTP body was not being encoded. Fixed by 1e634b3. Thanks, @skasriel.
  Thanks, @ricardopereira.
  No, these are specifically intended to be private.
  [From the README](https://github.com/Alamofire/Alamofire#http-basic-authentication):

``` swift
let user = "user"
let password = "password"

Alamofire.request(.GET, "https://httpbin.org/basic-auth/\(user)/\(password)")
    .authenticate(user: user, password: password)
    .response {(request, response, _, error) in
        println(response)
    }
```

This does not add an `Authorization` header until after the initial request fails. See the [Apple Documentation on Authentication Challenges](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/URLLoadingSystem/Articles/AuthenticationChallenges.html) for more information.

If something's not working, then it's likely to do with the server you're attempting to connect to.
  in AFNetworking for objective-c, there was this convenient flag I could set. 

[self setAllowsInvalidSSLCertificate:YES];

What's its equivalent in Alamofire for swift?
 Alamofire doesn't yet provide TLS verification, so there's no equivalent for `setAllowsInvalidSSLCertificate`.
 It is not yet available. TLS verification is slated for the 1.3.0 release. More info can be found [here](https://github.com/Alamofire/Alamofire/milestones).
 Check out the Security section of the README @Lweek.
  Thanks, @duemunk.
  Thanks, @rosskimes.
  Noted in c99e9ff6c1161f7b7ee4452d4110da8daeb13a2e.
  Use the `HTTPAdditionalHeaders` property of `NSURLSessionConfiguration`. This value may or may not be derived from the default `HTTPAdditionalHeaders` value for the session configuration of the default manager.
 `Alamofire.Manager.sharedInstance.session.configuration.HTTPAdditionalHeaders`
 Yeah, that's the point. If you want custom headers, pass it into the configuration of a new manager. The aforementioned line of code gets you the default, in case that's something you wish to base it off of.
  Until this is implemented, AFNetworking's multipart form request functionality can be used in conjunction with Alamofire itself.
 @mileswd we are going to implement this. We haven't finalized the `1.3.0` roadmap yet, but most likely this feature will make it onto that list. Stay tuned...
 Hey everyone, I just put up PR #539 which adds support for `MultipartFormData` uploads. I would love your feedback before merging it in. Cheers.
 Hi @chrisco314, I've seen some weird throttling on uploads on some ISPs before, but generally, it should just upload consistently. Alamofire doesn't do anything to trigger that behavior in any way.
 You need to add the parameters to the multipart form data @Johnykutty. üëçüèº
  Duplicate of #105, which will be merged into a 1.1 branch.
  Thanks for submitting this PR, @duemunk. As far as I can tell, the same necessary changes to the project were applied in cb7dde5b3aa7134cca57fc60fcaa0d03c5676ba3. Since the merge wasn't going to be clean anyway, I decided to work out my general frustrations in a sweeping epic of an installation guide, with 96e6a2fb72d7122cecd744ac811e6824731f42a4.

Seriously, CocoaPods for Swift couldn't come soon enough.
  Fixed by cb7dde5.
  Props to whoever in Cupertino wrote that great error message. 582eec1 should fix this.
  Thanks, @arnaudjbernard!
  Fixed by cb7dde5.
  See #70.
 Hi @mathiasi,

If you are finding this to be more than just the in-memory usage of the shared `NSURLCache`, then please open a new issue with a good description, info about how you installed Alamofire, Xcode versions and all relevant sample code. An actual sample project would be awesome.

Cheers.
  Presumably, if you were sending the header `Content-Type: application/json`, you would also then be sending JSON in your body. If so, specifying `ParameterEncoding.JSON` should perfectly suit your needs.

Otherwise, the latest in master also provides an interface that takes a `URLRequestConvertible` type parameter, of which `NSURLRequest` is a conforming class.  
  Thanks for the PR, @Mikoj. I ended up adding a slightly modified version of [GitHub's Swift `.gitignore` file](https://github.com/github/gitignore/blob/master/Swift.gitignore) in ae1e1148ba41f1b20b922f3a49edd1e7bb01a93c
  Thanks for the PR, @banDedo, but I think I'm going to take things in a different direction. The top-level convenience methods are good for making getting started and making one-off requests, but for applications which regularly access an API, more significant infrastructure is warranted.

5b94f2a2f1a368a63db2e692b9004a236560c0f3 adds the `URLRequestConvertible` protocol, which a consumer `enum`, `struct`, or `class` responsible for constructing requests can adopt. It'll have to be heavily documented before it goes live in 1.0, but I think it offers the cleanest and most extensible approach.
  Xcode bug notwithstanding, I was luckily able to fix this with 32fb7b4. Seems the XCTest runner doesn't take kindly to inner class test cases.
  Thanks for the patch, @johngibb. An equivalent change ended up being made with 59503b763ac4b71c7bce36bce44512b3cfa255f2.
  Thanks, @johngibb.
  It doesn't really make sense for a dictionary to have an optional value type, since setting a `nil` for a key removes that key from a dictionary:

``` swift
var parameters: [String: AnyObject?] = [:]
parameters["foo"] = nil
parameters.keys.array.count // 0
```

If this weren't the case, we'd expect a non-empty set of keys.

As @yanke-guo points out, `NSNull` is the appropriate value to pass here.
 Everything needs to bridge back to Objective-C to use `NSJSONSerialization` @rlaferla. Hopefully Swift 3 will give us some better options.
 @PurviJani Posting on old, unrelated issues is not a good way to get support. These types of questions are best suited for [Stack Overflow](https://stackoverflow.com) and tag `Alamofire`. We use our GitHub project for bug reports and feature requests.

Best of luck! üçª

---

From our [Contribution Guidelines](https://github.com/Alamofire/Alamofire/blob/master/CONTRIBUTING.md)

## Asking Questions

We don't use GitHub as a support forum. For any usage questions that are not specific to the project itself, please ask on [Stack Overflow](https://stackoverflow.com) instead. By doing so, you'll be more likely to quickly solve your problem, and you'll allow anyone else with the same question to find the answer. This also allows maintainers to focus on improving the project for others.
 @esetnik That issue should be fixed by [SE-140](https://github.com/apple/swift-evolution/blob/master/proposals/0140-bridge-optional-to-nsnull.md) as part of Swift 3.0.1 which I believe will be part of Xcode 8.1, which will be released alongside iOS 10.1. When that will be I'm not sure. 

In the mean time, doing what you suggest would be very complicated, requiring us to build our own non-generic optional protocol (for casting), along with functionality to extract values or `NSNull` and dynamically rebuild `parameters` values, which are arbitrarily sized. So it would be terrible for performance, requiring `O(n)` time and `O(n)` memory (as we'd have to copy the value passed in). It would also be slowed down by the fact that we'd have to do `is` checks on every value in parameters, both to check for optionality as well as to see if it's a collection type. So, given that it will be fixed rather soon, I'd say we won't be adding that functionality.

@cnoon, anything to add?
 I'm not sure where you get that necessity? The proposal bridges values (of any type) as their value or `NSNull`. The `Any` cast is done when passed as a `[String : Any]` value to the Alamofire APIs. 
  This was caused by a change in Swift source mapping from Foundation, which caused the `HTTPMethod` property of `NSURLRequest` to be optional.
 Fixed by 59503b7.
  Fixed by 997a2a4.
  Thanks for the PR, @lesmuc.

9ad2866 actually makes all of this unnecessary by using the built-in `HTTPAdditionalHeaders` property of `NSURLSessionConfiguration`.
  Fixed by cb7dde5, or otherwise mitigated by following instructions described above.

Anxiously awaiting Swift support in CocoaPods.
 You MUST have a deployment target of iOS 8.0 or above to use embedded frameworks with CocoaPods.

From the [README](https://github.com/Alamofire/Alamofire#installation):

## Installation

> **Embedded frameworks require a minimum deployment target of iOS 8 or OS X Mavericks.**
> 
> To use Alamofire with a project targeting iOS 7, you must include the `Alamofire.swift` source file directly in your project. See the ['Source File'](#source-file) section for instructions.
  I could not reproduce this. Perhaps this was fixed by #106, or maybe the latest Xcode 6.1 beta?
  Alamofire is already updated for Beta 7, as of 288509fc45b41d5545958d2b363679f7f8c6715c. Given the addition of implicit unwrapped optionals, his patch appears to be compatible with Beta 6, or some other previous version.
  See #32.
  Glad to hear the latest version fixes your issue.
  Thanks, @JJSaccolo!
  Fixed by #78.
  I actually prefer the way singletons are currently implemented in Swift. Unless Apple provides any official guidance on this in documentation, I am comfortable keeping things the way they are.
  > I presume various closure-typed properties in SessionDelegate, TaskDelegate, DataTaskDelegate and DownloadTaskDelegate are intended to be used by clients to extend/override particular delegates behavior.

Actually, that's incorrect. These are implemented internally for the sake of completeness. Any functionality intended for the end user would be exposed on `Manager` or `Request`.
  Thanks for pointing this out, @odnoletkov. 00b4dee43d95050e0f1749ef596a3a7d9289cfdd adds the missing step of removing the subdelegate after its received its last delegate method.
  Actually, I decided to remove `baseURL` outright from Alamofire. The recommended pattern for URL construction (will be documented extensively in the near future) is to construct `enum`s conforming to `URLStringConvertible`.
 https://github.com/Alamofire/Alamofire#crud--authorization
  I can't speak to specific build configuration issues. Xcode 6 and Swift are still in beta, and are subject to bugs and breaking changes.

The only officially support means of distribution for Alamofire are building as a framework or using CocoaPods, once that is supported. Of course, you're welcome to maintain your own fork, but I would strongly recommend against that.
  @rkeniger This is an interesting idea, but I believe out of scope for the library. Although JSON is ubiquitous, the practice of XSS (most commonly starting JSON with `)]}',`) is a niche practice, mostly relegated to the world of client-side JavaScript. Adding this as a parameter to `responseJSON` would mostly just confuse users.

That said, I could see a library providing an extension on `Alamofire.Request` that provides a `responseXSSProtectedJSON` method, or the like.
  Thanks, @rkeniger.
  Duplicate of #55.
  I cannot reproduce. Alamofire works fine with Beta 6.
 @jjochen Beta 6 is a minimum requirement for Alamofire.
  That's a fundamentally unsafe operation, since `NSJSONSerialization +JSONObjectWithData:...` returns `AnyObject?`.

See #57 for additional discussion.
  Thanks, @MacKeeper!
  Adding a .gitignore file that hides xcuserdata, which shows up as (untra...
 Thanks, @troypayne. A `.gitignore` file following GitHub's Swift template was added with ae1e1148ba41f1b20b922f3a49edd1e7bb01a93c.

(FWIW, `xcuserdata`, like `.DS_Store` and other common noise, is something a lot of people like to put in their user-level `.gitignore`)
  I have this 70% done on a private branch. I appreciate your willingness to help, but I would not recommend working on this yourself.
  > Parsing client specific JSON is beyond the scope of this library, and is a responsibility placed on the specific client.

Well said, @justinmakaila.

Though I would say the easiest way to integrate would be to implement a `responseSwiftyJSON` method in an extension on Alamofire.Request.
  Thanks, @zrcoder.
  Has anyone been able to run Alamofire.swift on a device running iOS 7?

For me, it's crashing with:

dyld: Library not loaded: @rpath/Alamofire.framework/Alamofire
  Referenced from: /var/mobile/Applications/A59259D8-0AF7-43AD-AC21-2A0530B26B09/Stayful.app/Stayful
  Reason: image not found
 @martijnkorteweg 
I get the following error after adding AlamoFire.framework to the Embedded Binaries

dyld: Symbol not found: _NSURLAuthenticationMethodHTTPBasic
  Referenced from: /private/var/mobile/Applications/560EC324-52BC-4046-9C3B-D830BE0E870D/Stayful.app/Frameworks/Alamofire.framework/Alamofire
  Expected in: /System/Library/Frameworks/CFNetwork.framework/CFNetwork
 in /private/var/mobile/Applications/560EC324-52BC-4046-9C3B-D830BE0E870D/Stayful.app/Frameworks/Alamofire.framework/Alamofire
(lldb) 
 @mattt any ideas?
 @angelcasado thanks! That did the trick
  This was caused by a change from Beta 5 to Beta 6. Delete your DerivedData directory and try again.
  The example project is built with Alamofire as a framework. You can use that as a reference if you need more clarification on installation.
 Thanks, @angelcasado.
  The latest in master has an example project and test harness. That should be a good place to start.
  Thanks for your PR, @Coltspb. I made a similar change to the same effect with 34f8f2f.
  Thanks for your PR, @Dschee. In the process of greater project restructuring, similar or equivalent changes were made in 9f7c365.
  As of 9f7c36531d6a23ab8b5bb3f456fb7a7c79370d65, Alamofire is updated for Xcode 6 Beta 6.
  Thanks for your PR, @maxpow4h. Unfortunately, these changes aren't applying cleanly after 9f7c36531d6a23ab8b5bb3f456fb7a7c79370d65, which did significant restructuring on the project. If you wouldn't mind, please open a new PR against the latest master.

Responding to specific changes:

> - Removed default arg of User's home directory

I actually like these as a default. I've found that most users are completely flummoxed by `NSFileManager` semantics, and would prefer something that "just works". Any reason why this wouldn't be an appropriate default?

> - Moved test 100.json file to Library/Caches directory

This test is to simulate downloading a file to the documents directory. For lack of a CDN to host a meatier file, I'm using HTTPBin's file stream.

> You probably want to pick a better NSError domain.

As of the latest commit in master, Alamofire does not construct `NSError` objects.
  Duplicate of #36.
  Thanks for sharing your thoughts, @tLewisII, but I'm not really sure what this would accomplish... Instead of any additional safety, I think a extra hoop like this would only serve to frustrate anyone who just wants to make a network request in an idiomatic fashion.

If anything, the correct approach would be to provide an extension on `NSURL` to have it conform to `StringLiteralConvertable`. I'm looking into that for the next release.
  Unit tests work just fine as-is. Are you running into any specific issue with access control?
 As of 9f7c36531d6a23ab8b5bb3f456fb7a7c79370d65, Alamofire is structured for use as a framework, rather than a drop-in file. The access control is such that the unit tests target in the provided test harness is able to successfully run all of the tests.
  Thanks for the PR, @NialG. One of the new patterns I'm incorporating before 1.0 is the `URLRequestConvertible` protocol, which structs / classes / enums can adopt in order to create an `NSURLRequest` (there is also `URLStringConvertible`, which is used to generate just the path).

The idea being that, for a larger application, a router object would be responsible for constructing paths or requests according to a particular context. For example:

``` swift
enum ExampleAPIRoute: URLRequestConvertible {
    case User(Int)

    var URLRequest: NSURLRequest {
        let baseURL = NSURL(string: "http://api.example.com")

        switch self {
        case .User(let id):
            let path = "/users/\(id)"
            return NSURLRequest(URL: NSURL(string: path, relativeToURL: baseURL))
        }
    }
}

request(URLRequest: ExampleAPIRoute.User(1)).response { (_,_,_, _) in
   // ...
}
```
  This is touched on a bit in #7. Basically, the current top-level interfaces for requests are a convenience for initializing with `NSURLRequest` objects. These will eventually expand to support other fields in a future release.
  It would be a difficult API design decision to defend if the input parameters of a serializer closure did not match those of the response closure. I could easily imagine removing information here to be problematic for certain use cases.

As for the existing serializers, I don't see an issue with their current implementation, other than perhaps not forwarding any existing errors up the stack using the underlying error information of an `NSError`.
  Thanks for your PR, @venj, but this is a duplicate of #34. As for #35, this is an unrelated change.
  It's a compiler error. Explicitly cast your parameters as `[String: AnyObject]` (or maybe `[NSObject: NSObject]`), and you should be good to go.
  df5e97e fixes this by nil-coalescing each value to `"Unknown"`.
  Hmm... following your findings, I don't understand how this would produce the desired behavior. In the case of an if / else statement, if certain cases overlap, it should go from most specific / exclusive to least. Unless I have it wrong, shouldn't it be testing download, then data, then upload?
 Thanks, @jandrewmoore.
  @tonglil You can encode the string as `NSData` and set as the `HTTPBody` or an `NSURLRequest`, which you then pass into `Alamofire.Manager.request`.
  These are doing different things. Alamofire is creating a credential that will be used during an authentication challenge, whereas AFNetworking is setting the `Authorization` header in the initial request.
  Thanks, @hpique!
  Fixed by #34. Thanks again, @jandrewmoore.
  Yes, `URLSession:didReceiveChallenge:` is the method implemented in Alamofire as well. Additional control over this behavior, namely TLS chain validation, is forthcoming.
  For anything beyond what the shorthand provides, you'll have to drop down a level of abstraction to create and manage `NSURLRequest` objects yourself. This may change in a future version, but for now, here's the process:

``` swift
let URL: NSURL(string: "http://api.imgur.com/3/gallery.json")
var mutableURLRequest = NSMutableURLRequest(URL: URL)
mutableURLRequest.setValue("...", forHTTPHeaderField: "Authorization")

let manager = Alamofire.Manager.sharedInstance // or create a new one
let request = manager.request(mutableURLRequest)
request.responseString { (request, response, string, error) in
         // ...
}
```
 Alternatively, you could also set the `Authorization` on the `defaultHeaders` of a manager. This would automatically apply the header to all requests created through method shorthand. 

Real documentation for this usage is forthcoming.
  Thanks, @sasikiran, but #24 came in a little before this one. Do you see any changes missing from that?
  I think there are plenty of opportunities to integrate other dependencies with Alamofire, but they'd be best suited as separate libraries themselves.

For example, someone could create Alamofire+SwiftyJSON, which added the method `responseSwiftyJSON`. Similarly, I'm planning to create an extension for XML support using [Ono](https://github.com/mattt/ono), which would add the `responseOnoXMLDocument` method (or similarly named).
  :+1:

Thanks, @kylef!
  Any clue why I have so many errors? Here's the first:

Alamofire.swift:46:16: Type '[String : AnyObject]?' does not conform to protocol 'BooleanType'
 I've created pull request https://github.com/Alamofire/Alamofire/pull/24 that fixes the issues.
  Cheers, @romanroibu. Thanks for the PR.
  Thanks for your feedback, @onevcat. In the process of updating the code to the latest beta, and other refactoring, similar or equivalent changes have been applied.
  You're probably missing an `import Foundation`.
 As of 9f7c36531d6a23ab8b5bb3f456fb7a7c79370d65, an example project and test harness are included in the repository.
  Indeed, that's a bit of code made unnecessary by the `URLRequest` convenience method a few lines down. Thanks, @onevcat.
  Fixed by #34.
  There is a bug in iOS 7 wherein sessions tasks created on a concurrent queue may not have unique identifiers (which is necessary for keying delegates on task identifiers). This ensures that all tasks are created serially, and have unique identifiers.
 The `queue` is a serial queue @pavm035.

``` swift
let queue = dispatch_queue_create(nil, DISPATCH_QUEUE_SERIAL)
```
  Thanks for your PR, @vmartinelli.  I had been developing this in a private branch, waiting until the example project was finished, so I apologize for any inconvenience in maintaining a separate fork by not providing this initially.

627b7420f9a8a690cfab57fc48c19a6941b3daeb adds an example project and test harness.
  Swift function naming conventions are still being determined, so there's no authority to cite for any specific rationale.

My personal thinking is that `response` is complementary to `request`; the ambiguity arises from the fact that request is both a noun and a verb. `respondJSON` doesn't sound right, though. Instead of an instance method, think of it instead as each method omitting an implicit `on`, i.e. `onResponse`.

> By the way, a similar question: what do you see as the advantage of Chainable Request / Response methods?  Could someone show me an example that clearly shows the advantage?

I'm not sure what you're asking, here... Objective-C would use chaining a lot more if there wasn't a syntactic cost; returning `Self` is a convenient way to string along expressions.

One additional benefit of the approach used by Alamofire is that it allows for multiple `response` calls, for any situation that might want to handle responses differently:

``` swift
Alamofire.request(.GET, "http://example.com")
               .responseJSON { (_,_, JSON, _) in
                     // ...
              }.responseJSON { (_,_, JSON, _) in
                    // ....
             }
```
  Thanks for suggesting this, @dataxpress. This is definitely something I'd considering‚Äîgoing back and forth a few times, in fact. Ultimately, though, I find myself preferring the explicit consistency of the current APIs. 

The extra method opens the rest of the convenience APIs up to potential bloat in order to match it. One confusing outcome if that were to come to pass is that `download` would also default to `GET`, whereas `upload` would be `POST` (which is not, itself, a strong default in a world where web apps tend to flex their method vocabulary).
  :rose: :fire: 
  Fixed by c709d35.
  See #8.
  Thanks, but this is not the error. There was a missing code fence block, fixed by d466d8e7fd66202d1a7be477c54d3cc0386f3339.
  Most of the development and documentation of Alamofire so far has focused on the simplest, most common use cases. Right now, what you're describing is accomplished by constructing a request with an `NSURLRequest`. The API may change to accommodate the described method in the future.
 @Dschee That's just not how I use GitHub Issues. I give you all assurances that I know what I'm doing.
 @Dschee Feel free to conduct yourself in your work as you see fit. I'm not particularly interested in having a discussion about process.

> On 2014/08/13, at 14:26, Dschee notifications@github.com wrote:
> 
> I don't wanna be disrespectful ‚Äì I mean you're the one with the big experience here ‚Äì but your explanation hardly satisfies my curious mind. I'm still wondering why you close ideas for future versions. I'd be happy to keep them opened or at least mark them within closed issues so that I can find them later as ideas for new versions.
> 
> But who am I to tell you something about maintaining great frameworks ... :)
> 
> ‚Äî
> Reply to this email directly or view it on GitHub.
  Thanks, @pwightman. This ended up being fixed with d466d8e7fd66202d1a7be477c54d3cc0386f3339, which changed the formatting from what was used to originally fit the code into the slides for the presentation announcing Alamofire on Wednesday.
