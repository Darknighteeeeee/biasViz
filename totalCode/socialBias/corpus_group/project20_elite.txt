  thanks, can you use the edit button the doc page to update it? you can get a URL by dragging the image into github issue.  A-Frame uses THREE and the logic to recover a lost context you pointed out should be used by A-Frame now too.  Windows / Firefox is my work setup and never seen this issue. Can you also reproduce in a different machine?  thx  Left eye camera frustum is used for culling both eyes in THREE. As you saw it has to be fixed on the THREE side first.  This is expected behavior. `componentchanged` is not emitted anymore for rotation, position, scale for improved performance. You can read the values on a `tick` method in your component and update `a-text` accordingly:

```
tick: function () {
     var cameraRotation = this.el.sceneEl.camera.el.object3D.rotation ; // or this.el.sceneEl.camera.el.getAttribute('rotation'); this will return degrees not radians.
    textEl.setAttribute('value', 'x: ' + cameraRotation.x + ' y: ' + cameraRotation.x + ' z: ' +  cameraRotation.z
}
```  **Description:**

Rather than create a new object each time to create a new `oldData`, just have two objects representing `oldData` and `data`. Also when updating, rather than create a new `data` object, have a `newData` object that is used for holding the new data which then gets copied into `data`. So in total, only use three objects: `oldData`, `data`, `newData`.

**Changes proposed:**
- Adapt `style-attr` implementation to be able to pass in an object for reuse instead of creating a new one each time. Also remove lots of callbacks, `Object.keys()` array creations from their code.  Also tweaked to do prettier stringifies. We manage this forked dependency now. 
- Use object pooling in core component code to reduce object allocations. Recycle them when component is removed.
  - 1. Remove object allocations on each update for deep cloning data to `oldData`.
  - 2. Remove object allocation on initialization for initial `oldData`.
  - 3. Remove object allocation on each update during `buildData` for default value copying.  
  - 4. Remove object alloaction during `buildData`, was using `Object.keys`.
- Add some helper properties to component (`isSingleProp`, `isSinglePropObject`, `isObjectBased`)
- Update our `styleParser` utils a bit to not allocate object + array + use callbacks to convert keys to camelCase, and to cache regexes.

Updated to not delete the keys when recycling an object, but just set every key to `undefined`. This means object pooling best used when objects share a common schema, in case we iterate over keys. So I create different object pools for each type of component, since their object keys will be the same. I also update schema parser to ignore undefined keys.

## Before

<img width="1251" alt="screen shot 2017-10-03 at 7 16 43 pm" src="https://user-images.githubusercontent.com/674727/31138775-de39265c-a86f-11e7-9614-1c417cb5c1d1.png">

## After

**Improvements:** See the `updateProperties` and `updateCachedAttrValue` no longer on the list of frequent memory allocators. 

<img width="1250" alt="screen shot 2017-10-03 at 7 17 57 pm" src="https://user-images.githubusercontent.com/674727/31138779-e0e4c56e-a86f-11e7-866d-db02bced835e.png">

- [x] Still need to polish/comment a bit more (and try to remove the clones for default values). But up and working again.
- [x] Tests
 Ready to go. Did another test with the /performance/animation-set-attribute stress test to measure memory. These recordings were taken over **4 seconds**. We save the following allocation calls:

- buildData (component) (~400KB)
- getKeyValueChunks (style-parser) (~160KB)
- cloneData (~80KB)
- updateProperties (~28KB)

With the particular stress test, it does lose out on ~5FPS (20FPS vs 15FPS), but it's also an unrealistic example since we wouldn't use setAttributes that hard and often for animations. Dodging GC is more important because GC will lose you entire frames.

We could perhaps have an option for components to not do any diffing, cloning, comparing, and just always run the update method no matter what, and let the component sort out data changes. We are probably losing a lot of time making sure redundant calls don't get processed.

# Before 

<img width="784" alt="before" src="https://user-images.githubusercontent.com/674727/46076363-2e160f00-c142-11e8-883f-8ed3012f703b.png">

# After

<img width="774" alt="after" src="https://user-images.githubusercontent.com/674727/46076370-32dac300-c142-11e8-82c9-3f91897a9c08.png">


 browser memory tools  We use StackOverflow for questions. You can move the discussion there. It will get more exposure. We use Github issues for bugs and feature requests.   **Description:**

**Changes proposed:**
-
-
-
 What's the rational to not bubble state events? It was for performance and semantics. For my laptop, a stateadded or stateremoved call each take ~.1ms (1% of a 90FPS budget), didn't quite like the cursor used it, so figured I could ameliorate it a bit. I thought it didn't make sense to bubble these events when they are very single-entity-specific.

I could go either way, my full desire would be to remove the API, and just use the cursor events provided. Second would be to remove event bubbling so it doesn't fire on like 10+ ancestors. If there's disagreement, don't mind closing either. When I write that API bubbling was what made it valuable. I used it to have a bunch of entities (created dynamically) changing to a specific state (`dead`) that I wanted to get notified for. Maybe we don't bubble but emit also on the scene so one can attach a single listener? @wmurphyrd Would that work for you? How about using raw events + data attributes? I feel using both state + events can be redundant. Instead of like listening for `stateadded` with `grabbed` state, just emit and listen for a `grabbed` event.  needs more info. Well, you don't provide any code or any leads. It's a warning that could come from anywhere. This is perhaps a StackOverflow support question to ask here https://stackoverflow.com/tags/aframe  **Description:**
The click event is not fired anymore if the mouse is not moved on the element. If the mouse moves a bit, then the event is firing again.

- A-Frame Version: 0.8.2 AND master
- Platform / Device: Desktop Firefox
- Reproducible Code Snippet or URL: 
After clicking on the start button, a navigation menu appears on bottom. Pose mouse cursor on right arrow without moving the mouse and click, and click again and again. Only the first click event fires and moves the white thumbnail indicator. If you slightly move the mouse between clicks, click events are fired.
http://dev2.ideaspacevr.org/gallery

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Thanks, you are right. There is something in my code specifically which prevents it.  
**Description:**

All of the fiddling with the alpha didn't really help and made things look worse when blending with other entities with alpha, and at distance.

Text example looks unchanged, but in certain conditions the text degrades badly. Can see it below, but it often manifests worse:

## Before

<img width="742" alt="screen shot 2018-09-13 at 3 25 59 pm" src="https://user-images.githubusercontent.com/674727/45519483-1619b500-b76a-11e8-9cd0-e0e7bd68213f.png">

## After

<img width="808" alt="screen shot 2018-09-13 at 3 25 33 pm" src="https://user-images.githubusercontent.com/674727/45519482-1619b500-b76a-11e8-9fbd-a48409d30f60.png">


**Changes proposed:**

- Remove alpha modifications that were done based on experiment / guess & checks.
- Remove the logic `when texel is too small, blend raw alpha value rather than supersampling`
- Remove the logic `when texel is big enough, do standard alpha test`
- Less shader branching! looks fine to me in the text example <img width="1359" alt="screen shot 2018-09-25 at 11 18 21 pm" src="https://user-images.githubusercontent.com/674727/46060836-635a3700-c119-11e8-9c48-f6ee7f5fe68e.png">
  What about a single `reverseDrag` flag that works for both mobile and mouse? I think this is fine  **Description:**

Loading screen to avoid blank screen while loading assets and scene render loop has not yet started. The loader animation doesn't require 60fps to mask main thread pauses.

The logic is a `pseudo-component` since it has to initialize and render while the assets load. 

The title of the page is displayed above the loading indicator.

The color of the dots, background and style of the title bar are configurable.

![loader](https://d3vv6lp55qjaqc.cloudfront.net/items/0M3q3m0W2Z3h3G17152y/Image%202018-09-05%20at%203.06.05%20AM.png?X-CloudApp-Visitor-Id=222920&v=51eab09b)
  Are you able to share a demo of the scene? Confirmed the issue. 

Here's what I think is causing the problem: the `material` component uses a default `alphaTest` of 0, whereas three.js uses a default of 0.5. That would be fine (both are reasonable values), but `THREE.GLTFExporter` has to choose _either_ opacity or alphaTest to write, it cannot export both to glTF. Because alphaTest appears to be non-default, compared to three.js, alphaTest is chosen.

The workaround would presumably be to set `alphaTest: 0.5` on the model, but that isn't fixing the issue for me on a quick test. Will need to look more closely at why that is.  For discussion and not ready to merge, see https://github.com/aframevr/aframe/issues/3509. It looks good to me. What's pending? Some questions in https://github.com/aframevr/aframe/issues/3509#issuecomment-417955800. This code is working, I'm just not sure if this is the right API to give users a colorspace option. I would probably like to create a new example rather than editing the anime-UI one, too. How about a material system because it only applies through the material component? e.g., `material="colorSpace: srgb"` Yep, probably a property of material makes more sense. @dmarcos just to clarify ‚Äî are you OK with this being a material *system*? I think something at the scene level is preferable to including colorspace on every material component.  We recommend using Stack Overflow for help questions ‚Äî I've commented on https://stackoverflow.com/questions/52078385/aframe-a-entity-template-data-thumb-transparency-not-working.  Are you talking about the component or the built-in [cursor component](https://aframe.io/docs/0.8.0/components/cursor.html#properties_rayorigin) using the rayOrigin property? Can you provide an example to reproduce and what you get vs. what you expect? Closing issue regarding mouse cursor: https://github.com/aframevr/aframe/issues/3754#issuecomment-417400062

The code above has some bugs (`aycaster`, mouse cursor being child of camera). Don't know how well mouse cursor would work as a child of a camera on a polyfilled device. Can create new issue if there is an example with code without errors.  Thanks! üëç  I'm OK with this ‚Äî I think we could just add the option to the scene [renderer.js](https://github.com/aframevr/aframe/blob/master/src/components/scene/renderer.js) component?  Thanks üëç  **Description:**

Regression from https://github.com/aframevr/aframe/commit/e0c8ff7e4233e8554d56bf6147025d8cf40e636e

- A-Frame Version:
- Platform / Device:
- Reproducible Code Snippet or URL:

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Doesn't sound like a bug in A-Frame. You can file a new one. netpro2k mentioned it might be a physics issue.  I encourage to open the question on StackOverflow. It will get more visibility. We use github issues for bugs and feature requests.  This is a utility that can be called optionally. It's extremely useful, and reduces bugs by today's components never cleaning themselves up. Rather than:

```js
{ 
  init: function () {
   this.bindMethods();
  },

  bindMethods: function () {
    this.click = this.click.bind(this);
  },

  addEventListeners: function () {
    this.el.addEventListener('click', this.click);
  },

  removeEventListeners: function () {
    this.el.removeEventListener('click', this.click);
  },

  pause: function () {
   this.removeEventListeners(); 
  },

  play: function () {
    this.addEventListeners();
  },

  remove: function () {
    this.removeEventListeners();
  },

  click: function (evt) {

  }
}
```

We do:

```js
{
  click: utils.bindEvent(function (evt) {

  })
}
``` It could be an auto-magic option by default, though there's less magic in calling it manually. I usually lean towards explicitness since it encourages understanding. Sometimes you don‚Äôt want to for instance remove event listeners on pause and only on removal. bindMethod will make all those decisions black boxy. I think plane, explicit, simple code is specially important in the core. It makes it more accesible since it requires less context to understand. It's explicit because you explicitly call it. It only does those behavior if you use it. You run into bugs if you *don't* use it. Components rarely clean themselves up. What is black boxy is the proposal of a magic flag or overriding addEventListener.  Sentences starting with But are fine, it sort of changes the meaning the the message, but will just merge anyways.  If one wants to reset the value to a previously set position the component is not updated:

```javascript
el.setAttribute('position', '3 3 3');
el.object3D.position.set(5, 5, 5);
el.setAttribute('position', '3 3 3');
```

The oldData value will be `3,3,3` and the second call to `setAttribute` won't have any effect. Really narrow edge case where it's not worth adding additional code paths to address. I' prescribe to choose one route over the other, strongly towards the `object3D` API. Yep, I filed because the bug hit me so not a crazy use case üòÑ I had an entity pool and one component was requesting entities and reseting the position with `setAttribute` at no effect while other components manipulate object3D directly. The sequence illustrated above can occur across different components. We cannot guarantee consistency of use  `setAttribute` or object3D direct manipulation specially when using 3rd party components.  @arpu setAttribute won't be deprecated because it breaks the API consistency. object3D direct manipulation is just the recommended way for perf reasons. Also because it's just more ergonomic. Change an axis individudally by changing a number, having access to the three.js Vector3/Euler suite for operations, vector copying and cloning, world-to-local space and vice-versa transforms. Can fix the bug, but would prefer to see setAttribute use for pos/rot/scale eradicated. Eliminating setAttribute for position, rotation, scale is probably premature. A lot of 3rd party components rely on it. It's also good to keep the same consistent API to update all components and leave object3D manipulation as a power user feature. Yeah, not deprecate it...but would like to see it become a 100% adopted practice.  You can write a component that updates the material or texture (advance the frame, then set like `textureNeedsUpdate = true`.  I'm okay with requiring from `src` if it's just for debugging A-Frame installed through npm. Otherwise, the alternative is to go thru `git clone`, `npm install`, `npm link`, and then build the `dist` on every change.  A-Frame can be imported with a single script tag `<script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>`. For 3rd party components I don't see a practical way to enforce using EcmaScript modules. A-Frame does not favor any pattern or toolchain. Developers usually distribute the code so it can be imported via a script tag or consumed via npm but nothing is preventing the use of EcmaScript modules as well. It's not clear to me what can be done on the A-Frame side. Suggestions are welcome
 Yeah, no need to make anything changes (not sure what specific changes are proposed).

ECMAScript modules seem only available on the newest version of browsers too. It will take time for it to be able to be adopted in production.  @primedcore FWIW Neither https://vivid.unit9.com/ nor https://konterball.com are made with A-Frame and use old versions of THREE and the WebVR Polyfill. The authors need to update to more modern versions. Nothing we can do from the A-Frame side. I tried with Chrome for Android 66, 68, 69 and 70 on a Pixel 2 and cannot reproduce any of the issues described with the A-Frame examples: https://aframe.io/aframe/examples/

@Gauzz What phone are you using? Can you double check that you are on Chrome version > 66?
 @primedcore Can you check your Chrome browser version? What device?  @primedcore I think that the problem you're describing is also different than the original filed issue where the gyro does not seem to work. Can you open a separate issue? @Gauzz Can you check this URL? https://aframe.io/aframe/examples/showcase/anime-UI/ That‚Äôs weird. if any restriction I would expect it to be applied to HTTP over HTTPS What about this sample: 
https://webvr.info/samples/03-vr-presentation.html?polyfill=1 What about this one? https://immersive-web.github.io/webvr-polyfill/examples/
  thanks!  should be fixed  they're meant to be more taken from 2D, not in VR. Could try to patch perhaps, but maybe be messy  Can you provide error messages, npm logs?  Good catch. Just corrected it  Thanks for reporting  Better to share a complete runnable simple example: Your particular file might no be loading, You might be attaching the event listener too late... Your approach seems correct with the info you shared. I also recommend opening a questions in StackOverflow. We use github issues for bug reports and feature requests. Also consider upgrading to A-Frame 0.8.2  This is a [duplicate](
https://github.com/aframevr/aframe/issues/354) It‚Äôs fixed in the master branch. Available here: 
https://rawgit.com/aframevr/aframe/6888165/dist/aframe-master.min.js  That was a change in Chrome that was accounted for in [0.8.2](
https://aframe.io/releases/0.8.2/aframe.min.js). Upgrade your application. Let us know if it‚Äôs still a problem.  Thanks for doing this. Just a minor comment and it's ready to go  Thanks! A small modification needed and ready to go.  Can you share a minimal example to
reproduce?  I'd link to the code versus the live example: https://glitch.com/~aframe-refraction-system

Don't worry about the test, thanks!  Thanks! Congrats on your first PR! ü•á   Not sure what build you are using in your fiddle but 0.8.2 works for me(https://aframe.io/releases/0.8.2/aframe.min.js). Example: https://jsfiddle.net/tg5qorkc/3/

Closing this and will reopen if this is still a problem I see. In the meantime. You could make your own build by taking 0.8.2 and applying (cherry picking) the canvas bound scroll fix:
``` 
git checkout v0.8.2
git checkout -b canvasBoundFix
git cherry-pick fb9024f229994477962
npm run dist
```  It's fragile to depend on non-public API and including directly from src. I have other ways to debug A-Frame than requiring from src in production.

If you want to debug directly with A-Frame, clone A-Frame repo, start the dev server, and a live build is ready at `http://localhost:9000/dist/aframe-master.js`. Or clone A-Frame repo, change package.json, and npm link. We could include `src`, but still exclude all the other crap. yeah  thanks!  I've fixed it. Somehow these Glitches are getting edited by someone, I've filed an issue on Glitch  Probably a fault of Chrome's policies https://developers.google.com/web/updates/2017/09/autoplay-policy-changes ... I don't particularly agree with them, it's what happens when VR is not a first-class citizen in a browser.

I believe if developers want to support video on Chrome, they need to register a listener to a click on the page then play the video.

I think Chrome should address it, it's not worth trying to make it work out of the box for A-Frame as we've seen the struggles on iOS Safari. There's not a strong focus for A-Frame to support all the video cases, but more full VR applications. So I think Chrome should either address it, developers work around it, or just leave a notice not supporting Chrome...or start targeting the rising class of VR-first browsers.  This is intentional behavior. WASD based locomotion in VR is motion sickness inducing. I recommend other mechanisms like [teleport](https://github.com/fernandojsg/aframe-teleport-controls). This is also a question better suited for [StackOverflow](https://stackoverflow.com/questions/tagged/aframe). We use Github for bugs and feature requests. For future readers:

See aframe-extras and https://github.com/donmccurdy/aframe-extras/blob/master/src/controls/README.md - you‚Äôll need to have an entity (‚Äúcamera rig‚Äù) wrapping the camera. This also applies for things like teleportation.  @viperphase1 Thanks. A PR is more than welcome if you have bandwith.   repeat is not a property of any THREE material but of [THREE.Texture](https://threejs.org/docs/#api/textures/Texture.repeat)  I can't reproduce the issue: https://glitch.com/edit/#!/rainy-jester?path=index.html:15:37

A complete example will help. Your HTML might not be well formed. Those warnings are innocuous and come from the `<cursor>` primitive that has a [ring](https://aframe.io/docs/0.8.0/components/geometry.html#ring) geometry. Your HTML switches to `sphere` geometry that does not have `radiusOuter`, `radiusInner` properties. You can avoid the warnings by writing the cursor in the entity form:

```
<a-camera look-controls-enabled id="cameracontrolers">
      <a-entity cursor="fuse: true" objects=".interactive" position="0 0 -1" geometry="primitive:circle; radius: 0.008; segments: 32" material="color: #fff; shader: flat"></a-entity>
 </a-camera>
```  Thanks! Congrats on your first PR!  You‚Äôre welcome to open a PR. Probably easiest is modify the clone function to treat arrays differently: https://github.com/aframevr/aframe/blob/master/src/utils/index.js#L120 Just to make sure. What I meant that in the case of arrays we should not clone them using `JSON.parse(JSON.stringify(obj))`. We should do a special case in the clone function to iterate ver the array. Something like this:

````
var newArray;
if (Array.isArray(obj)) {
  newArray = [];
  array.forEach(function (element) {
     newArray.push(element);
     return newArray;
  });
} else {
   return JSON.parse(JSON.stringify(obj));
}
````  Curved image should not make any difference when it comes to raycaster intersection.  It will help clarify if you provide a simple runnable example and a description of what you see vs what you expect. 

The raycaster gives the intersection point with the geometry in world coordinates. Is that position wrong?  Look at the network tab in Developer Tools and see what response is coming for your OBJ file. This error probably means the OBJ or MTL file is not at the URL you've referenced. There was a [similar issue](https://github.com/aframevr/aframe/issues/3686) opened two days ago. @wlhm1984 are you working on the same project? 

As commented in the other issue. Can you share your OBJ model? It seems your file is not well formed and you're getting a parsing error. I'm closing this since we keep Github issues for bugs and feature requests. For usage questions we rely on StackOverflow. You're also more than welcome to join the [Slack channel](https://aframevr-slack.herokuapp.com/) and repost the question for more visibility. 

  Thanks! Congrats on your first PR to A-Frame üéâ   Try adding `side="double"` ‚Äî https://aframe.io/docs/0.8.0/components/material.html#properties. 2D objects are rendered only once (i.e. from one side) by default, which is more performant.  @Giorat Thanks for noticing. Do you want to submit a PR with the docs? It should be almost copy paste from the [oculus touch](https://github.com/aframevr/aframe/blob/master/docs/components/oculus-touch-controls.md) one  Cool. Glad that it got fixed in THREE r94. Thanks for remembering writing the test and congrats for your first PR. Keep them coming ü•á   Can you share your OBJ model? It seems your OBJ model is not well formed. I will reply here but I'm closing this. We use github issues for bugs and feature request. For usage questions we use StackOverflow and you can share the link in the [Slack channel](https://aframe.io/community/#slack)  Thanks!  Yeah, unless we refactor the system and have some sort of forced dirty flag, they can't be updated with the same object.

An alternative is to flip-flop between two vector objects as you update.  Thanks! `if` is not terribly important. Just for Inspector for certain types of components.  Thanks!  Do you have any link / steps to reproduce? What browser? I cant reproduce with any of aframe examples on Windows Firefox / Chrome / Edge Glad it worked.   **Description:**

It's useful!

@Adam4lexander 

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Hey, got time to copy it in? Add as a separate module to `utils.js` in like `events.js` or `decorators.js`, then attach it to `AFRAME.utils.bindEvent`. Any more context about this? It‚Äôs hard to follow what this is for. The associated PR is adding a fair amount of code of complexity and the value is not obvious  > It seems to me that a proper fix would be for three to support setPoseTarget on WebXRManager

Yeah let's just wait for that. three.js's support is incomplete. WebXR is not going to ship until Q4 at least, and even then it's going to be incomplete (proper controller support). I'm sure Google/etc will address it in three.js shortly if they want to push WebXR and most WebVR sites are A-Frame based.  I see those gampads. `navigator.getGamepads` is populated by the browser not A-Frame. @kearwood @daoshengmu Do you know if Firefox is populating the gamepads list even if the controllers are not present in Oculus?  Thanks!  It will fire on the rig. `document.querySelector("#rig").addEventListener` Use a tick handler to detect changes in position, we've moved away from using pos/rot/scale components to manipulate pos/rot/scale, and instead using object3D directly, so that event may not always fire. https://stackoverflow.com/questions/38907857/how-to-listen-to-changes-in-the-rotation-of-the-camera-in-a-frame Replace position with rotation. Player will almost always be moving especially in VR. Better to just always listen rather than rely on events. Can store previous position if you want to compare  https://github.com/ngokevin/kframe/tree/master/components/orbit-controls  In the example you link to, WASD is working normally for me. Could you explain a bit more what issue you see? Simply pressing <kbd>W</kbd> briefly moves the camera far from its original position? Are you using a headset, too, or just a keyboard/monitor setup? Works fine. May sometimes glitch if computer is under a lot of load.  @Xrispy7 This should have fixed by https://github.com/aframevr/aframe/commit/aaa3bf0bf4e0dfc744e2964dc4c8f11b24620333

You can try the examples in master to verify: https://rawgit.com/aframevr/aframe/master/examples/

I'm closing but will reopen if the problem is not fixed  This perhaps belongs on the community page, next to the existing NYC entry (https://github.com/aframevr/aframe-site/blob/master/src/community/index.md), rather than the root introduction page on  the core steps to getting started with A-Frame.  I was able to reproduce the problem with the THREE example as well: https://threejs.org/examples/webvr_video.html

It does not seem to be specific to A-Frame @DigiTec Any known problem with the Oculus Browser + Video on the Go? Problem not exclusive to A-Frame.    What do you mean by marker? Is it a marker as defined in `ar.js`?  **Description:**

I was doing a non-recursive raycast, and defined some objects that had children. These children were getting added to the `objects` set due to the `flattenChildrenShallow`. So I had an entity with 700+ non-visible children that were toggled off, and they were getting added to the raycast set.

The original intent of the logic was to only add like `getObject3D('mesh')` and such. So rather than loop over children, loop over `object3DMap`. Makes the logic simpler as well.

**Changes proposed:**
- Don't add all of groups' children to `.objects`, only add `object3DMap` keys.

 r? @donmccurdy want to check it out since you did the initial flatten  Can you also try with Chrome Canary (m69) to see if it still reproduces?  Maybe we should just remove the whole preload logic for audio and video, letting it stream as normal?  Not sure, should have left a comment back then. You can try removing it or moving to a tock.  This is a proposal for a built-in post-processing API. Setting up post-processing in a comprehensive manner that works well in 2D and VR modes is not trivial to do. It requires tight integration with the render loop. A built-in effects API will help raise the visual quality of the content and will make very easy for everybody to experiment with the different effects while ensuring good performance. At first we would not have a public API for user defined effects since many are not suitable for stereo rendering. By providing the effects we can control how and what order are applied to guarantee consistent results and FPS. Once we settle on an API we can consider open it up. 

The API is built by defining `effect-` prefixed scene level components for each effect. The order they are applied is fixed and independent on how and when they are defined. e.g:

````html
  <a-scene effect-bloom="strength: 1.6" effect-sepia background="color: black">
      <a-box color="white" position="0 1.6 -2"></a-box>
  </a-scene>
```` 
This PR just contains a bloom and sepia effects but I will expand before merge. I would love to hear what effects people want to see first.

![bloom](https://d3vv6lp55qjaqc.cloudfront.net/items/140k132K2b0s1F3N3R1P/Image%202018-06-14%20at%208.57.28%20PM.png?X-CloudApp-Visitor-Id=222920&v=62ce6cbb) > This PR just contains a bloom and sepia effects but I will expand before merge. I would love to hear what effects people want to see first.

SSAO please! Having functionality based on a prefix and HTML attribute ordering is a bit magic. I would define the order `effects: effects-bloom, effects-sepia`. The order does NOT depend on attribute position. The order is fixed and will be documented. e.g: 1. tint, 2. vignette, 3. sepia, 4. bloom... it won‚Äôt be user configurable Sketchfab also has a fixed effects order: https://help.sketchfab.com/hc/en-us/articles/115000728943-Post-Processing-Filters?mobile_site=true  Let's try to fix the `text` component's reliance on same-name textures: https://github.com/aframevr/aframe/pull/3651. Otherwise this looks good to me. If that PR will take some time, then I'd prefer to merge this one and recommend that users use the `fontImage` path rather than relying on our inference of the image URL from the JSON filename.  It seems a Chrome issue with the permissions granted to a WebView. I found this reference: https://bugs.chromium.org/p/chromium/issues/detail?id=852543   Nice. I wanted this because, yeah, fullscreen on Macbook is a drain.

You don't have to build the dist for PRs, you can remove that.

Perhaps `renderer="maxCanvasWidth: 1280; maxCanvasHeight: 720"`? And I would make it so that if you enter VR, the height and width are ignored? I played around. I am not sure setSize helps with Retina. The size is already reported as 1440x900 and pixel ratio is 2. Setting pixel ratio to 1 seems like what you'd want to do for Retina? Don't know what that means, size larger than the screen. It varies between screens. My MacBook has a pixel ratio of 2, and it's OS-configured too, my Windows is at 1.25. Rather than maxSize, we should allow configuration of `renderer.setPixelRatio(maxPixelRatio)`? Also don't know how that plays with the VR renderer. Thanks! Let's see how it goes.  In the current version of `gltf-model` there is no option to specify the draco loader. You could certainly fork the component (https://github.com/aframevr/aframe/blob/master/src/components/gltf-model.js) and add those lines of code:

```js
THREE.DRACOLoader.setDecoderPath( '/path/to/decoder' );
loader.setDRACOLoader( new THREE.DRACOLoader() );
```

We could add this in 0.9.0, but it would be a breaking change since there isn't currently a `src` property:

```html
<a-entity gltf-model="src: foo.glb; dracoDecoderPath: /path/to/decoder;"></a-entity>
``` Does your model work on https://gltf-viewer.donmccurdy.com/? Glad it's working! :) Re-opening this as a feature request. I'd like to provide some way of using Draco while still using the `gltf-model` component. TBD if that is possible without breaking `gltf-model="foo.gltf"` single-property syntax.  There's something unusual about this model; it appears incorrectly in my native OSX quicklook plugin as well, and Cesium parses it as shown above in their converter.

You can try exporting differently from your tool (perhaps triangulate before export, if you haven't?). Otherwise the only thing that worked for me was importing the OBJ to Blender and exporting as glTF with https://github.com/KhronosGroup/glTF-Blender-Exporter. I don‚Äôt know, unfortunately. It could be that the model uses a rare OBJ feature, or is slightly incorrect in some way. Often OBJ models contain n-gons (faces that aren‚Äôt triangles) and this breaks some tools, and triangulation happens automatically when converting to glTF which fixes this.  This PR is empty üôÇ Closing this. Probably opened unintentionally  @ShashankaNataraj You'll need to create an A-Frame component for this, using [THREE.GLTFLoader](https://threejs.org/docs/#examples/loaders/GLTFLoader). Most likely you'll want to use the `.glb` version of a glTF model, which turns into an arraybuffer if you load it through Webpack.

```js
var el = this.el;
var loader = new THREE.GLTFLoader();
loader.load( buffer, '', function (gltf) {
  el.setObject3D('mesh', gltf.scene);
}, function (e) {
  console.error(e);
});
``` I recommend opening your question in StackOverflow. It will get more exposure. We use github issues for bugs and feature requests.  Thanks! Congrats on your first PR! üçæ   Oculus Go has a built-in Web Browser that can display WebVR content. https://www.howtogeek.com/wp-content/uploads/2018/05/img_5aebc7ad49d28.jpg Chrome for Android is also WebVR compatible. You should be able to use it with Daydream headsets  I left an answer in the other issue you opened (https://github.com/aframevr/aframe/issues/3633) Pasted below:

In VR mode the data from the sensors override your tap to move. Move a camera rig (parent of the camera entity). More info in the docs: https://github.com/aframevr/aframe/blob/master/docs/components/camera.md I also encourage to open usage questions on stack overflow. We use github issues for bugs and feature requests  In VR mode the data from the sensors override your tap to move. Move a camera rig (parent of the camera entity). More info in the docs: https://github.com/aframevr/aframe/blob/master/docs/components/camera.md  Does this work? 

https://rawgit.com/aframevr/aframe/master/examples/showcase/anime-UI/ What do you mean by move? A-Frame does not come with built-in locomotion in mobile. Try @donmccurdy movement-controls component https://github.com/donmccurdy/aframe-extras/tree/master/src/controls  In 0.7.0 A-Frame moved to glTF 2.0. Make sure your model follows the new spec. Archilogic uses an old version of glTF that we no longer support, yes. You may be able to use the `gltf-model-legacy` component in A-Frame Extras: https://github.com/donmccurdy/aframe-extras/tree/master/src/loaders  In your page you can place a-scene wherever you want or hide it like any other HTML element by using the [embeded component](https://github.com/aframevr/aframe/blob/master/docs/components/embedded.md) Mirroring is the default mode because its the simplest, most performant option. Showing something different would imply rendering the scene twice degrading performance in VR. You can opt into an alternative perspective by using a specator camera: https://aframe.io/docs/0.8.0/components/camera.html#properties_spectator An example of spectator camera:
https://glitch.com/~oceanic-market The link works for me. This is what I see

![shot](https://d3vv6lp55qjaqc.cloudfront.net/items/1N3c2a2w2s341N121A3g/Image%202018-06-08%20at%2011.53.20%20AM.png?X-CloudApp-Visitor-Id=222920&v=32e17a9b) The HTML is:
````html
<!DOCTYPE html>
<html>
  <head>
    <title>Hello, WebVR! - A-Frame</title>
    <meta name="description" content="Hello, WebVR! - A-Frame">
    <script src="https://rawgit.com/aframevr/aframe/master/dist/aframe-master.js"></script>
  </head>
  <body>
    <a-scene>
      <a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9" shadow></a-box>
      <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E" shadow></a-sphere>
      <a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D" shadow></a-cylinder>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4" shadow></a-plane>
      <a-entity camera look-controls position="0 1 0"></a-entity>
      <a-entity camera="spectator: true" look-controls position="0 1 0"></a-entity>
      <a-sky color="#ECECEC"></a-sky>
    </a-scene>
  </body>
</html>
````  Cool, thanks. We don‚Äôt want to merge failing tests. We can incorporate this once the problem is solved on the THREE side  What are you trying to accomplish? styleParse does not have any kowledge about schemas or datatypes. That function is the last step before asigning the value to the entitiy via setAttribute and after all the component schema parsing has been done. if your schema has a property called distance: { type: ‚Äúvec3‚Äù, default: ‚Äú0 0 0‚Äù}  the `AFRAME.utils.coordinates.stringify` will be called before `AFRAME.utils.styleParse.stringify` Yeah, stringify is just the basic CSS / style string parsing. It only parses a plain string fed from HTML.  Yeah, it's expected. The child and parent are their own entities. The events also bubble, use `evt.target` to get the specific target. `raycaster.recursive` property can also affect things.  I would circle with the THREE folks to see if it makes sense to enhance THREE.AudioLoader to fulfill your needs. Can you open an issue in THREE with a proposal and reference this issue to keep track?   Not sure I understand the problem. I just tried on Chrome 66 and 69 (Canary) on a Pixel 2 and the scene you pointed out enters VR mode as expected after enabling WebVR in `chrome://flags`. Can you describe exactly the steps you followed and what you expect vs. what you get?  Thanks!

Could you also PR this to https://github.com/spite/rstats?  To properly render languages like Hebrew or Arabic
  You could create hotspots with regular DOM elements positioned with 3D transforms but they won‚Äôt render in VR mode when used in a headset. I recommend using StackOverflow to ask questions. We use Github issues for bugs and feature requests.  Thanks! üëç   There‚Äôs not `right-to-left` support in the text component. I opened a more general issue: https://github.com/aframevr/aframe/issues/3612
Any community help will be more than welcome  https://stackoverflow.com/questions/38835415/how-to-defer-or-load-an-a-frame-scene-programmatically  Thanks This has landed?  Thanks! The site installs A-Frame through npm at different versions / branches for documentation. I think we just need to also allow `docs/` in as well for now, which shouldn't be too large. We used npm as a medium to install and copy documentation versioned from the GitHub repo. We could rejigger it to perhaps fetch and download the ZIP instead, but for another day.

The Markdown files (just flat files) shouldn't be included in applications if they aren't `require`d. So easiest to just leave `docs/` for now, and continue to wipe all else from npm. Will just live with a few Markdown files for now so we don't have to break the entire documentation system (or spend days rejiggering the build system and the bot). At least the examples are out. npm is messy, if there are libraries that suck in everything they fetch from npm, that's rough. Gonna merge for now and push a fix to continue to include docs, apologies if it isn't ideal yet!  **Description:**

https://stackoverflow.com/questions/50493717/how-to-get-aframe-to-only-upload-canvas-contents-to-texture-when-needed/50505535#50505535

Canvas textures was re-uploading to GPU every frame.

**Changes proposed:**
- Don't use VideoTexture for canvas...
 Good catch, updated. The linter is complaining Updated.  Thanks for reporting. Just tried your demo on the Go and I was hitting 55-60 fps consistently in 2D mode and performance in VR mode looks good to me as well. We need additional information on what you're observing. The perf tool has some overhead but the numbers I got is with the tool enabled. I don't see any issues with perf on the Go with the provided example. I'm closing this but will reopen if there's additional info.  Weights cannot just be added to fonts at display time in WebGL like they can in HTML ‚Äî I think you'll need to generate a font with the weight you need. See https://aframe.io/docs/0.8.0/components/text.html#generating-sdf-fonts. https://github.com/etiennepinchon/aframe-fonts  I cannot open the link that you provided to test. Can you provide another one?  **Description:**

The intersection in the event detail requires object creation. Pass a function instead. The intersection data is only used in certain and more involved cases and calling a function to get the intersection data is easy.

Can update docs if looks good.

**Changes proposed:**
- Instead of emit an object per intersection on tick, reuse the event detail, and offer `getIntersection` method to fetch intersection data. I think you still need to filter compute newly intersected entities / cleared for the `raycaster-intersection` and `raycaster-intersection-cleared` events, even if you ignore the `raycaster-intersected*` events. The raycaster-side events only get emitted on newly intersected or cleared events. Used sometimes when you want to know something is intersected. There is the cursor, but that only emits on the nearest intersected.

The only thing we'd save is some event emits. I don't think that has much effect. The loops and processing will be done regardless. If you aren't using the events, then I'd make your own raycaster. Rebased. Possibly, I think `getIntersection` is a bit more prescriptive / offers more guidance on what to do with the event. We could do both.  You have to put the script at the top so the A-Frame custom elements: a-entity, a-box... are registered when the DOM initializes. That‚Äôs how custom elements work. A-Frame does not scan / parse the DOM. Let us know if you have any other questions  Thanks.  Those examples you listed first are external demos we link that probably don‚Äôt have an up to date A-Frame. The A-Frame
built in examples live in https://aframe.io/aframe/examples/ and those should all work as expected  This is covered at https://aframe.io/docs/0.8.0/components/material.html#video-textures, I would add a link to there. Hey @wrjanan, can you update the PR to just add a link to above? `../components/material.html#video-textures`? Thanks! If you view it in GitHub, or npm run docs, you can test the link. It looks good!  Can you open a question on StackOverFlow and post it on Slack? We use github issues for bugs and feature requests. Not sure how `super-hands` works. Better to ask in [the original repo](https://github.com/wmurphyrd/aframe-super-hands-component). The A-Frame [tracked-controls](https://aframe.io/aframe/examples/showcase/tracked-controls/) example works as expected. In console:
![hand](https://d3vv6lp55qjaqc.cloudfront.net/items/3U2B2X101t2v0F43382k/Image%202018-05-14%20at%202.01.58%20AM.png?X-CloudApp-Visitor-Id=222920&v=3149d6b2)
 FWIW, the `super-hands` examples work also as expected. For instance: https://wmurphyrd.github.io/aframe-super-hands-component/examples/physics/
In console:
![super-hands](https://d3vv6lp55qjaqc.cloudfront.net/items/2r1U3n0O471a2U3K1D1P/Image%202018-05-14%20at%202.06.19%20AM.png?X-CloudApp-Visitor-Id=222920&v=cc9a819c)  You‚Äôll need to set `texture.flipY=false` when manually adding a texture to a glTF model.  This happens automatically for textures included in the model. Oops, I should have looked at the images before replying. Never mind about the "textures included" thing. Does this scene use a mirror modifier by any chance? This looks like a bug from previous versions of three.js. You may be able to manually fix this after import with something like:

```
var el = document.querySelector('#my-model');
el.object3D.traverse((node) => {
  if (node.isMesh) {
    node.material.normalScale.y *= -1.0;
  }
});
```  Some of the unit tests are failing with the change. Thanks for the PR. It looks good. One thing that you might want to consider. If you are calling `setAttribute` on a tick I recommend reusing the same object, the values will be considered trusted and type checking / parsing skipped altogether (https://aframe.io/docs/0.8.0/introduction/best-practices.html#tick-handlers) also reducing object allocation. For instance:
```javascript
init: function () {
 this.yourComponentData = {coords: {x: 0, y: 0, z:0}, enabled: true};
},
tick: function () {
  this.yourComponentData.coords.x += 1;
  this.el.setAttribute('your-component', this.yourComponentData);
}
``` If you are in a tick, better to just avoid setAttribute altogether. We should have the raycaster component update the origin/direction directly. We already do the object reuse, that only saves on parsing. Thank you. First PR achievement unlocked üéâ Congrats!  It's hard to unpack what you're seeing vs. what you're expecting with the given info. If you can share a simple runnable example that reproduces the problem it will be very helpful. I'm closing this due to the lack info. I will reopen if there are additional details  @bklava Is the result the same on the Oculus Browser?  What is exactly the problem? A PR for that would be welcome!  @j-conrad Did you by chance observe the same problem in any THREE example as well?  Thanks for sharing the info with us. Can you share a bit more detail? Any specific examples you can point? Do you mean text resolution? Are you referring to 360 video or real time 3D? I tested the A-Frame examples yesterday on the Go and they looked good to me. The examples in aframe.io have antialias disabled by default on mobile for increased performance. You can enable it in your experiences by doing `<a-scene antialias="true">` Cool. Yeah it seems to be missing from docs. FYI, it will be replaced in next aframe version in favor of the renderer component:

https://github.com/aframevr/aframe/blob/master/docs/components/renderer.md  Are you using a `cameraRig` property, as shown in the example? A code snippet or demo URL would be useful.

```html
  <a-scene>
    <a-entity id="cameraRig">
      <!-- camera -->
      <a-entity id="head" camera wasd-controls look-controls></a-entity>
      <!-- hand controls -->
      <a-entity id="left-hand" teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
      <a-entity id="right-hand" teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
    </a-entity>
  </a-scene>
``` You'll need to use a camera rig (just an entity wrapper around your camera) with `teleport-controls` in A-Frame 0.8. From the changelog:

> Remove VREffect / VRControls for three.js WebGLRenderer API. VR camera pose is managed by three.js.

The docs for `teleport-controls` have been updated to reflect this as well. In VR mode, the position of the camera is locked to the pose of the device. This solves many issues from previous versions, but also requires a change to your markup. The rig should be moved when animating or teleporting, rather than the camera.

If you find that isn't working well with `wasd-controls`, you may want to try `movement-controls` from aframe-extras instead, which has better compatibility in this situation: https://github.com/donmccurdy/aframe-extras/tree/master/src/controls#usage @WintermuteGermany I have created a simple glitch example using teleports and A-Frame 0.8.2 and a camera rig as @donmccurdy described: https://glitch.com/edit/#!/fixed-range

 I don't think there's anything actionable here on the A-Frame side. @WintermuteGermany If there's any usage questions besides the info we provided I recommend opening a question on Stack Overflow. @WintermuteGermany You‚Äôre welcome from a fellow Spaniard  Both dependencies are forked versions of the original, as some changes were necessary for whatever reason. I don't recall the particular changes, but things will likely break if they're switched to the npm versions. We also occasionally need to reference a forked version of three.js, although that's usually a temporary thing.

If these changes don't make sense to merge into the official packages, I think the best option would be to just put both dependencies in scoped npm packages.

This could be done on our end, as `@aframe/debug` and `@aframe/document-register-element` or by your company. Would defer to @dmarcos and @ngokevin whether it seems OK to do this on our side. There are a couple more in devDependencies ‚Äî are those not an issue for your security review? Ocasionally, we need to fix bugs or additional features in the dependencies and PRs in the original repos take time to be merged or are not accepted. 

Can you point your application to the bundled a-frame directly? https://aframe.io/releases/0.8.2/aframe.js

Another solution is to take those forks, publish them in npm yourself and repoint the package.json (as @donmccurdy mentioned)

Just curious, What are the security concerns about npm only dependencies? npm does not have any security or review process that I know of. I'm looking at scoped npm packages and we can definitively do it. Forked dependencies are an exception  . I feel pointing to github makes it clear and easier to follow through and see the changes. A package published on npm hides away the context and it's harder to trace back. A few issues / PRs and debugging have come from the community since the info is exposed in the package.json. @IntegersOfK We can definitively consider scoped packages but wondering if there's an alternative that we can explore that also works for you   @IntegersOfK Thanks for escalating the problem. It's the first time we've heard of such an issue. We'll look into it. In the meantime, I think the described solution will work. You can republish aframe yourself in npm with the dependencies also pointing to npm published packages. Would that fulfill all of your employer constraints? Is that an interim acceptable solution for you? Do you have a corporate npm account you can publish from? @IntegersOfK Even if we point now the dependencies to npm in master we would have to deploy a new A-Frame version and for that we would have to go through all the usual Q/A process. It will take us a few weeks to get there. If there's a way to republish A-Frame on npm things will move faster for you. Might simplify things if it's possible to skip devDependencies (e.g. `npm install --production`). Easier to deal with just two dependencies. Can confirm that at my company using an external CDN like `https://aframe.io/releases/0.8.2/aframe.js` would not be permitted. What about an internal CDN? @IntegersOfK Do you have an internal CDN where you can copy the A-Frame bundle where it's consumed from internally? @IntegersOfK That's awesome. Thanks for doing that work. I will definitively direct people with the same problem to your package.  This is due to changes / bugs in Chrome m65. Make sure you update to A-Frame 0.8.2 and Chrome m66. More info here: https://github.com/aframevr/aframe/issues/3476 @Lissy93 Upgrade to 0.8.2. It‚Äôs the latest published version:

https://www.npmjs.com/package/aframe

  Can you rebase? I pushed some fixes for the failing tests, then we can re-run the test suite. I think we added this a long time ago for a reason, so it has a little risk. We should have documented why that was necessary. We should avoid touching it if we can. Can we tell Babel somehow to ignore it?  Will merge, I think that was a no-op since yeah, browsers don't let you do that.   Can you share a complete runnable example with for instance glitch.com? There‚Äôs not enough context to see what‚Äôs happening  It is a design decision to keep the virtual and real horizon always aligned in magic window mode. You can copy `look-controls` and add the logic to pan with touch in the vertical direction. We don't use the polyfill panner in A-Frame. You have to modify the logic in `look-controls`:
https://github.com/aframevr/aframe/blob/master/src/components/look-controls.js#L285 @didacher if you are using the webvr-polyfill their repo is a better place to ask https://github.com/immersive-web/webvr-polyfill  Thanks for the ideas. In a cost-benefit analysis:

- As you said syntax is uglier and more verbose.
- We already have a [list of registered](https://github.com/aframevr/aframe/blob/master/src/core/propertyTypes.js#L11) types on a single place in code and docs. The list is not very long and most of types not often used. New users will still have to check [the documentation](https://aframe.io/docs/0.8.0/core/component.html#property-types) for details and more typing, uglier code for experts. 
- Extra maintenance to keep those lists up to date and greater risk of bugs. In the case of events specially there will be inconsistencies. We don't automatically collect all the events that all the components emit since they're not declared before hand (we could enforce event declaration). To emit an event you just call `el.emit('eventname');` anywhere in the code. We could manually collect the core events in a list but all 3rd party components would be missing. Potentialy confusing: Why are some of the events in the list and not others?

I see some of the value on protecting against typos but after consideration of the costs an implications not sure if the balance is positive.  @PlumCantaloupe Thanks for your suggestions. I'm closing but will reopen if you still think we need to revisit this.   https://github.com/aframevr/aframe/pull/3764  Got bit recently with an unexpected issue writing a component, thought I'd write it up for ideas...

The `nav-mesh` component needs the mesh from the entity it's attached to, and needs to account for transformations on its parents. I'd imagined this would be simple enough:

```js
AFRAME.registerComponent('nav-mesh', {
  init: function () {
    this.loadNavMesh();
    this.el.addEventListener('object3dset', () => this.loadNavMesh());
  },

  loadNavMesh: function () {
    const navMesh = this.el.getObject3D('mesh');

    if (!navMesh) return;

    const navMeshGeometry = navMesh.geometry.isBufferGeometry
      ? new THREE.Geometry().fromBufferGeometry(navMesh.geometry)
      : navMesh.geometry.clone();

    scene.updateMatrixWorld();
    navMeshGeometry.applyMatrix(navMesh.matrixWorld);
    this.system.setNavMeshGeometry(navMeshGeometry);
  }
});
```

Unfortunately this fails ‚Äî when `init` runs, the entity's parents do not have their position/rotation/scale applied yet, so `scene.updateMatrixWorld()` does nothing, and the transformation isn't applied to the Geometry.

Next I assumed `update()` would be a safe place to put the `loadNavMesh()` call, but it too runs before parents are initialized. I don't want this code to run on `play` (it shouldn't reload when the scene pauses) so instead I ended up with:

```js
tick: function (t) {
  if (t === 0) this.loadNavMesh();
}
```

Anyway, all of this was a little more complicated than I expected, and harder than component lifecycles in e.g. Angular. Saw this issue (or similar) called out as a [pain point compared to Unity recently, too](http://portfolio.anthony-scavarelli.com/2018/04/24/thoughts-on-multi-user-vr-development-using-unity-and-aframe-webvr/):

> Have to wrestle with asynchronicity issues that you generally don‚Äôt run into with Unity (e.g. why is this model loading BEFORE something else it is dependent on ‚Ä¶)

Anyway, I don't have a concrete proposal at the moment but wanted to think about tightening up component lifecycles in a future version and documenting clearly what component authors should expect. Initialization order is from children to parents. When `init` and `update` run for an entity all of its children have initialized but not the other way around. You could listen to the `loaded` event on the parent to get initialized. Asynchronicity is more a general problem of the Web than specific to A-Frame due to the single threaded JS context. I think the problem is more complex than that. Using the `loaded` event gets complicated when you need to consider:

1. component may be attached before or after scene has loaded
2. component may be attached before or after entity has loaded
2. component may be attached before or after entity's mesh has loaded
3. component itself may have async behavior

I don't see asynchronicity as a problem, given ways to direct async program flow, but currently I do some guessing and rely on undocumented behavior that can and has changed over time, like exactly when `update` will initially run. It's overkill, but see the much more granular initialization hooks that Angular provides:

- ngOnInit 
- ngAfterContentInit
- ngAfterContentChecked
- ngAfterViewInit
- ngAfterViewChecked
- ngOnChanges

https://angular.io/guide/lifecycle-hooks

They also provide a clearly-documented order for all hooks:

![peek-a-boo](https://user-images.githubusercontent.com/1848368/39227377-26c6083a-480d-11e8-98ff-b4982c0d4372.png)

I don't know React or Unity, but I believe they have some additional controls here as well: https://docs.unity3d.com/Manual/ExecutionOrder.html

The fact that I can't know the initial _position_ of my entity until the first `tick` has already begun seems like a hazard. I don't think we should rush into any changes here, but I do think it's worth considering whether we can make things more predictable for component authors.
 You could move the component up the tree, or run it on play with a check
that it only runs once, run it on scene loaded, or manage it in a system.
It's fairly common even in web development to write event listeners to wait
for something to happen first (e.g., DOMContentLoaded).

> The fact that I can't know the initial *position* of my entity until the
first tick has already begun seems like a hazard.

Seems like you want to know the position of the parent entity, no? The
position component initializes first if present.

We could add more hooks if we need, but wrote like apps with dozens of
components, haven't run into something where there wasn't a clean solution
(usually using events).

I think we have an issue open for allowing dependencies on components with
an event (e.g., depend on model loaded), though can be accomplished with
event listener, haven't felt too much need to add more API.

Any specific improvements or areas of documentation suggestions welcome.

On Tue, Apr 24, 2018 at 10:19 PM Don McCurdy <notifications@github.com>
wrote:

> I think the problem is more fundamental than that. Using the loaded event
> is a pain, and gets complicated when you need to consider:
>
>    1. component may be attached before or after scene and entity have
>    loaded
>    2. component may be attached before or after entity's mesh has loaded
>    3. component itself may have async behavior
>
> I don't see asynchronicity as a problem, given the ability to control
> program flow, but currently I do some guessing and rely on undocumented
> behavior that can and has changed over time, like exactly when update
> will initially run. It's overkill, but see the much more granular
> initialization hooks that Angular provides:
>
>    - ngOnInit
>    - ngAfterContentInit
>    - ngAfterContentChecked
>    - ngAfterViewInit
>    - ngAfterViewChecked
>    - ngOnChanges
>
> https://angular.io/guide/lifecycle-hooks
>
> They also provide a clearly-documented order for all hooks:
>
> [image: peek-a-boo]
> <https://user-images.githubusercontent.com/1848368/39227377-26c6083a-480d-11e8-98ff-b4982c0d4372.png>
>
> I don't know React or Unity, but I believe they have some additional
> controls here as well: https://docs.unity3d.com/Manual/ExecutionOrder.html
>
>  I don't think we should rush into any changes here, but I do think it's
> worth considering whether we can make things more predictable for component
> authors.
>
> ‚Äî
> You are receiving this because you are subscribed to this thread.
> Reply to this email directly, view it on GitHub
> <https://github.com/aframevr/aframe/issues/3556#issuecomment-384163696>,
> or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AApLpx8cbu1Mtkn_xITu3nUDeGUfvnZMks5tsAdzgaJpZM4TiupO>
> .
>
-- 

Kevin Ngo
ngokevin.com
 @donmccurdy In your case above I think it would be sufficient to do:

```this.el.sceneEl.addEventListener('loaded', () => this.loadNavMesh());``` 

This way all the entities all the way up to `a-scene` (that can influence the position of your entity) are initialized.

If you can describe other scenarios we might offer solutions with the current APIs. We could then collect the best practices in the docs. Oh I see. You might need to do in `this.loadNavMesh`:

```js
 init : function () {
    this.el.addEventListener('object3dset', () => this.loadNavMesh());
 },

  loadNavMesh: function () {
    var sceneEl = this.el.sceneEl;
    // Postpone if scene has not loaded
    if (!sceneEl.hasLoaded) { 
      sceneEl.addEventListener('loaded', () => this.loadNavMesh());
     return;
   }
   ...
  }
``` > I find the "loaded" event is a bit of a misnomer as it doesn't account for the actual content within the entity being loaded (i.e. a model and its associated textures/materials are not necessarily loaded as well).

An entity can always be loading things at any time, the `loaded` event is for loading all of its components and attaching onto the tree. Maybe it's better to use granular events and listen to what's needed than a catch-all loaded event that tries to consider every thing. I suppose we can introduce a way for components to hook into the loading process.

> When building a couple of components that accessed materials/meshes I had to approach similarly to Don's tick method. I see there is an "object3Dset" event I can listen to but that also doesn't necessarily mean the material is set correct?

There's a `materialtextureloaded` event. 

> Also, what about use cases where there are multiple dependencies within the ThreeJS layer. I am just getting to understand promises in js but how would we approach this within an asynchronous event-driven model (without having to resort to a bunch of questionable booleans in a tick)?

The `tick` boolean isn't a recommended solution. three.js has callbacks anywhere where asynchronous, and from A-Frame, there are always events that can be used to hook into anywhere. 

> Are some of these issues related to trying to maintain two areas where setting properties can take place: setAttribute(...) as position/scale/rotation as attributes vs. setting them directly to the object3D.position.set(...)?

Not really, they do the same thing. Perhaps components can have like a `async: true` property, and it has to call `this.load()` in order for the entity to be fully loaded. For like models. Though will cause inconsistency, some async components will adopt it, some won't. 

It seems more explicit to wait for a `modelloaded` event versus a general `loaded` event. And it won't block further initializations and such. Yeah. It's actually probably better not to force it to allow other things to happen while a model is loading, and anything that needs that model listen to the specific event.

Did you try to look it up somehow? Or we just need to put a disclaimer somewhere to read events in component readme? Or describing the async nature somewhere? Hopefully we covered bases with:

[Googling for example `aframe listen texture`](https://www.google.com/search?q=aframe+listen+texture`) and near beginning of [material docs](https://aframe.io/docs/0.8.0/components/material.html#events). It doesn't seem like that information is too far out of reach. > Seems like you want to know the position of the parent entity, no? The position component initializes first if present.

You only have local position until `play()` or `tick()` is called. The entity could have N ancestors all with transforms, and to account for that you need their positions/scales/rotations to have been applied. World position is simply not available in `init()` or first `update()`.

> We could add more hooks if we need, but wrote like apps with dozens of components, haven't run into something where there wasn't a clean solution.

The points i'm describing here are easy to avoid when writing a particular app, but hard to do right if you want your component to work robustly in other people's scenes. E.g. many, many community components become buggy if you start adding parents with transforms around them.

> this.el.sceneEl.addEventListener('loaded', () => this.loadNavMesh());

You're correct that this would work IF the component is never added dynamically, but again, I would be more comfortable doing this if lifecycle order were documented. I assume it's  `init -> update -> emit:loaded -> play -> tick`?  But it's easy to imagine `update` and `loaded` changing places, or `loaded` not being available at all for components added dynamically, and I don't want to rely on undefined behavior more than necessary.

> Perhaps components can have like a async: true property, and it has to call this.load() in order for the entity to be fully loaded. For like models. Though will cause inconsistency, some async components will adopt it, some won't.

As an example, some of the most common questions and "bug reports" I get are related to users trying to do things before `model-loaded` or `body-loaded` have fired. I would gladly adopt `async:true` in these cases. Obviously there would be many questions about how that would work (does it delay traversing up the scene, or just block first render like `a-assets`?).

But, I'm not suggesting we rush into any changes here ‚Äî especially not before 0.9.0. Just want to brainstorm around some ideas. There are also ways I could imagine this being done with a helper system on top of A-Frame...

```js
AFRAME.registerSystem('async', {
  // ...
});

AFRAME.registerComponent('sword', {
  init: function () {
    var sceneEl = this.el.sceneEl;
    sceneEl.systems.async.awaitAll('mesh', 'body', 'material')
      .then(() => this.doStuff());
  },
  doStuff: function () {
    // ...
  }
});
```

The current API works well and it's possible to solve most any issue for a particular experience, but I think there could be things we could do (or document) to make it easier to write components that are more reliably reusable across many scenes. > I would be more comfortable doing this if lifecycle order were documented.

- https://aframe.io/docs/0.8.0/core/component.html#overview-of-methods
- https://aframe.io/docs/0.8.0/core/component.html#play

Suggested approach:

```
play: function () {
  if (this.hasSetupNavMesh) { return; }
  // ...
  this.hasSetupNavMesh = true;
}
```

I have also filed in the past to differentiate between scene initial play and a resume handler (Inspector).

Or better, if behavior depends on parent entities, the behavior should move to the parent entity or a manager.

About most of my components I develop within applications are application-agnostic and can be dropped into other apps. There's not much difference in building a component within an app and a robust reusable one. > About most of my components I develop within applications are application-agnostic and can be dropped into other apps. There's not much difference in building a component within an app and a robust reusable one.

If by "robust" and "reusable" we mean (1) can be added at any point in the scene lifecycle, and (2) can be nested under parents with position/rotation/scale, then many components fall short of this. My own physics components and controls code, for starters. Both `ngokevin/aframe-physics-components` and `kframe/components/geometry-merger` make exactly the mistake I'm describing above, assuming that world position is available during `init()`, and will fail when nested under parents not located at the origin. Maybe the easy steps would be:

1. Add a cute little diagram showing overall order of lifecycle methods and events.
2. I'll experiment with async flow in my own components and report back if anything interesting comes of it.  @deckewandboden Is this still a problem?  It's deprecated. If people use it, their scenes will break on every A-Frame update.  Can you update the docs? Probably three.js changed the behavior? This is a dupe. https://github.com/aframevr/aframe/issues/3551  It might be a change in three.js logic. But setting `objects` is best practice.

You probably don't have to manually refresh. > You probably don't have to manually refresh.

^Assuming A-Frame 0.8+. The raycaster should log something if you are using an `objects` selector it can't auto-refresh. They still auto-refresh with or without the selector. Yes, but there are some selectors that autorefreshing will not catch. E.g., if `setAttribute()` call is not serialized to the DOM. I just mean that you'll see a warning logged if you are using one of these selectors. > would it still not make the most sense for the raycaster to ignore an entity with visible="false" regardless of whether or not it qualifies as a raycaster object? 

I often have hidden raycaster targets to pad the click range (e.g., small targets). Often, you still want to trigger with invisible objects. I even have a `raycaster-target` helper component that drops a hidden raycaster target by width/height.

> If it's desired for the entity to not be visible while also being raycastable, material="visible: false;" can still be used. This seems cleaner to me than having to add/remove/replace query selectors.

Regardless, you want to use query selectors, else everything will be raycastable. Some things I do is I create a `raycastable` component that can be mixed in. Or `data-raycastable` with a helper component that toggles them on / off based on like what menu you're on. Or with the state component, `bind-toggle__raycastable`. I always limit exactly to what should be raycastable because it's expensive. 

Explicit > implicit in this case, especially as it involves performance and visibility of objects is not always a determining factor.

But yeah, docs should be updated with best practices. Been building complex menus and have mastered the art of the raycaster. Not anymore without hacking the component, it's best practice and prescribed to control what is being raycasted. What I propose wasn't showing off (I'm not a wizard), it is simple. Rather than depending on what is somewhat an arbitrary condition (visibility) and doing `object3D.visible = false`, do either like `<a-entity data-no-raycast>` or `<a-entity data-raycastable>` with `objects: [data-raycastable]` or `objects: :not([data-no-raycast]`.

If you are depending solely on visibility, it sounds like the app has no system in place to toggle what is being raycasted, and your app is raycasting every single object, which is a killer for performance. I think that's just three.js behavior. Regardless, you should *always* define `objects`, and *never* depend on visibility. It is consistent if you ignore the case where you don't define objects because that should be done, or perhaps even required.  Yes, this is causes by a Chrome bug. More info: https://github.com/aframevr/aframe/issues/3458  @dmarcos maybe forgot to bump npm dist when you built? Oh nvm yeah that's right. We bumped after  That's the right version for 0.8.2. Master has r91 That‚Äôs correct. 0.8.2 ships r90 + a couple of fixes. Master points to r92 @wjessup you can use master:

https://rawgit.com/aframevr/aframe/master/dist/aframe-master.min.js

Where did you see r92 in the docs? I don‚Äôt remember mentioning it  Congrats for your first PR. Almost ready to go! I made a few comments / questions. Looking good. Thanks! @kevinsimper https://rawgit.com/aframevr/aframe/master/dist/aframe-master.min.js @kevinsimper Did you get a chance to disable armModel? Does if work as you expect? Is not the native arm model already applied and passed to the gamepad pose?  +1 from me for providing a way of setting sRGB here. It should apply to `map` and `emissiveMap` but not other textures. See also: https://github.com/aframevr/aframe/issues/3509. The alternative to this approach would be setting sRGB on `map` and `emissiveMap` _by default_, as well as `gammaOutput=true`, but that would make a lot of breaking color changes for 0.9.0. That sounds like too much pain, IMO.

Despite the three.js terminology, I would suggest naming this option `colorSpace` rather than `encoding`, and using `sRGB` and `linear` as the values. Thank you. @ncode congrats for your first PR. A few changes and this is ready to go. Hey @ncode, want to make a few changes? Thanks! The linter is also throwing some errors. @donmccurdy does this approach still look good? i don't have much experience with colorspace and encodings. This is still correct, but I think i'd prefer to do something at the scene level (like https://github.com/aframevr/aframe/pull/3757) rather than putting a setting on every component in the scene. If we merge the other PR we should be able to close this. Thanks @ncoder, we're going to go with a scene-level solution.  When using a headset you want to honor the user head rotation or it will cause disconfort. It‚Äôs a design decision. What‚Äôs your use case? You can try wrapping the camera entity in another entity and write a component to rotate it. The samsung S7 is not daydream compatible so Chrome is using the polyfill code path. I cannot reproduce the problem on the iPhone. exiting VR mode renables touch panning. @azmarte look-controls does not implement rotation on x axis. Are you using your own component? @azmartone My understanding is that your problem is not VR mode but after exiting VR mode. threejs controlling the camera in VR mode should not affect you. If you are loading A-Frame scenes in iFrames you have to adhere to the policies (https, allow attributes)

https://github.com/immersive-web/cardboard-vr-display#iframes

Probably Chrome m65 / m66 have started to enforce it. Samsung Internet might not be complying

Do the A-Frame examples work? https://aframe.io/aframe/examples/   See https://aframe.io/docs/0.8.0/components/material.html#transparency-issues. Transparency requires some careful setup.  Glad to see it's working üëç   Cool! Would you mind adding to docs as well? `docs/components/material.md` in the properties table. Thanks! This will allow some nice effects, thanks! üéâ  Thanks: ea129666250f0b9a30e62946d78b286593e331d3  The position offset was not applied correctly for the oculus touch model. The orientation did not match the real world position of the controller. Introduced a `orientationOffset` attribute to be able to match any controller model with real world orientation. rotationOffset should be deprecated but I left it for backwards compatiblity. We can remove in 0.9.0 `rotationOffset` was introduced for the vive tracker and not used anywhere else. It is safe to remove in favor orientationOffset @machenmusik `hand-controls` uses `orientationOffset` now https://github.com/aframevr/aframe/pull/3537/files#diff-02099d98da3e9b5683f5a6ac5092aec4L173  Duplicate of https://github.com/aframevr/aframe/issues/3449 ‚Äî this will be fixed on upcoming release.  We check the userAgent string to discriminate Oculus Browser and Samsung Internet and flip isGearVR to `true`. Before Oculus Go that was a fair assumption because those browsers were exclusive to GearVR. That's not the case anymore.
  I think we can do the 0.8.2 release soon. There's only one more issue on the milestone: https://github.com/aframevr/aframe/milestone/9 Cool ^^  https://aframe.io/docs/0.8.0/components/look-controls.html#properties_touchenabled

Please use StackOverFlow or the Slack Channel (https://aframe.io/community/#slack) for questions. Github issues are for bugs and feature requests.  This breaks consistency because the approach won't work in VR mode when the pose of the camera is modified internally by the VRManager in THREE.  @machenmusik Any position and rotation in the entity will be overriden by THREE in VR mode. @machenmusik It's just a fact, I would ask three.js to provide an offset on the camera. I think given that, it seems reasonable to close. Thanks for digging into this! @dmarcos spent *a lot* of time on this, we know the pain :)  thanks!  There must be something specific
to those devices. Do you see any errors on the browser console? It sounds like a problem at the drivers level of your OS + device combo. Something might not be working at the shader level since it works for other OSs versions. Just curious. Is this THREE example rendering correctly: https://threejs.org/docs/scenes/material-browser.html#MeshStandardMaterial It seems the problem is deep in the guts of the OS / Drivers / Browser / WebGL
implementation. We cannot do much on the A-Frame side. I keep this issue open as a reference and to collect further info. If I have to bet is a problem with the shaders. The shader branch of the MeshStandardMaterial is hitting some bug in the OS / Device / Driver combo you have. @gabrielgrant Would you mind opening an issue on THREE.js too? No, I don‚Äôt the DB issue is related since also reproduces on THREE.js Let's wait and follow https://github.com/mrdoob/three.js/issues/14137. Not opposed to adding Lambert but there hasn't been much need for it, and there may be a simpler solution.

Does `material="flatShading: true"` (with standard shader, *not* the flat shader) make any difference here? As don said there has not been much demand for lambert. It would one more code path to maintain. It's a problem with the shader path for the standard material in THREE and your particular combo of device / OS / driver / firmware: 99% sure. Yeah, I was curious about `flatShading` because it compiles away one difference between standard and lambert but apparently that wasn't it..  Closing this temporarly to leave the issue for new contributors  Rather than removed it should be fixed since it's the example for embedded scenes  Can you do a sanity check locally? My bad. I meant the A-Frame examples: you do npm install && npm start and visit localhost:9000/examples I would go through all the examples to do a sanity check (not just the tests) since there are multiple things that can break. We are going to do a 0.8.2 minor release and it‚Äôs too risky. We will postpone bumping THREE until 0.9.0 but we can merge this into master after we cut 0.8.2 @arpu We will fix it. Can you work with your own build as a temporary solution? Point releases are for small fixes and bumping THREE is a big change that might introduce regressions and breaking changes in components. It's better to postpone to 0.9.0 to give time for regressions to surface. We can bump THREE on master right after 0.8.2 release so there's time to test it. Thanks!  @payamspot you did it good üôÇIt would be nice to leave it for someone that has not contributed yet. Are you ok with that?  We can take your PR if nobody volunteers @payamspot yeah, you know the drill already. Some people feel intimidated and having  some issues like this one are good to build confidence. You‚Äôre alredy in pretty good shape https://github.com/aframevr/aframe/pull/3530  This looks like a spam PR. It‚Äôs getting sofisticated.  Do you have access to console logs to see if there‚Äôs any error? Thanks for info  Thanks!  `controllerconnected` should not fire with Touch if `gearvr-controls` is the only component in your entity  A-Frame 0.8.0 brings in some upstream fixes to THREE.GLTFLoader that are technically correct, but potentially inconsistent with existing scenes and examples. Pre-0.8.0, `gltf-model` assumed all textures were in linear color space ‚Äî `material.color` and `material.src` still make this same assumption today. That's incorrect ‚Äî images are usually sRGB, and the glTF spec explicitly requires color and emissive textures to use sRGB.

Following best practice:

1. Textures are converted `sRGB` -> `linear` at the beginning of the fragment shader if the image encoding is set to sRGB.
2. Renderer calculations are done in linear space.
3. Renderer output is converted `linear` -> `sRGB` for the screen if `renderer.gammaOutput=true`.

By default in A-Frame and three.js, `renderer.gammaOutput` is _false_ and step (3) never happens. As a result, glTF models look darker than they should. Textures using `material.src` look mostly right, because we don't set the encoding to sRGB, even though the images usually are sRGB. So the colors are being treated as linear in lighting calculations, which practically isn't very noticeable.

User **danilo** in Slack created this PDF, which illustrates the problem nicely:

https://drive.google.com/file/d/1BRdCU9nDzUHOfDYYXdbAV1cMW60Md6uv/view

I don't have any quick answers on what we should do here... in short, I think the three.js defaults assume some familiarity with color spaces, and ideally we would abstract this away from our users, or at least provide some best practices as a reference for users who are going to care about matching a color palette precisely.

If we _were_ to change our defaults, here's a straw proposal:

* [ ] By default, set `renderer="gammaOutput: true"`.
* [ ] By default, set `src` and `emissiveMap` both to sRGB encoding. Perhaps provide `srcColorSpace` and `emissiveColorSpace` to override this, but I think those properties would be an escape hatch to restore legacy behavior and not otherwise useful.

The one thing this doesn't fix is `material.color` values, which are assumed to be already linear in three.js, and don't have an encoding setting. So either (1) we could provide guidance about converting an sRGB hex code to linear, or (2) we would automatically do this in the `material` component.

I'm also not sure what this all means for vertex colors...

My vote for first step would be to add `srcColorSpace` and `emissiveColorSpace` in a PR, verify that it improves outcomes, and then enable them without changing any defaults. It would be nice to have feedback from someone more familiar with color spaces and/or rendering pipelines. üôÇ
 Maybe an even more user-friendly option would be creating an option `renderer="colorSpace: sRGB"` that (1) sets `gammaOutput=true`, (2) sets `texture.encoding = THREE.sRGBEncoding` for diffuse and emissive maps, (3) automatically converts `material="color: <color>;"` from sRGB to linear space. This is a bit more complex, however, and user-land components would still need to convert any colors they create themselves. I recommend that we do all of the above except (3) in a future release.

- [ ] default to `gammaOutput=true`
- [ ] add `gammaFactor` property, default to 2.2 (_not_ 2.0)
- [ ] use `texture.encoding=THREE.sRGBEncoding` by default for diffuse and emissive maps

By doing all of these at the same time, we'll minimize broken scenes on upgrade ‚Äî images and models should appear a bit less washed out, but not significantly darker or lighter. Directly given colors like `material="color: #f00"` will appear lighter than before, but I'm not confident about changing that default.

EDIT: Unity has some really nice references on the differences in lighting when using linear or sRGB colorspace: https://docs.unity3d.com/Manual/LinearRendering-LinearOrGammaWorkflow.html For anyone stumbling across this issue before it gets fixed, here‚Äôs a hacky workaround to mark non-glTF images as sRGB:

```
sceneEl.addEventListener('loaded', function (e) => {
  sceneEl.object3D.traverse((o) => {
    if (o.isMesh && o.material.map)  {
      o.material.map.encoding = THREE.sRGBEncoding;
      o.material.needsUpdate = true;
    }
  });
});
```

Combined with `renderer=‚ÄúgammaOutput: true‚Äù` on the scene, that should give consistent and correct colors for all images in the scene. One possible first step here: https://github.com/aframevr/aframe/compare/master...donmccurdy:feat-colorspace

With that branch, users may write the following:

```html
<a-scene color-space="sRGB" renderer="gammaOutput: true, physicallyCorrectLights: true">
  ...
</a-scene>
```

Result:

1. All color-related textures loaded by `gltf-model` componen will have correct colorspace. (already the case)
1. All color-related textures loaded by `material` component will have correct colorspace.
1. Lighting (from upcoming glTF extension) will have correct attenuation.
1. Output to screen will have correct colorspace.

But that's not a backward-compatible change for most scenes. Vertex colors and `material="color: #ff0000"`  properties will appear significantly lighter in this mode, and that's hard to automatically fix. I'd suggest we make a correct mode available, as above, recommend it for users who run into these issues, and work toward using it in our own examples.

Things I'm still not sure about:

1. Could `gammaOutput: true` be combined with the colorspace option? Maybe, but you might want to use colorspace _without_ gammaOutput if you're using post-processing, too.
2. Should colorspace be a property of the renderer? Also maybe, but the `renderer` component doesn't load until after all of the `material` components, so it would be kind of hacky to get the right data at the right time.
  This is a limitation of iOS. A website cannot enter fullscreen unless you add the page to homescreen.  Sorry for that. I just bumped the examples. Let me know if it does not work. Latest stable is very bad because people will copy the examples, start using it, and then when A-Frame updates, everyone's scenes will break instantly. Deploying examples also is more than the script versions, includes all of the modifications to examples + any new ones. @machenmusik FYI You can easily try the examples of any version: https://rawgit.com/aframevr/aframe/master/examples/ (replace master with any tag or commit)
  @dsinni What do you think of this PR? Instead of looking for ```e.target.id```, you would look for ```e.detail.id```, and it will give you the id of the sound being loaded/ended, even if there are multiple sounds on the a-box.  Hi @Syedwaheed ‚Äî For help, please use Stack Overflow or Slack. We use this issues list to track bugs and features. Additionally, when posting your question in either place, you will need to provide more information ‚Äî code (or better, a demo) for what you've tried so far even if it's not working, and a clear description of what you're trying to do. The meaning of "frames" is not clear in your question.  The property side is part of the material component (https://aframe.io/docs/0.8.0/components/material.html#properties_side). It should be `material="shader: flat; src:#image; side: double"` Please reopen if this is still a problem   Hi @samrae7, please feel free! My feeling is that it should probably be a sub-property of the `material` component, like:

```html
<a-entity material="src: foo.png; blending: additive" />
```

where values are `none`, `normal`, `additive`, `subtractive`, `multiply`. I think it is OK to leave out three.js's "custom" blending modes for now.

@feiss does that sound reasonable for most use cases? https://github.com/aframevr/aframe/pull/3543  Thank you!  @vaibhav2203 Thanks for submitting. Can you describe what you are trying to accomplish with this PR?  Thanks! But this PR is invalid  When modifying `el.object3D.position` directly, incorrect/outdated TRS transforms are shown after calling `.flushToDOM()`. Not sure how much of a special case it's worth to fix this, but it would be nice for the debugging methods to work as expected here.

Example: https://jsfiddle.net/donmccurdy/gr2oo3um/ Ok no worries about the demo, I'm fairly sure it's 0.7 vs 0.8 causing the issue.  Thanks!  I restarted the tests Thanks!  This is a duplicate of https://github.com/aframevr/aframe/issues/3441 Thanks for filing When models do not appear, do you see network requests for them? Or any errors in the console?  try a-frame master, we removed the examples dir from the package and now pointing to three.js proper. perhaps it was trying to fetch all three.js repo.  It is a known constraint of THREE that it uses one eye Frustum for culling: https://github.com/mrdoob/three.js/issues/13236 @omgitsraven commented on https://github.com/mrdoob/three.js/issues/13236  In your tick method try the following:
```javascript
var renderer = this.el.sceneEl.renderer;
var vrModeEnabled = renderer.vr.enabled;
renderer.vr.enabled = false;
renderer.render( this.surfaceScene, this.surfaceCamera, this.surfaceTarget );
renderer.vr.enabled = vrModeEnabled;
```  Will be fixed by https://github.com/aframevr/aframe/pull/3475 Fix merged, will be solved on next ~0.8.2 release.  Talking in Slack, for clarity the second code snippet with `movement-controls` is a red herring I think; that's aframe extras and no current release of aframe-extras works with aframe 0.8.0 yet. Extra details... we're talking about a vrprimus VA4 device, which has a joystick included.

Are you sure you don't need any other components but `look-controls` to get this working in 0.7.1? And the joystick moves the camera around, not just rotates it? I'm not sure how `look-controls` would have moved the camera in 0.7.1 unless this device is faking 6DOF pose or something... The master branch of aframe-extras may work now, with a syntax like this:

```html
<a-entity id="rig"
          movement-controls
          position="25 0 25">
  <a-entity camera
            position="0 1.6 0"
            look-controls="pointerLockEnabled: true"></a-entity>
</a-entity>
```

But the core issue is that i don't know whether this device's joystick is generating gamepad axis events, dpad events, MouseMove events, or something else. If it did in fact work with only `look-controls` before, then it may be faking MouseMove, in which case aframe-extras will not help ‚Äî i'm relying on `look-controls` for mouse movement as well. üòê Oh, to clarify, if it was just rotating the screen (and not moving the player) before then it was probably causing either mouse or touch events... I think aframe-extras is unrelated here sorry.  Thanks! Welcome as a contributor! ü•á  This PR is not merging for some reason. Github displays an error: `You can't perform that action at this time.` @jason90929 Can you please reopen to see if it solves the problem?  Thanks! Congrats for your first patch!  Please see https://aframe.io/docs/0.8.0/introduction/faq.html#can-i-add-links-to-my-scene and https://aframe.io/docs/0.8.0/components/link.html. We ask that questions and requests for help use Stack Overflow or Slack ‚Äî this tracker is for bugs and feature discussion. And (to get helpful responses) you'll want to check those docs first and ask about parts you don't understand.  This is because the data is copied internally instead of holding a reference. The behavior you are getting it is what I would expect since type `array` in your schema is not the same as `Float32Array`. Was it automatically a typed array before, or only if `setAttribute` was called with a typed array?

Inclined to say the more consistent behavior in 0.8.0 is good, and we can recommend use of a custom property type definition where typed arrays are wanted. You can create your own `parse` and `stringify` property type definition.  Minor, but in logo clouds like this glTF ecosystem screenshot...

![screen shot 2018-03-19 at 8 47 36 am](https://user-images.githubusercontent.com/1848368/37606285-5a546048-2b52-11e8-8eba-abf945aaec7e.png)

.... the A-Frame "logo" (I think that's just the title from the website?) sticks out a bit. Maybe we don't need a logo per se, but an official version of the title with nice padding would be good for branding situations like this. Might also be interesting to try condensing the 3D hero "A" from the homepage into a smaller icon.

//cc @cvan  Couple at:

- https://github.com/aframevr/aframe-presentation-kit/blob/master/materials/sticker-aframe1.png
- https://github.com/aframevr/aframe-presentation-kit/blob/master/materials/sticker-aframe2.png

PR any there if anyone wants to propose more.  This is because `DeviceMotionEvent.rotationRate` units have changed from degrees per second to radians on Chrome m66
 @RaoelHulst The fix that @jsantell has mentioned has shipped already. Update A-Frame to 0.8.2 @jsantell do you think we can close this issue? You can try to build yourself. Clone the repo, checkout v0.5.0 tag, update package.json, `npm run dist`. YMMV @jonwaterschoot With A-Frame 0.8.2 and Chrome m66?  Thank you! üéâ   @DigiTec Thanks for the fix and the test coverage. Much appreciated üëç  Thank you!  That's a known Chrome bug that will be fixed in m66. See https://github.com/aframevr/aframe/issues/3458 Closing as a duplicate.  Thanks for filing. For position, rotation and scale you can modify the object3D directly:
```
 entityEl.object3D.position.x = 5;
``` You can serialize to string with like component.stringify or AFRAME.utils.styleParser.stringify Thanks for filing. Unfortunately while this may suck, we can't provide that sort of API. If that means Elm won't work well with A-Frame, I think that's how it is. For the purposes of building VR applications, Elm is not strictly necessary, and we won't be bending A-Frame to fit Elm or existing Web tools built for 2D Web. Will be closing, but happy to discuss further! We're not going to introduce, support, and maintain multiple redundant APIs/codepaths to do the same thing. The example given so far was for position which is a simple case. There are hundreds of components that can each have dozens of properties. It's messy to attach a ton of random nested properties onto the element namespace. And setting component properties have massive side effects that should not be represented as a simple JS property change.

Frameworks and toy integrations are cool, but I rarely see these apps go beyond the constraints of placing basic shapes and models.  I merge and I'll add docs  Confirmed. @ngokevin, this is an indirect result of optimizations in #3250 ‚Äî the `raycaster-intersected` event now only fires on _new_ intersections, meaning that `cursor` has outdated information when it fires a `click` event.

I think those changes to the `raycaster` API are reasonable; we shouldn't have events on every frame from the raycaster. What if we update `raycaster.checkIntersections()` to programmatically _return_ a copy of all current intersections, so that the `cursor` component can use recent coordinates? A further issue, in `cursor.onIntersection` we sort the intersections _in the current event_ and mark the nearest as active. if another nearer intersection is still active, it is incorrectly lost. See #3475.  Thanks!  Closing to consolidate these on a single issue: https://github.com/aframevr/aframe/issues/3458  Thanks   Maybe an I-Frame would be better?  See: https://github.com/aframevr/aframe/issues/3450 It fixes some long-standing bugs in which the camera's position would be "in the floor", or at 2x height, or drop into the floor after exiting VR etc., for various devices. Quite a lot of alternatives were looked at... see https://github.com/aframevr/aframe/pull/3327. 

We're aware it breaks some existing components, e.g. I'm in the process of updating aframe-extras to support the new VR API. But, I think the change is necessary. Could you look through the comments on 3327, especially https://github.com/aframevr/aframe/pull/3327#issuecomment-360019236, and see if this is workable for your case? The move toward having a camera "rig" and not just a raw entity is IMO positive, so I'd like to see if we can get contrib modules and documentation updated to match. https://github.com/aframevr/aframe/pull/3451 provides (some) documentation, are there other updates you‚Äôd suggest? I've added this to an 0.8.X milestone in the hope we can improve documentation and update some examples. Another note, I've overhauled the controls in aframe-extras for 0.8.0 and documented them here: https://github.com/donmccurdy/aframe-extras/tree/master/src/controls

^tl;dr `universal-controls` is now `movement-controls` and should be attached to a camera rig. The examples are probably similar to what other components should do as well. @mokargas do you mean using `look-at` to reorient the camera? Bit confused sorry. For `wasd-controls` and aframe-extras we'll need a way to get absolute rotation of the camera, haven't spent much time on that but `cameraEl.object3D.getWorldQuaternion()` seems like the place to start. > Probably a bit of a stretch to ask non-devs to discover if they are starting on v0.8 and install an updated look-at contrib or other contrib that requires camera rotation, but I'm not sure how to handle that.

Worth noting that this change is not strictly breaking billboarding, it was always true that `cameraEl.getAttribute('rotation')` returned only local rotation, and the camera might have been transformed by a parent. We've just begun _recommending_ use of a camera rig, which surfaces issues in components like `look-at` that didn't convert to world coordinate space.

But the main thing is to report bugs on the third-party components when they no longer work with current A-Frame. We try to avoid breaking backward compatibility but sometimes it is necessary.

I've proposed some new docs in https://github.com/aframevr/aframe/pull/3498, but feel free to suggest more clarifications!  0.8.0 was hot fixed on the CDN with a couple of small patches so everybody benefits without having to bump versions. On npm though we cannot hot fix and had to bump the version number.  Confirmed. Looks we broke this with the major VRControls -> WebGLRenderer changes in #3152. From your [comment on SO](https://stackoverflow.com/questions/49387640/how-to-disable-tracking-position-in-aframe/49389033?noredirect=1#comment85794332_49389033) it looks like `hmdEnabled:false` functionality was lost with #3152 as well... thanks all!  @jeanmatthieud  this should be fixed on master now. Can you confirm? @Kezzsim On the A-Frame side we won't be able to work around all of the problems introduced on m65. We will have to wait till the fixes are deployed in m66 to have everything working as before. @FeralRizvi Update to 0.8.2 @Adilmar are you using 0.8.2 As far as I know phonegap goes behind in the chromium version they use. If they are behind m66 then the bugs introduced in m65 will remain until phonegap catches up. @Adilmar You're probably on Chrome m66 or on a version older than m65 that's why it works, right? Phonegap might be shipping a Chrome version affected by the bugs described in this issue.  @eggybot what phone?  Thank you and congratulations for your first PR! üéâ   Thank you. Good catch.  Thanks for the PR. We can now close this  FYI @meatwallace The fork we use in A-Frame is r90 + 1 cherry picked commit to fix a bug in the raycaster. The PR you opened if it lands will be available on THREE r92 that A-Frame will pick up in the next release. In the meantime you can build your own version of A-Frame as you did. I don‚Äôt think there‚Äôs any action we have to take on the A-Frame side. Thanks all for investigating this I bumped three to r93 in master. Two options to try:

- Point your script tag to https://rawgit.com/aframevr/aframe/master/dist/aframe-master.js
- Point your package.json to `"aframe": "aframevr/aframe#8a203f475b3"`

Please let me know if the issue is solved. Is the issue still open in THREE then? Nice! Glad to hear that it got fixed in THREE r94.  Thank you!   You can do it in a parent entity because now threejs controls camera
rotation in VR mode.

On Wed, Mar 14, 2018 at 5:13 AM Lance Bailey <notifications@github.com>
wrote:

> *Description:*
>
>    - A-Frame Version: 0.8.0
>    - Platform / Device: ALL
>    - Reproducible Code Snippet or URL:
>    <a-camera id="main-camera" rotation="0 180 0"
>    user-height="0"><a-entity cursor="rayOrigin: mouse"</a-entity></a-camera>
>
> I use camera rotation to start looking at a specific direction when
> starting my scene.
> I just updated to 0.8 and the rotation option is no longer available.
>
> If this is by design, what is the correct way to handle initial camera
> rotation?
>
> Thanks
>
> ‚Äî
> You are receiving this because you are subscribed to this thread.
> Reply to this email directly, view it on GitHub
> <https://github.com/aframevr/aframe/issues/3450>, or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AApLp_8EJ83cVF22P_wgG06LyuXhHkwCks5teQltgaJpZM4SqUef>
> .
>
-- 

Kevin Ngo
ngokevin.com
 Proposed some wording: https://github.com/aframevr/aframe/pull/3451  Thanks, I had been seeing this issue on page reloads. Yeah, initializing camera earlier somehow would be nice.

Shouldn't enter VR wait for the camera to initialize, and then try to call again in this case?  Can you do the enter VR but defer the setPoseTarget?

On Wed, Mar 14, 2018 at 2:17 PM Brian Peiris <notifications@github.com>
wrote:

> @ngokevin <https://github.com/ngokevin> Enter VR can't wait because
> requestPresent needs to invoked in a stack that was initiated by a user
> gesture or by the vrdisplayactivate event (which typically happens if you
> were previously in VR and then refreshed the page or traversed to a new VR
> app).
> AFAIK, the only methods we have to wait for the camera (Promise,
> setTimeout, setInterval) will create a new stack that does not retain the
> original initiator.
>
> ‚Äî
> You are receiving this because you were mentioned.
>
>
> Reply to this email directly, view it on GitHub
> <https://github.com/aframevr/aframe/pull/3448#issuecomment-373177731>, or mute
> the thread
> <https://github.com/notifications/unsubscribe-auth/AApLpwWFba2d1ekZbUbJYa4NZxCfkdXyks5teYjYgaJpZM4SprKJ>
> .
>
-- 

Kevin Ngo
ngokevin.com
  Thanks! I think this is the same issue as https://github.com/aframevr/aframe/issues/3467, which should be fixed after https://github.com/aframevr/aframe/pull/3475.  Thanks! I'm not sure this is a FAQ or useful to know, don't want to make the FAQ too noisy. Unfortunately, will close this one as it's more of a nugget than an FAQ that simplifies to "josh named it". Thanks though!  Moving this to milestone 0.9.0 as the fix will require updating three.js. The alternative would be to include a patched version of `THREE.MTLLoader` without updating the rest of three.js. I think we should get 0.8.2 released without waiting for that, but would not be opposed to doing 0.8.3 with this fix if it seems urgent enough. +1 from me. I bumped THREE on master with the commit of the MTL loader fix. @wmurphyrd can you verify that it's working now? https://github.com/aframevr/aframe/commit/5d30e926859cf31129b2a5b101db14bca0d78c13

@donmccurdy nice new gravatar picture üòé   Thanks for staying on top of postprocessing and make sure it still works. Rebase needed @wizgrav This is almost ready. Since the main use of the tock method is for post processing it makes sense to pass the camera as a paremeter. What do you think?  Yeah, it changed to `evt.detail` to not have to create an object. I will update the release notes / change log. Thanks!  The plane is rotated 90 degrees on the x axis so it's perpendicular to the camera. That's why it's not visible. The following works for me on Firexox (https://glitch.com/edit/#!/languid-scissor):
```
<html>
  <head>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-plane position="0 0 -4" rotation="0 0 0" width="10" height="4" repeat="4 2" color="blue"></a-plane>
      <a-camera></a-camera>
    </a-scene>
  </body>
</html>
```
We will reopen if it's still problem.  Thanks for filing!

Yeah, primitives are an abstract wrapper around `<a-entity>` where the `setAttribute` is the vanilla DOM `setAttribute`. That's why we'd recommend using `<a-entity>` for more serious work. Or living with the setTimeout. Unfortunately, I don't think we'll be changing or making major changes to primitives to improve this.  Okay I will update the changelog to note the breaking changes and migration requirements. https://github.com/aframevr/aframe/commit/ea836cffe7a994882f17024e97d934ca2860be8e  Let's just keep all the strings and merge it.  Two work arounds:

1. If you are applying a color to the background use the background component on `a-scene`: https://aframe.io/docs/0.8.0/components/background.html#sidebar

2. You can build your own entity instead of using the `a-sky` primitive:

```
<a-entity material="src: #yourImage; side: back; shader: flat" 
                geometry="primitive: sphere; radius: 5000; segmentsWidth: 64; segmentsHeight: 32">
</a-entity>
``` @i3games The bug is fixed now on master and it will ship in the next A-Frame version. You can use the workarounds [described above](https://github.com/aframevr/aframe/issues/3428#issuecomment-372076295) or use the master branch in your application (https://rawgit.com/aframevr/aframe/master/dist/aframe-master.min.js) I've hot-patched the fix into 0.8.0. So check it now!  @dustinkerstein Thanks for the detailed info. 

So my understanding is that there isn't anything we can do on the A-Frame side and everything will work again once M66 ships. I leave this issue open as a reference and as a reminder to verify M66 when available.  Thanks foe filing. I suggest reopening this question on StackOverflow. We use issues for bugs and feature requests.  Thanks for filing. In these cases where you need to interact more with three.js, I'd just create the geometry you need in a component. Like...

```
AFRAME.registerComponent('my-box-geometry, {
  schema: {
    width: {default: 1},
    height: {default: 1},
    depth: {default: 1},
    vertices: {default: 8}
  },

  init: function () {
    var geometry = new THREE.BoxGeometry(data.width, data.height, data.depth);  // etc.
    var mesh = this.el.getObject3D('mesh');
    if (mesh) {
      mesh.geometry = geometry;
   } else {
     mesh = new THREE.Mesh();
     mesh.geometry = geometry;
     this.el.setObject3D('mesh')
   }
  }
});
``` Geometries aren't updated in A-Frame. They are recreated. If you receive an update to the geometry, update the mesh `mesh.geometry = newGeometry`. Oh, if you only need the segments properties. We would appreciate a PR to `src/geometries/box.js`! It would be a simple add. Sorry for the chase, I had mindset of doing most stuff in components so whenever I need something, I just make a component. https://github.com/aframevr/aframe/pull/3426  Hi @paperkettle, thanks for the suggestion and student feedback üôÇ For one option there is a [`cube-env-map` component in aframe-extras](https://github.com/donmccurdy/aframe-extras/tree/master/src/misc#cube-env-map).

> Allow gLTF & obj+mtl material overwrites from the material component

Somewhat related: https://github.com/aframevr/aframe/issues/3155. This behavior is what a lot of people expect, and it would be nice if it could just work, but it's a pretty large change. I would be curious to see if it can be added (either part of `material` or a new component) that doesn't require maintaining duplicate copies of the schema.

> Is maybe premature given talk of [this possible extension](https://github.com/KhronosGroup/glTF/issues/946).

I'm not sure that would be ideal for A-Frame, as you wouldn't want to include a different `envMap` with everything model.

Another idea would be adding a property to the new `background` component:

```html
<a-scene background="visible: false; addEnvMap: true; src: url(...);"></a-scene>
```

^Assumes we update `background` to support a texture.... right now it only allows color. The component doesn't really need to deal with loading models, it can just listen for `object3dset` events and add `envMap`. Example here: https://github.com/donmccurdy/aframe-extras/blob/99535cd878eb36cb25cdcda4a32a40eb248c990a/src/misc/cube-env-map.js It depends, but definitely there are lots of components that modify a model after it's loaded. If you use `object3dset` events for that, then you don't have to worry about what format the model was in.

Maybe A-Frame should have an `env-map`, maybe not, I'm not sure on that one. But in any case there will be many situations where you need a small component to modify a three.js object like that. :)  Thanks for filing. This is more appropriate for StackOverflow. We use github issues for bugs and feature requests  Thank you!   **Description:**

Everything is disappearing unless at the very edge of my right eye.

See latest: https://a-frobot.github.io/aframe/examples/boilerplate/hello-world/

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Broken after three.js bumps

https://github.com/aframevr/aframe/commit/56dc163e23bec610c46506b22818a5ed84678b69

or 

https://github.com/aframevr/aframe/commit/5f196765f329b9478b75fb5a9f5620eb3302812f Yeah   You cannot enter vr automatically. it has to be triggered by user gesture like a mouse click. Forgot to say `thanks for filing`, sometimes things pile up and one needs to cut corners üôÇ  Happy to wait for webvr-polyfill changes to fix this, since it is Chrome that have broken it from their side.  ‚Ä¶method is called when they change. We were holding a reference and the deepEqual test was passing and the update method was never called (fix #3403)

-
 This fixes the problem but introduces extra object copies when instantiating `oldData`. I'm open to alternative solutions.  Yeah, need to think of another way. The perf hit isn't worth it (also using a Object.keys/forEach/fn creates an array and function over for...in).

I'd say create a method of the line component to accept updates. Assumingly this would be for `tick`ed changes, we wouldn't want to go thru `.setAttribute` in that case. Bare in mind we are already instantiating and copying properties to oldData. Strings, numbers, etc. It is allocated memory that is also eventually garbage collected. This patch makes also copies of plain object attributes. In practice the performance won‚Äôt change much.  The problem is not exclusive to line either but to all the component that have vector properties so a specific method to line will not fix the bug. The getAttribute flow often doesn't matter because for most entities, we never need to retrieve the data, only set. For example, it would be rare to want to retrieve the opacity of an animating button. If we set start/end points of a line and want to keep track, then can store those a in vector in component controlling the line.

The pos/rot/sca was a good perf improvement, with a minor fix on Inspector needed because Inspector was depending on componentchanged event, which also isn't a necessary API. I just simply told Inspector to update the panel when the handles are used. Performance is #1 priority IMO, because sites are unusable otherwise.

this commit should be fine, but worth nothing setAttribute has some overhead that should be avoided on frequent operations. @fernandojsg If this PR lands, what other inconsistencies are you worried about? If you modify obj/rot/scale via `setAttribute` componentchanged should fire normally as before. It is only when you modify the object3D directly (which is an advanced feature) that the `componentchanged` is not fired because you bypass the `setAttribute` code path. This should be ready to go. @fernandojsg There are no inconsistencies that I'm aware of. If you modify the object3D directly, `getAttribute` / `setAttribute` will work exactly as before. See example below on: https://rawgit.com/aframevr/aframe/master/examples/showcase/anime-UI/
![getset](https://d3vv6lp55qjaqc.cloudfront.net/items/1j1f1u163v0r1s0u0S1C/Image%202018-03-05%20at%201.32.41%20AM.png?X-CloudApp-Visitor-Id=222920&v=eeda1851)  Thank you @brianpeiris üëç   Thanks for filing. A-Frame itself does not cover collision detection. This is a question more appropriate for StackOverflow. We use Github issues for bugs and feature requests.  To get a good answer on StackOverflow you will have to provide code samples and more details about the different solutions / approaches you tried. https://www.npmjs.com/package/aframe-aabb-collider-component  Hi @CPSuperstore ‚Äî before A-Frame has loaded, `getAttribute()` is just the [plain HTML .setAttribute](https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute), which always returns a string. After A-Frame loads, it is changed to return a JavaScript Object that is much easier to work with. If you want to log the camera's rotation you should wait until the scene has loaded and then do one of these:

```js
var rot = el.getAttribute('rotation');
console.log( rot ); // { x: 0, y: 0, z: 0 }
alert( rot.x + ' ' + rot.y + ' ' + rot.z ); // "0 0 0"
```  We save the reference to those objects in the `component.data` and when modified externally and passed to `setAttribute` the comparison with the old value will return that old and new are equal and the update method won't be called. The strange thing is that we have not caught this bug before. Does it reproduce on 0.7.1?  How about 0.8.0?  Is not that the expected behavior? The height of the camera should apply automatically if you make the hud a child of it. If you add 1.6 then the hud will be at `1.6 + the height of the camera` as you described.

 Ok... but going back to what you were trying to accomplish. If you want to head lock entities they should be just children of the camera. Is not that working as expected? Just tested on Oculus and both cone and text are headlocked for me on https://codepen.io/machenmusik/pen/QQJyXV @luiguild what device and version of A-Frame are you using?  Let's move the check, and we can merge, thanks!  Will redeploy.  Can someone translate :D ? Google translate hints a problem with click events on 3D models but that's everything I can extract  Good questions for Stackoverflow

1. see model docs
2. there's cursor="rayOrigin: mouse", otherwise no  `hand-controls` rotates the model a bit. It doesn't play well with laser-controls. 

Hand-controls are more for when you using pure 6DoF, laser-controls when you want support both 6DoF/3DoF. You can manually set the raycaster origin/direction in this case if you want to combine both.

It should feel right if you use pure laser-controls.

Tell me if this is not the case. Thanks! Yeah I think either copy/patching laser-controls is appropriate here since it's taking a path of combining with hand-controls. 

Can't set raycaster straight up because laser-controls will overwrite it on `controllerconnected` event. You could write a component that waits for laser-controls to set the raycaster, and then you overwrite that and set the raycaster.  pivot is deprecated, that's why you don't see in the documentation. We kept it around for the few that were still using it before removal. I don't recommend relying on it. @theraccoonbear It's better to use the scene graph to accomplish this. Example:

```html
<a-entity id="pivot" rotation="0 45 0">
  <a-box position="5 0 0"></a-box>
  <a-animation attribute="rotation"
               dur="10000"
               fill="forwards"
               to="0 360 0"
               repeat="indefinite"></a-animation>
</a-entity>
```  Thanks for getting this going! Could you remove `package-lock.json` from the PR? Curious how it got in, as it's on our `.gitignore` list. @greengiant83 not yet üôÇ I made several comments requesting some changes. Thanks for staying on top of it @greengiant83 https://github.com/aframevr/aframe/pull/3394/files We may want to enforce that `orientationEl` be a descendant (or direct child?) of the controlled element. If we don't, there are some challenges and footguns:

```html
<a-scene>
  <a-entity rotation="0 90 0">
    <a-entity id="ctrl" rotation="0 -90 0"/>
  </a-entity>
  <a-entity id="sceneWrapper" rotation="0 45 0">
    <a-entity id="cameraRig" wasd-controls="orientationEl: #ctrl" rotation="0 -45 0">
      <a-entity camera/>
    </a-entity>
  </a-entity>
</a-scene>
```

Now obviously that's a _bad idea_ I'm showing above, but:

1. If we call `getAttribute('rotation')` on the `#ctrl` element, we're only getting its local transform.
2. If we call `setAttribute('rotation', rotation)` on the `#cameraRig` element, we're updating its local transform relative to a _different_ element's world transform. 
3. We could fix all of this in code by using `el.object3D.getWorldRotation()`, but there's a performance cost to calling `updateMatrixWorld()` that I wouldn't want to pay on every frame.

tl;dr ‚Äî as nice as it would be to have a general solution for `orientationEl` isn't tied to a "camera rig" concept, we get into edge cases pretty quickly when using this feature for anything other than a camera rig. Better to limit our complexity for now, I think.

@dmarcos preference? My thought is to log warnings if this is used outside of a parent/child setup. Then, at most, we have to multiply `orientationEl`'s rotation by the `cameraRig`'s rather than going arbitrarily through the tree.

EDIT: Maybe we merge this to a branch and iron issues out in followup PRs? I guess that depends... do we want a faster path than `getWorldRotation()` if the camera is a child of the rig? What if the camera is a descendant of the rig at depth N > 1? Assume we want for the rig's movement in world space to be in the direction of the camera's heading in world space.

IMO, we should be opinionated. This gets complicated and slow for anything beyond a simple parent/child camera rig, so for now I would restrict what we attempt to support. Even with the basic rig we still have to handle the case where the rig is rotated independently, which isn't in this PR yet. I'm fine adding a warning for now. We can polish the API for 0.9.0. I have a couple of ideas to create an `<a-entity player>` or `<a-entity avatar>` component to simplify everything. FYI, I have updated aframe-extras (master branch) to do pretty much what we're trying to add to `wasd-controls` here. [Docs](https://github.com/donmccurdy/aframe-extras/tree/master/src/controls). It might be nice to converge on similar behavior. The syntax i've used is:

```html
<a-entity id="rig"
          movement-controls
          position="25 0 25">
  <a-entity camera
            position="0 1.6 0"
            look-controls="pointerLockEnabled: true"></a-entity>
</a-entity>
```

Where `movement-controls="camera: [camera]"` is the default binding. I'm trying to be pretty narrow about the camera rig use case, rather than a general "steer any object with any other object" type of thing. Haven't implemented proper handling of a rotated rig yet, going to leave that for future work. Remaining issues here: 

- [ ] Are we OK with the `orientationEl` naming? I slightly prefer either `heading` or `camera` but realize I'm bikeshedding now. Also, we haven't used the `*El` suffix elsewhere that I know of, e.g. raycaster uses `objects` rather than `objectEls`. 
- [ ] Need some basic handling for a rotated rig. If no one gets to it first I'll make the change in aframe-extras and then share a suggested implementation here. Is it necessary because you either using motion controllers, or you are using WASD, not both at once, so it's not needed to move the whole camera rig with WASD. WASD moving the camera seems sufficient. Other use cases? See discussion in https://github.com/aframevr/aframe/issues/3351, but yeah, technically this may not be critical... If I move around with WASD before connecting an HMD you'll be teleported back to the origin, so that's a bit unpolished, but not a huge issue. 

FWIW I've thrown out the rotation parts of `universal-controls` to just focus on locomotion, renamed to `movement-controls`, so it can be used alongside `look-controls` now. Depends explicitly on a camera rig setup. I don't know if that should influence our recommendations here. I'd like to steer people toward using a camera rig, and it makes that easier if `wasd-controls` exemplifies it.

But since nothing is technically broken now, maybe we should take this off the 0.8.x milestone and leave it to decide for 0.9.0?

**EDIT** Moved this to 0.9.0.  Try https://github.com/ngokevin/kframe/tree/master/components/animation We've deprecated a-animation. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.  Thanks!  I do not have Oculus Go to test. How is the Oculus Go controller. @frankolivier Does it have the same buttons than the regular GearVR remote? @mkeblx What do you propose to use instead of the string to discriminate between controllers and properly map buttons to actions? I don't have an Oculus Go to test on. @DigiTec Could you verify if Oculus Go is working now on 0.8.0? Thank you Oculus Go landed on master a couple of weeks ago. It will ship with the next A-Frame version. If you want to play with it now you can use a master build: https://rawgit.com/aframevr/aframe/master/dist/aframe-master.js
An example of responsive controls can be found here: https://rawgit.com/aframevr/aframe/master/examples/test/laser-controls/ @machenmusik  https://rawgit.com/aframevr/aframe/master/examples/test/laser-controls/  I think this example should remain "pointlight", registering "light" will throw an error as it's already defined. The intention here is to show how a user could create a new component for their particular needs. Maybe `area-light`, using `new THREE.RectAreaLight( 0xffffff, undefined,  2, 10 );`, would be a better example since that's not already provided by A-Frame? @donmccurdy is correct. Thanks for submitting @polygontwist You might have got confused with object3D named `light` which can be different than the component name. The example illustrate how to add / remove object3Ds on a custom component and it is named `pointLight` so it does not collide with the built in `light` component in A-Frame.    **Description:**

https://github.com/aframevr/aframe/commit/334cd7eb7fccceb036c421dfbaa802d289cd4505 (cc @dmarcos)

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
  Fixes #3382.

Testing with fonts created here: http://msdf-bmfont.donmccurdy.com/

```html
text="align: center; width: 6;
    font: /examples/assets/fonts/yahei.json;
    value: ‰Ω†Â•ΩÔºå‰∏ñÁïå;
    negate: false;
    shader: msdf;"
```

![screen shot 2018-02-09 at 11 12 25 pm](https://user-images.githubusercontent.com/1848368/36059512-b7b40850-0dee-11e8-8689-8af84b0f83fa.png)
 Thanks! The fonts in aframe-fonts would need to be updated too, they are generated from https://github.com/Jam3/msdf-bmfont, which is still using the old msdfgen version. Users reporting issues because of that: https://github.com/etiennepinchon/aframe-fonts/issues/1#issuecomment-352407302

I'm hoping my little web app can help out here, and let you generate just the character set you need (especially necessary for chinese users), but i need to [iron out some issues](https://github.com/soimy/msdf-bmfont-xml/issues/21) first. So, probably won't want to change the default for 0.8.0 I don't think.  +1 for mentioning this, although I might clarify it a bit:

> When using PNG images as cutouts or masks (where part of the image should be fully transparent, and the rest fully opaque), use `transparent=false` and set `alpha-test` to something like 0.5. @js-d-coder This almost ready. Are you incorporating the changes that @donmccurdy suggested? Would also use `material="alphaTest: 0.5"` versus the primitive form. Will address comments in follow up commit.  @johnshaughnessy Thanks! Have you tried the track-controls example to check that the hand animations still work as expected? wfm. Doesn't change the behavior much, but I guess this is more correct.  Wireframe material and look-controls should not affect each other. Can you share code that illustrates your problem?  I usually have most of my components have an enabled property that I flip on/off if I want to say turn off the tick handler or return early from event listeners. Then how those are flipped are up to the application. Perhaps try as a third party component and see how it goes.  I think this is a sufficient place to put it. If it becomes outdated, won't be too bad, and someone will probably fix it. Thanks! üëç   I've removed the angle pieces. thanks!  Use `shader: flat` or `shader="flat"` for some devices with i guess older/weird chipsets  @meatwallace Make sure you do `npm install` when using master because the `three` version pointed by the `package.json` has changed. @dmarcos The dist is built by the bot on each commit (whether using via the rawgit or npm), so the three.js version is up to date if they use master). Console says three Version: github:dmarcos/three.js#r89fix I think a workaround is to wrap the camera children in another entity. Does that work? @Plaritxu Have you tried with master?  @meatwallace Sweet! Thanks for veryfing.  Thanks! Congrats for your first PR. ü•á 
  @acm0055 Thanks. this is not A-Frame specific, it is how DOM APIs work. In order to set an attribute you need to pass a value: `el.setAttribute(‚Äúclick‚Äù, ‚Äú‚Äù) / el.setAttribute(‚Äúclick‚Äù, {}`  Can you share a link with the before and after? Have you tried `0.7.1`? The componentchanged event was throttled in 0.6.0 onwards. Instead, use a tick handler to read rotation changes. You should be reading every frame because the camera rotation always changes in VR.

I've edited my answer here: https://stackoverflow.com/questions/38907857/how-to-listen-to-changes-in-the-rotation-of-the-camera-in-a-frame  No. What is your use case? The way to insert logic in the render loop in A-Frame is via the [tick, tock](https://aframe.io/docs/0.7.0/core/component.html#tick-time-timedelta) methods of components. Github issues are for bugs and feature requests. Please, use [stack overflow](https://stackoverflow.com/questions/tagged/aframe) or the [slack channels](https://aframe.io/community/#slack) for questions  iPad and iPhone work fine. I don't have access to any Windows Tablet / Samsung Tablet to test. The only thing I can think of is the lack of DeviceMotion API available in the browsers running in your tablets. Does this example work? https://webvr.info/samples/03-vr-presentation.html?polyfill=1

You can add a vertical scrolling by writing your own component that implements the feature. Possibly related: https://github.com/aframevr/aframe/issues/3427 "scrolling" as in camera rotation, you can modify look-controls to allow it.

"scrolling" as in 2D page, you can set `<a-scene embedded="true">`  merged  Hadn't seen this before; that's awesome ‚Äî thanks! Would be awesome if the Vimeo React component was available as an A-Frame component. You'd still be able to use it from aframe-react like `<Entity vimeo={{url: 'blah'}}>`  Currently the `text` component supports only a single texture page. For chinese characters, even the most common ~1000 characters require 40 texture pages using an msdf bmfont generator. 

Related: https://github.com/aframevr/aframe/blob/master/src/components/text.js#L209-L211

Here is a zip with what should be the most common 1000 characters, in the Microsoft YaHei font:

[yahei.zip](https://github.com/aframevr/aframe/files/1666534/yahei.zip)


```
npm install -g msdf-bmfont-xml

# simple test
msdf-bmfont -f json yahei/yahei.ttf -i yahei/charset-test.txt --pot --square

# 1000 characters
msdf-bmfont -f json yahei/yahei.ttf -i yahei/charset-1000.txt --pot --square
```

Related: https://github.com/aframevr/aframe/issues/3343 As long as I keep the charset small, this method does work:

![screen shot 2018-01-25 at 7 46 54 pm](https://user-images.githubusercontent.com/1848368/35424446-8d2b6d9a-0208-11e8-896f-eec3f7e3eb61.png)

Should also point out that those 1000 characters are 2.4 MB in this format, so users may still need to generate these fonts specially for each scene unfortunately. That sounds like a good option. Anyone have thoughts on whether:

1. canvas can be a fallback option within the `text` component
2. a second text component should be available in A-Frame
3. we should add an FAQ entry about options for intl text, linking to outside components like [aframe-canvas-text](https://github.com/ejeinc/aframe-canvas-text) and [aframe-text-geometry-component](https://www.npmjs.com/package/aframe-text-geometry-component)

SDF is the default now because it is performant and looks nice, but it is unfortunately harder to use with some languages. > Apparently, game devs generate fonts with the exact characters needed for a given script. I'm not sure if supporting every character is feasible.

Hm yeah that sounds realistic. It would be nice to have a web-based tool where you can autogenerate that JSON for some common free fonts automatically, with your own charset. Unfortunately getting `msdf-bmfont-xml` running on the cloud seems to be a bit inconvenient. :/ I've put together a little web tool for generating these MSDF fonts. It will support special characters correctly, and you can provide your own fonts if you wish.

http://msdf-bmfont.donmccurdy.com/

^note, this requires the `negate: false` setting on A-Frame's `text` component, which is only available on the master branch and will be released with 0.8.0. Will have http://msdf-bmfont.donmccurdy.com/ be the soluton?  Note that antialiasing is a setting you can control, have you tried putting `antialias="true"` on the scene? see also https://github.com/aframevr/aframe/issues/2666, i'm not sure where/if it is documented how antialiasing behaves by default. 

Also I suggest checking the model against a "just threejs" viewer like https://github.com/aframevr/aframe/issues/2666, as Sketchfab's viewer is highly customized and will not necessarily match our results.

There are also some z-fighting artifacts in all versions, but those are part of the model itself. We prioritize performance over visual fidelity. That‚Äôs why antialiasing is disabled by default. Sketchfab is a single model viewer with limited interactivity so they can make different choices.  `antialias="true"` does force it, you may be seeing just low resolution for other reasons? see https://github.com/immersive-web/webvr-polyfill/issues/273 and https://github.com/immersive-web/cardboard-vr-display/issues/7 ...there are some issues on Samsung phones, manually setting resolution in phone settings may help.  Can you share a link to your example? What browser / OS?  After #3327, it will often be preferable for `wasd-controls` to move the camera rig rather than the camera itself, relative to the camera heading. Similar to `teleport-controls`, we should add a `cameraRig` property to enable this:

```html
<a-entity id="cameraRig" position="25 100 25">
  <a-entity id="head" camera position="0 1.6 0" look-controls wasd-controls="#cameraRig;"></a-entity>
  <a-entity teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
  <a-entity teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
</entity>
``` Instead of coding this in the component I would provide examples where we use the camera rig pattern. The controllers and camera wrapped in an entity where the wasd-controls is applied:
```
<a-entity id="cameraRig" position="25 100 25" wasd-controls>
  <a-entity id="head" camera position="0 1.6 0" look-controls></a-entity>
  <a-entity teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
  <a-entity teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
</entity>
``` The problem with this pattern is that `wasd-controls` will always move in the `-Z` direction when pressing <kbd>W</kbd>, rather than matching the `#head` element's heading. An alternative to the `cameraRig` selector would be a `camera` selector to specify the element used to determine heading. How about this as proposed syntax, then:

```html
<a-entity id="cameraRig" position="25 100 25" wasd-controls="camera: #head">
  <a-entity id="head" camera position="0 1.6 0" look-controls></a-entity>
  <a-entity teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
  <a-entity teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
</entity>
```

The `camera` selector could default to `''` (for current element). The position of the camera will be overridden with the headset position, hence the need of a camera rig But the position of the camera is saved when entering VR and restored when exiting so you should get your `0 1.6 0` back  I have not tried that specific example but https://aframe.io/aframe/examples/showcase/tracked-controls/ works fine for me on a Razer Blade 13" with also NVIDIA driver 388.59 My windows version:

![winver](https://d3vv6lp55qjaqc.cloudfront.net/items/291D3U1R1c1e221W3a1b/Image%202018-01-23%20at%201.57.37%20PM.png?X-CloudApp-Visitor-Id=222920&v=d97ece4d) I'm closing this since it seems it is not specfic to A-Frame. We will reopen if there's any action to be taken on the A-Frame side.  Does it work on a regular browser on the Amazon Fire? You will have to figure out how to access to the browser console for phonegap and see if there are any errors. I don't know much about Phonegap and I don't have access to an Amazon Fire phone. I'm closing this since I'm unable to reproduce. We will reopen if there's additional information  I‚Äôm not 100% sure what it is the problem this solves. When you pull entities from the pool you can position them wherever you want. In the case of bullets you pull an entity from the pool, place it at the tip of the gun and animate it. The application has full control where the entities are placed. There is also the renderOrder parameter from Object3D for finer control: https://threejs.org/docs/#api/core/Object3D.renderOrder I would let content manage the position of the entities. The main problem of this PR is that it couples the internal data structure of the pool with the public API. The pool contract should be just `give me an available entity if any` / `return this entity to the pool`. External code should not care if there's a list, stack or any data structure internally. If that data structure changes the public API breaks. I think the proper solution is just position the entities so they stack in the order you need.  @ngokevin What do you think here?  **Description:**

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 I'm still skeptical about pointer lock by default. With pointer lock you need content to provide gaze based or alternative selection mechanisms while a cursor based raycaster is probably the best solution and not compatible with pointer lock. With respect to my personal workflow. Developing and testing is a worse experience than before since I have to hit `Esc` continuously to unlock my cursor. I would disable the pointer lock for development purposes.

In production, I think providing a reticle-based raycaster is best, how most games do it. Before, mouse drag and mouse-based raycaster was conflated, sometimes you'd want to drag the camera, but accidentally interact with the scene. The mindset you approach a game is totally different than the expectations when you are browsing the Web. The screen real estate is shared with other elements like 2D elements in the Web site or the browser URL or tab bars that pointer lock makes harder to interact with. When you launch a game you are fully committed to it and are not expected to multitask in the same way you do when browsing the Web. The conflation between drag and mouse based raycaster could be solvable by delaying a bit the clicks to see if they are followed by a drag movement. Ultimately, A-Frame is focused in VR and the 2D mode is not the expected primary mode of interaction with content. It is more like a preview mode.

Pointer lock makes development and casual Web browsing more tedious. It optimizes for exclusive long sessions interacting with a specific piece that I do not think it will be the general case in the Web as it is in more traditional games. For development purposes I do not always have control of the different experiences I have to debug / test or QA. The fact that pointer lock will be the default makes it harder. I agree, I don't think pointer lock improves the experience when viewing panoramas or 360 videos. > The mindset you approach a game is totally different than the expectations when you are browsing the Web. The screen real estate is shared with other elements like 2D elements in the Web site or the browser URL or tab bars that pointer lock makes harder to interact with.

> Ultimately, A-Frame is focused in VR and the 2D mode is not the expected primary mode of interaction with content. It is more like a preview mode.

I think the fact that A-Frame is focused on immersive VR means that sharing screen real estate with other 2D elements is not a primary use case, and so the fact that tab bars are harder to interact with isn't high-priority. I also agree that pointerlock is not preferable for panoramas or 360¬∫ videos. But for example in an immersive social VR experience where users on desktop 2D want to look around and feel present alongside users in VR, I think that pointerlock is a good improvement, more like a traditional video game experience.

But yeah I'm completely fine with setting `pointerLockEnabled=false` by default, as long as the option is there and we don't have to tell users to re-implement `look-controls` I'm happy. :) @donmccurdy Yeah, I'm happy with keeping the code. The controversy is only on which mode should be the default. Ok, let's set `pointerLockEnabled` to `false` by default.

When `pointerLockEnabled` is manually turned on, should we also ignore the setting if `utils.device.checkHeadsetConnected()` returns true? Can't use `sceneEl.is('vr-mode')` since that also fires in fullscreen mode... Any better indicators? Yeah I have a branch with that. I'm OK with it false by default. Well all I have is:

```
+    if (this.data.pointerLockEnabled && !this.pointerLocked &&
+        !(this.el.sceneEl.is('vr-mode') && utils.device.checkHeadsetConnected())) {
```

Have not written tests yet Looks about right üëç  The default fonts don‚Äôt come with chinese glyphs. You need to use a font that comes with them. This project contains all the google fonts: https://github.com/etiennepinchon/aframe-fonts
I don‚Äôt know if any comes with chinese characters. It would be nice if someone finds one and makes it available for the community. Someone has to process them to be used as SDF fonts.  See: https://github.com/aframevr/aframe/issues/3355 I've put together a little web tool for generating these MSDF fonts. It will support special characters correctly, and you can provide your own fonts if you wish.

http://msdf-bmfont.donmccurdy.com/

^note, this requires the `negate: false` setting on A-Frame's `text` component, which is only available on the master branch and will be released with 0.8.0.  Could you test your code with A-Frame master branch? There have been some fixes related to this. Is it possible that you're seeing the same thing as #3276? Should work now, try it out on master.  @takahirox Thanks! Nice to see back here üëç   I cannot see any problem in the provided screnshot. Do you have an alternative one  that shows the issue more clearly? It's hard to see if you don't have a frame of reference for what the scene should look like. I've drawn a circle around the artifacts in this example: 
![inkedsticky_li](https://user-images.githubusercontent.com/10034859/35186869-06e7e3e2-fde1-11e7-9995-b5217ac0694d.jpg)

@scheerio is your scene using aframe-environment-component? I'm not sure, but I think the issue might be limited to when that component is in use
  I would try `json-model` and `object-model` from aframe-extras first: https://github.com/donmccurdy/aframe-extras/tree/master/src/loaders

I think that `object-model` should work. You can also export glTF from the three.js editor.

Registering new geometry types, as shown here, is likely to be a bit harder.  Hm I see. Yes if the goal is not just to load a JSON model, but also have it work with the `material` component, then being able to use `registerGeometry` to create a geometry type that loads custom models would be helpful.

Creating JSON models is its own problem (the three.js editor isn't really a modeling tool, and the three.js Blender exporter has a lot of open issues) but maybe a similar thing could also work for more common formats.

The reason this doesn't work, I think, is that the geometry system expects `this.geometry` to be set during the `init()` call, and so asynchronous loading isn't possible:

https://github.com/aframevr/aframe/blob/2fe545627f8487475b2be80c99f91a585cb93a92/src/systems/geometry.js#L92-L107

If we could make that asynchronous it would allow this, but might also affect how materials are applied etc., so maybe not a small change. Would be curious to see a PR implementing it if you have time. :) Can have as a component, just skip the registerGeometry API  Cool thanks! Can you add a hover effect on the elements to emphasize you can interact with them using the mouse? Thanks! Congrats for your first PR  @meatwallace Thanks for investigating.  Is there any action to be taken on the A-Frame side here?  I can't reproduce the problem on iPhone X or Desktop (Firefox / Oculus) with the provided steps and example: https://glitch.com/~private-scent  Fixed this in #3201 Closing now! Sorry, I'm a bit late on this.  Thank you! üéâ You're probably the last new contributor of 2017. Happy new year! ü•á   Yeah, I think this is a bit difficult to do with an all-HTML API... perhaps there could be a single manager exposed on the `<a-scene>` or `<a-assets>` object, and `*-model` components can be changed to reuse that? This would make some other things easier like displaying a loading bar, too. For the drag-and-drop use case, which is a bit trickier to implement, developers could do something like:

```js
var manager = sceneEl.manager;
manager.setURLModifier((url) => url.replace('foo', 'bar'));
```  Instead VRManager from THREE does update the pose applying always `standing` coordinates so a user height is always present in the pose: defaulting to 1.6 in the case of 3DOF headsets.
 r- as is

This stacks the Vive's absolute pose in the room on top of a defined 1.6m on the camera rig. Resulting in being way too high up. This PR adapts to the changes proposed to the THREE VRManaged in https://github.com/mrdoob/three.js/pull/13158 Tested on:

- [x] Oculus Rift
- [x] Windows MR
- [x] Vive Shouldn't the non-VR mode user offset logic remain? We want a 1.6m (or configurable) user height on 2D mode, but when entering VR, use the headset pose.

See `laser-controls` is on the ground on desktop:

<img width="1153" alt="screen shot 2018-01-23 at 3 18 00 pm" src="https://user-images.githubusercontent.com/674727/35306010-a554eb3a-0050-11e8-96df-45a60ec9a247.png">

If we try to add `position="0 1.6 0"` to the camera rig, then in VR, the height will be too high. @ngokevin It is up to you to put the camera where you want in 2D mode. You can just place the camera where you want. You don't need a camera rig. The default A-Frame camera is placed at 1.6m already for people they don't want to mess with it @ngokevin Look at `tracked-controls` as an example r+

Can you dump some knowledge here for future reference? Everything about the sitting to standing transform, how the camera is handled internally by three.js, etc. The code is now much simpler than before. The camera pose is managed completely by THREE and you will always have a user scale height: Either the one coming from the VRDevice sensors or a 1.6m default otherwise. The use of sittingToStandingTransform can be safely ignored by A-Frame. All poses coming from VRDevices are normalized to `standing mode`. In other words, the camera height will always be relative to the ground: measured by the tracking system, inferred by the headset user configuration or default to 1.6m in the case of 3DOF headsets.  I updated the commit comment to reflect what this PR ended up doing that it is different that the original camera rig approach. By normalizing to `standing position` it is still possible to provide a camera rig to move the user around like for instance the teleport component. Lots of questions about how to use this now. üòÖ If camera pose is handled by THREE for 6DOF, I don't see any code here that would set the camera's position back onto the entity ... How do I look up the user's position in the scene? And how would components like `teleport-controls` move the player from some current position to, say, a target position at a different elevation?

In `tracked-controls/index.html` example I see:

```html
<a-entity position="0 1.6 2" camera look-controls wasd-controls></a-entity>
```

Please correct me on any of this that is wrong:

1. For 2D devices, camera height is `1.6` and that's configurable through the `position` component.
2. For 3DOF devices, camera height is `1.6` and that's __not__ configurable because it's hard coded in WebVRManager.
3. For 6DOF devices, camera position is handled by THREE, and is entirely independent of the starting position placed on the camera entity? Or it reflects initial `position.x` and `.z` but not `.y`? Magic, in 0.8.0 you don't need to do `el.setAttribute('position')` you can modify directly `el.object3D.position.set()` and you will get back the correct value when doing `el.getAttribute('position')`. The same goes for the rotation. THREE updates the pose on the entity.

To move the user around you just create a camera rig that you move around. `teleport-controls` is moving to a camera rig model already (https://github.com/fernandojsg/aframe-teleport-controls/blob/master/examples/mesh/index.html#L44)

```
<a-entity id="cameraRig">
  <a-entity camera look-controls></a-entity>
  <a-entity hand-controls="left"></a-entity>
  <a-entity hand-controls="right"></a-entity>
</entity>
```
To position the camera in 2D mode you just position the camera:
```
<a-entity position="0 1.6 0"></a-entity>
````
The position is saved when entering VR mode and restored when exiting. The A-Frame default camera already sets the height to 1.6.

For 3DOF devices the height is 1.6 by default. Not configurable but you can move up and down the user with a camera rig if necessary.


 Thanks to @arturitu for testing on:
- [x] Chrome on Daydream
- [x] Oculus Browser on GearVR
- [x] Internet Browser on GearVR Ok, I think this all sounds good but just to clarify....

```html
<a-entity id="cameraRig" position="25 100 25">
  <a-entity id="head" camera position="0 1.6 0" look-controls></a-entity>
  <a-entity teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
  <a-entity teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head;"></a-entity>
</entity>
```

Means that...

1. The "floor" is essentially at y=100, so if my height is 1.51 meters in a 6DOF device the `#cameraRig` position will be left alone, but the `#head` position will change to `0 1.51 0`, for a cumulative world position of `25 101.51 25`.
2. If I need the position of the player relative to the scene floor (e.g. for nav mesh stuff) I'll use `cameraRigEl.object3D.position`
3. If I need the position of the player's head, I'd use `cameraEl.object3D.getWorldPosition()`
4. Teleport controls will move the rig, not the camera, and most community components should do the same.
5. The cameraRig can safely be rotated around the Y axis but probably users shouldn't change pitch/roll.
 @donmccurdy correct to all of the above üòÑ  Ok, LGTM. üëç

Other thoughts: 

1. `wasd-controls` should probably either offer a `cameraRig` or `cameraEl` property, so that it can move the rig but set direction according to the camera heading.

2. I might delete a lot of the rotation-related stuff from `universal-controls`, and focus only on components that affect position instead... so for example components like `touch-` `checkpoint-` and `gamepad-controls` will move the rig around but will leave rotation to the `look-controls` component. That way things are less complicated for everyone and I can focus on things like navmesh traversal rather than these userHeight issues. üòÖ @donmccurdy Can you file an issue for the `wasd-controls` property to indicate a camera rig? 

Rotation composition is tricky üòÑ  Thanks everybody for your help on this PR. I got stuck for a while unable to make a decision I would feel comfortable with.  Is it [this model](https://sketchfab.com/models/1a9db900738d44298b0bc59f68123393) from sketchfab? It may be that the specular glossiness PBR materials don‚Äôt support shadows yet. Hm, yeah here's a live demo showing the lack of received shadows pretty clearly: https://bug-gltf-specgloss-shadows-lbxbxojcha.now.sh/

/cc @takahirox any idea if this is something we can patch in the spec/gloss ShaderMaterial? Oops just saw your comment above. I'll open a new issue on three.js for the spec/gloss issue then. Filed: https://github.com/mrdoob/three.js/issues/12980 Yeah, metal/rough is the core default but all the Sketchfab exports use spec/gloss so we do try to support it. It's just harder to implement in three.js so there are some edge cases like this.  Sweet! Thanks üëç  Doc tests failing. It complains about the link to `setAttribute` Thanks üéâ   Do the examples in the website work for you? https://aframe.io/examples/ If they work good for you. That's probably an issue specific to `ar.js` that it seems to be what you are using. I suggest filing an issue on https://github.com/jeromeetienne/AR.js  Sorry, I cannot understand üôÇ Is this PR made by accident? Is it spam? Are you a robot? ü§ñ  It's safe to assume this is an automated generated PR by a bot.  **Description:**

**Changes proposed:**
-
-
-
 What about making `background` not a default component, which effectively defaults to transparent. If developer wants a color, they can then set `background.color`. If want transparent, then don't set. At the moment, it defaults to a dark/black, which I'm not sure about. @ngokevin it defaults to black. You usually don't want a transparent background to start with.  Thanks!  The geometry of text when used with A-Frame is usually a plane/box which is more appropriate to call the compute bbox on, and it won't match the precise bounds of the text anyways since it can be longer than the text.

I use a formula `totalWidth = data.value.length * (data.width / data.wrapCount)`

The TextGeometry is probably created by the `three-bmfont-text` which is sort of a black box, and can't do much about that. Related: https://github.com/donmccurdy/aframe-physics-system/issues/74  This should be fix on the A-Frame side. I have a PR to fix this that introduces a camera rig to set the height of the user instead of using `stageParameters` in similar way than the THREE examples
    There's a `test.only` left to remove and this is mergeable:

https://github.com/aframevr/aframe/pull/3310#discussion-diff-157641487R69 You're right! The Github PR conversation is not the best to keep track of updates. Thanks! üëç   The textures load just fine for me. We host them on the assets repo https://github.com/aframevr/assets/blob/gh-pages/controllers/oculus/external_controller01_col.png
What example is not working for you? Closed for inactivity, let us know if you have any updates  It is a simpler version of https://github.com/aframevr/aframe/pull/3232 Once the bug is fixed in Webkit (https://bugs.webkit.org/show_bug.cgi?id=170595) we can just remove the `if` statement.
 @antoniohof thanks for investigating. Is there a way to crate an `isCordova()` function to detect the scenario and the condition to the if statement. Feel free to open a PR.  üôè Thanks  **Description:**

The first `updateSchema` call to determine whether the schema needs to be changed.

The second `updateSchema` call to build data with the new schema.

We need to find another or more performant way of doing this. It can become expensive in common cases if you are animating `material.color` or `material.opacity`. Perhaps limit `updateSchema` to check only on one property (as we use it for now), and switch the schema from there, to only call build data once. Right now, `updateSchema` can update based on a variety of factors, which is overkill.

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
  Thanks for filing!  **Description:**

I recommend raycaster should be checked every frame so that interactions are responsive. Otherwise they can feel delayed or laggy, impacting the perceived performance.

**Changes proposed:**
- Remove default raycaster 100ms throttle.

  This is not a bug or an A-Frame specific question. You have to either wait for the scene document to load or put your script at the end of the page in order for the elements to be ready to query. Glitch example: https://glitch.com/edit/#!/incredible-risk?path=index.html:20:32  Reports that this can be fixed with `material.side` = `back`. Perhaps the negative Z scale thing isn't working out anymore? We bumped A-Frame to THREE.js r89 a couple of days ago. Is this still a problem? Yep, it seems to reproduce on master. https://github.com/mrdoob/three.js/pull/12787

You need to try to not use negative scale anymore @vincentfretin Thanks for investigating. It would be great if you have some bandwidth to open a PR with the fix.  **Description:**

See `text` example, text does not appear.



<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 On the branch, not on stable. The warnings are from the custom color animation code of that example, but not related to the text not appearing. Commit was for being able to get rid of VREffect and use three.js's more performant VR renderer. It could be the case that it's an intentional change on three.js part, we need to investigate the exact issue and determine from there (perhaps three.js bisect). The offending PR https://github.com/mrdoob/three.js/pull/12787  **Description:**

I have two cursors, one with `rayOrigin: entity` on the controller, and one with `rayOrigin: mouse`. The controller has an event listener on `mouseenter`, and it is somehow getting triggered whenever the mouse cursor hovers over anything.

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
  **Description:**

Entities that are excluded by `raycaster.objects` can be reported as an intersected entity if they are a child of a selected entity. It makes sense that descendant meshes are included in the raycaster's search, but I would expect that the the parent which is specified in `objects` would be reported as the intersected entity in the `raycaster-intersection` event so that the reported intersections are exclusively with entities specified in `objects`

I can work on this if you agree

- A-Frame Version: 0.7.0 & master
- Platform / Device: desktop Firefox
- Reproducible Code Snippet or URL: https://cdn.rawgit.com/aframevr/aframe/c2f08cf0/dist/aframe-master.min.js

Only '#box' is included in `raycaster.objects`, but '#sphere` will appear as the event target when clicked.  Agreed, just ran into this bug.  Thanks üèÜ  Can you describe the issue? I cannot see the problem from the images This is a duplicate of https://github.com/aframevr/aframe/issues/3223  I can reproduce the same problem.  **Description:**

xOffset to allow for padding relative to the geometry plane behind it without having to separate them into two entities.,

**Changes proposed:**
- text.xOffset
 Whatever you want, you can set negative or positive value. It's naive.  **Description:**

Need to add a mesh/geometry for it to work. The geometry is created by the three-bmfont-dependency and it looks like the vertex positions of the generated buffer geometry are quite large? Perhaps we cannot fix it, but at least document it as adding an invisible mesh plane is not too bad.

- A-Frame Version:
- Platform / Device:
- Reproducible Code Snippet or URL:

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Note that the ‚Äúposition‚Äù attribute in these BufferGeometries has only X/Y, it‚Äôs not local Cartesian coordinates. That‚Äôs also breaking physics components. üôÉ

https://github.com/Jam3/three-bmfont-text/blob/master/index.js#L77  You need to have a VR headset connected on desktop or run it on a smartphone. Closing since this is not an bug or a feature request.  The change coming with r88 can be patched in via:

```js
sceneEl.addEventListener('model-loaded', function (e) {
  e.detail.model.traverse(function (node) {
    if (node.isMesh) {
      if (node.material.map) node.material.map.encoding = THREE.sRGBEncoding;
      if (node.material.emissiveMap) node.material.emissiveMap.encoding = THREE.sRGBEncoding;
    }
  });
});
```

An effect of that will be that textured glTF models look darker. We can offset that by adding `renderer.gammaOutput=true`, which arguably should be the default anyway. The obstacle would be that `renderer.gammaOutput=true` will make existing scenes look brighter, so it's not fully backwards compatible. Compare these effects by dragging glTF models into https://gltf-viewer.donmccurdy.com/ and turning gammaOutput on or off.

I don't think we need a special one-off build with r88, since developers can opt into the sRGB texture encoding change easily, but when we do update we'll need to decide how to handle it for correct rendering vs backward compatibility. A-Frame has upgraded to r89dev. Couple things to fix, but tracking in other issues. Proposed fix in https://github.com/aframevr/aframe/pull/3424. Encoding on `.map` and `.emissiveMap` will be handled by `gltf-model` and `THREE.GLTFLoader` already, so you'd just need to set `gammaOutput` for the correct result:

```
<a-scene renderer="gammaOutput: true" />
```

In retrospect it should likely have been true by default (same applies to three.js actually) but it will cause people grief if we change the default now. Consider that later on?  Does this reproduce in master (and do you still get the truncated ray) or with v0.6.0? There are several issues with the 0.7.x raycaster and cursor that have been resolved It sounds like the same thing is happening on all versions. v0.7.0 just has an issue where the line never shortens.

Could you try adding `"objects: [test]" to your raycasters? They may be colliding with each other's rays lines or with their own controller model as the current config in your example enables collisions on everything.  Did you ever try setting `raycaster.near`? I think I mentioned that on slack but  I'm not sure if you noticed it. That should help if the problem is colliding with the controller model itself. Could test that (using `near` instead of `objects`) and report back? If it helps, maybe we could suggest it be added to the default `laser-controls` config. 

However, it's never going to be perfect without setting the `objects` property because the rays will collide with each other's lines. @ngokevin it looks like we have an issue with the `laser-controls` raycaster colliding with its own controller model on Oculus Touch such that no ray will appear. Would you consider a PR to `laser-controls` to set `raycaster.near` to a small value by default to prevent this?  There are some plans in the roadmap for supporting spectator cameras, which might affect the concept of an "active" camera. https://github.com/aframevr/aframe/blob/master/ROADMAP.md

In the meantime, I don't think there is any technical policy - multiple active cameras won't work, and is not guaranteed to have reliable results.  The last to initialize would be the one that wins. It should be deterministic but I don‚Äôt know without trying what the order would be. As @donmcurdy pointed out I would not encourage having multiple cameras active simultaneously. Not sure if there‚Äôs anything actionable here. Closing it for now.  Does the laser-controls example work for you? https://aframe.io/aframe/examples/test/laser-controls/ Yes, click should work. That demo uses
the click event on the cubes. Try mofify that demo as a starting point. It does not seem this is a bug on A-Frame since the demo works. It is something particular to your content. I recommend asking the question on stackoverflow or the slack channels. https://aframe.io/community/#slack  Can you shar a complete runnable example?  thanks @jan-thoma! The root of the issue is here:

https://github.com/aframevr/aframe/blob/master/src/utils/material.js#L32

^in which we're returning early if the _url_ of a texture map hasn't changed. but I think it will require some reworking to do the right thing.  Thank you üôè   **Description:**

Support for `play()`/`pause()` ([docs](https://aframe.io/docs/0.7.0/core/systems.html#methods)) were added recently (0.6.0?) but no longer seem to be working.

Tried:

1. Just registering a system.
2. Registering system, registering component, and using the component in the scene.

- A-Frame Version: 0.7.0
- Reproducible Code Snippet or URL: https://codepen.io/donmccurdy/pen/aVGJER?editors=1000

 I actually most of the time just use components versus systems. They can act like systems, have more features, and are more stable. Until we port systems to use component code and add features to systems that give them an edge over just using a component. > However I never have seen actual usage .play() and .pause() in systems.

Up until 0.6.0, none of the lifecycle events worked on systems ‚Äî not even `update()`. Now, in 0.7.0, `play()`/`pause()` again do not work. So the fact that we haven't seen actual usage is not terribly surprising. Being able to use `pause()` in the physics system to stop physics simulation (running separately in a WW) would be an example use case.

> I actually most of the time just use components versus systems. They can act like systems, have more features, and are more stable. Until we port systems to use component code and add features to systems that give them an edge over just using a component.

We should fix this... we're doing the ECS model, systems should have functional lifecycle events. If `registerSystem` just becomes an alias for `registerComponent` that throws errors if you try to instantiate components anywhere but `<a-scene/>` that would be sufficient. Yeah, we should fix. Just been on the backburner since it's too easily workaroundable. We can call it entity-component system vs entity-component-system :)  A-Frame does not try to advertise pure 100% interoperability with the entire Web and Web Components stack. It piggybacks on top of DOM to provide a full game development framework that mirrors DOM APIs. In some cases, it works just fine (Preact, jQuery, d3.js). Since you were able to work around with `.attributes` (or `HTMLElement.prototype.getAttribute`, that's valid. But I don't think we will reinvent the entire framework at this point. Thanks! For a bit more context and some considerations behind A-Frame's API:

1. Scenes often call `setAttribute` and `getAttribute` many times per frame at 90fps. [De]serialization would add memory overhead likely to cause problems, which in-and-of-itself could be a major obstacle to using JS libraries with A-Frame. üòï
2. While we try to do what we can to support JS Frameworks, the vanilla developer experience does become noticeably worse with plain strings. Consider:

```html
<a-entity material="src: foo/diffuse.png;
                    normalMap: foo/normal.png;
                    aoMap: foo/ao.png"></a-entity>
````

```js
var material = el.getAttribute('material');
```

Practically we'd need to reflect the data to `el.property.foo` as you suggest, and this would be a pretty major breaking change for third-party A-Frame components. I assume we'd want to use ES5 getters/setters for that as well, and I'm curious what implications that has for performance... I'd love to see a proof-of-concept along these lines, but it seems like more of a rewrite than we can justify while working toward a stable 1.0.0 release. We wanted to provide a familiar API for web developers (including us), and in many cases, libraries happen to work (e.g., Preact, jQuery, d3.js, etc). The custom `<a-entity>` is documented with its custom behaviors, A-Frame doesn't break standard DOM elements. If developers needs a string form, there are several ways to retrieve that, although it'd have to be parsed again to be of any use.  A-Frame is meant for building VR experiences, meaning our three.js renderer must run at >=90FPS. Renderers like you describe are not able to run fast enough for VR, and are not supported by A-Frame.

If you want to do this type of high-quality rendering on the web, you will probably want to use [three.js](https://threejs.org/) directly, instead of A-Frame, along with one of the third-party pathtracing renderers. See thread here: https://twitter.com/alteredq/status/932729847301967873. 

It's possible that someone could create pathtracing extensions for A-Frame using those renderers, but that's probably a significant amount of work.  **Description:**

The `raycaster-intersection` event should only emitted when there are **new** intersections. Else most likely it would emit every frame which would not be very useful.

- A-Frame Version:
- Platform / Device:
- Reproducible Code Snippet or URL:

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 https://github.com/aframevr/aframe/pull/3250 You can use a tick function and check el.components.raycaster.intersectedEls  Does not support radius. Use a cylinder instead. there is also an `<a-tube/>` primitive in aframe-extras if that helps: https://github.com/donmccurdy/aframe-extras/tree/master/src/primitives#usage or aframe meshline as long as i'm here üòÖ https://github.com/andreasplesch/aframe-meshline-component  @jason90929 Can you share a link to aworking example with `0.5.0` and the broken one with `0.7.1`? look-controls is overriding the rotation. Use wrapper entity instead.

Would not tie camera rotation to Vue, that's big overhead for something that needs to update rapidly. Will close as this is more Vue side than what A-Frame can do.  Chrome 63 should have shipped. @meatwallace @kyriakosproto Can you confirm if this issue is gone? Cool, thanks!  The default fonts do not include special symbols. You can access additional fonts here: https://github.com/etiennepinchon/aframe-fonts  We should handle here if we preload: https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L126 @ngokevin do you know why `warn` output would not show up? Is that disabled for minified builds?

this particular error could be caught at preload step but many errors would not. It never reaches that point due to `<a-assets>` timeout. @joshmarinacci that sounds like the problem, but can you post the specific errors you're seeing in the console and/or Network tab? The exact fix is to add a console.log here: https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L126 Could you post a demo, and/or get a screenshot of the Network tab in your browser's developer tools after refreshing the page? (you can drag .ZIP files into GitHub comments). And are you using a [local webserver](https://aframe.io/docs/0.7.0/introduction/installation.html#use-a-local-server)? Hi @rhokstar ‚Äî the model `adidas.gltf` is working OK with `gltf-model` for me in A-Frame 0.7.0:

Demo: https://tmp-svtfxinske.now.sh/
Code:

```html
<!DOCTYPE html>
<script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
<a-scene>
  <a-entity gltf-model="src: url(adidas.gltf);" scale="0.01 0.01 0.01"></a-entity>
  <a-entity camera look-controls wasd-controls position="0 0 1"></a-entity>
</a-scene>
```

Can you post the rest of the HTML from your scene? I'm on MacOS, so perhaps something is different about file permissions but I'd be surprised to see that 304 in your network tab. Perhaps also disable caching at the top of the Network tab.  @joeloliveira7 Can you share a working example that reproduces the problem? I'm seeing the same thing on master I've been working with (3b6d48a6) and also the latest master (c2f08cf0)

On 0.7.0, the text in the far background is occluded by the nearer objects

![image](https://user-images.githubusercontent.com/10034859/33783761-a8d3f8ec-dc23-11e7-883b-160ccb4e6395.png)

On master it appears in front of them:

![image](https://user-images.githubusercontent.com/10034859/33783776-b977138c-dc23-11e7-9d64-7af814285b9b.png)


https://glitch.com/edit/#!/lewd-ferryboat?path=index.html:7:64
 Interesting, anyone fancy doing a bisect? Without trying this might be the culprit: https://github.com/aframevr/aframe/commit/c1403a27c6ad465ff337c9399365e0da67903112 Earlier I tried setting both to `false` with no effect, but maybe that doesn't work either (maybe needs an update flag, dunno). They both default to `true` already with/without the properties, so it'd be weird. Possibly related:

Text placed on a child of an entity with transparency is always rendered behind the entity, even when the Z position is significantly closer to the camera. Occurs on master but not on v0.7.0

Glitch above updated to show this behavior as well: https://glitch.com/edit/#!/lewd-ferryboat?path=index.html:17:84 Ok with c1403a2 reverted, I can toggle `material.depthTest` from the console and the behavior changes appropriately. 

The problem is that `text.updateBaseMaterial` is not called with the complete `text.data` but [with a subset](https://github.com/aframevr/aframe/blob/c1403a27c6ad465ff337c9399365e0da67903112/src/components/text.js#L172) that [never contains](https://github.com/aframevr/aframe/blob/c1403a27c6ad465ff337c9399365e0da67903112/src/components/text.js#L157-L164) `text.data.depthTest`/`text.data.depthWrite`

Just need to update the declaration of `shaderData` and it should work as intended.   @ugoel I recommend adding your images to `a-assets` https://aframe.io/docs/0.7.0/core/asset-management-system.html That. And also, three.js merged my patch for batching duplicate requests, so once we update three.js, it won't be any issue.  @artemistint the link isn't working for me, could you share the original DAE model? Note that GitHub lets you drag-and-drop ZIP files into comments. @artemistint I'm not sure why the COLLADA file isn't getting transparency applied correctly. That may be an underlying issue in THREE.COLLADALoader, but when I load the DAE file in Blender I don't see transparency there either. I don't know enough about COLLADA to say if the file is correct or not.

I'd recommend trying glTF instead. You can convert the file using Blender, and apply an alpha mask there. I used a PBR cycles node like this:

![screen shot 2017-11-16 at 11 23 29 am](https://user-images.githubusercontent.com/1848368/32911308-a43c1612-cac0-11e7-9539-350c937a865e.png)

^Note that AlphaCutoff must be `0`.

After exporting, everything looks correct on https://gltf-viewer.donmccurdy.com/ ‚Äî

![screen shot 2017-11-16 at 11 21 21 am](https://user-images.githubusercontent.com/1848368/32911323-b03752f6-cac0-11e7-95a8-d84c1bfee6f5.png)

Here are the final `.blend` and `.gltf` files:

[cave-deco.zip](https://github.com/aframevr/aframe/files/1479913/cave-deco.zip)







  Can you just check in your click event handler if the plane is visible and then do nothing? Hard to understand the exact problem in the original paragraph. Code would be helpful.

I assume this is the problem `the click and mouseenter event are trigered (even though they are not visible).`

Raycasters still hit non-visible objects. You can do `material="visible: false"` or use the raycaster's `objects` property to try to exclude it. Hope that helps, this also seems like a support question not a bug so you can head to Stack Overflow if you have more problems.  Thanks! Closed in favor of the simpler https://github.com/aframevr/aframe/pull/3306  People can do like `git clone --depth 20 git@github.com:aframevr/aframe` if they don't want to pull in old files. Don't think, then, it's necessary to rewrite the history.  @vincentfretin yes it was with my S6 + samsung internet. I don't have my device here but I'll let you know once I'll test it again. Is non A-Frame webvr content working for you? Does the Oculus Browser work? I believe there was a recent regression on the Internet Browser these days There‚Äôs an open issue that it‚Äôs probably related:

https://github.com/SamsungInternet/support/issues/19

@marchill Thanks for investigating this. Can you check if the issue above is the root cause?  @mre30 Do the `webvr-polyfill` examples work for you? http://googlevr.github.io/webvr-polyfill/examples/basic/  It is a known regression on the Oculus Browser and Samsung Internet. More info here: https://github.com/aframevr/aframe/issues/2844#issuecomment-340829968  @Aadjou Does the `webvr-polyfill` examples work for you? http://googlevr.github.io/webvr-polyfill/examples/basic/ This has to be fixed on the webvr polyfill side https://github.com/googlevr/webvr-polyfill It is not an A-Frame specific bug. I leave the issue opened as a reference until the polyfill gets a fixed and we can update the dependency As a temporary workaround try to set the display of your Galaxy S8 / S7 to the maximum resolution. As far as I know those devices come configured by default at a lower resolution they are capable of confusing the polyfill. Instructions on how to do it:

https://www.tomsguide.com/us/samsung-galaxy-s8-guide,review-4330-8.html @nicolomessina does the workaround above help?  Sweet! Found a few issues just now:

- Clicking the window causes video to pause (in case of mouse drag).
- First time loading, I got a DOM timing issue that `play()` call was interrupted by a `pause()` call.
- Sometimes WebGL errors when the video not yet loaded and gets passed to WebGL and we have a texture with no image.  This is expected behavior, the motion of the device / head takes precedence. I would not recommend rotating the camera and let the user have control of it. If you need to rotate you can create a parent entity and change the rotation there. As a heads up, it's not easy to compose rotations and get predictable results. Another option is desabling look-controls `cameraEl.setAttribute('look-controls', 'enabled', false);` and then you have full control of the camera. Answered:

https://stackoverflow.com/questions/43576222/is-there-a-way-to-recenter-reset-orientation
https://stackoverflow.com/questions/47086432/a-frame-threejs-reset-gyroscope
https://stackoverflow.com/questions/36677671/aframe-set-camera-position-at-runtime  From docs on the [`light` component and system](https://aframe.io/docs/0.7.0/components/light.html), you're looking for:

```html
<a-scene light="defaultLightsEnabled: false">
  <!-- ... -->
</a-scene>
``` Hm I see. I would have expected this to work...

```js
var scene = document.createElement("a-scene");
scene.setAttribute('light', 'defaultLightsEnabled:false');
scene.setAttribute('data-foo', 'bar');
document.body.appendChild(scene);
```

... but it does not. Only the `data-foo` attribute remains after initialization.  Thanks, I'd focus on placing this within the documentation (FAQ, material page, videosphere page, future video guide) and move away from expecting the `examples/` directory to be the official place. Perhaps an HTML comment in the existing videosphere page, but we keep the `examples/` directory mainly for testing core features.

https://github.com/aframevr/aframe/blob/master/CONTRIBUTING.md#add-glitch-examples-to-documentation The site sidebar link can be changed to your Glitch There is some confusion here. What we should do is:

Add the example to the **documentation** as noted here: https://github.com/aframevr/aframe/blob/master/CONTRIBUTING.md#add-glitch-examples-to-documentation

The examples don't need to be touched as we don't want to use them for developer reference as much as documentation and Glitches. I was talking about the A-Frame homepage sidebar, we can update the link to the source code.

 Okay to change the link in `a-videosphere` and https://github.com/aframevr/aframe/commit/7309eca64660e6c7e494afdf7c031fd4e7b23b1a is not the homepage (http://aframe.io/). If we can keep threads concise, it'd be easier to not miss things.  What three.js does is just simply copy the frame from the video. So if there's a black screen, it's from the browser. I think what you can do to workaround is find out when the video is just about to end, and then reset it manually to the beginning.

Something like: 

`if (video.currentTime >= TIME_WHERE_VIDEO_ALMOST_ENDS) { video.currentTime = 0; }`  Can you add a working example that reproduces the problem? Sorry, I meant... Can you share a link to a working example that can be easily run? A glitch or a page hosted on gh-pages will do. This should automatically be handled on A-Frame master build: https://rawgit.com/aframevr/aframe/3035117/dist/aframe-master.min.js  Thanks! We recommend replacing the content of a single scene instead of having multiple in the same page if you want to swap content. Do you want to render multiple scenes simultaneously? It‚Äôs already problematic to get good performance on a single scene. These are also API breaking changes for components that access systems. In general, tests should not be skipped to accomodate new functionality. Either the tests have to change if they don‚Äôt check the right things anymore or the PR has to be modified to not break pre existing functionality. While this fix may improve things for multiple scenes, I think we shouldn't go down that route for now as it will make things more complex. For support of multiple scenes, more things have to happen (e.g., three.js does not even support multiple scenes with WebGL renderer). See that #916 is closed.  @javismiles It seems you're using https://github.com/nikolaiwarner/aframe-chromakey-material. Open an issue there will be also useful. You will have to share a working example and also some information about the video.

I don't see anything exotic in the shaders of the chroma key material. https://github.com/nikolaiwarner/aframe-chromakey-material/blob/master/index.js You mentioned that iOS was working right? Is the issue exclusive to Android?  The `loaded` event fires when the file loads over the network not when your model renders You‚Äôre probably attaching an event handler after the model has loaded and the event has already fired If you're specifically waiting on this model to load, the best option is waiting for a `model-loaded` event on the entity itself (not the asset item). Other problem here ‚Äì the `.glb` asset is coming into the loader as a string, when it should be an ArrayBuffer. This can be fixed with:

```html
<a-asset-item response-type="arraybuffer" src="my_model.glb"></a-asset-item>
```

See https://github.com/aframevr/aframe/issues/2649. Offhand I can't think of a way to have that happen automatically (there is no file extension in Glitch, for starters) but maybe we could mention it in the `gltf-model` docs.  I would keep the current format so the log message remains consistent unless there's clear value on changing the date format. Thanks. I'm also European and I have never had trouble with the current format. It might not be the case for the general population. I have no data on either direction just personal evidence. Just curious, Is not the problem the same for humans if you see the date and don't know whether it is ISO8601? `05-10-2017`  and  `2017-05-10` are equally ambiguous to me if you do not know about data formats and most humans don't. Putting the year after or before the `month-day` does not change much in practice. In computer world I personally always assume that month goes first. 

The log is also a message for humans (developers more precisely) and not for machines to parse. In this case keeping consistency might be more valuable that potential benefit of the change. Thanks!  Thank you It's only an issue when it's used at the wrong time.  **Description:**

Similarly, if I keep my mouse hovering over console during scene load and enter the scene, it will fire a mouseleave event.

- A-Frame Version: 0.7.1


<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
  https://aframe.io/docs/0.7.0/introduction/faq.html#why-does-my-video-not-play-on-mobile  Does the webvr-polyfill example work for you? https://github.com/googlevr/webvr-polyfill/tree/master/examples @cloud4every1 the `webvr-polyfill` is the one doing all the work in browsers that don't have a WebVR implementation. If the polyfill example work on your device they should work on A-Frame. @cloud4every1 we were using the polyfill but we bumped the version we use. I would bet that it's a regression in the polyfill. You can try older versions of the polyfill by changing the package.json and running `npm install` and see if it fixes the issue: https://github.com/aframevr/aframe/blob/master/package.json#L46 @cloud4every1 yes, please open an issue on the polyfill or open a PR if you know how to fix it. Thanks! @siva3378 Can you describe the problem you have? What device are you using? What browser an version? Can you provide an example to reproduce? @siva3378 is not any of the examples
working for you? https://aframe.io/aframe/examples/boilerplate/hello-world/

You can host your example on glitch if you prefer: https://glitch.com/~aframe

 @siva3378 The behavior is correct. As mentioned in the docs `look-controls` rotates the entity that is applied on: the camera in your case. You can apply it to your `a-box`. It will work in 2D mode but not in VR because the head tracking will be applied to it. `look-controls` is designed to be used with a camera. 
```html
<a-scene>
  <a-entity position="0 0 5">
    <a-entity camera></a-entity>
   </a-entity>
   <a-box look-controls position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9" shadow></a-box>
   <a-sky color="#ECECEC"></a-sky>
</a-scene>
```   @fernandojsg ? @dmarcos it works! :)  They're not to be used together. One is for 6DoF, one is for 3DoF, both prescribing models. If you want a line from the hand, set `cursor` ([these properties](https://github.com/aframevr/aframe/blob/v0.7.0/src/components/laser-controls.js#L67) and `raycaster="showLine: true"` (see laser-controls code for reference). Or copy/paste laser-controls to change the model to the hand.  Setting another property does not remove other properties. Use the clobber flag if you want to wipe other properties, https://aframe.io/docs/0.7.0/core/entity.html#setattribute-componentname-value-propertyvalue-clobber, or do `removeAttribute(componentName, property)`  I think we should remove the `mergeTo` property, it works better if done manually versus declaratively (and it seems stale). I'd recommend merging manually in an A-Frame component what you need. I'm good with eliminating `mergeTo`. It is confusing even for me that I implemented it üòÑ  We've removed `mergeTo` in favor of doing it manually in three.js (e.g., within a component) when needed. Instanced geometries is an alternative way to achieve the same draw call reductions. Quick resources on merging geometries in three.js:

- https://stackoverflow.com/questions/30245990/how-to-merge-two-geometries-or-meshes-using-three-js-r71
- http://blog.sandromartis.com/2016/11/16/merging-geometries/
- https://stackoverflow.com/questions/36450612/how-to-merge-two-buffergeometries-in-one-buffergeometry-in-three-js
- https://threejs.org/docs/#api/core/Geometry

We can provide more resources as we develop/evolve examples and code. I made a geometry merge component: https://github.com/ngokevin/kframe/tree/master/components/geometry-merger#aframe-geometry-merger-component  First, thanks for the polyfill! Supporting templates is not a priority at the moment (there's a [template component](https://github.com/ngokevin/kframe/tree/master/components/template/) that plugs in better into A-Frame's ECS framework). 

If we could upgrade to v1 for free without any bugs, that'd be cool. It would be difficult/risky since [A-Frame does some patching to it](https://github.com/aframevr/aframe/blob/master/src/core/a-register-element.js), and that would need to be revisited. But no plans at the moment unless there's an free/easy path. Thanks! Not immediate plans to migrate to V1. I have not personally seen much work using templates in the A-Frame community  but it might be because they don't work üòÑ I have not seen the need for them in my own work either. Any other benefits of migrating to V1? I don't question the value of templates what I meant is that in the context of VR experiences I have not seen much demand / need. 

The reason we moved to a fork is https://github.com/WebReflection/document-register-element/pull/55 
I would be happy to drop the fork but we would have to test thoroughly. It has served us well, bug free for more than a year now. if it ain't broke, don't fix it üòÑ Thanks to you for that.

I would like to eventually move to V1, not sure if it's a priority at the moment. What are the timelines for V1 implementation in all the browsers? When can we expect V0 to be dropped? We'd need to spend time investigating and trying. We're not jumping at it since what we have works, and there's risk in having A-Frame run in some browsers with their native implementations (possibly with quirks) and some browsers on a polyfill, and then there's mass testing across every browser needed.

I hope you understand it's not that we don't want to do it, it's just that we're focusing on other things that yield much larger performance improvements (DRE is not very huge on the flame charts) with less effort and risk. You can imagine for 90fps VR, Custom Elements are not our bottleneck. Simply a matter of priority.

But in case you're interested in volunteering/contributing in testing A-Frame with CEv1 for, that'd be cool! We can let you know what the DRE monkeypatch does and that we'd need to be able to wrap/override setAttribute/getAttribute. There are not particular fixes we need from V1 just porting the logic we have. We have our own wrappers around the V0 API as @ngokevin pointed out: https://github.com/aframevr/aframe/blob/master/src/core/a-register-element.js

We want to eventually move to V1, it‚Äôs just a matter of fitting it in the current priorities. What we have now works for the time being but will keep a close eye on the browser support and possible bugs. Thanks for the feedback and the polyfill. It has helped us greatly. 
 @WebReflection Sweet! Thanks! The polyfill does sound promising, but at least for myself I have bigger priorities (I'm sure you don't have much time either). But I'll leave it open for anyone that wants to try/investigate. Thanks for the heads up. We will look into it after the 0.8.0 release in December.  Thanks! `VREffect` / `VRControls` will be gone in the next A-Frame version (see https://github.com/aframevr/aframe/pull/3152). I recommend starting making a WebXRManager similar to the WebVRManager that replaces VREffect / VRControls (https://github.com/mrdoob/three.js/blob/dev/src/renderers/webvr/WebVRManager.js). WebXR is still highly experimental so I would keep it as a separate `aframe-xr.js` library that bundles both the WebXRManager, the [webxr-polyfill](https://github.com/mozilla/webxr-polyfill) and associated components. At load, the library would swap WebVRManager with the WebXRManager in the renderer: `sceneEl.renderer.vr = new WebXRManager()` and register the relevant components for ar scenarios.  Agreed with not tunneling down into that deep of an experimental level, and three.js has moved away from Effect/Controls, so this direction won't be viable regardless. We can discuss in an issue next time so we don't waste your efforts (unless you were planning on doing this anyways). Thanks!  Thanks. Is it awkward since while videos can be loaded, the `a-assets` doesn't match the support? It also doesn't seem like just a simpler `.src` replace, that seemed fine to me since it wouldn't add anything. But need to do query selectors and walk through the `source`s when we consider a video element. And later for audio as well.

For multi-asset support, I might consider this which sets the `src` based on an available list of `srcs`. This normalizes the API so each asset is an element in a-assets with a `src` attribute, and the rest of the codebase doesn't need to do checks. Importantly, this also lets us reliably preload files through FileLoader since that's what `THREE.AudioLoader` will use, not audio elements.

```html
<a-asset-item id="aSound" srcs="a.wav, a.mp3, a.ogg"></a-asset-item>
``` Yeah, it's awkward to officially "support" it since it doesn't play with `<a-assets>` as expected, and they can't preload well so that weakens the point in using `<a-assets> ` at all. `<a-asset-item>` supporting multiple would fit better with A-Frame and it enables efficient audio preloading. Wouldn't really be a component, but a feature to `<a-asset-item>` which is open for expansion.

Streaming, yeah, we wouldn't use `<a-assets>` at all since `<a-assets>` is there purely for preloading. Still think it's a better fit in a component. I wonder how that plays well with uploading to the GPU, does it have to decode and upload each frame? Yeah, for large videos or streaming videos, often prefer to use inline URLs (either in material or other components) versus `<a-assets>`, only used for preloading files you want to preload. Hopefully, network fetching does not affect rendering too much? We can document grabbing a handle to the video element if three.js creates it (I believe `el.getObject3D('mesh').material.map.image`). Ah, right. Still can get the video handle that way above. The disconnect may or may not be small. It's another edge case to consider and document. Not comfortable supporting `<source>` in `<a-assets>` when we can't preload, yet that's the purpose of `<a-assets>`. 

I'm thinking again, is there a common need to support multiple video formats? A-Frame is a future-facing project, most people will just use one of the formats that are supported in all modern browsers, versus going through the work of converting to multiple formats. For the people that somehow need it, it'd still be possible to do with a bit of JS. I haven't come across projects that have attempted or asked for multiple formats (@cvan seemed to list A-Blast and Puzzle Rain, but they just use one format). my memory was wrong - it was [A Saturday Night](https://github.com/aframevr/a-saturday-night/search?utf8=%E2%9C%93&q=ogg&type=) Sound is a slightly different problem. `<source>` would be less effective there as three.js AudioLoader does not even use the `<audio>` element, but rather the FileLoader. Unprescribing `<audio>` and prescribing something like `<a-asset-item srcs>` would be effective there.

For video, I don't know if A-Frame should bend for Chromium. I'd prioritize mainline and VR-supported browsers.
 Is it possible to remove all the query selector logic? For hashing, just use the `video.src` provided as is. Then the PR is neutral and video `<source>` works (for now) at no cost. Just to make the PR a pure `getAttribute('src') -> .src` change? Then a warning in `<a-assets>` for videos with sources maybe. In A-Frame, I guess they'd always have IDs? So I'm understanding the fix more, is just to get past A-Frame warnings/checks/hashing so we can pass the video to three.js uninterrupted. Then the fix is mostly making the `hash` functions not mess it up (don't think they're too important anyways for video). Chromium is used by the official Oculus Browser and Samsung Internet Browser. Those are browsers that A-Frame should handle as first-class citizens, yes?  @cvan Yes we should support those. Even though Chromium does not ship with proprietary codecs, Oculus Browser and Samsung Internet both support H.264 and MP4 as far as I know, they're not just vanilla Chromium. The only affected one would be Chromium WebVR experimental builds. `needschanges` to remove the querySelector logic, use IDs for the hash. Let's make sure the approach is alright before going full into nits/comments/typos, just to reduce noise. Thanks! That one took a lot of energy üòÖ Agreed, thanks for helping with this. In the future, would you like me to mark reviews as approved but with Comments?

Beyond my admittedly noisy comments here, the important line I wanted to double check on was this: https://github.com/aframevr/aframe/pull/3176#discussion_r145609663

Doesn‚Äôt regress anything to my knowledge, but I think the loading of the videos are being timed out as a result. Am uncaught Promise, but assets and scene still load. So ok üëåüèΩ!

Thanks for this - I appreciate it, both of you.  The preloading abilities `<source>` video will be limited (it's not great to preload large videos anyways). The PR will enable at least the use of `<source>` without weird warnings (by passing an ID or the video element directly thru setAttribute).  Yeah, perhaps it might time out if you use `<source>`. Could be a separate fix to skip media elements that don't have a `src` attribute defined directly.  See https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L138 and https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#Attributes

`preload="true"` should be changed to `preload="auto"` (or `preload="metadata"` or `preload="none"`) in all the `<video>`s in the [Examples](https://github.com/aframevr/aframe/tree/master/examples).

Example URL where `preload="true"` is used on a `<video>`: https://aframe.io/aframe/examples/test/videosphere/

Examples:
- https://github.com/aframevr/aframe/blob/master/examples/boilerplate/360-video/index.html
- https://github.com/aframevr/aframe/blob/master/examples/test/video/index.html
- https://github.com/aframevr/aframe/blob/master/examples/test/videosphere/index.html

/cc @machenmusik

<hr>

Related issue: https://github.com/aframevr/aframe/issues/3173#issuecomment-337191996
  **Description:**

The [`calculateVideoCacheHash` helper function](https://github.com/aframevr/aframe/blob/27d984f2/src/systems/material.js#L250-L278) doesn't take into account videos with `<source>`s (instead of a defined `src` attribute on the parent `<video>` element).

Example:

```html
        <video id="video"
               autoplay loop crossorigin="anonymous">
             <source src="https://ucarecdn.com/fadab25d-0b3a-45f7-8ef5-85318e92a261/"></source>
        </video>
```

vs.

```html
        <video id="video" src="https://ucarecdn.com/fadab25d-0b3a-45f7-8ef5-85318e92a261/"
               autoplay loop crossorigin="anonymous">
             <source ></source>
        </video>
```

/cc @machenmusik 

<hr>

- A-Frame Version: `0.7.0`/`master`
- Platform / Device: All / Any
- Relevant Code Snippet: https://github.com/aframevr/aframe/blob/27d984f2/src/systems/material.js#L250-L278
 Digging a bit deeper, I found that [`AFRAME.systems.material.prototype.loadTexture` also checks the `'src'` attribute](https://github.com/aframevr/aframe/blob/444fc12/src/systems/material.js#L60-L62) of a `<video>` element, throwing a Console warning.

I assume this can be fixed by fixing the `calculateVideoCacheHash` method to use `<video>.src` instead of `<video>.getAttribute('src')`. And then just checking for [`src.src`](https://github.com/aframevr/aframe/blob/444fc12/src/systems/material.js#L60) here before throwing a warning. 

There are two cases I can think of where the wrong video could be used from a [cache hit](https://github.com/aframevr/aframe/blob/444fc12/src/systems/material.js#L134).

Obviously, the following is very anti-best practice for loading, but a developer could inadvertently do this when preloading `<video>`s without `id`s defined:

```html
<a-assets>
  <video><source src="video1.mp4"></source></video>
  <video><source src="video2.mp4"></source></video>
</a-assets>
<a-sky src="video1.mp4"></a-sky>
```

The other case, which is also uncommon: A developer could have more than one `<video>` element, defined in the scene's `<a-assets>`, mistakenly sharing the same `id` attribute values:

```html
<a-assets>
  <video id="video">
    <source src="video1.mp4"></source>
  </video>
  <video id="video">
    <source src="video2.mp4"></source>
  </video>
</a-assets>
<a-sky src="#video"></a-sky>
```
 In `a-assets.js`, I found a few more instances of `getAttribute('src')` calls that need to be adjusted:

- https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L45
- https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L81
- https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L103
- https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L162
- https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L205
 On a related note (though it could be handled in a separate issue), should also change [this line in `mediaElementLoaded`](https://github.com/aframevr/aframe/blob/68e6c26/src/core/a-assets.js#L138):

```js
  if (!el.hasAttribute('autoplay') && el.getAttribute('preload') !== 'auto') {
```

to this:

```js
  if (!el.autoplay && el.preload !== 'auto') {
``` I wouldn't support source, prescribe to use a format supported by the modern VR browsers. As seen from many areas we would have to touch, I don't think it's worth the maintainance cost. This is not some legacy way of defining videos. This is the best practice for modern browsers. I filed this not for some ‚Äúbackwards compatibility‚Äù issue - not at all. There is real value in supporting `<source>`. Serving different codecs is not just an edge case. /cc @machenmusik @domcccurdy There's a tradeoff for what's ideal and what's practical to maintain. "Best practices" become different when it comes to WebVR. Is there a large common use case for needing different codecs in VR? I don't think it is difficult to serve a format that is supported by the VR-supported browsers versus converting a video to multiple ones. If we support this, any time A-Frame code touches video, we then need to consider not breaking this.

We can continue discuss, but let's leave this closed unless the project maintainers decide otherwise. It's more of a matter of deciding priorities and maintenance cost for the project versus what's ideal in a vacuum.  Can we find examples of WebVR needing / using different codecs? I would defer this until we find specific use cases. Just thought of that this seems possible to handle in a component / external code as well. Things that are at least possible without A-Frame intervention are generally less priority. For anyone running across this. Something like...

```js
AFRAME.registerComponent('multivideo', {
  schema: {
    urls: {type: 'array'}
  },

  init: function () {
    var v = document.createElement('video');
    // 1. Loop over the URLs.
    // 2. Check if the video can play the type with `v.canPlayType`
    // 3. Keep looping until a video is playable.
    // 4. Set the material src to that video.
  }
});

// Alternatively, do this as a content script to get preloading working.
// Even possible to register a custom element for `<a-assets>` to handle this automatically.
``` An example today is of A-Blast and Puzzle Rain requiring OGG audio files in the Oculus Browser, Samsung Internet, and Chromium. And in other browsers, MP3 files are used. This is currently hardcoded in JavaScript, causing the incorrect assets to all be loaded initially in `<a-assets>` and then the correct ones fetched from the JS calls within the application logic.

Another use case is streaming video. Right now, @machenmusik has a PR for HLS. And typically you‚Äôd define one `<source>` for HLS, one for MPEG-DASH, and fall back to x264. Browsers already handle this feature detection based on the mime-type and codec passed in `<source type>`. I can't find uses of MP3 in A-Blast or Puzzle Rain (which is not A-Frame so there's no a-assets). They use OGG. Either way, it can be worked around in any case. Similarly for streaming video should be handled outside A-Frame IMO.  Because of how `<a-assets>` and the material `src` loading work, you can't do this:

```html
<video id="video" crossorigin="anonymous">
  <source src="video.mp4"></source>
</video>
```

No matter where you put it on the page, you won't be able to have A-Frame use a `<video>` with a `<source>` specified. It just doesn't load, because of the aforementioned places that check explicitly for `<video>.getAttribute('src')`.

Any third-party component you write won't fix this, without a bunch of monkeypatching. And, even then, I'm not sure it'll work because of the loading order of the systems and components.

The caching and preloading are just additional issues that also prevent loading and possible cache hits for the wrong `<video>` elements.

Sorry if that wasn't clear. Thanks for asking.
 I think it's simpler to prescribe not using a video player framework, it adds a lot more uncertainty. It's entirely possible to build a component or code that selects and sets a suitable video out of a list of video URLs. Not using `<source>` specifically, but that's OK. > Not using `<source>` specifically, but that's OK.

Why create a new DSL and deviate from how media sources are loaded in the `<video>` (and `<audio>`) elements natively supported in all browsers?

In my earlier comments, I found the spots that need adjustment, and there is a clear solution of just searching, replacing, and adding tests.

What's unreasonable about this request?

How are developers going to know that this doesn't work? Respond on Stack Overflow/Slack with a link to a different custom component and interface they have to learn (with its own caveats that don't 1:1 match up with browsers' native `<video>`)? Pointing developers to this now-closed issue? Add a new item in the FAQ? How sustainable is that approach?
 A-Frame doesn't carry everything over from the 2D Web. As mentioned, there is long-term maintenance cost in code that is already complex. It's also awkward since it won't support the inline URL style, which is why a third-party component is preferred. It's not unreasonable, but neither are the maintenance concerns. Any third-party component that interfaces with the video element will then need to account for `<source>`. Documentation and online resources will continue to guide developers. 

> IMO, that's a little like prescribing not using frameworks atop WebGL. Simpler, but perhaps less useful.

"why frameworks at all?" sort of becomes [reductio ad absurdium](https://en.wikipedia.org/wiki/Reductio_ad_absurdum). The point of the simplicity was of using one framework versus two different frameworks. Ah, well if it's just swapping getAttribute calls to `.src` calls, I think it's fine. Is that all we need? If so, I overestimated the effort given the amount of content in the proposal.  The PLY model is not a material ‚Äî to load it you would need to use the `ply-model` component from [aframe-extras](https://github.com/donmccurdy/aframe-extras/tree/master/src/loaders). Any components attached to a mixin are reused (not just material and geometry).

However, that mixins are just a convenience feature ‚Äî there's no performance benefit from reusing a model in this way. Yup, use the `ply-model` component instead and should work.  thanks for filing this. I noticed the exact same behaviour. looks like a recent regression. will fix soon - thank you! see the discussions here: https://github.com/aframevr/aframe/issues/3160#issuecomment-337542073

I'll wait to hear from @NellWaliczek and @olga-microsoft on this.

p.s. thanks for the videos - they're very helpful! üëç 

 This is not a `0.7.0` regression. The problem was already present in `0.6.0` and is due to the polyfill not returning to mono mode after exiting VR yep, you're right. `0.7.0` was just what I was testing with. (I didn't bisect it back to see when it first regressed.)

on `0.6.0`:

<img src="https://user-images.githubusercontent.com/203725/31803653-d7bf8784-b509-11e7-8579-50436f158b45.jpeg" width="500">
  Thanks! Docs fixed with #3167. This was a performance optimization added in #2950. It'll be part of the release notes once it's released.  Added input-mapping system: https://github.com/fernandojsg/aframe-input-mapping-component Not sure if it's the best idea to start the PR until we'll solve the issues we're discussing in my repo and then push all the changes, or merge it and evolve it here, moving the discussion to this repo too.
/cc @ngokevin @dmarcos thoughts? @fernandojsg I think we can deal with the issues in further iterations of the mapping. The current design is useful and easy to understand / use. I commented on https://github.com/fernandojsg/aframe-input-mapping-component/issues/3 that it is the only one that could change the current design, the others are refinements. We had discussed that problem before and settled on organizing the mappings per controller instead of per action for the reasons described in the issue: Organizing mappings per controller is closer to how users and developers reason about mappings. I grab a controller and I imagine how the interaction will feel and how the different actions map to the buttons. @trevorfsmith: since you‚Äôve been assessing and preparing for tackling universal XR/MR input fragmentation, I wanted to get your insight on this - if you haven‚Äôt already take a look. thanks for taking a look :smile: I believe we could still handle these global states as presenting or not with the states implemented currently and the app could swap between these mapping states as the app change itself to another state. Maybe we should let the component/system API bake before we place in the core. We've been quick to put components into core before (object `pool`) that haven't gotten a lot of run. I'll use it in one of my projects and can provide feedback/PRs.  @ngokevin yep I agree with you. I'll keep improving it on my repo and testing it with the rest of the demos and once it get mature we could decide how to include it here The `input-mapping` component is still under heavy development. It is a bit premature to pull into core. I'm closing this for now and we will reconsider for `0.9.0`. Better let it mature as a 3rd party component for now.   https://github.com/aframevr/aframe/commit/a840dd6cde6ff2410e96dbce2f10228d84a6cd8c  It creates a new geometry since they default to Buffer geometries which can't easily be updated in-place. Geometries are cached + reused though. https://github.com/aframevr/aframe/blob/master/src/geometries/sphere.js#L18   What is exactly your use case? Can you describe a specific scenario? You can always track internally in your component if a property has been ever set regardless of the default value.  For the callback use case I would emit an event from your component `rollchanged` that other entities can subscribe via `addEventListener`

For the carousel you can have a `selector` type property that references the selected entity of your carrousel A-Frame component properties are designed to express data not logic. There are other mechanisms for that: component methods, event / listeners Can you describe a use case? Also keep in mind that you can create your own property types by defining parser and serializers for them. You may want to try going down that path and see how it goes. For 3xN matrices that's likely best anyway. See: https://aframe.io/docs/0.7.0/core/component.html#custom-property-type

An example where I defined custom property types (although I did it differently than the documented way) here: https://github.com/donmccurdy/aframe-extras/blob/feat-state-machine/src/state-machine/transition.js#L17-L23 ... in this case my property type was explicitly designed to represent logic, like `position.x > 100`, for better or worse. üòá if you want to define a single value for the component, rather than multiple properties, you'd need to use your custom property type with a [single-property schema](https://aframe.io/docs/0.7.0/core/component.html#single-property-schema).  **Description:**

1. Load an A-Frame example that is using `0.7.0`, such as the [`Shopping` example](https://aframe.io/aframe/examples/showcase/shopping/).
2. Click the "Enter VR" button.
3. Resize/maximize the browser window.
4. Notice that the canvas is not resized to the new dimensions of the browser window.

- **A-Frame Version:** `0.7.0`
- **Platform / Device:** Desktop / Any (reproduced on Windows and macOS)
- **Reproducible URL:** https://aframe.io/aframe/examples/showcase/shopping/
- **Screenshot:** ![Screenshot of 'Shopping' example, browser window maximized](https://user-images.githubusercontent.com/203725/31488313-217d960e-aef2-11e7-9520-d3b82167871d.png "Screenshot of 'Shopping' example, browser window maximized") I `git-bisect`'d this regression back to this commit: https://github.com/aframevr/aframe/commit/4e98415

I see this was introduced in PR #3031. I see [this comment](https://github.com/aframevr/aframe/pull/3031#issuecomment-331105971), which was then handled in PR #3080.

Perhaps I'm missing something, but this doesn't fix the mobile cases.

> Is that really the expected behavior?  Shouldn't the canvas stay the correct size for the VR headset's resolution?

Totally reasonable concern, yeah.

Here's the common scenario where it looks really bad (on desktop):

1. Open an Edge/Firefox browser window
2. Launch an [A-Frame site](https://aframe.io/aframe/examples/showcase/anime-UI/)
3. Click the `Enter VR` button
4. Maximise the browser window
5. And you see a gaping white space

> Is that really the expected behavior?  Shouldn't the canvas stay the correct size for the VR headset's resolution?

On a Google Daydream or Samsung Gear VR, when you rotate the screen (as A-Frame's on-screen instructions tell you to), that triggers a canvas resize, which technically is increasing the resolution. If I return my phone to portrait mode, I'd expect the canvas to look like how it upon exiting VR as it did prior to entering VR.

On desktop, this is just an inconvenience and looks very much like a bug. But in the mobile scenario I described above, it jarbles up the screen. (I can provide a screenshot in a follow-up comment.)
 As for screenshots I just promised, even better are these videos from @Pterko in #3166:

- https://www.youtube.com/watch?v=TyEItePPoPA
- https://www.youtube.com/watch?v=lk7ihgJwFQg

Let me know if you or @olga-microsoft have ideas on a solution that could benefit both our scenarios without too much compromise. @NellWaliczek what are your thoughts on this, per my two comments above? @olga-microsoft you are right and your code is correct. The canvas should not be resized while presenting. The problem was an incorrectly `style.width` and `style.height` applied that were overriding the `width: 100%` and `height: 100%` applied by `a-canvas` style. https://github.com/aframevr/aframe/pull/3184 will fix the issue.  Hi @nedol ‚Äî¬†I've tested quite a lot of glTF files, it's certainly possible to do this.

Can you share your model, and ideally a demo showing the problem? Also note that A-Frame 0.7.0 supports glTF 2.0. If you have an older glTF 1.0 file, you need to use `gltf-model-legacy` from A-Frame Extras.

You may also want to check out our [troubleshooting section](https://aframe.io/docs/0.7.0/introduction/models.html#troubleshooting), and test your model with an [online viewer](https://gltf-viewer.donmccurdy.com/). I don't know where to find the glTF model in that demo. It's better to test with minimal scenes, so that you can narrow down where the problem is coming from. Can you make a simpler demo to verify everything is working?

```html
<a-scene>
  <a-entity position="0 0 -4" gltf-model="my-model.gltf"></a-entity>
</a-scene>
```

Also make sure you're checking the JS console for errors, which would be important clues, as mentioned in the 3d model troubleshooting docs. Could you post both the file and its `.bin`? You can drag-and-drop .ZIP attachments into GitHub comments directly.

EDIT: and texture files, if any. That second file looks correct to me in [this viewer](https://gltf-viewer.donmccurdy.com/) ‚Äì no visible transparency.

The earlier file definitely is missing a `.bin`.

If the models appear correctly in viewers like https://gltf-viewer.donmccurdy.com/ and http://sandbox.babylonjs.com/ then something about your particular scene is introducing transparency. You'll need to reproduce the problem in a simple demo for us to help you. More information about playing animation in A-Frame here: https://aframe.io/docs/0.7.0/introduction/models.html#animating-models  I think the goals (if we do this) would be ‚Äî

1. Bring the `registerShader` API closer to what component+ShaderMaterial can do.
2. Let developers use `material` on models, not just primitive shapes.

(1) is part of the discussion in #3151 and elsewhere of course.

(2) is definitely a common request, although I'm not sure how many people requesting it are familiar with UV wrapping. Applying an arbitrary material to an arbitrary model doesn't "just work", so practically what are the use cases for this?

Another concern, with (2), is that users may expect using `material="ambientOcclusionMap: foo.jpg"` would apply an AO map to their model's existing material. Merging materials seems hard in general, so I'm guessing we don't want to go that route? Using `material` would entirely override any materials already in the model?

> ...and to optionally traverse the model and its children, or apply recursively to the object hierarchy. (Though we should consider whether to traverse into child A-frame entities then)

I'd lean toward always traversing the model, and never the child entities. I think we could accomplish that by checking `object.el` while traversing, and not going further if it's defined.

***

Overall I'm undecided about this... My original concern, and reason for bringing this up, was about `getOrCreateObject3D` causing problems. But that can be avoided in other ways. We can continue the higher-level discussion about shaders first: this doesn't need to block #3154.  I haven't had the chance to do a thorough read-through yet, but assuming someone has reviewed for any errors then +1 from me for merging and not waiting on the other discussions. We have an example of custom shaders already. Do we want to point to it in the docs? https://aframe.io/aframe/examples/test/shaders/ Thanks, will work on merging this soon.  Tested on:

- [x] Desktop no headset
- [x] Vive
- [x] Oculus
- [x] Windows Mixed Reality
- [x] Daydream
- [x] GearVR
- [x] Cardboard (Android)
- [x] Cardboard (iOS)

Moving THREE dependency to the dev branch temporarly until r88 release.
 Note the work in progress label @vincentfretin Thanks for testing. I believe it now should work on GearVR as expected and also Daydream. @vincentfretin what example are you running? r? I moved all the userHeight logic from `camera` to `look-controls`. It always felt weird to have the idea of user associated to the camera. All the comments have been addressed been watching this and testing locally. nice work! üëç

which Windows Mixed Reality headsets and which Android phones for Gear VR + Cardboard did you test with?

though it's deprecated, just out of curiosity, have you tested on desktop Chromium?
 WebVR is already available on desktop Canary. If there‚Äôs any problem with the old Chromium builds I would encourage users to move to Canary. 

It should not make any difference what Window MR headset it is tested on. I only have an Acer available.

For GearVR all devices should be equivalent besides performance capabilities. My testing device is a Galaxy S6 A couple of more style-related nits to address from before and then r+wc @vincentfretin Thank you üôè   Yeah, please add. Thanks! Thanks for these docs (#3154)! They are indeed better.

For reference this is what i've done in the past for shaders: https://glitch.com/edit/#!/aframe-displacement-shader?path=client/index.js:1:0 (although i should use `object3dset` and not `model-loaded` there...).

I kind of lean toward the component+shader approach. Between missing `tick()`, missing uniform types, and no support for custom models, it feels very hard to recommend `registerShader` to new users for me. Previous proposal going that route in https://github.com/aframevr/aframe/issues/2047, the API is half-baked and more to maintain. We can add that example to the Glitch sidebar, would be helpful. ^BTW the glitch example has a leftover `time` reference where the noise should be updated.

> I am still leaning toward partitioning shader functionality into shader, and material functionality into the material component rather than continually requiring one-off replacements

Could you explain this more? You mean keeping a `registerShader` API that is used through the `material` component, I think? > Re: time reference - first line in vertex shader main computes time from time1000, so I think it still works?

In your demo the model just [scales with constant noise](https://aframe-displacement-registershader.glitch.me/), whereas [in the original noise is updated with time](https://aframe-displacement-shader.glitch.me/). I assumed you were trying to reproduce mine with less code, yes?  Can we open a PR on the polyfill repo? Good! I prefer to wait for googlevr/webvr-polyfill#286 to land and just bump the `webvr-polyfill`. Cleaner and less work. Pointing dependencies to private forks should be just a last resort Thanks! üèÖ   What is the use case for adding / removing scenes? It will be probably better to empty a scene and repopulate. Asset manager is just for blocking the scene on first load, it does not have any benefit after that. You can use inline URLs and have the same effect. But emptying/modifying the scene is the way to go, and we won't much support this use cases of attaching/reattaching scene. If you have any specific places where A-Frame can free memory, feel free to file an issue for that. Thanks! one quick comment i'll pull from #3137 - we should probably call WebGLRenderer.dispose() when a scene detaches  Actually the default camera generated by A-Frame has a user height of 1.6, but using the camera component itself has a default user height of 0. Perhaps we can reword to make it clear. `Height offset to add to the camera when *not* in VR mode so the camera is not in the ground. The default camera that A-Frame injects or the `<a-camera>` primitive has this set to 1.6 (meters, to represent average eye level.). Note the default camera component alone defaults this to 0.`  This experimentation can also happen as a 3rd party component. Yeah, it's pretty specific and fairly complex, I'd encourage a separate component. Thanks!  **Description:** Improve the cleanup of `laser-controls` on removal and allow an option to not load controller models. I'm suggesting this to improve my `progressive-controls` component, which uses `laser-controls` for pointing mode. I have an issue where the raycaster from laser-controls cannot be disabled for touch mode because it is added back on event triggers even if laser-controls is removed. I have also had a feature request for the model property from a user.

**Changes proposed:**

- When `laser-controls` is removed, also remove registered event listeners
- To accomplish the above, move helper functions from within `init` into component methods
- Add a `model` schema property that propagates to controller components
 I just found #2981 in which @ngokevin advises against adding the model property. Sorry I didn't search issues before sending this. Shall I strip out the commits related to the model property and just keep the `remove` cleanup? What is the use case for hiding the controller model? Looking back at the conversation, people should be able to do:

`<a-entity laser-controls daydream-controls="model: false">`

to disable. That should work, but there were some reports of it not. @dmarcos: I think it is because they want to load their own model instead of the controllers, like the guns in A-Blast. @omgitsraven @evhan55 Can you comment on use cases for which you wanted `model: false` on `laser-controls` / `progressive-controls`?

@ngokevin: yeah, but that gets a lot more verbose when we're talking about setting it for all the controllers loaded by `laser-controls` re: a-blast For something complex as guns, you'd want to use your own controller component. There's no need for laser/raycaster there. All it is is setting your own model.

re:verbose It's not too bad really, to just set the components. It'd take like 15 seconds. Alternatively, copy and paste the `laser-controls` component, all it does is set other components. It's very easy. I'm in favor of not adding more API or emphasizing components that can be done easily manually, to have multiple ways to do the same thing. We could have an article on on how to make custom components using `a-blast` as a case study. I opened https://github.com/aframevr/aframe-site/issues/469 What I'm really invested in here is the improved removal cleanup, so I'm
going to strip out the `model` related commits and force push an update
with just the cleanup

On Mon, Oct 9, 2017, 4:09 PM Diego Marcos <notifications@github.com> wrote:

> We could have write an article on on how to make custom components using
> a-blast as a cases study. I opened aframevr/aframe-site#469
> <https://github.com/aframevr/aframe-site/issues/469>
>
> ‚Äî
> You are receiving this because you authored the thread.
> Reply to this email directly, view it on GitHub
> <https://github.com/aframevr/aframe/pull/3138#issuecomment-335290229>, or mute
> the thread
> <https://github.com/notifications/unsubscribe-auth/AJkeq8R1Ai2g40UjpoBgX_3Y-o6zLtTcks5sqouigaJpZM4Px76m>
> .
>
 It's already in the docs https://aframe.io/docs/0.7.0/introduction/interactions-and-controllers.html#creating-custom-controllers I think these changes make laser-controls try to do too much, which was an almost reference out-of-the-box implementation that all it does is set other components. It's pretty much a config with no logic. If people need anything deeper than that, I'd start with a copy of laser-controls as a base and modify. If people need to do things such as disable the laser or remove models, that can be done with `setAttribute` calls. So I'd vote to close. I reverted the dependency, so I no longer have any stake in this.   @calrk Did your function above resolve the memory leaks for your project?

A-Frame uses [`THREE.Cache`](https://threejs.org/docs/#api/loaders/Cache), so it's expected that caching will stick around until `THREE.Cache.clear()` is called. But otherwise we're not intentionally retaining things. Makes sense, thanks. I don't think we want to have that function run automatically when an element is removed, because uploading textures to the GPU is expensive. For example, the user might just detaching it and moving it to another parent, and we don't want to force a texture to upload again.

Brainstorming ways to let users do this themselves:

- Create `entity.dispose()` method, that traverses `entity.object3D.children...` and disposes any textures and geometry that aren't in use elsewhere (can we detect that?)
- Create `dispose-on-detach` component that users can attach to entities, so that the entity will automatically dispose of textures when detached. The GLTFRegistry cache is only retained while the model loads, so it shouldn't be related to this issue.

> I thought that it was using THREE.Cache but maybe that is just the a-asset-item that gets cached, not the actual loaded geometries/materials? Correct me if I'm wrong...

The A-Frame asset system will cache whatever files it refers directly to. So if you have a `.glb` with textures and payload inside it, that's caching everything. If you have a `.gltf` with external payload and textures, most things are not using THREE.Cache. There is [WebGLRenderer.dispose()](https://threejs.org/docs/#api/renderers/WebGLRenderer) ... for cases where you want to clear the scene entirely, we should probably be using that in a `AScene.detachedCallback`. Would welcome PRs if someone has a use case and can test that.

> I think the dispose-on-detach is good but not an obvious solution for people to use, would an attribute on the a-gltf-model make more sense?

I'd rather not do anything specific to a single format, because we'll just have to re-implement it for other formats. I'm (more) ok with non-obvious solutions, because there are likely to be non-obvious pitfalls to using it:

1. Tracking references to textures, materials, etc. could be hard. Unless we solve that, disposing has the potential to 'break' other things in the scene.
2. Uploading textures to the GPU can easily take 500ms for a 10mb model, that that's a huge number of dropped frames in a running VR scene. So, dispose-by-default might be risky if you're just trying to move the model from parentA to parentB.

I think I like the `entity.dispose()` method more than making a component (and we could always make a component that applies it for you). The component API has a `remove` method that is invoked when an entity is detached from the DOM. Should not each component clean after itself when removed? If the `remove` method disposed of textures, then moving a child from one parent to another would re-upload textures to the GPU, and almost certainly drop frames. Hard to automatically guess what to do. ‚òπÔ∏è 

Could wait a few frames then check if entity is still detached?  I think it's the most asked question. See https://aframe.io/docs/0.7.0/introduction/faq.html#why-does-my-video-not-play-on-mobile, supporting inline video on iOS is a PITA. See also: https://github.com/aframevr/aframe/issues/2976

And, there are changes incoming that might cause similar effects on Chrome 64: https://www.theverge.com/2017/9/15/16311310/google-chrome-autoplay-videos-january

That is, autoplay is disallowed unless the user has interacted somehow. I haven't been able to find out if this interaction will work the same way it does on iOS, e.g. video must be played during the event callback.

short version, if you want to autoplay video the safest option is to have a "Start Experience" button before the user enters VR, and begin the video then.

EDIT: ah reading your comments more closely, autoplay is not the only headache yeah. üòï > you think the problem is related to autoplay rather than that shader error?

could be a lot of things sadly I don't think there is anything actionable here besides continued awareness of the restrictions and policies. Send a PR to the FAQ/docs if there's anything to add.  Thanks!  Common questions we should probably cover somewhere:

1. The `material` component doesn't work on loaded models, except for OBJ models that do not already have an MTL (material) file.
2. It's usually better to texture in DCC software (e.g. Blender). (Link to tutorial?)
3. If you do need to texture or re-color something on-the-fly, use three.js APIs like this:

```js
el.addEventListener('model-loaded', function(event) {
  event.details.model.traverse(function(object) {
    if (object.isMesh) {
      object.material.foo = bar;
    }
  });
});
```

For documentation on THREE.Material and its subclasses, see: https://threejs.org/docs/#api/materials/Material  Can you provide an example? If you'd like to submit a PR, you can `.trim()` the values at https://github.com/aframevr/aframe/blob/master/src/extras/primitives/primitives.js#L92  **Description:**

Currently, the raycaster seems to emit an event + object per tick per intersected entity, which is quite a bit. Even if the intersected entity was already intersecting on the last tick. So imagine you are just hovering over anything without moving, they'll get continuously pounded with events. I think we need only emit these events on the intersection start.


```js
    // Emit intersected on intersected entity per intersected entity.
    for (i = 0; i < intersections.length; i++) {
      // TODO: Check previousIntersectedEls to see if this is a new intersection.
      intersections[i].object.el.emit('raycaster-intersected', {
        el: el,
        intersection: intersections[i]
      });
    }
```

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Hmm, I forgot about that. Perhaps a property to always keep emitting in case you need that...? Even then you might not need it for every object. Theoretically, it'd be most efficient to look up the intersection data yourself which is not too hard. Maybe a subscribe method to put your entity on a list to get a callback for intersection updates? Could be done like so, perhaps not worth maintaining an API for what can be done with a bit of JS?

```js
groundEl.addEventListener('raycaster-intersected', el => {
  this.intersectingRaycaster = evt.detail.el;
});

groundEl.addEventListener('raycaster-intersected-cleared', () => {
  this.intersectingRaycaster = null;
});

...

tick: () => {
  if (!this.intersectingRaycaster) {  return; }
  var intersectionIndex = this.intersectingRaycaster.components.raycaster.intersectedEls.indexOf(this.el);
  var intersection = this.intersectedRaycaster.components.raycaster.intersections[intersectionIndex];
}
``` Nah, I don't discourage that. I do lookups like that often; it's simpler than asynchronous message passing. Members/methods are fine to be public API, depends how it's documented.  ticks can be throttled too.

I'm OK with just linking to this issue to the reference code above in the CHANGELOG. Upgrading your dependency is a deliberate step and comes with upgrade steps, so yeah, we can provide helpful instructions on upgrading, but not need to go as far as publishing a component. We can have a `breaking changes` section on the changelog for people to consider when updgrading Yeah, we've always had it, **Major Changes** + **Deprecations** Deprecation = `something that is gone` 
Major Changes can include `outstanding` new features besides `breaking changes`
I was thinking more like a list you can just go down to know where your existing content might break I just called it Major before since in semver, major changes are breaking changes but we can add a subcategory.

@machenmusik I'm OK just having people do it manually versus maintaining something new. Where there's a will, there's a way. Sounds good. done You can define two raycasters, one for plane, one for everything else, with separate intervals. The intersection set should only change if a `raycaster-intersected` or `raycaster-intersection-cleared` event fires. You can then iterate over `el.components.raycaster.intersections` directly to find the remaining intersections. Or if you specifically care about the plane, call `el.components.raycaster.getIntersection(planeEl)` to see if it is intersected. @machenmusik I'm not sure what you mean by "symmetrical", but yes, I'm not opposed to changing the events. But I do think use of the programmatic API will be necessary for certain use cases, and that's OK ‚Äî `raycaster` should stick to something that won't add too much overhead. TBH I think the `cursor` component itself would be a little simpler if it accessed the raycaster component programmatically. üòÖ The current event API is only firing when the list of intersections changes, right? Except the occasional case where two objects lose intersection at the exact same time? Just have to listen for both events. 

Seems like a case where numbers or a motivating example would be best. If there's a measurable improvement to be made, an option is fine with me. But the current API is new enough that I feel like we should wait a bit. If there was an option to disable that event and look up intersection data manually, I would use it. Since there is garbage created on every new intersection for `raycaster-intersected`.  Thanks!  **Description:**

Rather than emit an event + object on the raycaster entity on each cleared intersection, emit one with no event detail, and event handlers can look it up themselves, but this event is rarely used.

**Changes proposed:**
- `raycaster.clearedIntersectedEls` member.
- Emit `raycaster-intersection-cleared` only once per tick.
 What's the advantage of not including `clearedIntersectedEls` in the details of the `raycaster-intersection-cleared` event?

The disadvantage is other components would have to directly access the `raycaster` component instance object to learn the details, something I thought was discouraged Component members can be part of the public API, it's not discouraged to expose properties/methods. Not including would just save creating an object on each tick for garbage collection purposes. Is it able to fix? Oh, never mind, I guess you can maybe pass the array without creating an object. @wmurphyrd I opened https://github.com/aframevr/aframe/pull/3128 to pass the cleared elements as a detail of the event. I think versions are allowed to have some small breaking changes, especially in 0.x.x, if there's some gains, as long as things can easily adapt. It'd only break things directly using the raycaster events emitted from the raycasting entity, which I thought was not used often. The contract only applies within versions, but yeah, I wish it didn't break things.  **Description:**

**Changes proposed:**
- Cache event detail object.
- Emit one raycaster-intersection event per tick for all intersected entities.
 @vincentfretin Is it too hard for `super-hands` to accommodate to the new API? Yeah, didn't see super-hands coming. I can try making a small PR. Updated to use @dmarcos' cached event pattern. Updated. This has been done as part of another one of my PRs https://github.com/aframevr/aframe/pull/3250  I think if you clone the vector, you can get it to run the `update` call. Can you try changing to `lineData.end = lineEndVec3.clone().copy(this.unitLineEndVec3).multiplyScalar(length);`? And then PR with the `break` fix? Thanks for investigating!

I think regressions from doing garbage collection optimizations. Ideally we don't clone the vector, perhaps a more proper way to get the update to run while not cloning is two have two vectors for updating the line, and alternate between them.
 https://github.com/aframevr/aframe/pull/3127  It's not supported in all browsers so we will stick with the polyfill. Things will break with a straight switch to v1, and behavior will be inconsistent supporting both. Good luck. We monkey-patch the way document-register-element works a bit so we can have a hierarchy of classes that pretty much call `super()` on each other for various methods. I think there were a few other patches to fix bugs in the polyfill.  - A-Frame Version: v0.7.0
- Reproducible Code Snippet or URL:

Open https://aframe.io/aframe/examples/boilerplate/hello-world/, and select the sphere element in Dev Tools. Then:

```js
$0.setAttribute('position', {y: 2});
$0.flushToDOM();
```

Sphere's position changes from `0 1.25 -5` to `0 2 0`. As of A-Frame 0.5.0 this behaved correctly, leaving .x and .z alone; I didn't check 0.6.0.

Issue filed here from comments from @MichaelHazani and others in Slack. Perhaps turn them into multi prop components? That would also allow for `.setAttribute('position', 'x', 10)` to not have to instantiate a JS object. Hm I'm not opposed to that change, but do you know why it's broken with single-prop components now when it worked in 0.5.0?

I'm assuming this applies to `position` and `rotation` components, and user-defined components too (like my `velocity` and `quaternion`). Not sure. Before it probably worked by coincidence, but component code got refactored or changed, and now does not work. But making it multi-prop would make things easier, before if I wanted to update position, I'd have to getAttribute + change + clone (because getAttribute returns the `data` object) + setAttribute with another object.  Position, rotation, scale are really `faux` multiproperty components. They are single property components of the `vec3` type (that has multiple attributes). We could make it a multiple property with a custom parser that would still allow for the form: 
```el.setAttribute('position', '0 0 0');``` You could still pass in a Vector3 if we move it to multi-prop. A better way to update position now is `el.object3D.position.y = 2`. It will still be reflected in the A-Frame level. @ngokevin that's #3245 right? If we're fairly confident it will be a longterm feature, would be great to have some documentation of what to expect... is `object3D.position` the underlying storage for the `position` component? So `object3D.position.x = 20` should not force any copying? It looks like `getAttribute('position')` returns a `THREE.Vector3` now? But `rotation` is still an `Object`, since we need to convert from radians to degrees?

This feels like the right direction i think, just trying to make the API changes explicit.. seems possible this could break some components. Docs will be added during the pre-release preparation, yeah. The explicit change is modifications to underlying object3D position/rotation/scale will be reflected at the A-Frame level through `.getAttribute` without any explicit syncing phase. It's a top highlight for me for 0.8.0 for ergonomics and likely performance. `object3D.position.y +=2;` - shipped and docced  Thanks! This is a dup of https://github.com/aframevr/aframe/issues/3051 Fixed by https://github.com/aframevr/aframe/pull/3327  I can work on this. My changes in #2973 may be related and I'm working on a similar problem in 
wmurphyrd/aframe-super-hands-component#71 Merged, but will need a small tweak PR to make the touches not delayed.  Yes, this seems a dup of https://github.com/aframevr/aframe/issues/3051  **Description:**

**Changes proposed:**
-
-
-
 If you check the code, see that we still call getGamepads. The only thing I'm throttling is rebuilding the controller list. It's different from what we did before. #2984 was to fix the Chrome issue with `navigator.getGamepads` not getting called, this avenue was not approached. I can't imagine a couple hundred milliseconds affecting applications in controller detection, it will be hardly noticeable. Works on FF. Need to test on Chrome/Daydream/GearVR. @vincentfretin thanks for looking into it! Do you see any performance difference in the controller motion with and without the patch? Worked fine on Chromium/Rift. Is that enough? Anyone want to try to Daydream? I tried this on Gear VR: Oculus Browser and Samsung Internet on a Samsung Galaxy S8. compared to `master`, the controller doesn't seem worse. I can't perceive perf improvements, if there are any.

@ngokevin: which examples are you testing with? [Laser Controls](http://localhost:9000/examples/test/laser-controls/), [Tracked Controls](http://localhost:9000/examples/showcase/tracked-controls/)? Thanks. Either, anything with hands. Perf improvements are memory-leak/garbage related:

<img width="1250" alt="screen shot 2017-10-26 at 3 56 41 pm" src="https://user-images.githubusercontent.com/674727/32080753-4ff48806-ba66-11e7-99e4-c73dbfb438f8.png">
 @dmarcos r? @machemusik Have you had the chance to test it a bit? Do you remember the platforms where we had problems with low framerate controllers updates? @dmarcos This was tested on Chromium/Rift which was one of the platforms. The Gamepad call is called every tick, it's just A-Frame's controller list rebuild is throttled.  The proper solution for this is probably moving the logic to the restore pose of the camera component: https://github.com/aframevr/aframe/blob/master/src/components/camera.js#L99 All right. I think we should then move the logic to save / restore the camera pose / position from the `camera` to `look-controls` as well as the `userHeight` property.   Do this to fix tests: https://github.com/aframevr/aframe/pull/3149/files#diff-f9aac19c37c38417114cd801ed8016c4R12 Fixed the tests.

@dmarcos this fix make sense? We can refactor later. VRControls / VREffect will be soon gone. See https://github.com/aframevr/aframe/pull/3152 I leave it open as a reference and a reminder to port the logic. Nothing to do here. After the removal of VREffect / VRControls this PR is not applicable anymore.  **Description:**

#2958 

The original intention was to add something similar to pseudo CSS selectors. But:

1. State mixins are a scattered / roundabout way of applying DOM data based on an event. The same can be accomplished more simply with events. I use [event-set](https://github.com/ngokevin/kframe/tree/master/components/event-set) and it's easy.
2. State mixins can be slow. Any time a state is added, the entity force refreshes all of its components despite data not having changed. This caused some unexpectedness for me when components were trying to get "updated" with the same data.
3. `.addState`/`.removeState`/`.is` can be done with classes or data attributes while being visible from the DOM.
4. Usage is low. The appearances outside A-Frame are mostly when people copied code from the original `tracked-controls` example. a-blast/a-painter/a-saturday-night does not use states.
5. Less maintenance. The cursor component had lots of states and had to be maintained alongside the events which accomplished the same thing.

**Changes proposed:**
- Remove state mixins auto-appliers.
- Deprecate states.
 The `tracked-controls` examples also uses this features It's easy to port. I can port the tracked-controls example while removing lines of code. Don't think because a couple places uses this prevents us from cleaning up API.

```js
      <a-assets>
        <a-mixin id="cube"
                 geometry="primitive: box; height: 0.30; width: 0.30; depth: 0.30"
                 material="color: #EF2D5E;"
                 event-set__hit="material.color: #F2E646"
                 event-set__grab="material.color: #F2E646"></a-mixin>
      </a-assets>
```

And then delete all the state-related JS code.

See:

- [A-Blast](https://github.com/aframevr/a-blast/search?utf8=%E2%9C%93&q=addState&type=)
- [A-Painter](https://github.com/aframevr/a-painter/search?utf8=%E2%9C%93&q=addState&type=)
- [A-Saturday Night](https://github.com/aframevr/a-saturday-night/search?utf8=%E2%9C%93&q=mixin&type=) Would even propose to remove the state API overall in general since data attributes or classes can do the same thing. I still want to give the API a chance. I think it is useful, similar to CSS pseudo selectors. The state API is used in the A-Frame code itself for instance by the cursor and when entering vr. I've seen people relying on it. It can be implemented too with data attributes but it means more coupling with the DOM and not as terse and elegant as doing `el.is('alive')` These APIs have resulted in almost 0 maintenance so far. Every time a state is added (e.g., the cursor component), even if I'm using mixins at all, the mixin state updates will do a mass component update (`.updateComponents`), which is a large waste of perf. I just ran into a bug just now because it was running a mass `.updateComponents` even when no relevant data has changed any time state was added/removed, I had no mixins, and no event listeners.

People haven't been "relying" on it as much as it was used in tracked-controls examples and we shipped it, and then the code was copied and pasted around. I wouldn't say because it was useful. A-Frame is inherently DOM so coupling is not a concern, and even so I'd rather see this done outside the core repo if it's an experiment. I've ported all the instances in A-Frame to not use states.

I'm not sold on the CSS psuedo selector idea. It's a scattered/roundabout way of updating component data. We have JS code that adds state, we have to add a mixin in `<a-assets>`, and then another mixin based on that mixin name with a suffix, and then apply the mixins on the entity. It's much less magical and more straightforward to write a component (or a helper component). super-hands does not rely on states that heavily. The codebase has states because a lot of the code was based/copied on the tracked-controls collider and cursor. Actual usage of the states is low in the codebase. > Every time a state is added (e.g., the cursor component), even if I'm using mixins at all, the mixin state updates will do a mass component update (.updateComponents), which is a large waste of perf. I just ran into a bug just now because it was running a mass .updateComponents even when no relevant data has changed any time state was added/removed, I had no mixins, and no event listeners.

I'm not 100% following here... why were states triggering component updates? Just to explore options, couldn't we keep the State API but not use it this way in Mixins? I.e., still have methods for `addState`, `removeState`, and `is`, which fire events, but not tie mixins into that? Or does that not leave enough proven uses for states, if Mixins don't use them?

I was using states while working on a [state machine API](https://github.com/donmccurdy/aframe-extras/tree/feat-state-machine/src/state-machine), which seemed to be working nicely, but I suppose I could just as easily have made a `state` component.

 Yeah. I found the state API useful specially to develop UIs. We're providing pretty high level UI components like `hand-controls` and `laser-controls` that emit events and also modify the state of the entities. Event driven architectures are sometimes confusing and is useful to have a way to explicitly query the state of an entity. The state API is handy and very low footprint. My vote to keep it. Here's the footprint, consider you use states instead of events, which run frequently:

1. [`addState`](https://github.com/aframevr/aframe/blob/master/src/core/a-entity.js#L822) calls [`mapStateMixins`](https://github.com/aframevr/aframe/blob/master/src/core/a-entity.js#L836)
2. [`mapStateMixins`](https://github.com/aframevr/aframe/blob/master/src/core/a-entity.js#L137) registers a new mixin for every mixin the entity has, and then it runs [`this.updateComponents`](https://github.com/aframevr/aframe/blob/master/src/core/a-entity.js#L150) which does a mass component update.
3. [`registerMixin`](https://github.com/aframevr/aframe/blob/master/src/core/a-node.js#L150) as a side-effect also creates a Mutation Observer for each mixin the entity has.
4. An event is emitted.

The similar happens on `removeState`. So if everything is running on the state API rather than events as we often use now, these run on any thing that happens in the application, even if the entity is not even listening to these states. By providing both states and events, there's redundancy on how to handle things, and I think events are fine for handling these.

The way states are used today, are pretty much for events. In `tracked-controls`, all it is used for is "color this when the cube is hit, color this when the cube is unhit", it doesn't use the `.is()`. The `laser-controls` examples don't use it either, nor the painter/blast/saturday. If we want to query whether something has happened, it should be up to the application on how to keep the state. Just testing on one very simple constrained event in `tracked-controls` example:

## With States (Before)

Changing the color of a cube on mouseenter takes **8ms**. Bottleneck on `updateProperties` calls from which is from state mixins mass component update + new mixins. `buildData` shows up high on the call tree and memory allocator.

<img width="838" alt="screen shot 2017-10-12 at 9 53 39 pm" src="https://user-images.githubusercontent.com/674727/31516447-e4543d6c-af98-11e7-904c-8e0e7bba579f.png">
<img width="1252" alt="screen shot 2017-10-12 at 9 51 48 pm" src="https://user-images.githubusercontent.com/674727/31516448-e4734e64-af98-11e7-9562-6eea67536c4e.png">

## Removed States (After)

Changing the color of a cube on mouseenter takes **6ms**. No large `updateProperties` call. `buildData` does not show up on the call tree and memory allocator. And simpler user-facing API IMO with `event-set`.

<img width="1249" alt="screen shot 2017-10-12 at 9 58 28 pm" src="https://user-images.githubusercontent.com/674727/31516510-1617cd0a-af99-11e7-903e-6b9835692577.png">

<img width="1257" alt="screen shot 2017-10-12 at 10 05 38 pm" src="https://user-images.githubusercontent.com/674727/31516643-8a190368-af99-11e7-8bd3-e700dff79b20.png"> I don't have any issue with removing the state mixins feature. Ok to go ahead, IMO.

But the case for deprecating states entirely is less clear. It is kind of nice being able to just write `el.is('cursor-hovered')` without needing to have been listening to that element from the beginning. What if my component was created after the hovering began? It's not widely used, but it is a minimal API, so not much maintenance benefit to removing that. More specifically, I'm still hopeful states will be helpful for managing transitions between animations, NPCs, and little things like that. I've been planning to do more to test that, but have been blocked by (1) poor support for FBX/COLLADA animation, and (2) lack of a way to export multiple animations from glTF. I'm not as hardly opposed to keeping states, but I'm not quite comfortable either. I like not having special ways to do things that can already be done easily (e.g., data attributes, data sets, classes, a variable in a component, a variable in system). It also signals to developers "this is the way to do states". It's not quite how I'm handling state, and I don't think we've built enough applications to decide it's the best way. At least painter/blast/saturdaynight are not using them. > I don't think we've built enough applications to decide it's the best way. At least painter/blast/saturdaynight are not using them.

I agree we haven't researched enough to decide what the best way is now. But, we might as well keep the status quo (i.e. not delete an API that has been around a while) until we have something to recommend. Is there anything in painter/blast/saturdaynight that we'd suggest users imitate?  > It also signals to developers "this is the way to do states".

Pretty weak signal, given that it's used so rarely. üòâ I don't think it hurts anything to keep this API around until we can make a more definitive suggestion on how to do states. Yeah, it's definitely easier to keep the state API in. But I do see though like if you leave it in, there are components like `super-hands` that start to use it, and people copy/paste, and then it spreads. Then if you ever want to change it, it becomes harder down the road. But I guess we can do something when we get there. If we keep states, are we OK with removing it from like `cursor.js`? Or wonder if we can agree about the state mixins?

In the PR, I replaced the `.is('vr-mode')`with data attributes, but that was just showing what it would look like if we removed completely. They still feel a bit redundant. The addState/removeState does the same thing as events (e.g., `addState('hovered'); removeState('hovered');` vs `emit('hover'); emit('unhover')`, except that it keeps track of a boolean. I don't think keeping track of a boolean is necessary to introduce an API largely similar to events.

Several ways to do the same in a separate component without prescribing components to both emit state changes and events. The cursor component is an example of redundancy between them: for every event, it also has to maintain state stuff. For them to be useful, you'd need most components to implement states. These examples, the states are only maintained on demand:

```html
<a-entity state__hovered="on: mouseenter; off: mouseenter">
<!-- el.getAttribute('state__hovered'); -->
```

```html
<a-entity state="on: triggerdown; off: triggerup; name: pressed">
<!-- el.dataset.pressed or el.getAttribute('data-pressed') or el.states.pressed or el.is('pressed'), whatever. -->
```

Looking to at least remove the state mixins though. For performance (measured above), and also I'm experiencing weirdness where because the cursor component uses states, when I hover, the entity force-refreshes all of its components, and I get odd behaviors of entities jittering around. > Looking to at least remove the state mixins though.

Again, certainly, +1 for removing state mixins. 

>  I don't think keeping track of a boolean is necessary to introduce an API largely similar to events.

The question is whether now is the right time to delete an API we've already introduced. I do not think we should, until we have docs and examples to point to a replacement way of doing things and determine that it's better (or at least not worse) than what we're currently doing. The `state` component you show looks OK, but would need some thought about how to use it programmatically. `el.components.state.is('foo')`? Is that `state` component going to be in Core?  I don't think this all needs to be one PR. Was the state mixin feature ever documented? I remember staring at the tracked controls example source dumbfounded about how the color changed until I found state mixins code in core. 

I've already been working towards deprecating the only real dependency on state in super hands (i.e. the interface with sphere-collider), so I won't miss it. 

I did push state mixins as the easiest way to customize reactions in super hands. Would it be possible to pull `event-set` into core when dropping state mixins? It's nice to have a non-JS option for newcomers to add basic interactivity without adding another dependency `event-set` is opening a can of worms by introducing logic into the DOM a la angular. I think it should remain as a 3rd party component. I can always bundle it in super-hands I can split it. It's less risky to keep it but clarity is nice, and if you plan on deprecating something, better to do it early before it spreads via copy/paste. Just wanted to discuss while it's up.

The programmatic is described in the examples: a `.getAttribute` call (`el.getAttribute('state__foo')`), no extra API, and follows the same as the rest of A-Frame. No need to depend on the emitting component to implement states, components just emit as usual.

Would not put it in core as I haven't seen much usage. Most instances of set/removeState are from copy/pasting tracked-controls example code. I don't think it's a problem transitioning that small audience of the API since they maintain states but do not use them in applications. Deprecating an API is fine since upgrading is a deliberate step, and we just add migration notes/tips in the changelog.

I'll open a PR for the state mixins though. > ```
> <a-entity state__hovered="on: mouseenter; off: mouseenter">
> <!-- el.getAttribute('state__hovered'); -->
> ```

This syntax doesn't work ‚Äî the component still needs to be present while it's waiting for the event to fire, and presumably after it turns off.

Not to say we can't make a `state` component workable.. just needs some thought. Having this API spread only to eventually move it to a third-party component would be no worse, IMO, than having the community components all handle state in slightly different ways, so that there's no consistent API. I wouldn't introduce event-set in core, but FWIW, I've had no issues with event-set being hard to follow for toggling simple things. Comparing to Angular is extreme where it was messy due to the two-way data bindings that propagated changes throughout the application all in DOM. The way event-set is used, I wouldn't call logic as much as CSS pseudo-selectors are.

> This syntax doesn't work ‚Äî the component still needs to be present while it's waiting for the event to fire, and presumably after it turns off.

I think that's a lot easier to control than having to depend on the component implement states. Some will, some won't. At least events are dependable on being available. States will always be handled in slightly separate ways, there are too many different ways to keep track of a boolean. Closing for now after state mixins removal and will re-evaluate later, thanks!  thanks! Nah don't care, just fixed it up to merge it quick   thanks!  Would it be easier to edit the code instead?  Thanks! Can you update to 0.7.0, change the text to say hover vs. click, and apply a gray default color? It's already merged so it's fine. Thanks!  should be something like `enhances the behavior of`  The page is back, I just had to fix an error in the Markdown file and re-deploy.  cool will check it out  /cc @olga-microsoft @Malwine I don‚Äôt have a Windows Mobile phone to test on. Do you see any errors in console? Do any of the webvr-polyfill examples work. For example this one: https://webvr.info/samples/03-vr-presentation.html?polyfill=1 This triggered an old memory. A friend once told me that Edge Mobile DeviceMotion API apparently returns the `rotationRate` in degrees instead of radians. We have to add an `isEdgeMobile` clause to the following if statement in the polyfill to account for that:

https://github.com/googlevr/webvr-polyfill/blob/032684215904eadec83f3e8ca7e82fd69cdd993f/src/sensor-fusion/fusion-pose-sensor.js#L152 

That's why probably the `webvr-polyfill` examples orientation jumps around @olga-microsoft Probably. The decision should be made by the [polyfill](https://github.com/googlevr/webvr-polyfill) maintainers.  /cc @frederic-schwarz very nice example!  I suggest opening an issue on the [super-hands](https://github.com/wmurphyrd/aframe-super-hands-component) and determine there whether it's an A-Frame or a `super-hands` bug. I don't know much on how `super-hands` is implemented. I encourage using the Slack channel as well since people that use `super-hands` hang out there. In the meantime you can still use `0.6.1` if you don't need any of the features in `0.7.0` using `hand-controls` and `laser-controls` and `super-hands` all together looks iffy to me. I'm pretty sure you'd want to just choose one of those three. Could be some sort of race condition there and 0.7.0 just changed the loadout order.

Note that if something else is already loading a model (like `hand-controls`) then `laser-controls` might as well be `cursor` and `raycaster="showLine: true"`.  Thanks, I have made a PR which will index the docs once it's merged https://github.com/algolia/docsearch-configs/pull/225  Thank you!  Thank you!  Congrats on your first PR! The fix will ship in A-Frame `0.8.0` in Nov/Dec timeframe. You can always play with master by pointing to https://rawgit.com/aframevr/aframe/master/dist/aframe-master.js Just FYI, @dmarcos is right, but if you don't want all the other changes that will happen in master, it is safer to use your specific commit rather than latest master.  Closing in favor of https://github.com/aframevr/aframe/pull/3079  some of the text didn't seem to come through, did you need to enclose portions in backticks like `this` ? Fixed by https://github.com/aframevr/aframe/pull/3079  It is miliseconds. The documentation is correct  Thank you!   Thanks! All PRs should be done against master. The version branches are just for deployment purposes.  I would pass a querySelector for the raycaster to interact with the links like in the [example](https://github.com/aframevr/aframe/blob/master/examples/test/laser-controls/index.html#L53). Something like this:  `<a-entity laser-controls="hand: right" raycaster="objects: [link]; far: 100;"></a-entity>` Make sure that the distance of the raycaster is enough to reach out the objects you want to interact with. Please reopen if the [link traversal example](https://aframe.io/aframe/examples/showcase/link-traversal/ ) is not working for you. If it does then it's something specific to your application and better to discuss it on Slack or Stack Overflow. Very possibly same issue as #2980.  Hi @zzylovecode ‚Äî the [3D Models ‚Üí Troubleshooting](https://aframe.io/docs/0.7.0/introduction/models.html#troubleshooting) section in the docs is the best general advice we can offer if your model isn't working as expected.

If you've gone through all of those steps and still aren't getting anywhere, then we would need to see a demo and the source model to help.  `mode` is a vague name. I would keep the `whiteSpace` property name and make sure that value is mapped to the `mode` attribute of `three-bmfont-text`  This is cool, but swapping the environment causes hangs in the scene, right? I mean the performance is not really good, we can't really recommend slow scenes. Perhaps do something less intensive on the clicks. For example, changing some text, or making something a different color, popping up elements  I believe this is the same issue as #2980: the raycaster's cache must be cleared after models load. We're considering ways to do this automatically, but you can add a component in the meantime:

```js
AFRAME.registerComponent('raycaster-refresh', {
  init: function () {
    var sceneEl = this.el.sceneEl;
    sceneEl.addEventListener('object3dset', function () {
      var raycasterEl = sceneEl.querySelector('[raycaster]');
      raycasterEl.components.raycaster.refreshObjects();
    });
  }
});
```

```html
<a-scene raycaster-refresh>
  ...
</a-scene>
```  Thanks! üëå  It could be many things. You will have to share your shader code and a full working example for people to look at. If you move the plane further from the camera or make it smaller the problem still persists? Make sure it is not a clipping issue This is using a 3rd party shader. This is a more appropriate question for the Slack channel or Stack Overflow since it is not an A-Frame specific bug or feature request  Yeah, it's because it's based on scroll position so if the page doesn't scroll down far enough, it won't highlight. Not sure if it's a big deal, but we could add a special case to detect if user has scrolled all the way down and highlight bottom at https://github.com/aframevr/aframe-site    They're called by a shared util https://github.com/aframevr/aframe/blob/master/src/utils/tracked-controls.js#L22

The cursors work OK with the mobile controllers. See `laser-controls` for an example

Let me know if they don't work and provide an example of code  That'd be cool, probably will elect not to maintain within the core repo though since there'd be overhead in keeping those resources up to date. The vast majority of people will be online.

Though what works for being offline is cloning the repo and doing `npm install && npm run docs` for offline docs.  Not quite understanding the issue. userHeight can't be disabled, not applyingl, incorrectly applying> This problem should be gone in master now. I will wait for a more through testing / confirmation before closing @pandalion the fix is in the master branch, if you want to test that, but otherwise you'd need to wait for 0.8.0. Fixed by https://github.com/aframevr/aframe/pull/3327  Stack Overflow would be a place to ask for support. But:

https://aframe.io/docs/0.6.0/components/screenshot.html#properties

`<a-scene screenshot="width: 200; height: 200">`  To kick the tires. You can use one of the Google WebAR experimental apps: [WebAROnARCore](https://github.com/google-ar/WebARonARCore) or [WebAROnARKit](https://github.com/google-ar/WebARonARKit) and @chenzlabs AR component https://github.com/chenzlabs/aframe-ar I'm closing this because this is not a bug o feature request but a question more suited to StackOverflow  This solves a lot of issues with controllers connecting / disconnecting and the cases where the camera starts on the floor or unexpected position. We should have done this a loooooong time ago üòÑ @olga-microsoft this improves a lot the behavior of the `windows motion controllers` in Edge. r+wc suite.only  `windows-motion-controllers` hides the whole entity if the expected controllers are not present. This will also make any other controllers (Vive, Oculus...) invisible. I replaced the change in visibility of the controllers entity with the visiblity of just the windows motion controllers model if there's one already loaded. I tested more thoroughly the windows motion controllers in Edge and I find inconsistencies: I ofthen see just one controller when starting Edge and switching it on/off does not help. Also switching off and back on when the controllers are properly tracked does not seem to work. Not sure yet if the problem is Edge or A-Frame but Vive + Firefox seem to work more reliably when it comes to detect and track the controllers. Are you experiencing the same problems on Edge? @leweaver @olga-microsoft 
  Good catch. Just fixed it on https://github.com/aframevr/aframe/commit/47875a0eb6b05f54acbcc1bb2c135be4b75fc33e  Thank you!   Perhaps makes more sense for the use case of media streamed audio over multiuser to handle it within a separate component. Don't feel comfortable have the sound component handle both buffered audio as well as streams. Multiuser setups will have their own custom components for several things. I think this should be a component. That's what A-Frame is set up to do. Anyone can create components that do one thing and do it well. Supporting more things in the core sets a dangerous precedent to support even more things in the core. I think the sound component already does too much since it supports pooling (should have been a separate `sound-pool` component).

We might find as well that the Positional Audio default with three.js does not work well for multiuser, and we'd later be forced to continue to add more features and such to maintain it proper. I see there's already custom stuff happening in https://github.com/networked-aframe/networked-aframe/issues/11

So I recommend a component + Glitch, and we'd be happy to feature it in the documentation for people to remix. Next time I'll try to make the decision to close earlier so efforts aren't wasted. Thanks for understanding. Not sure whether that property type should pass through audio. The current three.js audio helpers do an XHR directly to the URL, they do not touch the audio element. It's better to pass a string. You also don't need to use `<a-assets>` for media streams because `<a-assets>` is for preloading only, and streams can't be preloaded. You can always use a string type or selector type and handle how you need. Right now, the sound component does not use the raw audio element so it doesn't make sense to change the behavior.  Closing for reasons in https://github.com/aframevr/aframe/pull/3042

This can be done more simply in a separate component. The primary reason for this feature was for multiuser, and I'm sure that these changes will not be the only changes needed for that in the future. In the `networked-aframe` issue, some people mentioned there are more things to be done. So faster to do separately. Thanks!  I've noted it more simpler and more appropriate places: 
 https://github.com/aframevr/aframe/commit/1d92dbb3d0680cec3c1218c718bb44c639ab9f5c

Note A-Frame mentions to be mostly tool agnostic, but does not mean compatible with all Web. Mutation observers are also not a common API web developers will use or be aware of. Good point, didn't see that. I'd add that to the FAQ and to the debug component...and then perhaps a Caveats section in the JS section linking to the FAQ. Would you mind adding that? Don't think we need a whole paragraph and code section though; mutation observers and attribute selectors on positions are not very common operations. Ok, yeah I thought MutationObservers were too narrow a topic for the FAQ, but something like `el.querySelector('[position=0 2 0]')` does maybe broaden the scope enough to include. That's fine with me. I do think we want to keep the code part light (ideally inline, if any) since these are not examples that people should imitate.  https://github.com/aframevr/aframe/commit/1d92dbb3d0680cec3c1218c718bb44c639ab9f5c  (Using latest master.)
@dmarcos @leweaver @olga-microsoft can you confirm? Thanks @NellWaliczek - that rationale makes sense.  Let me know how/whether folks not on the browser call can participate... Will give the alternative strategy a try. No luck with the workaround, as history.pushState() will not actually effect transition between two pages on same domain for example; using history.pushState() then history.go(0) appears to both fail to transition to the newly pushed location, and also to destabilize Edge. @machenmusik `history.pushState()` is not a drop-in replacement for page navigation; developers would need to use it alongside JS code for changing the DOM when the URL changes. The browser does not technically request a new page: this is most commonly combined with Single Page Application routers in React/Angular/Vue. In A-Frame, I think I think the History API is a good choice if you're using one of those frameworks already. If not, @ngokevin's state component might be easier to work with. @donmccurdy yes, understood that `history.pushState()` is not a drop-in replacement, but really for a single page application there is no need to do it this way at all; there appears to be no workaround at present for anything except single-page applications. > there appears to be no workaround at present for anything except single-page applications.

Right, just meant to clarify that. The only way to stay in VR is to stay within a single page. History API just provides a way to persist state in the URL, for users who want to do that, as it can accomplish some but not all of the goals of traditional page navigation.  Nice! Thank you!  Thanks for the details! 

I can [reproduce the problem in three.js too](https://gltf-viewer.donmccurdy.com/#model=https://s3.amazonaws.com/bug-figures/v2-locrotscale-cube-embedded-buffers.gltf), so it's not specific to A-Frame. Might be THREE.GLTFLoader, or might be the exporter... will try to figure out what's going on and report back.

Also, could you include the `.blend` file?  One observation, if the interpolation mode in Blender is changed to "linear", the animation plays normally. There seems to be some issue in THREE.GLTFLoader with playing cubicspline animation.

[cube_linear.zip](https://github.com/aframevr/aframe/files/1290245/cube_linear.zip)
 I think THREE.GLTFLoader is not interpreting cubic spline output values [according to the spec](https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation).

The output data looks like this for the `scale` channel, where each keyframe is a 9-float set.

```
[0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1.0448137521743774, 1.0448137521743774, 1.0448137521743774, 0, 0, 0, 0, 0, 0, 1.0448137521743774, 1.0448137521743774, 1.0448137521743774, 0, 0, 0, 0, 0, 0, 1.0448137521743774, 1.0448137521743774, 1.0448137521743774, 0, 0, 0 ]
```

Based on the error being thrown, three.js has interpreted this to give scales of `0 0 0`, which creates a degenerate matrix. There may be some conversion necessary, within GLTFLoader, to format the keyframes in the way that three.js expects.

@takahirox I noticed https://github.com/mrdoob/three.js/pull/10032; is this something you are familiar with from working with MMD? Filed https://github.com/mrdoob/three.js/issues/12233, as this issue is really in GLTFLoader, and closing the issue here.  Thanks! Opinion without supporting data and based on personal experience. When you end up reading a Readme file in a github repo, you are likely to have an idea of what the project is about and want to kick the tires as fast as you can. I prefer to see clear and concise instructions to get started first. The organization you're proposing is more appropriate for a project website instead of the README file of the source code. @ngokevin what do you think? Sorry I just realized that it's not a PR against the README file. I still favor having onboarding instructions first. @ngokevin has probably more to say thanks for opening this PR. I do agree with @dmarcos' recommendation about keeping the section placement as is. although it make hierarchically flow better with this change, presenting this information above is likely better for onboarding developers quicker with useful sample code.
 This was done on purpose to keep the quick started information above the fold versus paragraphs on exposition. Thanks though.  A-Frame already uses the device motion APIs as a fallback to rotate the camera on mobile phones. What browser and phone are you using? https://aframe.io/aframe/examples/ work on all my iOS and Android devices.  Thanks!  What browser? Can you provide a link that uses the video you captured? Need to enable CORS for your asset  Thank you!  There are some details in the documentation for the [`debug` component](https://aframe.io/docs/0.6.0/components/debug.html). In short, the DOM is not actually modified when calling `setAttribute`. MutationObserver can be relied upon to tell you when a component is added/removed, but not when its data has changed unless the `debug` component is in use (which isn't recommended it production, for performance reasons). @delapuente can you confirm that `MutationObservers` is working if you use the debug component? Thanks for filing, there are events to help you detect when's component is changed initialized or removed https://aframe.io/docs/0.6.0/core/entity.html#events_componentchanged You can poll if you need more frequent updates. A-Frame does not aim to follow the 2D Web exactly. It's not worth the performance hits to enable mutation observers. https://aframe.io/docs/0.6.0/introduction/faq.html#why-is-the-html-not-updating-when-i-check-the-browser-inspector

https://aframe.io/docs/0.6.0/components/debug.html It's commom in game development to favor polling over event driven programming. It makes things more explicit and gives control to the developer on when to obtain the most up to date information when needed. In A-Frame we want to make things easy in a way the encourages good practices that lead to good performance. @delapuente could I suggest putting this note about MutationObserver in the *JavaScript, Events, and DOM APIs* documentation instead of the FAQ? I agree it is unexpected behavior to web developers, but it is not very frequently asked about. Thanks!  As you mentioned `THREE` is bundled with `A-Frame`. No enough context in this issue to investigate what is going on. You will need to share an example of what you're trying to accomplish. Make sure that there's no code trying to use `THREE` before `A-Frame` loads Try to run `THREE` examples and make sure webgl is working on node webkit on Windows on your particular hardware Yeah, not enough information. It should work, but Stack Overflow would be a place to ask provided more information.  I think this is the proper solution for https://github.com/aframevr/aframe/issues/3019 but I have not tested yet on headset. I can do a pass tomorrow on Oculus / Vive and Microsoft Mixed Reality headsets. @leweaver Can you also verify on your side that this fixes the problem?
 Tried this on Oculus / Firefox 55 and it fixes the issue. @olga-microsoft Thanks for testing this. I made a couple of changes to consider the cases you mentioned. Now when disconnecting the headseat VR mode disengages automatically. Please, let me know if this covers every case now. @olga-microsoft I might need some help here. What browsers / headsets are you testing on? It is working as expected for me on Firefox / Oculus:

1. I start Firefox with the headset connected.
2. Click on the Googles to enter VR (VR mode engages and head tracking works as expected).
3. I unplug the cables (I tried the USB and HDMI independently and both at the same time) VR mode exits, the googles icon renders again and I can move the camera with mouse and WASD keys.
4. I click on the googles icon and the browser goes on fullscreen mode.

Do you see any errors in console? @olga-microsoft I see. `vrdisplayconnect` / `vrdisplaydisconnect` don't fire reliably with Firefox + Vive. It's a known bug (https://bugzilla.mozilla.org/show_bug.cgi?id=1397397). Do you have an Oculus to try on? 

On Edge + Win Mixed Reality. Can you try the following example (https://webvr.info/samples/00-hello-webvr.html) and see if you get the proper messages for `vrdisplayconnect` / `vrdisplaydisconnect` when plugging / unplugging the headset? (The screenshots below are taken on Firefox + Oculus)

![image](https://d3vv6lp55qjaqc.cloudfront.net/items/3d1G0z1N2w0e3G3S3w1L/Image%202017-09-07%20at%203.49.48%20PM.png?X-CloudApp-Visitor-Id=681eb91758819d0066e71ca9eb6d31d7&v=6280de15)

![image](https://d3vv6lp55qjaqc.cloudfront.net/items/2F320c2D1e3J0X0w310f/Image%202017-09-07%20at%203.50.12%20PM.png?X-CloudApp-Visitor-Id=681eb91758819d0066e71ca9eb6d31d7&v=39470660) Interesting. It seems you're seeing the render loop crashing and does not recover. Could it be that when the headset is unplugged in the middle of the render loop there's a last call to `submitFrame` that does not finish properly? The `vrdisplaydisconnect` would be dispatched after that call.  It looks there's a time discrepancy between Firefox and Edge somewhere. When unplugging the headset on Edge the vrDisplay.requestAnimationFrame is cancelled implicitly and the callback never invoked stopping A-Frame rendering loop. In Firefox somehow the callback of the ongoing requestAnimationFrame is invoked one last time after the headset is unplugged so the render loop has a chance to seamlessly switch to window.requestAnimationFrame. I'm not sure what is the expected behavior. It's not something we define in the spec (https://w3c.github.io/webvr/spec/1.1/#dom-vrdisplay-requestanimationframe) I pushed a change to restart the render loop when disconnecting the headset that you can try. @olga-microsoft let me know if that solves the issue on Edge. I still have to improve the approach since we don't want to end up with multiple render loops on Firefox Thanks! I'm now calling `cancelRequestAnimationFrame` on the handler for `vrdisplaydisconnect`. I also works on Firefox 55 / Vive  Thanks!  Someone pointed out in Slack that the default `<a-sky/>` element already exceeds the faces limit:

![screen shot 2017-09-04 at 8 53 20 pm](https://user-images.githubusercontent.com/1848368/30095138-7b329192-9285-11e7-83ef-4742209d81a7.png)

Maybe the sphere resolution should be lowered, maybe not, but regardless I think the stats threshold seems too low. Seems like the limit should be at least `maxVertices / 3`? Is there some validity to it? Ideally even though it's a bit more work and we should add more support, people would use cubemaps to get it down to 6 faces? I don't think there's any ~validity~ consistency to it ‚Äî if 12000 vertices is OK, then 12000 / 3 faces should be OK too. Could someone point me to where this limit is defined? Digging around and can't seem to find it. The faces limit is really not consistent with the vertex limit here. Also ‚Äî perhaps the `stats` component should include a link to our performance best practices doc, where we'd explain what `Calls` means etc.?  I think the exclamation is intentional to emphasize. @ngokevin ?  As I mentioned in PR #3010 Mozilla‚Äôs high-level goal is to continue its official support, leadership, and involvement, as it has since A-Frame‚Äôs creation by our staff. We‚Äôd be open to making the following contributions explicit:

- Continued role as A-Frame mark holder and defender
- Administration and security of all of the A-Frame sites and services
- Supporting the employment of at least one full time staff member in a peer/maintainer role on A-Frame

There are several ways to formalize this support that we would be open to and willing to have our Legal team help draft. One example to start the discussion would be the Thunderbird model, which is now an independent project but has an explicit commitment from Mozilla to continue a particular level of staffing, funding, and involvement:
https://wiki.mozilla.org/Modules/Thunderbird
https://wiki.mozilla.org/Thunderbird/New_Release_and_Governance_Model

Additionally, it is Mozilla's goal to ensure others can continue to meaningfully contribute and help lead A-Frame's continued development, which has always been a part of what makes Mozilla projects successful.

Since the question has come up in the past, a completely hands-off approach like the one Mozilla used in the most recent governance model for the Rust project doesn't fit as well for A-Frame. That project required a higher level of independence in order to assure potential contributors and users that the Rust language would not transition from a systems programming language into a browser-specific programming language. Mozilla does not expect that model would be used with any projects in the future, excluding those in which we no longer expect to invest.
 Cool, sounds good to emphasize Mozilla's support in the governance as long as contributors can continue to drive the project and community. Over its years of effort, A-Frame has thrived best organically, in a community-driven, hands-off, and transparent approach. I hope that continues to remain the case. It does feel awkward to have a community-oriented project's governance drafted by a legal team, and I don't wish to change the way A-Frame currently runs to match a different project like Thunderbird (which has a different scope and structure). But if necessary, Mozilla's legal team can draft a proposal that aligns with both Mozilla's interests as well as the broader community's. Thanks! Hello, is there any update to this? Sorry for the delay! I was out last week but am continuing to push this forward internally. As a quick update, I'm working with the folks who are looking to formalize Mozilla's involvement in projects that look like this - including Servo and several others. If there's a rapid timeline you'd like to close this down in, I can work to get something for A-Frame in place more quickly, but I believe that half of the A-Frame core team is on PTO and off the grid the next two weeks anyway :-)

Is there something you needed addressed sooner? Happy to work with your timelines if there's some deadline you're trying to meet, but I'm also sensitive not to rush this kind of work and leave time for some back-and-forth.

 No problem, I was just looking for any form of update or response. We should expedite this soon, past a month becomes worrisome to hold on important issues. Yup, I'll get Diego working with our internal folks on Open Innovation who are working in the governance space in the next week or two. Thanks!  **Description:**

A-Frame is experiencing bad performance on desktop Firefox / Vive.

https://bugzilla.mozilla.org/show_bug.cgi?id=1394561

`- Make sure you are disabling the normal 2d display's requestAnimationFrame callback when the VR presentation has started`

Tip from @kearwood to disable the window's requestAnimationFrame in VR mode. There is some flux with three.js's removal of VREffect, but it would still be up to A-Frame to handle this switching as it has its own RAF.

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 I don't think we're using `window.requestAnimationFrame` in VR mode. We use the VREffect `requestAnimationFrame` (https://github.com/aframevr/aframe/blob/master/src/core/scene/a-scene.js#L643) that drives the component ticks as well. VREffect switches to `window.requestAnimationFrame` or `vrDisplay.requestAnimationFrame` depending if we're in VR mode or not: https://github.com/aframevr/aframe/blob/master/vendor/VREffect.js#L184 Yes, sorry, this does not seem to be the culprit. We will need to investigate more to see why A-Frame is suffering latency when the WebVR samples are OK.  Am I correct to assume that this is happening in Edge?  A-Frame is focused on VR use cases and an OrtographicCamera does not make sense on a stereo / vr context.  Can you share what is your use case exactly? FWIW you can do this with a little hackery:

```js
AFRAME.registerComponent('ortho', {
  init: function () {
    var sceneEl = this.el.sceneEl;
    sceneEl.addEventListener('render-target-loaded', () => {
      this.originalCamera = sceneEl.camera;
      this.cameraParent = sceneEl.camera.parent;
      this.orthoCamera = new THREE.OrthographicCamera(-1, 1, 1, -1);
      this.cameraParent.add(this.orthoCamera);
      sceneEl.camera = this.orthoCamera;
    });
  },
  remove: function () {
    this.cameraParent.remove(this.orthoCamera);
    sceneEl.camera = this.originalCamera;
  }
});
```

```html
<a-scene ortho>
  <!-- ... -->
</a-scene>
```

But as @dmarcos says, A-Frame is not meant to be a general 3D library (as three.js is), it is focused on VR (and/or AR,XR,MR...), so ortho is probably not a case we can guarantee support or documentation for. Yeah, you'll need to write your own controls components possibly to work with ortho and manually replace the camera as Don suggested.  @promontis An orthographic camera and all its implications would be very hard to maintain. You can always build your own component as suggested above that you can ship with your editor. Is that an option for you?  Thanks!  Nice - I had actually done a version relying on `tracked-controls` changes from #2583 which are similar to those you made here, but I didn't have actual controller models.  Wonder if it makes sense to merge them FYI, working implementation on top of #2583 is here:
https://github.com/chenzlabs/aframe/tree/support-spatial-controller I missed one important thing. We should incorporate the `windows mixed reality controlers` into `laser-controls` too which are the A-Frame cross device universal controls (3DOF and 6DOF). It should be pretty straight forward. Just add the controls to the list: 

https://github.com/aframevr/aframe/blob/master/src/components/laser-controls.js#L18

And provide the appropriate event mapping and offset for the raycaster (so it's casted from the proper position of the controller):

https://github.com/aframevr/aframe/blob/master/src/components/laser-controls.js#L46

 Thanks for the patience. This is a big patch with a lot to discuss.  We're pretty close though Yes please, add the commit to this PR Hi folks, where are we on this one?  Going back to the original description of changes, it seems as though the priority order is this...

> Changes proposed:

> Windows Motion Controller support

This we definitely want ASAP, for the currently publicized handed controllers at least. I think that only a small subset of this PR is needed for that.

> Consolidation of tracked-controls duplicated logic to a single utility function

I think much of this PR is for this consolidation actually.  Do we need it?  We have been talking about refactoring, this could be first step.

> Added error callback on glTF-model component

Nice to have.

 This is pretty close! I think some rethinking refactoring is due to the controllers API after 0.7.0 release. The remaining changes If I have not missed anything are:
https://github.com/aframevr/aframe/pull/3013/files#r137131772
https://github.com/aframevr/aframe/pull/3013/files#r136705108
https://github.com/aframevr/aframe/pull/3013/files#r136705073
https://github.com/aframevr/aframe/pull/3013/files#r137129564 @leweaver Is there anything that can be done at the model / materials level? Adding a light  to the controller is a possibility but maybe too prescriptive and confusing when authors want to have control of the visual appearance of the scene. If nothing can be done at the material level we maybe consider add a light property to the `windows-motion-controls` component that it's `false` by default. This way devs that want to turn the lights on can opt into it. I believe this is the last pending change? https://github.com/aframevr/aframe/pull/3013/files#r137319556 Thanks! ü•á No need to include the built files. @leweaver Will you open a separate PR to point the models URL whenever we merge them on the `assets` repo? Thank you!  Thanks!  **Description:**

As commonly requested, this PR outlines the governance with added moderators: 

Project Maintainers: @dmarcos @donmccurdy @ngokevin
Moderators: @AdaRoseEdwards @Utopiah 

For clarity/efficiency and to enforce the explicit governance, we propose to have only maintainers keep admin/write permissions to the @aframevr organization and its repositories (unless provided otherwise such as with @fernandojsg and the Inspector).

The Code of Conduct has been updated to adapt to A-Frame's community, previously copied from Rust. The Code of Conduct has been tweaked and streamlined for A-Frame with some less redundancy. It looks good to me lgtm! Thanks for kicking off the formal discussion of governance, Kevin! As we discussed in the past, this is an issue that has been informal since the project‚Äôs inception and I‚Äôm excited to see something codified as the project grows and matures.

At a high level, I think A-Frame‚Äôs governance ideally ought to take into account existing members and organizations, as well as Mozilla's historical role as the steward. This would also allow Mozilla to continue to invest in protecting and growing the A-Frame brand, services and web properties, and development. 

I‚Äôd like to propose having a conversation about governance goals and guidelines in a new GH issue, as ultimately the governance for A-Frame ought to be more comprehensive rather than a few paragraphs in the top-level repo.

I will open a new issue shortly to kick this off.
 Status update for y'all! While the proposal has been accepted by community and members, still waiting on a response from Mozilla executive/legal people that have decided to open a separate issue. Hope to hear back from them soon. Unfortunately, there hasn't been much updates on this, I am going to close this for now and move to the issue.  In case of any future Glitches (more are welcome!), we can remix this base Glitch to maintain some consistency/formatting: https://glitch.com/~aframe

Working on merging them now Thanks! I think for UI, we should have componentized solutions versus JS in a script tag running animations (we prescribe JS code within components). Also some with more visual polish (e.g., demonstrating https://github.com/etiennepinchon/aframe-material with controllers).  I think a light example should have a way to quick be able to see different light types because this is all people will see:

<img width="1064" alt="screen shot 2017-08-28 at 4 53 35 pm" src="https://user-images.githubusercontent.com/674727/29798373-7d777618-8c11-11e7-8c71-f3c9d85ab634.png">

I'd add in-VR buttons to swap the light types or even spawn lights. That would mean a pretty much reworked example so I'll close this for now. Thanks!  thanks for the contributions. these are nice üëç Like https://github.com/aframevr/aframe/pull/3006, these require some work to format and make consistent. If @afvc is free, or whenever I have a bit of free time, we can get around to it.  What does attach to a-scene mean? Im not sure it provides any extra information. We've said where to put JS code and where not to put it.  Thanks! Your original issue, I made stuff bolder and more clear hopefully if other people run into the same thing, and I've added additional examples. I'll remove the `after the scene` part to recommend not putting code in raw script tags outside components at all.  Thanks, but we do not recommend this way. The very first section `Where to Place JavaScript Code for A-Frame` notes where to place code for JavaScript, always within components. Within a component, so that we don't have to wait to load at all:

https://aframe.io/docs/0.6.0/introduction/javascript-events-dom-apis.html#where-to-place-javascript-code-for-a-frame

> Before we go over the different ways to use JavaScript and DOM APIs, we recommend encapsulating your JavaScript code within A-Frame components. Components modularize code, make logic and behavior visible from HTML, and ensure that code is executed at the correct time (e.g., after the scene and entities have attached and initialized). As the most basic example, to register a console.log component.

The examples on the right hand sidebar also provide remixable examples to do so (all the other examples in the School follow this prescription as well https://aframe.io/aframe-school/#/9 ):

https://glitch.com/edit/#!/aframe-school-js?path=solution3.html

Also covered in https://aframe.io/docs/0.6.0/core/scene.html#running-content-scripts-on-the-scene

> The recommended way is to write a component, and attach it to the scene element. The scene and its children will be initialized before this component. The first section says explicit where to put JS code for A-Frame and numerous examples on the right hand side. The code in the original issue did not follow which was the issue, nowhere recommends using DOMContentLoaded in a script tag before the scene. Thanks though!  i You have to wait for the scene to load:
````javascript
document.querySelector('a-scene').addEventListener('loaded', function() { 
// your stuff goes here 
});
```` https://aframe.io/docs/0.6.0/introduction/javascript-events-dom-apis.html


https://aframe.io/aframe-school/#/9/3  Thanks! Pretty close! A small couple of tweaks and we're ready to go. Nice! Thank you! Welcome as a contributor!   `a-assets` is not an entity hence it does not take components. There's probably a different way to do what you're trying to achieve. I'm closing this since it's not a bug. You're welcome to open a StackOverflow question or swing by the Slack channels if you need help.  per @dmarcos:
I merged by mistake and reverted. Sorry for that. Can you please reopen?¬†#2985¬†has landed so we need to rebase

(Rebase forthcoming.)

 rebase needed to remove the commit that has already landed rebase done - are you in a position to sanity check? I tried quickly but it does not seem to work for me. I did not have the controller though (I hacked the link traversal demo with a gaze based cursor). Tomorrow I'll try with the proper controller again Works for me with this test page as example

https://s.codepen.io/machenmusik/debug/XaVMWJ/mVAbGERyxabk

Once you enter VR, it reloads in 5 seconds.  So if you end up out of VR, you know it is not working. I'm trying the link traversal example with your branch and the controller and I get dropped of vr. Does `examples/showcase/link-traversal` work for you? for me, it is working for simpler scenes, but not for ones with big assets to download -- I suspect it runs into the timeout issue in those cases looks like the setTimeout from prior PR is still needed for the VREffect to be available in the heavier cases. @dmarcos can you confirm latest PR version works for you? @dmarcos any progress on a more robust solution?  (Where this.effect will definitely exist while preserving user gesture?) @machenmusik out of curiosity, which example(s) are you testing with this? just https://aframe.io/aframe/examples/showcase/link-traversal/, yeah? This will be handled in un upcoming PR implementing a loading screen @machenmusik thanks for the conversation at OC4 @machenmusik that CodePen URL gave me a 403. just posting this in case anyone else's reading: https://codepen.io/machenmusik/pen/XaVMWJ/
 no sweat! I was just testing WebVR flows in Oculus Browser. and I know you were working on this, so wanted to check.

thanks for working on this. before I do a deeper dive, are there any known issues you know of for A-Frame + Gear VR? I ask because the new Oculus headsets are coming soon, and I want to make sure A-Frame and three.js are prepared.

thanks again for all your PRs and keeping your finger on the pulse :+1:  Cool, also feel free to create a Glitch instead so we can link it to the sidebar of that documentation page.

e.g.,

```
examples:
  - title: Adding Visual Feedback
     src: https://glitch.com/~absulit-cursor-feedback
```  This should work:

![img_5523](https://user-images.githubusercontent.com/674727/29677790-180ec5fa-88b1-11e7-9c8f-e76bfe88ee1d.PNG)

Let us know if you have more details.  Question, when you say Chrome on S8 and VR, are you using Daydream?  Or did you mean one of Samsung Internet or Oculus Browser?  Hi @ZTFtrue ‚Äî the examples in the three.js repo are using glTF 2.0. A-Frame's `gltf-model` component currently supports only glTF 1.0. The next version of A-Frame will have glTF2.0, or you can use the [gltf-model-next component from aframe-extras](https://github.com/donmccurdy/aframe-extras/tree/master/src/loaders) in the meantime.  Try using the animation component https://github.com/ngokevin/kframe/tree/master/components/animation which solves these problems by not having to do a createElement/setAttribute/appendChild just to add an animation  Thanks!  A-Frame 0.6.1 does not support glTF 2.0. It's a 0.7.0 feature. In the meantime, you can use the `gltf-model-next` component from A-Frame extras: https://github.com/donmccurdy/aframe-extras/tree/master/src/loaders  Do you still want tracking from daydream controls? If so this should work:

```html
<a-entity laser-controls="hand: left" daydream-controls="model: false"></a-entity>
```

Or just a floating laser that you can use however you want?

```html
<a-entity cursor="fuse: false" raycaster="showLine: true"></a-entity>
```

... but overriding `model:false` for all the different controller types manually is sort of a pain, so I'd be OK with surfacing a `model` property on `laser-controls` too. > ... but overriding¬†model:false¬†for all the different controller types manually is sort of a pain

Exactly... If we want to have easy to use laser-controls, we should add values that should cascade downward For edge and custom cases, I'd copy and paste the laser-controls component and do what you need rather than adding more API. laser-controls is an out of the box implementation and the code is very simple, it sets other components. If you need to create your own controls, you can modify it or add anothe component that overrides daydream-controls I'll check it out when I can, we should make that case work. it may be just changing the setAttribute to 3-argument form so it does not replace existing properties? laser-controls does not touch the model property. setAttribute does not replace non-specified properties without the clobber flag.  Thanks for the example case!

Found the problem: We typically think of the `raycaster.refreshObjects()` as needing to be called after the DOM changes, but actually `raycaster.objects` is caching the list of `Object3D`s associated with each entity, not the entity itself. So its cache needs to be cleared not just when the DOM changes, but when a model is added to an entity.

In this case, the [stub mesh created by the `material` component](https://github.com/aframevr/aframe/blob/master/src/components/material.js#L155) is what got cached. If I manually call `el.components.raycaster.refreshObjects()` after the model loads, everything works. That stub mesh has bitten me before (https://github.com/aframevr/aframe/issues/2464) ‚Äî I wonder if we could do without it?

I'd like to find a more intuitive way to keep the raycaster up to date, but it's a tradeoff on performance and ergonomics... Here's the [relevant raycaster code](https://github.com/aframevr/aframe/blob/master/src/components/raycaster.js#L122-L141). We could listen for `object3dset` on the scene, with a debounce? Another approach, can raycaster attach listener for model loaded event to entities of interest? We could have raycaster listen for `object3dset` on a opt-in flag?

Or provide harder documentation and Glitch examples how to manually refresh the raycaster as you need in docs. That'd be the most performant approach. It would be pretty messy to remove/add event listeners on every object attach/detach and refresh on possibly non-relevant object3dsets. Perhaps a component `raycaster-refresh="raycasterEl: [raycaster]"`.  I like the refresh component approach, fits the paradigm

On August 20, 2017 10:06:36 AM EDT, Kevin Ngo <notifications@github.com> wrote:
>We could have raycaster listen for `object3dset` on a opt-in flag?
>
>Or provide harder documentation and Glitch examples how to manually
>refresh the raycaster as you need in docs. That'd be the most
>performant approach. Perhaps a component
>`raycaster-refresh="raycasterEl: [raycaster]"`.
>
>-- 
>You are receiving this because you commented.
>Reply to this email directly or view it on GitHub:
>https://github.com/aframevr/aframe/issues/2980#issuecomment-323587112

-- 
Sent from my Android device with K-9 Mail. Please excuse my brevity. I think we should switch back to caching the list of elements, rather than the Object3Ds they contain. Then at least we're back in a position when it's only DOM changes we need to worry about, rather than changes to the underlying three.js scene graph e.g. `object3dset`. The cost of iterating the list of children on each raycast seems low; THREE.Raycaster is going to be doing that anyway.

An automatic way to refresh the raycaster would be good too, but becomes easier if we only have to worry about DOM events. I think it could even be opt-out rather than opt-in at that point, since ~~you only need to check new elements to see if they match `raycaster.objects`~~ well, or if they have classes/components added that would affect matched selectors. So maybe clean maybe not. Proposed fix: https://github.com/aframevr/aframe/pull/3070

I opted into more aggressive refreshing by default, but limited the refreshes to once per raycast. Is it feasible to provide #3070 in the form of a component, that could become raycaster dependency or system post 0.7.0, or does it require surgery to existing raycaster and thus core PR? My preference would be to patch the raycaster. The current behavior is catching users by surprise, and I think we can make the default raycaster more friendly without materially affecting performance.

But if we decide that isn't the direction we want, and that the raycaster shouldn't watch the kinds of DOM changes it watches in #3070, then yes I'll make a separate component to do the refresh. My only thought was that it might be good to refactor so the refresh policy was separable from the actual raycasting, so the default could be aggressive #3070 but other use cases could replace or entirely disable (e.g. for static scenes) Ok yeah. An option to turn off automatic refreshing and (manually) manage it elsewhere would be worth adding to that PR. https://github.com/aframevr/aframe/pull/3070  This blocks knuckles support. I found a rigged hand model from one of the Knuckles public demos but it's on FBX format. https://github.com/zulubo/knuckles/tree/master/InteractionPlugin/KnucklesFingerTracker_v5-6/Assets/Knuckles/ModelsI The model imports to Blender, including a skeleton, but I don't see pose data with it... That might be part of the `.fbx.meta` file included, but how do we use that?

We should be able to just create poses for the hand, but I'm not too sure how this works, or what poses are needed for Knuckles. :/ 

![screen shot 2017-08-16 at 8 00 30 pm](https://user-images.githubusercontent.com/1848368/29394656-9a19c5f0-82c0-11e7-863f-872be2408c31.png)
 Thanks for looking at this. Knuckles does not have poses but finger tracking. Each finger is a button with a value from 0 (finger contacted) to 1 (fully extended). We should be able to control each finger independently Thanks! I need to spend more time exploring Blender's secrets üòÜ  Nice. Also try https://github.com/ngokevin/kframe/tree/master/components/animation if you have issues with the current animation, I will later propose to swap it out with this.  Do we have, or should we add, an example of video without using autoplay for maximum mobile support? Maybe something with a *Begin Experience* entry button.

Some discussion in the #ar room in Slack ‚Äî it seems our [360¬∫ video](https://aframe.io/examples/showcase/videosphere/) example is not working on any mobile device ‚Äî it loads on my Nexus 5X (first frame Chrome, extremely slow framerate in Firefox), and nothing in iOS (any browser). Is adding a play button to the existing example enough? Sounds good to me. üôÇ

EDIT: maybe on the test video rather than the 360¬∫ video in the showcase Create a Glitch, we can link to it from the docs with the new Examples sidebar listing within documentation.  Careful testing this, as I think there may be namespace collision with tracked controls touch events Cardboard buttons have been working with `mousedown`. `mousedown` should also register with touch. You weren't seeing it emitting?   Thank you! ü•á   There's already a flag called `hmdEnabled`. Can we reuse it? I really appreciate the PR. The code looks great and it even comes with tests ü•á Our responsive approach considers magic window mode as the base line for mobile devices. A-Frame provides a set of sensible defaults out of the box that we think are useful for a majority of use cases. For custom functionality we recommend creating components using the core ones as a base as you did. Incorporating flags for a lot of particular cases will force us to test and maintain a lot of permutations making very difficult to maintain quality as we move forward. I'm going to close this PR but I'll keep it in mind if we see more demand for this feature. I'll try to write an FAQ and something in the docs about customizing look-controls for non-VR purposes. We've gotten many non-prompted PRs on `look-controls` in the past, and we usually repeat the same things. It's unfortunate to have to turn away work. But thanks though!  A-Frame VR-to-VR link traversals fail at present with Oculus Browser.

See Slack discussion at https://aframevr.slack.com/archives/C0GG937RN/p1502489851298903

See #2966 for a workaround PR.  Freeing resources of the previous page on navigation should be task of the browser. Not sure what A-Frame can do. @vincentfretin thanks for investigating. it is really helpful üôè  My understanding - the pose data returned and leveraged for controllers is in line with the handle -- this is true across vive, touch, gearvr, and daydream to my understanding. 

The Touch controllers are currently unique in their pistol-style positioning of ideal selection beam for things like `laser-controls`... one could argue that for this use case, components like `laser-controls` would be the right place to apply this.  @dmarcos @ngokevin thoughts? Yeah, intentional given the style of controller.

If you want to override it, you can use the origin/direction properties of the raycaster. https://aframe.io/docs/0.6.0/components/raycaster.html#properties_direction

You can pretty much copy/paste the laser-controls and modify those config values: https://github.com/aframevr/aframe/tree/v0.6.0/src/components/laser-controls.js

Or wait for `controllerconnected` for an Oculus Touch and set the origin/direction yourself once a Touch controller detected I will take a look Reproduced with current Firefox.  I am pretty sure this has not always been the case.  Can someone also test with Chromium (my rig has Nvidia driver conflict issues there) to confirm whether this is browser specific behavior? Current hypothesis - either Oculus or Firefox changed the orientation reported for touch controller to reflect pistol-grip offset, where previously it was being returned as in line with handle (for which the Touch model was previously designed and verified) hey, so did anyone figure out who changed what?
looks like it was still working correctly when we were working on laser-controls...
https://github.com/aframevr/aframe/pull/2678#issuecomment-302583370 Confirmed that this does impact experimental Chromium with Rift 1.17 software at least. If we merge #2583 then we may be able to use tracked-controls rotation from oculus-touch-controls to fix it
https://github.com/chenzlabs/aframe/blob/4e3fb0a938432bd10b91f7d9df5effdbf588ba86/src/components/tracked-controls.js#L28 Sounds like @dmarcos prefer an alternative he is working on to #2583, so what is the preferred avenue to solve this issue then?  Commit a new rotated version of model to assets and remove the adjustment in laser-controls? @dmarcos ^^ ?  Normally, we recommend just copying/customizing the look-controls if people need special behaviors. There are many permutations and edge cases of controls that people have come up with, but supporting all of the at once is pretty hard. Since now we have so many switches, it becomes harder to maintain.

Perhaps we might one day get something like Don's universal-controls in aframe-extras, but A-Frame is sort of VR-focused so doesn't cater as much to the many possible mobile use cases. The look-controls is meant to be a default implementation where A-Frame is VR-focused, meaning mobile uses HMD. I wouldn't try to add more and more things on top of look-controls to accommodate every use case. For cases such as this, it's not too difficult to copy/modify look-controls. We get a lot of PRs adding these types of switches to look-controls, I will try to add a FAQ/documentation on how to modify/customize look-controls in the future.

Thanks, let me know if you have other concerns. Well, will rethink this since it's a harmless switch. @dmarcos, opinions on having look-controls support full non-VR for mobile? I'd lean on not. I'm ok with this switch in isolation. The broader question is why are we taking this when we rejected similar PRs in the past? My worry is not this feature in particular, it's reasonable and the code is well written. My concern as we discussed is piling tons of small switches that grow the number of posible configurations and code paths we have to maintain. I feel that it's already hard enough to provide good support for the current broad range of devices for the VR use case. As a general approach I would wait to see more demand before taking up on the long term maintainance cost. I want to feel confident we can deliver good quality without going insane üôÇ Mostly a balance between maintenance vs. value. This one doesn't cause for much maintenance, but possibly some value. I could see how people might want to disable the polyfill but keep the touch controls on mobile, or want to provide some UI to let user decide interaction. Hard to measure demand on these types of things, but the WebVR community does love its "responsiveness". Thin line. It may be a question of providing access to internals so it is simple to make an external component that does look-controls except for some small thing... asking devs to recreate entirely just to throw a flag (e.g. laser-controls) is another example with a different response.  There, the maintenance is basically zero, the utility is potentially significant, and the code is written in such a way as to be impractical to work around (e.g., as we support more controllers and laser-controls is updated, variants have to update in lockstep as there is no reuse / inheritance possible) The maintenance isn't zero. We have arrays of flags and need to work together, and we're continually adding more flags or getting PRs for more flags for non-VR purposes. It's less resistance to copy-and-paste (remix, not *recreate*) and tweak. Components should be small, simple, tweakable rather than large complexes.

`laser-controls` workflow and customization doesn't have any issues with it. It's a very small and simple component that sets other components. Need to add more controllers? Just attach them. That other PR about the `model` flag is an unrelated issue with why the line does not show up when the `model` is set to `false`, not to do with needing any flags. Would it make sense to just disable the mobile orientation-based movement when hmdEnabled is false? I wouldn't handle fixed pitch, at that point, you can customize manually the look-controls for you own needs. @jaydansand it‚Äôs a deliberate design decision not a bug. It is very dissorienting changing the pitch with your finger since you quickly lose the sense of up / down and it‚Äôs difficult to recover from it without reloading the page > Copying look controls means buying into constantly merging and updating.

I don't think it's much trouble in practice. I've been maintaining an alternate version [here](https://github.com/donmccurdy/aframe-extras/tree/master/src/controls) and haven't had to touch the HMD/orientation code in 11 months. @jaydansand the way to opt out is to implement your own component as you succesfuly did.  @jaydandsand we want to keep the core components focused and with functionality that serves the majority of cases. By keeping components simple we prevent a combinatory explosion of flags permutations that is very hard to maintain over time. Simplicity also allows developers like you to adapt the code to particular scenarios we don‚Äôt cover. I‚Äôm going to close this for now and revisit in the future if there‚Äôs more demand Having `hmdEnabled=false` also apply to mobile devices seems reasonable to me; +1 on that.  > since the camera is also in that position by default

The camera default position should be 1.6 meters up, no? If you use the default camera or `<a-camera>`. Yeah, and in VR mode (with positional tracking), it would be at the real-world head height, so greater than 0. Anything we should note given that? It's not really anything specific with planes, but just placing stuff at the same position as the camera in general.

Perhaps a quick comment at https://aframe.io/docs/0.6.0/guides/building-a-basic-scene.html#placing-our-box-in-front-of-the-camera like "In general, note that if we add an entity at the same position as the camera, we won't see it from the default viewpoint". But we can leave that for another PR, thanks!  I would not hardcode version numbers in the examples or reference specific bugs. The info will go quickly out of date and it will be hard to remember to update it A bug in an example is the same as any other bug in the code base. The fix will ship in the next A-Frame version in a few weeks. You opened a good issue already to keep track of it. Any ideas on how we could fix it https://github.com/aframevr/aframe/issues/2961?  There's also the aframe-site repo which might be a more appropriate place: https://github.com/aframevr/aframe-site The issue might be also relevant here, the aframe-site repo does not have the same visibility. Can use this as a general call about blog post, doc materials, examples people think are not currently covered? We can file independent issues from this conversation so anybody can jump and help. Good entry points for participation. It's something we've tried before. It's hard to follow completely through and write something well since an article is a huge commitment and technical writing is difficult. But yeah, would be great to hear about any holes.

https://github.com/aframevr/aframe/issues/2317
https://github.com/aframevr/aframe/issues/2281
https://github.com/aframevr/aframe/issues/2274

But I can say that simple examples on Glitch are most sorely needed, people have requested that. For each documentation page, we will link to relevant examples on Glitch that people can play with. Just add the Glitch links to the documentation metadata, and I'll get them visible on the website.

```
title: Cursor
examples:
  - name: Clicking
  - url: https://glitch.com/~aframe-clicking
---
```

My call to action would be to create simple Glitch examples for each documentation page to link to. Code speaks louder than words, so please share them! I'll be working on them soon myself. @wmurphyrd It doesn't really matter the accounts because the Glitches can get remixed by anyone. We create examples, a contributor can remix them to add a small change and update the URL, and if we need to modify we can re-remix it. Cool. Going to close as you've gotten a couple of suggestions as desired. Will leave the aframe GitHub issues for core issues or actionable items by core team or community versus a call out. Note the A-Frame blog itself has a high standard for curation of content. Helpful content should be added as now Glitches or additions to the documentation. @afvc those look great! it would be great if you could get them into glitches and add them or send them to the docs! I suggest more frictionless ways to gauge community needs. One is to be present within the community; Slack and StackOverflow are a wealth of indicators on what knowledge is needed. You can even ask for ideas there. I've also indicated the need for more forkable examples. Another good source of blog content are case studies on innovations and real projects (i.e., new components, VR UI) that you personally work on (versus writing about a topic in a vacuum). Those are good places to start versus a soapbox-y issue GitHub that might not attract attention. Thanks for being interested in it.  Can you add code or ask on Stackoverflow? Which example? Most likely you need to position it in front of the camera position="0 0 -4" or use side="double"  Lots of questions in Slack about audio support on mobile, whether there is a workaround for playing without user gesture, etc. We should have a note, either in the FAQ or the `sound` component docs, explaining current state-of-affairs on this.

Personally, I'm not actually sure of the fully story myself. I think that audio without a gesture is completely impossible on iOS (although you can use an audio sprite started when the scene loads with a gesture). Is that also true on Mobile Chrome? Or can the gesture requirement somehow be worked around there?

/cc @dirkk0 + #1463 @dirkk0  thanks! Do you know if mobile Chrome in Android is a different story? I'm seeing some [information suggesting gestures are also required](https://bugs.chromium.org/p/chromium/issues/detail?id=178297) there, but I haven't tried this. Thanks! Opened #2974. Not sure about the WAV issue; maybe another issue for that?  **Description:**

During component data building, we're often cloning objects for `oldData` and `attrValue`. We could use object pooling to reduce allocations. We should need only two objects per component: the old data and the current data, but currently creating a new object (or more) on each update.

We can look at existing performant object pool implementations to reuse (some use arrays, some use linked lists).
  Radius is a valid property. Is it not working for you? https://aframe.io/docs/0.6.0/primitives/a-sphere.html#attributes_radius Yeah, radius should work fine. Let us know if there's anything else.

<img width="1379" alt="screen shot 2017-08-08 at 10 39 50 am" src="https://user-images.githubusercontent.com/674727/29086006-ee32fe5a-7c25-11e7-8420-a471297c9de5.png">
  This will be a bit more involved, but I think we want to cache the bounds (e.g., in `this.canvasBounds`, and then on window `resize` event in a throttled handler (`utils.throttle`), we want recalculate those bounds. Close, I meant just `utils.throttle` the handler, not `throttleTick`. In case someone is dragging to resize the window, many resize events would fire. OK, I see. We want to use `debounce` instead. We need to add a utility function for that. In `utils/index.js` next to `throttle`, we can add:

```js
module.exports.debounce = function (func, wait, immediate) {
	var timeout;
	return function() {
		var context = this, args = arguments;
		var later = function() {
			timeout = null;
			if (!immediate) func.apply(context, args);
		};
		var callNow = immediate && !timeout;
		clearTimeout(timeout);
		timeout = setTimeout(later, wait);
		if (callNow) func.apply(context, args);
	};
};
```

And use `utils.debounce` instead. Thanks! Thanks!  Thanks! PR appreciated to use canvas size isntead in `cursor.js`. Wonder if `getBoundingClientRect` is performant to be called on every tick though. Fixed using debounced window.resize handler + canvas bounding rect. https://github.com/aframevr/aframe/pull/2942  Thanks! A small change and ready to go. Thanks!  Do you have a [codepen](https://codepen.io/) or a [glitch](https://glitch.com/) illustrating the problem? What does `getColor(item.status)` return? What about if you do `color: 'green'` Does it work? Yeah. We should maybe expose it as a component property  We prescribe always putting JS into components, even a `main` component. This allows code to be executed at the proper time, when things are loaded and ready.

https://aframe.io/docs/0.6.0/core/scene.html#running-content-scripts-on-the-scene

https://aframe.io/docs/0.6.0/introduction/javascript-events-dom-apis.html#where-to-place-javascript-code-for-a-frame

Listening to the `loaded` event outside of a component is expected otherwise if flying loose outside a component. The code there is a bit more complex. Asynchronous operations with components running in non-deterministic order. Wiring is more necessary in those cases. Either:

- If a component A creates an element that component B needs, I'd have component A communicate an event when it's ready so component B knows when to run. 
- Or component A can `setAttribute` that `selector` property of component B when it's created.  It's not quite correct, I would not use `throttle` when `throttleTick` should be used. Throttling `tick` shouldn't be explained in the `throttle` section. I don't think `throttle` needs to an example, `throttleTick` could have one though.  Have you tried on Android? Thanks! ü•á   It is the same thing, and unfortunately there is no perfect solution right now. Transparency and order-independent rendering are very difficult to get right. We would need things like https://github.com/mrdoob/three.js/issues/4814 to be solved.

But with luck you might find that `material="alphaTest: 0.5"` helps here, as mentioned in #666. Going to close this to merge the threads. Can't guarantee it would work in your case, but yeah:

```js
var el = document.querySelector('#my-model');
el.addEventListener('model-loaded', function (e) {
  e.detail.model.traverse(function (node) {
    if ( node.isMesh ) node.material.alphaTest = 0.5;
  });
});
```  **Description:**

I'd like to be able to update an array property type using the same array without having the clone the object myself to get past the component deepEqual check.

```js
// test component
schema: {
  foo: {type: 'array'}
}
```

```js
var foo = el.getAttribute('test').foo;
foo.push(50);
el.setAttribute('test', 'foo', foo);
```

Currently I need to do:

```js
var foo = el.getAttribute('test').foo;
foo.push(50);
el.setAttribute('test', 'foo', AFRAME.utils.clone(foo));
```

Possible solutions:

```js
// Skip equals check flag or force update flag.
el.setAttribute('test', 'foo', foo, true)
``` 

```js
// Options object for setAttribute
el.setAttribute('test', {foo: foo}, {forceUpdate: true, clobber: false});
``` 

- Clone the object/array when setting `oldData`, but this doesn't sound great for perf.

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
  Nice, thanks! I'm far from my headsets this week. I will do a sanity check as soon as I can next week and will merge. /cc @caseyyee @jsantell while your logic is probably more appropriate on Daydream (because you disable panning using the finger) I think the result should be identical (both logic old and new use native HMD orientation given by hmdEuler). Do you see any difference in your Daydream device when entering proper VR mode (webvr in Chrome Daydream is hidden behind origin trials....) ? this seems pretty close. @jsantell: friendly ping?  Which platform/browser? Sure it's not on the event iself? https://w3c.github.io/webvr/spec/1.1/#interface-vrdisplayevent thanks!  1. Need a geometry on the text.
2. `onclick` is not supported. Use event listeners. https://aframe.io/aframe-school/#/9/4

https://aframe.io/docs/0.6.0/components/text.html#limitations  The laser controls isn't meant for gaze-based. Making an app responsive to support both controllers + gaze would be up to the application. If anyone has an example to show this off, create a Glitch, and we can add to the docs.  Thanks!   See aframe-React readme. Components mean different things  Is not that misleading? The controller is 3DOF and there wont't be 1:1 matching between the hands and the controller. It might be ok for some interactions. Not sure if the offset should be part of the schema since you could achieve the same effect by nesting the controllers inside an entitiy Is not that misleading? The controller is 3DOF and there wont't be 1:1 matching between the hands and the controller. It might be ok for some interactions. Not sure if the offset should be part of the schema since you could achieve the same effect by nesting the controllers inside an entitiy There should be an arm model in place for both gearvr-controls and daydream-controls, unless you have disabled it.  Are you proposing a different arm model?  Or is the arm model not doing the right thing for your use case so you were proposing a different strategy? Yeah. The arm model should be the one applying the offset  Fixes #2721.
 The glTF loader will only duplicate the UVs if there is no second UV set, so yes‚Äî you can create a custom second set of UVs in your software instead. The second UVs can only be used for AO/lightmap, though.  i'd just remove the `--save` piece and leave everything else  üëç  thanks for the pr! I don't think this should be part of the main repo since it's a for a third party packaging tool for a fairly niche store. This would belong best perhaps as a tutorial since people would have to modify the metadata anyways. Closing for now, but we can keep the conversation going  Thanks!   Thanks!  First thing is that in VR you should not animate the camera and let the user have control of it. This won't work well in a headset.
In the case of the nested camera composing rotations is not a trivial business in 3D. The result you're getting is expected.
I don't think this is an issue on the A-Frame side. Let's leave the discussion to the SO question.   **Description:**

There's been a regression since A-Frame v0.6 (was also present in master since before the release of 0.6) which prevents the aframe-particle-system component from working when there is fog set on the scene. Details are logged here as an issue on that project: https://github.com/IdeaSpaceVR/aframe-particle-system-component/issues/26

It causes a WebGL error to be thrown:
```
THREE.WebGLProgram: shader error:  0 gl.VALIDATE_STATUS false gl.getProgramInfoLog Varyings with the same name but different type, or statically used varyings in fragment shader are not declared in vertex shader: fogDepth   
```
```
three.js:21505 WebGL: INVALID_OPERATION: useProgram: program not valid
```

- A-Frame Version: 0.6.1
- Platform / Device: Chrome / Desktop
- Reproducible Code Snippet or URL: https://codepen.io/maxakohler/pen/gRgZZP
 The problem is the [SPE dependency](https://github.com/squarefeet/ShaderParticleEngine) of [aframe-particle-system-component](https://github.com/IdeaSpaceVR/aframe-particle-system-component/) that it's not compatible with THREE > r83. Since `r84` (A-Frame 0.5.0 used r83) there's a varying `fogDepth` declared in the [fog_pars_vertex](https://github.com/mrdoob/three.js/pull/10497/files#diff-e02b3101630f5ea2d12b18a6439d615a) chunk that [SPE](https://github.com/squarefeet/ShaderParticleEngine) has to [include](https://github.com/IdeaSpaceVR/aframe-particle-system-component/blob/master/lib/SPE.js#L900) when composing the vertex shader.  This is the THREE PR that introduced the change for reference: https://github.com/mrdoob/three.js/pull/10497 Yes, you can use 0.5.0 or update https://github.com/IdeaSpaceVR/aframe-particle-system-component/ to make it compatible with THREE > r83  Can you add this to the docs as well, thanks!  @donmccurdy we should revert the tween.js bump. Fortunately, @dmarcos did not bump his deps before he built the release so this only happens locally does the CI not do `npm install`? The older version of tween.js is deprecated; if the API change is trivial maybe we should just fix it. It's deprecated, but it doesn't really hurt to keep the version we had previously and not add extra work / unexpectedness.

We have to manually build dists during release so the CI builds didn't make in Everything is (still) working for me locally. üòï Tests pass, `npm start` works, demos work, all on a clean installation of aframe. I'm currently at `@tweenjs/tween.js@16.10.0`. npm 4.6.1, node v6.9.5. Is it possible there was a bad patch release of tweenjs somewhere around the time we published? Or perhaps related to https://github.com/tweenjs/tween.js/issues/358? Good to hear! Thanks for checking again! I'll go ahead an close the issue and will reopen if necessary.  thanks!  So we just need to add `alphaTest` to the `material` component, similar to `depthTest` which is already there?  Sounds like a good idea to me, +1. Already there
https://github.com/aframevr/aframe/blob/master/src/components/material.js#L23 Oh nice, so #2516 would have just gone stable with v0.6... in that case let's add docs and call it good.  Yeah, that URL should be a relative one  I'd look for a component-based API https://github.com/ngokevin/kframe/tree/master/components/animation rather than adjust across A-Frame to account for `<a-animation>` API.

If you need to encapsulate entities, the template component is another option.  We've deprecated a-animation. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.

In these cases, might need additional JS to control iterations of the animation.  > Are there any changes that need to be done for aframe to import Blocks?

Some Blocks will contain ngons (faces with >4 sides). The three.js OBJLoader can't render these, and whether it really should be fixed to do so, I'm not sure. The workaround is to triangulate the mesh in Blender, or perhaps some easier tool. We could, at minimum, document how to do this.

> It would be great to have a component that takes the URL of a folder with the decompressed contents of the zip exported by blocks and places that in the scene.

Mr. Doob has [added support in the three.js editor](https://github.com/mrdoob/three.js/commit/6cfda9b71b3456ff095233a70785fa30a7080526) (not core three.js) for loading Blocks directly from the .ZIP. We could consider doing the same in A-Frame, although IMO it's the sort of feature that would be nice for testing but bad for published code. Support for ngons landed. Also https://archilogic-com.github.io/aframe-gblock/  You will need to convert a font set that has arabic characters. https://aframe.io/docs/0.6.0/components/text.html#custom-fonts  Thank you! üëè  We have a cursor example (https://github.com/aframevr/aframe/blob/master/examples/test/cursor/index.html). Do we add some text there to illustrate how to do it? I think the `a-plane` labeled with text in https://github.com/aframevr/aframe/blob/master/examples/test/text/scenarios.html would work with cursor, right?  If so, maybe we can point at something like that as example. Yeah, IMO the core text component should be thought of more as a specific type of material / decoration and so to be interacted with, the entity needs a geometry (e.g. plane or box) that defines its area / volume for interaction...?  We're trying to deemphasize primitives since they are just aliases over an entity + components and introduce a lot of quirks and inconsistencies.   @Akshaylyer12 Sure! Open a PR when you have something ready. This is an issue that is already filed on the aframe-site. Unfortunately, we cannot hand-hold through the entire process. If you are unable to find it, I recommend to get acquainted with the codebase more and come back to it later.  That particular boilerplate is not updated to the latest A-Frame Version (0.6.0). I opened an issue on its repo to upgrade: https://github.com/aframevr/360-image-gallery-boilerplate/issues/8 https://github.com/aframevr/aframe-inspector would also be a better place to file. Currently working on Inspector a bit now. Thanks!  `materialtextureloaded`  I can't reproduce this with Nightly + Vive  Please use StackOverFlow or the Slack channel for questions. Issues are just for bugs or feature requests.  Could you share an OBJ created from SketchUp in this way?

Might also be worth testing your model somewhere like https://clara.io/ or [FBX Review](https://www.autodesk.com/products/fbx/fbx-review) to see if the problem is isolated to A-Frame or related to the model. Sorry this probably isn't the answer you want, but Sketchup's exports seem to be very unreliable. There's a problem in the model, causing `<a-obj-model/>` to crash and causing Clara.io to fail to parse colors. I can fix that manually in Maya LT (here is a corrected file: [first.zip](https://github.com/aframevr/aframe/files/1147476/first.zip)) but in the future you may have better luck with tools like MagicaVoxel or https://www.tinkercad.com/, or by learning more advanced tools like Blender.


 @kschzt Thanks for checking. Have you tried if the problem still reproduces with `master` that uses a newer version of THREE?  * It adds a mouse cursor mode to the `cursor` component similar to https://github.com/mayognaise/aframe-mouse-cursor-component
* It modifies the `raycaster` component to accommodate the mouse cursor use case
* It makes the link traversal example usable on desktop
* It adds link traversal example to the index.html 

[Demo](http://swimminglessonsformodernlife.com/aframe/examples/showcase/link-traversal/mountains.html)
 I replaced `mode` with `rayOrigin` with two options `entity` / `mouse` So not going to try the idea of having a cursor work with both simultaneously? It needs more thought and probably not a priority right now.  @stephanedemotte can you open an issue?  Re parenting is tricky to achieve. Can you have two cameras and switch between them? This is a dup of https://github.com/aframevr/aframe/issues/2425  I believe those arrows should only show up in mobile @ngokevin ? Yeah, we can just hide these for desktop The repo is on https://github.com/aframevr/aframe-site but the arrows work for me now Never mind, they only don't work on the Logo example, but I moved the issue  Thinking further, why do we need a `.reload()` feature? I'm sort of in favor of removing this altogether because it will get messy trying to maintain the feature and address all edge cases of resetting a scene to a clean slate. I'm fine with deprecating. I checked with @fernandojsg and we don't use it in the inspector. @rockwalrus how did you hit the issue? what's your use case? @rockwalrus Firefox Nightly now implements the `vrdisplayactivate` that it's fired on reload and the scene should reenter VR automatically so you would not need  to call `reload`. Anything that prevents you from demoing on Firefox Nightly? I think it's fine to reload the page and enter VR programmatically (this can be done on mobile when using the polyfill). Everything done in this current PR could be done without being in the core as well. Multiple embedded scenes is not supported at the moment and it's not something I think we will do in the short / mid term. There are a lot of performance implications and we have to first focus on get good overall performance on a single scene :) 

You said that your scenes don't have much state stored on them. It will be more performant to reset the component properties to the original values rather than recreating the whole scene (specially on mobile) as `reload does`

 @rockwalrus you could add a class to all your dynamic entities `<a-scene class="myElement">` and select them all with `document.querySelectorAll('.myElement')` and remove them. Still more performant that reloading the scene, specially if you care about cardboard / mobile In your case I would create a `reset` component for the scene that restores the state and removes all the dynamic entities.  To determine if `reload` is worth keeping I prefer to analyze the use cases that need the feature. In the case described above (restoring the initial state of a scene) reloading the whole scene is not the ideal more performant way to proceed and it should be solved differently. Your use case to reload a page is already covered by the WebVR API since reloading a page and remaining in VR is a considered scenario. Your problem is with devices where there's no WebVR implementation (Cardboard like devices). Are you using a cardboard with a button? You could hook enter VR to a press on the button after reload to be able to enter VR (fullscreen on polyfilled devices) 
 OK, I would close, look into deprecating `.reload()`, and leave as application-level / third-party code.  @Marchhill Can you try with master? Does the webvr-polyfill demo have the same problem? http://googlevr.github.io/webvr-polyfill/examples/basic/ What does double vision look like? is there a difference in DPDB and maybe the specific model of phone has wrong/missing entry? @clavis-magna Does this happen also with the `webvr-polyfill` example? http://googlevr.github.io/webvr-polyfill/examples/basic/  Thanks. `pivot` was previously something someone wanted to reduce the amount of entity nesting for animations. We created some examples using it (e.g., the A-Frame logo). We don't really want it in the core, but are keeping it for those examples still around,  You have to set `material="side: double"` https://jsfiddle.net/q2d2nxdo/  **Description:**

**Changes proposed:**
-
-
-
 We also need to change the default values to `1`.  Use a wrapper entity or temporarily set look-controls to disabled. https://stackoverflow.com/questions/36677671/aframe-set-camera-position-at-runtime  dupe and fixed. https://github.com/aframevr/aframe/issues/2841  You'll want to use `<img>`, not `<a-asset-item>`  Hmm, calling `enterVR` or `exitVR` twice should not doing anything since they have early checks to see if you are already in VR.

Do you have the WebVR Emulator installed? I think this issue is only if you have the WebVR Emulator extension enabled, which may cause weird things. The WebVR Emulator may not be as useful for A-Frame since wasd-controls and mouse-drag controls provide the same sort of emulation.

If I don't have it installed, Mac/Chrome enters full screen normally. Windows/FF Nightly enters VR with correct height. I reproduced with the Emulator installed and uninstalling it helped.  The GearVR Controller has a handedness that is set when you pair it using the Oculus app.  (I believe the default is right hand.)  If you configured your controller to be left handed, then the GearVR Controller is exposed with left handedness, and so I would expect the behavior you are seeing.  Can you confirm whether that is the case? @gabrielperales can you confirm behavior with both Samsung Internet (in GearVR) and Oculus Browser?  I am wondering if this is a discrepancy in behavior between the two, or another issue specific to your use case, given that @clofts613 confirmed the expected behavior above. The Oculus browser is included in Oculus Home. You have to open it with the button that says Internet in the bottom bar @gabrielperales there is the Samsung Internet GearVR app, which I think you are using, and also a browser more integrated into Oculus Home https://m.vrheads.com/how-use-oculus-browser-gear-vr There seems to be a regression where gamepad extensions are disabled: https://forums.oculus.com/developer/discussion/comment/564429/#Comment_564429 There's a regression on the Oculus Browser 4.0 where gamepad extensions are disabled by default. It will be fixed in the 4.1 release in late november. This is a workaround in the meantime (taken from the forum thread linked above):
- Open a new tab, start typing 'chr' (w/o quotes)
- Once you see 'chrome://chrome-urls' as a hint - click on it.
- Click on 'chrome://flags' link
- Search for 'Gamepad Extensions', it is located somewhere close to 3/4 of the page.
- Change its state from 'Default' to 'Enabled'.   
- Relaunch the Browser (you'll see a button at the bottom of the page).
 Excellent news. Thanks @mkeblx   I think the 'rain' and 'ocean' components are good examples of this, and the goal for this issue would be to gather even more ideas. No need to distinguish categories of procedural-ness. :)

Similar to #2408, maybe a nice thing would be a component that can grab a random child from a model, rather than loading the entire model. So I could load a glTF file with 5 trees, and have 100 trees randomly drawn from the model, scaled, and scattered around the scene. (or does the environment component sort of already do this?) > Any kind of geometry reconstruction from images as a component.

Maybe getting a bit ahead of ourselves now, how about scoping to: "generating non-deterministic content in a scene". Computing content from scanned point clouds, photo clouds, and ML is a whole field of study on its own. üòâ

> A planet generator based on our solar system plus categories of extra solar planets

+1 to this ‚Äî could make our own little infinite space sim  What about signed distance field primitives a la shader toy? Has anybody experimented with them in WebVR?

http://iquilezles.org/www/articles/distfunctions/distfunctions.htm @joshmarinacci Have you read the component documentation? https://aframe.io/docs/0.6.0/core/component.html
How can we improve it? This issue is a brainstorming exercise to collect ideas for anybody to implement. I think what's missing from the components documentation (which might not make sense there anyway) would  be information about how to manipulate underlying three.js geometry. For example, I wrote the `<a-ocean/>` component while referencing [this tutorial](https://tympanus.net/codrops/2016/04/26/the-aviator-animating-basic-3d-scene-threejs/). 

That might be a common enough problem to be worth writing up somewhere. I've definitely pointed people to that code several times. But I think we'd also want to be clear that it's only recommended for dynamic stuff, and that if you want a model of an airplane (like in that tutorial) you should probably be using one of the modeling tools we list instead. This is more in three.js's wheelhouse than A-Frame's domain. A-Frame's domain is more of the structure that houses three.js code. There are pages on how to interface with three.js within A-Frame, how to write a component, and modifying geometries is for advanced developers that know three.js. How to write a component that modifies three.js geometries becomes a specific example.

But yeah, it'd be helpful for someone to create these specific Glitch examples, e.g., of a component modifying a geometry. Then we add it to the documentation sidebar under the Table of Contents to get live forkable examples.

To add to the doc, head to doc Markdown file header and add like:

```
examples:
  - url: https://glitch.com/~aframe-component-geometry
    title: Modifying three.js Geometry Component
``` A friend of mine ( @rlamana ) had actually started porting [the example](https://tympanus.net/codrops/2016/04/26/the-aviator-animating-basic-3d-scene-threejs/) that @donmccurdy pointed out to A-Frame. I've been begging him to finish it up. Ramoooon pretty please! :kissing_smiling_eyes: :kissing_smiling_eyes: :kissing_smiling_eyes: :kissing_smiling_eyes:  @rlamana cool! Do you mind setting up `master` as the default github pages source and putting the link on the repo, so I believe it could be much easier for people to try it Nothing actionable for A-Frame core here, continue to build procedural components and projects, and disperse them into the community. environment is pretty well adopted  Probably we should replace this line of `getForColorComponent ()` in `src/core/a-animation.js`

https://github.com/aframevr/aframe/blob/af3f89049d10b9037895b9059e5aa430c6f1bf81/src/core/a-animation.js#L465

```javascript
from = new THREE.Color(dataFrom);
```

with

```javascript
if (dataFrom === undefined) {
  from = new THREE.Color(el.getAttribute(attribute));
} else {
  from = new THREE.Color(dataFrom);
}
```

?

If this looks ok, I'll make PR.
  This was fixed at https://github.com/aframevr/aframe/commit/16e18f66f33d6615db44311b40e965fd3f25e0ff ... will have 0.6.1 out with bug fixes soon.

https://rawgit.com/aframevr/aframe/538439e/dist/aframe-master.min.js  ‚Ä¶te on component initialization (fix #2829)

The following call to `getAttribute` returns the data object of the component (this happens due to one of the perf optimization to reduce unnecessary object copies) that gets modified and then passed to the `setAttribute` method. 
````javascript
var position = el.getAttribute('position');
position += 1;
el.setAttribute('position', position);
````
the oldData object was constructed before building the data object resulting in the oldData to actually contain the current data. The condition that checks if the component should be updated (oldData !== data) was failing because the objects were identical.

Two fundamental changes in this PR:
1. The oldData object is built after the data object is constructed to contain the actual previous data.
2. The update method receives undefined on first call when the component initializes. The core components have been modified to comply. 
 Can we avoid making oldData undefined on the first call? It's extra work to check and opens up for potential for lots of bugs in components (e.g., not accounting it could be both undefined or an object). Can we separate the internal old data versus the public one? Old Data being undefined it what makes sense to me? What do you pass to update on first call, when the component has been just initialized? Empty data makes just as much sense. And it's backwards incompatible and puts less type checking effort and less potential bugs for component authors.

What do we return where?  What about components that don't have an object as schema data type like visible for instance? If the default is false people might do things like `if (oldData) {...}` undefined works better for single-prop schemas. I think that was the current behavior. Ok, I'll revert back to passing `{}` on multi prop schemas and `undefined` on single property Can also update the PR description for future reference. yeah  Are you on `0.6.0` or `0.5.0`? Thanks!  Can you provide a link to an example that reproduces the issue?  A fix for `setAttribute` has landed on master (https://github.com/aframevr/aframe/pull/2840). I cannot reproduce this bug on the text example.  Please let us know if you are still affected and can provide an example to reproduce @vrimaginar are you trying with the master branch? IiRC, the support for auto width and height is on text component, not geometry component... That's an error in the documentation. Geometry does not have auto height and width properties. I tested on the [text example](https://a-frobot.github.io/aframe/examples/test/text/) and it works fine to me (see the fucsia plane in the middle) by doing:
```javascript
el.setAttribute('geometry', 'primitive: plane; height: 1; width: .5')
```
![test](https://d3vv6lp55qjaqc.cloudfront.net/items/1o2s3N3d1M2s0b293j0M/Image%202017-07-17%20at%204.20.01%20PM.png?X-CloudApp-Visitor-Id=4ef42a89e08bc241f872ecc16ec4e51f&v=83ed0c9e) I'm surprised that was working at all. `auto` is not a valid value for the geometry `width` and `height` it will be parsed as an integer resulting in a `NaN`. The `text` component does not check anywhere for `auto` values either. I think the text component should have a `backgroundEnabled` property and manage its own geometry instead of relying on user doing any sort of manual configuration. @machenmusik any ideas? The mystical processing of `auto` is here: https://github.com/aframevr/aframe/blob/master/src/components/text.js#L270

'auto' was more memorable and descriptive than `0`

I think the problem here is that adding the geometry component is not triggering layout update.  But if you do anything that causes the text component to recompute, the geometry component values are then set.

Apologies that my prior comment was not clearer. @dmarcos the text component does manage its own internal geometry, but does not include background (nor padding/margin); one issue that would arise with deprecating the magic geometry handling and replacing with a fixed background plane is that you don't always want a plane as background. `auto` ends up being a `NaN` when it is parsed as a `Number`. I would constraint the background to a plane handled within the component and for other kinds of geometry as a background the user can handle that externally. I don't think resizing automatically a random geometry is going to end up producing the results you expect.  Yeah I think there were issues with explicit zero being mistaken to mean default (which is nonzero)

I am on the fence w.r.t. background, IMO without padding / margin the background may not be so helpful since it may look wrong; not sure change in behavior is worth breaking backward compatibility... The change will ship on 0.8.0. I'm not concerned about backwards compatibility.  I think is better to evolve the API and ensure good ergonomics rather than being worried about backward compatibility. At the of the day we're still in 0.X.Y versions. The original idea was to be able to use text to label a plane or box or anything that had a width and height.  But that was rather early on, I don't think I realized that model loaders like obj and glTF were not considered geometry, so maybe that hasn't ended up being as useful as hoped. What about adding a `backgroundEnabled` flag and the components sets the plane geometry internally? maybe call the new flag `backgroundPlane` and have it forcibly `setAttribute('geometry', {primitive: plane; width: __, height: __})` -- and if false (default), continue existing behavior for backward compatibility? or it could be `background: plane` (so in theory you could also use box or other primitive) I would start with just a plane and make it work really well. Expanding to any geometry is too much ground to cover. I would probably not use the geometry component but create a custom geometry internally with THREE  Thanks!  A-Frame already has a Wakelock mechanism when entering VR mode that works as expected for me on any of the aframe.io examples (https://aframe.io/examples/) and on a Samsung Galaxy S6. NoSleep.js is not working on the glitch example because it is not initialized by user action (NoSleep.js uses a video element playback mechanism), as the NoSleep.js demo (http://richtr.github.io/NoSleep.js/example/) does when the button is clicked. As mentioned above you can initalize NoSleep.js by putting a button or splash screen in your demo that user has to click. I don't think any action has to be taken on the A-Frame side, this is a general problem of integration of NoSleep.js with Chrome for Android.  is submitting the PR against the docs branch intentional? We don't do fix uplifts to older versions of aframe. We recommend people to update to the latest version instead (now 0.6.0) Do you think this PR is still necessary? 0.6.0 fixes this, and the docs branch is just for cherry-picking documentation fixes.  This PR is made against the docs branch. It should be against master We will be releasing 0.6.1 later this week. If this PR is submitted against master the fix will shipped with it. We then have to recommend people to upgrade. Fixing on 0.4.0 and 0.5.0 won't help much since we would have to cut a 0.4.1 and 0.5.1 releases that devs would have to upgrade as well. We just do bug fix releases of the latest public version. 0.6.0 at the moment Yeah, should be against the doc branch, but we don't cherry-pick fixes to older versions. Newer versions exist to improve older ones.  add HLS example, converted from https://github.com/aframevr/aframe/issues/1846#issuecomment-309201624
 tested using native HLS support in Edge browser, using local server run as `npm start` The example is a bit buried. Wouldn it be better to add it to the existing videosphere example? We could add a button on screen to switch to the hls one. What do you think? I thought about something like that but was unsure since many browsers do not support native HLS. We could make the existing example the default one and a button on the corner to switch to the HLS one @dmarcos you mean like the latest commit?  CSS styling welcome... @machenmusik: I have a device (for just this purpose!)

I‚Äôll test it tomorrow and get back to you.

thanks for taking this on :) This seems like a pretty narrow use case (iOS + video + streaming + HLS). This seems like it could be done fairly easily outside of A-Frame without A-Frame supporting it specifically? why limit A-Frame‚Äôs video capabilities? and, if A-Frame decides to explicitly not support these video use cases, provide a working solution for integration with A-Frame. if A-Frame doesn‚Äôt just work out of the box, potential big names will just move on to a different WebVR framework that does. Similar to what happened with Shopify VR prototyping with A-Frame but [ended up settling on PlayCanvas](https://www.shopify.com/partners/blog/building-a-vr-shopping-experience). Because there's a maintenance cost, complexity, and it can be accomplished outside A-Frame. I believe A-Frame is successful with adoption in the WebVR space, I don't think it hinges on iOS streaming video support. 2) Sure, the extra shaders, special checks for Mac, switching shaders depending on a combo of file type and platform, needing to communicate between different parts of code base for whether a texture needs a flip or correction, and additional logic branching in code I already have a hard time following (texture and material utils). Then on top of that the browsers are always changing, and different browser versions. Then compared against the demand.

Perhaps, there's no way to apply the quirk through the base material component, but it should be possible if you wanted iOS HLS to have a component that does everything start to finish. There's a high bar for core features, we've excluded much more popular features from the core. @cvan There‚Äôs a thousand things A-Frame could do and we have to prioritize and factor in complexity and maintainance cost. If there‚Äôs a strong market signal that indicates that `iOS + video + streaming + HLS` is important we can consider it. Said that even if we try to cover as much ground as we can we won‚Äôt get 100% adoption since taste and personal preferences also play a role in decisions. Shopify does not provide much detail in the blog post about why they favored Playcanvas over A-Frame. I would love to know more but it does not seem to be video related. If you have more info please feel free to open any issues with the functionality you think is missing. @dmarcos Fair points, thanks. As @machenmusik points out in [his comment above](https://github.com/aframevr/aframe/pull/2830#issuecomment-337408140), iOS is not the only consumer of HLS. Microsoft Edge (Windows Mixed Reality) and Safari use HLS.

You did great work to quickly get `0.7.0` shipped to have A-Frame support Windows Mixed Reality-capable headsets as first-class citizens.

Supporting video on these platforms is just the right thing to do.

`Why won't my video play in A-Frame?` is one of the most frequently asked questions. I think any Pull Request that improves the quality of video playback is a Pull Request that deserves to be considered to be merged upstream. Especially if others are helping to review (and maintenance provided in the support of issues filed, tests written, and follow-up PRs), this is how an open-source project can function to satisfy desires of those that are not the core, active project maintainers.

Just based on the public signals, Apple is participating in the WebVR spec. It wouldn't be a leap in imagination to assume that Safari on desktop will eventually support WebVR.

If video is not considered not an A-Frame priority (roadmap or not), @machenmusik should have been consulted back when he opened this PR on June 30.

I would think that having the popular video sites be able to use A-Frame would rank pretty high on the priority list. If you take a look at the sub-Reddits for every popular mobile VR headset, the same questions keep coming up: `How can I upload my videos to play in VR?` or `How do I play 360¬∞ videos on the VR browser?`

There are clear signals from users, developers, and the A-Frame community (GitHub, Slack, Twitter, Reddit) that they want first-class video support.

Costs of developer burden vs. longevity of A-Frame.

A-Frame ought to bite the bullet and handle all the quirks and browser inconsistencies, and support native APIs already supported in 2D, on behalf of the developers.

The answer shouldn't be `video isn't as important as X, sorry`. It should be `sure, thanks for the patch; let's make sure this works; developers, try this out; and respond to the feedback`. No one's against supporting video, but the PR is more about iOS + HLS quirks. General video issues have been difficulty in addressing continually changing browser quirks. If you are interested in pitching in, a Glitch demonstrating video playback on iOS would be valuable for the docs. I understand the concerns, but the longevity of A-Frame being threatened is a fairly extreme case to make. Apologies for the delay in reviewing the PR, lots of things happen at once, specifically 0.6.0 was released exactly on June 30th, so this got lost in the mix. I'd support it in a component. It'd probably take you 20-30 minutes to publish, and the code path much, much easier to maintain. I'd keep the material component simple; I myself just make my own material component when it doesn't support something I need, much quicker than trying to bake/test it into core. If you need to update it, does not need to go through us. It'd be more discoverable as well as a component.

Regards to PR, I'd vote to close and then remove the quirk-hacking, and throw up a component.  What do we need from the PR to have a working HLS example? We can't have an `hls-video` component that does everything start-to-finish with a Glitch that we can publish to the docs? I was proposing not only the quirk handling, but entire feature and handling altogether. You can create your own texture in the component as well, no need for A-Frame to flip/specify texture properties. I'm also leaning to keep this as a separate component and let it evolve independently. There seems to be too many quirks and edge cases on a device and browser basis. Video streaming in general seems a bit of a moving target. If we feel there's a good paved way we can recommend I would reconsider to put it in the core. 

Some additional info to consider when gauging demand of video in WebVR based on personal observation:
1. For people starting without 3D graphics knowledge, video or panos seem the path of least resistance to start kicking the tyres and learn A-Frame. More often than not, the end goal of people doing video is not shipping video in production. Many of those questions we see about "How do I render Youtube, or this and that video?" come from people on a first exposure to WebVR / A-Frame and quickly move to other kind of experiences. A basic support of video for learners might be enough in the core. With this I'm not saying there is low demand for video content but something to consider is that the perception might be higher than the actual demand.
2. About KRPano. It is a specialized product that supports a wide range of 360 image and video formats. It also comes along with tools to prepare assets. They provide an end to end workflow. I imagine a whole new separate project focused on 360 video / panos. A-Frame core should not aim at covering so much ground.

 Video is supported in-core minimally. Will detect if a video is passed and use VideoTexture if so. Any workarounds or additional needs supported outside core. HLS is especially even more of a niche demand. If KRPano offers something good in those regards, that's great. We'll continue to listen to opinions, but I don't think we can assuage anyone that disagrees fundamentally how we guide A-Frame's direction.

I hope this decision is understandable to some capacity since these conversations have taken too much time. Here's moving forward:

- Closing the PR.
- Removing any special HLS shaders and hooks and such.
- Recommend anyone interested to create a component/Glitch to handle these needs. Have the component act outside the A-Frame material codepath. We can feature in the docs, there's no difference to interested developers where it lives. Measure how well it goes, then we re-evaluate in the future.

It should be extremely easy to release a component and/or Glitch. This is foundational to A-Frame's philosophy: permissionless innovation and extensibility. If anyone is passionate about helping with video, publish a component/Glitch/guide that will help people today; no one has stepped up there. It is a much more efficient path than trying to maintain in material component's dizzying code path. The [prescribed way to add examples](https://github.com/aframevr/aframe/blob/master/CONTRIBUTING.md#add-glitch-examples-to-documentation) is to create a Glitch and link from the documentation. That way people can remix it/try it out instantly, and the code is more copyable since the `dist` is not a relative path to a Browserify build.

Hosting on the repo means we'd have to maintain it, any little changes need to get reviewed/tested, and indicates a level of quality of support which I can't guarantee.  and https://bugs.webkit.org/show_bug.cgi?id=163866#c17 is the WebKit bug to follow We can leave the examples folder as is for now, perhaps for testing core features and components, but start to move towards Glitches for examples and demonstrations.  Most likely because of the changes of skipping type check if reusing the same object, thanks will check it out. @ip can you add a test case? thanks! I found the problem. For single property components like `position` or `scale`. The component oldData is not a copy of data but a reference. When doing things like:
````javascript
var position = el.getAtttribute('position');
position.y += 1;
el.setAttribute('position', position);
````
Both data and oldData are modified. the `update` method of the component is never called because no changes in the component are observed since  `oldData === data`. PR coming If you call `setAttribute` multiple times with the same object (as you do in your example), the object is considered trusted and we disable certain checks on it (type checking and comparison with oldData values). Your second call to `setAttribute` is going to through a different path that ends up triggering the change you were expecting on first call (because we don't compare against oldData) We should probably restore the comparison with oldData regardless if the same object is passed multiple times to `setAttribute` (thinking about it)  This has been fixed on aframe master branch in github   @autonome Do you know if the fix ever landed on the polyfill? We can pull the fix in for `0.6.1` next week  Hi @7dir ‚Äî Nice! Would you like to add your component to [awesome-aframe](https://github.com/aframevr/awesome-aframe)? I don't think there's anything actionable on this issue.  You can play with the segments property and see if you can find a lower value that feels good. PRs are welcome :) https://github.com/aframevr/aframe/blob/master/src/extras/primitives/primitives/a-cursor.js#L12  Thanks! Almost ready to go. There's a broken test to fix I've updated to fix tests, added tests for selectors that were not accounted for, fixed the regex. thanks much  Thanks!  Seemed to be causing backward compatibility issues with animated cursors Gonna need to grep the examples and tests @ngokevin did you want to finish this one off?  I won't be able to get back to it for a while  Can you post example code which this PR might address? Will help clarify the case, thanks! I would add a test with the case that this PR fixes added the tests  Nice catch  This does seem to be a bug, really weird. I can reproduce on master + Firefox too. And using the text component vs. primitive as well.

Here's a Glitch: https://glitch.com/edit/#!/cherry-driver Fixed  Can you try `material="visible: false"`? I believe three.js changed to look at the material visible property rather than object3d visibility.  I think instead we should just revert it back to `cursor-fusing` in the code. Not worth breaking the few examples with animated cursors. Also the PR should be opened against master branch.  @vrimaginar Do you want to open a PR? Thanks! I think @cvan called that out as a backward incompatibility in laser-controls PR... Yes, I think the question is whether to accept the incompatibility and change docs to match the new name(s), or change back to backward compatible names and leave the docs. I believe that the change made as part of laser-controls PR was to the raycaster event names, so not only impacting laser-controls. I might just change it back. The states aren't used often in public API and thought it was ok but forgot about the cursor animation docs Changed back  I'm curious what would happen if you decomposed the primitive to entity + components. A-Frame has a fairly strict child-to-parent/inside-out load order. All children have to be loaded (meaning node is attached, components are initialized), then the entity initializes all components, then emits that it is loaded. So it's hard to think that it'd be due to the A-Frame core, maybe it's because of primitives, or maybe another issue, but I'd love to know more. Where is locomotor-auto-config defined?  To clarify the use case, are you interested in events from the gamepad, getting current state of the buttons, or position/rotation? Or some combination of those?

It looks like even within `tracked-controls`, there is no reference to which hand it is. We'd need to look at the `<device>-controls` component for that, which is inconvenient. 

One solution would be to include `hand: 'left' | 'right'` in the `controllerconnected` event. Actually, the current vive-tracker PR may have some changes one is looking for here... especially regarding hand Not all tracked controllers have the concept of handness so we include that on the vendor specific controls live `oculus-touch-controls` or `vive-controls` @AndresCuervo Can you share a bit more of your use case so we can recommend a solution? A code snippet / markup will help IMO, seems like there are a few different topics this brings up:
(1) exposing hapticActuators for more convenient use
(2) declarative markup to respond to the events controllers generate
(3) stylistic difference between attaching event listeners ad-hoc that dispatch functions, and making components that contain the functions and are attached to the same entity What controllers are you supporting? I recommend using the higher level controls that will give you the button mappings. if you use `vive-controls`, `daydream-controls`, `oculus-touch-controls`... you can listen to events like `triggerdown` , `touchpaddown` ... the handle to the entity will be passed to the handler. Look at `hand-controls` as an example https://github.com/aframevr/aframe/blob/master/src/components/hand-controls.js IMO Declarative ways to attach handlers ends up being more confusing than helpful when applications get complicated since you have logic scattered between HTML and JS and it's unclear what is the scope and where those handlers live. I agree that an haptics API is a different conversation Is there anything actionable in this issue? I feel the requested functionality (besides haptics) is already provided by our vendor specific controls. As a general rule devs won't be interacting often with `tracked-controls` unless you want to integrate a controller that does not have built in support > if you use vive-controls, daydream-controls, oculus-touch-controls... you can listen to events like triggerdown , touchpaddown ... the handle to the entity will be passed to the handler. Look at hand-controls as an example 

This works; I think the OP also wants to know which hand the entity is associated with, and the entity doesn't give an easy way to identify that without iterating over `vive-controls`, `daydream-controls`, `oculus-touch-controls`... but that is not hard to work around, by attaching `id="left"` to the entity yourself.

But the tl;dr here is, if users want behavior attached to a specific hand, it's best to put that behavior in a component on that hand, rather than writing outside event listeners and trying to work backwards to get the Gamepad and hand references.

Other than maybe continuing the haptics conversation somewhere, I don't think changes are needed here then. @donmccurdy agree although doc and example changes may still be relevant Re: declarative handling turning into obfuscation - yeah, often times the handling is placed in a component that is attached to the same entity (and sometimes the dependencies feature of components is used to ensure the right components are attached)  init should br called since the geometry is recreated when the properties change. For advanced, more optimized geometry I would recommend creating a separate component instead of relying on extending the built in primitives  Thanks! I recommend a custom component for now, the `registerGeometry` I think we should even make internal API just for the geometry component.  thanks!  Did this already at https://github.com/aframevr/aframe/commit/0f3ff992ae71819e0048f4f04fc36083688a1a10 but hmm builds are erroring. Maybe we have to lock it down without the `^`? OK, I see, can you rebase? Thanks!  Thanks, but it was correct before. Multiple `<a-light>`s. `<a-lights>` is not valid. I wanted to make it plural without having to say `with <a-light> elements`  This should work, we should find out why it isn't.

https://github.com/mrdoob/three.js/blob/master/src/audio/PositionalAudio.js#L82 Thanks, we can take a look for a real solution. I'll test it out now.  Hi @kazandzhiro ‚Äî

See issues https://github.com/aframevr/aframe/issues/1475 and https://github.com/aframevr/aframe/issues/2758. For various reasons, we're not able to offer much support for IE11. Specifically in this case, the dependency on TypedArray.prototype.slice goes past A-Frame into some of our three.js dependencies.

That said, I thought this feature was in IE11. Does adding this meta tag in `<head/>` give a different result?

```html
<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
```

You may also be able to add a [TypedArray polyfill](https://github.com/substack/typedarray) to your page. But generally speaking, we very much recommend using an evergreen browser (Microsoft Edge, Firefox, Chrome, or Safari) with A-Frame.  Hi @vrimaginar ‚Äî it looks like the model is hitting some sort of GPU limit on your other devices. I don't have enough info to guess what exactly it is, but tl;dr my advice would be to reduce the complexity of your model. 85MB is quite a lot for a mobile device to deal with. In Blender, you can simplify the model with tools like the [Decimate Modifier](https://docs.blender.org/manual/es/dev/modeling/modifiers/generate/decimate.html).

Targeting <15MB is likely to give better results, and more like 1‚Äì2 MB if you intend for yours to view your presentation on their cellular connections. Hm. Hard to guess whether it is the model itself, then. I'd be curious if you can remove things from the scene (remove one sky sphere at a time?) and if it starts to work at some point. Try using this build https://rawgit.com/aframevr/aframe/8d60730/dist/aframe-master.min.js where textures get auto disposed when not in use. What may be happening is you are switching between the spheres and the textures in memory accumulate. Also helps is rather than 15 skyspheres, have one at a time and swap out the image  It restarts randomly, while interacting with the scene, in 2D mode, in VR mode? I can't reproduce on my iPhone 7 Plus with https://aframe.io/examples/hello-metaverse/.
@CallumMitchellRV Do you think we can close this? Is it still a problem for you?
 @CallumMitchellRV Can you try with master branch and see if it still reproduces? @CallumMitchellRV thanks for filing this issue. sorry that it's fallen through the cracks. what are your screen-lock settings on your iPhone? the stock, default settings?
 Cool @moyashipan. Thanks for verifying  A PR to fix this landend last night: https://github.com/aframevr/aframe/pull/2751

Can you make sure you're using the very latest master? The issue is different and mentions that pr Can someone try #2707 and see if it is the old Carmel auto-enter attempt?  Added  Thanks!  @hardiksurana caching is handled through A-Frame's asset management system: https://aframe.io/docs/0.5.0/core/asset-management-system.html

If you're using inline URLs instead of `<a-assets/>`, you may be circumventing the caching. If you are already using the asset system, could you:

1. Test on the `master` branch of A-frame ‚Äî we've already fixed some bugs in this area.
2. Add a Codepen or JSFiddle example.

Thanks!

> EDIT: Oops, just saw you mentioned `a-assets` in the title. Anyway, the two suggestions would be the right next steps I think. I think the extra requests were fixed here: https://github.com/aframevr/aframe/issues/2472

So, that fix is in the `master` branch, not 0.5.0, and will be released with A-Frame 0.6.0.

A-Frame doesn't give you direct access to the response status codes, but there should be only one request anyway after these fixes. Hope that helps! I believe the 304 are just browser cache hits? You can check `THREE.Cache` to see if it has been fetched or not  Thanks! Do you want to try opening a pull request to fix it? We can help if you don't know how to Here are the steps for updating our docs, if you're interested, @kkruups ‚Äî https://github.com/aframevr/aframe/blob/master/CONTRIBUTING.md#update-documentation Fixed #2777  **Description:**

- A-Frame Version: 0.5.0
- Platform / Device: all
- Reproducible Code Snippet or URL:

Just run this install to `aframe` version `0.5.0`:

```sh
npm install aframe
```

<details>
<pre><code>0 info it worked if it ends with ok
1 verbose cli [ '/usr/local/Cellar/node/8.0.0_1/bin/node',
1 verbose cli   '/usr/local/bin/npm',
1 verbose cli   'i',
1 verbose cli   'aframe' ]
2 info using npm@5.0.1
3 info using node@v8.0.0
4 silly install loadCurrentTree
5 silly install readLocalPackageData
6 http fetch GET 200 https://registry.npmjs.org/aframe 734ms
7 silly pacote tag manifest for aframe@latest fetched in 776ms
8 silly install loadIdealTree
9 silly install cloneCurrentTreeToIdealTree
10 silly install loadShrinkwrap
11 silly install loadAllDepsIntoIdealTree
12 silly resolveWithNewModule aframe@0.5.0 checking installable status
13 http fetch GET 304 https://registry.npmjs.org/deep-assign 77ms (from cache)
14 silly pacote range manifest for deep-assign@^2.0.0 fetched in 79ms
15 silly resolveWithNewModule deep-assign@2.0.0 checking installable status
16 http fetch GET 304 https://registry.npmjs.org/style-attr 155ms (from cache)
17 http fetch GET 304 https://registry.npmjs.org/object-assign 158ms (from cache)
18 http fetch GET 304 https://registry.npmjs.org/three 91ms (from cache)
19 silly pacote range manifest for object-assign@^4.0.1 fetched in 175ms
20 silly resolveWithNewModule object-assign@4.1.1 checking installable status
21 silly pacote range manifest for style-attr@^1.0.2 fetched in 173ms
22 silly resolveWithNewModule style-attr@1.3.0 checking installable status
23 silly pacote range manifest for three@^0.83.0 fetched in 112ms
24 silly resolveWithNewModule three@0.83.0 checking installable status
25 http fetch GET 304 https://registry.npmjs.org/debug 229ms (from cache)
26 silly pacote range manifest for debug@^2.2.0 fetched in 231ms
27 silly resolveWithNewModule debug@2.6.8 checking installable status
28 http fetch GET 304 https://registry.npmjs.org/tween.js 47ms (from cache)
29 silly pacote range manifest for tween.js@^15.0.0 fetched in 50ms
30 warn deprecated tween.js@15.0.0: This package has moved to @tweenjs/tween.js. Please update your dependencies.
31 silly resolveWithNewModule tween.js@15.0.0 checking installable status
32 http fetch GET 304 https://registry.npmjs.org/promise-polyfill 257ms (from cache)
33 http fetch GET 304 https://registry.npmjs.org/load-bmfont 263ms (from cache)
34 silly pacote range manifest for promise-polyfill@^3.1.0 fetched in 261ms
35 silly resolveWithNewModule promise-polyfill@3.1.0 checking installable status
36 silly pacote range manifest for load-bmfont@^1.2.3 fetched in 266ms
37 silly resolveWithNewModule load-bmfont@1.3.0 checking installable status
38 http fetch GET 304 https://registry.npmjs.org/envify 308ms (from cache)
39 http fetch GET 304 https://registry.npmjs.org/present 310ms (from cache)
40 http fetch GET 304 https://registry.npmjs.org/browserify-css 324ms (from cache)
41 silly pacote range manifest for envify@^3.4.1 fetched in 316ms
42 silly resolveWithNewModule envify@3.4.1 checking installable status
43 silly pacote version manifest for present@0.0.6 fetched in 316ms
44 silly resolveWithNewModule present@0.0.6 checking installable status
45 silly pacote range manifest for browserify-css@^0.8.2 fetched in 328ms
46 silly resolveWithNewModule browserify-css@0.8.4 checking installable status
47 http fetch GET 304 https://registry.npmjs.org/three-bmfont-text 162ms (from cache)
48 silly pacote range manifest for three-bmfont-text@^2.1.0 fetched in 164ms
49 silly resolveWithNewModule three-bmfont-text@2.2.1 checking installable status
50 info lifecycle document-register-element@0.5.4~prepack: document-register-element@0.5.4
51 silly lifecycle document-register-element@0.5.4~prepack: no script for prepack, continuing
52 verbose tar pack [ '/var/folders/zn/l4r1wmpj57q7h97088lcf6gw0000gn/T/npm-56448-5bf4136e/tmp/packing-6b2ac072/package.tgz',
52 verbose tar pack   '/Users/cvan/.npm/_cacache/tmp/git-clone-a2c71706' ]
53 verbose tarball /var/folders/zn/l4r1wmpj57q7h97088lcf6gw0000gn/T/npm-56448-5bf4136e/tmp/packing-6b2ac072/package.tgz
54 verbose folder /Users/cvan/.npm/_cacache/tmp/git-clone-a2c71706
55 info lifecycle document-register-element@0.5.4~postpack: document-register-element@0.5.4
56 silly lifecycle document-register-element@0.5.4~postpack: no script for postpack, continuing
57 silly pacote git manifest for document-register-element@github:dmarcos/document-register-element#8ccc532b7 fetched in 1728ms
58 silly resolveWithNewModule document-register-element@0.5.4 checking installable status
59 silly fetchPackageMetaData error for webvr-polyfill@github:dmarcos/webvr-polyfill#a02a8089b Command failed: /usr/local/bin/git checkout a02a8089b
59 silly fetchPackageMetaData error: pathspec 'a02a8089b' did not match any file(s) known to git.
60 verbose stack Error: Command failed: /usr/local/bin/git checkout a02a8089b
60 verbose stack error: pathspec 'a02a8089b' did not match any file(s) known to git.
60 verbose stack
60 verbose stack     at ChildProcess.exithandler (child_process.js:252:12)
60 verbose stack     at emitTwo (events.js:125:13)
60 verbose stack     at ChildProcess.emit (events.js:213:7)
60 verbose stack     at maybeClose (internal/child_process.js:887:16)
60 verbose stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:208:5)
61 verbose cwd /private/tmp/atest
62 verbose Darwin 15.2.0
63 verbose argv "/usr/local/Cellar/node/8.0.0_1/bin/node" "/usr/local/bin/npm" "i" "aframe"
64 verbose node v8.0.0
65 verbose npm  v5.0.1
66 error code 1
67 error Command failed: /usr/local/bin/git checkout a02a8089b
67 error error: pathspec 'a02a8089b' did not match any file(s) known to git.
68 verbose exit [ 1, true ]</code></pre></details>

This is because in [`0.5.0`](https://github.com/aframevr/aframe/tree/v0.5.0) the [`package.json`](https://github.com/aframevr/aframe/blob/v0.5.0/package.json#L43) points to [`dmarcos/webvr-polyfill#a02a8089b`](https://github.com/dmarcos/webvr-polyfill/commit/a02a8089b).

Even though the [`dmarcos/webvr-poylfill`](https://github.com/dmarcos/webvr-polyfill) moved to [`aframevr/webvr-polyfill`](https://github.com/aframevr/webvr-polyfill), GitHub keeps the old remote URLs around (and just adds deprecation notices). But `npm` does not.

@dmarcos: can you delete https://github.com/dmarcos/webvr-polyfill and re-fork [`aframevr/webvr-poylyfill`](https://github.com/aframevr/webvr-polyfill/fork)?

(this may require you to delete your original fork from https://github.com/googlevr/webvr-polyfill, because GitHub doesn't allow forks of forks.)
 I reforked the polyfill on my account: https://github.com/dmarcos/webvr-polyfill/

The hash https://github.com/dmarcos/webvr-polyfill/commit/a02a8089b exists now show npm should fetch it as expected. Just tried and it seems to work. Please reopen if the problem persists
 @dmarcos: Thanks! I see that the commit resolves on GitHub, but I cleared my npm cache and it still won't install properly. I tried `npm cache clean`, `rm -rf ~/.npm`, `npm cache verify`,

<img width="1145" alt="screen shot 2017-06-13 at 6 42 29 pm" src="https://user-images.githubusercontent.com/203725/27111887-26faedf4-5068-11e7-86d5-b7f4f0da7a39.png">

Ideas?
 That screenshot does not seem related to the polyfill. Try deleting your `node_modules` directory and run `npm install` again? Below the result in my windows box:

![install](https://d3vv6lp55qjaqc.cloudfront.net/items/2j402d3h2Q450q270N1p/Image%202017-06-13%20at%206.50.39%20PM.png?X-CloudApp-Visitor-Id=402ef9a4b6ed079d2b4c220eb45be353&v=d217e0dd).  It says `Command failed: /usr/local/bin/git checkout a02a8089b`.

The commit in question is https://github.com/dmarcos/webvr-polyfill/commit/a02a8089b. So, it seems to still be the `webvr-polyfill` dependency it's fatal-erring on. I'll try on another machine and clearing my cache too. I just hope others aren't encountering the same problem of trying to install `npm install aframe` once and it not being fixed now.
 Someone else is observing the issue. Additional info: npm `3.10.X` works but more recent versions `5.X.Y` fail. Fails for me on a Windows machine I haven't used in a while. npm 2.15.11. We can cut 0.5.1 on npm, perhaps pointing to a fork on my username to be safe. A workaround to this issue for anyone running into this today until we fix is `npm install aframevr/aframe@0.5.0`. Same issue here. Installation fails with npm 5.X, so I've reverted to npm 4.X. Currently fixing...the commit is on GitHub but no longer on the Git tree. Solution is to publish a fork of the polyfill to npm with the same changes and re-tag v0.5.1. I don't think we need a new tag anymore. I believe I solved the mystery. When I reforked the polyfill in my account the commit showed up on github (https://github.com/dmarcos/webvr-polyfill/commit/a02a8089b) but just realized that it does not exist in git. Github must have some sort of cache that in same cases is not consistent with the git data base itself. I had the missing commit on a local clone of my old fork that I have pushed again to github. I believe that everything should be fine now without having to republish, re tag.  @clark @DKvistgaard can you confirm if everything is working now? You should not need any changes on your side. It should just work üëèüíÉ @natesena could you give npm and node.js versions? `npm -v` / `node -v` @natesena What version are you trying to install? I see a reference to your cache in the command out put you pasted. Clearing your cache with `npm cache clean` and reinstalling `npm install aframe` might solve the problem. Let us know.  If you are trying to use the recently added core daydream controller support, the component name is `daydream-controls` if I recall correctly - not `daydream-controller` Does using WebVR API in Chrome on Daydream still need either origin trial token or explicit WebVR feature flag enable?  If so, and you haven't done either, then I would expect requestPresent to fail due to browser denying permission. So wait, if you turn OFF WebVR support (and then are presumably using polyfill not Daydream mode) then I don't think the controller will work.  My understanding is that you have to be in Daydream mode (WebVR enabled) for the controller to do its job. @intensr @caseyyee: this appears to be a dupe of issue #2677. we should close one of the bugs and  address this issue. A little testing of my own...

After a host of updates to Pixel phone and controller (all now on latest), and using Chrome beta (webvr enabled so no origin trial token dependency) with controller example codepen:
 https://codepen.io/machenmusik/pen/YQGrWQ
Once you enter VR and click the track pad, since for security the Gamepad API will not provide controller data until the controller is used, the controller is visible (although it required re-home position) and clicks work. @cvan we probably want to work issues with official phone and controller firmware first, then come back to see if that fixes this one.  On Pixel with Chrome beta and latest aframe master, I don't see any issues @intensr the Axon 7 is an official Daydream device, but from original post I understood you were not using the production firmware ("yes its flashed") which I think would be the important Axon variant to support (complicated by the fact that AFAIK no one on current A-Frame team has one).  Using my Pixel that just updated itself and controller to 7.1.2, and Chrome beta with the WebVR flag thrown to work around the codepen-has-no-origin-trial-token issue, the Codepen I mentioned worked as expected with Daydream controller.  edit: there seems to be other issues here at play.

I'll post testing summary for just controller issue into 2677

@cvan I think we can continue to address the enter VR issues here for this device. @intensr if the page you are using is insecure or lacks origin trial token (which is true for Codepen) I think the WebVR flag must be manually enabled, and you need to touch button on the controller after entering VR for it to appear  @intensr sorry if this is obvious but just to make sure w.r.t. the WebVR enable flag you have done  https://webvr.rocks/chromium steps 4 and 5 with your Chrome In Chrome release channel one has to enable the GamepadExtensions in chrome://flags (besides WebVR) in order for the Daydream controller to show up. In Canary this is not necessary. In both cases, Chrome + GampeadExtensions and Canary the controller shows up consistently on https://webvr.info/samples/XX-vr-controllers.html, https://threejs.org/examples/#webvr_daydream and also aframe laser-controls from master when run locally on my machine https://github.com/aframevr/aframe/tree/master/examples/test/laser-controls

@intensr Please use Chrome with WebVR and GamepadExtensions enabled on chrome://flags or Canary. The example included in master should work. https://github.com/aframevr/aframe/tree/master/examples/test/laser-controls

Please reopen if it does not. I'm running into the same issue here. Daydream controller works on the webvr.info and threejs.org examples but not on the aframe examples.
Adding the controller to the hello-world example, I got the following state
![image](https://user-images.githubusercontent.com/782511/31865332-c5fa284a-b76d-11e7-8af0-f411426cd096.png)
 It looks like some async problem maybe? As If I'm adding breakpoints that slow down the initialization sometimes it works and the controller appears Is that master or 0.7.1? Both Something must have changed on the chrome side @dmarcos could you reproduce it too? I don‚Äôt have a daydream around today Go home get one! Everything is on fire! @machenmusik on the first link doesn't work but on the second one yep Git bisecting it right now... :\ It's some kind of async issue, as after getting an absurd bisect commit, I went through your two codepen examples and I reload them several times and I got both of them working and not working.
 I spent hours testing daydream for 0.7.0 and the laser controls example was working rock solid. I‚Äôm almost certain that something must have changed on the chrome side Testing on Canary: https://aframe.io/aframe/examples/test/laser-controls/ works fine for me FYI `hand-controls` does not support 3DOF anymore. `laser-controls` is the recommended responsive input.  @dmarcos yep I'm not using `hand-controls` I'm testing always against `laser-controls` and I'm still getting random failures :\ I'll post if I find something Reproducing the issue: https://www.youtube.com/watch?v=OvODqJ9l_Yc  **Description:**

Barebones stats component, all it does is show one number: FPS.

```html
<a-scene stats>  <!-- 2D stats. --> 
  <a-entity stats position="0 0 -4" text="color: red"></a-entity>  <!-- Rendered stats. -->
</a-scene>
```

Most of the implementation:

```js
AFRAME.registerComponent('stats', {
  tick: function (t, dt) {
    this.el.setAttribute('text', 'value', 1000 / dt);
  }
});
```

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 hmm, was wondering whether potentially having to re-render glyphs every tick was going to be a performance killer, versus something like the FPS counter on https://webvr.info/samples/02-stereo-rendering.html That seems like a canvas to texture render? I don't think updating a number has a big performance impact, the log component example I did was thrashing five different logging consoles with lots of text and it seemed fine. https://github.com/ngokevin/kframe/tree/master/components/fps-counter#aframe-fps-counter-component  Thanks!  Ok, so it looks like the `#audiosource` element is no help at all here ‚Äî presumably the three.js audio system is making its own copy of the sound, in order to do positional audio or something.

Instead, you need to use the element with the sound component attached to it, and then dig into the API a fair bit:

```js
var soundComponent = entity.components.sound;
// NOTE: If the audio file hasn't finished loading, `.source` will be null.
var audioSource = soundComponent.pool.children[0].source;
var audioContext = audioSource.context;
console.log('currentTime: %f', audioContext.currentTime);
```

Here's a demo: https://glitch.com/edit/#!/aframe-sound-demo

Clearly this isn't the most discoverable, and it's liable to break if there are multiple sounds in the pool... maybe we should expose a `getContext()` method on the `sound` component, for users to get at this programmatically?  What phone?  Confirmed I also have this issue on Firefox Android 7.0 on a Galaxy S7 Edge with A-Frame 0.5. In A-Frame 0.6 / 0.6.1 it's fine.  Don't think it's appropriate to mention in the context of this page. This guide is several steps into A-Frame and we shouldn't try to protect developers from JS here. Thanks though!  I think the image looks fine, img doesn't need a closing tag and your image is served straight from raw.git which isn't a cdn  Oh, I see. Oh, I see! Sorry. That looks great. If you drag your image into any GitHub issue / pull request comment box, it will upload to CDN. Thanks! Nice image editing work  Hi @zubairq, see previous discussion of this here: https://github.com/aframevr/aframe/issues/1475

A-Frame supports Microsoft Edge, but not IE11. There are both feature and performance issues that make supporting IE11 unrealistic for us. If you're going for a simpler (non-VR) 360¬∫ pano experience, you may want to consider [VR View](https://developers.google.com/vr/concepts/vrview-web). For VR content, you will need a newer browser. Yeah I'd use Microsoft edge. Ie11 would be hard to support well. Very minimum we'd need to include a custom event polyfill just for ie @sim3083 do you see any errors in the JavaScript console? @sim3083  Can you run your example with a non minified version to see where it fails? @sim3083 Thanks. Can you click on those errors and see the A-Frame line that it is actually failing? This is because an inconsistency of IE11 CustomEvent implementation where you cannot call `new CustomEvent`. From `CanIuse`:

```
While a window.CustomEvent object exists, it cannot be called as a constructor. Instead of new CustomEvent(...), you must use e = document.createEvent('CustomEvent') and then e.initCustomEvent(...)
```
https://caniuse.com/#feat=customevent It also seems that IE 11 webgl implementation is missing some stuff. Proper custom elements and WebGL are minimum requirements for A-Frame. Is anything preventing you from upgrading from IE11? The `CustomEvent` issue could be special cased for IE 11. I don‚Äôt see any solution for the missing WebGL methods and extensions. Unfortuantely A-Frame won‚Äôt be able to support IE 11 @zubairq Some of it might work if you don't hit any THREE path that uses any of the WebGL missing extensions or methods. @sim3083 Do you see the same WebSocket error in other browsers besides IE11? @sim3083 The WebSockets error is something particular to your network configuration. The other one is due to the incomplete IE 11 WebGL implementation.  Is there a way we can downgrade Sinon and its peers back? Sinon 2.x has a lot of deprecations that we don't have much time to handle or learn the new API.  This PR has regressed VR mode on desktop. Neither Oculus nor Vive enter VR anymore. Delaying the initialization of VRControls introduce timing issues. Note that VRControls is also asynchronous and we have to somehow handle that asynchrony. The timing was right and the extra delay that this PR introduces affects the initialization timing. This PR is not critical for 0.6.0. I'm going to revert and we revisit later in a follow up PR. @kellyselden feel free to reopen. Make sure that Vive / Oculus enter VR mode.   Perhaps try checking if it's a node environment and not initializing it if so?  Thanks! Maybe would be good to add `Requiring A-Frame in Node` section at like https://aframe.io/docs/0.5.0/core/globals.html  Thanks, currently looking at it. Having trouble getting Firefox to play sounds at all. I had an issue with a certain sound where I had to re-encode it with ffmpeg just for Firefox. Does it work for you if you try other sounds? Same issue here. I get the following error when adding `preload=auto` to the `<audio>` element where I'm also using `autoplay: true` on the `sound` component that plays the preloaded sound in the scene:

```
Uncaught (in promise) TypeError: Failed to execute 'decodeAudioData' on 'BaseAudioContext': parameter 1 is not of type 'ArrayBuffer'.
```

This is with using `ogg` encoded audio files. It's also worth noting that manually calling `sound.playSound()` after the render loop begins produces the same error. @johnshaughnessy Should we store the file and not the element in the cache? I cannot remember why we store the element. I will have to dig into it. @ngokevin Do you remember the rational?  Sweet! Thanks!  We use `document.createElement` everywhere. It doesn't matter for Node because we don't expect it to be executing any runtime code, right?  We use github issues for bugs and feature requests. For questions please use stackoverflow:

https://stackoverflow.com/questions/tagged/aframe

or our slack channels:

https://aframe.io/community/#slack
 For posterity: https://stackoverflow.com/questions/44450241/recording-vr-motion-video  Just a small nit and this is ready to go

https://github.com/aframevr/aframe/pull/2748/files#r121260759 Great! Thanks for sticking with it. Not many people get their hands dirty with these parts of the code. Thank you very much!  Does this affect Node usage? Or is this for removing those couple lines in the tests?  In discussions over Slack about the need of adding a flag so some components `tick` / `tock` methods have a higher priority made me think. We now have `dependencies`  and `schema` that turn into reserved words. The approach won't scale if we want to keep adding things like the flag mentioned before. We might want to consider consolidating all the fields in a single `config` object:
````javascript
AFRAME.registerComponent('my-component', {
 config: {
   dependencies: { ... }, 
   schema: { ... },
   priorityTick: true
 }, 
 init: function () { ... },
 update: function () {...},
 tick: function () { ... }
});
````
 We can still take the old form and provide a warning message in console for a couple of versions before deprecating. @donmccurdy @ngokevin what do you think? Offhand, I like the idea of having a `config` property, but I'm not sure dependencies and schema should be in it. They feel less like configuration, or at least schema does. Can we think of other properties that make sense? Some ideas:

- `system` name for components that are part of a multi-component system
- `multiple` could be moved into config. really it's not the component configuration as much as the specification though, right?  when I think of configuration, I think of configuration of an instance of the component (which for public properties is `data`) sidebar - I don't think a Boolean `priorityTick` will suffice if we have enough complexity to require prioritization @wizgrav w.r.t. `priorityTick` -- if we're talking pre/post-processing, presumably those need ordered chains / graphs, and a Boolean can't represent any but the most trivial ordering - use a number at minimum, at which point you probably want to call it `tickPriority` - or maybe I misunderstand the use case @wizgrav there you need to be able to specify ordering of systems right?  e.g. this system needs to go after system X...  Note that there is indeed a screenshot facility in A-Frame, is it not yet accommodated correctly? It sounds okay, but I don't think the prototype is much polluted at the moment, and it's not much work for developers to avoid reserved properties. It does sound like work to migrate the component ecosystem however. The whole component definition is sort of like a config in itself as well. But as we add more properties it will harder to avoid the collisions. We have components already that add all sort of stuff like `mapping` , `axisLabels` or their own private methods. maybe when/if we get around to deprecating primitives, this will be more palatable / necessary.
another option, of course, is to keep namespace flat but use a prefix to avoid collisions Prefixes hurt my eyes. No please (the traditional thing is to do something like underscore as prefix, not some further camelCase, but I agree that is somewhat less desirable) It might be pre-emptive as that hasn't been an issue, and even as we add more properties, it's easy to avoid collisions. Also unlikely to hit those collisions as well. Just validate the component prototype and throw errors. A component is likely to try todefine config as the other names. Perhaps if we can batch it with other breaking changes in the future. yeah I think `config` is maybe not the best choice, but something like `meta`, `spec` / `specification`, `properties`, `definition` would be much less likely to clash (and much more obvious a problem if it happened) 

or something more readable like `is` or `has` It's hard to come up with a useful word that means "everything about the component that isn't a method". I was suggesting omitting at least `schema` from the `config`, because it feels conceptually different from primitive configuration values anyway (and something like `tickPriority` does really feel like configuration). I don't think finding a more ambiguous word is helpful ‚Äî if there are meaningful ways to group properties let's do if; if not, I don't think this is a pressing issue yet. 

For reference, here are Polymer's top-level properties: https://www.polymer-project.org/2.0/docs/api/#function-Polymer.Class although it's not arguably better than just a `config` object namespace (which is what I'd suggest, in line with what most folks are as well) ‚Äì just for the sake of evaluating other options, what about accepting a third argument for the config object?

```js
AFRAME.registerComponent('my-component', {
 init: function () { ... },
 update: function () {...},
 tick: function () { ... }
}, {
  dependencies: { ... },
  schema: { ... }
});
```

if there are three arguments, use this format. if there are only two arguments, go with what @dmarcos said and continue to allow that format to work and print a `console` deprecation warning, keeping things backwards compatible until the release of the first A-Frame major version (`1.0.0`).
  Thanks! Not often we get a contribution in those parts of the code  red > green good patch! üôè Looks like some intermittent failures with ff   Thanks!  Yeah, didn't really expect that to work. You can file at https://github.com/aframevr/aframe-inspector Oops, browser inspector. System update is not implemented, right? I think this is the same as https://github.com/aframevr/aframe/issues/2612.  **Description:**

Make the path relative to the GitHub root. For example, at top of every doc page:

```
title: laser-controls
type: components
layout: docs
parent_section: components
source: src/components/laser-controls.js
---
```

I will configure the aframe-site repo to build the URLs depending on the version of the documentation being viewed and show a View Source button.

For example, built URLs:

- **master:** https://github.com/aframevr/aframe/blob/master/src/components/cursor.js
- **0.5.0:** https://github.com/aframevr/aframe/tree/v0.5.0/src/components/cursor.js
- **0.4.0:** https://github.com/aframevr/aframe/tree/v0.4.0/src/components/cursor.js

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Sorry this was finished   Thank you!  Thanks! This PR does not look right. Can you make sure you branch of an up to date master branch? Only the commits you are adding should appear in the diff  Yeah, duping with that. I'll put an update in that issue.  **Description:**

Previous attempt at https://github.com/aframevr/aframe/pull/2726

There was previously logic at the Entity level for updates to merge the existing properties into the new data set. That logic was removed since more data-building logic now lives in the component. But there was no logic to merge the existing properties when it came to the cached `attrValue`.

In the future, I think it might be nice to rename that to `rawData`.

**Changes proposed:**
- When updating `this.attrValue`, merge in the previous data if not clobbering.
 Good stuff!  Yeah, perhaps, want to try to remove it?  You should submit a PR from the latest master and only including the commit or commits with the proposed changes. As It is we cannot see what changes you're trying to make This is still from the wrong branch. You need to submit to master branch not docs-v0.5.0  Wrong branch. Make a PR to the master branch,  Should be filed on https://github.com/aframevr/aframe-inspector, but yeah HTML export is buggy  This is explained in the FAQ https://aframe.io/docs/0.5.0/introduction/faq.html#can-i-render-youtube-videos-as-a-texture  Thanks for submitting. This should be a separate component outside of the core. It handles position so it wouldn't have been good for look-controls anyways which handles rotation. wasd-controls handles position, so your component could be used alongside that. `<a-entity camera look-controls wasd-controls pinch-controls>`. I hope it's fine to close; in the future, you can file an issue beforehand so we don't waste your time :)  Thanks!  ```
<a-entity>
  <a-animation></a-animation>
  <a-camera></a-camera>
</a-entity>
```

Again, Kumaresh. Please ask on Stack Overflow, provide code to show that you tried, and show what you tried.  This was filed a couple days ago. Closed with solution at https://github.com/aframevr/aframe/issues/2708 It's expensive. Better to call the refresh method on demand rather than hacking in mutation observers and running selector refreshes 90 times per second. If you really want to do it, you can create a component that force refreshes the raycaster on your desired interval.  When the ` gearvr-controls` component is used and tested on actual hardware, the controller model rotates around a point in space outside the models geometry. I haven't tested with another model yet to determine if it's an issue with the GearVR controller model itself or if it's an a-frame bug or polyfill issue.

- A-Frame Version: master (70875d8fef84ac754b465d506dfe64ad62e68f29)
- Platform / Device: Samsung Galaxy S7 Edge / GearVR 2017 Controller / Oculus Internet Browser
- Reproducible Code Snippet or URL: https://hazardu5.github.io/aframe-workshop/examples/19/finish > the controller model rotates around a point in space outside the models geometry.

Since the Gear VR Controller is 3DOF, its positional information is approximated using a simplistic arm model, which you can see at https://github.com/aframevr/aframe/blob/master/src/components/tracked-controls.js.  By specific request during PR discussion, the parameters of the arm model were removed from the component schema, so unfortunately it is not as easy as one would like to tweak or turn off. @HAZARDU5 so I believe the behavior you are describing is the correct functionality of the arm model for 3DOF and not a bug.  Are you making a request to make the arm model parameters accessible (or capability to turn off the arm model) ?  If so, we should probably change the issue title. Yeah I guess so - could we expose the arm model parameters? @dmarcos thoughts re: exposing controls for 3DOF arm model?  goes back to prior PR discussions a bit, I know you and @ngokevin preferred keeping private, but unless they will be maintained as part of core, may be better to open up or perhaps componentize Customizing the arm model could be useful in instances where you want the controller's gyro sensors to directly control an object in a scene and have the controller rotate around a point at 0,0,0 inside the model. E.g. I use the laser pointer to take a model toy off a shelf then it switches to a zoomed in view of the model that follows the camera and allows the toy to follow the rotation of the controller 1:1. Or for another example, the user can rotate the controller to tilt a labyrinth style maze where a ball, affected by physics, must be guided to the end of the maze. It'd be great to be able to do this without having to do some serious hacks to correct for the arm model offsets during transformations.  Hi @richardanaya ‚Äî Do you have a particular workflow in mind, for bringing PBR materials in from Substance Designer? We could certainly add support for `material.roughnessMap` and `material.metalnessMap`, but I'm not sure that specifying 3-4 textures in your HTML is the ideal workflow. Also note that the `material` component doesn't necessarily work with external models; it's most often used with primitives like cubes and spheres.

If the final goal is to be able to import a model coming from Blender/C4D/Maya along with textures created in Substance Suite, I think the best option would be to export into a single format that already supports PBR. The current version of `gltf-model` does not yet, but when the glTF 2.0 spec is ready you will be able to use that. Here are some examples: https://github.com/cx20/gltf-test/tree/2.0#pbr-models

Specifically, from Substance Painter, you would export textures with the Unreal Engine 4 Occlusion-Roughness-Metallic preset, using OpenGL (not DirectX) settings.  @richardanaya Is there any easy to use tool out there to create those roughness / metalness maps without being a skilled artist? I would like to play with one and see if I can get something pretty. I guess there's also value on reuse maps created by real skilled artist like yourself right? It would be nice, and we're already currently supporting some of the other types of maps. But they don't get much usage, there's not much of an audience. For someone that is new enough to be relying on basic shapes, but is knowledgable enough to know about or how to use roughness or metalness maps.

> Having roughnessMap and metalnessMap could allow seamless PBR textures for less skilled artists.

So I say this is sort of an assumption that people would pick it up versus using like glTF. Something we *could* do, but whether we *should*? I haven't seen much demand. I wanted it before, but Don convinced me they're more advanced features that people would rather just create your own three.js material or use loaders. Thoughts? > I agree that building with primitives is a good start as a gateway to working with Blender and more sophisticated modelling tools.... Some things that are missing from aframe that are useful in SL are things like path cut, hollow, twist, and shear.

I do understand the challenge of getting started with 3D modeling software, but A-Frame is not intended to be a gateway to Blender. Declarative HTML is great for composing a scene, and adding interactivity, but polygon-based modeling is a whole different ballgame.. Better to have realtime interactivity for that, not an edit/refresh cycle. Even three.js doesn't attempt to support that, and there are libraries built on top of three.js to handle simple things like boolean operations. I would be happy to discuss this further in another thread, if someone would like to open one... my opinion at present is that tools like MagicaVoxel, Paint3D, or Tilt Brush are better stepping stones to 3D modeling.

Someone could _use_ A-Frame to build something like A-Painter, except for 3D geometry, and that would be awesome. Or, similarly, a tool that lets you drag-and-drop a model and some textures, and have it baked into a `glTF`. But those should be layers on top of A-Frame, not built in.

***

> I wanted it before, but Don convinced me they're more advanced features that people would rather just create your own three.js material or use loaders. Thoughts?

I'd be OK with adding `roughnessMap` and `metalnessMap` as described here... There are other maps on the `material` component, so it doesn't really introduce any new code paths or new concepts for users to understand. But I do still think (in reference to the earlier issue we discussed) that exposing settings on the textures themselves (e.g. `material.metalnessMap.wrapS`) is pretty advanced and doesn't make much sense with primitives.

These two proposed maps are no less common than `ambientOcclusionMap`. They're probably more common, actually? So my vote would be to go ahead and include them, even though they won't be used heavily. Substance B2M looks like it could give some interesting results with these maps.
 Hmm I'm having second thoughts. To add some context from #2721, apparently `ambientOcclusionMap` never worked to begin with, and was never reported as a bug.

> Even though i'm artist who's capable of using blender3d and exporting fancy models with fancy maps, a more simpler VR artist may only know how to use primitives and seamless repeatable textures. Having roughnessMap and metalnessMap could allow seamless PBR textures for less skilled artists to create powerful materials on simple objects.

@richardanaya could you give a concrete example of what a new artist might do with "powerful materials on simple objects"? Ideally including a seamless PBR texture we can try out? I'm not opposed to supporting this, but having a hard time convincing myself that people would use it. Thanks for the detailed response ‚Äî Concretely though, what sort of a scene could I make with this technique? Can you provide a seamless texture that looks OK on primitive shapes?

For example, something like this:

```html
<a-box material="src: ...;
                 normalMap: ...;
                 metalnessMap: ...;
                 roughnessMap: ...;"></a-box>
```

![screen shot 2017-06-03 at 8 27 53 pm](https://cloud.githubusercontent.com/assets/1848368/26758744/15d02360-489c-11e7-8970-b10cd64b4c14.png)

I can't think of a real scene where you would want this level of detail on boxes and spheres, without also caring about UVs.

With (4) you are referring to artists who can model, and we need to clarify that the `material` component does not work well at all with arbitrary models. Only boxes, spheres, and the other primitive shapes. So we're talking about users who have paid Allegorithmic subscriptions, but who can't make a cube in Blender, assign textures to it, and export? This seems like a rare creature. üôÉ  @CarlBateman The case you're describing is adding maps to a 3D model, and the `material` component can't modify 3D models at all, except for OBJs that don't have a material already. So even if we added metal/rough texture support, it wouldn't solve that problem for you. The `material` component is typically used for adding materials to primitive objects, and metal/rough maps on cubes and spheres is just not a very common need.

> My 3D artist works with Maya which, apparently, can't export shiny, and converting to glTF is not an option (their preferred format is fbx, which is proving to be a nightmare).

Why is converting not an option? I understand that client requirements can be tricky and out of your control, but this is similar to saying "my artist works in Photoshop and exporting to .JPG is not an option, so we must embed .PSD files in our website." If tools like [FBX2glTF](https://github.com/facebookincubator/FBX2glTF) are just not working for your models that's a valid issue of course.

EDIT: For the case of shiny materials, Maya's Stingray PBS materials can be converted to glTF metal/rough using FBX2glTF. The author of the converter is quite responsive to bugs, if that's not working for you.

> In time, glTF will likely be widely supported, but unfortunately that's not the case now. Shouldn't A-Frame try to support existing formats and properties as well as possible to minimise friction with the limited tools we have available to us?

In my opinion, the cost of supporting FBX is astronomical. THREE.FBXLoader has been around for years and is still unreliable, despite having extremely capable people maintaining it. I'd much rather invest in tools for converting FBX to web-friendly formats, using Autodesk's SDKs. I secretly want to default A-Frame to `lambert` or `phong`. `MeshStandardMaterial` is overkill and no one ever uses its features, and it's not really meant to be configured by hand (more as an export material). Switch to `lambert` for improved performance across the board and developers that need standard just create a simple component. > Yes, fbx is a nightmare, but that's what I was given initially. Now, we're using obj.

Ok, yeah OBJ has limited features but is reliable enough. That's a valid situation for the metal/rough params with `material`, I expect we will be supporting OBJ indefinitely.

FWIW I just did a quick test with Maya LT, FBX2glTF, and a Stingray PBS material ‚Äî worked surprisingly smoothly: 

<img width="743" alt="screen shot 2017-12-16 at 4 03 59 pm" src="https://user-images.githubusercontent.com/1848368/34075455-6b45c672-e27c-11e7-9d69-0dba5b853ad5.png">

> Is it THAT easy to write a component for MeshStandardMaterial?

If the default were changed, you'd be able to opt back into standard with `material="shader: standard; src: ...;"`. No new component needed. >  Is it THAT easy to write a component for MeshStandardMaterial?

Yeah. You would want to do it anyways since the current standard material doesn't support every parameter, which you'd need to make it seem actually PBR. If you're not using env maps or all the params, then PBR is pointless. Don't have to make it agnostic either:

```js
AFRAME.registerComponent('my-crate-material', {
  dependencies: ['geometry'],

  init: function () {
    this.el.getObject3D('mesh').material = new THREE.MeshStandardMaterial({
      // Add your parameters.
    });
  }
});
```

When I build apps, I often don't use the default materials. I optimize it so my app only has a few materials with spritemapped textures. Something like this:

<img width="711" alt="screen shot 2017-12-16 at 5 14 23 pm" src="https://user-images.githubusercontent.com/1848368/34075735-ade17d52-e284-11e7-9f06-0261d69aaf8b.png">

Haven't got a shiny metal around but I think the key thing there is to include an environment map as @ngokevin said. Can't include `envMap` with OBJ or glTF inside the file, so it would need to be added in JS. Test with https://gltf-viewer.donmccurdy.com/ to get a preview that includes envMap automatically.

Substance Painter can also export glTF these days, that might be a viable way to stitch your OBJ files and PBR textures together into a glTF. I proposed phong to become the default because the vast majority of developers do not use PBR features. Phong becoming default doesn't stop anyone from using standard, it's a few lines of code to whip up a material component that does what you need. It's in your best interest given the current standard is half-baked anyways. That's the foundation of A-Frame is you don't need permission to add a feature you need.
 
We try to be constructive and offer solutions. We don't consider only two types of users. In fact the opposite. We interface with thousands of developers and have examined hundreds of applications and are aware of general needs. Phong looks worse. Many people expressed in the past how pleasent looks a-frame by default. All modern engines and pipelines are moving to PBR. Better to get aligned with the rest of the industry sooner than later. For better or worse I don't think Phong would improve performance in a meaningful way, it's not that different from MeshStandardMaterial really. Lambert or unlit would, but they're less appropriate as defaults.

The recommendation of glTF has clear technical reasons, beyond "flavor of the month" status. OBJ and COLLADA do not support PBR at all. FBX technically does, but that isn't well defined, and is unreliable as a runtime format in ways that I never expect to see fixed.

I would be OK with reopening #2722 for the purpose of adding metal/rough to OBJ files via the `material` component, which might make some beginner-friendly workflows a bit easier. This would also allow metal/rough use on primitives although I don't recommend doing that in practice.  Refreshing the objects involved query selector and processing through the objects. If you want to refresh the raycaster for corner cases such as these, you can call el.components.raycaster.refreshObjects on demand I think the raycaster filters out objects with material.visible = false by default  Thanks for filing. I'd rather this be maintained outside since it benefits a smaller number of users but adds more maintenance to the project. A-Frame's API is also primarily through the DOM and already has a type system with component schemas so the benefit seems minimal. > A-Frame's API is also primarily through the DOM and already has a type system with component schemas so the benefit seems minimal.

I think the point is less that A-Frame's API especially needs a type system, and more that A-Frame users may want to use TypeScript in their own applications (for whatever reason), and doing so is extremely painful if your dependencies do not have correct typings. For example, the BabylonJS ecosystem is TS, and it would be nice to accommodate those users coming from that background.

For the question of whether those typings should be in A-Frame's repo or not:

1) If typings were in the repo, how are they served? Is there an entry in `package.json` like `"typings": "typings.d.ts"` or something? Or are they bundled into the build explicitly?
2) By adding typings to the repo, do we get any advantage for maintaining them? Specifically, could typings be generated from our JSDoc automatically?

If the `.d.ts` file will have to be updated by hand regardless, then I think it would be better to maintain it outside of this repo ‚Äî none of us are using TS here, and it's likely to go stale. If we can automate the typings here in a way that wouldn't be possible in another repo, I'm open to that. I'm in favor to keep it separate as well, keep an eye on adoption and reevaluate in the future. I don't know much about TypeScript but for those that want to develop their own components, is there space for a`ts-aframe-boilerplate`? That bundles the `t.ds` for you with your components? Is there anything actionable in this issue? Can we close / archive? Thanks for giving a Typescript perspective using a-frame.  Going to close for now. Thanks!  Thanks. I made a Glitch https://glitch.com/~abrasive-orchid for this I don't get issues with 1000 `<a-plane>`s on my laptop or desktop. Can you check the Glitch and see if you reproduce or see what needs to be changed?  **Description:**

Wait for `controllerconnected` event and check the `evt.detail.name` matches `vive-controls` or `oculus-touch-controls`.

I think we can wait until `controllerconnected` to start the XHR for the hand-model OBJ/MTL. I would strongly suggest that in the data schema there should be an array of strings that are component names to both attach initially and respond to upon controller connected, that defaults to whatever you like (here, vive-controls and oculus-touch-controls) @jselmani good catch! yes, this should be fixed in 0.7.0  Thanks! This looks fantastic. I just want to spend some time doing QA and making sure we're not missing anything. Looks good to me. Thank you everybody! I keep our fork around for reference for a little bit but the goal is to decommission as soon as we make sure everything works. If anyone wants to help test/QA a bit, you can do so using https://a-frobot.github.io/aframe/examples/ which now has this PR @ngokevin: here you go, did quite a bit of testing and created this [spreadsheet](https://docs.google.com/spreadsheets/d/1oZdSMQ4SmmUJdfYccE2MP2fgKMe95fYhVKYS78326zk/pubhtml) ([editable version here](https://docs.google.com/spreadsheets/d/1oZdSMQ4SmmUJdfYccE2MP2fgKMe95fYhVKYS78326zk/edit))
  We would love to help. Could you also provide an English version? I translated this in Google translate and it seems it's a request to have docs in Chinese. @ngokevin Who do we know in the Chinese community that could help? We know a lot in Taiwan. 

@besteric from Ali translated some of the A-Frame site to Chinese a while back, but there's work involved on how to host that. If we also have docs in Japanese, I'll help. There's some at http://www.a-framer.com/. I'll look into it after the 0.6.0 release. Moving to https://github.com/aframevr/aframe-site/issues/380  @AngelFQC Can I ask you to click through the three.js examples and see if you see any crashes (https://threejs.org/examples/)? I would like to discard that it's not a problem with the particular GPU / drivers that your phone has. @AngelFQC what about no WebVR exampless? Can you click trough all of them and see if there's any crashes? I would like to see if the are any WebGL incompatibilites with your phone regardless of WebVR.  Chromium is actively being looked at https://github.com/googlevr/webvr-polyfill/pull/267 and we're actively testing browsers... thanks for being patient. @stevel4857 Can you provide browser / links to demos you're trying? aframe.io works for me on Vive and Oculus / Windows 10 / Nightly. This issue is about Firefox for Android. Are you also testing on it? @stevel4857 you may be having the nvidia driver issue I had - roll back to 378.92 I'm on 381.78 drivers and everything works for me (GTX 1080 / Windows 10 / Vive / Nightly)   I think GLTF2Loader will be ready for A-Frame v0.7.0, but I'm not sure COLLADA2GLTF and the Blender exporter will be updated to glTF2.0 quickly enough. We may not want to bump `gltf-model` until the workflows are stabilized. There is also a tool for upgrading glTF1.0 assets to glTF2.0, so if that's reliable then maybe we don't have to wait on other stuff. We could also have both `gltf-model` and `gltf2-model`, but since three.js is planning to drop GLTFLoader eventually, I think that makes less sense.

For now, I have a `gltf-model-next` component in aframe-extras. glTF 2.0 has been released!
https://www.khronos.org/news/press/khronos-releases-gltf-2.0-specification Yay!

I think my vote would be:

- Plan to upgrade to three.js r85 for A-Frame 0.7.0.
- Update `gltf-model` from GLTFLoader to GLTF2Loader then, without renaming the component.

Waiting for 0.7.0 also buys some time for the tooling, since COLLADA2GLTF updates haven't been merged yet.
 And one more thing.
Make sure to use the latest Blender glTF exporter version.
Recently it's fixed a skinning bug. Quick recap of my thoughts on timing here:

1. THREE.GLTF2Loader is stable already, available in three.js r85 and r86.
2. If we swap GLTF2Loader for GLTFLoader under the hood in `gltf-model`, that will be a breaking change. glTF1.0 models will no longer be compatible. Is that OK? Shall I just create a `gltf-model-legacy` component in aframe-extras, similar to the `gltf-model-next` component I'm maintaining now?
3. glTF blender exporter supports glTF 2.0, COLLADA2GLTF does not yet. I'm hopeful that COLLADA2GLTF can be ready by the time a-frame 0.7.0 would be released.
4. Does upgrading to r85 or r86 mean we need to migrate from VREffect to ArrayCamera (or something)?

tl;dr my vote is to add glTF2.0 in A-Frame 0.7.0, IFF there is not some blocking issue related to VREffect deprecation in new versions of three.js.
 I forget which version of three.js removes the VREffect, but just doing a straight upgrade to GLTF2 for 0.7.0 and having a legacy one somewhere sounds good to me. re ArrayCamera was introduced in r85 but is still not ready for production as, for example, we don't have frustum culling working properly, hopefully that would be solved on r87.
+1 for upgrading to gltf2 and leave v1 as legacy. So if we upgrade to r86 now, we can continue using VREffect as usual? @donmccurdy I think so.  If `renderer.vrEnabled === false` everything should behave as it does now. I think so too, but we need to do some testing because the `WebVRManager` was introduced on the renderer itself and many things rely on that, like setting the viewport, calling rAF, so I don't know if it could have side effects if using vreffect  fixed  Support questions should go to http://stackoverflow.com/questions/tagged/aframe and please provide more information

https://aframe.io/docs/0.5.0/introduction/faq.html#why-does-my-video-not-play-on-mobile  Support questions should be asked at http://stackoverflow.com/questions/tagged/aframe, you will need to provide even more information (screenshots, the images) that what was filed here in order for us to help.  dupe https://github.com/aframevr/aframe/issues/2675  Will work with animation component, perhaps better to mention `<a-animation>` or put it in the animation docs, but will just pull in for now. Thanks!  Thanks!  `daydream-controls` doesn't work:
```html
<a-entity daydream-controls>
```

Looks like `isControllerPresent()` is returning false in `tracked-controls.js`

Daydream controller is confirmed to be working on webvr.info/samples

This happens with both Chrome Canary and regular Chrome.   I think this _may_ have been due to the controller update I received last week since nothing in the controls seems to have changed.

- A-Frame Version: Master
- Platform / Device: Android Daydream running Chrome and Canary
- Reproducible Code Snippet or URL:

Viewable example:
https://iridescent-team.glitch.me

Edit here:
glitch.com/edit/#!/join/6963d888-4dfa-4b51-93ce-ba100c9fb78b

cc @machenmusik @cvan for a look-see. Cool, will also check it out. I wonder if the Gamepad ID changed. Does `navigator.getGamepads()` return anything when presenting? If it does what is the `id` of the gamepad returned? We're expecting `Daydream Controller`. Has that changed in Chrome / Canary?  The webvr.info examples don't filter by id but take whatever first gameapd they encountered. If I have to bet Chrome just changed the `id` string and we just have to update it here: https://github.com/aframevr/aframe/blob/master/src/components/daydream-controls.js#L10
 mmmh... `navigator.getGamepads()` should return something ![image](https://cloud.githubusercontent.com/assets/1560884/26261998/1b9f6780-3c88-11e7-91bf-eae586afd4f6.png)
 It appears that `controller.pose` isn't returning anything.  Also cloned down the examples on webvr.info/samples and those don't work either.  Only seems to work on the webvr.info/samples site. @caseyyee is that an `origin-trials` side effect? Maybe you have to go and enable webvr on `chrome://flags/`? Yeah, don't know.  I've also been using https to make sure that's a non issue as well. OK interesting.  If I let it sit for a while, it will start to work.  Not sure why there is a delay.  Definetly some kind of weird inconsistency.    > OK interesting. If I let it sit for a while, it will start to work. Not sure why there is a delay. Definetly some kind of weird inconsistency.

Order does matter. I'm not sure how things are staggered, but this is the explicit order: query for `VRDisplay`s (or `VRDisplay`events), and then query for `Gamepad`s:

```js
let gamepad = null;
navigator.getVRDisplays().then(displays => {
  let gamepad = navigator.getGamepads()[0];
});
window.addEventListener('vrdisplaypresentchange', () => {
  gamepad = navigator.getGamepads()[0];
});
```

Let me know if that works. If truly required, this explicit order is a little troubling, since it is perfectly reasonable for an experience to provide gamepad functionality outside VR, as well as inside  > If truly required, this explicit order is a little troubling, since it is perfectly reasonable for an experience to provide gamepad functionality outside VR, as well as inside 

I 100% agree. I'd look at these spec issues: w3c/webvr#184 and w3c/webvr#30 (and its follow-up issue: w3c/webvr#194). Feel free to chime in as well; developer ergonomics are important to address in these specs before these APIs' implementations ship to users.
 Should try to fix for 0.6.0 yes?  If the timing issue is indeed the culprit, then do we need to ensure that getVRDisplays has returned before we allow the tracked-controls system to actually call getGamepads?  If so, is there any reliable way to tell whether that has been done (e.g. scene property) ? See latest comments from me on #2769, am not seeing errors mentioned Hey there, as an extra data point.

Here's my tests and what I saw with the Pixel XL this morning:

https://codepen.io/machenmusik/pen/YQGrWQ
https://iridescent-team.glitch.me/
https://threejs.org/examples/?q=day#webvr_daydream

For all examples:

Does't work with standard Chrome. No controller at all.
Controller only works after interacting or letting it sit for some time (consistent with testing per Issue 2677) before becoming active with both Canary and Beta. > Does't work with standard Chrome. No controller at all.

do you have an origin trials tag on any of those that would enable native WebVR via Daydream?
Codepen is a no.  Frankly, mine are probably expired and I need to update them.
Glitch is probably a no.
Not sure about three.js...

Do you have the flag thrown manually on Canary and Beta?
If you manually set the flag on standard Chrome, does it suddenly start behaving the same?
 anyone able to answer questions above in https://github.com/aframevr/aframe/issues/2677#issuecomment-303395005?
 > Controller only works after interacting or letting it sit for some time (consistent with testing per Issue 2677) before becoming active with both Canary and Beta.

I thought that interacting was supposed to be required, for security/privacy purposes.  The fact that "letting it sit for some time" works surprises me, maybe that's the race condition mentioned above
 @dmarcos should this be closed like https://github.com/aframevr/aframe/issues/2769#issuecomment-308577969 ? Closing this because for the reasons explained here:

https://github.com/aframevr/aframe/issues/2769#issuecomment-308577969 (not closed yet?)  Thanks and congrats for the first contribution!   `text="align: center"`

Also https://github.com/mayognaise/aframe-html-shader/pull/12 is an option for rendering HTML/CSS as a texture. Slightly expensive to compute, but perhaps cheaper than pulling in and rendering glyphs? I suppose `text.padding` wouldn't be too bad. The text auto width was intended to size the text width to the geometry, not the geometry to the text width - you can't automatically size both height and width, you need to pick something as a FRAME of reference.  Is it a more common case to want arbitrary width based upon fixed height, rather than arbitrary height (including line wrap) based upon fixed width?  If so, perhaps we should add some switches for that (whether it's padding, or something else)  There are a failing tests we have look at  I believe this should be filed against the inspector not aframe. @fernandojsg Moved to https://github.com/aframevr/aframe-inspector/issues/475  The camera doesn't handle any of that logic. `active` just refers to the user's camera, but a camera can be inactive but still controlled. You can `.removeAttribute('look-controls')` temporarily.  Can you point to an example that reproduces the issue? Thanks @darioodiaz can you provide more information on the specific model of phone that exhibits the problem?  my suspicion is that it does not support a OpenGLES extension the default font's text shader is using.  Can you also try one or more of the non-default stock fonts like kelsonsans? of specific interest: `GL_OES_standard_derivatives` Any errors on console like in the lines of `extension XXX not supported`? If there is a good way to determine whether the shader should use highp or mediump this might be straightforward to fix, but I don't have anything to test it with  yes, there is actually a PR to aframe polyfill to fix this already, but perhaps it hasn't been merged into the version you are using.  @dmarcos do you recall where this stands? looks like this isn't merged / used yet
https://github.com/aframevr/webvr-polyfill/pull/4

the specific change is
https://github.com/chenzlabs/webvr-polyfill/commit/87130ae1ffb8d5c33fe78dc10ea4a0da279eb173

which should be built into
`chenzlabs/webvr-polyfill#avoid-touchstart-collision`


 so the odd part is that it had fixed it at least at one point, but clearly it won't now.  would you like to submit your change as separate PR, and I can close that one? LOL I closed googlevr/webvr-polyfill#229 in favor of yours, but I left mine in aframevr/webvr-polyfill for now just in case you didn't base yours on the commit at which aframevr and googlevr diverged (and thus you might run into the problem I did with dragging in other changes unintentionally) @gordonbrander if you can submit that to aframevr as well, and it doesn't drag in a bunch of other changes from googlevr, let me know and I will close mine @gordonbrander just rebase yours on this commit and you'll be all set

https://github.com/googlevr/webvr-polyfill/commit/4787fe5546e33bb82b9a3981245f39d9e1e136ba ok, closing my aframevr polyfill PR as well so you can do yours, thanks welcome aboard @gordonbrander ! The issue stems from how `tracked-controls` handles events.  daydream-controller doesn't use `tracked-controls` but instead runs its own copy of that functionality.  @dmarcos @ngokevin perhaps we should change the internal event names to avoid collision, at the risk of breaking some existing usage? @machenmusik what collision are you talking about? I cannot tell by the previous conversation. IIRC `tracked-controls` emits events named `touchstart` and `touchend` that clash with the actual mobile events, and mobile Chrome does not appear to allow CustomEvent to set the `touched` array which lies outside event detail. Seems like fixed in polyfill.  thanks for the interest. if you're referring to HLS video streaming (which iOS uses), see PR #2597. if you're referring to just normal video streaming, browsers handle that fine as is. if you're referring to DASH video support? that can be easily supported in WebGL/three.js, but nobody has written a third-party A-Frame component for it yet, but one could be easily written to support DASH video streaming.

btw, so future people can find the answers to questions easier, you can post your questions to [Stack Overflow, tagged as `#aframe`](https://stackoverflow.com/questions/tagged/aframe). (tehre are a ton of folks to chat with on the [`aframevr` Slack](https://aframevr-slack.herokuapp.com), if you have [questions](https://aframevr.slack.com/messages/questions) or just want to chat.) I think what you want is `navigator.getUserMedia` + WebRTC.

1. Go to https://gurivr.com/, and click on the "Augmented Reality" demo
2. Check out the `aframe-passthrough` component [demo](https://flysonic10.github.io/aframe-passthrough/basic/) ([source](https://github.com/flysonic10/aframe-passthrough))
3. Check out [this demo](https://s3.amazonaws.com/cassell-webvr/webvr-soccer-stadium-multiplex/index.html) of multiple video planes in a playing Soccer Stadium

Let me know it these links help. I'd be glad to help and point you in the right direction - if you can just provide me with a URL to a test case/example and/or the video assets you know you'll need. Thanks!
 what needs to be done is to get what you want playing as a video element, then you can reference that video element by selector for A-Frame to use it.  I believe @jesstelford had a component a while back that may serve as an easy to use example >  what needs to be done is to get what you want playing as a video element, then you can reference that video element by selector for A-Frame to use it. I believe @jesstelford had a component a while back that may serve as an easy to use example

ah, you mean his [`aframe-video-billboard` component](https://github.com/jesstelford/aframe-video-billboard)? [here's a demo.](https://jesstelford.github.io/aframe-video-billboard/switch-source/)

yeah, that completely slipped my mind; that's likely a good one to use üëç  We use issues for bugs and feature requests. As @cvan pointed out I encourage using StackOvervlow or our aframe Slack (https://aframe.io/community/) for questions   Yes, can you please re-file there? Thanks!  Hi! Posted a reply on the [other issue](https://github.com/donmccurdy/aframe-extras/issues/148). Going to close this issue out, since the `ply-model` component is only in aframe-extras.

Thanks,
Don  That distortion in the poles is an artifact of the consumer cameras used to capture 360 panoramas. Usually 2 fish-eye lenses on opposite sides that capture 180 degrees. The only way to fix that is using multi camera rigs that minimize distortion across the whole sphere. (e.g https://shop.gopro.com/virtualreality/omni---all-inclusive/MHDHX-006.html). There's nothing we can do on the aframe side. which versions/commits do we see this problem with?  0.5.0?  latest master? Can you share a link to a working demo that reproduces the problem? The distortion at the poles is a common effect of equirectangular projected 360 images. There's less information per pixel. You can see how any 360 photo on flicker you display also presents the same issues:

https://www.flickr.com/groups/360degrees/pool/ I see what you mean about distortion

but I don't recall this happening in prior versions, wondering if it is dimensions distortion (effectively clipping the picture which is bad for equirect) or insufficient sphere tesselation

it is certainly possible to deal with entirely in shader (compute texture coordinates based on observed long/lat regardless of shape) which is probably along the lines of Pannellum suggestion above.

will try to find some time to take a closer look
 so far, looks like the default geometry settings for sphere used by a-sky have insufficient detail and exhibit visible distortion... increasing detail mitigates

http://codepen.io/machenmusik/pen/PmQLyR @starwaver can you confirm that increasing detail of playback surface fixes for you? (see codepen)

@dmarcos should we consider increasing default detail? @starwaver do you have a CORS-friendly URL of an example image to do in a codepen? @starwaver so it turns out that for your codepen, the problem is this: whereas videos automatically set the non-power of two flag, apparently images don't, and so you get distortion from the resampling the browser does.  the magic missing piece is `material="npot:true"`

http://codepen.io/machenmusik/pen/wdmjQb

so there are two pieces to this: 
(1) default geometry for a-sky and a-videosphere are not high enough to avoid easily visible distortion at poles -- fix is to increase segmentsWidth and/or segmentsHeight
(2) support for non-power-of-two textures is only enabled by default for video, so other asset types may experience distortion due to resampling

@dmarcos @ngokevin @cvan can one of you please reopen this issue? and would you agree that the stock values in core should probably be adjusted to compensate?
 @machenmusik I'm ok with increasing the sphere segments. 
People should be submitting power of two textures. Not sure if that should be enabled. yes most distortion for images is npot / resampling / mipmap, i think -- there are more fidelity gains to be had by slightly more detailed sphere, but rapidly diminishing tradeoffs beyond 64 segments, IMO thanks @cvan for reopening!
@dmarcos unless one of you gets to it first, I will do a PR that enables npot by default for images, and maybe bumps up segments for default spheres (will need to do a little testing to see what works best) > People should be submitting power of two textures.

The reality is that requiring power of two almost never really works in practice, as very very few devices have native power of two capture resolutions, and the quality loss from resampling is demonstrably worse than mipmap / interpolation compromises... thus this issue exists :-) @bryik yup, now I remember why I did a PR for that parameter! ;-) I think what is happening is that `npot:true` also disables mipmap (which is another potential source of resampling which ends up looking like distortion at poles) looks MUCH better now, I think we can close this? 
http://codepen.io/machenmusik/pen/ZKoWLe
http://codepen.io/machenmusik/pen/pPVyNE (@starwaver now we can see the underlying stitch errors from your camera rig that @dmarcos meant originally)  @shaunmnemonic Please reoopen if you can reproduce on master   so unless i misunderstand, this will attempt to fix a mobile issue with autoplay by forcing play on first click, but without really understanding that the video should be playing so may actually start videos that should remain paused? also the fix does not appear to be constrained to apply only to mobile / cases known to require it... is that safe? btw, after I get this one out of the way, I have one final PR: a patch (client-side only too) that fixes the cross-origin video playback issues on iOS (e.g., for videos hosted on CDN) üéâ @machenmusik: I know you've been dabbling in that realm quite a bit.
 ok, just made these two changes (weren't exactly necessary, but figured it'd clean things up):

* https://github.com/aframevr/aframe/pull/2657/files#diff-565a65bb6612d5571efb7439e5423720R183
* https://github.com/aframevr/aframe/pull/2657/files#diff-565a65bb6612d5571efb7439e5423720R148

tested on Android and iOS, and all appears good should probably test on rift/vive with a video that shouldn't autoplay to ensure do no harm.
maybe fire an event or two so "tap to play" ux can be displayed/dismissed? apologies that I am not currently in a position to test on iOS (had borrowed a device but returned it) > maybe fire an event or two so "tap to play" ux can be displayed/dismissed?

I'm just handling `autoplay`, yeah. I don't want to add video controls for non-autoplay video; that would make too many assumptions about the content IMO. and, FWIW, desktop already doesn't have video controls/toggles. [this component](https://github.com/oscarmarinmiro/aframe-video-controls) I think is a good place to start (until browsers start shipping with their own consistent video 360¬∞ controls). right, I didn't mean actually implementing any UX for it in core, just the events that would be needed to do so (since otherwise it's kinda cryptic, and if you actually have to present UX without the events in core, you have to do yourself anyway, negating the benefits in moving handling into core).  I basically do this now at higher level (when you call play, set a timeout to check if it actually did anything, if not present some ux and attach self-removing handler) @machenmusik Thanks, that I agree with. I had a long response, but it got lost in my tabs. Basically it was to the effect of this:

Chrome for Android and Safari on iOS & desktop have the same initial requirements now: `<video autoplay>` with an audio source or `videoEl.muted === false` require an initial user-gesture requirement for playback.

That's my only intention of addressing in this PR (and in a follow-up PR: the [infamous CORS Safari bug](https://bugs.webkit.org/show_bug.cgi?id=135379)).

<hr>

The [`aframe-video-controls` A-Frame component](https://github.com/oscarmarinmiro/aframe-video-controls) is a good place to prototype what "controls" look like, beyond the obvious `<video autoplay>` case to handle.

FWIW, Samsung's got built-in 360¬∞ video controls (built proprietarily to start, to get something out the door). It looks like the next browser likely to ship 360¬∞ video controls (but this time as a "standards-compliant solution") is the Oculus Browser/WebVR team (in coordination with React VR); there will be no manual touch user-gesture requirement (`vrdisplayactivate` will just be triggered). And, I'm not aware of Google's status of adding support in Chrome, but it wouldn't be a stretch to imagine Google's working on 360¬∞ video controls now or in the near future. Lastly, I think I can speak for the folks at Mozilla when I say Firefox and Servo would like to add in-chrome  360¬∞ video controls, but it's currently not on our list of prioritized bugs (as of now).

Thanks for the feedback. Hope that answers some questions too. @dmarcos given my comment above, this look good to you? @cvan per conversation, does this emit an event when installing the tap/click to play handler?  standard html video events can be used to detect play, but maybe not installing the handler > @cvan per conversation, does this emit an event when installing the tap/click to play handler? standard html video events can be used to detect play, but maybe not installing the handler

not _installing_, but upon playing, yes. do you think there ought to be an event? and, if so, should it be emitted on the `<video>` element in `<a-assets>` _and_ fired on the `<a-entity>`? (if a video URL is provided instead of a `src` to `<video>`, A-Frame creates its own `<video>` behind the scene, so the event wouldn't be incredibly useful in that case.)

I can add an event. what are the use cases you're thinking for that? (besides just good measure?) The use case is literally to present some UX (say, head locked a-text "Tap/click to play") when the code added in this PR determines that it is required.  That UX should only be visible when said click handler is required to be installed (which my usual code at this point does isMobile() to help filter out, IIRC).  

If you're not going to constrain this behavior to mobile (or specific UA behavior as you detailed in comments) I do wonder if some testing/experimentation is needed in case non-mobile cases have a sufficient delay before playing that it looks like the not-going-to-play mobile case (e.g. if the video takes a long time to buffer initially). > The use case is literally to present some UX (say, head locked a-text "Tap/click to play") when the code added in this PR determines that it is required. That UX should only be visible when said click handler is required to be installed (which my usual code at this point does isMobile() to help filter out, IIRC).

I was thinking more to handle this with a poster 360¬∞ image/skybox (√† la `<video poster="example.png" src="example.mp4"></video>`): #1271

I'd like to get video playback to work first before adding a UI, as any defaults ‚Äì even if they're necessary ‚Äì can prove to be quite intrusive for users. IMO, it's best to start with no controls but get playback working out of the box, and then add controls shortly thereafter. It's harder to remove a UI (and it could complicate users' experiences if the UI changes a lot, `<video>` 360¬∞ controls get standardised, etc.) than it is to add a UI.

> If you're not going to constrain this behavior to mobile (or specific UA behavior as you detailed in comments) I do wonder if some testing/experimentation is needed in case non-mobile cases have a sufficient delay before playing that it looks like the not-going-to-play mobile case (e.g. if the video takes a long time to buffer initially).

In my follow-up PR for iOS, I do sniffing for Safari (for the WebKit CORS bug). This is a good point you bring up. At the very least, I think it'd probably make sense for me to sniff for Safari _or_ Chrome for Android; that would get `autoplay` video playback working for the majority of the use cases.

And with a `poster` image (#1271), as soon as a user clicks anywhere on the page (including clicking the `Enter VR` button), a 360¬∞ video would play. It's really great üëç

Thanks for the feedback; this helped a ton. I really appreciate it.
 re: poster, sometimes the ux that should be displayed for click-to-play is a property of the page/site and not the video, so maybe less tied to the poster that would normally be attached to the video.

I agree that we don't need to include ux here, but as we are modifying the usual event handling to do something smarter for click-to-play, I do think we should emit a click-to-play event on the A-Frame entity, or the scene as an alternative, as the A-Frame event handling markup doesn't understand the video element really.  Then authors can do whatever event handling for their UX with typical A-Frame semantics. I just tried this on an iphone 7 Plus and I cannot get the video to play. I loaded the `tests\videoshpere` example and video does not play when tapping on VR mode. Can anyone get the video to play? > I just tried this on an iphone 7 Plus and I cannot get the video to play. I loaded the `tests\videoshpere` example and video does not play when tapping on VR mode. Can anyone get the video to play?

if you copy a video file from the Uploadcare URLs and move them to the `examples/` directory, you can see it working.

if you use Safari on macOS to Remotely Debug your iPhone, you'll see the Console is littered with CORS errors. that's the "infamous CORS bug" I referred to in https://github.com/aframevr/aframe/pull/2657#issuecomment-300490769 and https://github.com/aframevr/aframe/pull/2657#issuecomment-300164119

I have a branch locally, the second PR of these mobile video issues, which addresses that - using a workaround trick with Blobs.

<hr>

we could have an `.mp4` video sample checked in to `examples/` directory of this repo. as long as we aren't adding more than one, I think we should be fine re: the repo size. (plus, it'd make it easier for folks doing offline development, if they forgot to download the videos first.)

so if you download https://ucarecdn.com/fadab25d-0b3a-45f7-8ef5-85318e92a261/city.mp4 and save it to `examples/boilerplate/360-video/city.mp4` and update the video path in `examples/boilerplate/360-video/index.html` to point `city.mp4`, you should see it all working.

let me know if you're still having issues or have questions. thanks üëç 
 the CORS "fix" is unlikely to work with HLS video, so if it is going to be introduced into core can we please either verify HLS survives it, or place appropriate video type guards? > the CORS "fix" is unlikely to work with HLS video, so if it is going to be introduced into core can we please either verify HLS survives it, or place appropriate video type guards?

yep, I'll test it with HLS and let you know - thanks üëç 
 I expected logic to detect whether `autoplay` is specified to determine whether to start playing the video or not on that gesture. How does that work?

And perhaps easier to test if you include that follow up PR here to see if we can get it working on iOS.  @cvan I think this is not too far from being mergable. There are some pending questions when you have the time: https://github.com/aframevr/aframe/pull/2657#issuecomment-306945378 Also type guards to avoid breaking other video... https://github.com/aframevr/aframe/pull/2657#issuecomment-301069075
Some concern the blob technique will not work for large videos.
What size videos are you testing with? > What size videos are you testing with?

- https://ucarecdn.com/25f36ea9-579e-4914-85ed-e131dd9e75d1/walking_the_dog_360_video_short.mp4
- https://ucarecdn.com/16cbcc72-ef7a-44f5-be04-3988d0ce9c6c/nice_dive_with_wild_dolphins.mp4 (fetched from https://www.youtube.com/watch?v=zUzLvybAGKM)
- https://ucarecdn.com/fadab25d-0b3a-45f7-8ef5-85318e92a261/city.mp4

@machenmusik: which videos are you testing with? so I can test large videos and real-world HLS/DASH examples?
 @cvan given the potential CORS issues with content, am wondering whether we should convert the iPhone friendly version of stock MP4 into HLS (MP2TS) so that an A-Frame demo showing iOS HLS would actually work right... which would also be the source you need to test here

I think the original three.js ticket for iOS HLS had some streams, I remember seeing an example in there with an ultralight but don't recall the specific name (much less the URL) @machenmusik do you have a URL of a video example?
 @cvan let me try to quickly make HLS from @Utopiah's https://github.com/aframevr/aframe/issues/1846#issuecomment-309201624 ...
see https://github.com/aframevr/aframe/pull/2830 @machenmusik as you know, video policies need to be handled quite uniquely such that user activation is respected properly based on the audio/video media being played (or autoplayed). I still maintain that this should be handled properly out of the box in A-Frame core, not as a third-party component.

if I address the outstanding review comments, is there any chance that this would be merged? I ask based on the feedback on related PRs and issues concerning video playback (not only for Safari on desktop and iOS, but also for Android - both for Randall's new GeckoViewVR APK, existing Chrome-based browsers). This was marked `needs answers` for https://github.com/aframevr/aframe/pull/2657#issuecomment-306945378   Nice. Thank you  **Description:**

http://stackoverflow.com/questions/43788105/issue-with-aframe-where-setattribute-reset-previous-proprieties

When passing a string as the second argument for a multi-prop component, A-Frame may be clobbering/resetting existing properties. Update `Entity.setAttribute` to consider this case.

- A-Frame Version: 0.5.0
- Platform / Device:
- Reproducible Code Snippet or URL: http://codepen.io/deva/pen/QvMeom

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
  We've deprecated a-animation. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.

With animation component you can set `startEvents`, `pauseEvents`, and `resumeEvents`. The component will also automatically stop all related animations to not conflict.  On A-Frame master, you can do `<a-asset-item response-type="arraybuffer" src="model.gltf"></a-asset-item>`  thanks!  Thanks!  **Description:**

Provide out-of-the-box way for attaching laser cursor to controllers, mapping the events, creating a line.

https://github.com/bryik/aframe-controller-cursor-component

Possible API brainstorm:

```
<a-camera>
  <a-entity cursor></a-entity>
</a-camera>

<a-entity hand-controls="right" cursor"></a-entity>
```

The `cursor` component can perhaps detect when it's attached to a controller or not (`tracked-controls`), or whether its parent has a camera. cc @bryik  so what i do personally is have a separate `controller-cursor` component that listens for the new controllerconnected event and disables the camera gaze cursor when it takes over (and it uses configurable events like trigger/touchpad/thumbstick for emulating mouse down/up events).  not sure it helps to completely merge into same component since controls may need different adjustments? Merging because all of the event names, raycaster code, state is the same. The main thing different for controller is mapping to detect click and option to show a line mesh. if the assumption is that there should only be one active cursor that should jump from camera (gaze) to controller (button press), I understand what you mean (to avoid multiple raycasts etc.) but if the plan is to allow multiple simultaneous, not sure there will be as much benefit.  direct mouse click is something else really.  maybe just need to allow cursor to respond to controller button events, and create a laser-pointer alternative to the typical ring representation (e.g. you should be able to use laser pointer with gaze if you like) Perhaps make it less magic and explicit with presets:

````
<a-camera>
  <a-entity cursor="type: gaze"></a-entity>
</a-camera>

<a-entity hand-controls="right" cursor="type: controller"></a-entity>
````

Based on type, A-Frame can handle listening for VR mode, whether to laser/reticle (or even project). cc @caseyyee, who's been thinking and working with responsive controller components @ngokevin seems like we're really talking about presets...
```
<a-entity cursor="fuse: true; fuseTimeout: 500"
            position="0 0 -1"
            geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
            material="color: black; shader: flat">
```

gaze is preset for `fuse:true` and maybe timeout
controller is preset for laser pointer geometry and/or default material, but really we might want preset for ring, cross, dot, etc. as well

would it be better for `gaze-cursor` and `controller-cursor` to exist and simply assign properties to `cursor` dependency as a way to share the code? I might do that. The awkward thing I need to resolve is that our current crop of 3dof controllers primarily have `trackpaddown` for clicking, and 6dof controllers have `triggerdown` for clicking. I wish I could set the cursor to just listen to both events, but there's a event collision: 6dof controllers have their own `trackpaddown` events. 

I could do cursor -> gaze-cursor | controller-cursor. gaze-cursor sets fuse, controller-cursor renders a laser. Though a `preset` property might just be as simple while avoiding API surface / abstraction hell.

presets:

| presetName | properties | usage |
| ---------------| ----------- | ------- |
| gaze             | `fuse: true; upEvents: ; downEvents: ;` | under camera |
| controllerTrigger              | `laser: true;  downEvents: triggerdown; upEvents: triggerup` | 6dof controllers
| controllerTrackpad              | `laser: true; downEvents: trackpaddown; upEvents: trackpadup` | 3dof controllers | What about `gaze-controls` and `laser-controls` as analog of `hand-controls` ? `-controls` have meant controllers or code to handle pose. The cursor stuff is more of an attachment onto the controllers for interactivity. I see `laser-controls` pretty similar to `hand-controls`. They all use `daydream-controls`, `vive-controls`... under the hood? gaze-controls they have also tracking associated to it but it's the headset / camera. The `-controls` family of components handles effecting the position/rotation of entities and the family of tracked-controls/daydream-controls/gearvr-controls/vive-controls/oculus-touch-controls/hand-controls follow a pattern and build on top of each other. 

The cursor components don't necessarily depend on any of those. They just attach interactivity/state on top of events that may come. So I wouldn't want to conflate them. I also don't think we need entirely separate components configure a single component; that's what properties are for, to configure. It can sometimes be hard to follow the abstractions otherwise.

Here's the API I am thinking:

```
<a-camera>
  <a-entity cursor="preset: gaze"></a-entity>  <!-- Gaze is the default. -->
</a-camera>

<a-entity daydream-controls gearvr-controls cursor="preset: trackpadController"></a-entity>

<a-entity hand-controls cursor="preset: triggerController"></a-entity>
``` I think that at least `laser-controls` should do more than just interactivity / state. It will position the laser on the correct position based on the controller available and will map the buttons to emit `click` events on other entities? I don't think it's much different than `hand-controls`
````javascript
<a-entity laser-controls></a-entity>
````
That gives you a consistent laser regardless of the specific hardware or number of DOF. I could get on board with that. That way would be to make the `cursor` component smarter and do controller (or lack of controller) detection) and automatically set everything. If I had my own custom controller, I could configure the position/rotation of the controller. The slight downside is increased complexity in the component to make things more magic (controller detection and auto-configuration); if it were developer-configured, it'd be simpler, less need for manual testing.

I think `-controls` naming though should be reserved for components controlling an entity. While it would be coupled to `-controls` code, the laser wouldn't be controlling anything. Well... `laser-controls` would control the entity the same as `hand-controls`, `daydream-controls`, `vive-controls` do. The `laser-controls` I had in mind is pretty similar to `hand-controls` but in this case the model is just a line (+ the default controller model for each platform) and it scales across 3DOF and 6DOF. `laser-controls` can make use of another component `cursor="type: laser, position: 0 0 0"` that can be reused by custom controls OK.

We'll have `laser-controls` which sets all the proper configurations for each controls we support. If someone does a custom controller, they can configure the `cursor`/`raycaster` component. Maybe the `cursor` can handle drawing the line based on the `raycaster`'s far/origin/direction. 

Maybe `cursor` can default to `gaze` configuration so we don't have to create another component.

We can also document/share code that will toggle the cursor/controller cursors depending on controllers available if devs want to set both and have everything handled for the "responsive" case. Thinking about this API.

## laser-controls

Works with 3DoF and 6DoF.

Configures `cursor.downEvents`, `cursor.upEvents`, `raycaster.origin`, `raycaster.direction` based on which controller is active.

Configure `cursor` or `raycaster` components for further customization.

No properties.

## cursor

Laser's length is configured via `raycaster.far`.

Laser's position/rotation is configured via `raycaster.origin` and `raycaster.direction`

`laserAlwaysShow` if off only shows laser when interacting with objects configured by `raycaster.objects`

| property |
| ---------- |
| fuse        |
| fuseTimeout |
| downEvents |
| upEvents |
| laserAlwaysShow |
| laserColor   |
| laserEnabled |
| laserRadius |

## raycaster

| property |
| --------- |
| far |
| interval |
|  near |
| objects |
| recursive |
| origin |
| direction |

## extra: responsive-controls-toggler

Perhaps provided via documentation or examples

`<a-scene responsive-controls>`

Creates gaze-controls under camera and laser-controls. Toggles between either way depending on whether controls are active

## usage

```
<a-camera>
  <a-entity cursor></a-entity>
</a-camera>

<a-entity laser-controls></a-entity>
``` If I understand correctly, this is the chain of components injecting other components:

![img_5228](https://cloud.githubusercontent.com/assets/1848368/26184174/1697af28-3b38-11e7-88f2-ac19378253bb.JPG)

I'm a bit concerned that the existing `-controls` components expose nearly-similar APIs without actually sharing any code... if I want to use a custom model, I'm left doing this:

```
<a-entity vive-controls="model:false"
          oculus-touch-controls="model:false"
          gearvr-controls="model:false"
          daydream-controls="model:false"
```

That's a bit out of scope for this question of having a laser, so I don't think we need to address it here, but it does make me wish this laser implementation could not add onto that dependency stack.

What if we just called it, say, a `laser-cursor` component, which depends on `cursor`, but that does not automatically add all the other controls? Presumably it would have an `origin` and `direction` that can be customized by the user and passed on to the raycaster. In terms of getting the `origin` and `direction` automatically from the currently-active controls, that sounds like a job for a System and not for a direct dependency between the components IMO.

No opinion on the `responsive-controls-toggler` proposal for now, since that depends so much on the previous thoughts.

 What I typically do these days is in a codepen here:
http://codepen.io/machenmusik/pen/gWdgMy

You can see a set of components - `controller-cursor` (translate controller events to down/up/click), `controller-model-if-present` (think `hand-controls` abstraction of which controller, but using the native controller model instead of the low-poly hands), `controller-with-cursor-if-present` (which includes `controller-model-if-present` and ray representation, as well as disabling gaze cursor when controller connected)

Thoughts welcome @machenmusik very nice! That looks quite helpful.

Your `controller-cursor` matches my suggestion on `laser-cursor` I think, in the sense that it isn't responsible for adding controls itself. Although I hadn't thought of the need to manually call `onMouseDown()` on the cursor. I'm not fan of components with conditionals in their name. they define logic which is the opposite of declarative I see from the point of view of the user. The same as `hand-controls` I want a single component `laser-controls` that gives me a nice laser interface with the model of the platform I'm using so I just care about hooking up the events to my application logic. I'm sure we can have something that will work out of the box for 90% of the cases. <img width="602" alt="screen shot 2017-05-17 at 8 55 20 pm" src="https://cloud.githubusercontent.com/assets/674727/26185974/2e9bcb08-3b43-11e7-9ac5-b385b2e58a87.png">

I had the same concerns about the towering abstraction stack, but I think of `laser-controls` as a convenience layer. The `responsive-controls-toggler` isn't really a proposal for inclusion. Just something we can provide or link to from documentation in case people want to know how.

For custom controls with laser, I see the story as:

```html
<a-entity custom-controls="model: customModel.gltf" cursor="laserEnabled: true" raycaster="direction: 0 -0.10 -1">
```

```js
AFRAME.registerComponent('custom-controls', {
init: function () {
  // Whatever controls you want to support.
  setAttribute('vive-controls', {model: false});
  setAttribute('oculus-touch-controls', {model: false});
}
});
``` The current implementation of `hand-controls` is pretty simple and I would use it as a starting point for `laser-controls` What @ngokevin says :) As a convenience layer, I would find `laser-controls` most helpful if it did not BOTH provide behaviors and inject other controls. This comes back to bite users who want to have custom controls, because they now have to re-implement the laser to get that. And it pre-supposes that all future `<device>-controls` components will be part of A-Frame core.

If the idea (from `cursor="laserEnabled: true"`) is that the actual laser-related logic would go into the `cursor` component, and `laser-controls` is just some syntactic sugar with no behavior of its own, then I have fewer concerns. But why not just make it a primitive, then? The actual laser logic would be in `cursor/raycaster`. The extra behavior needed is to automatically line up the laser appropriate to the controller models + map which button event triggers down/up, depending on which controller is connected. @dmarcos I was not proposing to add names with if-present to core, I just use that to distinguish that they are expected to do nothing until the controller connects - my pet peeve with hand-controls is that they default to visible even if no controllers are present, so you end up with a pair of hand models permanently stuck at origin `laser-controls` would also position the origin of the raycaster depending on the model. Components that are sintatic sugar are ok to me. A different topic: primitives is something we want to deprecate due to
side effects when combined with mixins and confusion when a component is both set on the entity and the primitive (you might have several attributes in the entity that refer to the same thing). As a layer of abstraction they introduce more noise than value over the entity / component model.  @ngokevin you can definitely add the controller-cursor behavior into cursor, although then you need to know if it is a controller-cursor or a gaze-cursor, not sure that is worth trying to jam into same component as opposed to having them separate.  However, IMO there should be a way to (1) provide custom appearance for ray/line (2) have the ray/line stop at intersection as opposed to tunneling straight through to the full length of the ray/line (and maybe place some intersection graphic) -- really this starts to be like teleport controls (straight laser vs. parabolic, and hit target appearance) @dmarcos Let's not start a different topic in this issue.

@machenmusik Yeah, that's doable. Not much logic needed to differentiate gaze vs controller. You can just attach both types of events and they won't interfere. The laser can be customized through various properties, or really, you can disable the laser and provide your own mesh. And stopping the laser or projecting on the intersection point can be done later too. > The actual laser logic would be in cursor/raycaster. 

Ok cool. That, or as @dmarcos said in Slack, if `laser-controls` uses `laser-cursor` for the laser behavior, that is similarly fine.

The point on primitives makes sense.

If possible, it would be preferable for `laser-controls` to not have specific knowledge of each `<device>-controls` component model for determining offsets, but to get that through some component or system API. Let's not plan on every `<device>-controls` being in core. @ngokevin  w.r.t. Laser customization of appearance - at some point you realize that the entity with controllers and model is related to but distinct from the ray/line indicating the laser with its own position and orientation offsets, they can't be the same entity... If the idea is to force people to make their own mesh, it is complicated by the need to understand the underlying object hierarchy to do it right... As an example, maybe I want the ray to be thin and lower opacity until it is intersecting with something at which point it starts pulsing and appearing to be more solid... which along the lines of cursor could be done as animation if things were structured properly Maybe laser-pointer should just be the ray/line, and cursor can auto-switch if it sees controller connected event, which should never happen if attached to camera to be a gaze cursor? Brainstorming here:

```js
AFRAME.registerComponent('laser-cursor', {
  dependencies: ['cursor'],
  schema: {
    origin: { type: 'vec3' },
    direction: { type: 'vec3' },
  },
  init: function () {
    var el = this.el;
    var data = this.data;
    el.addEventListener('controllerconnected', (e) {
      if (!data.origin) { el.setAttribute('laser-cursor', 'origin', e.detail.defaultOrigin); }
      if (!data.direction) { el.setAttribute('laser-cursor', 'direction', e.detail.defaultDirection); }
    });
  },
  // ...
});
```

I don't think I have a good sense of how to allow users full control over the line... seems like they will need to re-implement at least one component there. Ideally we can limit that case to only re-implementing a single component. I don't think we need a separate `laser-cursor` component. Potential confusion vs. cursor or laser-controls, and not much meat to separate from cursor.

Possible ways to configure a line, just provide your own mesh. You can still offset it with `mesh.position` or `mesh.rotation`.

```
<a-entity cursor="laserEnabled: false" line="radius: 0.1; color: blue; opacity: 0.8"
               event-set="_event: mouseover; line.color: green; line.opacity: 1">
</a-entity>
```

Alternatively, the default laser mesh is accessible through something like `getObject3D('cursorlaser')`.
 Cursor/raycaster need to be dormant if no controller at all right?  (Else you have stuck raycaster permanently firing from origin) Good point. `laser-controls` could attach the cursor only once a controller is connected. The big nuisance I see at the moment is having to repeatedly specify the objects property for raycaster - once for gaze and then twice more (once for each controller)

Maybe we need one objects pool and multiple raycaster instances that reference it Not just twice? One for gaze-based and one for controller-based? I don't think it's much work to define twice, but that's also where mixins can come in. 

Different raycasters could want to intersect different objects. it's not just defining,  you have to gather the list of THREE objects multiple times which is wasteful.

if you can't share raycasters, and you want to be able to select things with either hand, then you need three.  if you implement the ping-pong between controllers based on which one was used last -- which is sometimes good and sometimes incredibly annoying -- then you need two so did you guys want to start prototyping the changes in a different branch (feel free to grab whatever you like from the codepen if it is useful), we can see how it feels to use and whether it makes our apps easier to write, and once happy can PR and merge? That's why I wanted to have some toggler-type component somewhere so there's not duplicate raycasters. But the three.js object querying is not as expensive/frequent as the actual intersection tests.

Yeah, I'm working on it at the moment. Diego needs a cursor for his link traversal demo. > laser-controls could attach the cursor only once a controller is connected.

once you start down that path, you realize there is a whole bunch of stuff you really only want once a controller (with the correct hand property) is connected.

> Yeah, I'm working on it at the moment. Diego needs a cursor for his link traversal demo.

ok, feel free to steal liberally from codepen if helpful.  it felt really good / convenient to be able to just say
`<a-entity controller-with-cursor-if-present="right"></a-entity>` -- naming issues aside -- and I'd encourage efforts to simplify the number of -controls currently required to specify as discussed above. Thanks, I'll check it out. I'm not as opposed to having a general utility toggler components like that (A-Blast has a component that toggles the controllers off if not VR), but for now, I think I'll just code in the one event listener into the component. > I don't think we need a separate laser-cursor component. 

That's fair. Even if it's `laser-controls`, the goal should be to let users add their own `<device>-controls` component without re-implementing the whole stack. To summarize, in case this is blocking anyone, I think we are agreed on adding optional laser functionality to the `cursor` component? I assume that is the bulk of the work, here. 

Dummy examples of using the `laser-controls` convenience wrapper would be helpful to understand that API. Working on it at the moment. There's not so much laser functionality, more like laser appearance, which is just creating a line. Doesn't look like there's actually much code to change, perhaps the hardest part is being able to offset the raycaster, which isn't too bad.  Great! In case it's helpful, new PR on three.js: https://github.com/mrdoob/three.js/pull/11349 It'd be interesting to see something like `aframe-crawling-cursor` implemented at the point of intersection. This would make it easier to target geometry in 3D space as the size of the laser pointer dot would change depending on the distance from the camera: https://github.com/jujunjun110/aframe-crawling-cursor That's currently in the PR https://github.com/aframevr/aframe/pull/2678 Great - I'll take a look and will give it a test!  Components are supposed to solve this. Bundles of JS that can be consumed via HTML.

Gaze Teleport: https://github.com/donmccurdy/aframe-extras/tree/master/src/controls
Set on Event Listener: https://github.com/ngokevin/kframe/tree/master/components/event-set

These can be found on https://aframe.io/registry/

I am updating docs now, thanks for the issue. There's also https://aframe.io/school/, the docs have the 360 image gallery guide that goes over the interactivity and event setter with link to demos, and we're currently updating docs too  Thank you!  I think we need https://github.com/aframevr/aframe/issues/2166

But you can try clearing texture cache `AFRAME.systems.material.textureCache`. They resolve promises which you can call `Texture.dispose()`. But yeah, iOS has 10MB limit per tab or something.  If you want to include an asset at runtime, just set the URL directly `<a-image src="texture.png">`. But yes, your way should work as well, but a roundabout way of doing it.

(Note Stack Overflow is the best place to ask questions.)  Dupe https://github.com/aframevr/aframe/pull/2642  @ngokevin is this the typical case of differences between component and primitive behaviors (and perhaps encouragement to use components for more complex cases) ?  In `src/components/look-controls.js`, the code should check to see if `this.data.enabled` before adding the class on the document body for the cursor. Help wanted! https://github.com/aframevr/aframe/pull/2642  I'm not sure I understand the problem. What do you mean by using your entities twice. Can you come up with a simpler fully functional example? @kurai021 I would try cloning the element before re-attaching it. In jQuery: 

```js
$el = $el.remove().clone();
```

Hopefully that solves it, but in either case a simple example would be helpful. :)

See also:

* https://github.com/aframevr/aframe/issues/1444
* https://github.com/aframevr/aframe/issues/2425
 @kurai021 I don't understand what you mean, sorry. What options do you refer to? A simplified version of your script (showing only what's necessary to reproduce the problem) would be helpful. What do you mean by preventing reuse? Can you be more specific so we can understand the problem and your use case? The THREE cache is going to store a downloaded file so you don't fetch it over the network multiple times. It is what you want in most cases and this is why is a sensible default. I don't think there's anything to fix. If you have a technical question, you can head to http://stackoverflow.com/questions/tagged/aframe and clarify the question a bit.  Thanks. No problem, just style / minor stuff. Still need to adjust one more thing. Switch `!=` to `!==`. 

https://travis-ci.org/aframevr/aframe/jobs/225977249 thanks!  We can document it. Note all HTML attributes are lower case on the Web. fixed  Good place for questions is Stack Overflow: http://stackoverflow.com/questions/tagged/aframe, that'd be the best place.

You should be able to set a `material` component alongside `obj-model` component.

Workaround is to wait for `model-loaded` event, grab the mesh, and change the materials manually. It's difficult to expose every material property that could be used to post-process a model as a common API. If you need to override an MTL, I would make a component:

```
AFRAME.registerComponent('my-material-override', {
  init: function () {
    var el;
    el.addEventListener('model-loaded', function () {
      var material = el.getObject3D('mesh').material;
      // modify material.
    });
  }
});

<a-entity obj-model="obj: obj.obj; mtl: mtl.mtl" my-material-override></a-entity>
```  Most of the examples are on GitHub too under MIT, including the one in the READMEs. I'll try to make sure to include LICENSES on Glitches too.  **Description:**

Pointer Lock is an easier way to look around on desktop than mouse-drag. Mouse-drag also has problems that it triggers clicks on time users move. We could add Pointer Lock to the default control scheme if:

1. User is on desktop
2. User does not have a headset detected
3. User enters fullscreen mode

It seems like Pointer Lock doesn't prompt permissions on Firefox and Chrome anymore too when I try Pointer Lock example on MDN with user gesture. So it's not intrusive, use the VR Button click as the user gesture.

We maintain the mouse-drag for now when not fullscreen.  A slightly tangential topic: Should we also consider a screen based raycaster when we're not in fullscreen?  (like react-vr)
Another question: Do people use the fullscreen mode? I personally either go to VR or use it in non fullscreen. I see fullscreen useful for probably the embedded case if the preview is very small. I don't like that screen-based raycasting conflicts with using the mouse to look around. `aframe-mouse-cursor-component` is available for those that want it. If you have a scene you can't look around or move and interact with mouse raycasting, it's almost the same as a 2D webpage?

If I were to engage in a site on plain desktop, I think I'd use full screen if it offered me Pointer Lock. Also makes it easier if people want to build traditional 3D sites (WASD + Mouse + wall collisions). What are the cases against just having Pointer Lock always? It used to be we didn't like the Permissions prompt, but if we use the User Gesture, the user has intended to interact with A-Frame and no permission will pop up. Multiple A-Frame scenes are not supported. Even so, would Pointer Lock be intrusive? Needing to hit ESC to disengage and continue on. Pointer lock is only engaged if you click a scene, so that's not possible The best component to look at is A-Frame Extra's Universal Controls. +1 from me for including pointerlock with `look-controls`, at least as an option.

Side note: I've needed a [small hack](https://github.com/donmccurdy/aframe-extras/blob/master/src/controls/mouse-controls.js#L123-L134) to disable pointerlock when in inspector mode. Probably want to do the same for `look-controls`. I think the `.pause()` handler would handle that if Inspector is opened Yeah, I'm in favor of a Pointer Lock on by default. I shared some A-Frame stuff to people on desktop and the click-drag is not usable. For default desktop mode, I'd favor Pointer Lock/a-cursor versus Click-Drag/mouse-cursor (they conflict anyways).

There's no permissions hanger anymore since it's activated on click. Try: https://webvr.donmccurdy.com/checkpoints/  This question doesn't have enough information. You can ask on Stack Overflow http://stackoverflow.com/questions/tagged/aframe with detailed information to get help.  What's our proposed solution?  Not much to do. Videos in general are high CPU usage, more so as a texture. Up to the browser to optimize it.

Not much to do for mobile, they aren't super equipped to handle VR, and we'll using the WebVR polyfill so it's not a true optimized implementation.  thanks!  I've just noticed that the `text` component `opacity` parameter is not working as expected:
When the opacity goes below a certain value (`~0.4`) the text abruptly disappears.

![2017-04-24_14-48-21](https://cloud.githubusercontent.com/assets/782511/25337754/5bb3fdf2-28fd-11e7-8fa3-e98427af963f.gif)

I've tried both in my original repo and on @bryik and it's working as expected so it should be something introduced in the custom sdf function (https://github.com/aframevr/aframe/blob/master/src/shaders/sdf.js)
@machenmusik do you mind taking a look at it or explain the changes you did on the `sdf.js` as I remember you commented something to improve rendering but I don't remember correctly. 
Maybe we could have both versions? the original sdf.js and the current one with another name as a modified version as fadein/out opacity is a very common feature that we should support correctly. @machenmusik sure
 
Steps to reproduce:
- https://aframe.io/aframe-inspector/example
- Add a new empty entity
- Add `text` component
- Set `value` to `TEXT`, leaving the rest of the parameters as default (shader is `sdf` by default)
- Modify the `opacity`

I've tried on Windows10 with Firefox 55.0a1 and Chromium 56.0.2910.0 and both seems to be broken @machenmusik I just saw your PR, but I'm having the problem on `sdf` that it's the default currently Ouch, I didn't know that, we should do something as right now it's misleading to see `sdf` but it's using `msdf`.
I'll give it a try later and let you know, thanks!  Thanks!  **Description:**

`THREE.BlendCharacter` has been removed from Three.js r85.

So maybe we need to rewrite our `blend-character-model.js` in reference to  [Three.js webgl_animation_skinning_blending example](https://github.com/mrdoob/three.js/blob/dev/examples/webgl_animation_skinning_blending.html) or make our `THREE.BlendCharacter`.

 Related thread in Three.js https://github.com/mrdoob/three.js/pull/11152 We can still pull it from the examples directory through Node, right? I'm not sure Node well but is it possible to pull it from Three.js r84 example even if we bump Three.js into r85?

https://github.com/mrdoob/three.js/tree/r85/examples/js
(`THREE.BlendCharacter` has been removed from Three.js r85 example)

Even if we can, it's no longer maintained by Three.js so it wouldn't work with the latest Three.js someday. Can we convert the model to glTF? > Can we convert the model to glTF?

Probably yes. If so, the animations can work similarly. Is upgrading to three.js r85 planned for 0.6.0, or waiting until next release? I think it could wait, perhaps while post-processing support improves. I'd like to bump Three.js to the latest revision right after 0.6.0 release, before Three.js supports VR + Post-Processing. (Maybe we can't do that for 0.6.0 due to the last minute for the release)

Because I want to update `GLTF2Loader` as soon as possible, and I think it still takes time til Three.js's post-processing support.

BTW I don't think I followed the discussion above. Would we convert the model to glTF and remove `blend-character-model.js`? Yeha, we can do that. Ideally, we could get rid of blend-character-model, even buy in on an animation mixer component. > I'd like to bump Three.js to the latest revision right after 0.6.0 release, before Three.js supports VR + Post-Processing. (Maybe we can't do that for 0.6.0 due to the last minute for the release)

+1

> Because I want to update GLTF2Loader as soon as possible

Let's start a new issue to discuss how/when we want to make this transition. Opened #2693.

> Ideally, we could get rid of blend-character-model, even buy in on an animation mixer component.

+1 for moving `blend-character-model` out of core if we can. Adding `animation-mixer` to core is fine by me, although we don't really need it for just hand controls. OK, got it.
Let's close this issue when we remove `blend-character-model`. Note: Seems like `VRControls` and `VREffect` will be removed from Three.js in r86, r87, or later.
https://github.com/mrdoob/three.js/issues/11301

Update: They'll stay for a r86 Do we know an ETA on r86? Perhaps soon? I'm asking Ricardo now.

Update: probably tomorrow Let's start working on this once we release 0.6.1 Are there source files for `oculus-hands/v2/leftHand.json` and `oculus-hands/v2/rightHand.json`? I'd like to try converting them to glTF, but don't know of any way to import three.js JSON files back into Blender. 

/cc @feiss  It looks like [most are geometry-only](https://github.com/mrdoob/three.js/tree/dev/examples/js/exporters) except MMD; I can give that a try though. Not seeing any real conversion options without the original models, so just going with #2876. Fixed by https://github.com/aframevr/aframe/pull/2876  @machenmusik, @caseyyee, or @mkeblx (!) ‚Äì someone who has a functional Oculus Browser device: can you take a looksie?

(I'm waiting on a new Samsung Gear VR viewer)
 thanks, @mkeblx. I'll debug it once I get my new Samsung Gear VR; if you (or someone else) can get to it before then, sweet! I wonder if the old code to auto-enter VR (by necessity) for Carmel Developer Preview is trying and failing with Oculus Browser.  But previously for me pages were loading in 2D with enter-VR button visible just fine with Oculus Browser.  Did this just change recently? Can we test with 0.4.0? On the assumption that most will be using Oculus browser now, maybe we should remove auto-enter-vr from default scene components, and those that need can add manually? @dmarcos if you like that approach I can do quick PR @weddingdj thanks for investigating! Is that with current master? `auto-enter` vr was disabled recently. Entering VR itself works fine though right? requestPresent is failing. Is this the Oculus Browser or the Samsung one? `requestPresent` is clearly failing saying that it requires user gesture. I don't understand how it's entering VR. Is it the polyfill taking over? @dmarcos I don't think you merged #2707, was auto-enter disabled some other way? Perhaps auto enter is attempted and fails in such a way that messes up subsequent exit after manually entering.  Try with #2707 included maybe? I would look into the `exitVR` button of `a-scene`: 

https://github.com/aframevr/aframe/blob/master/src/core/scene/a-scene.js#L229

Is `exitVRSuccess` ever called? @weddingdj just curious. do you use a remote console or something to see the logs on GearVR? That'd be helpful! I will be around to test it in an hour. Yeah, I just tried myself. I guess it means Oculus Browser may not be firing `onvrdisplaydeactivate` as the WebVR API says it should. Asking them now in the PR. Or here. Does Oculus Browser implement `onvrdisplaydeactivate`, or is there another agnostic way to detect exit VR so A-Frame can handle it. Thanks, I'll use that. Thx Justin  **Description:**

The System code is currently really simplified and doesn't have the same code as the components. The complete fix is to make Systems extend Components. I would take a simple hack for now though.

- A-Frame Version: master
  Thanks!  Dupe https://github.com/aframevr/aframe/issues/2546  Thanks!  **Description:**

URL: https://glitch.com/~superficial-treatment

1. Open the Glitch using FF Nightly, Oculus + Touch.
2. Open console
3. Press left controller trigger

Expected: Console will log once
Actual: Console logs twice

```html
<!DOCTYPE html>
<html>
  <head>
    <title>Hello, WebVR! - A-Frame</title>
    <meta name="description" content="Hello, WebVR! - A-Frame">
    <script src="https://rawgit.com/aframevr/aframe/90f512b/dist/aframe-master.min.js"></script>
    <script>
      AFRAME.registerComponent('test', {
        init: function () {
          var i = 0;
          this.el.addEventListener('triggerup', function () {
            console.log('TRIGGER UP', i++);
          });
        }  
      });
    </script>
  </head>
  <body>
    <a-scene>
      <a-entity hand-controls="left" test></a-entity>
    </a-scene>
  </body>
</html>
```

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Will confirm first. Looking at code, might not be the case. But still emitting twice. Updated with a Glitch. Really puzzled. I put a console.log in A-Frame, and it seems it only emits once. tracked-controls and hand-controls don't emit that. vive-controls seem disabled since there are none present. But when I add an event listener, the handler runs twice.  We have a `template` component! Or you can use [aframe-react](https://github.com/ngokevin/aframe-react) or any other Web solutions (Vue.js, template libs, view layers).

https://github.com/ngokevin/kframe/tree/master/components/template/  For some reason the a-frame inspector has a breaking error while trying to hide the loader. This causes it to be unresponsive when launched.

See below:

```
Uncaught DOMException: Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node.
    at NewComponent.hideLoader (https://cdn.rawgit.com/aframevr/aframe/v0.5.0/dist/aframe-v0.5.0.js:68558:13)
    at HTMLScriptElement.script.onload (https://cdn.rawgit.com/aframevr/aframe/v0.5.0/dist/aframe-v0.5.0.js:68583:12)
```

- A-Frame Version: v0.5.0
- Platform / Device: OSX 10.11.6 / Firefox 52.0.2 / Chrome 57.0.2987.133
- Reproducible Code Snippet or URL: https://58f6d0a253444.gladeye.org/prototype1/

I suspect that a broken version of the inspector JS has been pushed to the CDN as this is loaded independently of the a-frame JS file. The example URL was working earlier today and hasn't been touched since.
 After further investigation it seems that it was partially caused by the bootstrap modal dialog box css that was running on the page. When using the current master branch of a-frame and disabling the dialog box html the inspector works as expected. Would it be possible to change the css class applied by the inspector to something other than `modal`? e.g. `inspector-modal`? This would help prevent collisions with other CSS that may be on the page, especially since it's embedded in a `style` element, making it difficult to remove / adjust in certain cases where there are collisions. It's a issue already filed on the inspector but we still didn't address it :/ https://github.com/aframevr/aframe-inspector/issues/129 feel free if you believe you could help there! (I assume this is the same issue, but correct me if I'm wrong.) Loading the Inspector from Docs doesn't work https://aframe.io/docs/0.5.0/guides/:

![screen shot 2017-05-05 at 4 02 35 pm](https://cloud.githubusercontent.com/assets/203725/25767255/8a5bebee-31ac-11e7-9899-a0a35b83f926.png)
![screen shot 2017-05-05 at 4 02 46 pm](https://cloud.githubusercontent.com/assets/203725/25767257/8a607326-31ac-11e7-9d97-60ad2bf68848.png)

The Inspector loads fine from the https://aframe.io examples though:

![screen shot 2017-05-05 at 4 03 28 pm](https://cloud.githubusercontent.com/assets/203725/25767256/8a5dfe16-31ac-11e7-9288-22f1ac9e899c.png)
![screen shot 2017-05-05 at 4 05 04 pm](https://cloud.githubusercontent.com/assets/203725/25767267/a5c53250-31ac-11e7-9dc1-62476ff55623.png)
 Inline example/inspector has been removed from docs since.

Moving to https://github.com/aframevr/aframe-inspector/issues/129  So with PR the video at least plays but flipped and with wrong color? :)  Is that better than the video not playing at all? Can we add add a custom shader that it's set automatically when playing on iOS? > due to CORS issues with Mobile Safari, in order to test this, your HTML page must be in the same exact domain as the IDevice-compatible video content (m3u8 manifests and ts / aac files), Subdomains will not work at present.

can you point me to a sample video you're using as a test case?
 @machenmusik nice work on supporting this üëç if you can point me to some test case URLs, I'll try this out on my end.
 i think i used hls urls from the prior threejs tickets on the topic

maybe should just convert the aframe 360 video from MP4 to iPhone-safe HLS? > maybe should just convert the aframe 360 video from MP4 to iPhone-safe HLS?

how about including both as `<source>`s? if including both as `<source>` works, that's fine although it complicates the example since you can't do with inline `src` in `a-videosphere` for example -- I was just trying to say that if we want HLS source, should probably make a version of the recently-iDevice-friendly MP4 example that is HLS format awesome, thanks for making the updates üëç btw, is there a simple test or two you can add? See [my comment](https://github.com/aframevr/aframe/issues/2663#issuecomment-300538257) in issue #2663. If @machenmusik has other insights, would be glad to know and discuss. Thanks, everyone üëç  @machenmusik I want to merge this but I would like to see it working first. Do you have any example I can try? so per discussion with @dmarcos, it seems that recent changes may have broken this somehow.., may need to do a little more investigation before merging this one :-/ found the problem :-) Thanks!  This is an issue with `aframevr/aframe-site` repo, I will check it out. Thanks! It's a backend/Node issue. Fixed! Had a minify step that was overriding some of our link processing steps.  Thanks for the request. This kind of features are better supplied by 3rd party components (https://aframe.io/aframe-registry/(. We want to keep the core small with the functionality that most of the applications need.   That (scale, rotation, position/translation) is the correct order for A-Frame. [Additions to the docs are welcome](https://github.com/aframevr/aframe/blob/master/CONTRIBUTING.md#update-documentation), perhaps on the pages for the `scale`, `rotation`, and `position` components?  Thanks you!  Fixed by #2587   What happens if the gyro is reenabled? I think probably the orientation would have to be reset so it plays well with mouse panning. I would leave this out of the default set and recommend tweaking your own controls (taking look-controls and removing the VRControls bits). I propose to close ^ Yeah! The more toggles we have in the core components the more combinations we have to keep track of and QA. It's not hard for someone to copy and customize the controls.  Would be keen to see this as we've got a few demos we'd like to try building utilizing the Vive trackers. @kfarr can correct me if I am wrong but at present there seems to be one functional and one test issue. 

The functional issue is that the observed position (with the default orientation correction) appears to have a small Z offset when compared to collocated entities and the SteamVR mode, which may be a combination of the rotation and the natural pivot position of the tracker model.

The test issue is that somehow only the node.js tests fail with a rather cryptic message.

But the PR should otherwise be functional for experimentation with Nightly. @machenmusik just wanted to check because I didn't see any labels, do you need a review on this? @cvan it's marked as Work in Progress ([WIP]) in the title of the PR yeah, just wanted to see if he needed a hand
 @cvan I think it's actually good except the weird failing node test (and maybe if we want to fix the default pose z-offset, but said to not be a big deal) @cvan test now passes, so removing [WIP] from title... what more did we want to do this one before merging?  maybe a good example or two (which is where the Z-offset from what SteamVR shows is annoying, since otherwise we just need the most basic usage for that) in looking more closely at the Z-offset:

go to this codepen:
https://codepen.io/machenmusik/pen/XRJmWB

if you look at the dummy tracker and marker, 
```
<!-- nothing wrong with the model, this looks right -->
  <a-entity position="0 1 -1" obj-model="obj:https://cdn.aframe.io/controllers/vive/vr_tracker-vive.obj; mtl:https://cdn.aframe.io/controllers/vive/vr_tracker-vive.mtl">
   <a-entity tracker-marker="?"></a-entity>
  </a-entity>
```
the model is aligned correctly with the center of the marker and rays
(no position from vive-tracker and tracked-controls at all)

if you look at the first real tracker (labeled 0),
which gets its pose from vive-tracker,
and then bring over the vive wand and touch the marker's center as a sanity check,
you can see that the entity itself has inherited the right pose 
(as shown by the marker and rays, agreeing with SteamVR)

but the tracker model doesn't appear in the same place as either the marker or rays (or SteamVR) -- that's the Z offset issue.

if you have a second tracker and look at the marker labeled 1,
you can see that the Z-offset issue is the same even without the rotation correction
(which is needed to make things match SteamVR, BTW)

thoughts / suggestions? I have to spend time looking so it won't make it for 0.6.0 No problems there.  If the Nightly bug with wrong gamepad id is gone, I may be able to (squash and) simplify changes to make less invasive?  Which might have better chance of merge regardless of when.  Or did we want tracked-controls to understand how to filter by hand anyway, and those changes should remain? duh.  i just realized that the Z offset is probably whatever adjustments were being made with old vive controller model.  pushed change to PR, but can't check actual outcome -- can anyone check https://codepen.io/machenmusik/pen/XRJmWB to see if offset is gone?  @kfarr @dmarcos? if the offset is gone, maybe we can land in 0.6.0 after all (well, from a functional standpoint anyway, still maybe no time for @dmarcos @ngokevin to look) confirmed, offset is gone (internally; some very slight difference from SteamVR). @cvan I think we can remove the work-in-progress label now (I would but I can't) (I may end up doing a simpler version that does not handle the aforementioned Nightly quirk, which may simplify things and avoid some conflicts with latest master from other merged changes.) Ok so revised to better fit against latest master.  Any issues?  @kfarr is this better now w.r.t. the mystery Z offset we used to encounter? (May need to rebase and fix a bit after current round of optimizations in master) Rebased, and starkly basic but fully functional example added and tested against Firefox release 55 (64-bit). @ngokevin why am I getting this test failure? seems that a recent commit may have poisoned the well...
```
[error]: docs/introduction/index.md
    Link definition does not exist: [Mozilla][mozilla]
``` I think this one is in good shape now, if we feel comfortable enough merging, then can use `rotation` to address #2965 at least temporarily the vive-tracker controller object hand property is undefined (which makes
sense because the tracker has no handedness)

On Thu, Aug 31, 2017 at 6:39 PM, Lewis Weaver <notifications@github.com>
wrote:

> *@leweaver* commented on this pull request.
> ------------------------------
>
> In src/components/tracked-controls.js
> <https://github.com/aframevr/aframe/pull/2583#discussion_r136465173>:
>
> > @@ -80,8 +91,10 @@ module.exports.Component = registerComponent('tracked-controls', {
>
>      // Hand IDs: 0 is right, 1 is left.
>      for (i = 0; i < controllers.length; i++) {
> -      if ((data.idPrefix && controllers[i].id.indexOf(data.idPrefix) === 0) ||
> -          (!data.idPrefix && controllers[i].id === data.id)) {
> +      if (((data.idPrefix && controllers[i].id.indexOf(data.idPrefix) === 0) ||
> +           (!data.idPrefix && controllers[i].id === data.id)) &&
> +          ((data.hand === 'any-or-none') ||
> +           ((controllers[i].hand === 'undefined' ? DEFAULT_HANDEDNESS : controllers[i].hand) === (data.hand === 'none' ? '' : data.hand)))) {
>
> Is this a typo or intentional? In src/utils/tracked-controls.js you are
> testing against: controllers[i].hand === undefined
>
> ‚Äî
> You are receiving this because you were mentioned.
> Reply to this email directly, view it on GitHub
> <https://github.com/aframevr/aframe/pull/2583#pullrequestreview-60009411>,
> or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AB-_4nm29KEhppNVSo9E5zW1szjXtwd7ks5sdzYSgaJpZM4M9DrV>
> .
>
 @machenmusik: do you mean @dmarcos‚Äô PR #3152? is this blocked on @dmarcos‚Äô work? if so, is there a branch we can test against? excited to try this out - thank you Yeah, @dmarcos has a patch. We'll have him to make a WIP PR so it's visible. I've seen his PR work with spectator camera before so at least it's not imaginary.  Yeah I had a PR. I will share it short after the VREffect / VRControls PR lands. Thanks for the patience.    Thanks! Can you remove the changes from the dist directory?  Sounds good!  Thanks for looking into this. A-Frame already injects these `<meta>` tags for Safari/WebKit for iOS.

If you load your phone in landscape mode, the "pseudo-fullscreen mode" won't trigger. But, if you turn your phone back to portrait mode and then back to landscape mode, the "pseduo-fullscreen mode" _will_ trigger. I looked in the [`webvr-polyfill`](https://github.com/googlevr/webvr-polyfill), but I don't think it's caused by something there.

I've done a lot of researched, asked a lot of people, and ‚Äì as far as I can tell ‚Äì it's just how iOS behaviour works (unless you're in a pinned ). I've looked for a lot of workarounds (this week I checked and spent quite some time too).

Is this behaviour above what I'm describing, the same thing you're experiencing, @rambambulli @derhuebiii?

Videos, screencasts, images would help too - just to make sure we're seeing the same issues. Thanks for your help! > Yes, that's correct, didn't realize that before. If this workaround would be implemented a "pop-up"/modal like we get when entering the VR mode in portrait mode that a turn to portrait and back helps would also help for that problem. Of course not optimal, but the best we might get currently with iOS...

Though not ideal, this is a good idea - thanks for the suggestion. (FYI, we also have #1239, which is somewhat related.) I'll repurpose this issue to address that. I'll grab this one; if you want to contribute a PR too, I can help review it. (Don't feel blocked on me, if you need this fixed, is what I'm saying.) Thanks for your help again üëç   Should we allow this? Can we prescribe that assets should have IDs because they are unique? If you have more than one of the class, then it's ambiguous which asset. Yes, I think assets should be identified uniquely by id. I would say that `id=1` is a bad id and also ill formed. ids must begin with a letter:
https://www.w3.org/TR/html4/types.html#type-id  This issue has no information. np  Most looks good, do you think it'd be better to center the triangle by default? Thanks! We can add docs, just a section in the `geometry.md` file works fine Thanks for the wait. I've updated the PR to not have to recreate the quaternion and vectors on each instance. Waiting for tests to pass then will merge!  Thanks for filing! I think it's due to https://github.com/aframevr/aframe/issues/2464 (dupe). obj-model sets a dependency on `material` component to make sure it's initialized before the obj-model...*in case it's set*. If it's not set, then it'll throw that useless warning which we should fix.

  Just writing up some API ideas here. 

***

Developers try to use `<a-animation/>` to transition between states (do X after Y), and of course it doesn't (and shouldn't) do any of that. In Unity that would be managed by a [state machine](https://docs.unity3d.com/Manual/StateMachineBasics.html), for which we currently have no construct.

But state machines are naturally declarative. They can be cyclical graphs, which the DOM can't, but let's try:

```html
<a-scene>
  <a-entity gltf-model="..."
            state-machine="#npc-state;"
            animation-mixer="clips: none;"
            proximity-emitter__far="filter: #player; distance: 20; event: far;"
            proximity-emitter__near="filter: #player; distance: 1; event: near;"
            path-finding="target: none;"
            attack-ability="target: none;"></a-entity>

  <a-state-machine id="npc-state">
      <a-state name="idle"
               default
               enter-set="property: animation-mixer.clips; value: idle_*;"
               transition__walk="on: farstart; state: walk;"
               transition__dead="on: healthchange; where: health <= 0; state: dead;"
      </a-state>
      <a-state name="walk"
               enter-set__1="property: animation-mixer.clips; value: walk_*;"
               enter-set__2="property: path-finding.target; value: event.target;"
               exit-set="property: path-finding.target; value: none;"
               transition__idle="on: farstop; state: idle;"
               transition__attack="on: nearstart; state: attack;"
               transition__walk="on: nearstop; state: walk;"
               transition__dead="on: healthchange; where: health <= 0; state: dead;"
      </a-state>
      <a-state name="attack"
               enter-set__1="property: animation-mixer.clips; value: attack_*;"
               enter-set__2="property: attack-ability.target; value: event.target;"
               exit-set="property: attack-ability.target; value: none;"
               transition__walk="on: nearstop; state: walk;"
               transition__dead="on: healthchange; where: health <= 0; state: dead;"
      </a-state>
      <a-state name="dead"
               set-value="property: animation-mixer.clips; value: dead_*;"
      </a-state>
  </a-state-machine>

</a-scene>
```

The syntax above represents the following graph:

![img_5060](https://cloud.githubusercontent.com/assets/1848368/24890795/b2a3c994-1e26-11e7-990e-9ef9f6d5c743.JPG)

A very similar pattern would apply to conversational bots, quest progress, puzzle rooms, and more. So I think this solves a generalizable problem.

Concerns here:

1. Triggering on events alone is maybe not enough. See things like `health <= 20`. I think that syntax would be helpful, but parsing it might be a chore.
2. Verbose. We could split out separate lists of `<a-state/>`s and a list `<a-transition/>`s, such that transition to `dead` wouldn't have to be repeated, and states could just list their transitions as `transitions="towalk, toattack, todead"`, but is that harder to read?
3. Every transition is triggered by an event, and that event needs to contain parameters for the next state. E.g. `target` for the walk and attack states. That feels like a weird coupling, maybe? 
4. Perhaps all of the `enter-set` / `exit-set` stuff should not be in the state machine at all. The state machine only handles transitions, and logic for behavior in each state lives in components attached directly to the entity:

```html
<a-entity attack-ability="on: attackstatestart;
                          off: attackstateend;" ...></a-entity> I have a blog post going out tmr about state machines and state management and game state in aframe that's relevant. We can have a look and compare ideas [Did some prototyping](https://github.com/donmccurdy/aframe-extras/commit/1b42ab4033f8e963b0eccea127882139a4839ba0). There's one show-stopper in the syntax above, which is that the state machine is a sibling of the entity it's assigned to, as though multiple entities were going to *share* that state machine. That doesn't work at all, because the state machine code needs to know which thing it's operating on, having multiple entities is complicated, and yeah. So with some revision:

```html
 <a-entity gltf-model="..."
           state-machine="#npc-state;"
           animation-mixer="clips: none;"
           proximity-emitter__far="filter: #player; distance: 20; event: far;"
           proximity-emitter__near="filter: #player; distance: 1; event: near;"
           path-finding="target: none;"
           attack-ability="target: none;"
           state-machine="initial: idle">
      <a-state name="idle"
               start-set="property: animation-mixer.clips; value: idle_*;"
               transition__walk="on: farstart; state: walk;"
               transition__dead="on: healthchange; where: health <= 0; state: dead;"
      </a-state>
      <a-state name="walk"
               start-set__1="property: animation-mixer.clips; value: walk_*;"
               start-set__2="property: path-finding.target; value: event.target;"
               end-set="property: path-finding.target; value: none;"
               transition__idle="on: farstop; state: idle;"
               transition__attack="on: nearstart; state: attack;"
               transition__walk="on: nearstop; state: walk;"
               transition__dead="on: healthchange; where: health <= 0; state: dead;"
      </a-state>
      <a-state name="attack"
               start-set__1="property: animation-mixer.clips; value: attack_*;"
               start-set__2="property: attack-ability.target; value: event.target;"
               end-set="property: attack-ability.target; value: none;"
               transition__walk="on: nearstop; state: walk;"
               transition__dead="on: healthchange; where: health <= 0; state: dead;"
      </a-state>
      <a-state name="dead"
               start-set="property: animation-mixer.clips; value: dead_*;"
      </a-state>
</a-entity>
```

**tl;dr** it will be good to test more alternatives and compare. I quite like this. Per-entity state seems like a necessity, actually.

But ‚Äî as you point out in the article ‚Äî the web has done really well with application-wide state, too. We certainly need some form of application/scene-wide state. This approach isn't incompatible with that. It just means for a given entity the application only knows what state it's in, not the internals of which components do what in that state. So each entity declares its own reducer, I think? Redux still confuses me... Redux takes time to grasp which is why I have sort of have a more consumable form in the second approach of the article without all the jargon. 

Entity-specific state can still be contained within the single global store, and we could select or bind with its corresponding piece (subtree) in the global store. In web apps you often have lists of fetched objects in state that get binded or assigned to respective pieces of the DOM 

I like that the general approach contrasts with finite states where each entity is in a single discrete state at a time. In the Redux-y approach, app state is a single tree of data, and any change to that tree represents an entirely new state. So rather than represent entities as separate states, we modify data about the entity and the application can react how it needs.  More flexible since we don't try to pigeonhole all the possibilities of states into single strings.

Perhaps I can refine the article to clear up my ideas with diagrams > Entity-specific state can still be contained within the single global store, and we could select or bind with its corresponding piece (subtree) in the global store. In web apps you often have lists of fetched objects in state that get binded or assigned to respective pieces of the DOM.

I agree with that, yes, a global store is helpful. But I'm not sure how an entity or component would bind to its subtree without some sort of subtree-specific syntax, e.g. what I've written above. 

> ...we don't try to pigeonhole all the possibilities of states into single strings.

I should clarify here, the state machine is very much *not* meant represent the entire state of the entity, because state won't be that discrete. For example, in addition to `idle | walk | attack | dead` states, an entity might have `inventory: manaPotion; health: 5/10; mana: 8/10;`. Those stats wouldn't be in the state machine, but do affect what the entity does when it's in, say, `attack` state.

So whether or not there is a state machine for animation, sound, and behavior modes, there is still a separate need for overall state *management* like you are proposing. My syntax is just declaratively adding a reducer to the Redux store, bound to a subtree.

The one point I don't see in the article is that IMO entity-level state is important. You may have animations and sounds associated with each state, but the `animation-mixer` and `sound` components shouldn't know about that, and shouldn't have `currentSound: run; currentAnimation: run` as separate global state entries. State should say the entity `isRunning`, and components can handle that accordingly. Posted on Slack:

> Kevin: I see states like idle/follow/attack could be boolean indicators that are pieces of the overall entity‚Äôs entire state (idle: false, follow: false, attack: true, health: 50} rather than discrete. and the entity can react anytime any piece of that changes

...

> But I'm not sure how an entity or component would bind to its subtree without some sort of subtree-specific syntax, e.g. what I've written above.

A separate "smart" component could help bind to a subtree, yeah with syntax. Could be declarative like `state.entities.0`. Or just a more ad-hoc component that reaches into the tree.

> The one point I don't see in the article is that IMO entity-level state is important. 

Entity-level state could be stored as a piece of the tree. At least in Redux, it'd be common to have specific reducers to manage individual entities or types of entities which would effectively give it its own state, but just still contained within the global store. If the state is trivial, then yeah we could use an approach like existing entity state API.

As you said, what we have in mind might be complementary, so looking forward to seeing your experiments! Will close as not actionable.

There's https://www.npmjs.com/package/aframe-state-component being used in production on large projects and it's ergonomic.

And https://www.npmjs.com/package/aframe-animation-timeline-component

Continue to come up with good stuff, but this'll all happen outside core for a while.  After checking the spec I don't think we need any of the guards in this PR since if a Gamepad is pose capable the pose attribute should always be available.  I think it means that the `pose` attribute is always present if the hardware is `capable` of providing poses (not all gamepads provide poses) regardless of the state of the controller. If pose is not defined for a tracked gamepas in any of the browsers we should file a bug against.  Thanks for filing! It's still not well supported, and since we override lots of Custom Element stuff, I imagine it being a large effort that would introduce bugs. Once it solidifies and is widely available, we could consider switching from polyfill.

<img width="1253" alt="screen shot 2017-04-07 at 12 39 15 pm" src="https://cloud.githubusercontent.com/assets/674727/24816861/4ead8748-1b8f-11e7-9614-ad611596b265.png">

There's also https://github.com/aframevr/aframe/issues/567 so I'll dupe with that.
 I understand. It's something we'll look at once there's wide support of V1. But switching from polyfill to polyfill will likely introduce bugs due to how closely A-Frame relies and overrides the current one. A-Frame doesn't use vanilla registerElement behavior.  Hand selection is automatic as per: https://github.com/aframevr/aframe/commit/cb1399eeb3df1f94d7216371d3794e0770791832#diff-a772568948cd05296a498a049c2b78adR87

So there is no need to specify a hand. I think already introducing daydream-controls into hand-controls is causing issues on how things should actually be or makes us consider cases that shouldn't happen (e.g., hand-controls doesn't make sense for Daydream). What if we removed `daydream-controls` from `hand-controls`, it would clear up the issues with this PR? I think I would remove `daydream-controls` from `hand-controls` since it implements an interaction model that does not translate well to 3DOF. I would create a separate example (laser pointer kind of interaction technique) to illustrate 3DOF controllers +1 on removing from hand-controls.

I do understand why you would want to try to include it into hand-controls, but I think the controls are sufficiently different in 3dof that it can't really be made to work.

As far as hand filtering.  I will refer to comments made in slack:

![image](https://cloud.githubusercontent.com/assets/1560884/24818389/2e33574e-1b95-11e7-827d-99f6af5968e1.png)
 As far is this PR goes.  We'll open changes to remove hand-controls as a separate PR, and use this one to address the daydream-controls hand filtering changes. r+ from me OK, just talked this through with @machenmusik:

Make default "either" and if that's the value, don't use the hand as filter criteria.

Will add to this PR code changes (not just docs).

 @machenmusik r? Let me clarify my intent as I found the existing behaviour a bit confusing in use and I don't think I have been entirely clear on what the issues are:

1.  Default handedness breaks for left handed users:
```html
<a-entity daydream-controls></a-entity>
```
This on it's own defaults to the `DEFAULT_HANDEDNESS` which is set to `right`.   This causes an issue when you use the `daydream-controls` as a _left_ handed user (and configured as _left_ handed user from daydream).  `isControllerPresent` doesn't find the controller in this case, and the controller just seems broken/non-functional.

The expectation is that the daydream-controls would correctly map the `controller.hand` and apply the correct arm model to the appropriate hand my daydream is configured to.

2. Specifying both hands is confusing (solution to problem 1):
```html
<a-entity daydream-controls="hand: left">
<a-entity daydream-controls="hand: right">
```
But this causes confusion to anyone using the controls since daydream, is of course a single controller.

This can also be confusing to handle at a application level if you need to configure content to one hand or another (since the reach is different for left and right hands).

The solution:

By specifying just the `daydream-controls`, it should default to the `controller.hand` property to set handedness.  This will make it work for both left and right handed users without specifying two elements.

We should also expose the hand through the component that is in use, so that applications can adjust accordingly based on hand.

Also, a little more thinking and comments in this PR, I agree that letting applications select a arm model using the API is not important since that can be done from the daydream settings.

 made consistent with https://github.com/aframevr/aframe/pull/2545 Thanks everybody!  I've updated with https://github.com/aframevr/aframe/commit/7ee9444539b4c7cb9a4fcd2771cfba76219d2dd2, but would like help adding links to examples (@donmccurdy know any good ones for custom materials using components?). This would be very nice to have. I haven't seen any good/simple examples, but can certainly throw a few together. üôÇ If you could, thanks! Glitches welcome :) @scottmsinger what do you mean by wrapping a three.js shader? MeshStandardMaterial is already a default A-Frame material. Do you mean injecting your own GLSL code into one of the default three.js shaders? Or using one of the existing MeshFooMaterial classes and turning it into an A-Frame component, without actually writing any shader code? Adding arbitrary GLSL to three.js's shaders is quite complicated, afaik. They're not simple shaders, because they have to account for lighting, shadows, skinning, morph targets... Anyway here's an example:

Demo: https://aframe-displacement-shader.glitch.me/
Code: https://glitch.com/edit/#!/aframe-displacement-shader
Credit: https://www.clicktorelease.com/blog/vertex-displacement-noise-3d-webgl-glsl-three-js/

But maybe an example that doesn't depend on any GLSL utility functions would be best. @donmccurdy Thanks, you're awesome! Want to add those links to the material docs?  Here's a second example, where the shader code is much simpler, but includes a component that takes a `color` property as well as the `time` uniform.

Code: https://glitch.com/edit/#!/aframe-simple-shader
Demo: https://aframe-simple-shader.glitch.me/

PR shortly.  Yeah, fuse events are synthetic so they do not count as an explicit user gesture. An alternative to using fuse is to use the Cardboard button as a click/tap event (`canvas.addEventListener('click', ...)`). Otherwise, it's a bad limitation of iOS/mobile browsers.  Thanks, I've patched the warning to log the entity. You can try it with https://rawgit.com/aframevr/aframe/14c9b5b/dist/aframe-master.min.js  This is a design decision. If we enable touch rotation in the vertical direction you quickly lose the sense of what's up and down when paired with the gyro orientation No, panning on the vertical axis is not implemented You could take look-controls as a starting point and implement your own component with vertical panning. It should not be too difficult. We focus on VR and our curent control schema assumes at least a device capable of magic window mode (gyro available)  **Description:**

I had a game state component where I wanted to just store a plain JavaScript object in the game state, via the schema. Don't need any of the HTML parsing pieces, but we could have that too.

```
schema: {
  foo: {type: 'object'}
}

// ... setAttribute('component', 'foo', {bar: 10})
```

Possible HTML form just in case, but won't be used often:

```<a-entity component="foo: {bar: 10};>```

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Closed, see https://github.com/aframevr/aframe/pull/2565  I tried the model below in your scene and it renders fine:

https://cdn.aframe.io/test-models/models/brainstem/BrainStem.gltf

There is probably something wrong with your models.  Hi @pieper ‚Äì this issue has been fixed in three.js, but the won't be released until r85. See: https://github.com/mrdoob/three.js/issues/9073

The problem specifically affects custom shaders in the glTF file. If your model is using standard three.js materials (i.e. glTF's KHR_materials_common extension) then you'll be fine. When converting with COLLADA2GLTF, that means adding the `-k` flag.  It uses the [DeviceMotion API](https://developer.mozilla.org/en-US/docs/Web/API/DeviceMotionEvent)

https://github.com/googlevr/webvr-polyfill/blob/master/src/sensor-fusion/fusion-pose-sensor.js#L220

You would have to expose the Arduino sensors through the browser using the Device Motion API (that probably requires modiyfing the  source code of the browser) or you can run a local server that passes the info to the page through WebSockets. I recommend using [stack overflow](http://stackoverflow.com/questions/tagged/aframe) for questions. The issues are for bugs and feature requests.  Thanks!  Thanks for filing! There's a PR open right now.  This contains https://github.com/aframevr/aframe/pull/2567 
Can we remove it from this one? Thanks everybody! Controller collection complete. Cross platform achievement unlocked!  **Description:**

One image was causing three requests:

1. `<img>`  in `<a-assets>`.
2. Again if `crossorigin` wasn't set and A-Frame set it for you + re-requested.
3. three.js TextureLoader

**Changes proposed:**
- Pass `<img>` element through all the way down to the Texture creation process so that three.js TextureLoader doesn't get called. All the way down, we handle string (inline URLs) vs. element (`<a-assets>`).
- Store `<img>` element in THREE.Cache if we use `<a-assets>` so three.js doesn't ever re-fetch.
- Start enforcing `crossorigin` on images because else A-Frame will have to make a second request with the `crossorigin` flag set if it's not set.
- Set `crossOrigin` on the TextureLoader just in case, we had some reports of it not working for inline URLs
- [x] tests
  Thanks!  Thanks. We've deprecated a-animation anyways. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.  Hi @oveddan ‚Äî there's some (admittedly light) documentation on the [registerShader API](https://aframe.io/docs/0.5.0/components/material.html#example-1), but you'll probably get more out of [this example](https://github.com/aframevr/aframe/blob/bbc2f0325cdd3c4bd95a69ce4ce9705b0e6a041d/examples/showcase/tracked-controls/shaders/skyGradient.js).

One thing that is lacking from the current implementation is a `tick()` method to update your uniforms. If you need uniforms other than the defaults provided by three.js, you may have a better time using a normal custom component with THREE.ShaderMaterial, as I've done in [this example](https://github.com/donmccurdy/webvr-experiments/blob/master/1-portal/components/transient-material.js).

More documentation is certainly welcome! But part of the reason we don't have it is because there's not a well-established best practice in A-Frame yet. Yeah, I think it's mostly because the API is half-cooked, and I'd prefer the component route for now. Adding documentation / disclaimers / links for that very welcome though.  thanks!  Thanks!  We can't test the 3DOF GearVR until it's released, and it's code baggage until then. Would make PR quick to test/review. The 0DOF trackpad style of interaction will start to lose relevance and in the long-term completely disappear, I'd leave it as a community feature. We're shipping sooner than that. 3 weeks is forever, and then there's the time to wait in line for the controllers and wait for shipment. Cool, thanks. GearVR's not too urgent, the controllers will take time to roll out amongst the GearVR + WebVR developer community and consumers as well. @machenmusik the controller motions are pretty laggy/slow to update.  Is the pose data coming through slow, or is this something else?  Also noticed this with the `aframe-daydream-controller` component.

Also regarding handedness.  Shouldn't this be exposed in the controller API?   The component should set that up for you. This is pretty close! :) Thanks for the patience @machenmusik I don't think it's the model.  Though I will experiment by taking it out to see if that helps to improve performance.   I'll whip up a a-frame example that works with the controller since the existing motion controls one doesn't work for 3dof. @machenmusik update:   definetly not the model.  removing it doesn't seem to help performance.  I should also mention that in-headset, the performance is good and it seems to be just the controller that laggy/slow.
 Could it be the browser not sending the pose frequent enough? OK, so some further testing.  It seems like the pose updates are just not very frequent.  I see this also in three.js examples as well.  So it's not something specific to the work here.

After some more testing, I definetly see some lag in native daydream apps as well, so it's definetly possible that it's a limitation with the controller itself.   It could be that they are doing some kind of interpolation with the pose that makes it less noticeable.

Edit:  Guess what I'm saying is that the perf issues are not something that should hold this patch back.  It seems that there is more of a general problem here to solve with the controller. Thanks! I'm going to merge this but I think we need a better example to illustrate the capabilities of a 3DOF a controller. Woo, thanks @mchen! When you have time, can you throw in some unit tests too?  Thanks!  **Description:**



Advantages:

- Single-property components are inflexible in that you cannot add a new property to the schema without having it be a breaking change. I was looking at https://github.com/aframevr/aframe/pull/2297, and I couldn't add a new prop without a breaking change.
- Less confusing having to guess if a component is single-property or multi-property, for example, is it `hand-controls="hand: left"` or `hand-controls="left"` (some controllers are single-prop, some are multi)? Is it `gltf-model="src: #model"` or `gltf-model="#model"` (some loaders are single-prop, some are multi). It's been inconsistent so I've seen people make mistakes including myself
- Less documentation about schemas in the component API (https://aframe.io/docs/0.5.0/core/component.html#single-property-schema is a bit awkward to explain)
- Reduced API surface/branching in the component API (e.g., if you do this, then it's single prop, if you specify this, it's multi prop)
- Can delete a lot of code where we check isSingleProp in a lot of places in the core component code

If we do this, then we'd need to introduce a `default` property for cases such as position, rotation, scale that designates if the component value is used in single-prop mode:

```
schema: {
  position: {type: 'vec3', default: true}
}
```

 I agree with @machenmusik better use another property name to avoid confusion when using `default` How compatible is it to delete "a lot of code where we check isSingleProp" while maintaining cases like `position` and `rotation`? That sounds good if it's feasible; in any case I like the idea of having *fewer* single-property components. Models and controls probably need to be forward-compatible with adding properties. And if we do the last part of the proposal, do we need `el.getAttribute('position').position` to access that vector, or is the value still replacing the `data` object itself? I hadn't thought about `getAttribute`...I think it's better instead we recommend being more careful with using single-prop when more properties in the future can be added and when it makes sense.  Thanks. There are ways to do triangles currently (using the existing geometry and reducing the segments), but I guess a triangle would look like passing three vertices. Fixed!  I moved the webvr-polyfill fork to the aframevr org and rebase on top of the later master
 @HalfdanJ  Can you verify that this fix your problem? we're going to want this for aframevr/webvr-polyfill#6 at least... #2700  https://aframe.io/docs/0.5.0/introduction/faq.html#why-is-the-html-dom-not-updating-in-a-frame I'm getting the same issue here.  The component updates, so the tests don't fail, but the scene doesn't update.  cc @dmarcos   Needs a rebase, unlucky someone just touched that same file! Thanks! Rebased and committed at https://github.com/aframevr/aframe/commit/33b5ec13723ce5df0c80bdb7695c180dd3ad8429  Thanks!  It works with React https://github.com/ngokevin/aframe-react

I don't know what's needed to work with Angular 2, or maybe it does work. Check out https://github.com/brakmic/Angular2_VR_Starter OK thanks for the info. from what i've heard, the angular integration has not been too hot yeah. updating that page to remove the Angular piece  Has been fixed since, thanks  Yes, this PR could be hiding the symptoms of a deeper issue. In principle the `load` method should only fire when the component is attached to the DOM and hence has a parent element We need a test case to see in what conditions the problem manifests Yeah, a unit test that fails before this PR, and passes after this PR would be perfect. We had a PR for this previously, but wanted to nail it down.  @rxl881 Can I see your code that reproduces this? OK, I think I can reproduce this in a way. Found the test cases, tweaked it to check parentEl earlier. Thanks!  **Description:**

In case you want to point to one locally.
 Yeah, but not exposed in the schema. I don't think we need anything magic, just a way to configure. Export the base URL? I'm just thinking simple: expose schema property where you provide a full URL or path. Don't have to think about what strings are added together and such. It's not too bad, you just make the URL constants into a schema property default. Users don't have to define if they don't need, but in the case they do (e.g., work offline), they can. Yeah if you want to override the model you can disable the default one and use your own model on your own higher level component specific to your application as the `hand-controls` component does or the `paint-controls` on a-painter. Most likely you will want to add logic to manage button highlights and animations Pattern at the moment is to set all *-controls to `model: false` and set model manually. We usually have an application-specific `controller` component  #2502  Thanks!  It's a design of A-Frame for better perf

https://aframe.io/docs/0.5.0/introduction/faq.html#why-is-the-html-dom-not-updating-in-a-frame
https://aframe.io/docs/0.3.0/components/debug.html#component-to-dom-serialization  Our event names don't have uppercase. Can we keep them lower cased? we could do `abuttonchanged` I'm a bit lost with all these PRs. What does this one includes?  I've tried this PR with Vive and Oculus touch and I observed a couple of problems:
1. The analog buttons (triggers in Vive an Oculus) return duplicated touchstart / touchend events on a single press.
2. The tracked controllers example only shows one hand with Vive while it works with both hands on Oculus What is exactly the problem with `gamepadconnected` / `gamepaddisconnected` ? I want to know how to report it as a bug for Firefox. Thanks!  Yeah. I can add a unit test too.  Yes, we could maybe have `el.addMixin()` / `el.removeMixin()`?  Is DK2 still supported by recent Oculus runtimes? In Firefox Nightly i see AFRAME.utils.checkHeadsetConnected() return `true` with a DK2 connected and using the following demo https://aframe.io/aframe/examples/showcase/anime-UI/.
Please reopen if this is still an issue.  Try https://github.com/ryanbetts/aframe-daydream-controller-component  I didn't include any extra information as it can be accessed directly by the target +1 for using gamepad ID rather than a new string. And if a new string is needed, we should be consistent on `-controls` or `-controller` here. I needed this feature to detect when a gamepad is connected and determine (without need to redo most of the work done already by the core components) if it's an oculus or a vive controller. 
In my particular case I needed to rotate the geometry of the gun to fit the controllers orientation differences. So I needed an event as the model could be loaded before the gamepad was already loaded.
I used `-controls` and `-controllers` to match the current components `vive-controls` and `oculus-touch-controllers`. I agree that we should define a consistent name for both, so probably we should start changin the name of these components? And even using singular instead of plural in their names?
I decided to send just the minimum amount of info because I could find the rest of info by looking at the target's componet, but f you feel that the ID could be useful too for sure we could include.
I'm open to any other proposal that could works for the same purposes.



 @fernandojsg would the example that @machenmusik points out in the codepen work for you? the @machenmusik proposal probably could works in most of the cases but I feel we're adding some extra steps that are not really necessary: adding a new component `which-controller-present` (should it be included in the core, or should we link from the aframe registry?), include that component in all the `tracked-controls` entities you want to check.
I feel it's the same if we'll create a `is-model-loaded` component and will emit a event when a `json-model` is loaded, and we should include it on every model we've loaded.
Maybe users could have also strange behaviour if this component is initialized after the tracked-controls is ready so it won't catch the events.
Probably a mix between the two approach could be to include that code inside the `tracked-controls` to remove my proposal code in each controls and emit these events directly from the tracked-controls. 
 I've updated my PR with the component code of @machenmusik included directly on the `tracked-controls` . So we don't need that extra component and it's cleaner also as we don't need to remember to include that component. What do you think? Let's make `tracked-controls` properties `id`, `prefixId` and `controller` multi valuated to avoid collisions so the controller detection moves down from `oculus-touch-controls`, `vive-controls` to `tracked-controls`. We can then emit an event in `updateGamepad` when one of the controllers we're looking for is detected (https://github.com/aframevr/aframe/blob/master/src/components/tracked-controls.js#L77) I was trying to solve duplicated code and emitting the event in one sweep. There's an easy way to emit the higher level event by passing the component to `isControllPresent` or mixing the function int the component (https://github.com/aframevr/aframe/blob/master/src/utils/tracked-controls.js#L34) My main concern with moving the logic from `vive/oculus-controls` to `tracked-controls` is that it could grow up a lot as more controllers appears isn't it? Or maybe we could refactor after a while with something like `registerController` to specify the name and how it should detect it :)

So to follow with the PR with @dmarcos proposal, we should move `checkIfControllerPresent` and `injectTrackedControls` from the  `vive/oculus-controls` to `tracked-controls` right? and the rest code should remain on each component. And so the `trackedcontrollerconnected` event will be emitted in the `injectTrackedControls` on  `tracked-controls` similar as I did on the same function but on each component. Let's do something easier. The `isControllPresent` signature will receive the component and it will manage the `controllerPresent` flag. The event wil be emitted only when the controller shows up passing the component name in the detail. We have to make `oculus-touch-controls` use `isControllerPresent` again I've modified the `isControllerPresent` to accept a `component` parameter instead a `sceneEl`. And this function will emit the event if present.
I've modified (just while we're discussing this PR, nothing definitely) the trackedcontrols example to add a listener for these events on each hand and log them. But it just keep printing forever.
Time to sleep here, but if someone have any idea, it's more than welcome ;) I've refactored the code and moved all the inject and add/remove eventlistener to a new function in `utils/tracked-controls` `checkControllerPresentAndSetup` (Any suggestion for a better name maybe?) and it's working as expected.

The test are still not passing, as in `checkControllerPresentAndSetup` I'm calling `isControllerPresent` that we were mocked previously as they were included on the component itself, but now I'm calling it directly from the utils module and I can't think on an easy way to mock it so we could return true or false so it could inject correctly the listener and the component. Any idea?
 @machenmusik thanks! I've used your implementation and it's working as expected üëç  Thank you! That's x2 bonus points for a PR that removes more code than adds.  I've a question, Do we need to call `addControllersUpdateListener` on `play` even if the controller is not present? @machenmusik ok thanks, I've just keep them by now to keep the consistency between all the controllers components, we could address that later if needed.

@dmarcos fixed the issue with the `remove/add listeners` on `play/pause` Thanks! @machenmusik I used false as I saw that we're initializing `controllerPresent = false` in all the `init` for each controller's component and that's why I used that value as default.  Can you file this on the Inspector? IMO, the Export feature is hard to make right  Thanks!  Thanks for filing. I wonder if it's an issue with the `collidable` entity not being initialized in time the raycaster does its `querySelector`, even though the raycaster should be listening for attached entities. What happens if you swap the order, or remove the `objects` check? Ah, right. Setting `dependencies: ['raycaster']` will initialize raycaster on the entity. Thus you were having a dummy raycaster not emitting events?  Thanks! I didn't think about this before, but there's no way to tell if the parser should be run in general on a default value. We don't know if the default value supplied is pre-parsed or parsed. The PR works for `vec2`/`vec3`, but that's a bit too ad-hoc.

Perhaps the proper solution is to enforce the default values be already parsed, and not allow, for example, strings to be passed as default values for `vec3`s? It's guaranteed to affect more than just `vec2` and `vec3`. I think proper solution is to enforce post-parsed default values in schemas. We can have a `validateSchema` method that performs several checks when a component is registered and throws some warnings / errors in console if things do comply like having 
````javascript
v: {type: 'vec2', default: 'ohYeah'}
```` Sorry, after reading the original issue more, I think it's OK to normalize some default values where we can. It's not often we access `schema.propertyName.default` manually anyways. Closing in favor of https://github.com/aframevr/aframe/pull/2511  Thanks!  (this never happened)  **Description:**

To configure depth testing.

In `src/components/material.js`.

http://stackoverflow.com/questions/42799420/why-is-the-opacity-different-depending-on-the-camera-angle/42822927?noredirect=1#comment72797756_42822927

  Note we currently have a couple of cherry-picked commits we need to pull in. Currently using a fork `dmarcos/webvr-polyfill#a02a8089b` @HalfdanJ thanks @HalfdanJ what bug fixes are missing? #2700  Sounds good to me. Labeled if anyone wants to grab it.  Tested. Thanks!  I guess the advantage of having them as function is that the logic to determine if the environment isGearVR, isOS, isNode does not run unless is required. These are always run though since we call them from index.js and a-scene.js. The disadvantage is that we are calling them multiple times. Can rebase this now Thanks! Love the test code deletions.  What kind of markup is that? Are you using any library? I see things being rendered. I'm not sure what you're expecting to see. Can you be more specific or provide a simpler example? `%cA-Frame:warn %cPut the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML.%c +0ms`

Put the A-Frame script above the scene.  - A-Frame Version: 0.5.0

I'm having recurring problems stemming from the `userHeight` offset in `camera`.

1. It defaults to `0`, except if you don't include a camera in your scene, in which case it defaults to `1.6`. This is likely confusing for new users.
2. One of the less-awful locomotion mechanisms for mobile users is something like `checkpoint-controls`. I would like to do one of the following:

```html
<a-entity universal-controls="movementControls: checkpoint"
          checkpoint-controls="mode: teleport">
  <a-entity camera="userHeight: 1.6"></a-entity>
</a-entity>
```

^This breaks, because the camera's offset is inside the entity being rotated. Looking down moves the camera closer to the ground.

***

```html
<a-entity camera 
          position="0 1.6 0"
          universal-controls="movementControls: checkpoint"
          checkpoint-controls="mode: animate">
</a-entity>
```

^This mostly works with mobile, but breaks with roomscale devices, and all of the checkpoints need to include this 1.6 offset as their `y` values.

***

```html
<a-entity camera="userHeight: 1.6"
          universal-controls="movementControls: checkpoint"
          checkpoint-controls="mode: animate">
</a-entity>
```

This looks better, but fails in all the same ways as the last example ‚Äì the camera is going to directly modify the position of the entity (which ideally a camera would not do...) and now the checkpoints need to somehow be device-aware and include or exclude the offset appropriately.

***

Getting into the longer discussion of #2265, but I wanted to give a concrete example of the difficulty. I'd like to be able to give people a default that more-or-less works with both mobile and roomscale, but it's not obvious how to do that without hardcoding userHeight in a lot of places. I'm not sure. I think that these methods...

```
camera.removeHeightOffset()
camera.saveCameraPose()
camera.restoreCameraPose()
```

... would ideally be in `look-controls`, not `camera`. In that case I could implement my own component that handles the height offset without worrying about a camera that mutates itself. yeah. probably look-controls is a better place for that logic look-controls is used for more than just cameras, which is why i think carving off the mutating portion into a separate component may be safer... to me, look-controls should only apply the orientation, and if there is some auto user height offset logic, that should be a separate component that can be used for that purpose (e.g. if someone wanted geometry or text to auto adjust to eye level) Fixed by https://github.com/aframevr/aframe/pull/3327  @ngokevin what do you think of the `pre` scripts? I kind of prefer to see everything explicitly defined in the command. Those pre things are kind of magical and easy to miss when trying to understand how things work I agree, I'd rather see it explicitly because they're easy to miss. Thanks though!  Thanks!  Thanks!  Thanks!  I think we'll pass on this since most editors require a specific EditorConfig plugin for this to work, not quite agnostic enough. If there's a more general way to tell editors to follow the linting rules, we can check that out.   Use `raycaster.objects` property to filter what you want to intersect. If you no longer want to intersect, then remove the entity from the selector group, and refresh the raycaster manually (`el.components.raycaster.refreshObjects()`).  In other parts of the code base we have checks `isXXX`. I prefer to keep function name consistency over grammatical correctness  Name consistency is about developer ergonomics. Thinking about it is actually even gramatically correct. `isCoordinate` actually means the variable is of the type `coordinate` I would just change `isCoordinate` to `isCoordinates` since the function is to determine if a the passed string contains coordinates Thanks!  Thanks!  Thanks!  I'm looking how we can cache `<img>` elements so that it's downloaded once and stored in the three.js Cache. But a workaround is to use `<a-asset-item>` instead of `<img>` for images. Fix under review https://github.com/aframevr/aframe/pull/2544 Try to set `crossorigin="anonymous"` on the images Works for me: https://glitch.com/~aframe-2472

P.S., there's not much point in adding to a-assets dynamically. That's for preloading and blocking. You can set the material src inline without creating an `<img>` I've updated it to be more correct. https://aframe-2472.glitch.me/

The problem is setting an image with `<img>` before its loaded. The original Glitch/GitHub issue was trying to dynamically append an `<img>` to `<a-assets>` so I was trying to work within those parameters. If you are using `<img>`, we must wait for it to fully load first, which `<a-assets>` does.

If you want to set dynamically, set inline URL on the src and texture loader will load the image first before setting.
  **Description:** 
Currently we use `requestAnimationFrame`'s timestamp as the time to be used on `scene.render`, to update the `TWEEN` and the scene itself.
The following code (https://github.com/aframevr/aframe/blob/master/vendor/VREffect.js#L186-L194) is used to detect which `requestAnimationFrame` we should call, if we've one HMD connected it will call the `vrDisplay`'s one. 

```javascript
this.requestAnimationFrame = function( f ) {
		if ( vrDisplay !== undefined ) {
			return vrDisplay.requestAnimationFrame( f );
		} else {
			return window.requestAnimationFrame( f );
		}
	};
```

The problem is that even if you have a HMD connected, it takes a while to init it so for a few frames it will call `window.requestAnimationFrame` and after that `vrDisplay.requestAnimationFrame`.
`window.requestAnimationFrame` will returns the timestamp since the page was **loaded**, but 
`vrDisplay.requestAnimationFrame` on firefox nightly returns the timestamp relative to the **first load of the browser** not the current page (@kearwood could correct me if I'm wrong here).
So that generates that jump in the timestamp that we see in nightly:
![image](https://cloud.githubusercontent.com/assets/782511/23706478/a1d26b20-040e-11e7-8f67-8fb3b09a871b.png)
We can see that:
- 0 is generated by https://github.com/aframevr/aframe/blob/master/src/core/scene/a-scene.js#L392
- Then we have 3 frames with 3xxx generated by the `windows.RAF`
- Finally `vrDisplay.RAF` jumps in and sends the, much higher, timestamp as I had the browser opened for a while.

So we have two problems:
- The jumps between these values generates incorrect deltas and can generate weird issues (Like the one we've seen in TWEEN: https://github.com/aframevr/aframe/issues/2175)
- The timestamp is typically used to control the timeline of the experience, and we're using an incorrect value for that.

So my proposal is to use `THREE.Clock` or `DATE / performance.now` directly on the render loop to be consistent across browsers and independent from the `RAF` being used.  Can you pull request that to WebVR polyfill? Thanks!  https://aframe.io/docs/0.5.0/components/debug.html#component-to-dom-serialization  should work. scripts need to be defined before a-scene.  We've removed `mergeTo` in favor of doing it manually in three.js (e.g., within a component) when needed. Instanced geometries is an alternative way to achieve the same draw call reductions. Quick resources on merging geometries in three.js:

- https://stackoverflow.com/questions/30245990/how-to-merge-two-geometries-or-meshes-using-three-js-r71
- http://blog.sandromartis.com/2016/11/16/merging-geometries/
- https://stackoverflow.com/questions/36450612/how-to-merge-two-buffergeometries-in-one-buffergeometry-in-three-js
- https://threejs.org/docs/#api/core/Geometry

We can provide more resources as we develop/evolve examples and code.

Note it probably only worked with geometry component before, not with a-obj-model.  Can we add a unit test for this?  We've removed mergeTo in favor of doing it manually in three.js (e.g., within a component) when needed. Instanced geometries is an alternative way to achieve the same draw call reductions. Quick resources on merging geometries in three.js:

https://stackoverflow.com/questions/30245990/how-to-merge-two-geometries-or-meshes-using-three-js-r71
http://blog.sandromartis.com/2016/11/16/merging-geometries/
https://stackoverflow.com/questions/36450612/how-to-merge-two-buffergeometries-in-one-buffergeometry-in-three-js
https://threejs.org/docs/#api/core/Geometry
We can provide more resources as we develop/evolve examples and code.  We've removed mergeTo in favor of doing it manually in three.js (e.g., within a component) when needed. Instanced geometries is an alternative way to achieve the same draw call reductions. Quick resources on merging geometries in three.js:

https://stackoverflow.com/questions/30245990/how-to-merge-two-geometries-or-meshes-using-three-js-r71
http://blog.sandromartis.com/2016/11/16/merging-geometries/
https://stackoverflow.com/questions/36450612/how-to-merge-two-buffergeometries-in-one-buffergeometry-in-three-js
https://threejs.org/docs/#api/core/Geometry

We can provide more resources as we develop/evolve examples and code.  Thanks! Can we line it up with the title?

# Before

<img width="1197" alt="screen shot 2017-03-05 at 3 41 50 pm" src="https://cloud.githubusercontent.com/assets/674727/23592752/6d622430-01ba-11e7-9f1e-ba8647e9f27c.png">

# After

<img width="1128" alt="screen shot 2017-03-05 at 3 41 58 pm" src="https://cloud.githubusercontent.com/assets/674727/23592744/5d9dd468-01ba-11e7-9a3d-9921107f5d9c.png">

<img width="325" alt="screen shot 2017-03-05 at 3 42 04 pm" src="https://cloud.githubusercontent.com/assets/674727/23592736/4e94136a-01ba-11e7-802f-44df1090ba44.png">
 Thanks! Still a bit off though. I use Page Ruler Chrome extension to line it up:

<img width="284" alt="screen shot 2017-03-06 at 2 24 17 pm" src="https://cloud.githubusercontent.com/assets/674727/23632953/aa544274-0278-11e7-979f-c2cffb8685d2.png">

<img width="1036" alt="screen shot 2017-03-06 at 2 24 08 pm" src="https://cloud.githubusercontent.com/assets/674727/23633001/df8fb2b6-0278-11e7-8a0d-26eb447291ac.png">
 Looks good, thanks!  I don't think it should be renamed. It's a spread pattern in the code base to have isXXX to check for the type of a value. In this particular case I would even say that it's gramatically correct since it should be read as "is the string passed of the type coordinates?" maybe adding an s at the end would be enough `isCoordinates`  @caseyyee ping here for your experiences  You can manually refresh the raycaster with `el.components.raycaster.refreshObjects()`. Can you re-post this answer to StackOverflow? Thanks!  I don't understand why `emulated` is for and why it's needed. If I cannot understand it quickly by reading the docs myself that I wrote the original controls :) I bet there will be a lot of other people that will be confused.  Some times it plays but it does not play the animation in reverse. Sometimes they get stuck in a pose. Probable causes: Models update, three.js update (maybe the animation API has changed)...
 On Firefox Nightly, the first animation always plays smoothly. But then subsequent animations are instant / snap / don't interpolate smoothly.

Another issue I have is the poses get stuck until I manually push the trigger back to its resting state. I feel after you release the trigger, the button value isn't completely at `0`. But at a value close to 0. We need to introduce a threshold.

The models are also a bit too bright. They look flat-shaded. Maybe we can make the material less shiny / reflective / darker? RE: Threshold. I meant for the Vive trigger. When I released, it wasn't all the way released, like it'd be 0.01mm off from the full resting state, so I had to pull it up to trigger a triggerup. Yeah, maybe...just a tiny threshold for what button value determines an event vs. 0 and 1. Firefox will handle the setting of the threshold now. I'm looking at this now. Here's a recording for tracked-controls example if you want to reproduce.

[recording.json.zip](https://github.com/aframevr/aframe/files/904156/recording.json.zip)
  We can force enable WebVR through the browser config on mobile to test, right?  I've added docs and made the quick update. Thanks!  I updated the docs some more because I forgot to do that when we changed the clobber logic for setAttribute, and did some style nits to the tests. Thanks!  Np, we originally did what you did, add a check, but if it's manifesting again we need to see what's really up Duping https://github.com/aframevr/aframe/pull/2521, will write a test to investigate  The camera component restores the camera pose when exiting VR. https://github.com/aframevr/aframe/blob/master/src/components/camera.js#L163
What about handling it there? @RSpace thanks for testing. I need to spend some time understanding the problem a bit better to see what is the best solution. Thanks!  Thanks!  It's helpful to be able to entities to different parents.   Currently, to do this, you need to:

1) flush entity to DOM (to preserve your entity state).
2) copy the entity.
3) add copy to new parent entity element.
4) remove the existing entity.

```js
var entity = document.querySelector('#myelement');
var newParent = document.querySelector('#mynewparent');
entity.flushToDom();
var copy = entity.cloneNode();
newParent.appendChild(copy);
entity.parentNode.removeChild(entity);
```

To do this in three.js, it's a simple matter of changing the `object3d.parent`.   DOM `parentNode` and `parentElement` are read only properties, so you cannot re-write to a new parent.  Not sure if this applies any differently to custom element/web component.

It would be nice to just:
```js
entity.parent = newParent;
```

Also welcome any suggestions for any alternative way of doing this that I may have missed.


 @caseyyee what are the use cases for reparenting you have in mind? There are `Entity.add` and `Entity.addToParent`, but then they wouldn't be represented in the DOM. Maybe those methods should check if the DOM node is not attached, and attach if so.

Use case I can immediately think of is grabbing an object and putting it in a hand's local coordinate space. Yes, grabbing and object would be a prime example of why you would want to do this.

The add method would work, but I figure you would want to keep the DOM tree faithful to the THREE scene structure.   
 We might want to wrap the methods `insertBefore` / `insertAfter` for entities I guess the quick&dirty way could works but it will recreate all the components from the cloned entity.
Ideally the three.js object could be just moved using `.parent = blabla` but the DOM moved without reinitliazing the whole stuf, but I'm not sure how to do that.
I agree that a very common use will be grabbing objects and doing just `.parent = blabla` it's the way you do typically in unity for example, as it's easy and performant. Trying to re-parent now to grab something. API Options:

- `.setParent(parentEl)`
- Moving a child to another parent: `.parentNode = anotherEl` (this could internally use `.setParent()`)
- Having a parent adopt a child: Wrap `.appendChild` to see if it's already attached, then re-parent. (this could internally use `.setParent()`)

Implementation options:

What component data do we want to keep? Do you keep local transforms? Just take original component data? Runtime data?

I might just keep it simpler and do @caseyyee's flushToDOM and copy over. Then up to application to do any processing of data. First, a simpler solution to re-parent. Doesn't take much work so I don't think we need an API. Although we can document it.

```js
entity.flushToDom();
newParent.appendChild(entity);
```

Second, @dmarcos came up with a much better idea for temporary grabbing. Move the three.js `Object3D` as a child of the hand's `Object3D`, and leave the DOM as is. When you ungrab, you can resync the DOM if wanted. I'm gonna try that out. Example code for grabbing / ungrabbing by re-parenting the Object3D:

Grab:

```js
 // World to local transform so position and rotation do not change when moved.
handEl.object3D.updateMatrixWorld();
worldToLocal = new THREE.Matrix4().getInverse(handEl.object3D.matrixWorld);
object3D.applyMatrix(worldToLocal);
```

Ungrab:

```js
// Get world transforms.
position = activePrimitiveObject3D.getWorldPosition();
rotation = activePrimitiveObject3D.getWorldRotation();

// Move object back to original parent.
sceneEl.object3D.add(object3D);

// Sync world transforms back to entity.
el.setAttribute('position', position);
el.setAttribute('rotation', {
  x: THREE.Math.radToDeg(rotation.x),
  y: THREE.Math.radToDeg(rotation.y),
  z: THREE.Math.radToDeg(rotation.z)
});
```
 I agree with @machenmusik.

There are many general cases where you want the change reflected into the DOM and not just changed on Object3D.

Maybe a more relatable example:
```html
<a-bag></a-bag>
<a-car></a-car>
```
Now put the bag into the car and drive it around:
``` html
<a-car>
  <a-bag></a-bag>
</a-car>
```

So to answer @ngokevin earlier questions:

* `setParent(newParent)` seems to fit better in terms of consistency with other API that we already have.  I feel `appendChild()` is slightly less clear.
* Ideally we keep all components and state.   I know this is harder to achieve and for now, `flushToDom()` would probably do the trick for now.
* I wouldn't make any local/global coordinate.  Though as an option would be super nice ie:
`entity.setParent(newParent, { convertToLocal: true })`

A high effort, but maybe worthwhile  idea would be to separate the DOM tree from three.js scene graph.  Doing this, would make reparenting non-destructive and give us flexibility and performance in other areas as well.  Anyways, more pie in the sky than anything else. Yeah, a nice to have. But working around or doing it manually is fairly easy. If we wanted to add DOM syncing or account for controller offsets, we could at the application-level. 

And yeah, an A-Frame implementation should separate DOM from three.js somehow. For reference, the current mode of simulating "grabbing" or re-parenting: https://www.youtube.com/watch?v=Gd-Qc9TuHZ0

Umm off top of my head, I think it's like: have a dummy object under the parent. Invert the entity's world matrix/transforms. Apply dummy object's matrixWorld transforms to entity. Or something similar. If I get around to this again, I'll post code.  How difficult to split the `emulated` changes from the `axismove` additions? I don't understand at first sight what the emulated property does. If I don't get it quickly that I wrote the original controls many other people will get confused too. `emulated` won't be used often, almost purely for motion capture replaying. Where you want to force controller event listeners to be added despite no controllers being present. Currently, we add controller event listeners regardless which causes events to be double-emitted. @dmarcos Any thoughts? Issue is when we made controls always add event listeners, controller events would double emit for hand-controls since both Oculus + Vive event handlers are attached. The proposal is an `emulated` property which controls when we force event listeners to be added. Let us know if you have other proposals (e.g., naming `forceEventListeners`, `forcePresent`), but the use case is for emulating + motion capture. It's more easy to review if things are in isolation, so we'll try not to clump non-cohesive changes together in one PR. @dmarcos still needs to take a look and understand, but the tl;dr is that we forced event listeners to be added regardless of Gamepad present in order for motion capture, but that causes doubly-emitted events (vive + oculus controls). The proposed `emulated` property will only add *all* event listeners if specifically enabled. Would you mind breaking out the `axismove` changes to another PR?  After discussing in Slack, it seems we'll revert https://github.com/aframevr/aframe/pull/2314 for another solution, so we don't need `emulated`. Thanks!  I think it's fine to not move that complexity into A-Frame. The complexity is the result of trying to have an Export feature that tries to turn runtime code into source code, which is messy.  Thanks for answering. Yes, DOM methods can be used as normal. It's up front on the introduction page: https://aframe.io/docs/0.5.0/introduction/#javascript (`We can use traditional JavaScript DOM APIs to manipulate A-Frame scenes to add logic, behavior, and functionality`).

Questions should also be asked on StackOverflow: https://stackoverflow.com/questions/tagged/aframe  Does this block #2378?

I think the caching is a moot point for now, GLTFLoader has a cache built in. In terms of preloading, agree, but it's the same situation as other loaders (OBJ and COLLADA won't pre-load their textures, either) except that glTF file can optionally have larger `.bin` resources. If someone wants to combine everything (geometry, shaders, textures, ...) into a single `.glb` file they can do that, and the COLLADA->GLTF converter supports it. So don't think this should be too critical, or least not enough to justify a special case for glTF.

If it is something we want to solve robustly, maybe we want a general model case for assets?

```html
<a-asset-item type="model" gltf-model="url(...)"></a-asset-item>
```

And if the type is `model`, the asset waits for a `model-loaded` event rather than a particular file URL. This should work for all model types, including their textures, and the `*-model` components theoretically wouldn't need to change (although `el.setObject3D()` might break...). Let's try to look into this with 0.7.0. As it is now, the `.gltf` will be cached but multiple requests get made for `.bin` files referenced by this. Probably this should be fixed at the three.js level, not here, but I'm not sure. What about inferring from the file extension and we keep the `src` API? That pre-parsing is feasible for glTF... I'm less excited about doing it for other formats like COLLADA and OBJ. Would we be comfortable only doing this for glTF? If not, and we want it to work for other types of models, I think we need some system by which `<a-asset-item/>` can actually invoke the appropriate loader, like:

```html
<a-asset-item gltf-model="foo.gltf"/>
``` > Seems to me that, assuming it's possible, the use of .glb (single file) should be encouraged if folks want to be able to preload as a generic single file?

Great point. It's not possible to convert a glTF->glb directly yet, but that should be supported soon-ish. Maybe we just recommend `.glb` wherever possible. Even for a `.glb`, the asset management system isn't behaving the way i'd like:

```html
<a-scene environment>
      <a-assets>
        <a-asset-item id="castle" src="../assets/castle/Castle.glb"></a-asset-item>
      </a-assets>
      <a-entity position="0 0 0"
                scale="3 3 3"
                gltf-model="#castle">
      </a-entity>
</a-scene>
```

In this example the scene starts presenting with just the environment visible, and the castle flickers in a second later. Because GLTFLoader parses asynchronously, presumably. I'm inclined to say we don't NEED to solve secondary dependencies of `<a-asset-item/>` `.gltf` files yet, but we should have a better story for loading a `.glb` ideally. Waiting until a `.glb` has parsed would probably fix the first case anyway. There are now multiple tools (https://sbtron.github.io/makeglb/, https://glb-packer.glitch.me/) for packing glTF files and their dependencies into GLB archives, so I don't think we should do anything special for `.gltf` here.

As mentioned above, it would be ideal if there were some way to ensure a `.glb` (or other model) can hold the asset system until it _parses_, not just until the content is downloaded, because parsing may not complete for several frames. Renaming the issue accordingly.  Constants are supposed to be internal to core. I would not like to expose them unless there's a good reason to. @kellyselden What's exactly your use case? Can you be more specific on what *keeping your app in sycn with upstream changes* mean? @kellyselden You can access the default value before initialization like this: `AFRAME.components.camera.schema.userHeight.default` Can you use `cameraEl.getAttribute('camera').userHeight` to get the value? Sorry for the circles. I think given there's no good way to grab the value, we make constants public, but be careful about what we place in the constants folder. We can have a constants index.js that exposes public things. If something needs to be private, then constants live within their own modules or directly require constant files. 0 is the default for the camera component, but 1.6 is the default for the default camera.  @xgqfrms-GitHub welcome! Yes, it is a custom element based on [newer web APIs](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Custom_Elements). Much of A-Frame's syntax involves using elements like `<a-entity />` or attributes like `<a-entity foo bar />` to create relationships between [THREE.js](https://threejs.org/) objects. For example, `<a-scene />` is closely related to [THREE.Scene](https://threejs.org/docs/?q=scene#Reference/Scenes/Scene).

The [FAQ](https://aframe.io/docs/0.5.0/introduction/faq.html) and [Slack](https://aframe.io/community/#slack) are good options for learning more.  Thanks! Almost done! @machenmusik yes I know that there's a few incosistencies but I always push in reviews to use the past participle as event names. The DOM event names are totally inconsistent Yeah! I don't like the harcoded relationship axis0 / axis1 to `trackpad` either. We should use the mapping object somehow. @machenmusik @cmvanp I'm merging this patch but feel free to come up with an improvement @cmvanb Thanks and congrats for your first patch!    We now do a warning https://github.com/aframevr/aframe/issues/2511 if the default value doesn't match the type rather than trying to force parse. Thanks Damon!  Unfortunately, that would increase the size of the JS. It's easier for now to document and read it externally on the READMEs, which the Inspector can one day consume if we enforce and curate the format for the README. Auto-generated documentation usually adds more maintenance work while producing less friendly docs.  A very convenient scenario for handling 3d scenes could be having **all** the objects in the scene saved in just one 3d file (obj, json, gltf,...) with the objects inside the scene properly named. So there would be just one file to load, just one `<a-asset-item>`, simplifying also all file handling and workflow. 

For this to work, we would need a way of assigning the objects from the scene to individual entities. Something like this could be nice:

```xml
<a-assets>
  <a-asset-item id="room" src="room.gltf"></a-asset-item>
</a-assets>

<a-entity model-object="from:#room; obj:chair"></a-entity>
<a-entity model-object="from:#room; obj:table"></a-entity>
```

Is there anything like this available already?

 +1, there was a similar question on SO: http://stackoverflow.com/questions/42074856/aframe-clone-object3d-within-entity/42076326?noredirect=1#comment71360013_42076326

Probably an external/registry component for starters? Should be a property of the obj-model, gltf-model... or agnostic to those? Agnostic I think, not aware of any format-specific needs. Yeah, once the model is loaded and in a THREEJS object, we can extract any object in an agnostic fashion.

@donmccurdy yeah, something like that component. Do you think it is such an edge case that should not be in core? I'm happy either way. Maybe I'm not familiar enough with modeling workflows to know if bundling assets into a single file is common/useful.
 We should differentiate the uses where you want to clone the object or just use a reference to it Could this be a good feature for `0.8.0`?. Once a model is loaded there's a lot manual work to do to manipulate the model (change textures, access sub models, animate...) and A-Frame is not making it easier to deal with them. There's an opportunity for us to provide a convenient API to manipulate models after they are loaded (obj, collada or gltf). @feiss idea was that any component can define an `onModelLoaded` method that gets called whenever a model loads on the entity. a `model` object is passed as an argument that contains an convenient API for manipulation either declarative like the one originally proposed (https://github.com/aframevr/aframe/issues/2408#issue-208426083) or imperative like:
  - model[name] to access sub objects.
  - model.setLambertMaterial(selectorObj, lambertProperties) > Once a model is loaded there's a lot manual work to do to manipulate the model (change textures, access sub models, animate...)

Could we collect a list of these use cases somewhere, in a bit more detail? I'm not sure I have a good enough handle on them to propose an API. A few comments on these specific items:

- **change textures** ‚Äî this is definitely something users ask for a lot, but, i think many don't understand how UV wrapping works... if we give them this API, is it just going to be a footgun?
- **access sub models** ‚Äî +1 for doing something here, although not sure yet whether it belongs in core.
- **animate** ‚Äî i think this is all set? we could move `animation-mixer` into core if that helps, but note it doesn't work with COLLADALoader.  > I consider accessing sub objects pretty important. It would allow users to pack all (or many) objects in just one scene, so it can be much more convenient both authoring the assets and loading them (with the additional benefit of having only one request). 

+1 on this, I agree. Although, there are at least two use cases, that might require different implementations:

1. After loading a model, unpack all children into new (A-Frame) entities in the scene. User can then use raw JS, (or Blender custom properties?), to apply components to each.
2. Before loading a model, user declares entities that should pull specific things out of that model (for example, the original post in this thread).

If either should be in core, I think it would be (2). I've implemented (1) at times as well, but maybe that is more niche.

> Adding a lightweight abstraction API of threejs tightly coupled to the A-Frame component structure

I'm more nervous about this. The three.js APIs are already a fairly high level abstraction around WebGL. And, I think it's a benefit not a drawback that you wind up writing three.js code (and using three.js docs + stack overflow) when working with A-Frame. Most of those things can be done fairly cleanly with three.js. The `fadeIn`/`fadeOut` methods are an exception, but I think that's a case for considering new imperative animation APIs rather than new abstraction on top of three.js. Good points. The distinction about re-creating the hierarchy is interesting. I've avoided that when trying this in the past (nesting is a problem with physics, which was my use case). But other users might want to preserve their model's structure. I've done https://github.com/ngokevin/kframe/tree/master/components/gltf-part#aframe-gltf-part-component for my own needs three.js: `mesh.getObjectByName('whatever')` would be awkward if the hierarchies don't match up. So perhaps if you use my part component, and have another component that generates an entity for every single part. And then attach components afterward? I think there will be lots of different use cases for this, probably not possible to have one component that does it all... Seems best to just make components as the need comes up and figure out what works well.  Good catch!  https://github.com/jpchase/OriginTrials/blob/gh-pages/developer-guide.md
 I submitted a token request @RSpace saw [your comment](https://github.com/aframevr/aframe/issues/2444#issuecomment-297645014) in issue #2444, thanks.

I did some tests, and when the `chrome://flags#enable-webvr` flag is enabled, the A-Frame examples do work for me with mobile Chrome (release channel M56 + M57) and Chrome Canary ("nightly" builds). Let me know if you're seeing something else. Thanks!  Duping with https://github.com/aframevr/aframe/issues/2472

I have looked at this issue a couple times, but will fix soon, it's an important bug  Can you provide the web console output using the broken build?  Cool. Yeah, adding `<a-asset-item>` should work.  ‚Ä¶of the material the texture is removed (fix #2388)

 @machenmusik @ngokevin alternative to https://github.com/aframevr/aframe/pull/2393 @machenmusik what about now? A bit more clear? This code is overly complicated and difficult to understand and maintain. I'm looking for opportunities to improve it.   Thanks!  **This issue opens following discussion:**  
**Would it be useful to have scheduled A-Frame hangouts/meetups for collaborators.**

Take-away from our Skype call and discussion (15th Feb), following questions were raised and best way to stress these is to have open discussion here. We need to determine whether we need or can gain something from such hangouts and what benefits that would bring for A-Frame release life-cycle. Currently A-Frame development discussions take place in [slack](https://aframe.io/community/#slack), under github [issues](https://github.com/aframevr/aframe/issues) and some face-to-face which has so far proven to be fairly productive in general and therefore questions and discussion here are to cover only the extra values what such meetups could bring. We reserved [9:00 am - 10:00 am Wed, Mar 1 2017](http://bit.ly/2l8YagC) to have our first hangout however date and time may change! After all goal of this issue here is also to determine format, schedule, agenda, time for first hangout.

**Questions to be answered**

- **What would be primary objectives for such hangouts**
take-away proposals from our session
  - Focus small pre selected subset of targets for upcoming release
  - Having productive and organized discussion about the roadmap
  - Discuss high priority issues
  - Discuss open pull requests
  - Discuss  short term goals of A-Frame e.g next version
  - Discuss long term goals of A-Frame e.g v1.0.0
  - Discuss features/issues to drop from milestone
  - ...

- **How often should we have such hangouts**
proposal was once a month

- **What would be the duration of the session**
proposal was 1 hour

- **What would be the agenda**
Agenda should be fixed here as result of open discussion .
  -  one of the ideas was to pick 5 topics before hangout and assign each topic to different person who leads the subject to be covered within 10 minutes during the session. these 5 topics can be anything specific issue, PR feature etc.

- **What would be the best weekday and time for it**
This is totally open and we should find the week day and time so that it would be possible to join as many interested participants as possible.

**Waiting for your proposals, ideas, suggestions and everything else related to the topic.**

  Can we add unit tests? Both for `setAttribute('material', 'src', '')` and `removeAttribute('material', 'src')`. Thanks!  Pretty sure i've answered this question half a dozen times in slack, but i can't find any permanent FAQ or documentation for it.

Summary of points to cover:

1. Check the console for errors or warnings (CORS, parsing errors, etc.)
2. Open the `.mtl` file and make sure that paths to textures are relative, not absolute.
3. ??? *BEGIN DRAFT*

**Troubleshooting a 3D model**

3D models are created in many different programs, exported to different formats, and often have problems that will show up in some viewers (e.g. A-Frame or THREE.js) but not in the editor that created them (e.g. Blender).

Steps for troubleshooting a 3D model:

1. [Open the JavaScript console](http://webmasters.stackexchange.com/a/77337) and check for any errors.
2. If you see an error related to CORS, the file is not correctly hosted. [Set up a local server](https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server) to resolve this, or use a free hosting option like [Neocities](https://neocities.org/).
3. Try opening the model in a good native application, like [FBX Review](http://www.autodesk.com/products/fbx/fbx-review). If the model works in FBX Review but not A-Frame, it's likely that something about the model is not supported by THREE.js loaders. Try converting to a different format, or searching for bug reports on the [THREE.js issue tracker](https://github.com/mrdoob/three.js/issues). If an OBJ, COLLADA, or FBX model cannot be opened in FBX Review, the file is probably corrupt.
4. If there are no errors, but you see nothing: The scale of models are often very, very large in comparison to the camera. They might be 1000 times bigger than the user such that the user is inside the model and cannot see it. Try scaling it down scale=".001 .001 .001" and see where it is. The A-Frame Inspector (<kbd>ctrl</kbd>+<kbd>shift</kbd>+<kbd>i</kbd>) will help with this.

Format-specific issues:

**OBJ/MTL** ‚Äî MTL files often have incorrect paths to textures. Open the MTL file in any plaintext editor and look for absolute paths (`C:\\foo\bar\baz.png`) that should be relative (`bar\baz.png`).

**FBX** ‚Äî THREE.FBXLoader supports only ASCII FBX files, not binary.

***

*END DRAFT*

Patched together from various SO posts:

- http://stackoverflow.com/questions/40433713/why-does-my-obj-mtl-model-material-show-up-as-black
- http://stackoverflow.com/questions/38740086/why-is-my-model-not-loading-with-a-frame
- http://stackoverflow.com/questions/42149435/a-frame-obj-mtl-why-i-do-not-see-anything Sounds good. We need a standalone guide for `Adding Models` which this would fit in well. After I filed this issue, we have added a troubleshooting section to the docs: https://aframe.io/docs/0.5.0/introduction/models.html#troubleshooting

So it's not in the FAQ, but the content is there. I think this can be closed. But we could also add a link to this content from the *Why does my asset (e.g., image, video, model) not load?* section maybe.  Copied from Slack:

<img width="987" alt="screen_shot_2017-02-15_at_9 37 56_pm" src="https://cloud.githubusercontent.com/assets/1848368/22983322/bb394598-f36f-11e6-995a-aaa2dc5b2a55.png">

^There is no actual `cursor` component there, but regardless we should implement the `remove()` function. Just detaching the entire element should work in the case above. @codechikbhoka thanks. do you want to open a PR? i can grab this unless someone has started sure  Hi @lennerd ‚Äî A key distinction between A-Frame and React is that A-Frame doesn't require use of a bundler ‚Äî most of our users are probably loading A-Frame as a `<script src="..."/>` from CDN, and are often unfamiliar with more advanced JS tooling. My vote would be to avoid introducing separate production and development builds, because for many users just opening the JS console is an "AHA" moment. If there were a fork, development should be the default in our documentation.

Omitting unused portions of `package.json` sounds very reasonable. Perhaps we could consider moving from Browserify to Webpack or Rollup (I believe the latter two support tree-shaking?).

As a baseline of discussion, v0.5.0 weighs in at:

- 1,100kb minified.
- 283kb gzipped.

Of that, THREE.js is responsible for about half:

- 504kb minified.
- 128kb gzipped. Sounds good. Experimenting with the build seems like the right first step, especially if we can compare sizes of the resulting binaries. Webpack is more popular ofc, but Three.js recently switched to Rollup so I'm curious what that's like.

(And will need to defer to @ngokevin or @dmarcos for final say) We'd have to narrow down exactly what we'd be able to shave off, if anything, if we moved to Webpack. In A-Frame, schemas primarily define **parsing**, not validation, and even then the code is extremely thin for that.

As Don said, React is a different ecosystem where you're pretty much mandated to use build tools. Even though you could theoretically do it, no one uses React without build tools. I'd be interested in seeing the build size comparisons, and I do prefer Webpack, but I don't think you save much size besides the tiny overhead for each module. 125kb savings sounds promising so far! Took a look through the minified code and have a couple more ideas. Haven't verified much of this, but it looks like:

- [ ] package.json, 3.3kb
- [ ] 2 videos, 6kb and 3kb (one is used for wakelock, maybe?)
- [ ] 3 implementations of `isMobile` total size 7kb
- [ ] 4 SVGs, mostly small but the largest is 52kb.
  - the 52kb one is definitely worth looking into..

Other things we're already considering deprecating and moving into separate repos:

- [ ] THREE.ColladaLoader (??kb)
- [ ] tween.js (6kb) + `<a-animation/>` code (??kb)
 One thing I would like to comment on this. While reducing the size of the build is important we have to evaluate how much energy is worth investing on it. The size of the assets that the average VR application is going to load will make a-frame build size negligible in comparison. For instance, The vive controller model weights already 1.5 MB from the obj and another 1.X MB from the textures (https://github.com/aframevr/assets/blob/gh-pages/controllers/vive/vr-controller-vive.obj) and that's just a single asset :-) Certainly there's a point of diminishing returns; i'd agree 3-5kb changes are probably not worth conditional logic in normal/minified builds. But if webpack shaves 125kb, that's relevant to mobile users. 50kb of SVG is similarly suspicious. Want to deal with just those two?

To be honest, I think 1.5MB is too much for the vive controllers, too. That's >30,000 tris before you've even added any content to the scene. And it's <600kb after conversion to glTF. üò¨ The vive controllers can indeed be optimized. It's an example illustrating that just a couple of assets will make the build size responsible for just a tiny fraction of the loading time. In an asset heavy medium I would not go out of our way to optimize the build size of a-frame. Webpack enforcing workflows and tooling into our users is another cost that has to be factored in. I would look first on cheap ways to improve our build size without replacing the tooling @lennerd Can you provide more info about your particular use case? How big is the a-frame build compared to other assets that your average embed loads? wontfixing as it's hard to go from here, but can look at PRs for smaller, more specific changes if anyone wants to do. considering the size of A-Frame is equivalent to an image, KBs here and there aren't as weighted as they would be on a normal 2D page's expectations IMO  @a-frobot docs-v0.5.0  Looks a lot like this error: http://stackoverflow.com/questions/34662574/node-js-getting-error-nodemon-internal-watch-failed-watch-enospc

I don't know if the accepted answer will work on Solus. If that is the problem, perhaps we can exclude some directories (\*cough\* node_modules) from the filesystem watch?

EDIT: Better link: http://stackoverflow.com/questions/16748737/grunt-watch-error-waiting-fatal-error-watch-enospc @beautifulmind looks like a permissions issue in your case, perhaps this? http://stackoverflow.com/a/16151707/1314762 

(based on the `npm ERR! Error: EACCES: permission denied` line.)

EDIT: Ah, sorry not exactly as written there. You need ownership of the current directory, so:

```
sudo chown -R $(whoami) .
```  We would have to write the exif header in JS. I actually wrote a parser / writer in the past (https://github.com/mozilla-b2g/exif-parser) but It might be overkilling to make it a dependency of aframe core If you want to do it in browser you have to be able to parse and write exif data. You can always download and add the meta data offline (http://www.sno.phy.queensu.ca/~phil/exiftool/)  @Stefie The commit referred by the `package.json` indeed exists https://github.com/dmarcos/webvr-polyfill/commit/a02a8089b which is the same as https://github.com/dmarcos/webvr-polyfill/commit/a02a8089 In git you can refer a commit by just a unique prefix
I can't reproduce the issue on my desktop machine. Can you somehow share a link where the error manifests? Cool, thanks! Anyone knows the procedure to update the polyfill hosted on https://storage.googleapis.com/cardboard-dpdb/dpdb.json ? Does any one know who's the point of contact? I don't mind hosting a `github.com/aframevr/dpdb.json` repo that people can submit PRs against. I want to make sure it's not going to be confusing #2700 fixed  Thanks  We've changed to use THREE.Clock to keep track of time to fix Nightly weird timestamps in the requestAnimationFrame to fix this.  **Description:**

1. Add an event listener to a controller (`gripup`) in the `showcase/tracked-controls` example.
2. Add a console.log in the event listener.
3. Open the scene and press the button. 

See the log shows up twice.

- A-Frame Version: 0.5.0
- Platform / Device: Vive / Windows / FF Nightly

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Probably. Need to poke around to think of the best solution. @dmarcos would know best. Maybe introduce a property to force event listening that will be disabled by default, but enabled by replayers. 

What I don't think will work is trying to detect whether a different controller exists, that might be messy. https://github.com/aframevr/aframe/pull/2556  3. sounds good to me. [Context for the change in r84](https://github.com/mrdoob/three.js/pull/10500#issuecomment-270354703).

I also like (3). Should responseType be set automatically, or do we just document that it needs to be done for glTF? 

GLTFLoader has an internal cache, sort of, so disabling THREE.Cache for `gltf-model` only might be a 5th option. > 1. Why does a-asset-item call THREE.Cache.files[src] = responseText;

I have no idea ‚Äî seems fine to change that, as long as we set `THREE.Cache.enabled = true` somewhere.

> 2. In a-assets.test.js this var XHR_SRC = 'base/src/README.md'; is the path to non-exist file.

I also have no idea. üòë 1. was from https://github.com/aframevr/aframe/commit/5728902d29cc73b12269f41d5417ae92ab63ae77

You can try to remove, I don't quite remember, but I might have been running into issues where it didn't exist in the cache in time the A-Frame code ran.   ```
 0
down vote
accepted

After a lot of messing about, I discovered that a lot of my issues were due to trying to test in the simulator.

When running on the device I was able to get an app running the latest version of a-frame working with the latest version of react-native, but only by setting up react-native to recompile the android project from source java, pulling from the current master.

I also had to enable hardware acceleration in the Android.Manifest.

Thanks to Chris Chen for the assist

```  Thanks!  thanks!  **Description:**

https://github.com/aframevr/aframe/pull/2370 Firefox is going to check the string to be consistent with Chrome Using the string to identify controllers cannot be a long term solution. We have to come up with a better way. It might require changes in the Gamepad / WebVR APIs Closing for now as everything works, the prefix seems a bit more flexible. We can reevaluate strings later on.  This looks good to me.  When a system and component are registered with the same name, the schemas are merged. Additionally, an instance of the component is created on the scene (as well as an instance of the system). Is my understanding correct, that systems are intended to support configuration on the scene element?

([JSFiddle](https://jsfiddle.net/donmccurdy/wnL5g1ux/))

```html
<a-scene transmogrifier="systemProp2: false">
  <a-entity transmogrifier></a-entity>
</a-scene>
```

```js
AFRAME.registerComponent('transmogrifier', {
  schema: {
    componentProp1: {default: true},
    componentProp2: {default: true}
  },
  init: function () {
    console.log('component.init: ', this.el.tagName, this.data);
  },
  update: function () {
    console.log('component.update: ', this.el.tagName, this.data);
  }
});

AFRAME.registerSystem('transmogrifier', {
  schema: {
    systemProp1: {default: true},
    systemProp2: {default: true}
  },
  init: function () {
    console.log('system.init: ', this.sceneEl.tagName, this.data);
  }
});
```

Result:
![screen shot 2017-02-08 at 6 55 58 pm](https://cloud.githubusercontent.com/assets/1848368/22763009/502914c0-ee30-11e6-8024-8f74ac01de72.png)


- A-Frame Version: v0.4.0
- Platform / Device: All Thanks for the detailed issue. There's also https://github.com/aframevr/aframe/issues/1945 Scene should discern system vs. component. It is intended/documented to configure the system and not create a component (https://aframe.io/docs/0.4.0/core/systems.html#properties) but clearly a component has been created here :) Yeah, systems actually are configurable on the scene (although updates currently don't work, needs a bit of a refactor). I'm going to keep poking at shadows if someone wants to look at this.

I think we have the scene wrap `initComponent` (https://github.com/aframevr/aframe/blob/master/src/core/a-entity.js#L339) to do a check to return if it's a component and a system is registered. If everything is OK, call initComponent as normal. Yeah, the documentation is out of date on that part. We can add a section about that. Should we say that components that have a system are not applicable to `a-scene`? Yeah. If there's a system, then the scene can't have the component form. There won't be a case where you want both the system and component on the scene because in ECS, the components apply to entities and systems are global like the scene. They might get extra features later on like lifecycle methods to manage subscribed entities. They are global singletons. They get initialized first. But the API itself is mostly the same as a component. I'll take this.  Thanks!  This should be fixed now that we listen to `onvrdisplaypresentchange` event  Filed at aframevr/a-painter#183, should be improved now  Mixins are just for components. You can have a component set whatever you need. The template component also accepts component names that act as data contaners.  the intent was not to make `a-video` a 1:1 mapping of the `video` tag. `a-video` creates a quad with a video texture applied to it. There are no controls and not sure if attributes like `playsinline` make even sense in the context of VR  Nice! Thanks for investigating. I'm going to do some testing on my side Seems the workaround is still needed, despite that issue being closed:

> Ok, this is now busted if BUFFER_SCALE is not 0.5. Seems like another iOS bug, which gets resolved if you set the size of the canvas to the same thing. - boris Rebasing the PR, and added tests. Will merge once it's green.

Tested on iPhone 6, iOS 10.

## Before

![img_4573](https://cloud.githubusercontent.com/assets/674727/22667149/602a8816-ec70-11e6-8037-6d44ab545d63.PNG)

## After

![img_4574](https://cloud.githubusercontent.com/assets/674727/22667148/6025eec8-ec70-11e6-8c45-8c8c6f3e038c.PNG)



 I actually don't see a difference on my iPhone 6, 10.1.1, even with https://github.com/aframevr/aframe/pull/2345 ... perhaps it's more discernable on a Plus. I'll let @dmarcos take a final look, or @giordyb can you post before/after screenshots? It does the trick for me on an iphone 7 Plus:
## Before
![img_3332](https://cloud.githubusercontent.com/assets/39342/22672380/644ce8cc-ec88-11e6-8990-8f774e602803.PNG)
## After
![img_3331](https://cloud.githubusercontent.com/assets/39342/22672379/644c7a40-ec88-11e6-816d-9cded0680d13.PNG)  Android throttles or provides high-latency access to the accelerometer/gyroscope sensors. This is probably pronounced as performance drops. If you are using lots of boxes, there are techniques to improve performance:

The performance doc mentions [geometry merging](https://aframe.io/docs/0.4.0/introduction/best-practices.html#performance)

Or use three.js geometry instancing (there are some WIP components by @takahirox to enable this): https://threejs.org/examples/webgl_buffergeometry_instancing.html Unfortunately, we should lower expectations on what non-WebVR enabled devices can provide. With non-WebVR devices, we are literally polyfilling proper WebVR head pose data using Device Motion API. Official WebVR-enabled devices provide data directly and optimized through the WebVR API proper. 

While many Android devices today are OK for tinkering for newcomers to at least play with, many of them will exhibit non-smooth tracking (as seen since you have 60FPS but bad jitters). 

The code relevant is at https://github.com/googlevr/webvr-polyfill   **Description:**

Fixes #651.

Migrates [shadows from aframe-extras](https://github.com/donmccurdy/aframe-extras/tree/master/src/shadows), with a few changes to the API. Example includes shadows on the "Hello World" example, but we should probably come up with something more interesting.

Some of the shadow properties are non-default; this has worked better so far (from various bugs filed against extras) but perhaps we want to be consistent with THREE defaults instead? In any case, tweaks to the shadow camera properties are going to be par for the course on any serious scene.

**Changes proposed:**
- Add `shadow` component, which recursively enables cast/receive on child geometry. Note that it is recursive and on by default.
- Add shadow properties to the `light` component, for supported types.
- Add shadow setup to the `light` system. The shadowMap is enabled automatically, and not exposed in schema, but the shadow type can be set with `<a-scene light="shadowMapType: pcfsoft">`.

/cc @fernandojsg @takahirox
 Oops I forgot. Added! > Just curious to know if we can dynamically enable/disable shadow after scene is rendered once?

Programmatically, yes: `sceneEl.systems.light.setShadowMapEnabled(false)`. Systems don't support updates right now, so there's no pure-HTML way. Any tips on tuning the shadows?

**Single Point Light + Torus Knot**

Point light in the center of the knot. Boxy shadow shapes.

<img width="647" alt="screen shot 2017-02-06 at 6 56 00 pm" src="https://cloud.githubusercontent.com/assets/674727/22676034/f780c2fc-ec9d-11e6-9fe6-cdd29083338a.png">

**Directional Light + Point Light**

Trying to animate the point light, spinning around the scene. Point light casts odd shape for the cylinder at an odd angle. Do I have to tweak `light.angle`?

<img width="856" alt="screen shot 2017-02-06 at 6 53 06 pm" src="https://cloud.githubusercontent.com/assets/674727/22675970/83b43354-ec9d-11e6-861a-e3e10dfe36fa.png">
 I continued playing around. Got it looking a bit better, but doesn't look as smooth as the [three.js shadow + point light example](https://threejs.org/examples/#webgl_shadowmap_pointlight), even though I've cloned all the parameters.

https://github.com/ngokevin/aframe/commit/958fdfc2b2cfe37508951dbc439f88ad81dc4cab

<img width="965" alt="screen shot 2017-02-07 at 3 30 08 pm" src="https://cloud.githubusercontent.com/assets/674727/22716319/53c0d32a-ed4a-11e6-8e2d-5afd2ddf58fd.png">

I also added some meshes (sphere, box, cylinder), the shadows seem clipped and in a weird spot despite playing the shadow camera top/near/left/right and map width/height
 Re: tuning, I think scene dimensions are very much a contributor to how your camera parameters should be set. Not really sure how to optimize that. I've just pushed a `shadowCameraVisible` option that is helpful for debugging.

Directional lights will perform a fair bit better than point lights, as well. Still playing with the shadows. The camera helper really helps, I saw the camera was totally not where I expected it to be. Should we start adding baseline tests and docs? Tests added. Was trying to get rid of some shadow clipping and debugging why my shadow camera was not lined up with my light, but playing with the shadow parameters from the Inspector doesn't have an effect. Are the updates working? Will save this for 0.5.1 until I get a good handle on it and document the tuning process. Sounds good. I've fixed the updates ‚Äî there were a couple more hoops to jump through for updating the shadow camera and cameraHelper. Also removed `shadowDarkness`, which isn't supported anymore.

EDIT: But updates to the system configuration will not work, which seems OK for now. Added a first draft of documentation. I'm not attached to the structure really: there's no *Systems* category in the docs, and most of the properties are on the `light` component, so that's where I put most of the documentation. Perhaps a post in the *Guides* section would be more appropriate?

We should probably also link to something explaining light baking, but I'm just learning that process myself. Rebased, and reverted temporary changes to the hello-world example.

Any more to do here? Should an example be part of this PR? Thanks, this is my next priority. I have that example I was doing to copy the threejs example, if you have any cool ones we can add that too We can cherry-pick this example for now: https://github.com/ngokevin/aframe/commit/958fdfc2b2cfe37508951dbc439f88ad81dc4cab

I had *much* better and expected results setting `shadowCameraFov` to 90. With the help of the Inspector. I added an example, changed defaultCameraFov to 90 for better point lights.

Dynamic schemas we could do in a follow up.  We've removed mergeTo in favor of doing it manually in three.js (e.g., within a component) when needed. Instanced geometries is an alternative way to achieve the same draw call reductions. Quick resources on merging geometries in three.js:

https://stackoverflow.com/questions/30245990/how-to-merge-two-geometries-or-meshes-using-three-js-r71
http://blog.sandromartis.com/2016/11/16/merging-geometries/
https://stackoverflow.com/questions/36450612/how-to-merge-two-buffergeometries-in-one-buffergeometry-in-three-js
https://threejs.org/docs/#api/core/Geometry

We can provide more resources as we develop/evolve examples and code. I made a geometry merge component: https://github.com/ngokevin/kframe/tree/master/components/geometry-merger#aframe-geometry-merger-component  Can't you override the styles A-Frame sets with CSS? It's for fullscreen purposes. If you want to allow `embedded` scenes `<a-scene embedded>`  Based on the screenshots and example video, the WebVR emulator ought to emulate both eyes. Clicking the toggle VR button in an A-Frame scene goes fullscreen, instead.

Not sure if that's something about how A-Frame detects the HMD, or if Jaume's examples were using the polyfill instead, but it would certainly be helpful for debugging if the extension were A-Frame compatible. At the very least, I don't think clicking the *VR goggles* icons shoulder enter Fullscreen mode. There were a couple issues filed about adding a separate `Fullscreen` button, tweaking the `Enter VR` button. But, now I see that the tooltip text (even `alt`/`title`) text is now gone (per #1432) - even further misleading folks. Without context, upon loading an A-Frame, it's completely unclear that:

1. If on desktop and mouse-drag controls are enabled, that I can drag my mouse and pan around the scene.
2. I need a VR headset (or a mobile-polyfilled iPhone/Android headset) to interact with the scene.
3. Clicking the icon for the VR googles triggers Fullscreen mode when a browser does not natively support WebVR.

Suggested fixes:

1. A-Frame includes icons, tooltips, and helpful UI hints to indicate the camera controls.
2. A-Frame indicates on the page the system and device requirements to experience "immersive VR."
3. A-Frame exposes additional buttons (or tooltips) based on system/device capabilities.

See this screenshot of Facebook's UI indicators for its embedded 360¬∞ video support:

<img width="531" alt="screen shot 2017-02-04 at 3 03 44 am" src="https://cloud.githubusercontent.com/assets/203725/22618004/d60a2a8c-ea86-11e6-9874-0fd6e5efb8af.png">
 A-Frame used to display text in a tooltip upon `:hover` of the "Enter VR" (icon of VR headset). I suggest we add some helpful text or graphic (√† la the [Facebook example above](https://github.com/aframevr/aframe/issues/2347#issuecomment-277435874)). > I use the last version chrome mobile browserÔºåand it worksÔºÅit seem to some browser does not support the VR presentation any more.

Which other browsers are you referring to? probably should be filed on the emulator, not sure if it's used much considering look-controls/wasd-controls (or orbit-controls) pretty much does the same thing  dupe https://github.com/aframevr/aframe/issues/2322  Good catch!  +1 for having something like this in the FAQ.

Similar passage going into # 2333 ‚Äî [gltf-model.md](https://github.com/aframevr/aframe/pull/2333/files#diff-65cb6350cb8b140f4af98738e4059465), perhaps we can consolidate and have one guide with more detail. May also want to link to `json-model` / `object-model` if they're going to be mentioned. Sounds good, although the answer might be incomplete (i.e, should mention some things about glTF and the advantages/disadvantages of all). Though it's better for docs to repeat itself because people don't read every page. thanks for the contribution! üëç per @ngokevin's comment above, could you mention [`glTF`](https://en.wikipedia.org/wiki/glTF)? > Sounds good, although the answer might be incomplete (i.e, should mention some things about glTF and the advantages/disadvantages of all).

I would mostly follow after what @donmccurdy wrote at https://aframe.io/docs/master/components/gltf-model.html#why-use-gltf

Also does not mention how to use the JSON loader. My vote would be to go ahead and merge this, and make any tweaks to wording with followup commits. Tweaked a bit. Merged, thanks!  Fixes #2261.

**Description:**

Adds `gltf-model` component and system, based on @xirvr's [aframe-gltf implementation](https://github.com/xirvr/aframe-gltf).

**Changes proposed:**
- Include THREE.GLTFLoader.
- Currently excludes animations, but for Three.js r83+ an implementation might look very much like [`aframe-extras.animation-mixer`](https://github.com/donmccurdy/aframe-extras/blob/master/src/loaders/animation-mixer.js).
- ~~Adds example model (which is 11MB, so we can pick another from [gltf-test](https://github.com/cx20/gltf-test) if we prefer).~~
 We can host the sample models at https://github.com/aframevr/assets. Just commit it there, and it'll be available via ```cdn.aframe.io``` Updated. I believe this is caught up now. looks good to me!  great looks totally fantastic  We need to fix the tests Probably just some race condition or timing issue. What did we think about just removing the `recursive` property altogether and being `recursive` by default? I remember something about hard to figure out what element exactly was intersected in a big tree?  @machenmusik did you still want to get this merged? I've forgotten the context here a bit, but as far as I remember: With `raycaster="recursive:false`, the raycaster tests against each entity's root Object3D, and will never detect anything. That's no good; we should either fix that or remove the option.

1. If we can simplify this PR a bit, great. I'll add proposed changes, if we choose to move forward, in separate comments.
2. Removing the `recursive` option would be OK, too. For users who understand the performance profile and scene graph enough to care, setting up a custom component with a THREE.Raycaster is not that difficult. If they're doing that kind of performance tuning, they should probably consider taking the querySelector out of the picture anyway. If we choose to keep the `recursive:false` option around, then I'm happy with this PR after the remaining comments.

But I don't have a strong opinion about whether that option should exist, one way or another. @dmarcos @ngokevin - @donmccurdy and I think this one is done, did we want to merge or close?   Thanks!  Understand the confusion, but this is how THREE.Raycaster works. Parent `THREE.Object`s do not have geometry: if recursive:false is set the children are ignored, so there's nothing for the raycaster to hit. Neither A-Frame nor Three.js will be able to change this behavior, in all likelihood. 

Your workaround is a good one, though, and perhaps a community component (`shallow-raycaster`?) should be created to allow it more conveniently. Ok, looking at this a bit more, here's a simpler [Codepen demo](http://codepen.io/donmccurdy/pen/EZoLRr). With no nesting whatsoever, and `{recursive:false}`, clicks on the box still don't go through because there's a wrapping THREE.Group around the mesh.

So, there is something to be fixed here. Either:

1. We remove the `recursive` property from the raycaster, because it should basically always be true.
2. Or, we try to implement shallow (1-level) raycasting in a way that avoids these wrapping elements. > (is the wrapping that is done always only one level deep?)

For stock geometries, yes. If there's a `collada-model` or something involved, there's also a good chance that the model introduces its own wrappers.  [Here's an example using Mapbox](https://github.com/jesstelford/aframe-map) to render the map, and then using that `<canvas/>` element to create a texture. I also recommend the [A-Frame Slack](https://aframe.io/community/#slack) to see what others are working on. :)  It has an npm specific fix  thanks!  nice!  Are you thinking about sharing your component in the registry? https://github.com/aframevr/aframe-registry We can have it on the Registry. If it proves useful to many scenes, we could include it.  Thanks for filing. I do expect the component to update on each frame, *but* the `componentchanged` event shouldn't fire if the data hasn't actually changed. Marked as `help wanted (easy)` to investigate if we are indeed checking that data has been changed.  thanks!  The CodePen model 404s. I don't think this should be an issue? The collada-model should be waiting until its loaded before it tries to set any mesh for the raycaster to pick up. Maybe we should fix raycaster too?  **Description:**

CodePen's JS tab will append to bottom of body which doesn't work for A-Frame.


<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Done!  **Description:**

Introduction should give a quick context on deploying on the Web. It's free, it's instant, no gatekeepers. Contrast that with native app stores that go through lengthy review processes that may end up in rejections. Publishing a VR experience with A-Frame is the exact same as publishing a web page. Note we want to deploy with `https://` due to WebVR SSL restrictions.

1. Publishing with GitHub Pages
2. Publishing with Neocities
3. Additional Guides for Publishing on AWS, Surge, Heroku, etc.

<!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->
 Sorry, I've got a start on this already at https://github.com/aframevr/aframe/pull/2639, but please look over and send any improvements once I have it out :) Merging with #2634, guide has been written in https://github.com/aframevr/aframe/pull/2639  Thanks! The indentation does not follow the convention. Tested + reviewed. Thanks!  Thanks! Not allowing vertical touch is a deliberate decision because it becomes very confusing for de user in combination with device motion. You quickly lose the reference of where is up/down and you can only recover by reloading the page It's difficult to support every single use case. We prefer that the standard implementation remain focused on a default preset. This is better as increased complexity in code will increase maintenance in the long run and slow releases. Components can be built or customized that can be updated or published asynchronously from A-Frame. I think an okay compromise that at least it's possible to achieve what you need via components. I understand there are many use cases, but we try to set the direction of the project towards true WebVR. You can add it to https://github.com/aframevr/awesome-aframe, publish it and we'll feature it on the blog, or contribute a FAQ entry on how to customize controls. Thanks! The decision to lock finger panning to the `x` axis is what we observed delivers the best experience for the majority of applications when combined with gyro orientation that all tablets and phones have. If you allow for vertical panning the user quickly loses the notion of up / down and it gets disorienting. The good thing about a-frame is that it's very easy to override the defaults if your application does not fit within those design decisions. We cannot cover every single use case on A-Frame core because as @ngokevin said we would not be able to guarantee good quality for all the possible combinations of controls moving forward. We want aframe core to be useful with sane defaults but still contain the complexity of the code base. We've been focusing the efforts on making very easy for anyone to modify and extend the default behavior.  **DO NOT MERGE WITHOUT TESTING ON HARDWARE**

The code can be reviewed but it needs to be tested with hardware to make sure it works. I'm far from my beloved VR headsets now. If someone can test then we can merge. 

This is a requirement from the motion capture components. When reproducing we want the controls to listen to events even if there's no real tracked controls present.


 The capture components won't be part of the core so I prefer them to use the same public API as any others. This change is innocuous for the normal use of the vive/oculus components. We can revisit if it ends up being a problem.  Monkey patching is difficult to understand and debug in case of problems. it should be used very sparsely. If events name collisions is a problem we can revisit. For the moment I lean toward the simplest solution. Tested with hand-controls + vive-controls on Vive.

@mchen RE: your idea. I think just relying on events and event details are simpler than wrapping or stubbing the whole GamePad API. 

r+ from me  Thanks!  I was working on it yesterday to try to really improve caching and asset system. I'll be back Tuesday.  Merging issue with https://github.com/aframevr/aframe/issues/2472  I'd would clarify it more in the Getting Started section. If there's a spot that doesn't imply people should use a local server, we should address it there, at the root. Perhaps move Getting Started to be the first guide? I'm not too sure about that. Right now the Introduction section serves as high-level overview and introductory reading. The Guides are more hands on. I think that works for now. It certainly wouldn't hurt if beginners read through Best Practices and FAQ before getting their hands dirty.

To move Getting Started, you move it to the guides/ folder. The metadata at the top of each file determines the order and sections. Do `npm run docs` to get a preview. thanks!  1. If developers want full screen only, and not VR, I would create a fullscreen button that calls requestFullScreen, but I wouldn't put it to A-Frame.
2. Sounds good, if anyone wants to investigate tablet. @tinchoforever can you tell if `AFRAME.utils.device.isMobile()` is returning `true` on your Nexus 9? @tinchoforever What do you get when you do `navigator.userAgent` on console? That's the problem. Your userAgent string does not include the `Mobile` keyword. Apparently not all the Android tablets report the browser as mobile. I found some references to the problem:

https://meta.discourse.org/t/my-android-tablet-was-not-detected-as-a-mobile-device/26734/14

http://stackoverflow.com/questions/5341637/how-do-detect-android-tablets-in-general-useragent
 @tinchoforever Can you try if https://github.com/aframevr/aframe/issues/2382 fixes your issue? Any error on console?  Try `<a-scene antialias="true">`?

screenshot won't be supporting the mobile case. Take it from a desktop. width/height parameters now work https://github.com/aframevr/aframe/pull/2474, `antialias="true"` will help.  What do you mean by `tilt` efect? You say if you move the device it works? Is there any error in console? does ionic expose the device motion APIs? > If you move your finger up and down the video 

`look-controls` does not support vertical panning because it'll throw off the orientation axis. If you want to design for non-VR, you'd need to create your own controls to modify the camera.  Works for me. Might've been a Nightly regression.   That check is in place so that WASD controls won't move when the player is typing into an `<input/>` or `<textarea/>` ‚Äî say, a chatbox or signup form. Other ideas? How are you using the modal dialog? @chriscar you should have access to the canvas by doing `sceneEl.canvas`. We can maybe create a specific method in `wasd-controls` instead of using the utils one to test the solution @cvan might have some ideas. @chriscar: @dmarcos: @donmccurdy: if the iframe is on the *same origin*, then you should be able to do this:

```js
window.addEventListener('DOMContentLoaded', function () {
  // Find an iframe already on the page.
  var iframe = document.querySelector('iframe');
  if (iframe) {
    iframe.addEventListener('load', function () {
      try {
        iframe.contentWindow.focus();
      } catch (err) {
        console.warn('Could not focus iframe', err);
      }
    });
    if (iframe.contentWindow) {
      iframe.contentWindow.focus();
    }
  }
});
```

Or, ideally, if you're dynamically creating an `<iframe>` from JS:

```js
// Create an iframe.
var iframe = document.createElement('iframe');
iframe.src = 'my_scene.html';
iframe.allowfullscreen = 'true';
iframe.enable = 'vr';  // See https://github.com/w3c/webvr/issues/86
iframe.addEventListener('load', function () {
  try {
    iframe.contentWindow.focus();
  } catch (err) {
    console.warn('Could not focus iframe', err);
  }
});
document.body.appendChild(iframe);
```

Let me know if that solves your problems.
  - A-Frame Version: v0.4.0
- Reproducible Code Snippet or URL:

This fails:

```js
var cylinder = document.createElement('a-cylinder');
cylinder.setAttribute('color', '#000000');
cylinder.setAttribute('height', `1.5`);
cylinder.setAttribute('position', `3 1 0`);
scene.appendChild(cylinder);
```

But this works:

```js
var cylinder = document.createElement('a-cylinder');
scene.appendChild(cylinder);
cylinder.setAttribute('color', '#000000');
cylinder.setAttribute('height', `1.5`);
cylinder.setAttribute('position', `3 1 0`);
```

Preferably both would work. Seems like a strange edge case that new users could easily be surprised by; I know the primitive init cycle is a bit troublesome but hopefully we can fix this case.
 Yep, both cases should work Hm I filed based on [this conversation](https://aframevr.slack.com/archives/questions/p1485046322874497).

But I can't reproduce the problem either. There were websockets involved, so probably the elements were added after scene init, but even so I can't reproduce this. I guess she was on 0.3.2  Thanks for filing this. @ngokevin @fernandojsg I'm going to put some thought on this. Any ideas? Maybe some features for the inspector or a-painter? I don't think we have any mentorship spots open at the moment.

RGSOC has closed  You have to specify the properties on the animation component, not bare attributes.

`<a-mixin id="anim-mixin" animation="property: rotation; dur: 500"></a-mixin>`  Does this reproduce with latest master? I remember model file names and stuff getting shuffled around and being temporarily broken. There were several changes in both the model and the `vive-controls` and this does not seem to reproduce anymore. Please reopen if it's still a problem  Possibly simpler to just document how to modify a COLLADA model post-load using the event rather than building it into the component? We'll probably move COLLADA to a community component as we get glTF in. Can you address the linting? I was considering this closely. I will close because:

1. It doesn't scale, we can't cover all the material properties that can be loaded COLLADA, or all the cases where you'd "post-process" a model after loading. 
2. The workflow is expected, the same as in three.js, you load a model, and then write some code to configure as you need. This case, you can use `model-loaded` event.
3. `alphaTest`ing is not something you'd want 100% of the time.
4. COLLADA is on a deprecation path.

If there's any flashing, you can `visible="false"` until you are done with everything.

I did consider banning single-prop components, but instead in the future, we'll be more diligent about using that, and use it for simple cases like pos/rot/sca/visible. Thanks!  <!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->

**Description:**

1. Go to an example with `hand-controls`.
2. Do `document.querySelector('[tracked-controls]')` in console.
3. Says `null`, but should return entities with `hand-controls`.

Dependency synchronization with DOM works for the first dependency, but not further dependencies.

- A-Frame Version: 0.4.0
- Platform / Device: Desktop
- Reproducible Code Snippet or URL: https://ngokevin.github.io/kframe/scenes/aincraft/
 `tracked-controls` is not a dependency of `vive-controls`. It is set only if there's a vive connected:
https://github.com/aframevr/aframe/blob/master/src/components/vive-controls.js#L138
 If the vive controllers are present you should get something from `document.querySelector('[tracked-controls]')`
 OK, thanks.  @ngokevin has the asset moved? I forgot whether or not I added it. I'll get around to updating it. Fixed, thanks! Typo in the guide.

It's at `https://cdn.aframe.io/basic-guide/audio/background-noise.wav`  Thank you!  Thanks!  Thanks! sure!  They were moving for me but with no trasition. It flipped from released to pressed positions without intermediate states. Ok. thanks!  Documentation for [THREE.PositionalAudio](https://threejs.org/docs/index.html?q=positional#Reference/Audio/PositionalAudio).

Specifically, these options might be useful:

| property | default | description |
|---------|-------|----------|
| distanceModel | ~linear~ inverse | `linear`, `inverse`, `exponential` |
| refDistance | 1 | Reference distance for reducing volume as the audio source moves further from the listener. |
| rolloffFactor | 1 | Describes how quickly the volume is reduced as the source moves away from the listener. |
| maxDistance | 10000 | Maximum distance between the audio source and the listener, after which the volume is not reduced any further | @wildaces215 you are more than welcome to help Oh, good point! `inverse` it is then. I don't think anyone's working on it. It seems a lot of people are just commenting "i want to work on this" on a lot of issues and not doing anything. If people are interested and the issue doesn't seem to be active, I'd just create a PR versus a comment. No worries, not talking about anyone specific :)  Try: `<a-entity camera cloned-look-controls="reverseMouseDrag: true">` rather than `<a-camera>` which has `look-controls` attached.  The `grab` component [currently only handles position](https://github.com/aframevr/aframe/blob/master/examples/showcase/tracked-controls/components/grab.js#L62-L85). Rotation would be a nice addition here, and solves some common use cases without requiring users to drop in CannonJS. 

Another, somewhat related, idea would be a `snapped-grab` component that does the same thing but snaps object position to some interval and rotation to 45¬∫ or 90¬∫ after the object is released. Maybe we could just use the super-hands component That'd work too. I think the 'stretch' and 'drag-and-drop' functions are a bit less universal but otherwise it looks good. Adding rotation means also switching from aabb collider to something else. The demo is not the ultimate tutorial of VR object manipulation. I wanted to keep the complexity to a minimum while still being compelling so it can be used as a base for more advanced stuff. I would not use third party components for the core examples. @dmarcos Just switching to `sphere-collider` would do the trick, right? Aside from the nuisance of figuring out relative rotations for nested objects..

**Goal for filing this issue** ‚Äî it'd be great if there were minimal-as-possible component(s) for positioning and rotating objects with tracked controllers. If that can be done simply enough, we should include it in core. I don't think `super-hands`, or physics-based grabbing, is minimal enough to include in core. 

Linking to registry demos would be orthogonal IMO, I'm not worried about discoverability of these components (they're already very visible, registry will make them more so) but just that there is no bare-minimum component yet (physics is overkill in most cases, and `super-hands` does more than most users need).  Awesome! The source code lives in `src/`, you can find it in `src/core/a-mixin.js`.

Would you be comfortable writing a unit test for that? `tests/core/a-mixin.js` Needs some rebase and clean up of a bunch of comment and test code Polished it up and committed @ https://github.com/aframevr/aframe/commit/22c9ddb166c004d819f0d7c45f6cbb1e21e1fcf5 . Thanks!  <!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->

**Description:**

For A-Frame, this is uncharted territory for a lot of us. But let's get a start on it, and build from there.
People with experience include:

- @feiss - [A-Painter Interface](https://github.com/aframevr/a-painter)
- @kfarr - [City Builder Interface](https://github.com/kfarr/aframe-city-builder/)
- @mflux - [dat.GUI VR](https://github.com/dataarts/dat.guiVR)

Throwing up a layout because I don't have much experience, but we can look at the implementations above and explain how they were made.

1. Building Interfaces with HTML
2. Building an Interface Using an Image
3. Building an Interface with 3D Objects
 I'm thinking more 2D interfaces that can be interacted with controllers. True, there's no one way to do VR interfaces, but it's better to have a guide showing a few implementations than nothing at all. That way, at least the community can build off of it. As we converge to more best practices, these guides can always be updated.

For levels, knobs, dials, buttons, I have an issue for "Adding Interactions in VR" guide https://github.com/aframevr/aframe/issues/2274 The guide will be targeted towards VR where you have positional tracking and 6DoF controllers. Yeah. The future of VR's lowest common denominator at some point will be positional tracking + 6DOF controllers, so that's what we're aiming for. With all my respect (and at least regarding A-Painter), I wouldn't call our projects as examples of 'best practices', but 'first practices'.. We had a problem or goal, and we solved it in the best way we could using the time we had. But that does not mean that was the **best** way of doing it, or that other UIs should be done that way.. 

I'm talking about the technical implementation of a certain UI. When talking about the conceptual design of VR UIs, I think **nobody** knows the best practices yet, this is a barely explored territory..

What I think @ngokevin wants is to write about the different ways of implementing and drawing UI elements using A-Frame. Something like what he has in the last bullet list of the first post: how to make ui elements using html tags only, using images, 3d objects, even procedural objects...

Teaching people different ways of making a button in A-Frame, not telling about how a button in VR should behave or look like, or how responsive VR UIs should be. Yup, pretty much wanted a "first practices" guide on some existing implementations to get a start, not a Bible. We can speed up experimentation if we provide a foundation using what we know so far rather than leaving it at "no one knows". That'd be great! Yeah, if anyone wants to volunteer a case study, that'd be useful for people. Else at some point, someone or me can read through some of the implementations and regurgitate it. I think both. Some original content with describing a couple implementations that we have so far, with links out for further reading. As we evolve our knowledge and prototype more in VR UI, we add and update content. **@imgntn is now working on this.**

@rapoulson Would love to see a further reading list if it's not too much work. Not sure what would be useful, they'd mostly be for inspiration? Not much content right now describing building room scale interactions for WebVR. Sorry, wrong issue. The comment above was for the Interaction Guide. No one is working on this currently. @kfarr Thanks, will take a look right after this A-Frame release.  <!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->

**Description:**

I want to clear out the mixins component on an entity

[6:08]  
this.el.setAttribute('mixin' , '');

[6:08]  
is throwing an error "'querySelector' on 'Element': 'a-mixin#' is not a valid selector."

[6:09]
any ideas? `removeAttribute('mixin')` doesn't also work.

We should also allow `.removeAttribute('mixin', mixinName)` @BhuvanaMeenakshi Thanks for the interest. Can you open a PR with a test case fixing the issue? https://github.com/aframevr/aframe/pull/2291  I think this is a dup https://github.com/aframevr/aframe/issues/2008#issuecomment-257905203  Have you tried a-frame 0.4.0? Do the examples on aframe.io work for you? Then there's something wrong with your setup. You have to share your whole document and not only the `a-scene` I don't know much a bout Ionic/Angular.js but it seems this is not an aframe bug (since the aframe examples work for you) but something with your integration. I recommend asking the question on stackoverflow  http://stackoverflow.com/tags/aframe/ or use the a-frame slack (some people use angular.js there) https://aframe.io/community/#slack 

I close this but please reopen if this ends up being an a-frame specific problem.  **Description:**

We need a guide focused around adding interactions, primarily with tracked controllers in Vive and Touch. This guide will make heavy use of community components including: [aframe-physics-system](https://github.com/donmccurdy/aframe-physics-system) by @donmccurdy and [aframe-super-hands-component](https://github.com/wmurphyrd/aframe-super-hands-component) by @wmurphyrd

Possible guide outline might look like:

1. Adding Tracked Controllers to the Scene (`hand-controls`, `vive-controls`, `touch-controls`)
2. Listening to Tracked Controller Events 
3. Adding a Cursor to Tracked Controllers (https://github.com/bryik/aframe-vive-cursor-component by @bryik )
4. Grabbing Objects (super-hands)
5. Checking for Collisions and Colliding Objects (super-hands)
6. Scaling Objects (super-hands)
7. Adding Physics to Interactive Objects for Throwing and Hitting (super-hands + physics)

Inspiration: https://unity3d.com/learn/tutorials/topics/virtual-reality/interaction-vr **@imgntn is now working on this.** https://aframe.io/docs/0.6.0/introduction/interactions-and-controllers.html  You're adding an element at runtime which will cause a reflow of the page. I don't think there's anything to be done on the A-Frame side. `<a-scene>` has some CSS rules that come with it, you can override as you need or add styles to your page to prevent it.    Don't think the intro is good to get into code details. There is a JavaScript guide we can mention this though for A-Frame, we usually recommend code to live within components which go before the scene. Thanks though!  Nice! Thanks!  Until they add the `allowvr` attribute to the iframes It's actually CodePen that needs to add that attribute. We just need to say WebVR won't work right now until they add it to their I-Frames. Cardboard will work though. That's great. Some tweaks:

**Note:** VR mode currently won't work until the `allowvr` attribute is added to CodePen's I-Frames.  Help wanted to change that text color to white. (#FAFAFA) @mitchallen would you like to help to tweak the colors?  There's a lot here, so a couple starting points:

1. Let's exclude `kinematic-body` from discussion. It will never support roomscale VR, and that's primarily what we're talking about with tracked controllers.
2. In the `leap-hand` component I took this approach:

```html
// A
<a-entity camera look-controls position="0 1.5 0">
  <a-entity leap-hand="hand: left"></a-entity>
  <a-entity leap-hand="hand: right"></a-entity>
</a-entity>
```

OTOH, `tracked-controls` assumes the controller is attached directly to the scene. I'm not sure how `teleport-controls` is able to associate the three.

```html
// B
<a-entity camera look-controls></a-entity>
<a-entity teleport-controls tracked-controls="hand: left"></a-entity>
<a-entity teleport-controls tracked-controls="hand: right"></a-entity>
```

Another option, not currently implemented anywhere, would be this:

```html
// C
<a-player>
  <a-entity camera look-controls></a-entity>
  <a-entity teleport-controls tracked-controls="hand: left"></a-entity>
  <a-entity teleport-controls tracked-controls="hand: right"></a-entity>
</a-player>
```

What are the tradeoffs of (A), (B), and (C)? Is there value in establishing a recommended structure, and do we know enough about what that should be yet? I haven't seen an A-Frame demo with co-presence in roomscale VR yet, will we need a player abstraction to support that? FWIW I was doing some modifications in my latest test with hand controls and teleportation, and I've found the best way to go is to use the same camera rig that is typically used in engines like unity, the C described by @donmccurdy :
```
<a-entity id="camerarig">
  <a-entity camera look-controls></a-entity>
  <a-entity teleport-controls tracked-controls="hand: left"></a-entity>
  <a-entity teleport-controls tracked-controls="hand: right"></a-entity>
</a-entity>
```

So you could move the camerarig instead of manually update the position of the camera and the controllers as I'm doing right now with the teleport-controls (I'll update the examples to follow this approach too).
The only concern is that before you had the correct position & orientation values for camera and controllers within the entity, and now you should apply the transform from the camerarig, but it shouldn't be a big deal. In unity it's commonly used `transform.position/scale/rotation` that refers to world instead of local (`transform.localPosition/Rotation/Scale`), but when you edit the `transform` on the inspector windows, you're editing the locals not the globals.
I believe we can't just assume a switch between globals or locals for all the cases but to expose both as unity does and leave that responsability to the component.

My proposal would be to have: `.getAttribute('globalPosition/Rotation/Scale')` and it will be just a read-only component that will returns the computed global values, (we could show them also in the inspector as non-editable values too).

These values will be computed just when required, as we don't want to keep decomposing the world matrix on every tick if we're not going to use them.
With this components like the `teleport` will need to query `globalPosition` of the controllers instead of the current `position` or accessing by code to the `worldposition` with threejs.
 @machenmusik I don't understand what you mean with propagating camera changing to controllers.
You'll have something like:
```
<a-camerarig>
  <a-entity camera></a-entity>
  <a-entity teleport-controls></a-entity>
  <a-entity teleport-controls></a-entity>
</a-camerarig>
```
And when you want to apply teleport you move the whole `camerarig` so you'll be moving the camera and the controllers at once. Umm I still don't understand, the `camerarig` will be a direct child of `a-scene` so every time you move it, it will be in global coordinates, and the object inside it (camera and controllers) you don't want to move them outside of the rig globally so they're just moving locally as expected. 
That's the approach I followed for the camera controls implementation I've used here https://twitter.com/fernandojsg/status/836371728976719872 and it's based on how unity's cameraRig works and I can't think right now in any use case where I want to set the global position of any object within the rig instead of moving the rig itself, probably for some edge case but I believe for most common uses it could works. Could you give me some example you're facing right now? camera rig works  <!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->

I'm seeing seemingly hundreds of "components:geometry:warn Geometry merge is only available for `THREE.Geometry` types. Check that both of the merging geometry and the target geometry have `buffer` set to false" errors within this demo, so two things:

1.  We should fix the demo's root issue, obviously
2.  We should consider implementing something like three.js whereby we cut off `console` statements after a given number of executions.

- A-Frame Version: 0.4.0
- Platform / Device: Chrome desktop
- Reproducible Code Snippet or URL:  The `/examples/test/geometry-merging/` demo within the repo


 We've removed mergeTo in favor of doing it manually in three.js (e.g., within a component) when needed. Instanced geometries is an alternative way to achieve the same draw call reductions. Quick resources on merging geometries in three.js:

https://stackoverflow.com/questions/30245990/how-to-merge-two-geometries-or-meshes-using-three-js-r71
http://blog.sandromartis.com/2016/11/16/merging-geometries/
https://stackoverflow.com/questions/36450612/how-to-merge-two-buffergeometries-in-one-buffergeometry-in-three-js
https://threejs.org/docs/#api/core/Geometry

We can provide more resources as we develop/evolve examples and code.  Discussing how best to maintain `gltf-model` with @xirvr; perhaps either (1) merge it into aframe-extras.loaders, or (2) merge it into core.

Advantages of having `gltf-model` in core:

- glTF is (IMO) the most promising asset format for the web. If we want to see that gain traction, I think we need to be willing to treat it as a default early on (even if the popularity isn't there yet).

Disadvantages:

- Animation should be treated as format-agnostic, using THREE.AnimationMixer. Currently the `animation-mixer` component lives in aframe-extras, and it's not clear that we want more animation-related code moving into core. We could ensure that core/gltf-model exposes its animations in a way that is compatible with aframe-extras/animation-mixer.

Further discussion of animation: https://github.com/xirvr/aframe-gltf/issues/9

***

Proposed syntax for any THREE.AnimationMixer-compatible format, including glTF, with animation:

```html
<a-entity foo-model="src: homestar.foo"
          animation-mixer="clip: run"></a-entity>
```
 Yeah, I'd agree with adding `gltf-model` to core. If we need to pull in a way of animating models, we can do that too. How is the adoption of `gltf` so far? What's the status of exporters from popular tools: Blender, Cinema 4D, 3D Studio, Maya... What's the status of the three.js loader? I know that when we tried to use it for our demos everything looked pretty immature @feiss What do you think? The common argument is that we help drive the adoption. I'm fairly confident about THREE.GLTFLoader. It was fully re-written over the last 6 months, the code is relatively clean, and both @takahirox and I have been contributing to its maintenance. It's close to supporting all of the official glTF sample models ‚Äî perhaps by THREE.js r84 or r85. 

There are some converters, I'm not sure how well they work. There's not much available for exporters. My vote would be for us (A-Frame, and THREE.js) to go out on a limb a bit to support rendering the format, in the hope that we drive adoption and encourage tooling to catch up. @ngokevin @dmarcos thoughts y/n? glad to put together a PR if we want to see how much is involved, should be comparable to other formats though. Yes, please go ahead.   <!-- If you have a support question, please ask at https://stackoverflow.com/questions/ask/?tags=aframe rather than filing an issue. -->

**Description:**

Core component source code currently use `require`s. If someone wants to copy/paste/fork a component to modify it to their needs, they'd have to change the `require`s to point to like `window.AFRAME` for utils.

If we make our components use the `AFRAME` global instead of `require`s, we ensure that our components aren't using any internal hidden API, and that they have same privileges as any other component in the ecosystem. It would also make components easier to copy/paste and they'd be able to work in a pure browser context.


 My vote would be to avoid this, and not determine project structure for the convenience of devs who are new to package managers. It also makes it impossible to preserve private APIs within A-Frame core. Some alternatives:

1. Document (on SO or official docs) "How to customize a component".
2. Write an `angle` utility to create a component by forking an official one.

But I recognize that neither of those is a good solution when then component depends on various utils or helpers.

Do we think this issue applies to many components other than controls (both for camera and tracked controls) ? If not then maybe we revisit some amount of abstraction around the controls api. I could see an option where we take #1248, make that into a new repo like aframevr/aframe-controls, and document how to customize controls for that framework. But #1248 doesn't include a clear story for tracked controls. This would only be for components, which I don't think should have access to private APIs. Using the global would be a way to enforce that, and sort of create separation/less coupling between the components and the core API. 

Yeah, sorry the controls refactor got backlogged. It could be promoted to `aframevr/` org to get it along the way. I don't follow the analogy, but in many projects it is necessary to have private helper methods that are used internally, but not exposed externally. Exposing a public API implies an agreement with developers: that method will not be changed in a backward-incompatible way without appropriate [SemVer](http://semver.org/) version increase, and the more public API surface you have, the harder your public releases become. When that contract is broken, it's hard for third-party developers to keep their packages compatible. Many components in awesome-aframe are already incompatible with 0.4.0... that's fine for now (churn is expected up until 1.0.0) but we'll eventually want to have a fairly stable API.

Everything in `src/utils/*` is exposed as public APIs, and is available to anyone as `AFRAME.utils`. This is a good and appropriate way to expose public utilities. If those are the only utilities needed by components, then that's great. Perhaps A-Frame's core components are fortunate enough to not need additional private helper methods; I don't know of any counter-examples. If we remove all requires from the core components if forces us moving forward to make public any API, utility library or helper function used by more than one component. More API surface, more liability, harder to provide backwards compatibility, slower to change and innovate if we want... It's something we know pretty well at Mozilla with all the internal APIs that add-ons have been able to rely on. Aside: @ngokevin No problem on the PR, I'm not even convinced it should be in core at this point. Separate repo is worth discussing later though.  That's expected. 3D raycaster returns 3D point. If you want mouse click event, you can just listen to click on the window. @ngokevin I think the question/problem was that the intersection data was cached from the first intersection event, and not updated on each frame after that. We fixed that a while back though (by v0.3.2 at least) and I can't reproduce the problem now in v0.3.2 or v0.4.0.

Here's another script I'm using to test it:

```html
<script src="https://aframe.io/releases/0.4.0/aframe.min.js"></script>
<a-scene>
  <a-box position="0 0 -5"  class="intersectable" material="color: red"></a-box>
          <a-camera>
          <a-entity raycaster="far: 30; objects: .intersectable"
                    cursor
                    geometry="primitive: ring; radiusOuter: 0.015;
                              radiusInner: 0.01; segmentsTheta: 32"
                    material="color: red"
                    position="0 0 -0.75"></a-entity>
        </a-camera>
  </a-scene>
<script>
var box = document.querySelector('a-box');
box.addEventListener('click', (e) => console.log(e.detail.intersection.point))
</script>
```

^Note that the point reported is different depending on where we click the box (as expected).  Please head to http://stackoverflow.com/questions/ask/?tags=aframe to ask a question  Thanks!  **Description:**

Is there a better way to to update the global transform than `document.querySelector('a-scene').object3D.updateMatrixWorld()`?

[2:12]  
I‚Äôm trying to get a entities global position and rotation. (edited)

mchen [2:23 PM]  
isn't it supposed to auto update?

dmarcos [2:23 PM]  
@caseyyee no need to touch the scene. example here: https://github.com/aframevr/aframe/blob/master/src/components/raycaster.js#L150
 GitHub
aframevr/aframe
aframe - A web framework for building virtual reality experiences. 
 
 

caseyyee [2:25 PM]  
@dmarcos yeah, that‚Äôs what I was trying originally.  Not sure why it‚Äôs not working.  Will look into it again since it obviously works in the raycaster case.

mangob [2:27 PM]  
joined #general

mchen [2:28 PM]  
so I thought that auto-update is enabled by default (although the raycaster can't assume that it is enabled)

mathemagie [2:31 PM]  
joined #general

caseyyee [2:36 PM]  
@dmarcos @mchen seems to only work if i wrap in a self executing function like in the raycaster example.

[2:36]  
even then, it doesn‚Äôt seem like i‚Äôm getting the true world coordinates back of my mesh.

mchen [2:36 PM]  
can you just get___World() when you need it?

dmarcos [2:37 PM]  
@caseyyee can you share your code?

caseyyee [2:37 PM]  
@dmarcos sure i‚Äôll whip something up.

[2:37]  
@mchen how does that work?

mchen [2:39 PM]  
https://github.com/chenzlabs/aframe-teleport-controls/blob/master/index.js#L82 (probably not the most efficient)
 GitHub
chenzlabs/aframe-teleport-controls
aframe-teleport-controls - A-Frame teleport controls component 
 
 

caseyyee [2:49 PM]  
@dmarcos https://gist.github.com/caseyyee/2e2e921593964b91049136ac1ce31d13

[2:52]  
@mchen I get the same result when using that approach.   just the local coord.

mchen [2:54 PM]  
you are only doing calculatePosition at init

[2:54]  
did you mean to do it either in tick or update?

caseyyee [2:54 PM]  
Anywhere really.   i just stuck it in init for testing purposes.  can you not expect that to work?

mchen [2:55 PM]  
i don't think the threejs objects are actually up and working until later (see recent messages about when the camera is ready as well)

caseyyee [2:55 PM]  
ok i‚Äôll try some other lifecycle methods to see if it makes a difference.

mchen [2:55 PM]  
i know for a fact that the teleport-controls usage works

caseyyee [2:56 PM]  
sticking it in play works it seems.   doh.

[2:56]  
@dmarcos ^

dmarcos [2:58 PM]  
looking

caseyyee [2:58 PM]  
Might want to make that clearer in the docs somewhere since in some components, the method is used to update scene objects.

dmarcos [2:58 PM]  
@caseyyee oh I know

caseyyee [2:58 PM]  
and I guess by that time, I would have figured that I would be able to extract scene position.

dmarcos [2:58 PM]  
init is called before is actually inserted in the DOM

[2:58]  
I believe

[2:59]  
let me check

[3:01]  
@caseyyee ok i see

[3:02]  
if i do el.parentEl.object3D.updateMatrixWorld()

[3:02]  
it works

[3:02]  
so

[3:02]  
`init` is called

[3:02]  
before the first render loop

[3:03]  
and the matrices have not been yet updated for any entity

caseyyee [3:04 PM]  
interesting.   i didn‚Äôt think the renderer needed to be active before you could update the matrices.

dmarcos [3:04 PM]  
@caseyee if you want to do it in the init

[3:04]  
yes you have to call

[3:05]  
`el.sceneEl.object3D.updateMatrixWorld()` (edited)

[3:05]  
that should work

caseyyee [3:05 PM]  
yeah, thats what I was basically doing.    alright, that‚Äôll do for now.

dmarcos [3:05 PM]  
and then you can proceed like you were doing

mchen [3:06 PM]  
maybe that should be called in core before rippling init calls

caseyyee [3:07 PM]  
footgun for sure if not.

mchen [3:08 PM]  
you probably want to update in update method though...

ngokevin [3:13 PM]  
or maybe have the component wait for the renderstart event

mchen [3:14 PM]  
hmm, so now that I am looking a little more closely... 
when init fires, is anything attached yet?

ngokevin [3:14 PM]  
yeah init fires after attach

mchen [3:14 PM]  
so then assuming that scene init fires first, probably easy enough to call inside the a-scene init

ngokevin [3:16 PM]  
but you have to call it after the object3Ds are attached?

[3:16]  
i meant the component inits, not the scene init
  Is it possible to cover this with a test?  That's because of the asynchrony. If there's a pending request when `src` changes we should ignore the resullt. It should be an easy fix  It would be nice to have the browser auto-enter VR when refreshed on changes.  This would make it so that as a developer, you won't have to re-enter VR on every change and simply have the change show up in the headset.

- A-Frame Version: 0.4
- Platform / Device: Windows, HTC VIVE

 @machenmusik chrome won't allow for it, but Firefox will.   

Another alternative might be to have our own sync logic that would hot-reload the a-frame scene to make refreshing and auto-entering VR unnecessary.   Not sure if the work required to do that would be more difficult or not? So Firefox doesn't need user interaction? Will that change? Maybe just add a one-line JS in your app to click the button.

If it's for development purposes, there is a WebVR recording tool coming out that will help with this so you don't even need to enter VR to test.

But it might be possible to do something similar to React hot loading of components. A server can send a message to the scene which component changed. A-Frame can detach, re-register, and reattach the component. But that'll probably be far off I bet. @ngokevin WebVR recording tool doesn't help here.   Just being able to see changes reflected in the headset without having to reach over to click _Enter VR_ is all i'm asking for.     

Enter VR is still being specced, but it looks like user gesture will be required to enter VR for the first time, then any subsequent navigation and refreshes will be allowed to enter VR.

Hot loading sounds like the most ideal solution to me. vrdisplayactivate is implemented and only the first enter requires the gesture.  Thanks, but we want to do this for all entities/nodes, not just cursor/raycaster: https://github.com/aframevr/aframe/issues/2225

The code to do this is in the ANode.attachedCallback  Thanks! Can we fix the broken tests? Thanks! I can push another commit, but the earlier place is in attachedCallback, and we have a console.warn utility that will provide where the warning is coming from. @ngokevin feel free to revert or open a new PR  @giordyb @sebi-b @rafaelboschini @okwme I'm curious to know what is your use case for the `reload` method? What are you trying to achieve?  thanks!  It's cool to add your CodePen, that Pen is already not 'in house'. Thanks! Thanks!   @karansaulakh Why do you prefer a 0.05 value? I forgot why the default user height for the bare camera component is 0 and not 1.6? Because a camera can be used for anything not just for a human scale avatar. You might want to use the camera on a plane cockpit or on a car driver seat post. The camera should be scale agnostic and other higher level components should introduce the concept of scale, avatar or player The default camera and `<a-camera>` have a 1.6m default, shouldn't the camera component? The camera can be used for anything, but a standing human seems like a reasonable default versus clipping the ground. Adding magic offsets is always confusing. I would probably rename `<a-camera>` to `<a-player>` or `<a-avatar>` or something like this. I prefer to keep the camera component agnostic Ok, will close  Thanks!  Thanks a lot!  What browser are you using?  With Firefox Nightly, there is an issue with the Oculus Touch controllers positions being offset:  https://bugzilla.mozilla.org/show_bug.cgi?id=1324149   I suspect this is the issue you are seeing since i'm getting the same result.   Works fine with VIVE. @machenmusik Currently Oculus touch controllers in Nightly are only supported through OpenVR -- though that's going to be changing soon so that that the API works directly with Oculus instead.   If you disable openVR, you get headset support, but touch controllers won't work.

@giordyb ah interesting.  Could be something with A-Frame then.  Chromium should be fine. @machenmusik Oculus touch is not functional with Nightly right now because of the issues.   We'll want to wait till it's fixed before using it.  thanks!  I see, I think for now, it's OK to not clone and leave it up to the developer to do (`AFRAME.utils.clone`, pass in a string, or `JSON.parse(JSON.stringify())`  Just replied in stack overflow - will follow up with a full answer if that is helpful. :) Going to close this since this is more of a question, not an issue: http://stackoverflow.com/questions/41393812/toggle-the-visibility-of-dom-with-a-frame  You should be appending to the scene rather than the document.body. In the aframe-react bug, is that component mounted under the scene? Also, yeah we should throw a warning for that OK, repurposing the issue for the warning. Will try to investigate the react side later  This is a known browser issue with Chromium and passing wrong timestamps to requestAnimationFrame. You can try using an older Chromium from September or Firefox Nightly  Can you describe your problem more precisely, are your `headers` accept loading this issue can we reproduce that? Perhaps you should post it to stackoverflow instead... 20mb is not too large. The problem is likely something invalid in the model itself, or use of some feature that THREE.OBJLoader doesn't support yet. Usually it's the first. [Here](https://github.com/mrdoob/three.js/issues?utf8=%E2%9C%93&q=is%3Aissue%20objloader) are some examples of others' issues with the OBJ format.

To debug what's going on, you'll want to look at the JS Console and include that output with any bug reports. If that doesn't work, we'll need to see the model, preferably in a live demo, to be able to help.

***

Meta: I'm not sure if SO will take questions along these lines, since it's just about impossible to differentiate  between questions of the form "my model doesn't work" until you open the black box of the file itself. Maybe we could add a paragraph to [Why does my asset not load](https://aframe.io/docs/0.4.0/introduction/faq.html#why-does-my-asset-e-g-image-video-model-not-load) explaining specifically how to debug a model that isn't rendering.

In the meantime, I'd vote to close this issue until there's a bit more information. @nikolas7892 I'm going to close this issue. Please reopen if you can provide additional info  Should aspect be part of the schema? Is there any case you want to have an aspect ratio other than the viewport? cc @maissani  If the camera aspect ratio won't be different than the viewport (in the embedded case we still use the viewport size) we should then remove `aspectRatio` from the schema and change it internally on the component whenever the viewport size changes. I don't think we should rely on the aspect ratio to create any effects. It will be pretty jarring on VR mode  Thanks!  I'm not sure if I understand the question. Short story: yes, changes in the DOM will affect the render of the scene. Long story: The scene is rendered at the refresh rate of the device is presented to (60fps on a normal display, 90 fps on a Vive or an Oculus Rift). Changes on component properties in the DOM will modify the underlying Three.js Object3Ds and will be picked up by the render loop.   I would not prefer to introduce work around for browser bugs. Specially when those bugs are known and come from experimental builds Chromium experimental builds are not the only ones with native Oculus and Vive support. Firefox Nightly also supports both. Nightly supports Oculus Rift natively but not Touch yet. We're days away from having support for touch. I insist on my preference of not accumulating workarounds in the code base for known bugs in one off experimental builds of a specific browser.    What do you think about recalculating the aspect ratio of the camera whenever the canvas size changes instead of just on camera update?  Instead of resizing the camera [here](https://github.com/aframevr/aframe/blob/master/src/core/scene/a-scene.js#L295) we could emit an event that the camera component listens to and the aspect ratio is then recalculated Why do you need to recalculate the aspect ratio when the zoom or fov change? aspect is not even part of the component schema. The aspect updates should be taken out the `update` function and make them based on canvas resizes, hence the need to introduce a new event on `a-scene` and a new method `updateAspectRatio` in the camera component Is there any case where someone would want an aspect ratio that it's different than the viewport? If not then `aspect` should not be part of the schema and the logic should be out of the `update` method. It's better if all the camera updates are handled by the component instead of `a-scene` modifyng it. I think it's cleaner to move the logic back to the `camera` and trigger it by a `canvasresized` event emitted by the scene @radenui We're pretty close from having something mergable. My proposed changes are the following:
1. Remove `aspect` from the camera schema since I don't see any use case when one would want an aspect ratio other than the screen.
2. Emit a new event from a-scene `canvasresized`
3. The camera component recalculates the aspect ratio automatically (it's not user configurable) based on the canvas resizes. There are some pending changes described here: https://github.com/aframevr/aframe/pull/2216#issuecomment-301549089 @radenui are you still actively working on this? I'm closing this due to inactivity. We will reopen if there's interest  Thanks!  Thanks!  After adding your commit to #2209 close this PR  After adding your commit to #2209 close this PR  I have a feeling that #2210 and #2211 should be here as single PR not individual PR's Thanks!  That's a good point about the delay, @machenmusik.. I think it might confuse people to have a `checkHas6DoFControllers()` method that will always return false when the page loads. Helper method or no, people will need to understand the basics of the Gamepad API.

Maybe best option would be to post (in Stack Overflow or FAQ) an example of how to use the Gamepad API to detect this. Example:

```js
window.addEventListener('gamepadconnected', function (event) {
    if (event.gamepad.pose) {
      // ...
    }
});
```

I'm not 100% sure how to differentiate between 6DOF and 3DOF, but presumably that's `gamepad.pose.hasPosition`. [Gamepad Extensions API](https://w3c.github.io/gamepad/extensions.html#dom-gamepadpose).  @machenmusik I can't reproduce this. Could you provide a specific case, and at what point in the scene's lifecycle you're testing for `el.sceneEl`? 

For example, in the `<a-ocean />` primitive, adding an `init()` method to the `ocean` component works as expected, and `this.el.sceneEl` is there. @machenmusik can you provide reproducible code/? Closing unless we have a reproducible test case  This is a modification of @fernandojsg component and there's a PR opened there(https://github.com/fernandojsg/aframe-bmfont-component/pull/1). I'll wait for fernando's review first. Maybe we could move the discussion to my repo PR and once we got that fixed and working update it? Or just the other way but to avoid commenting in both places In fact the component wasnt yet ready to ship it on aframe.
First we need to fix the functionality for example msdf doesnt work yet but its exposed anyway. Then we should refactor and lint the code.
And finally add some cool examples. > Sidebar, it is a nuisance that you can't use the same source between standalone and proposed core... which would make this sort of thing much easier if working components could literally be pulled into core
@machenmusik What does it mean working components? @fernandojsg won't maintain his component anymore and will be now part of the core. The [registry](https://aframe.io/aframe-registry/) paired with the inspector is the way to easily consume / discover components that are not part of the core while separating concerns and liabilities. I want to reduce what gets into core to what we consider is minimal functionality and has to be consistent across a-frame scenes. If functionality keeps growing we won't be able to keep good quality. @ngokevin @fernandojsg Should we pull the trigger and merge this? Can the component name be shortened? `text` might be too prescriptive, what about `bmtext` or `sdftext`? @dmarcos let me have a look at it, I didn't check the last updates for a while, sorry :)
@ngokevin umm as we could have several techniques I wouldn't choose `sdftext`, being a part of the core maybe `text` could be enough? or `text2d` or something non related to the technique used to render it I wouldn't mind `text` too much, we'd document that there are other methods. And it seems cleaner.

I haven't had time to take a look either. Will get around, but if I don't, I can always post-review. Namespace collisions not too much of an issue, Registry components aren't allowed to register names used by core components. I'll just rename mine to text-geometry (or make it part of the geometry component).

I can help with tests in a bit. Thanks! I think `text.text` is fine. You can change, or I can get to it later. Maybe `<a-text content="Hello">` or `<a-text value="Hello">`? Also, we can talk more about future of primitives in Slack later on. Makes sense to me. `text.value`. I can help with tests right after I finish my current set of work. I'll put it up next. OK, helping on tests and clean up now Would be great to have a section in the doc about other possible text implementatons (geometry, DOM-to-canvas). Usages, advantages, disadvantages, links. I've filed https://github.com/mrdoob/three.js/issues/10644 to improve the three.js FileLoader so we don't have to do the whole get or create Promise dance. Else I'm gonna work on decoupling that stuff we have now out of the component to make it easier to read and test. Alright! Spent pretty much the entire week looking at this and helping with tests, clean up, docs, and refactors. It looks great. Super thanks @machenmusik! And @fernandojsg @bryik for the long lineage of the text component. :1st_place_medal: 

If we catch anything else, we can address in a smaller follow up PRs.  I'd like to consider https://github.com/aframevr/aframe/issues/2047 There's no difference in difficulty between the current Shader API and using ShaderMaterial directly. We are tightly wrapping the API, routing vertexShader + fragmentShader to ShaderMaterial.vertexShader + ShaderMaterial.fragmentShader and mapping the schema to uniforms. It's actually more difficult because you will run into limitations and it's not as documented as three.js's.

It's not a good idea to support two APIs, especially when one is limited and always has to be kept up to date. Using ShaderMaterial is much more solid. You will be able to copy and paste three.js ShaderMaterial examples straight in rather than trying to figure out the relationships to A-Frame, and there is less risk of API regressions. The grunt work of updating uniforms could be handled by a util or just boilerplate. I think I prefer accepting the few additional lines (that could be resolved with utils, it's just updating an object) that comes from A-Frame trying to hide the three.js API. The maintenance of this API doesn't end with adding textures. It might resolve your simple shader, but there are way too many cases out there where you'll just run into a wall (what about `samplerCube`?).

See all of the [uniform types](https://github.com/mrdoob/three.js/wiki/Uniforms-types) we'd need to create A-Frame-to-three.js mappings and property types. Every time three.js updates its API, A-Frame will have to answer. I understand it saves a bit of work in some cases, but in others it seems fragile and will cause some frustration. @ngokevin I don't think that API will change that much in three.js. At the end they're matching GLSL types and that's settled. The root issue is more code/API to maintain versus the benefit. If we propose an API that is an alternative to an existing one, it shouldn't have holes. We could pile on more code and features, but that increases maintenance versus just pointing to ShaderMaterial and leaving it at that. Every feature has a long-term cost.

I'm not sure what you mean with the texture mapping. You're using the `map` property type either way. OK. I thought about it. Even if we prescribe ShaderMaterial, the same amount of work is needed to support the schema. It would be nice to hide the three.js uniform types and use A-Frame schema types instead. I'll punt this for now, I hope we have volunteers to fill in the rest of the property types (there is a PR open for Matrix4) and support the rest of the ShaderMaterial properties. 

PS: The `flat` and `standard` materials support simple texture offsets and repeats. We can file an issue for what's missing. There's also #api on Slack if we want to take it there. Related https://github.com/aframevr/aframe/issues/2032 ... the texture loading pieces are a bit of a mess With the extension, in the Diff view, you can see all lines that aren't covered. So I'd see a lot of Red next to the lines that were added, meaning a lot of incoming code that's not unit tested.
<img width="1151" alt="screen shot 2016-12-21 at 6 43 57 pm" src="https://cloud.githubusercontent.com/assets/674727/21413608/75a067b6-c7ad-11e6-8ed4-defb282d47fe.png">
 Apologies, tests should have been added to these pieces of code previously (I try to fill in tests when I see holes). Nevertheless, it's a good thing to have. But we can worry about reviewing the PR itself first. I'll look at this tomorrow or friday  https://github.com/aframevr/aframe/pull/2193  Thanks, we can cherry-pick this onto the docs  Thanks!  Thanks!  @machenmusik Got a version of the `hand-controls` tests working without the `nextTick` calls: https://github.com/dmarcos/aframe/blob/noNextTick/tests/components/hand-controls.test.js Thanks!  needs rebase  @machenmusik doest it ring a bell? I reverted the model from the https://github.com/aframevr/assets this is probably why the problem cannot be reproduced anymore. @noerw can you confirm that everything is working? Please reopen the issue if you can still reproduce the problem.  Nice, thanks!

@ngokevin how would you feel about just naming this `utils.throttle`? That feels more consistent with common libs like `_.throttle`, and the function may also be used for mouse or gamepad events. This is a `debounce` function in my little world. I don't know what it's the most common name. And yes, it should be generic and not specific to tick. I also believe that the tick should never be debounced but the function of interest that the tick calls If you debounce the tick and later change the component you might end up with a strange behaviour and then remember / rediscover that tick was being debounced In this case `updateControllerList` should be the pne debouced and documented on the method @dmarcos To me, `debounce` implies that the function won't be invoked immediately, but only after the invocations pause for at least ___ms. I do think `throttle` is the right name (although perhaps there are uses for both functions).

[_.throttle](https://lodash.com/docs/4.17.2#throttle) vs [_.debounce](https://lodash.com/docs/4.17.2#debounce) @donmccurdy you're right `throttle` is the correct one Good point about the `time, delta` arguments. One solution would be to use an a-la-carte NPM implementation:

```
utils.throttle = require('lodash.throttle');
```

But, that would add a 3.6 KB to the build. If we don't expect to use the function internally, maybe it's better for developers just to NPM-require the function themselves.

Also seems easy enough to use `Date.now()` instead of relying on those `time, delta` args, and invoking `callback.apply(null, arguments)`. Yes, to throttle back we can use `Date.now()` to keep track when the function was called last. I would not pull 3.6Kb of dependencies for such small piece of functionality. We can implement a simple generic throttle in our utils based on `Date.now()` Throttling the tick changes its behavior and will suprise devs in the future since it's not obvious that is behaving differently. I would just throttle those methods that need to be throttled (`updateControllerList ` in this case) down and let tick behave the way is expected. We can do:
````javascript
/**
 * This method is throttled down....
**/
updateControllerList: utils.throttle(function updateControllerList() { ... }, 100);
```` Thinking about it more, a more generic throttle would be easier to use for devs rather than a custom tickThrottle. It gives devs more control on what exactly to throttle. In that case:

```
init: function () {
  this.throttledUpdateControllersList = throttle(this.updateControllersList, 50);
},

updateControllersList: function () {},

tick: function () {
  this.throttledUpdateControllersList();
}
``` If we use the convention of naming the throttled method as `methodNameThrottled` there will be less space for confusion. It's likely you will see `methodNameThrottled` in the call stack of your `methodName`. This way it won't affect either to other uses of the methods in the component. I'm not too worried about the conventions and how we use it in `tracked-controls` system, it'll be up to the developer, so just thinking about the API (throttle vs. throttleTick).

I like `utils.throttle` flexibility, but I like not having to call `Date.now()` for each component for each frame. It's much tighter to use the timestamps given by `tick`. Though I haven't run into cases where I've only needed to throttle parts of a `tick`, it's always been all-or-nothing given that components are designed to do one thing and do it well. @mikebolt Thanks for the review. We don't need window.performance.now since that provides sub-millisecond updates, which aren't needed in the context of VR.

You could publish the throttle, but would maybe prefer it to be kept in the repo for now. Thanks! Glad I don't have to do this anymore:

```
tick: (t, dt) => {
  if (t - this.time < 500) { return; }
  this.time = t;
} Only nit (against @dmarcos concern) was we call the method `throttledTick` when it actually isn't throttled. It gets wrapped to `tick` which is the method that is actually throttled. Would have preferred a comment:

```
init: function () {
  this.tick = throttleTick(...);
},

/**
 * Note this method is wrapped to be throttled every 10ms in init().
 */
tick: function () {
  // ...
}
``` Congrats on 2500th commit  I think it's fine to let it break. It makes obvious what it's going on. If the animation just don't play you will spent more time figuring out what happened Animation are supposed to be defined in the model. The component is designed around the asset. I'm fine to let i break so a bug speaks loudly.   Had an idea for one way of solving the issues of #1564, #1437, and #2147, potentially with a simpler API. Instead of having any sort of global dependency resolution, tick/tock, or custom update cycle for shaders...

```js
// API
sceneEl.addTick(Number order, Function fn);
sceneEl.removeTick(Number order, Function fn);

// Constants
AFRAME.Phase = {
  PRE_TICK: 500,
  TICK: 1000,
  POST_TICK: 1500,
  POST_RENDER: 2000
};

// Usage
sceneEl.addTick(AFRAME.Phase.PRE_TICK + 1, function (t, dt) {
  // ...
});
```

The goal here is that component authors can still hook into the A-Frame scene lifecycle, without adding much complexity to the core library itself. Callbacks could be added by components, shaders, or just global code. 

/cc @ngokevin @wizgrav @dmarcos  Closing this out as there have been other suggestions and no clear consensus. Currently I'm using something like this for physics, with my own custom system driving the event loop, and that works well for my needs.  See https://github.com/aframevr/aframe/tree/master/dist#release-builds for build information. Include the master or v0.4.0 version instead.  I think `hand-controls` should just be exclusive to `tracked-controls`. Other method inputs should map to different interaction models that are not hands. A gamepad or the gear VR touchpad should map to a controls schema other than `hand-controls`: a gaze based interaction for instance I want to keep `hand-controls` simple and exclusive to `tracked-controls`. The [tracked-controls](https://aframe.io/examples/showcase/tracked-controllers/) demo (walking and reaching objects out with your hands) is not a very good experience with GearVR or a Daydream control. For experiences that use just pointing at targets I can see a 3DOF controls to be used but for GearVR you probably want something different than emulating a hand with your gaze. You're idea of responsive controls is really worth exploring and probably an excellent addition to the registry. We're trying to keep the core as nimble and simple as we can with pieces that are highly reusable and not very opinionated. Also I'm not sure if  a `gearvr-controls` makes sense. At the end of the day it's just one kind of gamepad. The same as the x-box or a PS gamepad. Maybe a `gamepad-controls` makes more sense. One could register mappings for different gamepads. This could also simplify `tracked-controls` to just handle the pose changes.  > right now the mouse/touchpad emulation is activated for GearVR when using Samsung Internet VR browser, and there is specific hackery to leverage the Carmel gamepad mapping

This is why I push back on this kind of changes. I want to minimize the liabilities in the core. We don't have the resources to pay close attention to each browser, version and device to adapt the code to all the quirks (specially for those in experimental phase). The reason of having the [registry](https://aframe.io/aframe-registry/) is:
1. Enable permission less innovation where multiple solutions to a problem can coexist and compete. 
2. Having a community that helps provide all the functionality that we don't have the resources to develop and maintain.

The core team will make its best to facilitate the conversation and create a system for people to share, discover and use those components.  I believe this was fixed by not having the default component override the set value.  https://github.com/aframevr/aframe/pull/2475 should fix  @salmanfarisvp what issue are you having with `git clone git@github.com:aframevr/aframe.git` I see. This seems to be the issue 
https://github.com/aframevr/aframe/issues/2178#issuecomment-267395742 I personally prefer to use `git@github.com:aframevr/aframe.git` since it uses the keys already setup in my system. @ngokevin What do you think?

 Thanks!  @salmanfarisvp You may not have a public key attached to your GitHub account: that would prevent cloning from git@ URLs. You can fix that [with these instructions](https://help.github.com/articles/error-permission-denied-publickey/#verify-the-public-key-is-attached-to-your-account).

Alternatively, try cloning from the HTTPS version of the URL:

```
git clone https://github.com/aframevr/aframe.git
```  I'm not too familiar with this, but I think [adaptive streaming tends to require extra libraries](http://stackoverflow.com/questions/28529383/why-do-i-need-dash-js-for-streaming-mpeg-dash-videos), like dash.js. If you set all of that up, it could certainly be possible to use with THREE.js or A-Frame. But, I haven't seen anyone implement this yet, and I don't think we're able to provide videos for testing sorry. @ronit-kadwane #2129 is merged does that solve it for you? Yes, this feature would be left as a component and to extra libraries.  @Charton100774 you should ask that via stackoverflow http://stackoverflow.com/questions/ask/?tags=aframe  I'm facing the same problem, and it's not related to expensive code, for example:
```javascript
var tween = new TWEEN.Tween({ alpha: 1.0 })
  .to({alpha: 0.0}, 1000)
  .onComplete(function () {
    console.log('completed');
  })
  .onUpdate(function () {
    console.log('updated', this.alpha);
  }).start();
```

Chromium:
![chromium](https://cloud.githubusercontent.com/assets/782511/23704941/9a365c66-0407-11e7-8a78-678a99f7e0a1.gif)

Firefox release:
![firefox](https://cloud.githubusercontent.com/assets/782511/23704952/a11fd0ac-0407-11e7-9dff-21249b164d06.gif)

Firefox Nightly:
![nightly](https://cloud.githubusercontent.com/assets/782511/23704959/a7f59aa6-0407-11e7-8eb4-ee0c40cd4266.gif)

But If I run the same on the console from one of the examples of the current TWEEN.js release on nightly, it works as expected:

![nightlytween](https://cloud.githubusercontent.com/assets/782511/23705038/fb9a6fce-0407-11e7-90c8-38bc6a532cfc.gif)

Maybe it's tme to update TWEEN? /cc @dmarcos @ngokevin 


 I've just tried to update to `16.6.0`  and the problem is still there :\ it's really strange because if I run the same code on the tween examples it works but if I run on the console with AFRAME injected it doesn't After discussing with @dmarcos it seems that there's a problem with the `TWEEN.update(time)` in https://github.com/aframevr/aframe/blob/master/src/core/scene/a-scene.js#L446.

Logging the `time` value on chromium seems to be consistent:
![image](https://cloud.githubusercontent.com/assets/782511/23706422/6ae696cc-040e-11e7-875e-9e751468698a.png)

While in nightly it seems to jump abruptly:
![image](https://cloud.githubusercontent.com/assets/782511/23706478/a1d26b20-040e-11e7-8f67-8fb3b09a871b.png)
 FWIW if we call `TWEEN.update()`, it will use it own timer (https://github.com/tweenjs/tween.js/blob/master/src/Tween.js#L52) and it seems to work correctly both in the examples and in the code pasted before. https://github.com/aframevr/aframe/commit/6a4bd10d4ac4b018ba7abea72532f8c4b0bc22c4  Make a button that calls requestFullScreen. https://developer.mozilla.org/en-US/docs/Web/API/Fullscreen_API  Thanks!  @Zergus the value of `data` will be passed in `event.detail`. Example:

```js
el.emit( 'actionstart', {value: 2} );
el.addEventListener( 'actionstart', function (event) {
  console.log( event.detail.value ); // 2
});
```

This is similar to the native [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events) `detail` property.  There's an `enter-vr-ui` component already. What about adding an `auto` flag to it? https://github.com/aframevr/aframe/blob/master/src/components/scene/vr-mode-ui.js We can rename that component to just `enter-vr`  Have the `src/systems/material.js` keep a running count of usage for each texture. When a material component detaches, it'll call the system's `unregisterMaterial`. In that system's method, check how many other entities are using that texture. If there are none, then call `texture.dispose` on it. The issue was fixed by https://github.com/aframevr/aframe/issues/2686. No need to do anything, the fix will be released with A-Frame 0.6.0. @tsotneguti because 0.6.0 has not released yet üòÑ  **Description:**

- A-Frame Version: 0.4.0 (current master)
- Platform/Device: Chrome, Firefox
- Reproducible Code Snippet or Demo URL [highly encouraged]: http://172.16.152.12:9000/examples/primitives/models/

```
TypeError: data[path[0]] is undefined

...

// Gather component data from mappings.
  for (i = 0; i < this.attributes.length; i++) {
    attr = this.attributes[i];
    mapping = this.mappings[attr.name];
    if (mapping) {
      path = utils.entity.getComponentPropertyPath(mapping);
      if (path.constructor === Array) {
        data[path[0]][path[1]] = attr.value; // ERROR HERE
      } else {
        data[path] = attr.value;
      }
      continue;
    }
  }
```
  I think this could live as a third-party component for now. Could even be simpler, just reading the rStats value and outputting with text component.  Thanks!  To do this, I think we just need the shader registration to recognize an additional type for textures. Specifically THREE.Texture ‚Üí 't' in THREE.ShaderMaterial uniforms. Yeah, I'd just use the ShaderMaterial API directly. Hm. ok textures are pretty pretty critical if there's going to be a registerShader API at all. I don't think this is the right line at which to ask people to switch from registerShader to using THREE.ShaderMaterial.

Especially since writing a component isn't that inconvenient for anyone who will be writing their own shaders. So a registerShader API that would be missing key ShaderMaterial features seems a little pointless. I think if we were to continue building the registerShader API, then yeah, texture support is mandatory. But I don't see the need for an API that tightly wraps ShaderMaterial, there's a lot of work for A-Frame to handle all of the uniform types and hiding three.js API. I'd rather registerShader just prescribe you to create a material through three.js. There's an issue filed to reconsider the API to be less hands on and more flexible. > I think if we were to continue building the registerShader API, then yeah, texture support is mandatory. But I don't see the need for an API that tightly wraps ShaderMaterial, there's a lot of work for A-Frame to handle all of the uniform types and hiding three.js API. I'd rather registerShader just prescribe you to create a material through three.js.

Ok. Yes I like either of those directions, just not the grey area in the middle of the spectrum. üôÇ Not just maps, we'd have to support a lot more things like all the uniform types and shader material parameters like fog or lights. @LarkinArt Whether `registerShader()` will evolve or be deprecated is TBD, I think, but in either case I would work directly with THREE.ShaderMaterial within a component, yes. [Here's an example](https://github.com/donmccurdy/webvr-experiments/blob/master/1-portal/components/transient-material.js#L19-L48).  Regression from probably non-recursive raycaster changes, checking it out. @ngokevin did you see this while working on laser-controls PR?  I assume you were using vive -- trying to understand if it is a core issue or an interaction with other components folks are using Yes. In the `examples/cursor-projection/` that loads an OBJ model. Errors on 2D desktop too.  Server side issue, the server did not allow CORS on the resource OK, will need to double check the XHR has CORS set. I believe it should, we set it on the XHRLoader (soon to be named FileLoader). Using an `<img>` in `<a-assets>` without crossorigin should work since A-Frame will auto-inject that.

I wonder about the inline URL piece though I've did an extra set of cross origin on the TextureLoader for inline URLs, maybe that will help even though we overrode the prototype already https://github.com/aframevr/aframe/pull/2544 Check if that works. https://rawgit.com/aframevr/aframe/ee12d49/dist/aframe-master.min.js  We'd need a simple test case that would reproduce an issue for A-Frame. Not sure what would happen with Nuxt (never used) + Vue  It provides a loader for scenes to show something on screen while assets and the scene initializes. It demotes `canvas` and `vr-mode-ui` to libraries from components. The loader needs them before components initialize.
 Glad to review this if it‚Äôs still on the roadmap. Or perhaps we should create an external component if we‚Äôre hesitant to put this in core? This needs more work. We will postpone for 0.9.0  Can merge this with #1846. We hide the videosphere demo on mobile for these reasons, and I don't have the answers. Lately, people have been getting inline video to work on iOS somehow. If you have any hints, check them in at #1846.  Thanks!  Yeah, that's the issue. Fall back to the September 23rd builds for now.  thanks!  Alternatively, pass a selector for the camera The screenshot component should always operate on the active camera. There's maybe oportunity for a `point-and-shoot` component Yeah, probably a different feature. Like a literal camera component that you can hold and see a preview.  **Description:**

Let's say I've got a custom shader that depends on the camera's position:

```js
const glsl = require('glslify');

AFRAME.registerShader('myShader', {
  schema: {
    vCameraPosition: { type: 'vec3', is: 'uniform' }
  },
  vertexShader: glsl.file('./my-shader.vertex.glsl'),
  fragmentShader: glsl.file('./my-shader.fragment.glsl')
});
```

I'll need to update `vCameraPosition` on every frame, but the shader itself doesn't have a `tick()` lifecycle method. So I can do that by adding a new component, instead:

```js
AFRAME.registerComponent('myShaderUpdater', {
  tick: function (t, dt) {
     el.components.material.material.uniforms.vCameraPosition.value.set(...);
  }
});
```

That works, but there's also no guarantee that the camera (or any other components my shader depends on) have already ticked. In practice, the shader ends up 1 frame behind.

Any suggestions on a better way to update uniforms? Some ideas:

1. Declare order/priority of components (sounds complicated).
2. Use a system (do systems always tick after components?).
3. Add support for `tick` lifecycle method to the shader itself, which should be invoked later than components. Closing this / not any sort of urgent.   r+  Thanks for bisecting. This makes the fix much easier I investigated this and It's a bigger problem than I thought. The root cause comes from the collision between the primitive mappings and some of the existing component names. Primitives map the `material.visible` to the `visible` attribute while `visible` is also one of the core components. When `visible` initializes it also triggers the primitive mapping update that sets the material component and the original `material` attribute is overwritten. 

I opened https://github.com/aframevr/aframe/pull/2145 to explore a solution. My first approach is to ignore mappings that have the same name as one of the registered components. This still won't work if components are register dynamically as the inspector does. @ngokevin What do you think?

I still don't know why https://github.com/aframevr/aframe/commit/8b0df2365c77dd43666afb6f63e922b4d4037753 unveiled the issue and we did not see it before.  What about this one?
````javascript
data[key] = typeof defaultValue === 'object' && defaulValue !== null? utils.extend({}, defaultValue) : defaultValue;
```` Well this another case:
````javascript
typeof [] === 'object'
````
But if we have an array as default it would be a single property schema and it would not run the line you pointed out. Your proposals are good but I think mine it's a bit more explicit and easier to understand. @jesstelford You're more than welcome to submit a PR if you want to take this. Can you add a test to cover for the bug? @dmarcos @jesstelford I've filed a bug separately but of the suggestions so far, only one handles arrays correctly:

```js
data[key] = (defaultValue.constructor && defaultValue.constructor === Object) ? utils.extend({}, defaultValue) : defaultValue;
```

See also, [is-plain-object](https://github.com/jonschlinkert/is-plain-object/blob/master/index.js).

Default values may be arrays whether it's a single-property schema or not, so I don't think there's an easy out there. Although, IMHO, primitive types `string` (or `int`, `number`, ...) should be non-nullable and either cast to an empty string, or throw an error when assigned a non-string default value like `null`. But that's personal preference and not really the question here. :)  Warning added.  **Description:**

Common case to only want to call a tick behavior on an interval rather than every frame.

```js
AFRAME.registerComponent('foo', {
  tick: utils.throttleTick(function (t, dt) {
  
  }, 500);
});
```

This would keep track of last time the function ran, and wait 500 ms before calling again.

 Added  `auto-detect-controlers` would be an excellent contribution for [the registry](https://aframe.io/aframe-registry/). For the core I prefer to have lower level and simpler components. In order to support touch I would add a new component `oculus-controls` that is similar to `vive-controls` but specific to touch. I would then modify `hand-controls` to add `oculus-controls` and `vive-controls` to the entity at init time and map the events to the high level actions: thumbup, thumbdown, gripclose, gripopen, pointup, pointdown.

I developed the rational a bit more here:

https://github.com/aframevr/aframe/pull/2124#issuecomment-262604106 I don't think you actually need an `auto-detect` logic in a new compoennt. The `oculus-controls` ,`vive-controls`, `daydream-controls`... will query the gamepad API and look for the corresponding id. If the controller they're looking for is not present they won't do anything. You could have something like:

```html
<a-entity daydream-controls vive-controls oculus-controls></a-entity>
````

Only the one that corresponds to the available controller will be active. There will be an implicit auto-detect logic hence there's not necessary a new component just for detection I think It's unlikely that there will be 11 controllers in the market. Even if there are most of the experiences will focus in 1 or 2 because the capabilities are very different. Doing an experience for Daydream is very very different than doing one that uses the Vive. Also in the worse case there's very little cost on dragging 11 components around on a single entity in the scene. I would defer something more complicated until those things are a real problem. You might be right and `hand-controls` should not be part of the core. Once the registry is officially released and devs get used to it we will consider to move it out. @machenmusik thanks for the criticism by the way, we really appreciate these discussions :) I agree with @machenmusik that things will get messy quick once more controllers become popular. But also agree with @dmarcos when the need arises, we can improve the API and decide what's in core, what's not, how new controllers can be registered cleanly. I think @dmarcos wants the simplest approach right now while keeping the abstractions reasonable, and we can extend later.

And yeah, really appreciate the PRs, tough problems! I think short-term, we could abstract how @dmarcos suggests. Separate Touch component, and support hand-controllers temporarily to be able to use both. That shouldn't take too long. After that, we can easily have master builds that support Touch, as well as introduce different controller components in the Registry that are easily consumable.

Long-term, we can try to envision an API that will handle most controllers and controls (which you are giving great ideas for). We have a PR open for extensible controls we might be able to utilize.  Is there any problem of each controller calling `navigator.getGamepads` to detect if the controller they're looking for is present? We could make a `utils` function that both `vive-controls` and `oculus-controls` components use. `utils.isControllerPresent(controllerString)` . The controls first make that check and if the controller is present then they set the string on `tracked-controls` and attach event listeners. If the controller they're looking for is not present they'll just remain inactive. `tracked-controls` should not call `getGamepads` on every tick. We keep a reference to it:

https://github.com/aframevr/aframe/blob/master/src/components/tracked-controls.js#L31

That reference changes when the controller and/or id properties changes.  Those properties is what `oculus-controls` and `vive-controls` will set.  Oh that's the system `tick` That's necessary because there's no events to know when gamepads are connected or disconnected (constraint of the Gamepad API).This is in the `tracked-controls` system which is a singleton. There will be just an instance regardless of how many entities use the `tracked-controls` component.  We can find ways to improve it. Correct. If you have `oculus-controls` and `vive-controls` on the same entity you will just have one `tracked-controls` instance. On the `init` method of `oculus-controls` and `vive-controls` you will have:

1. Check if the controller you want is present. `utils.utils.isControllerPresent(controllerString)'
2. If it is present you set the `id` and `controller` you want on `tracked-controls` and  `attachEventListeners` to be able to emit the corresponding button events.
3. If it is not present then you do nothing :). The component stays quite and out of the way.

 `tracked-controls` will always fire events. `oculus-controls` and `vive-controls` will decide if they want to listen to them or not. You could have a flag `listenToEvents` that you can add to the `play` \ `pause` methods to decide if you want to attach the listeners or not:

https://github.com/aframevr/aframe/blob/master/src/components/vive-controls.js#L50 @machenmusik Yes could definitively debounce the calls to `getGamepads` I requested a few more changes. We're getting closer :). Thanks for sticking with it Hi @machenmusik I've just tried the `tracked-controls` example and I've found the following issues so far:
- If you press and/or release the grip button it does the animation instantly, but if you do the same for the trigger it takes a time to change the state, having so much delay. In fact if you keep pressing the trigger the animation doesn't change at all.
- I've tried to grab the cubes using any of the buttons/triggers and I couldn't move them.

I'll keep trying to see if I find more issues.
Thanks for your work on this PR! @machenmusik testing on oculus @machenmusik probably manually changing the position of the cubes on the example itself: https://github.com/aframevr/aframe/blob/master/examples/showcase/tracked-controls/index.html#L29 to something closer Should we add the teletransport component to the example? @fernandojsg I just noticed that there're no events for just "touch" buttons as they do on oculus games, I mean if you want to just do a fist you don't need to press both trigger, but just touch them (the same as we've the touchstart/end on vive and then we've a button value). Is it because the gamepad api doesn't expose them yet? Unit tests? Mock/stub if we need. 700 LOC, there'll bound to be bugs and regressions arising from future maintenance. @machenmusik I give you a starting point:

https://gist.github.com/dmarcos/b53c571919f56e289faa103957c498b5 @machenmusik the link to the gist on my previous comment was wrong. This  is the one:
https://gist.github.com/dmarcos/b53c571919f56e289faa103957c498b5  Thanks  This might be a breaking change. Components might be expecting a string. If we do this for video, we should maybe be creating video elements if a string is passed, and same for audio and images, and to also inject to a-assets so it's referencable. Will need to look into that I'm worried that previously components always accepted a string, now they can sometimes get a string or an element. I think I'd like to ensure that an element is always received if we do this to keep things consistent:

1. If it is a selector, just return the element. Ensure it has a `src` set.
2. If it is a URL, then maybe we create a media element for them, setting the src, ensure `crossorigin` and `playsinline`. And we append it to `<a-assets>` so they have a reference to it if they want to control media playback.

This PR does look like it fixes things without breaking any official examples, but I think I'd like to resolve it completely. For your case, you could work with an A-Frame fork for a while. Then once it's committed, we'll start having auto-generated master builds you can use. Sorry, just got back from vacation and work trips, will look at it tomorrow as I prepare release. Thanks!  https://github.com/aframevr/aframe-site/commit/661b154dd1e16f417625050ad18989a66fef49e6

fixed, thanks!  Do you have this tested with an Oculus Touch? Don't need to commit the dists. Thanks. That will require some thought on how to untangle and handle different controllers gracefully. Not too worried on getting it out too soon since we are about to ship a release, and Touch controllers are still rolling out. Here is what we have now:

```
hand-controls
<adds hand model and uses events from>
vive-controls
<adds button mappings and uses tracking from>
tracked-controls
```

What do we need? Maybe:

```
hand-controls, vive-controls, oculus-controls, X-model-controls
tracked-controls: handles both tracking + button mappings?
```

But @dmarcos and @fernandojsg have played with controls more than me. Is there a need to make `modeled-tracked-controls` separate? We can assume controllers will always have models + mappings. I see, maybe it's OK to just duplicate the mappings between the uppermost layer? We can expose common mappings as a constant. As opposed to what I think you are proposing, a thin intermediary component just to handle mappings. I would start simple and just add `oculus-controls` and a logic to `hand-controls` to select either `oculus-controls` or `vive-controls` at runtime.  I don't think `modeled-controls` is an abstraction we need. What about adding a `modelSrc` property to `tracked-controls`? We would have `tracked-controls` that optionally loads a model through a `modelSrc` property and then `oculus-controls` and `vive-controls` will manage button mappings, controller specific events and animations / highlights related to the model.  `oculus-controls` and `vive-controls` will use `tracked-controls` , set the appropriate `modelSrc` and pass the corresponding string for the gamepad id `OpenVR Gamepad` \ `Oculus Touch`. You could add both to an entity if you want to support both Touch and Vive:

`<a-entity oculus-controls vive-controls></a-entity>`

If either the Oculus or Vive gamepad is not present then the corresponding controller will have no effect on the entity. 

More abstract controls like `hand-controls` will set both `oculus-controls` and `vive-controls` on the entity (and maybe `daydream-controls` in the future) , set the `model` property to false and map the buttons to the specific high level actions: pointing, grip, grab... `tracked-controls` won't be much heavier. It would just handle the model loading.  If you have exotic model formats or want to make something procedural you could always handle that yourself in your higher level component: `hand-controls`,  `magic-wand-controls` ...

An alternative is to leave `oculus-controls` and `vive-controls` to handle the model loading. That would mean some potential code duplication but everything is simple and clear Authors don't have to enumerate the controllers manually. For instance `hand-controls` (and other high level controls schema) would instantiate and configure them in the init method:
``` javascript
el.setAttribute('vive-controls' { ... });
el.setAttribute('oculus-controls' { ... });
````
The capabilities of each controller are very different. Daydream is only 3DOF, Vive has a touchpad, Touch has two analog joysticks and two triggers. Each application and type of controls should explicitly decide what input to use and how integrate it. Integration is not straight forward and there's going to be cases where you cannot simply support all inputs for your interaction model. You cannot for instance do a-painter with a Daydream controlller or there might be an application that uses the two analog triggeres of the Oculus Touch in a way that won't work in a Vive controller. We should favor highly reusable non opinionated components in the core and let 3rd parties to compete on the higher levels of abstraction.  I's fine to have an old version of a dep lib. Upgrading it won't do much, but I plan to replace tween with anime anyways.  The capture seems correct to me. The scene is rendered differently for each eye. Look at the image on the left side inside the white band. What do you mean by your eyes don't identify they're stereo?
 Which Android device are you using? OK, this seems exclusive to large Android phones. I'm glad you found https://github.com/googlevr/webvr-polyfill/issues/176 , that's the appropriate area to fix. Will leave this open for now. @thoragio Thank you! üèÜ Can people confirm that https://github.com/aframevr/aframe/pull/2345 fixes this issue? https://github.com/aframevr/aframe/pull/2345  try https://www.npmjs.com/package/aframe-star-component
  What do you exactly mean by form controls?
 Can you describe a use case?
 Widgets and interactions can be accomplished through application-level or community components, does not need to be part of the core.  In cases like these, you would document your component to prescribe certain response types? Or have the component handle both? Would there ever be an issue where two components are expecting different response types on the same asset?
  thanks!
  **Description:**

The root issue was the dependencies were not being initialized for primitives because primitives were trying to do `setAttribute` on `attachedCallback`, but at that time `Entity.load` had not been called yet, so dependencies were being blocked from initializing on `el.hasLoaded`.

I initially tried keep them more-or-less separate and give primitives their own `load` method, but it  got messy fast and it became much easier to have the `Entity` prototype have knowledge of the extra data supplied by primitives (through `defaultComponents` and `mappings`). Thus I made primitives implement a method called `getInitialComponents` which the Entity can pull from. 

As an extra bonus, this also means primitives no longer have to duplicate some of the Entity data building process. Primitives only have to worry about default components + mappings, and the entity handles the other data sources.

I made `getInitialComponents` a method rather than having primitives set a property because when an instance of a primitive was setting the property, it would overwrite that property used by other instances sharing the same prototype.

**Changes proposed:**
- Primitives implement `getInitialComponents`.
- `Entity.updateComponents` includes `getInitialComponents`, merging it on the level of DOM components

 I would try to avoid adding extra complexity on `a-entity` to fix primitives. I need to think about this and see if there's another way to solve this.
 I'm not worried about duplicated code in primitives.
 Primitives need a way to hook in early into the component initialization process or else it's extremely difficult to maintain. I've refactored primitives over and over but there's always been issues, I'd like to just end it with a tiny hook and not have to maintain it. The hook isn't primitive-specific code and won't affect existing entities.
 I spent a couple of hours trying to mixin the primitive `defaultComponentsFromPrimitive` into `defaultComponents`. I have the hunch that it might be the cleaner way to fix this. In the process I discovered an inconsistency in the system. Values in the default components are not honored. For instance if you do:

``` javascript
var proto = Object.create(ANode.prototype, {
  defaultComponents: {
    value: {
      position: '2 2 2',
      rotation: '',
      scale: '',
      visible: ''
    }
  },
```

The position value is not applied. I think fixing the inconsistency together with the mixin I described above might be more elegant.
 @dmarcos that would need to be `position: {x: 2, y: 2, z: 2}` ‚Äî I patched this into one of my examples and default position still works.
  @takahiro Thanks for this! 

@james-h-stephens To get a better picture, can you give a specific use case for this?

Need to think because this property type would probably only be set by other components since it's awkward to hand-code it.
 The rightmost column of affine 4x4 matrix is always [0,0,0,1] that's why some engines uses 4x3 matrices instead of 4x4, maybe we could simplify this one using just 4x3 (and then it will be parsed still to a THREE.Matrix4) but without explicitly define the latest column?
 Should the property be explicit about column-major vs row-major format? The latter is more readable to me, but the former is required for `THREE.Matrix4.fromArray(...)`.

From an ergonomics perspective, I think I like this syntax:

```
<a-entity my-matrix="1  2  3  4,
                     5  6  7  8,
                     9  10 11 12,
                     13 14 15 16">
</a-entity>
```

.... but the output should be a flat array, regardless, as it is here.
 I screwed up and started a duplicate PR, #2113. If we're still undecided on syntax here feel free to compare/contrast.
 Agreed. Summary of my vote:

Serialized / user input: row-major, either `n1 n2 n3 n4` or `n1 n2, n3 n4`.
Deserialized / output: Either column-major array, or THREE.Matrix4. > what type/format of parse() and stringify() input/output/defaultValue should be

any resolution on this?
 I'm happy with @takahirox's implementation as it stands:

- in serialized form: row-major space-separated string.
- in deserialized form: column-major array.

I do realize that this preference sounds inconsistent. IMO the deserialized form _must_ be either column-major or a THREE.MatrixX ‚Äî those are the two forms that will play well with three.js. Row-major is nice for readability, but if we think readability of matrices in HTML is less critical than API consistency, we could change the serialized form to column-major as well.

EDIT: row-major in, THREE.MatrixX out would be acceptable too, without the internal inconsistency, but then is no longer consistent with the vector types, which don't return THREE.VectorX. This needs rebase @takahirox what use cases do you have in mind for this type? About rebase, ok. 
Regarding use cases, for example applying rotation matrix. Not sure what to do with this PR. No complains about code or the API. My issue is that I struggle to find good use cases for the matrix type. I also think that the components APIs are a layer on top of three and passing matrix values around in my view breaks the level of abstraction. I propose shelving / archiving this PR until we find a legitimate use case. What do you think @donmccurdy @ngokevin @fernandojsg ? @dmarcos I don't think it breaks the abstraction ‚Äî reasonable that someone might want to encapsulate scale/position/rotation, and matrices are the appropriate primitive for that ‚Äî but I don't have an immediate use case, either. We've done OK without even an official `quaternion` component, so maybe it is best to table this.

I'm certainly OK with re-opening this PR in the future though. As per prior conversations. I'm archiving this for future reference.  Thanks!
  thanks!
  Will look into it.
 Yeah. The actionable thing to do here is to convert that A-Frame example video to a friendlier codec.
 @JonathanGrant You can try any a-frame scene on regular Chrome and see if the video plays. (https://aframe.io/examples/showcase/videosphere/ plays fine) You won't be able to enter VR but at least you know if it's a problem with the video codec or something else.
  Oculus touch has to be first supported in browser in order for us to integrate it.
  @theDrGray I'm going to close this. Please reopen if you think it's a problem with a-frame
  Thanks!
  Performance stats inside VR mode is really needed. Just a FPS counter attached to the headset tracking, in a corner of the screen, or even just a small quad with a color code indicating if fps > 90 (green) or not: orange ( >= 80 ),  red ( <80 ).. https://github.com/ngokevin/kframe/tree/master/components/fps-counter#aframe-fps-counter-component  **Description:**

Systems are currently pretty much just components that auto-initialize on the scene and set a `this.system` reference to components that match the system name. The concept is that they are services or managers for components, but there is not much API or features to it, only semantics.

The issue is that we have to maintain both Systems + Components. This means extra code for us, and extra concepts for developers. And then things like the Inspector and Registry have to take the differences into consideration.

The proposal is to remove `AFRAME.registerSystem` and use `AFRAME.registerComponent`.

## API

The true MVP is to just remove the idea altogether and use components. The developer can specify the API and separation of concerns.

```js
AFRAME.registerComponent('physics-system', {
  addBody: function (el) { // ... }
});

AFRAME.registerComponent('physics-body', {
  init: function () {
    scene.components['physics-system'].addBody(this.el);
  }
});
```

But we could add a property to differentiate a normal component and a "manager" or "system" component. This alone can enforce that the component must be added to `<a-scene>`. And that perhaps auto-initializes once it's registered.

```js
AFRAME.registerComponent('physics-system', {
  system: true
});
```

Taking it further, we can instead specify the components it oversees to give it references and handlers:

```js
AFRAME.registerComponent('physics-system', {
  manages/systemOf: ['physics-body', 'physics-joint'],

  entityAdded: function (el, component) {
    PhysicsWorld.addBody(...);
  },

  entityRemoved: function (el, component) {
    PhysicsWorld.removeBody(...);
  }
});

scene.components['physics-system'].entities
```

Then @dmarcos thought about handling entity updates and marking them as dirty such that system updates in response to a component update are run only once per tick as well.

## Benefits

- Less concepts for A-Frame. There are only Entities and Components.
- Get all of the magic of components (lifecycle, data management). 
- Smaller API surface area. We can delete a bunch of code and documentation and issues.
- The Inspector gets "system" support for free.
- Fixes issues we have currently with systems (no update/play/pause). @wizgrav I don't think it's necessary to define any API for execution ordering, the developer could have control over it. If you defined a system that oversees multiple components, you'd have a group of entities that have all of those components, then you can do as you please.

``` js
AFRAME.registerComponent('foo-system', {
  systemOf: [['bar', 'baz']],

  tick: function () {
    var barData = this.entities[0].getAttribute('foo');
    var bazData = this.entities[0].getAttribute('baz');

    // 1. Do stuff with barData.
    // 2. Do stuff with bazData.
    // Do whatever.
  }
});
```
 That's why you wouldn't put `tick`s on the components. You have the components act as data containers, and delegate the logic/execution to the system.
 For physics, my components implement a `step()` function, and the system invokes those in custom (two-phase) ordering.

I wouldn't want to reduce systems to unprivileged components without also having real control over `tick()` order. That would potentially break physics badly. Managing `tick()` order seems like a much harder problem. Having systems extend the Component prototype, and support play/pause, would seem great though. Is it possible to merge system/component code while continuing to support a two-pass `tick()`? So there would still be a concept of systems, but fewer codepaths?

I also like the `systemOf` syntax. I could see AFRAME.registerSystem just being an alias of AFRAME.registerComponent that enforces/requires a `systemOf` property. We could make systems extend components, but there's a lot of code involved in managing the lifecycle. Right now, the lifecycle is the same so it makes sense to make them components with some extra sauce. The minimum level of extra sauce, IMO, would be that system-components' `tick()` handlers are invoked after all components on scene descendants. Or, alternatively, one of the various tick ordering proposals. What are the open questions for answers/feedback on this currently? I'm currently thinking having Systems extend Components but keep the `registerSystem` API. I can imagine Systems gaining more functionality like `entityAdded` and `entityRemoved` handlers. I'll close this for now as System updates just landed and there is currently a separate issue for entityAdded/entityRemoved handlers. If refactoring is needed later, we can re-evaluate.  @james-h-stephens working on this, but also there is a `vec4` property type that [works well for quaternions](https://github.com/donmccurdy/aframe-physics-system/blob/master/src/components/math/quaternion.js).
  **Description:**

```js
entityAttached: function (el, componentData) {

},

entityDetached: function (el, componentData) {

}
``` `entityAttached` vs `componentAttached`?
 Not fleshed out yet, but probably entity. The entity is now managed by the system. You could possible do neat stuff like specifying two components, and matching entities that only have _both_ of those components (e.g., `enemy` + `dead`).
 This could be done nicely with mutation observers:

```js
var observer = new MutationObserver((mutations) => console.log(mutations));

observer.observe(sceneEl, {
  subtree: true,
  attributes: true,
  attributeFilter: ['foo']
});
```

Except that sadly it won't catch `foo__1`.   thanks!
  thanks! it should be load
  thanks!
   Related: https://github.com/aframevr/aframe/pull/1515

The above solution makes cubemaps an entirely separate shader, but they should perhaps be a property type that can be used for any property.

I was thinking whether the `map` property type could support both textures and cube textures. Would that make sense to do? If I have `<a-sky>`, could `src="#myMap"` and `src="#myCubemap"` both work, or should they be separate properties?
  Thanks!
  I believe the syntax for a link is already correct. Is not the link working for you?

https://github.com/jpetto/aframe/blob/44a9ca12f66ab4e846cb9992c5d45487a4f71a8e/docs/guides/building-with-components.md

On the markdown docs I see that a link is expressed as `[link to Google!](http://google.com)`

https://guides.github.com/features/mastering-markdown/
 understood! Thanks!
  It would be nice to offer a different set of mirroring options with VR:

![view-modes](https://cloud.githubusercontent.com/assets/1560884/19981721/4edb8876-a1c0-11e6-8bee-eef236ffb496.png)

 Since 0.8.0 there's a spectator mode for the camera component https://aframe.io/docs/0.8.0/components/camera.html#properties_spectator

I have not seen much demand for the reduced mode. Should it be part of the core or an advance feature provided by external components?  Try setting `window.scrollTop to 0
 Well, it's a Safari problem. If you can find any solutions such as http://stackoverflow.com/questions/24889100/ios-8-removed-minimal-ui-viewport-property-are-there-other-soft-fullscreen , that'd be great...else we recommend more recent hardware/software.
  thanks!
  Thanks!
  I think that sounds good. I don't imagine needing non-ID selectors for assets.
  moved to a-painter https://github.com/aframevr/a-painter/issues/156
  Here's a test I wrote, it oddly passes:

``` js
+     test('initializes defined dependency component', function (done) {
+       var el = document.createElement('a-entity');
+
+       registerComponent('root', {
+         dependencies: ['dependency']
+       });
+
+       registerComponent('dependency', {
+         schema: {foo: {type: 'string'}},
+         init: function () {
+           assert.equal(this.data.foo, 'bar');
+           delete components.root;
+           delete components.dependency;
+           done();
+         }
+       });
+
+       // Create entity all at once with defined dependency component and component.
+       el.setAttribute('dependency', 'foo: bar');
+       el.setAttribute('root', '');
+       this.el.appendChild(el);
+     });
```

Any suggestions for this test case?
 OK thanks! I'll try to inject raw HTML as string then.
  **Description:**

Lots of properties for THREE.Texture at https://threejs.org/docs/?q=texture#Reference/Textures/Texture , how to expose these in a clean way for each kind of map?

Maybe a texture property type?

```
material="map: [src: #texture; anisotropy: 1.1; flipY: true]"
```

Or a indirect route?

```
material="map: #texture__map"
texture__map="src: #texture; anisotropy: 1.1; flipY: true"
``` Looking at https://aframe.io/docs/master/components/material.html#built_in_materials and how there are multiple map types trying to expose every texture properties for each one, it seems necessary for a separate texture component. @dmarcos toyed with this before.
 I think this will be important as currently, we have to create a different property on the material component for each type of map, duplicating a lot of the texture setup. The standard shader has:
- ambientOcclusionMap
  - intensity
  - repeat
  - offset
- displacementMap
  - intensity
  - repeat
  - offset
- normalMap
  - intensity
  - repeat
  - offset
- map (src)
  - intensity
  - repeat
  - offset

Then what if we want to add a new texture property, like configure the wrapping or flip? We'd have to add it to each single one, and in the code, we'd have to duplicate logic.

A separate texture/map component would be cleaner. It could have its own system for caching. You just define a texture component, and reference from the material (or any other) component.

`material="map: map__texture" map__texture="src: #textureImg; anisotropy: 1.1; flipY: true"`

And alternative, allow inline definition

`material="map: [src: #textureImg; anisotropy: 1.1; flipY: true]"`
 I'm not 100% sure whether I like this any better, but for discussion's sake here's a counter-proposal. No integration with the existing `material` component, just a separate `texture-config` component that modifies properties of the object it's attached to, whether there's a `material` component or a model of some kind.

```
<a-entity obj-model="obj: url(...); mtl: url(...);"
          texture__customemissive="map: emissiveMap;
                                   src: url(emissive.png);
                                   flipY: false;>
</a-entity>
```

If `src` is omitted, it would just modify the existing texture on that object, if any.

Potentially more complicated if this is a model with multiple meshes. Apply to them all? Allow a `name` selector? I think my concern with the original proposal is that it's verbose and requires changes to the schema, for a case where I (personally) would probably just define the THREE.Material in a component.

Like, I'm not going to want fine-grained control over textures on a cube geometry, and if it's a custom mesh then why not package textures with that? Where I might want this would be to, say, add an emissive channel to something exported from MagicaVoxel ([example](https://twitter.com/donrmccurdy/status/838971043909894145)) and in that case there would be no `material` component to begin with. I wasn't thinking of this issue as being specific to custom shaders; seems valid even for the default three.js material types. But whether the issue is common enough to be worth a component (or schema changes) in core at this point I'm not sure.

Example: MagicaVoxel doesn't export an emissives channel, so I threw together [this component](https://github.com/donmccurdy/webvr-experiments/blob/master/3-postprocessing/components/material-map.js) yesterday to add that. Could have done this in Maya or Blender, of course, but eh. Or maybe you want to enable/disable emissive when something turns on, etc. Maybe this could be done more internally by having a texture property type of some sort that gets mixed into the material just for code quality (easier caching of identical textures, easier handling of updates). Maybe I'm not sure what problem you want to solve, sorry.

My working assumption is that very few developers will use things like `aoMap` with the `material` component, much less `aoMap.flipY`, because the `material` component isn't very compatible with custom models and occlusion maps of primitive geometries aren't very interesting.

But if there's something about the current implementation that would benefit from cleanup then please go ahead. :)

EDIT: And, is there caching that can't be done at the TextureLoader level? I want to solve manually implementing multiple different texture property types for each type of map and be able to easily add more texture property types to each.

I also want to improve texture caching, in memory and for the GPU. TextureLoader handles network caching, not memory and not sending duplicate texture data to GPU. We currently cache textures if they have the same `src` and same `repeat`, but there are much more texture properties to take into account.

I agree though that perhaps these property types aren't important for the basic material component, and they could just be imported using glTF. I'll close this then in favor of more of a code quality / refactor route without affecting the API to descope this.  Workaround might be to do a super stub of the `window` with `global.window = { ... }`. 

aframe-react actually only needs `AFRAME.components`, so yeah, need to find a way to decouple for Node purposes.
 Solution might be to have a `browser.js` entry point and a separate `index.js` entry point which contains Node-friendly requires. The `browser.js` entry point can export what `index.js` does. Point `package.json` `main` to `index.js` and `package.json` `browser` field to whatever is in `dist/`.
 #2484  thanks!
  https://github.com/aframevr/aframe/commit/aca4f90584a78262e9567c6b67d2aec74878027f
  You can ask on StackOverflow.

I posted and answered it at:

http://stackoverflow.com/questions/40336251/how-do-i-add-a-tick-timer-clock-or-behavior-to-my-scene-that-runs-continuousl/40336252#40336252
  Need to `npm run lint`
 Looks like we have to bump Node for the lint tests to run well on Travis. But can you do `npm run lint` to fix lint errors?
 Yeah, can you run `npm run lint` locally and fix those errors? It also now needs a rebase. 
 Thanks for addressing the lint. Working on reviewing this now. I have fetched and rebased this. I'm currently doing some cleanup and refactoring and will get merged/approved shortly.
 How come we are doing `el.getAttribute('preload') === 'none' || !el.hasAttribute('preload')` to check for media element progress. What's the situation on what audio and video need to preload?

Video: needs autoplay
Audio: needs preload

?
 I dug into this more. There is an issue. There is no way to get the number of bytes through HTMLMediaElement progress events, only time/duration. Ideally, we'd be able to calculate total size of assets in the scene in bytes. But right now, XHRs give bytes and HTMLMediaElements give seconds. There isn't an easy way to get an accurate percentage or progress.

I think the solution is to not rely on HTMLMediaElement progress, and use XHRs for everything. However, with HTMLMediaElement, I was confident that the browser would cache these types of assets. My question is: is there a way to make the browser cache video/img/audio that are requested first via XHRs and ensure that only one XHR is sent per asset? > There is no way to get the number of bytes through HTMLMediaElement progress events, only time/duration.

Did you check on responses with and without `Content-Length` HTTP response headers?
 > My question is: is there a way to make the browser cache video/img/audio that are requested first via XHRs and ensure that only one XHR is sent per asset?

It's a hack, but probably the most bulletproof way that comes to mind: I'd suggest monkeypatching three.js' XHR loader.
 @jonalex let me know if you need help with this; I'm excited about this functionality Yeah, I've been looking through this code just recently, which I was commented here. I'll follow up at some point here and let you know if/where the assets logic could use some help; stay tuned. Thanks for your help - it's much appreciated.
 is this close to graduating from WIP? is there anything I can do test or simplify this? If you can get it to read byte progress from media elements, be my guest.  This pull request contains a merge commit instead of the changes. Try starting with a new branch:

```
git checkout -b mybranch
```

Rebase. Make sure the `aframevr/aframe` repo is added remote in your `.git/config` (let's call it `upstream`).

```
git pull --rebase upstream master
```

Then make your changes and commit. Push your changes.

```
git push origin mybranch
```

Then make your pull request :)
  The browser and device support will change a lot. Maybe just a plain link under the `Find out more:`.
  thanks!
  yeah that's a bug, can you fix it? thanks!
  **Description:**

Only works in Firefox. https://developer.mozilla.org/en-US/docs/Web/Events/contextmenu

But helps discoverability of these tools.
  **Description:**

Just a random idea.
- Rely less on `this`.
- Make functions more contained such that they can easily be adapted, unit tested, and more predictable. You wouldn't need to the DOM to test.
- Makes it more explicitly apparent what is available rather than a `this` namespace.
- If another framework wanted to adapt the A-Frame components, they could write an adapter for `entity`.
- By passing in state, modifying it, and returning it, we could have debug tools to keep a history of all state changes. (i.e., state machine). Perhaps open doors to composing/wrapping functions

```
AFRAME.registerComponent(‚Äòfoo‚Äô, {
  initialState: {
    currentPosition: new THREE.Vector3()
  },

  schema: {},

  update: function (entity, data, state, oldData) {
    state.currentPosition.x += 1;
    return state;
  }
});
```
 @mflux Can you articulate what `this` confusion mean? Simply passing the prototype of the component to `registerComponent`  as we do know is simple and effective.  Using `this` is pretty vanilla JS and every developer regardless of the library they come from understands it. In your example, It's not clear what `context` is without having to read extra docs. The current architecture is not opinionated and very flexible. You could wrap your variables in a closure if you prefer or you could even create your own `registerComponent` that implements the pattern you describe. 
 You can actually do what you describe... You can create `AFRAME.registerComponentFn`.
 I think he means you wouldn't have to do [method binding](https://github.com/aframevr/aframe/blob/master/src/components/look-controls.js#L67), doing [`var self = this`](https://github.com/aframevr/aframe/blob/master/src/components/scene/inspector.js#L59), or doing like [`var x = this.x`](https://github.com/aframevr/aframe/blob/master/src/components/light.js#L43).

I can see the benefits. This is still vanilla JS, and you don't know what's in `this` either without reading the docs. At least with `context`, you can `console.log` it and read it cleanly. They're both equally flexible, this is just a bit cleaner. You'd also be able to create private "methods" that have still access to the scope, which currently you can't.
 It's also prescribe developers to [pre-define all their state/internal variables up top](https://github.com/aframevr/aframe/blob/master/src/components/light.js#L32) and discourage them from [calling handler functions as if they were methods](https://github.com/aframevr/aframe/pull/1853/files#diff-6285039eee70ed830f70f7d2f7b7dfa5L60).
 I like simplicity over all. @mflux design is for me a proof of success of keeping things simple and unopinionated. He comes to a-frame with his own particular background and was quickly able to successfully bend the current design to his own taste. 
 Awesome. At the very minimum, we can expose the Component prototype now.

I'd like to write components this way too as it would be much easier to unit test and decide what is private and public. Ideally, we could be able to pass a prototype _or_ function into the same function while having both of them go down the same code path and not introduce extra API. Will have to explore that more.

Also reminds me a bit of React. All components were classes/prototypes, but then they introduced stateless functional components where you could define a component via just a function, input props and output the render `props => <ReactComponent/>`. 
 Having used them in AngularJS, Express, and Koa, my opinion is that state management through `state`/`context`/`scope` arguments often introduces more inconsistency than it fixes, and I would prefer not to see that become a required pattern. The nuances of `this` are inherent to JavaScript, and the community is already dealing with those at the language level (fat arrows, `class` syntax, etc).

Exposing component prototype makes sense to me; I'm certainly supportive of letting devs write however they prefer.
 The prototype is exposed now. We can create a third-party wrapper and try it out, test its ergonomics.
 While I like the closure syntax more than our current state, we're on the road we're on...hopefully `class` syntax might help things later on.  **Description:**

Something to do with the webvr polyfill buffer scale again?
 Probably a result of the WebVR polyfill post-processing. Will check issues there and remove from the Milestone.
 Can we do both at the same time? Thanks! Yeah, we can give it a couple of days.

This issue is reported to also affect iPhone 6. Maybe because the VR effects (e.g., barrel) applied by the polyfill degrade the resolution? I believe the step is to target when in the WebVR Polyfill the blur was introduced. This is made difficult due to WebVR API migrations. My guess is it was when the barrel distortion and VR effects were added to the polyfill. The solution may be to introduce a way to toggle off those effects to preserve resolution. 

https://github.com/googlevr/webvr-polyfill The PR is up. Need help testing, use this link: https://rawgit.com/ngokevin/aframe/polyfilldist/dist/aframe-master.min.js > "It does the trick for me on an iphone 7 Plus" - dmarcos

> Before

![img_3332](https://cloud.githubusercontent.com/assets/39342/22672380/644ce8cc-ec88-11e6-8990-8f774e602803.PNG)

> After

![img_3331](https://cloud.githubusercontent.com/assets/39342/22672379/644c7a40-ec88-11e6-816d-9cded0680d13.PNG) Try with anti-aliasing enabled? Oh, I never noticed you were comparing to a native app. I thought the side-by-side were with an older version of A-Frame the whole time. I'm not surprised by that given the rendering runs through WebVR polyfill post processing effects (distortion, sampling). @mkeblx Any ideas on why A-Frame scenes might be blurry in Samsung Internet + WebVR + GearVR?  Thanks!
  It would be nice if there were some [browser badges](https://github.com/substack/browser-badge#example) in the [`README`](https://github.com/aframevr/aframe#a-frame). Or a link to the [Devices & Platform Support docs page](https://aframe.io/docs/0.3.0/introduction/device-and-platform-support.html) could suffice.
 Hi, check out this contributing guide https://github.com/aframevr/aframe/blob/master/CONTRIBUTING.md and some of the other issues in the repo. Welcome and thanks!
 thanks!
  You can take the stereo sound source from the video and use the positional sound component for left and right, perhaps?
 The 360 devices are focused on images rather than video capture, so I'd be surprised. The videos you saw were maybe professionally produced with binaural mics and rigs?
 I recommend demuxing the audio from video and place the sounds where you want with the positional sound component.
  **Description:**

Easiest way is to make sure it's in the `<head>` to reduce errors where people are including A-Frame after the scene HTML.
- A-Frame Version:
- Platform/Device:
- Reproducible Code Snippet or Demo URL [highly encouraged]:
 It might be helpful to also have a warning if components are registered after a scene is already in the DOM. Ideally that would "just work," but since it's complicated and we don't support it yet, nice to have a safety net for users putting A-Frame in `<head/>` but registering components after the scene.

(I've made this mistake myself a few times, since scripts that modify the scene do need to go later or wait for DOMContentLoaded)
 The issue was originally filed as #485. Want to forward dupe?
 Yeah, nice catch. I'll close that one as it's trying to support actually having the `<script>` in the body, and this is for a warning. We might be able to have `<script>` in the body with logic, but things could get messy, and components via `<script>` tag might not work as well if they also have to be in the body.
  Try defining your components before `<a-scene>`
  I'm experienced with npm and ES6 modules and Browserify/Webpack/UMD workflows so I understand. A-Frame is pretty large scope, it's VR in your browser, I think that warrants a global. Think of it as the global `window` of VR.

I used to prescribe components when installed through `npm` do:

```
var AFRAME = require('aframe');
AFRAME.registerComponent('foo', require('my-component'));
```

But I preferred less work for developers so they can just require and go. For your linter, you can do `/* global AFRAME */`. And there's not much of a consequence of exposing a singleton as a global, traditionally, it might feel bad because applications used to put _everything_ in global.
 Don't think we can do much as A-Frame is and should be used as a frontend library where a window is available. I think it is requirable from Node now though.  Depends on their browser's WebGL/WebVR support. If it can't load a simple skysphere, there's something up with their browser.
 Let me know how three.js examples load
 Would have to wait for a WebGL-compatible browser from PS.
  I think we are running out of room for badges :)

Otherwise, we've been promoting just our `aframe.io/releases` or `unpkg.com` (which we use for our component ecosystem). Thanks though!
  It introduces a scene level component `screenshot` that allows to take a snapshot of the rendered scene with the `alt-S` shortcut. It is configurable to take either equirectangular (panoramas) or screen snapshots. It should also work with the inspector. @chriscar I believe you were asking for this a couple of days ago in Slack. It would be great to get your feedback on it.

I still have to organized the code a little bit better but the functionality is complete. 
- Bumps three.js r81
 The perspective screenshot is upside down and reverse

![screenshot-anime ui-1477263286293](https://cloud.githubusercontent.com/assets/674727/19630280/d475eb44-993b-11e6-96d2-53184f5a9e07.png)
 I made a bunch of changes based on review and fixed the vertically flipped pixels on perspective projection.
 There are still a few typo/doc comments to address in the diff.

Also, curious what changed about how three.js stores `<img>`s? Otherwise, r+wc
 I fixed the typos and changed the shortcut to `alt+ctrl+s`. `alt+s` opens the history menu on Firefox. Using `alt+ctrl+s` also makes it consistent with the inspector shortcut
  The mouse cursor component should work.

https://github.com/jesstelford/aframe-click-drag-component does similar as does the https://github.com/aframevr/aframe-inspector

The three.js demo has a draggable objects demo too
  Hi @mountainguan ‚Äì thanks for using A-Frame! From the [contributing guide](https://github.com/aframevr/aframe/blob/master/CONTRIBUTING.md#get-help-or-ask-a-question), detailed questions on Stack Overflow tend to get better results than GitHub issues ‚Äî [ask a question with the 'aframe' tag](http://stackoverflow.com/questions/tagged/aframe).

When asking on Stack Overflow, please also include:
1. More specifically what you are trying to achieve. By "aspect" do you mean aspect ratio? Or simply the direction the user is facing? Or detecting whether or not a particular object is within the user's line of sight?
2. Any code that you have tried so far, even if it doesn't work, and any problems or errors you have run into.

This helps us to understand your question better, and also allows others to learn from your question in the future.
 You can force the scene to keep the HTML up to date by using `<a-scene debug="true">...</a-scene>`. There are moderate performance losses for doing this.

However, `getAttribute()` will always give the latest data (with or without the `debug` option). Example:

``` javascript
var cameraEl = document.querySelector('[camera]');
cameraEl.getAttribute('rotation');
```
  We've deprecated a-animation. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.  Do three.js examples work?
  Fixed thanks!
 https://github.com/aframevr/aframe-site/commit/30671e75783c18ce7692001d9a8aacf0399f2c10
  https://github.com/aframevr/aframe/pull/1978
  Are you using the cursor component or raycaster? Cursor component adds the click events.

Either way, check the raycaster max distance is sufficient (videosphere has 5000m radius, so set to 5000+)
  thanks!
  Thanks! Can you update the docs too?
 thanks!
  Not quite sure what's going on, there's too much stuff sitting on top of A-Frame, it's hard to debug (Angular 2, routers, typescript, es6, multiple scenes).
 Any updates? I am not sure this is actionable unless we have more details.
 Will close without a test case for now  Doesn't work yet https://github.com/aframevr/aframe/issues/916 ... it'll be non-trivial to support that actually.

For presentations, I've been detaching the current scene and appending new one when I change slides. Also consider I-Frames.
  Good catch! Thank you
  thanks!
  Hi @Hongbo-Miao ‚Äì try the list of [community-made A-Frame components](https://github.com/aframevr/awesome-aframe#components). You probably want [one](https://github.com/bryik/aframe-bmfont-text-component) [of](https://github.com/maxkrieger/aframe-textwrap-component) [these](https://github.com/ngokevin/aframe-text-component). Showing text in WebGL is a bit complex, and different approaches are better for different things, so it has been left out of the core library so far.
 I like using https://github.com/bryik/aframe-bmfont-text-component

Whether that should be standard I am not sure. Currently, it's the solution that works and looks the best. It might be nice to have it out of the box. But other solutions like html-to-canvas might win out?
 We should consider having a basic sample text implementation (I like @bryik's) as part of the standard lib. This way if third-party components want to add text for whatever reason (debug, labels), they don't have to depend on a third-party text component or consider how to package that in.
 https://github.com/aframevr/aframe/pull/2200  > Do you have any guesses what router would change? The error is because something hasn't initialized with the scene when the geometry is initializing. I don't know how that could happen.
 There's an event. `scene.addEventListener('loaded'...`

Or attach your Angular init code in an A-Frame component `<a-scene angular-init>`
 alternatively:

``` js
AFRAME.registerComponent('angular-init', {
  init: onLoaded
});
```

``` html
<a-scene angular-init>
   ...
</a-scene>
```
  The newest version of Chromium uses WebVR 1.1 API.

Latest bleeding edge A-Frame addresses this: https://github.com/aframevr/aframe/tree/master/dist

Sorry about that, need to communicate that somehow!
  Thanks for filing. Before we weren't versioning our docs, so there wasn't an easy way to pull in typo fixes. Now there is, so going forward this shouldn't be an issue. We'll just have to leave pieces of 0.2.0 with typos.
  Thanks, I think there were some merge conflicts. Will get that fixed.
 Component dependencies don't have attributes. They could but the current API only allows to define the list of dependencies to guarantee an order of initialization. If the component is also defined in the entity we call `updateComponent` with the proper data defined in the DOM attribute:

https://github.com/aframevr/aframe/blob/master/src/core/a-entity.js#L425
 Thanks Ryan, my bad for regressing it!
  i'd recommend setAttr before appending
 i see, that's expected. here ya go. http://stackoverflow.com/questions/39719445/why-is-the-html-dom-not-updating-in-a-frame
  you have to go to your safari settings and set it to hide
 Try setting window.scrollTop to 0?
  A community component would be good for this that would take an image URL or `<img>` selector and add rotation based on the xmpmeta. 
 Will close this in favor of a separate third-party component.
  **Description:**

I've found cases where we want to be able to update systems (e.g., `enemy` system). Since systems already have schema/play/pause/init/data...with update, they will have the same API as components. We should be able to reuse the prototypes, but maintain the same registration API + system-to-component referencing
 :+1: I run into the same problem while developing the `decal` system for the a-shooter.
 Considering instead https://github.com/aframevr/aframe/issues/2071
  0.4.0 has a nicer message: `Uncaught (in promise) Error: Failed to enter VR mode (requestPresent): No VR hardware found.` It didn't work because the calls to go into fullscreen failed, and then orientation lock. You can't control these things with javascript because they are app settings.
Both of them are in the correct settings of course. The fix here is to disable the fullscreen and orientation checks when in a webview. The same will apply to iOS. This is because the WebView doesn't support vrDisplay, and aframe doesn't support browsers that don't support vrDisplay.

A potential fix is to use a-frame 0.2.0 code for presenting as a fallback. Sorry, I don't understand the problem. Chrome (not the Chromium WebVR builds), Firefox (not Nightly), Edge or Safari don't support VRDisplay and a-frame works fine. The polyfill should kick in in all those cases. What's different in a webview? We don't do Android development in the a-frame team so we cannot test webviews easily. If someone can investigate and provide a fix we will take it Sorry, I'm not very familiar with the codebase. Where is the polyfill located?

Ahh, it seems to be in index.js - I will have a look into it. OK, looks like a simple fix for the webvr-polyfill project. I will submit a pull request with them and keep this bug open to make sure we update the dependency on a-frame. Hmm, it looks like the changes were submitted and denied. WTF.

https://github.com/googlevr/webvr-polyfill/pull/175 https://github.com/aframevr/aframe/pull/2345  thanks!
  We use the XHRLoader at https://github.com/aframevr/aframe/blob/master/src/core/a-assets.js#L90 ... just need to add a hook there.
  The call is at https://github.com/aframevr/aframe/blob/master/src/core/scene/a-scene.js#L170

Is it a harmless warning, or does it prevent stereo mode (one render for each eye)? Is there a way to detect a fullscreen/native/pinned context?
 I mean is there a smarter way to automatically handle it without having to create a property? "If this app is in Cordova, don't fullscreen".
 Yeah, perhaps that'd work. Can you confirm that'd work on hybrid mobile apps?
 Might be some work on A-Frame side to fix this too. 
 #1940 fixed  Can you still reproduce the issue with this stripped-down snippet?

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Minimal test case</title>
  <script src="https://aframe.io/releases/0.3.0/aframe.min.js"></script>
</head>
<body>
  <a-scene fog="type: linear; color: #FFFFFF; far: 40; near: 0">
    <a-entity position="0 0 0" rotation="0 0 0" id="root_entity"></a-entity>
    <a-entity camera look-controls wasd-controls position="0 0 0" rotation="0 0 0"></a-entity>
    <a-sky color="#FFFFFF"></a-sky>
  </a-scene>
  <script>
    var positions = ['0 0 -5', '3 0 -5', '-3 0 -5', '0 0 -8'];
    var colors = ['red', 'blue', 'yellow', 'green'];
    for (var i = 0; i < positions.length; i++) {
      var sphere_base = document.createElement('a-entity');
      sphere_base.setAttribute('position', positions[i]);
      var sphere = document.createElement('a-sphere');
      sphere.setAttribute('position', '0 0 0');
      sphere.setAttribute('radius', '0.8');
      sphere.setAttribute('color', colors[i]);
      sphere.setAttribute('opacity', '0.5');
      sphere_base.appendChild(sphere);
      document.getElementById('root_entity').appendChild(sphere_base);
    }
  </script>
</body>
</html>
```

The above works on my iPhone 6, in Safari on iOS 10, but I can't edit and test your full code with the AJAX request in there.
 Closing due to inactivity and no reproducible test case  thanks! https://github.com/aframevr/aframe/commit/5f46b6c448cb0cea49dd9104a615437714f73168
  **Description:**

This is a well-ingrained API, and a lot of people like it. Unfortunately, I think there are too many issues with it that are inherent making `<a-animation>` its own Custom Element. We should consider delegating it to third-party component (I have a sample [animation component on kframe](https://github.com/ngokevin/kframe/tree/master/components/animation)). Since it's very ingrained, we'd probably give it a few versions to slowly deprecate. 

Here are the issues:
- **Poor Imperative Ergonomics**: To add an animation imperatively, we must do `createElement`, multiple `setAttributes`, `appendChild`, and `addEventListener('loaded')`.
- **Asynchronous**: With `<a-animation>`, we must wait for it to append to the DOM and register a callback listener. It's not synchronous when it could be.
- **Inconsistent with the Framework**: The `<a-animation>` tag is the only outlier in which we use a child DOM element rather than an HTML attribute to modify an entity's behavior. Components are nice because they can easily be mixed in, and you could use things like [aframe-mss](https://github.com/ngokevin/aframe-mss)
- **Difficult to Maintain**: I made an animation component, and it is a 3-4 times smaller codebase and much simpler. This is because `<a-animation>` duplicates a lot of component logic related to entity lifecycles (having to handle attach, update, remove). We also have a lot of edge case code in our base classes just for `<a-animation>` that we could move or remove (e.g., move states from ANode to AEntity). 
- **Buggy**: Lots of animation-related bugs that are tough to fix and often just result in adding more attributes. We don't have the manpower to maintain it when it's already fairly hard to maintain.
- **Faster Development**: Having animations be detached from the A-Frame core library means faster iteration. Due to being easier to maintain, having more features, and not being tied to A-Frame versions, we can do bug fixes and add features without needing to tie it to the an A-Frame release.
- **Verbose** (nit): A-Frame Component form is much shorter than DOM form
- **Inspector**: component form would be automatically compatible with the Inspector
 are you comfortable with people using https://github.com/ngokevin/kframe/tree/master/components/animation?

honest question: why not move your component into core?

I understand the desire for faster development, but for front-end devs it's not trivial to drop in a component, unless they're comfortable with the command-line + Node/npm + Browserify. (until there's some sort of graceful component loading such as how it works [with the Holodeck Club's `manifest.json`](https://github.com/holodeck-club/holodeck-club.github.io/blob/79a5cc9/molo/manifest.json#L22) and [ESNextbin](https://esnextb.in/?gist=27fd38f51a4a9303e9c7&execute=true)).

I can imagine a third-party component with (even more) stock animations (i.e., canned effects) such as those defined in https://daneden.github.io/animate.css/ but for A-Frame.
 Faster iteration is pretty much it. We can bump a component and release it rather than people having to wait at least a month for a new A-Frame. And we have more leniency to include additional features if it were to live as third-party. It also lets us offload work to community so that we so that we can focus on larger things because there are a lot of of costs to keeping this module (documentation, issues, support, bugs).

I think difficulty in requiring a component is a separate and larger issue. But people don't need command-line/NPM/Browserify, it's just a script tag. Front-end devs are accustomed to pulling in code via `<script>` tag (A-Frame being included). My brother in high school was able to grab aframe-extras with no coding experience.

I was somewhat on the fence, but I think offloading to community vs. a large batteries-included library is best long term (for now).
 Forgot to answer the first question, I'm comfortable maintaining that just as I have `<a-animation>`. The two or so versions of deprecation will give a good buffer time as well to transition. If I don't maintain it well, naturally people can fork it (just like Blair MacIntyre forked to a better look-at component).
 > Faster iteration is pretty much it. We can bump a component and release it rather than people having to wait at least a month for a new A-Frame.

perhaps it's worth finally adopting [`semantic-release`](https://github.com/semantic-release/semantic-release) (which despite its name doesn't require adopting semver naming) for "continuous releases" (issue #304 covers this). if I'd have to vote, I'd place that issue high on the priority list. but you and @dmarcos definitely have a better idea of priorities.

> My brother in high school was able to grab aframe-extras with no coding experience.

That's awesome and reassuring. I can actually see (and am a bit concerned) that `aframe-extras` becomes what the `aframe` core should've/could've been. Do you share those worries? I've seen with other OSS projects, it becoming a bit awkward when you need to need an additional lib to do anything "interesting."

> Forgot to answer the first question, I'm comfortable maintaining that just as I have `<a-animation>`. The two or so versions of deprecation will give a good buffer time as well to transition. If I don't maintain it well, naturally people can fork it (just like Blair MacIntyre forked to a better look-at component).

That seems fine. I just wonder where to draw the line. Could go the `stack.gl` or `express` approach - of having micro-modules and having folks install + require each dependency. Is that the desired path of A-Frame? Or should it become (or remain?) the jQuery (a "stopgap" solution until the browsers catch up - no offence to jQuery) of WebVR for now. Is there concern that deprecating `<a-animation>` could sacrifice the ease of A-Frame scene development (for its hundreds+ WebVR devs/enthusiasts) in an effort to ease development of the `aframe` core lib (for its 71 contributors)?

Asking these questions because they're things I've wondered myself about A-Frame's vision and strategy. More precisely:
- When, if ever, will A-Frame be considered _done_?
- What do we need to get there?
- What is currently getting in the way? Lack of core developers/reviewers, core features, platform dependencies, curation, documentation, third-party component creators, scene creators, enough innovative scenes?
 > perhaps it's worth finally adopting semantic-release

`semantic-release` is sort of related, but if you want to pull in one fix for a single component, developers shouldn't have to worry about bumping A-Frame and having to pull all the unrelated changes with it. I'm actually sort of against continuous releases, I don't think it's right for A-Frame because releases should be fairly stable, QAed, and with documentation, which sounds hard to do. Feel free to enlighten me about continuous releases in another issue...I'm all for automating them though.

> I've seen with other OSS projects, it becoming a bit awkward when you need to need an additional lib to do anything "interesting."

I don't share the worries. Every framework you're going to pull at least one dependency. It's hard to imagine if someone was able to make fireballs or mountains with a component, but were deterred by having to include a `<script>` tag. People'll actually want to because with a line of code, they can save themselves a ton of work (or be able to do something they couldn't otherwise). Of course, we can always ease the process. More documentation and more abstractions (Inspector, Editor, Atom plugin).

p.s., I also think it's quite beautiful that developers are adopting `aframe-extras`, it shows a healthy ecosystem. People are discovering it, are able to use it, gives them value, and all without us.

> I just wonder where to draw the line.

Thin vs. large standard library is a legitimate question. I've thought about it over the months, and thin is best for us _currently_ for the long term. It is sort of micro-modules, but I think that isn't necessarily a bad thing for WebVR today to enable open experimentation and to keep bundle sizes down. Component packs like `aframe-extras`, `kframe`, and perhaps our own curated pack will make this better though. 

As we see more necessary things (i.e., link traversal) or unbeatable/must-have components pop up (i.e., perhaps a solid `grab` component, physics, controls), we can adopt more into the core or standard lib. Take it on a case-by-case basis, I don't think declarative tweening is vital or prime enough to make the cut. So don't worry too much that we're going to have a library that does absolutely nothing, it'll be plenty on its own :)

> Or should it become (or remain?) the jQuery

I think three.js is already like the jQuery of 3D/VR. Grab bag of convenient modules with no opinionated structure.

> Is there concern that deprecating <a-animation> could sacrifice the ease of A-Frame scene development (for its hundreds+ WebVR devs/enthusiasts) in an effort to ease development of the aframe core lib (for its 71 contributors)?

Deprecating `<a-animation>` will improve ease of development for the many performance and technical reasons mentioned above. Being able to set an animation with `el.setAttribute('animation', {...})` is so much better than `createElement(); setAttribute(); setAttribute(); setAttribute(); setAttribute(); appendChild(); addEventListener('loaded')`. Since it's a component, you can use it via mixins, my CSS syntax in `aframe-mss`, or the A-Frame Inspector (which you currently can't!).

> When, if ever, will A-Frame be considered done?

I think it is possible to get the A-Frame's API in a solid state since we don't have the burden of trying to enable every feature. We can have a healthy ecosystem of components, shaders, controls, primitives, etc. that are all created without hassle through that API. By that point, we should have a good story of where components live. Then we focus less on the API, and more on human-centric tools like a full Editor or VR Editor (although we have the capability to do these things in parallel).

> What do we need to get there?

If we all build more scenes and components, we can continue to iterate A-Frame's API as well as gauge what is necessary to include into the core.

> What is currently getting in the way? 

Nothing is in the way, necessarily. We're making progress. All the above helps move things along. My itch is having more innovative scenes being built.
 (First off, apologies for the wall of text. I'm trying to get in the habit of over-documenting things, as our team is effectively remote as is the A-Frame community.)

Awesome, this all makes perfect sense. Thanks for writing that all up. I can dig it. Personally, as someone who doesn't want to bother with build steps (though I am very comfortable with build systems), I don't want to manually add scripts (`aframe.js` + `aframe-extras.js` + ‚Ä¶) to my scene. There are build systems out there that attempt to alleviate this (such as [`systemjs`](https://github.com/systemjs/systemjs)).

I'm asking these questions ‚Äì and my apologies for my questioning (and these questions are perhaps better left to be answered in a separate issue in this repo) ‚Äì in the hopes that we can keep things simple and usable. It's great to keep the A-Frame core small + elegant is great and enable developers to not have to have their components vetted by us. But I wonder if we could borrow some lessons from [hapi.js](https://github.com/hapijs) and [express.js](https://github.com/expressjs)).

All-in-one editor tools such as [`esnextbin`](https://esnextb.in/?gist=27fd38f51a4a9303e9c7&execute=true), [Thimble](https://thimble.mozilla.org/), and CodePen are great for prototyping (and even the first two could actually be productionised). But, today, devs still have to introduce Node + npm + the command line + Browserify/Webpack + git + GitHub if they want to create, publish, and share a scene with the world. If it's not Node + npm + the command line, it's a trial-and-error adventure of copying URLs + moving files into a directory + testing. (I know we can improve on both fronts; I touch on this later.)

> I think three.js is already like the jQuery of 3D/VR. Grab bag of convenient modules with no opinionated structure.

three.js doesn't have a module system (though I know there have been attempts and arguments for/against it), but it could be considered opinionated in that it offers an anti-modular, expansive feature set.

It's certainly frustrated me that with three.js I couldn't just pick and choose modules like I can with customised jQuery/lodash builds (which admittedly causes fragmentation and makes bugs harder to trace, report, reproduce, etc.).

three.js' solution to this problem is to include everything in one giant bundle (though with Webpack/rollup.js, tree-shaking makes the problem obsolete; and also a promising contender has recently entered the ring: [optimize.js](https://github.com/nolanlawson/optimize-js)) and encourage the community to build an ecosystem of examples that also live in the repository.

I agree adoption and ease of use would falter if A-Frame took the same approach. But, I will say that even npm and GitHub are suffering from the problem of "which module does what I want it to, is it compatible with the core library (and the version I'm using), do I have a guarantee that it is and will be well maintained and tested." I've heard from tweets, blog posts, podcasts, etc. that folks at both the companies are working on this problem. Curation helps for sure, but at the end of the day things need to work (most of the time).

I'd say that requiring a build step to create a scene now ups the learning curve. If you aren't moderately comfortable with the command line, Node, npm, and JavaScript, copying and pasting or downloading a third-party script (or bundle of scripts) becomes a black box.

I think it's important to support the pro-build folks and the anti-build folks. And, the anti-build folks aren't necessarily JS-na√Øve; they may instead want to simply invest more time in a scene than searching components, testing components, and settings things up from the command line.

I look at at [`stack.gl`](http://stack.gl/), and even with its learning resources, such as [Shader School](https://github.com/stackgl/shader-school) and [WebGL Workshop](https://github.com/stackgl/webgl-workshop), and I have to stop and wonder why I don't see many folks cranking out WebGL shaders/scenes (or maybe I'm looking in the wrong places). There's also [regl](http://regl.party/) ([source](https://github.com/regl-project/regl)), which seems to be getting some attention.

I have no doubt A-Frame will continue to thrive with its growing ecosystem of components and abundance of developers creating cool scenes.

I just hope the tools aren't getting in the way. I'm not necessarily advocating a "monorepo" (see [this](http://danluu.com/monorepo/), [this](https://github.com/babel/babel/blob/master/doc/design/monorepo.md), and [this](https://news.ycombinator.com/item?id=10138946)), but I wonder if there's a way we can ensure that folks can compose scenes easily without having to worry about compatibility and quality (and build-step complexity).

A fair comparison I'd say is assets. There is a wildly active community of artists out there, and you can find some good assets (paid and free), but making sure they work with three.js/A-Frame out of the box requires a lot of manual work. I know there are steps we can take to automate those steps and reduce those stressors. And, I'm excited to introduce tooling to improve that process.

I just question whether scattering components and creating third-party packs improves or complicates the mental model and scaffolding of what A-Frame is, what A-Frame isn't, and when to rely on third-party modules. IMO, ease of scene creation for developers should be the #1 priority, whatever it takes.

So to bring things back, here are some ideas to solve the problems mentioned above:
1. Put non-core components in their own repos in [the `aframevr` org](https://github.com/aframevr/) (√† la [hapi.js](https://github.com/hapijs) and [express.js](https://github.com/expressjs)).
2. Pull more and more code out of the `aframevr/aframe` core repo (which is exactly what express.js did over the years).
3. Continue to curate [a community-driven list of "vetted" components](https://github.com/aframevr/aframe-components) (with extensive metadata) for easy discovery (and it could be possibly eventually automated).
4. [Maintain easy component management](https://github.com/aframevr/aframe-inspector/blob/3dc164f4/src/lib/componentloader.js) from within the [A-Frame Inspector/Editor](https://github.com/aframevr/aframe-inspector) (√† la Package Control for Sublime Text, with granular flexibility for versioning/searching, etc.).
5. Build a tool like [`esnextbin`](https://esnextb.in/?gist=27fd38f51a4a9303e9c7&execute=true) (or commission the existing tools such as [Thimble](https://thimble.mozilla.org/), CodePen, et. al. to properly support A-Frame goodies such as tab completion, snippets, component discovery, etc.).
6. Ensure that there exists awesome A-Frame plugins and snippets (see [this one for Atom](https://github.com/bhuizi/aframe-atom-snippets)) for the commonly used text editors (and possibly IDEs) ([this](https://draculatheme.com/) is possibly a good list to strive for).
 > But, today, devs still have to introduce Node + npm + the command line + Browserify/Webpack + git + GitHub if they want to create, publish, and share a scene with the world.

There's a bit of a tangent with the pro-build vs. anti-build in the entire comment: _build steps are a barrier to adoption_. Firstly, there are no build steps. I don't know why Node + NPM + Browserify are being mentioned, they are by no means required nor are they pushed over normal HTML. Secondly, people have no issue including script tags for extra features, we can see this based on how well `aframe-extras` has been received and been used by even the non-technical. I've seen no evidence that A-Frame or including extra features has been too difficult, and for this issue, pointing from `<a-animation>` to an animation component shouldn't be a large hurdle.

That being said, yeah, we can definitely improve the process. [And we are!](https://github.com/aframevr/aframe-components/issues/5) Most of your suggestions sound good, so keep those noted down. 

p.s., `Express` and `Hapi.js` are not good comparisons because they are backend frameworks, adding additional code has no performance tradeoffs for them. If you look at the contrary on popular frontend frameworks, you will see a micro-module approach for non-core features.
 ![ceilingcat](https://cloud.githubusercontent.com/assets/1848368/18696117/8f6c946a-7f84-11e6-9c90-5a11a4e4a795.png)

I have no strong opinion about whether `<a-animation />` should stay in core, but:

> 1. Put non-core components in their own repos in the aframevr org.

That's beneficial, especially until points 3 and 4 come together. I don't particularly need to sit on `aframe-extras`, and if part(s) of that should be split out somehow I'm open to doing that. With loaders, for example, it's important that those components be consistent. Scattered community-driven loaders make it harder to change things, like adding model animation support.
 Yeah, case-by-case basis we can maybe start introducing non-core components in the `aframevr` repo. That may be physics, loaders, controls, post-processing effects, etc. I think those decisions will come naturally as the needs arise. 
 Right now, I am starting to gather un-published components that I think are useful to re-use (e.g., the sun shader example, A-Painter landscape, reverse look controls drag) in K-Frame. Also I'm making it easy to add new things with auto-generated example pages, README, and component templates. As we learn more from this, we'll get a better idea in the future.
 I'm going to add this to the `0.8.0` milestone, because `animation-mixer` is already there, and these two feel like they should be considered together. But also fine with me if we punt them both to the next version, instead.

EDIT: Actually, bumped to 0.9.0 after talking to dmarcos. https://github.com/aframevr/aframe/pull/3518  https://github.com/nolanlawson/optimize-js

Provides hints for JS engines for optimized parse speed.  Most notably a massive speed improvement for Three.js, our underlying technology.
 Thanks to @AdaRoseEdwards for finding this!
 See https://github.com/nolanlawson/optimize-js#benchmarks and https://nolanlawson.github.io/optimize-js/. Would be interesting to test an optimize-js three.js build and measure. Additionally, it'd be cool if we created an A-Frame benchmark they could include on that list.
 Will just leave as is. Don't know if the extra build step is worth it and can come with surprises. It doesn't look to be maintained nor adopted.  Hi @s1mar ‚Äì we'd be glad to help with your question, but could you [repost it to Stack Overflow with the "aframe" tag](http://stackoverflow.com/questions/ask/?tags=aframe)? To get good answer, it would also be great if you could include more about what you mean by "hotspot functionality", and any code you've got so far.

We ask for questions to be put on Stack Overflow for a couple reasons: (1) new SO questions are automatically posted in Slack, so they get attention more quickly, and (2) answers on SO are easier for others to find, so your question can help others learn A-Frame too.
 Posted here:

http://stackoverflow.com/questions/39623871/how-can-i-add-hotspot-functionality-in-a-frame-panorama

Closing this and we'll focus on the S/O post.
 Will do. Thanks!
 https://aframe.io/docs/0.3.0/guides/building-with-components.html
 @Carpetsmoker thanks!

@ngokevin @darkwing Based on the clarification, I guess the question would be a duplicate of [this](http://stackoverflow.com/questions/36499971/aframe-io-creating-hyperlinks-and-download-links/36956240#36956240). I'm not sure how to flag it as such. Or we could fill out the question/response for a 'hotspot' that triggers events when the camera enters an area, which has been asked several times before.

@s1mar Sorry, again I don't know what you mean without more details and a demo. The `rotation` component is where you would start. You might also see the code for the [look-controls](https://github.com/aframevr/aframe/blob/master/src/components/look-controls.js) component, which uses discrete pitch/yaw/roll to track camera orientation.
 The documentation and the guide linked above and the school all teach exactly how to add hotspots to a panorama.   @terryleee your best bet would be to show a loading effect using HTML/CSS, an image, or whatever you want, and then to hide that effect when the `loaded` event fires:

``` javascript
loadingEl.classList.add('visible');
sceneEl.addEventListener('loaded', function () {
  loadingEl.classList.remove('visible');
});
```

If that isn't doing what you need, could you post this question with additional details to the [A-Frame tag on Stack Overflow](http://stackoverflow.com/questions/ask/?tags=aframe)? We can generally give more helpful answers there. Thanks!
 Appears to have been re-asked here:

http://stackoverflow.com/questions/39586429/how-can-i-add-a-loading-effect-before-all-assets-are-loaded
  Missed this question. Do you want to render in stereoscopic without VR capabilities, or are you interested in using accelerometers and gyroscopes of a Raspberry Pi? Can you explain the use case more?
 The code that determines whether to use VREffect is `if (checkHeadsetConnected() || this.isMobile)`. 

`checkHeadsetConnected` ultimately depends on having a `VRDisplay` https://w3c.github.io/webvr/#interface-vrdisplay and setting the orientation to something that's not a zero vector.

Hacky way is to set `document.querySelector('a-scene').isMobile` to `true` and remove the orientation modal overlay. 

You can check how the WebVR polyfill does it too https://github.com/googlevr/webvr-polyfill which does it for smartphones, you can do something similar for the Pi.
 Leave this open for maybe an API to force stereo rendering.
 I'd stand with just hacking it and set `isMobile` to cheat it It was a hack that might have worked just by coincidence, not a feature we were supporting. What is the use case for stereo rendering in desktop without a headset?  The position of the camera is going to be similar in VR and 2D mode. What value do you extract from stereo rendering and distortion without a headset? What kind of content are you developing? Mono rendering is usually enough for object positioning. There is a Web extension that simulate VR hardware (https://chrome.google.com/webstore/detail/webvr-api-emulation/gbdnpaebafagioggnhkacnaaahpiefil?hl=en) for that purpose. @skrichten Can you be more specific about your use case? Why is mono rendering not accurate enough for testing? Can you present on VR hardware from an Electron context? This is not a trivial feature to implement and maintain over time. I‚Äôm just trying to understand the problem we are trying to solve. @skrichten What headsets are you supporting? Distortion and field of view are hardware specific. If you want accuracy you would need to exactly simulate the characteristics of heach headset. Random or generic stereo rendering and distortion won‚Äôt solve your problem if what you need is precision. Also notice that WebVR is only available on Chrome Canary behind a flag. I have no experience with Electron and how they update the version of Chromium / Blink they ship. Chrome only supports Vive at the moment. You can use Firefox but you cannot then use Electron. There‚Äôs nothing I know of that simulates hardware if accuracy is what you need. You mention you want to simulate a static camera position. Just make sure that the approach is useful since we people are never completely static. The fine adjustments you do assuming a static point of view might not be perceived by a real user. I would recommend to test on real hardware if accuracy is a top priority for you.   Try `play/pauseSound()` or pause/play the audio element

.play/.pause are callback methods
 Cool, changing the issue to improve our docs.
 Perhaps this is deserving of its own issue, and let me know, and I can file.

When I was dealing with some scenes in the past, I wanted to just mute all sounds on all the entities in the scene. [Here was my hacky solution.](https://github.com/MozVR/oculus/blob/e73ea2c8/assets/js/common.js#L20-L85)

If there's already a component that handles this, awesome! If not, can we introduce it into core (e.g., `AFRAME.sounds.mute()` or something)? Or, if folks feel it should be a third-party component (even one under the `aframevr` org), what would it look like? (I assume my [approach](https://github.com/MozVR/oculus/blob/e73ea2c8/assets/js/common.js#L20-L85) above is not a good one to evangelize. I kept hitting issues, and that hacked-up mess is what I arrived at.)

I see this issue is being repurposed to improve the docs. Regardless of the componentisation/functionality point above, can we also document how to pause all sounds in a scene?
 Loop over the sounds

https://github.com/aframevr/aframe/issues/1083 will make it marginally easier
 done
  thanks for approriately addressing this issue
  Perfect, thanks!
  Hi, thanks for filing. We made a tradeoff between resolution and working around a canvas resizing issue.

This should be cleared in iOS 10. Here's a workaround (with disadvantages): http://stackoverflow.com/questions/39305663/why-is-a-frame-0-3-0-resolution-low/39305668#39305668
  Hi, could you try again? You added another line instead of modifying the existing one.
  Thanks for the prefix-removal information, might have to update some information. In `<a-assets>`, we automatically fix up all tags with `crossorigin`, we could do something similar for playsinline.
 > The same technique can be used to render into a WebGL context. Note in this example that a user gesture‚Äìthe click event‚Äìis required, as the <video> element is not in the DOM, and thus is not visible. 

So maybe need a click or pin-to-homescreen still?
 > Thanks for the prefix-removal information, might have to update some information. In `<a-assets>`, we automatically fix up all tags with `crossorigin`, we could do something similar for playsinline.

we already do for `webkitplaysinline` [here](https://github.com/aframevr/aframe/blob/a578f6fd/src/systems/material.js#L282) and [here](https://github.com/aframevr/aframe/blob/a578f6fd/src/systems/material.js#L317). just need to now add another attribute for `playsinline`.

the click-to-play policies previously existed before iOS 10. and those were tracked in a separate issue (#316), but it was decided that a third-party component would could be responsible for introducing a "play" button if we detect any video or audio on the page. see these comments too: https://github.com/aframevr/aframe/issues/316#issuecomment-212608703
https://github.com/aframevr/aframe/issues/316#issuecomment-219181039

I'd recommend just adding the `webkit-playsinline` attribute in `material.js` where we are already setting `playsinline`. And then file a separate issue for the "play button" for autoplay media that requires a user-initiated action. Keep in mind that not every browser on iOS has this restriction; I don't expect Safari for iOS 10 to change, but Chrome may and [Firefox will](https://github.com/mozilla/firefox-ios/pull/1651).
 @caraya Thanks! Are we ok in iOS now then? :) try using a different video codec. you can use [`ffmpeg`](https://trac.ffmpeg.org/wiki/CompilationGuide) to do that:

```sh
ffmpeg -i IMG_1040.MOV img_1040.mp4
```

btw, which platform are you testing this with? @pdnellius can you link me to your video source so I can take a look? oh, yeah, you're probably hitting this [CORS bug on WebKit/Safari](https://bugs.webkit.org/show_bug.cgi?id=135379). I've got some code that I'll be making a PR to `aframe` for that works, but, again, it's just a workaround. it is a known, and unfortunate, WebKit bug.
 That CORS workaround is only functional for MP4, not HLS for example (and may force entire MP4 loading rather than streaming, which may be problematic in some cases?) @machenmusik have you tried using MPEG-DASH instead of HLS? it's supported on iOS Safari. HLS is going to be deprecated anyway. Last I tried (not super recently) DASH did not play with iOS 10 mobile safari... do you have a working example? What error do you see on iOS? The CORS error in the console, or something different? you need user gesture to trigger media playback that has audio when using mobile safari, and gaze selection doesn't count as a user gesture to the browser, you need touch event or touch-generated click > I'm not sure if this is directly related to this issue, but I'm having trouble triggering audio on iOS devices. I'm listening for click events that play audio assets. I'm curious is anyone else is having a similar issue on iOS devices or if you know of a solution?

which audio codec is the sound encoded with? if you're listening for `click` events, the user-gesture requirement should be met. can you share a URL of your project?
  thanks!
  Maybe because the default camera is created after the scene is loaded...to check for existing cameras.

There is an event: `camera-set-active`. Does that help?
 A bit hard to follow all these callbacks (our fault!). So you can't move code outside the `loaded` callback and into the `camera-set-active` callback?
 You can check for `nodeready` which is emitted after attach...but ideally we shouldn't have to do that. If you write your code within components/systems, you should be assured that everything has been set up. I think I'd need full code to give more helpful guidance though.
 Is it feasible to remove invocations of `init()` from inside `setAttribute()`? This also bit me in #1900. 

Another option, specific to this issue, might be some scene-level config to prevent injection of default cameras.
 Maybe we can also let it look for `data-aframe-camera`...?
  ``` js
<a-entity id="parent" geometry="primitive: plane; width: 0.1; height: 0.1;rotation:0 0 0" position="0 -1 -1" material="src: #menu_hamburger; shader: flat; transparent:true; depth: 1; opacity: 1">
  <a-animation begin="mouseenter" attribute="material.src" from="#menu_hamburger" to="#menu_mais" dur="1000"></a-animation>
  <a-animation attribute="material.opacity" begin="mouseenter" to="0.5" dur="100"></a-animation>
  <a-animation attribute="material.opacity" begin="click" to="0" dur="100"></a-animation>
  <a-animation attribute="material.opacity" begin="mouseleave" to="1" dur="100"></a-animation>
</a-entity>
```
 Try this https://github.com/ngokevin/aframe-event-set-component for setting things in response to events when you don't need to tween.
  I don't think I understand the Slack discussion, but components emit events on their element, so this works for any component:

``` javascript
el.addEventListener('mouseleave', function () {
  // do stuff.
});
```

OTOH `cursor-hovering` is a state, not an event, but the `mouseenter` and `mouseleave` events should tell you when it could have changed. You can check an element for a state with:

``` javascript
el.is('cursor-hovering') ? 'yep' : 'nope'
```

@cvan was your comment in Slack saying that maybe state changes should fire independent events, e.g. `statechange`?
 I think there's a stateadded / stateremoved event on the entity
  thanks!
  That'd be weird since if you stare at something, it'd keep clicking it.

you can copy/paste the cursor component to customize it though https://github.com/aframevr/aframe/blob/master/src/components/cursor.js
  Made this for now: https://github.com/ngokevin/kframe/tree/master/components/reverse-look-controls
  thanks!
  I cannot reproduce this on A-Frame 0.5.0 and iOS 10.3.1. Please reopen if this is still an issue.  thanks!
  Not sure. A-Frame doesn't depend on .VOX though, and suggested exports from MagicaVoxel is OBJ (or at least PLY).
  what's this for?
  Not quite possible, at least it won't be out of the box: http://stackoverflow.com/questions/36298195/how-to-render-youtube-videos-as-a-texture-in-a-frame?s=1|5.0516
  bounce isn't a valid easing function, you have to prefix with ease-in or ease-out or ease-in-out
  Thanks for reporting this. In principle the rendered size  when entering VR should be the one reported by the webvr API. More preciscely `vrDisplay.getEyeParameters`. This is managed by `VREffect`. I need to check how the window size is influencing the renderer size
 This also reproduces on Firefox Nightly  I think the bug that causde the regression is that the cursor is listening for the wrong event names `raycaster-intersection` and `raycaster-intersection-cleared`. Replacing those with `intersection` and `intersactioncleared` should fix the problem

https://github.com/aframevr/aframe/blob/master/src/components/cursor.js#L53
 Nevermind. Disregard. I was looking at 0.2.0 :)
 There are a couple of failing tests
 addressed at:
- https://github.com/aframevr/aframe/commit/e4900e16ea9228af39d2a4fef6798393e79bd82a
- https://github.com/aframevr/aframe/commit/37c33d2cc88de369feff7027f3d1e24b305ef496
  If you use 0.3.0 stable, then #899 shouldn't apply. Are you using master or stable 0.3.0?
 I see. Will think about how to resolve that.

You can do a workaround by using entities.

`<a-entity geometry="primitive: plane" material>`

When you are ready, set the material src:

`el.setAttribute('material', 'src', 'url(myvideo.mp4)');`
 This was introduced in https://github.com/aframevr/aframe/pull/1789

Need to update that code to not error if there's not a `src`
 Fixed thanks
  Can you PR to rstats: https://github.com/spite/rstats to add a **class** to those under/over-threshold fields? That way we don't have to hack the JS file and apply through CSS
  Thanks!
  We bumped the webvr-polyfill which had some issues with iOS. There is currently a bug in iOS Safari related to canvas resizing such that if we had it at full resolution, VR mode would look broken until you turned the phone. This should be fixed in iOS 10, so we told A-Frame to give it full resolution for iOS 10 Safari.

If you want full resolution (but it will look broken until you turn the phone), you can set `window.WebVRConfig = {'BUFFER_SCALE': 1}` before you include A-Frame.
  You can remove the `look-controls`.

Just define `<a-entity camera>` without look-controls
  nice catch
  everything else looks good
  Is the funcionality equivalent?
 We use the ghpages script across the boilerplate, most published components in the ecosystem use it, and I use it for my projects too. So it's good, thanks!
  Seems like we could also assert the URL now for good measure: https://github.com/aframevr/aframe/pull/1864/files#diff-4f03fc30c4b0a8c6c5d3703fc9d6e58aR29
 The `<script>` tag would still be there and not destroyed right? We can tear it down in the test teardown.
  needs unit tests
 thanks!
 FWIW, I opened a PR about `postMessage`-ing data in #1487. probably not necessary any time soon, but I can see the query-string parameters getting messy over time.
 query string params for stats would've been useful in several cases when i wanted to showcase scenes that had stats on.
 Test added.
 Where are `queryStrings` documented? I agree with @cvan. It is a slippery slope to sprinkle queryParameter based switches all over the place. Is there a way to make it component agnostic and self contained by having a `queryParameter` component?
 IMO, the behavior should be contained within the component. I don't think it's a slippery slope, having query params here isn't going to encourage us to have query params in other components. We have some precedent on not trying to anticipate. To date, we only have two: `stats` + `vr-mode-ui`. We'd document the behavior from within the relevant component.

Though alternatively, you could have an agnostic component that detaches/attaches components based on query parameters. Something like `queryparam-detach="component: stats; queryParam: stats"`. I don't like this as much because it's more API, more default components to add, and it's indirect.
 What about going with a strictly `postMessage` API? Seems lightweight and changing the settings wouldn't cause a page refresh. Or if we don't want to go there yet, use hashes (since those won't reload the page upon changing, but you can listen for `hashchange`).
 postMessage is for I-Frames and is more complex. My use case is just when someone publishes a scene with stats on, I want to share it with stats off. We don't need dynamic change of the settings here, don't think we're gonna be toggling the stats on and off across origins. And also web pages should only have one hash, giving it functionality for stats makes things odd. 
 > postMessage is for I-Frames and is more complex.

`postMessage` is not necessarily for iframes. can be used for these following use cases:
- a document can `postMessage` to itself
- a scene can `postMessage` to another scene
- a Web Worker can `postMessage` to scene(s)
- a Service Worker can `postMessage` to scene(s)

> And also web pages should only have one hash, giving it functionality for stats makes things odd.

Do you think that will hold true? Already the author of the [`aframe-href-component`](https://github.com/gasolin/aframe-href-component/blob/e1e49f3/basic/anchor.html#L16) is using a hash to jump to an entity in the scene. How would you load https://gasolin.github.io/aframe-href-component/basic/anchor.html#blue-cube and disable stats if we're assuming a "single hash"?

I don't have a perfect solution in mind, but I think it'd be more future-proof, extensible, and user-friendly to introduce a `postMessage`-based solution and introduce a method on the `AFRAME` global, such as `AFRAME.stats.disable()` - which would disable stats and store a value in `localStorage` to disable stats upon subsequent page loads.

(Related: For the [eleVR Web Player](https://github.com/hawksley/eleVR-Web-Player#ability-to-load-external-video-urls-via-query-string-hash-postmessage), I introduced a few (albeit complicated but versatile options) for configuring the player without having to write a bunch of boilerplate code.)
 RE: postMessage use cases. None of those have anything to do with stats. I mentioned I-Frames because I assumed that was your use case.

> How would you load https://gasolin.github.io/aframe-href-component/basic/anchor.html#blue-cube and disable stats if we're assuming a "single hash"?

I wouldn't, which is why I'm in favor of using queryparams and not hashes as you proposed `use hashes`.

> I don't have a perfect solution in mind, but I think it'd be more future-proof, extensible, and user-friendly to introduce a postMessage-based solution and introduce a method on the AFRAME global, such as AFRAME.stats.disable() - which would disable stats and store a value in localStorage to disable stats upon subsequent page loads.

Don't see why all this over a queryparam. I think we're missing why we're introducing a flag to disable stats. If a developer wanted to disable stats on their own, they would just remove it, they wouldn't call a global method. The use case is to disable stats when the developer has set it and we want to showcase it without.
 > Don't see why all this over a queryparam.

what do you mean by `all this`? as I'd expect in any other PR, I think we can agree it's fair to question additions to the codebase, regardless of the seeming size or scope of the change.

> I think we're missing why we're introducing a flag to disable stats. If a developer wanted to disable stats on their own, they would just remove it, they wouldn't call a global method. The use case is to disable stats when the developer has set it and we want to showcase it without.

apologies, either the past conversation I think got truncated here, or I was just getting confused between PRs (as this is over three weeks old now).

> If a developer wanted to disable stats on their own, they would just remove it, they wouldn't call a global method. The use case is to disable stats when the developer has set it and we want to showcase it without.

what do you mean by "showcase"? do you mean fire up the URL of an A-Frame scene, manually/automatically take a video/GIF/screenshot? or do  you mean link to a URL from our "showcase" (i.e., the A-Frame Blog or from Twitter)?

in any case, I would imagine that we would want to normalise all the presentation of the page (meaning disable stats UI, debug mode, cursor style of `<body>`, hide the VR goggles/any other button UI). if that's what we're going for, I would recommend instead of having a one-off for `stats` (which as @dmarcos says could be a slippery slope), perhaps what we want instead is a `presentation` mode? thoughts?
 > what do you mean by all this? 

I was questioning the complexity of the solution (which actually doesn't solve the problem).

> what do you mean by "showcase"?

Both

> in any case, I would imagine that we would want to normalize all the presentation of the page...could be a slippery slope

The only thing we currently desire is the ability to disable stats. Debug mode has no visual effect, don't had a need for cursor style customization, don't have a need for hiding the goggles. I don't imagine a slippery slope, adding a query parameter here is not going to encourage other uses, it's just the simplest solution that effectively solves the problem so we can move on.
 Any more thoughts on his?  Just want to keep it moving....
 I'd r+ it, but making sure everyone's OK with it. Simple use case, simple solution, should be cut/dry.
 go ahead
  There's a currently a PR open to swap to BrowserSync. Will close in favor of that: https://github.com/aframevr/aframe/pull/1671
  Thanks, should we just use that video on desktop too?
 I see, thanks. I suppose the proper API might be something like:

```
<a-assets>
  <video id="city"></video>
  <video id="cityMobile></video>
</a-assets>

<a-videosphere degrading-src="desktopSrc: #city; mobileSrc: #cityMobile"></a-videosphere>
```

where degrading-src is a component...although it's a lot to bend backwards just for iOS. I wonder if we should just document the limitations and move on
 Thanks, will keep that issue to have that example swap to mobile using a component and/or just wait for iOS 10.
  Crap, thanks.
 Here's a workaround:

``` js
AFRAME.registerComponent('gearvr-height-fix', {
  dependencies: ['position'],

  init: function () {
    if (!AFRAME.utils.isGearVR()) { return; }
    var position = this.el.getComputedAttribute('position');
    position.y += 1.6;
    this.el.setAttribute('position', position);
  }
});
```

``` html
<a-entity gearvr-height-fix>
  <a-camera></a-camera>
</a-entity>
```
 @poshaughnessy Fixed to call `isGearVR()` correctly. 

Will get around to a proper fix.
  brave enough for a test? i spent a lot of today testing look-controls, would be great to have a start on wasd-controls. i'd mimic https://github.com/aframevr/aframe/pull/1853/files#diff-387522ff670c30773ff46795b9f7dc84R7 where tests are in `core/controls.test.js` and we integration test using the default camera.
 could use a small test
 I was writing a test for this today, it kept failing, so upon further review I don't think this is needed due to @ngokevin's recent PR and this line: https://github.com/aframevr/aframe/pull/1904/files#diff-6231789e7e7fac0fbea47834d09b3bdcR56

Let me know if I'm wrong but I think this can be closed.
 Cool. Thanks. I was just writing the tests to accompany the look-controls and guess I accidentally did this too.
  Thanks, if you catch any `you`s in a guide, we could make it consistent.
 This should be good for review @ngokevin 
 Still a few "you"s instead of "we"s
 The remaining "you"'s are appropriate -- they reference the user making future scenes, not the scenes we're making in the guide.
  Thanks, we can apply the same to the other couple parts
  Thanks for the feedback. Those events should be provided by an external component. They are out of the scope for aframe core. 
  Thanks for catching this.

The `obj-model` component has an initialization dependency on the `material` component. But it seems that it's not being honored?
 fixed
  We can get full coverage if we also test the `remove` (detached) callback. This should remove the event listener when the components is detached (with `removeAttribute`).
 Thanks!!
  I found some stuff here: https://github.com/bfred-it/iphone-inline-video

I wonder if you need to add `muted` to get it to play without user interaction?
 Hm, they should both follow down the same code path. plane/sphere shouldn't make a difference.

What if it's just one video? And does the city.mp4 video play on desktop? What if we try to play `#video1` on the videosphere?
 Thanks for the investigation. We should re-encode our example video and document the restrictions.
 Will keep the issue around for now to do those couple tasks.
 FWIW, I already fixed this in `master` in PR #2656. are y'all referring to something else?

After a lot of trial and error, the command I used was this:

```js
ffmpeg -i city.mp4 -vf scale=3168:-2 city-3168.mp4
```
  thanks!
  **Description:**

With an extended deprecation period for the src type. 'asset' reinforces the relationship to a-assets and is less vague / more descriptive compared to 'src'. 
- A-Frame Version:
- Platform/Device:
- Reproducible Code Snippet or Demo URL [highly encouraged]:
 `<img>` is a type of asset within `<a-assets>` so it related. I'd intend to only have one property type, but giving time for deprecation.
 It's supposed to map to the concepts of assets, not 'src' which is a string. And 'src' in context of property types is not immediately obvious. 

Note this is only for property type name in schema, not the attribute name 'map: {type: 'asset'}'
 Hi! Again, this is for the name of the internal property type, not the name of the HTML attribute.
  I got it working in https://github.com/aframevr/aframe/pull/1845

I wonder if it's a component initialization order issue.
 fixed
  Thanks!
  thanks!
  Thanks, I agree, it needs an iteration. I'm trying to get more boilerplates into the repo each with a guide so this guide will be de-emphasized.
 thanks, we've just remove that section since we had a patch that makes it no longer necessary.

i will try to get a guide some time about detailed case studies on writing different kinds of components
  I have tested these updates fairly extensively. Failed to update three to 0.79 because of failing tests on textures and material
 Thanks! I;m not in favor to update dependencies if there's not a reason too. There can be a lot of subtle bugs. I for example spent too much time chasing viewport problems with the webvr-polyfill
 Update three.js dependency is definitively due.
 I believe dependency update has to be deliberate: why do we want to update?
 @dmarcos Better to do it now than later. As aframe is running for 0.4.0 many new futures will be added! Right? As currently there are long time warnings for some deps. about to become deprecated. while now you already see warnings that your deps will stop working since their deps will not be included in future releases etc. I find that this is a must that at the beginning of next version roadmap you update your deps and solve any exposed issues before you start building new futures on top of something which may not work anymore when you finally to the update. Another point here is that webvr and aframe are cutting edge therefore should not take to easy keeping deps up to date. Quality of Aframe can suffer in long term. Can't say that this will happen, but risk factor it is for sure. For example it was known after three 79 came out that Aframe has issues with it, but so far nothing has been done to fix that while three is nr 1 dep. I don't know if that makes any sense to you and do you get what I'm worried about, but I shared my opinion anyway :). And I totally understand your point ex with polyfill, but can that be as excuse not to update nevre again or if then when everything craches?
 And if you have solid plan how to track that need of dep update, based on what to consider when to update - then please share. It would be useful info.
 > As currently there are long time warnings for some deps. about to become deprecated. while now you already see warnings that your deps will stop working since their deps will not be included in future releases etc. 

@mkungla What warnings are you referring to?
 > I find that this is a must that at the beginning of next version roadmap you update your deps and solve any exposed issues before you start building new futures on top of something which may not work anymore when you finally to the update.

Dependencies like `object-assign`,  `promise-polyfill` or `style-attr` play a very specific role and they fulfilled their function flawlessly. Why fixing what it's not broken and expose us to possible regressions or carrying additional features we don't need? A library increasing a version number does not mean that there are less bugs than the previous version or regressions have not been introduced. 
 Can we change this PR to just update `three.js` and evaluate each dependency individually. For the `devDependencies` I'm not that worried if we make sure that they work on Windows.
 i'm on gihub mobile at the moment and can't tell from head right now. Im back online within 3-4 h and can check then. But you can see by your self by installing aframe and (verbose) output of npm speaks for it self.
 Sure lets to three then.
 @dmarcos 
So I revert then all, but devDependencies?

> Can we change this PR to just update three.js

Sure, but which version? `0.77.1` which has been tested and working or `0.78 , 0.79` which exposes some issues and requires to fix blocking issues with `textures`.

> and evaluate each dependency individually

That lives here for a while #1635
 @mkungla can we move the devDependencies to a different PR?
 sure, how is it going to be then with three? 0.77.1?
 @mkungla anything wrong with 0.80.0?
 Yes, as build finishes and fails, Check the build logs. These failures are with three  >= 0.78
 @dmarcos I guess we have to start digging into these issues first and reference each issue to this PR?
 @mkungla Yeah, it seems something is different with the `THREE.TextureLoader`. We have to investigate what has changed. Thanks for looking into this.
 This has been done. Thanks though! We still need r82.
  thanks!
    Fixed by @cvan, thanks!
 Also see #316 and https://aframe.io/docs/0.3.0/introduction/faq.html#why-does-my-video-not-play-on-mobile for more info.
  Uses `event.code` in browsers that implement it, which is layout-agnostic and should consistently correspond to the physical locations of the WASD keys, not their letter-equivalents.

Also adds <kbd>‚Üê</kbd><kbd>‚Üí</kbd><kbd>‚Üë</kbd><kbd>‚Üì</kbd> for good measure.

Would understand if we don't want to merge this while #1248 is still open, but this seems like a nice-to-have for users outside the U.S.

Fixes #333, #1409, and #1490.
 Thanks!
  Nit that's been bugging me, in both Sublime and Atom I have JSHint plugins configured that automatically apply the nearest .jshintrc. In A-Frame's case there's nothing to indicate that `require()` and `module.exports` are allowed, so they're flagged:

![screen shot 2016-08-19 at 11 34 19 pm](https://cloud.githubusercontent.com/assets/1848368/17828631/a4c837e8-6665-11e6-9345-3df55229248c.png)
 Same here has bugging me too with Atom
  @darkwing **Steps to reproduce** is definitely needed info in many cases. Besides that I find really useful how [three.js](https://github.com/mrdoob/three.js/issues/new) new issue templates are.

So even if you find a bug in `Windows`, `Chrome`, `Aframe 0.2.0` and I test it and get same bug in `Linux`, `FF`, `Aframe 0.3.1` then adding these gives better overview about extent of issue.

But I don't know what others think about that. @ngokevin , @dmarcos ?
If there is something else to be considered to add into new issue template perhaps you can add it to this PR.
 Most cases we can track down the issue given a simple description. In the contributing guide, it mentions a test case as optional/extra.
 Is it fair to replace the text with?
`Reproducible Code Snippet or Demo URL [highly encouraged]:`
If someone does not have the time to provide the test case... Do we prefer them not to file the issue?
 Thanks!
  thanks!!
  Let's not commit the dist
 Would you have time to add some unit tests in `src/tests/shaders/standard.test.js`? Unit tests for setting each kind of map and wrap type? If not, I can help out. 
 Looking good, thanks! If you rebase the PR, the Codecov errors should go away.
 Also think it'd be good to put your example scene in `examples/test`
 We can do that now or later ^ your call
 Sorry, one more thing. Is it possible to get coverage for spherical maps after post-load?

<img width="1101" alt="screen shot 2016-08-20 at 3 28 15 am" src="https://cloud.githubusercontent.com/assets/674727/17830643/2e3c9d64-6686-11e6-98b8-50f7a45fd1ec.png">
 Hm, okay. We can do that when we add coverage for envMaps in general (as well as a bit of refactor) later on.
 We merged a patch to normalize carriage returns and line feeds. Might be easy to start from master and copy paste your code on. @mkungla might have tips for rebasing
 @AdaRoseEdwards what files do you have conflicts with? Try to replace windows endlines with unix end lines in those files. Commit in your branch and rebase again
 Whe I said commit I meant ammend... @AdaRoseEdwards I'm happy to help if you need
 Trying setting `git config --global core.autocrlf true`
 @AdaRoseEdwards your ~~last~~ commit went wrong since your merged `master` branch was behind `aframevr/master` 
1. revert this last commit 

``` sh
git checkout standard-material
git reset --hard HEAD~1
git push -f origin standard-material
```
1. Make sure you have one `git remote` pointing to `aframevr/master`

``` sh
git remote -v
#should give you output something like this
origin  git@github.com:AdaRoseEdwards/aframe.git (fetch)
origin  git@github.com:AdaRoseEdwards/aframe.git (push)
upstream    git@github.com:aframevr/aframe.git (fetch)
upstream    git@github.com:aframevr/aframe.git (push)
```

if you don't have any remote pointing to `git@github.com:aframevr/aframe.git`
then add it 

``` sh
git remote add upstream git@github.com:aframevr/aframe.git
```

then update your forks master, as I see you have also there one conflicting commit "Add more physical maps to stadard material" back this code up and revert this commit as well

``` sh
git checkout master
git reset --hard~1
git push -f origin master
```

Now you can rebase your master

``` sh
gir fetch --all #do get info from both remotes
git rebase upstream/master
git push -f origin master
```

Now your fork master is in sync with aframe master and you can rebase/merge with your other branches
 #67e1ecd worked and can be squashed when merging but good idea to sort out your fork anyway :)
 @dmarcos lgtm
  Main purpose is to fix mixed linefeeds and have cleaner
master branch by flaging some files as binary so that git
won't create unnecessary big diff objects. Related to #1586, #1658
This is necessary so that added .gitattributes
could be dealt same as regular PR's and would not affect
new clones. No action needed by Collaborators since together with
second commit including fixed line feeds this PR can be treated as regular!
Some currently open PR's may need rebase with this commit if PR's
if PR have common files fixed with this PR.
 After merge only thing to do is to bump new dist!
  You can use the CubeCamera from three.js: http://threejs.org/docs/api/cameras/CubeCamera.html

And something like grabbing the render output from a renderer using the camera: http://stackoverflow.com/questions/15558418/how-do-you-save-an-image-from-a-three-js-canvas

I haven't done this yet so I don't have specifics. But you can definitely research, and it would be cool to see someone do it.
 Relevant links:
https://hacks.mozilla.org/2016/04/record-almost-everything-in-the-browser-with-mediarecorder/
https://mozdevs.github.io/MediaRecorder-examples/

Could easily build an A-Frame component using the `MediaRecorder` API (in very few lines too).
 I think this is for 360 recording or recording from an external in-scene camera, rather than a screencap.
  Thanks!
  https://github.com/ngokevin/aframe-animation-component might respond to updates
 I've been trying to maintain https://github.com/ngokevin/kframe/tree/master/components/animation more, but I haven't fully finished my most recent update. We've deprecated a-animation. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.

The component will respond to updates  Using something like [`markserv`](https://github.com/f1lt3r/markserv) as a dev dependency.

So you don't have to stand up both the `aframe-site` repo _and_ this `aframe` repo.

A very nice-to-have (but, of course, low-priority) feature.
 sounds good
  Thanks!
  Can we consistency-tize it the other way?
 I'd already been slowly moving it towards without spaces. I think spaces make them look like if or function blocks, and we don't have spaces for arrays.

``` js
if (hello) { return this; }
var a = { b: this.c };
```
  **Description:**

Testing `npm run dist` was redundant to `npm run build`.
  - Disable comments in favor of using the Travis CI statuses. To reduce noise.
- Remove failure threshold if a PR decreases overall coverage.
  This has been fixed. Thanks for reporting!
  **Description:**

Discovered and investigated by @dmarcos
  You do `entityEl.setAtrribute('visible', true / false);`
   Will fix the Codecov Travis failures soon. Need to remove the constraint that all PRs must improve coverage.
  Firefox nightly in travis does not run tests so let's replace it with `Firefox Latest` 

Firefox latest: Firefox 48.0.0 all checks have passed
https://travis-ci.org/mkungla/aframe/jobs/152856107

Travis default Firefox 31.0.0
https://travis-ci.org/mkungla/aframe/jobs/152852975 some tests fail
  **Description:**
- Add unit tests for enter/exit VR also covering the canvas fullscreen styles.
 The problem is caused by the styles applied by the polyfill on the canvas element:
https://github.com/borismus/webvr-polyfill/blob/v0.9.15/src/cardboard-vr-display.js#L224
Our `position: fixed` is overridden 
https://github.com/aframevr/aframe/blob/master/src/style/aframe.css#L49
Making `position: fixed !important` solves the problem
 This one is risky. I would postpone this post 0.3.0
  In order to use "powerful APIs," your site must be served from a "secure origin" - that is, be served over TLS or `http://localhost:*`/`http://127.0.*.*` (see [this](https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features and [this]%28https://w3c.github.io/webappsec-secure-contexts/%29 and [this]%28https://github.com/w3c/webvr/issues/60%29, etc. for more context).

It's worth noting that WebVR is not a "powerful API" just yet, but already today some APIs such as are already a hassle to use (door-hanger permission prompts spamming on every API request/page load in Firefox or disabled in Chrome). Example: `navigator.getUserMedia` with Firefox over HTTP won't persist the "allowed" notification (only for HTTPS), and the API is already outright deprecated for external IPs/non-HTTPS origins in Chrome.

There's an easy way to create a self-signed cert from an `npm command`: https://github.com/cvan/webvr-holodeck/blob/6581527/package.json#L9

It's worth noting that `budo` offers this out of the box now: https://github.com/mattdesl/budo/blob/master/CHANGELOG.md#900

Relevant to issue #1277, which is being handled in PR #1671‚Ä¶ also good news is that BrowserSync also already supports HTTPS out of the box (just set `https: true` in the options). (And here's the relevant script: https://github.com/BrowserSync/browser-sync/blob/master/lib/server/certs/gen.sh)
 Merging with https://github.com/aframevr/aframe/issues/1277

Though I am not sure why we need SSL for localhost since APIs will allow access to localhost, but #1277 will solve anyways. There's a PR open https://github.com/aframevr/aframe/pull/1671 Although `http://localhost` and `http://127.1.x.x` are whitelisted as "secure origins" in Chrome and Firefox, if you need to test on mobile devices or dedicated remote devices (Google Daydream/Cardboard, Gear VR with Samsung Internet/Carmel, dedicated Windows machine for VR), you must load a URL on your LAN (e.g., `http://10.0.1.59:9000`) and load the scene in the headset.

Additionally, when testing a WebVR site (without ngrok/localtunnel/self-signed HTTPS), any WebVR site loaded in Chrome for Daydream injects a "This site is not secure" window that persists directly in front of you in VR (for the entire duration of the VR session); it's really the worst.

Unfortunately, when serving over a non-secure origin, most browsers won't let you use APIs such as Service Workers, `getUserMedia`, Speech Recognition/Synthesis, `devicemotion`, etc.
 (Chrome tends to be stricter in [its secure-origin policy](https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features), but Firefox, Safari, and Edge all have similar documented and enforced policies.)

I've looked at several projects/boilerplate/starter kits; unfortunately, most of them have quite convoluted instructions for setting up HTTPS (because it's intentionally difficult to generate self-signed certs [especially wildcard ones] and get the browser + OS to accept them, especially on macOS).

Possible solutions that come to mind:

* Recommend using [ngrok](https://ngrok.com/) (which returns both `http` and `https` URLs).
* Consider creating a boilerplate using BrowserSync (which is a nice `npm` local dev server that has a bunch of cool recipes, including easy HTTPS, built-in `localtunnel` support, and live-reloading).
* Document instructions for self-signed SSL certs and serving HTTPS.
    * Somewhere in the docs for local development (and for any A-Frame boilerplates that run locally, such as [this one](https://github.com/aframevr/aframe-boilerplate/)), we could link to [bud≈ç's docs on HTTPS](https://github.com/mattdesl/budo/blob/master/docs/command-line-usage.md#ssl-and-https).
 OK. I had a section on ngrok in the School, and I can add it to the Getting Started some time. Since the entry point is starting to be more and more Glitch, that will help as well. awesome - thanks! üëç  also, great work on the Glitch boilerplates. very excited to be able to do more development from my Chromebook. üíª  üò∫   **Description:**

Workaround for [Webkit bug on iOS Safari < 10](https://bugs.webkit.org/show_bug.cgi?id=152556).
### Before

Upon Entering VR from landscape without orientation change:

![img_3576](https://cloud.githubusercontent.com/assets/674727/17687932/92352120-632e-11e6-8168-ae6259ed4bb6.PNG)
### After

Stereo now sized correctly, at the cost of decreased resolution. With the version check, this should automatically be addressed once people upgrade to iOS 10 as the Webkit patch rolls out.

![img_3575](https://cloud.githubusercontent.com/assets/674727/17687931/92350a14-632e-11e6-9d0e-278b66cab73f.PNG)
 I have to try this tomorrow on my iphone 6 Plus that has `devicePixelRatio === 3`
 The canvas size gets fixed when turning the phone to portrait and back to landscape. Is avoiding that glitch more important than keeping the high resolution? 
 I think so, I don't think it's acceptable that people (not developers) have to know to rotate their phone back and forth. Many would think it was just broken and leave. With the version check, trying to have it automatically be addressed once iOS 10 starts rolling out.

I'll change it to `1 / window.devicePixelRatio` then for iPhone Plus.
 Yes, I confirm we need `1 / window.devicePixelRatio` to make it work on the iphone6 Plus
  **Description:**

https://codepen.io/ngokevin/pen/AXNZwV

Allow CodePen to listen to click of the scene to blur their text editor.
 Oops, I updated the CodePen. Didn't have look-controls attached...
 Yes that seemed to solve it
  **Description:**
- [x] wait for travis to see if it works
## **Changes proposed:**
## 
## 
  It is due to the use of `MutationObserver` in the `registerElement` polyfill. Default lights are first added to the scene and immediately removed by the light system when the scene lights initialize.  By the time the `attachedCallback` method is called for the default lights `parentNode === null` due to have been removed. The solution is postponing the default light creation until the scene has loaded and prevent the spurious default lights. This also makes the light and camera systems consistent.
 @FrederickDesimpel yeah! good point! I'm going to make some changes to adjust.
 r+
  **Description:**
The current `geometry-gallery` example uses `thetaLength: 350` for circle and cylinder makes them looks like broken:
<img width="444" alt="screenshot 2016-08-12 21 19 17" src="https://cloud.githubusercontent.com/assets/782511/17634402/bd88b37c-60d2-11e6-9ef3-860885e9efac.png">

I've just changed them to `360`:
<img width="409" alt="screenshot 2016-08-12 21 19 36" src="https://cloud.githubusercontent.com/assets/782511/17634440/e5be79d0-60d2-11e6-995e-645f6df9d26c.png">
    **Description:**

If cross-origin media element is defined in `<a-assets>` without `crossorigin` attribute set, then `<a-assets>` will re-append the media element **with** `crossorigin` set to re-request with correct headers. three.js will then be able to access the contents of the resource.
- [ ] tests

This means **no more CORS confusions**!
  **Description:**

`updateHeightOffset` was not taking into account mobile.

**Changes proposed:**
- Simplify by removing `updateHeightOffset` since `addHeightOffset` can handle it if `oldData` is passed in.
- Fix enter VR since sometimes `removeHeightOffset` was getting called before `saveCameraPose`.
- Should not have to do `addHeightOffset` on exit VR now since `restoreCameraPose` handles that.
  **Description:**

All of our docs and guides are in `docs/`. It would be cool to have a script check grammar/typos across all the docs.

Examples:
- https://github.com/robinvdvleuten/gingerbread
- Prose checkers: https://github.com/btford/write-good / https://github.com/ngokevin/engrish
 @Coder206 go for it
 I have feeling that should not be as part of `npm start` (`npm run dev`) .
Seeing that more as independent script which maybe executed as  part of `npm run precommit`, but that's just a thought.
 [Grammarly](https://www.grammarly.com/) is also quite good
 Grammarly is a browser extension, we're looking for something we can run as a script on our files
 I know, was just suggesting it because I know a lot of companies and schools use it (so it's probably decent). I've used it with some luck a few times. As for automated scripts, I saw the one you wrote, which is cool, and I'm sure there are many, many others out there. I'm sure y'all have done your research. I found these links, if they're of any help:

https://github.com/mrmarbles/wordsworth
https://www.chromium.org/developers/design-documents/extensions/proposed-changes/spellcheck-api
http://codepen.io/aecend/pen/rOebQq
 thanks for the research. so far i think gingerbread looks the most complete, although it relies on an external service. most of our doc typos so far have been grammatical in nature rather than spelling
 Thanks for experimenting! Maybe we can trim code snippets?

```
var gingerbread = require('gingerbread');

var text = readFileSync('blah.md', 'utf-8').contents;
cleanedText = removeCodeSnippets(file);

gingerbread(cleanedText, function (error, text, result, corrections) {
  // result contains 'The smell of flowers brings back memories.'
});
```

This includes inline code blocks (separated by backticks) as well as entire code blocks (separated by triple backticks).
 Yeah, and the YAML headers. And links. It will take some fine tuning, but would be useful to many other projects too.
 wontfixing unless someone has an easy idea  Test coverage is localy browsable and found in coverage/report
Added travis after_success: for posting report to codecov.

Added devDependencies,
istanbul, browserify-istanbul, codecov, karma-coverage

Updated devDependencies,
browserify: ^11.0.1 -> ^13.1.0
karma: ^0.13.15 -> 1.2.0
karma-browserify: ^4.4.0 -> ^5.1.0
karma-firefox-launcher: ^0.1.6 -> ^1.0.0
karma-mocha: ^0.2.0 -> ^1.1.1
karma-mocha-reporter: ^1.1.0 -> ^2.1.0
karma-sinon-chai: ^1.1.0 -> ^1.2.3
lolex: ^1.4.0 -> ^1.5.1
mocha: ^2.3.3 -> ^3.0.2
sinon: ^1.17.3 -> ^1.17.5

I wasn't familiar with [Coveralls](https://coveralls.io/), so used [codecov.io](https://codecov.io/) instead
 **You can test this PR out,**
_Create new branch with username prefix since it is easier to remember what branch is what_
`git checkout -b mkungla-coverage master`
_Pull and merge my coverage branch_
`git pull https://github.com/mkungla/aframe.git coverage`

now if you run tests then new directory called `coverage/report` is created which is static html so you can see what your test are covering.
 Works great!!
  Can we get some unit test coverage on it?
  thanks!
  @Haydos585 you can to PR with changes!?
 there's an edit button at bottom of docs that makes it super simple in case you didn't catch it
  We mention it at:

https://aframe.io/docs/master/guide/device-and-platform-support.html

and I believe the new FAQ will lead to this page as well. I deferred to caniuse and iswebvrready because the browser support will be changing outside of the scope of A-Frame.
 Although just briefly. I suppose I could highlight it more with a Browser Support section
 Heard that  WebVR API will  be put into [caniuse](http://caniuse.com/). It would be difficult to maintaining own browser list and keep it up to date.
 @mkungla that'd be really nice in combination with https://caniuse.bitsofco.de/
  **Description:**

It'd be beautiful if all assets in every scene were automatically cached by service workers.

Or perhaps cache everything fetched by three.js loaders in general. We should be able to hook into everything that three.js loaders fetch (which is stored in THREE.Cache).

[Service Workers: Cache then Network](https://serviceworke.rs/cache-then-network_index_doc.html)
 Just to keep it mind that with `audio` and `video` `THREE.Cache` can cause problems since you can't modify `ArrayBuffer` after it is attached so you may ran into.

>   Uncaught InvalidStateError: Failed to set the 'buffer' property on 'AudioBufferSourceNode': Cannot set buffer after it has been already been set
 Service Workers act as HTTP request interceptors, and can choose to resolve a request with data from IndexedDB immediately? Seems like that could be cleanly separated from AFRAME, aside from registering some sort of cache-clearing mechanism. 
 > Service Workers act as HTTP request interceptors, and can choose to resolve a request with data from IndexedDB immediately?

That's one use case, yep. You could create a "synthetic"/mock REST API.

I think Service Workers are more useful here as a pass-through cache: upon requested, if the resource matches a certain host, path, and/or extension, cache the resource after the response has been fulfilled. Also, selectively caching resources that will be used often and not change - that's also a great use case. Or, even if they are used often, the Fetch + Cache APIs are super powerful when used within a Service Worker. There are lots of interesting use cases, especially for WebVR. The obvious end goal being to have a completely offline VR experience, but the low-hanging fruit is obviously quicker loading times with aggressive caching.

IME, a Service Worker for A-Frame scenes is not premature optimisation. But, YMMV, definitely.

Also, IMO, there should be multiple configuration options. Caching the resources (and invalidating them appropriately) can make all the difference in the network response time. Offline is obviously a great goal to have in mind, but at least to start, scenes will load _drastically_ faster with default/smart Service Workers that can be enabled. (I had some decent luck with Service Worker-ify-ing [DrawVR](http://drawvr.com/)'s scenes and was messing around with them for the [Holodeck Club](https://github.com/holodeck-club/holodeck-club.github.io/)).

[sw-toolbox](https://github.com/GoogleChrome/sw-toolbox/blob/master/recipes/cache-expiration-options/service-worker.js) IME works pretty well without having to write a ton of boilerplate code.
- https://googlechrome.github.io/samples/service-worker/custom-offline-page/
- https://googlechrome.github.io/samples/service-worker/selective-caching/
- https://googlechrome.github.io/samples/service-worker/prefetch/
- https://serviceworke.rs/
- https://github.com/GoogleChrome/samples/tree/gh-pages/service-worker#service-worker-recipes
- https://github.com/holodeck-club/holodeck-club.github.io/blob/d274e3c/common/assets/js/lib/webvr-commander.js#L35-L41, https://github.com/holodeck-club/holodeck-club.github.io/d274e3c/master/sw.js
- https://github.com/fxos-components/serviceworkerware
- https://github.com/googlechrome/sw-toolbox
 Here are the related issues for the https://aframe.io site (aframevr/aframe-site#110) and the Examples we show there (aframevr/aframe-site#110).
 What do you think about an opt-out API?

``` html
<a-assets sw-cache-ttl="3">  <!-- Invalidate in 3 days. -->
  <img id="myTexture" src="texture.png">  <!-- Will get cached by default. -->
  <a-asset-item id="myModel" src="myModel.obj" sw-cache="false">  <!-- Will not get cached. -->
</a-assets>
```
 My two reservations about an opt-out API would be:
1. Users should be able to fork and/or add custom modules to the SW, since a site only gets one. Physics would also seriously benefit from SW, which I haven't configured with aframe-extras.physics yet, but it's definitely a goal.
2. For opt-out ‚Äì I don't think it's possible to both install and run a SW from the same script; you need to invoke `navigator.serviceWorker.register('/sw.js')` and then that file needs to just be there. This makes Browserify and Webpack dev workflows pretty incompatible. So the current add-aframe.js-and-go would need to be replaced with more of a prescriptive boilerplate.
 I would definitely have the units for expiry not be in days - need to be way more granular (even preferable to be in sec or ms).
 > 1. For opt-out ‚Äì I don't think it's possible to both install and run a SW from the same script; you need to invoke `navigator.serviceWorker.register('/sw.js')` and then that file needs to just be there. This makes Browserify and Webpack dev workflows pretty incompatible. So the current add-aframe.js-and-go would need to be replaced with more of a prescriptive boilerplate.

We can document this. And it can be optional. Also, see https://github.com/GoogleChrome/sw-precache. TBH, it's probably asking some library maintainers (maybe folks on the Polymer team?) how they plan on maintaining SW.

What I would do is just make it really easy to opt-in with config settings (which IMO we should have on `require('aframe')`/`window.AFRAME` - and have the `sw.js` URL easy to download (or pull from npm).

<hr>

This is part of a larger discussion that I'll postpone having in this issue, but I've been thinking about Webpack for a while now. and it seems like it might help us do some nice custom builds with ease. and the size savings seem to be quite significant. I was a Browserify proponent back in the day, but the "flavour of the month" seems to have something to it. We can discuss in another build.

Thanks for all the feedback, y'all. Appreciated.
 @Coder206 nope, this can be totally different. I would try aframevr/aframe-site#110 first and then see which best practices you can borrrow for aframevr/aframe-site#111 (which technically could live in this repo [aframevr/aframe]). Or it could be part of a hexo pre-deploy script, whichever.
 Relevant: Relevant: https://medium.com/@addyosmani/offline-storage-for-progressive-web-apps-70d52695513c
 Btw, I filed #951 back in Feb. Do you want to keep that open? My inclination is to have this issue be for investigating SW and writing an opt-in component. And then #951 would be for including an example of using aforementioned component. Sound good?
 yeah sounds good
 I would suggest using https://github.com/GoogleChrome/http2-push-manifest for weighting the manifest by filesizes. Before we run `npm run deploy`, I would generate the Service Worker. And we should keep a quota limit so we don't exceed sane limits. would leave as a separate generator tool for a-assets and can link from docs

meanwhile https://www.supermedium.com/blog/service-workers  Thanks
  thanks good catch!
  @darkwing and @ngokevin wouldn't following be a solution? and perhaps add then polyfill into lib for compatibility.

``` js
var medias = Array.from(this.querySelectorAll('audio, videos'));
var imgs = Array.from(this.querySelectorAll('img'));
```
 makes sense while there would be possibility to add polyfill for Array.from
 Selecting nodes without the need to traverse the DOM in tedious loops is nice, however @ngokevin and @dmarcos probably have better overview what performance impact querySelectorAll can have in this context for A-Frame.
 @davidwalsh I noticed a bug, it should be `video` not `videos`.
 I'd file an issue for polyfilling NodeList forEach/map.
 Thanks!
  Thanks
  It would be more robust to traverse all the scene children and check for the `isEntity` flag on them. Nothing prevents people to register a primitive with a prefix other than `a-XXX`. By checking `isEntity`  you don't need a special case for `a-animation` either.
  @darkwing could you edit please your issue and  review the [guidelines](https://github.com/aframevr/aframe/blob/master/CONTRIBUTING.md) for contributing to this repository. 
Missing information about OS/Browser!
  @darkwing actually, how are we sure qsa returns an array again?
  @fernandojsg The inspector is involved with this. Thoughts?
 It's ok for me, as I could look for those `aframe-injected` and remove them before exporting or copying to clipboard the scene.
 @fernandojsg Do you want the aframe-injected also on the VR mode UI, canvas, meta tags?
 Yep that would be great! As right now I'm removing them by hand: 
https://github.com/aframevr/aframe-inspector/blob/b9e46216e005a1117a708943342cb589aed81524/src/lib/exporter.js#L39-L47
So what you said VR Mode UI, canvas, metatags, CSS, ...
 @darkwing would you mind remove those as well? I think the issue was primarily for @fernandojsg's inspector to generate HTML
 thanks!
 @ngokevin @darkwing  ops, sorry I was a little bit late to the conversation, maybe it could be another PR, but what about including `aframe-injected` to the CSS?
`<style type="text/css" data-href="src/style/aframe.css">`

And probably for the stats too?
`<style type="text/css" data-href="src/style/rStats.css">`
  **Description:**

https://github.com/aframevr/aframe/pull/1701 addressed it somewhat, but compared to 0.2.0, the resolution is still degraded.

This is probably webvr-polyfill issues, but need to fix it somehow for the release.
### iOS (iPhone 6) / A-Frame 0.2.0

![img_3567](https://cloud.githubusercontent.com/assets/674727/17494244/b5823d32-5d68-11e6-8783-47898ccbcce1.PNG)
### iOS (iPhone 6) / A-Frame Master

![img_3568](https://cloud.githubusercontent.com/assets/674727/17494245/b583c062-5d68-11e6-98c4-da01bf0f31f1.PNG)
- A-Frame Version: master
- Platform/Device: iOS
 This is a polyfill problem. The polyfill decides what size the canvas is going to have based on a data base of devices. The size is returned via `getEyeParameters`. 
 Yeah, I noted it is part of the polyfill and marked `needs dependencies fixed`. Still strongly affects A-Frame. For now, we should hack the polyfill to get the behavior as it was before.
 Also the polyfill introduces distortion so the image is going to look distorted on your display when not looked through the lenses. You cannot compare both images (before and after) pixel by pixel
 I notice that the resolution values of the polyfill are also conservative. A compromise between image quality vs performance? Performance takes priority over image quality
 Yeah, but it is a serious decrease in image quality with no noticeable performance gain on our example scenes. The decrease in resolution doesn't seem worth the distortion when testing side-by-side.
 You also have an iphone 6. 
 We've been recommending latest smartphones for Cardboard (last two generations). That would be minimum iPhone 6.
 I would change the title of this bug and remove artifacts. What you call artifacts are the effects of the distortion. You can't compare both images pixel by pixel.
 @ngokevin and @dmarcos . perhaps aframe should enable us to set which camera effect is used when in vr mode. Since I have feeling that `THREE.VREffect` with distortion can't bring the comparable quality in detail as `THREE.StereoCamera` did in 0.2.0.

Something like 
`<a-scene vr-effect="default">`
`<a-scene vr-effect="stereo">`
if that makes sense.
 We did not use `THREE.StereoCamera` in 0.2.0. The distortion is not done by `THREE.VREffect` is done natively by the browser or by the polyfill. 
 @dmarcos hm some reason I false idea that 0.2.0 used stereo camera by how that looked and prop stereoRenderer but now checking it's clear. 

> with distortion can't bring the comparable quality in detail as THREE.StereoCamera

translates to then that the distortion made by polyfill to render HQ requires more memory than most mobile browser allow per tab
 Flat desktop also has low resolution, the buffer scale patch fixes it for some reason...
 Never mind, separate issues.
 Yes that is known issue at this point that resolution of VR effect on any mobile is quite low
Related #1873, However using stereo view like in A-Frame 0.2.0 (2 squares ) would make affect experience on Gear VR and Cardboard 
 https://github.com/aframevr/aframe/issues/2008
  Thanks!
  It's a limitation of mobile browsers, not A-Frame

http://stackoverflow.com/questions/38380912/why-is-my-video-or-videosphere-not-playing-on-mobile-in-a-frame-vr/38380941#38380941
  Issues are for bugs and feature requests. Please use stackoverflow for usage questions
  For anyone looking, the code is in `src/components/wasd-controls.js`
 Some time within the last twelve days of bumping the dist, this has been fixed.

I tried a couple examples in CodePen using the latest master that I generated locally, WASD works again.
 Weird
 @bryik lemme know if this works for you https://github.com/aframevr/aframe/pull/1797
 Re-working on it, another test shows it didn't work. So flaky :0
 OK here's one where I remove `event.preventDefault()` in look controls canvas mousedown https://codepen.io/ngokevin/pen/AXNZwV
  Would you be okay adding tests for setting a target, updating a target, removing a target, updating angle?

`tests/components/light.test.js`
 I added a README https://github.com/aframevr/aframe/tree/master/tests#a-frame-unit-tests
  wall lights, the little 20ms markers seem off
 wall lights

<img width="1062" alt="screen shot 2016-08-05 at 12 29 39 pm" src="https://cloud.githubusercontent.com/assets/674727/17448273/4e73b3bc-5b08-11e6-9516-db26a22d24dc.png">
 @caseyyee can you make these changes when you get a chance?
  This fixes the error of `parentEl === null`  seen on console in some of the demo like anime-ui.

This removes also what I believe is unnecessary sceneEl specific code since the same logic (updating components) is run for every entity (scene is just another entity).
 The naming is for consistency.
 I think I got equivalent and simpler code. I added a test to cover for https://github.com/aframevr/aframe/issues/1383

Now all entities wait for all the children nodes to load so we don't need specific logic for the scene anymore.

The animations check for the parent to have loaded before playing. If the node is not loaded then they postpone the start of the animation
 r+wc
  thanks
  Nice Thanks!
  Nice thanks! Good catch
  **Description:**

Since we removed the modal and switched it to a fullscreen icon, there is no indication that the scene is VR-capable. Imagine the case where someone Tweets an A-Frame scene, and someone who opens up the scene on desktop does not know much about WebVR. The fullscreen icon alone makes it look like a plain 3D experience.

The primary solution I can think of is to re-introduce the modal that linked people to the Mozilla VR website. As most WebVR scenes today are built with A-Frame, this Enter VR CTA is important to introduce users to WebVR and how to consume it. We can add a referrer to the link so we can gain metrics whether people are engaging with it, but we can't assume it's not helpful yet.

Another solution would be an icon that conveys both that a headset is not connected, but fullscreen can still be entered. When a headset _is_ connected, then the icon changes to just the Goggles.
 @dmarcos said he will revert the fullscreen icon.
 @ngokevin does #1712 close this?
 Yes, solved! I still have some reservations behind removing the modal since it trades off user experience for reduced maintenance and less code. Perhaps that can be a separate component.
  Thanks!
  Thanks!
  Good catch. The call should be removed from `init()`. And IMO, the addEventListeners/removeEventListeners methods should be removed and put into `play()`/`pause()` directly because it implies they're used somewhere else. And yeah, it should be `pause()`.
  Nice! Thanks!
  @liuwaichung can you ask this via SO http://stackoverflow.com/questions/ask/?tags=aframe
 Issues are for `bugs` and `feature` requests.
  @FrederickDesimpel yeah! Congratulations! I let @ngokevin check this out
  Safari Mobile requires user action to play a sound.
  Try playing with the `theta-length`. `<a-sky theta-length="180">`
 Can you ask on http://stackoverflow.com/questions/tagged/aframe with more details for help? Thanks!
  Yes. I think we should get rid of Array.from. We can open a different PR to remove the one introduced by #1642
  A-Frame's style guide is a combination of https://github.com/Flet/semistandard and @dmarcos preferences (one if which is early returns and flattened logic blocks). So some things might be weird, but style guide is mostly set in stone.
 No problem, takes getting used to :)
  This issue needs more information. And this question would probably be better on StackOverflow.
  **Description:**

I cannot get audio to play on iOS, both on Safari and Chrome.

What I tried:
- `autoplay` directly on the component. #1463 made me think right away that this wouldn't work. But #1463 description implies that it wouldn't work for Chrome for Android, but it **does** work for me.
- using `entity.components.sound.play()`, both with a setTimeout and with user events.

Both approaches worked properly in Chrome for Android and desktop browsers (Chrome, Safari and Firefox). In Firefox for Android, my app crashes even before I could try the audio, but that is just information, I'm not focusing on Firefox.

I inspected the iOS Safari console and network tabs with remote debug and there wasn't any error or something.

Also, as a side note, I tried the [a-wakens demo](http://ngokevin.github.io/a-wakens/), and it worked on: 
- Chrome, Safari and Firefox (desktop), Firefox (Android)

but didn't work on:
- Chrome (Android), Safari and Chrome (iOS)

So, I'm pretty much clueless about how to get audio to play on iOS and would appreciate some tips.
- A-Frame Version: 0.2.0
- Platform/Device: iOS 9.3.2, iPhone 6, both Safari and Chrome 51
 Hi, I moved to http://stackoverflow.com/questions/38645716/cant-play-sound-on-ios because I think this is a question and a matter of figuring out how to use WebAudio on mobile, rather than A-Frame issue.
 Thanks @ngokevin 
  This bug has been [fixed](https://github.com/aframevr/aframe/blob/master/src/systems/tracked-controls.js#L20)

 You just have to bump the dist `npm run dist` 
  @michael829 In standard Geometry objects, an array of THREE.Vector3 elements are in `geometry.vertices`. In BufferGeometry, which A-Frame uses, the vertices are still available but flattened out:

```
var vertices = geometry.attributes.position.array;

/*
[
  x1, y1, z1,
  x2, y2, z2,
  x3, y3, z3,
  ...
]
*/
```

If you need THREE.Vector3 instances, you'd need to re-create them from that array. If you're just hoping to align things to the edges of the shape, also check out [geometry.computeBoundingbox()](http://threejs.org/docs/index.html?q=geometry#Reference/Core/Geometry), which is faster.
  ‚Ä¶low on windows

@cvan @ngokevin I don't know if this is the most elegant way to deal with this but it's 100x faster on Windows :). I should have done this a looooong time ago. I was suffering in silence.
 @cvan I need your input on this
 yippie, I'm glad this is faster - testing‚Ä¶
 @cvan How does this look like?
 sorry, forgot about this PR - besides the comment above, looks good. it's quite fast.
 r+wc fast and üëç 
 Yes yes yes! :)
 can you add "#1277" to the commit message?
 r+wc
 @cvan As far as I understand `browserSync` just monitors the build file to reload the browser. `Watchify` observes the `src` files to regenerate the build. Any suggestion on how both should be combined?
 @cvan As far as I understand `browserSync` just monitors the build file to reload the browser. `Watchify` observes the `src` files to regenerate the build. Any suggestion on how both should be combined?

that's correct. if you're going to use `watchify`, you'll need to watch `{src,vendor}/**` to know when to rebuild `src/index.js` -> `build/aframe.js` and then `browser-sync` needs to watch `{build/aframe.js,examples/**}` to know when to refresh the JS bundle or the HTML page.

I spent some time trying to get it all to work without `watchify`. I have a patch, but it's not all working correctly:

``` diff
diff --git a/package.json b/package.json
index bf10f65..af63cc5 100644
--- a/package.json
+++ b/package.json
@@ -7,8 +7,8 @@
   "scripts": {
     "build": "mkdirp build/ && npm run browserify -- --debug -o build/aframe.js",
     "browserify": "browserify src/index.js -s 'AFRAME' -p browserify-derequire",
-    "browsersync" : "browser-sync start --config ./scripts/browserify-config.js",
-    "dev": "npm run watchify | npm run browsersync",
+    "browsersync" : "node ./scripts/browserify-config.js",
+    "dev": "npm run browsersync",
     "dist": "mkdirp dist/ && npm run browserify -s -- --debug | exorcist dist/aframe.js.map > dist/aframe.js && uglifyjs dist/aframe.js -c warnings=false -m -o dist/aframe.min.js",
     "gh-pages": "npm run ghpages",
     "ghpages": "node ./scripts/gh-pages",
@@ -22,7 +22,6 @@
     "test:firefox": "karma start ./tests/karma.conf.js --browsers firefox_latest",
     "test:chrome": "karma start ./tests/karma.conf.js --browsers Chrome",
     "test:ci": "TEST_ENV=ci karma start ./tests/karma.conf.js --single-run --browsers firefox_latest",
-    "watchify": "watchify src/index.js -o build/aframe.js",
     "version": "npm run dist"
   },
   "repository": "aframevr/aframe",
diff --git a/scripts/browserify-config.js b/scripts/browserify-config.js
index fb4dd2f..10d15dd 100644
--- a/scripts/browserify-config.js
+++ b/scripts/browserify-config.js
@@ -14,15 +14,22 @@

 var urllib = require('url');
 var urlParse = urllib.parse;
+
 function isEnabled (val) {
   val = val || '';
   return val !== '' && val !== '0' && val !== 'false' && val !== 'off';
 }

-function getEnvVar (name, defaultVal) {
+function getBoolEnvVar (name, defaultVal) {
   return name in process.env ? isEnabled(name) : defaultVal;
 }

+function getIntEnvVar (name, defaultVal) {
+  return name in process.env ? process.env[name] : defaultVal;
+}
+
+var bs = require('browser-sync').create();
+
 var opts = {
   server: {baseDir: './'},
   middleware: [
@@ -37,12 +44,34 @@ var opts = {
     }
   ],
   rewriteRules: [],
-  files: ['build/aframe.js'],
-  watchOptions: {ignoreInitial: true},
-  open: getEnvVar('BS_OPEN', false),
-  notify: getEnvVar('BS_NOTIFY', false),
-  tunnel: getEnvVar('BS_TUNNEL', false),
-  minify: getEnvVar('BS_MINIFY', false)
+  files: [
+    'examples/**',
+    {
+      match: ['src/**', 'vendor/**'],
+      fn: function (event, file) {
+        console.log('matched', event, file);
+        if (event === 'change') {
+
+          var browserify = require('browserify');
+          var b = browserify();
+          b.add('./src/index.js');
+          var fs = require('fs');
+          b.bundle().pipe(fs.createWriteStream('build/aframe.js'));
+          browsersync.reload('build/aframe.js');
+
+        }
+        /** Custom event handler **/
+        // console.log(event, file);
+      }
+    }
+  ],
+  // files: ['build/aframe.js', 'examples/*.html'],
+  // watchOptions: {ignoreInitial: true},
+  port: getIntEnvVar('PORT', 9000),
+  open: getBoolEnvVar('BS_OPEN', false),
+  notify: getBoolEnvVar('BS_NOTIFY', false),
+  tunnel: getBoolEnvVar('BS_TUNNEL', false),
+  minify: getBoolEnvVar('BS_MINIFY', false)
 };

-module.exports = opts;
+bs.init(opts);
```

I can try to keep digging into it. but if you want to keep `watchify`, we just have to make sure the reloading works correctly. because currently it doesn't, at least for me on Mac.

Even [`budo`](https://github.com/mattdesl/budo/blob/c4aa94428/package.json#L39) uses a [custom middleware for `connect` (the dev web server)](https://github.com/mattdesl/watchify-middleware`).

I tried seeing if anyone else has tried to combine `browserify` and `browser-sync`. They have with `gulp`, but I don't think it's worth adding yet another build tool.

My patch is nearly close to getting it to work, but it might be slower than just using `browser-sync` + `watchify`. What are your thoughts? IMO, let's do whichever's easiest (without adding Gulp though).
 in addition to changing the commit message, can we fix the typo of "reliable" ("relialable")?
 I have a _hunch_ that budo was unreliable and slow because of the connect server and middleware. Want to try switching out the [`connect`](https://github.com/senchalabs/connect) middleware ([`connect-pushstate`](https://github.com/brentertz/connect-pushstate)) for a BrowserSync one? Here's [some sample code](https://github.com/mattdesl/budo/issues/140#issuecomment-193360011) from a `budo` issue.

[`budo`](https://github.com/mattdesl/budo/) is powerful, designed specifically for browserify, is actively maintained by the community, and @mattdesl updates it very frequently. If BrowserSync makes Budo more reliable, I'd suggest trying that first. And, if that's the case for you, Diego, on Windows, let's file an issue for @mattdesl to consider making the same change.
 > This is the first I've heard of budo being slow, I think as with most code it's just a matter of benchmarking to determine the culprit. Can you provide more details about what is slow? Maybe a test repo I can try on Windows?

I think it happened when the `ecstatic` server was replaced by `connect`. I develop primarily on Mac OS X, and only test my scenes on Windows (and Chromebooks).

For other projects, I have resorted to using BrowserSync instead of `budo` for mainly these reasons:
1. a plethora of options (though I see you have an `--ssl` flag in `budo 0.9.0`, which is awesome.
2. out-of-the-box support for https://localtunnel.me/.
3. the main reason: the WebSocket hanging issues  I've had a lot of budo-specific issues with multiple HTML pages open and directories [i.e., any HTML file whose url is not `'/index.html'`] - I've filed issues for all those in the past. I don't think others could reproduce my issues. (FYI: I'm referring to budo/issues#79 and mattdesl#80 mostly, which I cannot tell whether they are fixed or not because they are intermittent but common enough to be a problem/nuisance.)

The HTTP server alone feels significantly faster. The headers are the mostly the same, and neither is sending gzip'd responses. So, I'm not sure what is accounting for the "hangs" (or "drops"?) @dmarcos is experiencing on Windows. All I can attest to lately is that `browser-sync` _feels_ much faster than `budo`.

`budo` is so easy to drop in a Browserify project and get going. I'd rather we not switch dev servers - or worse, go the Webpack route üòè 
 @mattdesl: thanks for chiming in here. Since budo was using connect, I was having some problems with the speed (not sure if it was tiny-lr hanging or what). For other projects, I tried BrowserSync (which is just express under the hood, with a nice plugin system).

I saw your new branch and am actively using it for development of another project. Nice work on the perf improvements - definitely faster than any other watcher with a build step.

I haven't filed an issue because I'm trying to find reliable STR, but every so often when I make file changes, the server will die on me on some socket error. I'll capture it next time I see it.

Having multiple pages open with multiple browsers open, watching files *added*, etc. - those seem to be the factors I've noticed when I have to restart budo to pick up my changes.

I have a few related budo questions for you. Would be easier to chat over Slack or Twitter DM. When you have some time, hmu. Thanks!

P.S. I'll make a PR to A-Frame using the latest budo once this has all been figured out. @dmarcos Do you still have issues with Budo? I haven't run into much issues. I haven't had many issues. If we wanted to simplify the workflow and since most component authors are using webpack, we could switch to webpack 2. As complicated as I think webpack's config system is, version 2 supports a local dev server and easy prod building out of the box. @ngokevin: does webpack provide the nice error logging and https support that bud≈ç does? Yeah, pretty sure it does, given the huge ecosystem behind it. The workflow won't be simplified that much, you still run a dev server that rewrites paths to an in-memory build and you still have a build step to pack, just as we do now.

The benefits are smaller build size (someone reported shaved 100KB in one of the issues) and **simpler** config. If you see our current Browserify steps, they're a bit complicated to modify, and really hard to add additional steps like license-prepend or autoprefixer especially without messing source maps. But not high priority given other work. I have not seen much problems lately with budo. Let me spend a bit more time with it and I'll close this if it's not relevant anymore.  I think we can close? I haven't seen any issues with budo. I think can close  It looks good. The only concern is some problems we had in the past that might not be issues anymore. When using HTML templates the isScene might not be available (because the custom element is not yet initialized) while you can still check for a tagName. @ngokevin @cvan Do you have any use case in mind where these changes could break things?
 Don't think there will be much side effects. HTML templates are no longer used. And the changes here look like `isScene` will be available.
  maybe because we use spaces and not hard tabs?
  Thanks! It looks good. I want to make a round of test to all the examples before merging this.
 @mkungla this needs rebase
 @dmarcos just rebased.
 Thanks!
  If it helps, A-Frame is just a three.js framework and what it does is copies the values on pos/rot/scale onto the `THREE.Object3D`.

There is an `.applyMatrix()` method on that object, though that's internal. You could write a higher-order component that takes a transform matrix and sets appropriate value on the position/rotation/scale components. 
 There could be a `matrix` component that internally decomposes to rotation, position and scale but not sure it should be part of the core.
 Yeah, I would just apply the matrix to the Object3D. Networked-aframe should not assume transforms are only updated thru transforms and provide some sort of detection such as dirty flags or wrapping of object3d methods Only updated thru aframe setattribute*  Yeah, perhaps in the best practices guide.
 Would not be Stack Overflow a good place for those questions? If we maintain such a wiki it would be upto us to keep it up to date, review and curate all the PRs. Stack overflow is more decentralized and more easily searchable through google
 Don't think there's much to do here. A-Frame is focused on WebVR, which will be responsible for normalizing all the devices. At least, we won't be maintaining and documenting cases across versions of mobile browsers and smartphones.  thanks!
  Hi,

You can write a component that wraps the DDSLoader (https://github.com/mrdoob/three.js/blob/master/examples/js/loaders/DDSLoader.js).

https://aframe.io/docs/core/component.html
 We aim to keep the first-party list of components to must-haves. Since we can't maintain every possible feature out there. This lets other people be module owners of components. In the next version, we will lazy-load curated components so they will seem first-party. (call them second-party).
  It seems that is a problem of your specific device and the DeviceMotion API right? The examples in the website have not changed in the last month
 @dmarcos this can be closed. Just tested again with same device and this is fixed in master.
 @mkungla thanks for checking. @michael829 please reopen if this is still a problem
  looks good to me
 @darkwing thanks!
  **Description:**

Embedded A-Frame scenes (iframe) within Twitter if the `twitter:player` metatag is set. See if we can inject that metatag with info from window.location.

https://twitter.com/guri_vr/status/751870382219599872
- A-Frame Version:
- Platform/Device:
 Yeah. If it should be configurable/toggleable, it should be a component. 
 Cool. I think this doesn't have to be a component/system. It can just be a module that is always run when the scene attaches. I would also check whether Twitter player metatags already exist before creating them.
 I think this isn't possible because Twitter will fetch statically.  Thanks!

Also check out https://github.com/ngokevin/aframe-animation-component, I will be repping this implementation from now on.
  Nice! Thanks!
  Thanks! We removed those examples, forgot those links.
  Thanks!
  @FrederickDesimpel What's would a regular cursor component be?
 Could be with the mouse: https://github.com/mayognaise/aframe-mouse-cursor-component/
 Reticle makes sense, though it would be a lot of work for everyone to rename. Perhaps we can do this when we start extracting out prescriptive components and we can have both names work for a while.
 I think it would be too much effort to rename. For consolation, `reticle` is an uncommon word, and `gaze cursor` is somewhat a common term nowadays.  https://github.com/aframevr/aframe/commit/bd1bdd8159e0f947bdebc01d66d5e12361733960
  **Description:**

I'm trying to use assets management for preloading (or prefetching, I don't really know the difference) some audios before they are actually needed.

When I put a tag in `<a-assets>` like:

```
<audio id="sound-hall" src="./assets/sound/hall.mp3"></audio>
```

my browser makes a request and downloads the full audio. But, strangely, it finishes with HTTP status **206 Partial Content** (even though it has downloaded the full file, as I can check in the Content-Range header):

![image](https://cloud.githubusercontent.com/assets/4842605/16847846/5fe05f7e-49c9-11e6-8736-99a06e1f7508.png)

But when I actually want to use the audio, I need to place the URL to the audio again in the `src` for the `sound` component:

```
src: ./assets/sound/hall.mp3; autoplay: true
```

When this happens, a new request is made, and downloads the whole file again (no caching), with the same size, but this time with status **200 OK**:

![image](https://cloud.githubusercontent.com/assets/4842605/16847926/bb703512-49c9-11e6-90e7-8dd34f7ce056.png)

So my question is how to get this working for real? I would like to make a single request, that should end with a 200, or at least that the next requests end with status 304.

As a side question, one thing bothers me: when I use assets management for images, I can refer to the asset via its `id` attribute. Why when using `audio` should I refer to them via `src` attribute? At least this is what the docs show in the [example](https://aframe.io/docs/0.2.0/components/sound.html):

```
<a-scene>
  <a-assets>
    <audio id="river" src="river.mp3">
  </a-assets>
  <a-entity sound="src: river.mp3"></a-entity>
</a-scene>
```
- A-Frame Version: 0.2.0
- Platform/Device: any
 Thanks for filing. This is sort of currently being addressed in https://github.com/aframevr/aframe/pull/1629 where we can refer to an `audio` tag by ID, but need to see if we can make THREE.AudioLoader accept audio tag contents.
 Thanks, I'll stay tuned.
 After talking with @mkungla, we have to:
- Detect if `src` is an `<audio>` or path.
  - If `<audio>` then don't use the Loader, and create context manually and get buffer.
  - If path, then use AudioLoader to fetch.
- Modify or fork the `src` type so that it preserves whether the data is media element or raw path. Right now, it always returns a string/path.
 @mkungla nice! Will try ASAP. Closing.
 Is not working exactly how I expected, actually:

![image](https://cloud.githubusercontent.com/assets/4842605/17178539/3e4c6eb6-53ec-11e6-8b7d-fdcbbe57422f.png)

I'm dealing the same way with images and audios, but they seem to be handled differently by the assets management. For instance, the image `sl-hall.jpg`, it only appears once in my network tab, with a 200, but the corresponding sound, `sl-hall.mp3`, seems to make a request every time I go to the same room. The first one with 206, and subsequent with 200 but with `(from cache)` in the Size column.

This is basically the same situation that led me to open the issue initially, the difference here is that in my sound component now I'm referencing the src by id, not by the url anymore.
 Thanks @mkungla , your explanation gave me a better understanding of the underlying problem.
  Thanks for the work. I do feel workflow instructions are important. Though for the purpose of endorsing just one, I feel these instructions might be:
- Prescriptive (must use Git, GitHub, Node, Atom)
- Challenging (introduces a ton of new technologies into the stack)
- Out-of-scope (tutorial for getting started with web development tools in a section about getting started with A-Frame)

However, I feel like this might be a great blog post material if there're more screenshots and elaboration. And then we can also put your face on it. Something along the lines of "Workflow for Web Development Beginners".
 Going to think about this a bit more, actually. Still on the fence. It might not be prescriptive since we should recommend Git, GitHub, Node, and I re-read and saw you didn't actually enforce a text editor. If the section is small and contained enough, it might be useful.
 Thought about it more. I don't think we should recommend this workflow for total beginners. GitHub + Node + CLI is too much. This would make a good blog post for easing people into web development. For the next version of the A-Frame though, we will be featuring different workflows for different types of creators.
 The homepage we will have something that acts like a playground for beginners. There's also Codepen, and workflows like MagicaVoxel.
 Will close for now, but will loop you in homepage posts.

I recommend publishing this workflow online somewhere for now though for those that need it! (like Medium)
  Thanks, PR is open
 PR welcome!
 Also look into using text shadows
 Thanks for playing with it! Seems like we still have room to decrease the shadow a bit and still be readable?
 Looks better :)
 Great! We can copy and paste the new rStats into A-Frame. And add a class to style it in `src/style/rStats.css` using `.rs-counter-base.alarm`
 thanks!
  Yeah, can you update the examples and docs as well? Thanks!
  Yes, should be up :)
 Fixed thanks!
  thanks!
  **Description:**

**The scenario**:

I'm developing a "virtual tour" application with a-frame. The core of my app is basically a `<a-scene>` with `<a-assets>`, a single `<a-sky>` and some (1 to 3, depending the situation) `<a-image>` used for navigation purposes. On every navigation I just change the sky `src` attribute with the id of another asset.

I'm using React to organize my scene in components: one for the scene itself (together with assets and camera), a child component for the room (with the sky and the nav elements) and a nav component.

For the assets, for each room, I put in `<a-assets>` the image for that particular room, and the image for all the possible rooms that can be reached from that one (to prefetch them). Since I'm using React to help me here, I keep an array of all the assets that were already put in `<a-assets>`, and I only add to it the ones that never were loaded. So I start with, say, 5 assets (nav images, current room sky, next room sky), and as I navigate, more assets are put in `<a-assets>`, but the ones that are already there are never touched. So, at the end of the tour, I might have about 15-20 assets in `<a-assets>`.

I have around 15 different "rooms" (so 15 sky images). The sky images range from 500kb to 2mb. My nav images are always with the same src, and it is a small png image (less than 100KB).

Each sky image is only being loaded once and not making any more requests (100% sure, checked on browser and on server), but my navigation image gets loaded once and then on every navigation it makes the request again, but with 304 status. Could not find a way to overcome this, but it shouldn't be a big problem.

The components are behaving well, so I'm not having several renderings of my react components for each transition or something like that.

**The problem**:

I have a major performance problem testing the app in my Android phone (Motorola Moto X, 2nd generation, 2GB of RAM) with Chrome. After around 10-20 transitions between rooms (in some rooms I don't have an option besides going back to the previous room), the transitions begin to get slower and slower, to the point where I focus to my nav element and my phone freezes, so I need to restart it. I tried Firefox on my phone but the Firefox will crash every time a few seconds after loading the app. Firefox even crashes with the oficial [hello world demo](https://aframe.io/examples/showcase/helloworld/), so I don't think that this is my problem exclusively.

In my computer (MacBook Air, 4GB of RAM, i5 CPU), I can run my app with much more stuff on it and everything runs fine. I've added [gifs](https://github.com/mayognaise/aframe-gif-shader) in my navigations, [text](https://github.com/ngokevin/aframe-text-component), audio (a different audio for each room) and [mouse-cursor](https://github.com/mayognaise/aframe-mouse-cursor-component) and I had no problem running my app. Although, when I navigate about 20 times between rooms, the RAM consumption gets bigger than 500MB with all this stuff, and 200MB-300MB without it (as simple as when I get the crash on mobile).

**Conclusion**:

It would be really nice to receive some suggestions about what I might be doing wrong. I can show some code if my description is not enough and if you think that would be helpful, but I think my description was pretty complete.
- A-Frame Version: 0.2.0
- Platform/Device: critical on mobile (Chrome 51.0.2704.81, Firefox 47.0), bad in desktop (Chrome 51.0.2704.103)
 I just found this app: https://aframe.io/blog/syria/
I'll try to figure out what they are doing, because they don't seem to have the performance problems that I described, even though my app is simpler than that.
 Edit: removed all the links since the repo is private now

@JohnRodney hey there, thanks for the input.

I just made my repo public so you can take a look: [edited]

The component that creates the sky and changes the src is this one: [edited]

You might get confused with some "state" and "properties" that you might see in the code. Besides React (that uses "state" and "props" nomenclature), I'm using a state-machine called Macchina that I've built some time ago, where I also used "state" and "properties" but with a completely different meaning. It needs refactor, but it helps me to keep the mapping of the rooms properties simple (see this file: [edited]).

The current state of the repo is with almost everything stripped out (sound, gifs, text) to try to spot the perfomance leak.

I will try now your suggestion. Thanks!
 Forgot to mention, to play with the app you should just run:

```
npm install
npm start
```
 @JohnRodney (or should I say Daryl from TWD?), you suggestion DID work. I cannot thank you enough, man!

On the other hand, this seems to me a very random solution. I would like to have a better understanding on why this works.

The downside is that since all my `<a-sky>` are in the DOM when the React app is mounted, I need all my assets in the DOM also, so my prefetch now has become pointless.

But I'll try another approach: put my `<a-sky>` as needed, and once they are in the DOM, never remove them. This way I can use the assets lazy-load/prefetch.
 So @JohnRodney , my current solution is: I put a `<a-sky>` in the DOM for each visited room. If I am in that room, then the entity holding the sky is visible, otherwise, not. Keeping one `<a-sky>` for each src, and never changing the source was the solution, but not putting all of them at once in the DOM was my way to delay loading all the assets.

I'm in the same situation that you was, so I'm not very happy either, but the deadline ain't getting further. Closing because I think my issue was solved, thanks to your help.

(I'm also putting my repo as private, because it should be). 
  @FrederickDesimpel Would love if you could add a target property (type `selector`) for the light component.
 spotlight.target added, thanks!
  @FrederickDesimpel can I have the example scene that you're using in your screenshot to test it on the editor?
 fixed
  Pushing back. Considering https://github.com/aframevr/aframe/issues/2071
  Thanks!
  I think this is the issue: https://github.com/aframevr/aframe/issues/1715
  The webvr polyfill uses a device database to determine the resolution that the polyfilled version of the `getEyeParamers` will return. The `navigator.userAgent` string must contain the device model name that matches the one in the database. In the case of a nexus 5 is `Nexus 5` (https://github.com/borismus/webvr-polyfill/blob/master/src/dpdb/dpdb-cache.js#L182)
It looks it's a problem with the polyfill database or your emulator not containing the correct device model name for those devices. There's nothing that we can do on the a-frame side.
  I can confirm that your scene is broken with your A-Frame bundle. Not sure which version you are using but it's not `0.2.0`, and it's not `master` (`861c369`) - according to my `diff` checking. Try https://github.com/aframevr/aframe/blob/master/dist/aframe.js / https://cdn.rawgit.com/aframevr/aframe/master/dist/aframe.js.

When I forked your scene and used `<script src="https://cdn.rawgit.com/aframevr/aframe/master/dist/aframe.js"></script>` instead, it worked on mobile.

I wish we included a `sha`, not just the `package.json` version in the bundle.
  Should be fixed now?
 https://github.com/aframevr/aframe/commit/6be3725d548e5f071b0ec19a534d6235643ee525
  I can address at https://github.com/ngokevin/aframe-animation-component
 We've deprecated a-animation. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.

The component will not include delay in every iteration. If you want to add delay before each iteration, can control the animation with a bit of JS   r+wc
 This is ready to go but I first need @fernandojsg input first. In order to lock the version of the editor to a version of A-Frame we have to agree on the url schema. @ngokevin suggested `https://aframe.io/aframe-editor/builds/0.3.0/aframe-editor.js` where the version refers to the A-Frame version. I made the editor url a property of the component so people filling adventurous can try experimental versions
 Yep, I agree that probably will be more useful to follow the same version number for the builds to match aframe. We could use `https://aframe.io/aframe-editor/builds/0.3.0/aframe-editor.js` for the first release
 Alternatively `https://aframe.io/releases/0.3.0/aframe-editor.min.js` to match A-Frame.
 @ngokevin :+1:
 @ngokevin @fernandojsg How are we going to deal with master? If you use a-frame master it should point to the master version of the editor as well.
 Maybe we can immediately point A-Frame Master to Editor Master after we release. But A-Frame 0.3.0 should be locked to Editor 0.3.0.

Or we always point to the last release. If developers are using Master, we prescribe to configure their Editor URL. `<a-scene editor="url: mastereeditorurl">`
 @ngokevin are you going to add the release command for the editor? As you mentioned master should point to the latest release of the editor and devs can just change the url if they want bleeding edge. Before merging this It would great to have a functional URL `https://aframe.io/aframe-editor/builds/0.3.0/aframe-editor.js`
 How about I copy one to `https://aframe.io/releases/0.3.0/aframe-editor.min.js`?
 Yes we can copy it manually for now.
 Remember to `s/editor/inspector`
 Let's push a build to `https://aframe.io/releases/0.3.0/aframe-inspector.min.js` so I can point this PR to it.
 `ctrl + alt + i/e` loads the editor and immediately jumps into it the first time.

When I exit, and press `ctrl + alt + i/e` again, I expected it to open the Editor again, just like the Browser DOM Inspector you can toggle on/off with the same shortcut.
 In Windows the shortcut for the inspector is `ctrl+shift+i` . `windows key + alt + e` opens the browser menu in chrome.
 @fernandojsg how can I programmatically exit the editor so I can close/open it with the shortcut? Maybe the shortcut should be handled by the editor instead of aframe. What do you think?
 @dmarcos once the editor is injected you can use `editor.enable()` and `editor.disable()` (I just realised that I should change also s/editor/inspector there :)
I could include the shortcut in the inspector to toggle it, but to inject the first time should be done outside the editor, how to handle this two entry points?
 Just a nitpick, could be `editor.open()/editor.close()` or `editor.enter()/enter.exit()`.
 @ngokevin yep, just after writing that, I was thinking how bad naming these functions have. I'll change them for `open/close`
 r+wc
 One question regarding this shortcut. If you press `ctrl+alt+i` to inject the `inspector` and open it, should I add also the same shortcut once injected to toggle the inspector right? (Even if after that we could create a easier shortcut like `Esc` or whatever for doing the same)
 Yeah, would be nice to toggle like the Chrome Devtools.
 I think we're using alt instead of shift.
 > I think we're using alt instead of shift.

nice, ok - can we update the docs?
 I suggest to not do reviews if the label `needs review` is not present. This PR only went through a rebase cycle. There are a bunch of changes coming soon and we will have to do the work again.
 r+

can do later:
- unit tests
- bump package.json
- test with most recent inspector build that ctrl/alt/i can toggle inspector open and closed
 restarted the build
 just marked `needs changes` for the typo in the `remove` method
 Just changed to `AFRAME.INSPECTOR` https://github.com/aframevr/aframe-inspector/commit/50eaa732febc6b989338e81d94cb3b9b4e07d543
  **Description:**

Earlier, I changed `click` to `cursor-click` for the cursor component to know where the event comes from.

But if we want to support multiple interaction mechanisms (mouse, gaze, controller), should we come up with standard event names such that developers only have to listen to one event (`click` vs. `cursor-click` + `trigger`)? Right now, we have "mousedown" even though you might not be using a mouse, should we keep those old names?

Example names:
- `cursor-click`, `trigger` -> `click`
- `cursor-mouseenter` -> `hoverenter`
- `cursor-mouseleave` -> `hoverleave`
- `cursor-mousedown` -> `clickdown`
- `cursor-mouseup` -> `clickup`
 yes, please standard event names. Those `cursor-*` have been bothering me.
 What should we name them, should they interoperate with controller event names?
  @dmarcos r? This will make the archives only have `dist/` + LICENSE + README. I'm mostly okay with it.
 I don't remember having ever used those archives on any of my projects. What's is the expectation when downloading one? Having a snapshot of the whole repo or just the library dist files?
 So after some talking, it seems that while it is nice to have it slightly cleaner, the expectation is that it should serve as a snapshot of the repository. It's a bit more flexible to leave those files in, and follow what other big projects do.
 @mkungla Do you use any project that follows that pattern? Using the archives to only package up the dist files
  [React for example](https://github.com/facebook/react/releases) offers two kinds of downloads in the release (they're even represented with different icons)
1. A zip file with the dist files
2. A zip with the archive of the repo

The purpose of git archiving is to actually snapshot the directory tree of a repo:
https://git-scm.com/docs/git-archive

@mkungla I don't know how the `.zip` with the dist files is generated but React is not using `.gitattributes` (https://github.com/facebook/react/blob/master/.gitattributes). Can we change this PR to let the archiving be the whole repo snapshot and generate another zip with the dist files like React does?
 FWIW, here are my current thoughts:

It seems more flexible and less contentious to have it serve both purpose of release and snapshot. Downloading the `.zip` will still give you access to the `dist/` files, it shouldn't be too obstructing to also have other files in the archive.

I agree that most people that would want the other files would just clone it. And it would make it cleaner to exclude those files, but it's a marginal benefit.

You mentioned that we might want a `.gitattributes` for other purposes. The one you posted, is all that does is just add EOF newlines? Just not sure we want to maintain another file unless it's really useful.
  Try setting on a wrapper entity.

``` html
<a-entity rotation="SET THIS"><a-camera></a-camera></a-entity>
```
  @msj121 Would you might updating this patch? Thanks!
 https://github.com/aframevr/aframe/commit/1a7888ad389065ffd839915e48d9c5a3c2f4287d
https://github.com/aframevr/aframe/commit/e67974d42a7a25002d169a2e50a7fbfef929a7a7
  Add support for tracked controls. It introduces three levels of abstraction: 
**`tracked-controls`** that is limb/vendor agnostic. It just applies the pose and emits events on the entity. it's applicable to any future tracked objects: feet, scene elements... 
**`vive-controls`** that is specific to the vive controller and makes the proper button mapping: trackpad, trigger, menu, grip
**`hand-controls`** that applies a hand model and maps button events to higher level of abstraction events like `grip` or `point`
 @donmccurdy Oculus Touch and Daydream will be supported through `tracked-controls` that provide the lowest common denominator: pose and button events
 I have a new version of the patch that filters out all the controllers besides those with the id "OpenVR Gamepad" We should maybe discriminate those that don't have a pose but I don't know if that's reliable. I'll push the update later in the day.
 This puppy is ready to go. @ngokevin 
 OK, will give a final sweep today once I finish up some stuff. Thanks for waiting.
 @ngokevin One last decision it has to be made is to include or not `hand-controls`, `vive-controls` and `blend-model` (that carries an extra THREE module) as part of the standard build. It's quite a bit of code for a feature that won't be used much right now (but pretty important in the long term)
 I was in favor of including everything, and then extracting them out later once we have the component consumption system down. I think this feature is important enough to be batteries included.
 I'm going to addd the componets to the core and documentation for them
 I made the relevant component part of the core so you can get hand controls out of the box.
 r+wc
 I also added docs for the components.
 OK thanks, i can clean those up when i sweep the docs again before release 
 It would be worth to add an example that uses the vive-controls. We can do that in a separate PR.
  It seems Ricoh knows how to orient the image based on EXIF data for horizon correction. You can adjust the rotation of the skysphere `rotation="0 0 30"` or something
  I suggest that you move to master that wil be 0.3.0 soon (1-2 weeks) We prefer to focus on getting 0.3.0 rather on a 0.2.1
 Yeah, would be less overhead to go straight to 0.3.0. `master` is available in the meantime.
  Good idea, could you add one for us?
  It's intentional. Letting the user move up and down on mobile becomes disorienting quickly in combination with the phone sensors. It also makes the scene unusable in a headset because the vertical axis won't match the real orientation of user's head.
  **Description:**
Creates a showcase to illustrate link traversal, characteristic of the WebVR 1.0 spec. A hover and click effects for the links are still pending.

@cvan I know you have opinions on how pages should handle link traversal while remaining in VR. Let's discus and incorporate those ideas into this PR.

This is a link to the demo if you want to quickly try it out:
http://swimminglessonsformodernlife.com/aframe/examples/showcase/link-traversal/
 can you rebase?
 Tests pending Alright, Nightly enters for me now. Camera had a low height for a bit until I restarted. But I experienced that the enter VR wasn't kicking in after navigation, and the portals are too large/far away (I can't walk up to them, and or poke my head thru because they look huge) In link-controls.js

`if (previousSelectedLinkEl || selectedLinkEl.components.link === undefined) { return; }`

This threw an error for me `selectedLinkEl` is not yet set.

```
link-controls.js:302 Uncaught TypeError: Cannot read property 'components' of undefined
    at i.onMouseEnter (http://localhost:9005/js/link-controls.js:302:49)
    at Object.module.exports.fireEvent (http://localhost:9005/js/aframe-master.min.js:450:2078)
    at http://localhost:9005/js/aframe-master.min.js:293:2801
    at Array.map (native)
    at HTMLElement.value (http://localhost:9005/js/aframe-master.min.js:293:2772)
    at i.twoWayEmit (http://localhost:9005/js/aframe-master.min.js:202:3787)
    at i.onIntersection (http://localhost:9005/js/aframe-master.min.js:202:3035)
    at HTMLElement.<anonymous> (http://localhost:9005/js/aframe-master.min.js:432:132)
    at Object.module.exports.fireEvent (http://localhost:9005/js/aframe-master.min.js:450:2078)
``` Still looking into this, but creating the links programmatically with

```js
var LINKS = [
  {href: '?env=arches', image: 'img/arches.png', title: 'Arches'},
  {href: '?env=checkboard', image: 'img/checkerboard.png', title: 'Checkerboard'},
  {href: '?env=egypt', image: 'img/egypt.png', title: 'Egypt'},
  {href: '?env=forest', image: 'img/forest.png', title: 'Forest'},
  {href: '?env=goaland', image: 'img/goaland.png', title: 'Goaland'},
  {href: '?env=goldmine', image: 'img/goldmine.png', title: 'Goldmine'},
  {href: '?env=japan', image: 'img/japan.png', title: 'Japan'},
  {href: '?env=poison', image: 'img/poison.png', title: 'Poison'},
  {href: '?env=threetowers', image: 'img/threetowers.png', title: 'Three Towers'},
  {href: '?env=tron', image: 'img/tron.png', title: 'Tron'},
  {href: '?env=yavapai', image: 'img/yavapai.png', title: 'Yavapai'},
];

AFRAME.registerComponent('generate-links', {
  init: function () {
    LINKS.forEach(link => {
      var linkEl;

      // Current page.
      if (window.location.search.indexOf(link.href.substring(1)) !== -1) { return; }

      linkEl = document.createElement('a-entity');
      linkEl.setAttribute('link', {
        href: link.href,
        src: link.image,
        title: link.title
      });
      this.el.appendChild(linkEl);
    });
  }
});
```

Gives errors like:

```
core:schema:warn Unknown property `0` for component/system `material`. 
aframe-master.min.js:21 core:schema:warn Unknown property `1` for component/system `material`. 
aframe-master.min.js:21 core:schema:warn Unknown property `2` for component/system `material`. 
aframe-master.min.js:21 core:schema:warn Unknown property `3` for component/system `material`. 

aframe-master.min.js:297 Uncaught (in promise) TypeError: Cannot use 'in' operator to search for 'strokeColor' in pano
    at i.updateCachedAttrValue (aframe-master.min.js:297)
    at i.updateProperties (aframe-master.min.js:297)
    at HTMLElement.value (aframe-master.min.js:289)
    at HTMLElement.value (aframe-master.min.js:289)
    at i.update (aframe-master.min.js:222)
    at i.updateProperties (aframe-master.min.js:297)
    at HTMLElement.value (aframe-master.min.js:289)
    at e (aframe-master.min.js:289)
    at Array.forEach (<anonymous>)
    at HTMLElement.value (aframe-master.min.js:289)
```

I debugged and found that `attrValue` at some point became a string value of `pano` rather than an object like I'd expect. material component was calling `updateCachedAttrValue('pano')` I think an issue is `el.setAttribute('material', 'pano', data.src.src);` in link.js. If I pass in a raw URL vs `<img>` from `<a-assets>`, then it sort of breaks. This has been an awkward part of the API, we should just have the link component check if it's an `<img>` or string, or hope it just works as a string.

Changed to `el.setAttribute('material', 'pano', typeof data.src === 'string' ? data.src : data.src.src);` It doesn't look like the portals are doing `look-at` on the camera Should `<a-entity link scale="0.5 0.5 1">` work?  I think the title text above the portals need double-sided materials in case you go to the other side r+ This is for VR to VR scene traversal.  The UI is componetized in the `vr-mode-ui` component:

``` html
<a-scene vr-mode-ui><a-scene>
```

You can remove it and implement your own.
  As @donmccurdy said. You should convert your FBX to a format better suited for real time applications. FBX was designed as an exchange format for design applications.
  OK, I see the problem. We weren't setting fog on MeshStandardMaterial despite documenting it.
  Does the problem reproduce in master?
 https://github.com/aframevr/aframe/commit/e4900e16ea9228af39d2a4fef6798393e79bd82a
  We're trying to call `setAttribute` before everything is initialized. Two options:
1. Use the component system to write script components (recommended to automatically hook scripts into the A-Frame system)
2. https://aframe.io/docs/0.2.0/core/scene.html#running-content-scripts-on-the-scene
  thanks!
  Pretty awesome! People have been registering custom materials, but this seems like a much simpler API.
 Should be good after changes, thanks!
 Thanks! I can squash-merge.
  This code is much cleaner that the previous attempt. @fernandojsg, What do you think?
 @wizgrav nice, thanks!
 Nice it seems mrdoob accepted the patch
 We can now copy and paste to the vendor directory
 I still didn't check the code, by now I'm trying to run the demos with a headset and on chromium they won't work as the video won't load so maybe the demo version could be something simpler using just geometry?
I've tried also to run it on Firefox nightly 50.0a1 with Oculus Rift and I just get rendered the right eye, the left eye is black. 
Has someone successfully make them work on windows with headset?
 @wizgrav I've just tried the new version and it's still painting just one eye. I'll try to debug it this afternoon!
 Now both eyes works, but it looks weird. The left eye looks at the front but the texture is stretched and the right eye looks like the camera is rotated to the left:

![20160621_131601](https://cloud.githubusercontent.com/assets/782511/16227705/97bd3e68-37b2-11e6-9f69-68ed996813b6.jpg)
![20160621_131603](https://cloud.githubusercontent.com/assets/782511/16227706/97be16d0-37b2-11e6-83f7-aac2c6f12c59.jpg)
 @wizgrav sure! just drop me a line on slack and we'll do it!
 Would still be easier to review if it was broken down further like:
1. tock (purely)
2. post-processing
3. graph-ordered execution
 @wizgrav @fernandojsg ready for review right?
 Not an example, but could use unit tests for adding/remove `tock` and that components that define `tock` have those behaviors registered on the scene.
 @ngokevin @wizgrav do you mind if I leave this review to next week as I'm quite busy right now? I'll give it a try and try to use in another context with other effects to see how it will scale
 @AnnCaryn Yes, the effects probably will be added to the https://aframe.io/aframe-registry so people could register their own posteffects and then you could easy include them in your project, they won't belong to the core, just the base functionality, as @wizgrav explained.
 @wizgrav @ngokevin is this change still something that is desired to be merged? Since this thread got bumped, the update for post-processing is there's pending work in three.js to get it to work well for VR (a camera for each eye). The `tock` looks OK, I've since merged the System update pieces. Thanks for the patience. I would like to keep the `tock` related logic and move the postprocessing logic to a different PR. Can we do that? @wizgrav A use case for example we needed this for (and we hacked temporarly) is the ability to capture an animated gif of a running scene. @wizgrav we would call `tock` in the render function the same way we call `tick`. This is what the render method would look like (renderTarget is null by default)
```javascript
render: {
      value: function () {
        var effect = this.effect;
        var camera = this.camera;
        var delta = this.clock.getDelta() * 1000;
        this.time = this.clock.elapsedTime * 1000;

        if (this.isPlaying) { this.tick(this.time, delta); }

        this.animationFrameID = effect.requestAnimationFrame(this.render);
        effect.render(this.object3D, camera, renderTarget);

        if (this.isPlaying) { this.tock(this.time, delta); }

        this.effect.submitFrame();
        window.performance.mark('render-iteration-finished');
}
```` I would not check for the `postprocessing` attribute inside `a-scene`. The postprocessing logic should be decoupled from the scene. The postprocessing component could instantiate the renderTarget for the scene and you can move the logic to the `tick` method (that happens before render) so nothing specific to postProcessing remains in the render loop. We might want to consider a separate scene component called renderTarget that instantiates the renderTarget for those components that require one. Thanks a lot for the patience. Longest running PR in aframe history. It need a rebase. Yeah! Thanks very much for sticking with it. @wizgrav one last thing. I see changes on VREffect. Are those coming from the three repo? Do we need then! Amazing! it only took a year to land this üòÑ @wizgrav It's fantastic you were able to bring it back home  I don't think animations is the proper solution. Try creating a delay-set component:

``` js
AFRAME.registerComponent('delay-set', {
  schema: {
    component: {type: 'string'},
    delay: {default: 2000},
    property: {type: 'string'}
    value: {type: 'string'}
  }

  init: function () {
    var data = this.data;
    var el = this.el

    setTimeout(function () {
      el.setAttribute(data.attribute, data.property, data.value);    
    }, data.delay);
  }
});
```

``` html
<a-sky color="#73F7DD" delay-set="component: material; property: shader; to: flat"></a-sky> 
```
 Oops, should be data.component, not data.attribute

``` js
<script>
AFRAME.registerComponent('delay-set', {
  schema: {
    component: {type: 'string'},
    delay: {default: 3000},
    property: {type: 'string'},
    value: {type: 'string'}
  },

  init: function () {
    var data = this.data;
    var el = this.el;

    setTimeout( function () {
      el.setAttribute(data.component, data.property, data.value);    
     }, data.delay);
  }
})
</script>
```
 Nice. Found out GitHub comments are not a good environment for coding :)
  What do you mean by misalignment between split screens? Anyways, I don't think VR mode is useful in a tablet form factor. There are no holders in the market that fit tablets.
  removed getComputedAttribute  I believe you fixed this, thanks!
  @msimpson That error you see means that video playback has to be initiated from a user action: A click or a tap on the screen. I don't think it's a regression on A-Frame side but a change in the policies with respect to video playback in Chrome Mobile. @lautarorb Does the problem reproduce with a Chrome Mobile older than 51.0.2704.81? I don't have an Android device I can test on.
 @timmhayes what phone do you have? Sanity check.  Does this work for you?  https://codepen.io/machenmusik/pen/gRPZqd You can fork the codepen and replace the video URL with whatever you like, as long as it is wide open for CORS Interesting.  Does the A-Frame example video work if you also specify the mime type as part of the video element, rather than only replacing the URL?  Maybe a regression in mime type detection behavior in Chrome? Can you try with the master branch?  We recently versioned our documentation and have not cherry-picked the fixes. So 0.2.0 documentation has this broken link, but master documentation, it is fixed! http://codepen.io/mozvr/

https://aframe.io/docs/master/guide/getting-started.html

I will try to start cherry-picking fixes. Thanks!
  @nikhilnayak98 Can you provide a link to an example that reproduces your problem?
  Thanks! 
  **Description:**

It's possible that you may call `scene.enterVR()` and it won't work because [`THREE.VREffect`](https://github.com/mrdoob/three.js/blob/fdca37f/examples/js/effects/VREffect.js) hasn't finished [its async logic](https://github.com/mrdoob/three.js/blob/fdca37f/examples/js/effects/VREffect.js#L49-L58).

This means that when you try to call `scene.enterVR()`, it calls `this.effect.requestPresent()`, which throws `No VR hardware found.`.

I have to actually call `navigator.getVRDisplays` myself and hope that when that resolves, `THREE.VREffect`'s `navigator.getVRDisplays` call has resolved and the `VRDisplay`(s) are detected and ready to be used.

https://github.com/aframevr/aframe/blob/f43ad9bd/src/core/scene/a-scene.js#L217
- A-Frame Version: f43ad9bd
- Platform/Device: all
 Marked help wanted to just add `rendererready` event at the end of setupRenderer.  We got working a proper solution at https://github.com/aframevr/aframe/commit/365829f688a420631e0f575c2598fe07a6abe554 which was a bit more involved and fiddly.

Thanks so much for the work though!
  Yeah. When we versioned the docs, this was the compromise, not easily being able to push small revisions. We can fix this by updating the tag with the fixes. Perhaps I will have to do a weekly manual update...
 We might have to just leave 0.2.0 like that, but 0.3.0 going forward we are cherry-picking fixes
  Something to do with pixel ratio or the WebVR polyfill.
 Was able to fix this by modifying VREffect to use `window.devicePixelRatio` instead of `1`. Not sure the implications or intentions though.
 @dmarcos was wrestling with this. I think he knows what's up. and there's some discussion in the [webvr-polyfill issues](https://github.com/borismus/webvr-polyfill/issues) too.
 I was able to fix it by changing the BUFFER_SCALE to 1 and having VREffect use the set pixel ratio. But need to compare performance.
 @mkungla has been doing some investigation and said:

> Problem with The Perspective cameras and how these are created and updated
> 
> And function fovToProjection, fovPortToProjection, fovToNDCScaleOffset do not give exact results they should always
> 
>  As I see then 0.2.0 you used `THREE.StereoCamera` instead of `THREE.VREffect`
 https://github.com/aframevr/aframe/pull/1701
 #1701 has addressed the issue. 
 Continued https://github.com/aframevr/aframe/issues/1735
  Thanks!
  Thanks!
  There is a `buffer: false` option, but preserving the original geometry data sounds harmless. Let's do it.
  good catch
  You can create a half-sphere using the sphere geometry and reducing the thetaLength/phiLength
  https://github.com/aframevr/aframe/pull/1904
  It exports properly for me following your instructions. Make sure that you don't have any strange illumination in your blender scene. Please reopen if you have any additional information

![Blender Cone](https://s3.amazonaws.com/f.cl.ly/items/2i171Q1F0F3p0X2m0B1b/Image%202016-06-24%20at%201.17.21%20PM.png)
  @tbalouet Did you put a `src` to your image? I've tried myself on console and everything seems to work as expected. ![Set Attribute](https://s3.amazonaws.com/f.cl.ly/items/0f0V350j1Z3v371p0B3q/Image%202016-06-02%20at%2010.09.54%20AM.png?v=303b646c)
 @dmarcos Did you try setting the position immediately after append?
 I've tried setting the position before appending to the scene and it also works. 

![Set Attribute](https://s3.amazonaws.com/f.cl.ly/items/3g3E463F0b083d1M2s2f/Image%202016-06-02%20at%2010.14.04%20AM.png?v=3701f7cb)
 I tried and it works for me. Perhaps a codepen would help.

``` js
>>    <a-scene stats>
        <!-- Cube -->
>>      <a-entity position="0 0 -10" rotation="45 30 0"
                  geometry="primitive: box; height: 8; width: 8; depth: 8;"
>>                material="color: #167341; roughness: 1.0; metalness: 0.2;"></a-entity>
>>      <a-camera position="0 0 10"></a-camera>
>>    </a-scene>
+
+     <script>
+       (function () {
+         var box = document.createElement('a-box');
+         document.querySelector('a-scene').appendChild(box);
+         box.setAttribute('position', {x: 0, y: 10, z: -10});
+       })();
+     </script>
```
 That could be his problem. If the JS runs before AFRAME is initialized our `setAttribute` wrapper is not in place and hence the form `setAttribute('position', { x: 0, y: 0, z: -10 })` won't work. If you do `setAttribute('position', '0 0 -10')` will run through the standard setAttribute method and the attribute is set as you would expect even if AFRAME is not ready.
 @tbalouet You should make sure that your JS runs after AFRAME loads. Follow what @donmccurdy said.
 I'm going to close this because I'm 95% sure that the problem was the order of JS execution. @tbalouet feel free to reopen if loading AFRAME before setting up your entities does not solve the issue.
 @tbalouet Nice! Your scene looks really nice. are baking the lights?
 Can you post code + what you expect in a new github issue so we can check it out? thanks!
  For now, I think I'd rather we create a general event-proxying component (published outside A-Frame, but eventually be able to be lazy-loaded) than add more features into the animation system. That component might be useful in other cases. I feel the animation system right now is becoming unsustainable.
 I recommend trying to go through the component system. It is less asynchronous (going through the DOM system), becomes composable, and is easier to work with since you can just do `setAttribute` rather than `createElement + append + setAttributes + wait`.
 Nope. `animationend`/`animationstart` events bubble so they should be available to listen to on the parent entity. To select tie the proxying to the specific animation, you could maybe use a selector.
  Not reproducible anymore  dupe/fixed on master https://github.com/aframevr/aframe/pull/1497
  You could write a component that emits an event on another entity when you receive a certain event:

``` html
<a-event event-pass="on: click; emit: show-tooltip; target: #my-target">
```

https://aframe.io/docs/core/component.html
  @reutopiaer How did you get that error message? Can you provide an example? Can you try with aframe 0.2.0?
 @reutopiaer Please reopen if you can provide additional information
  Thanks for this, will look when we can. Got a bit of a backlog :)
 This looks good! Can you add a quick and cool example in `test/cubemaps`?
 Going to mark needs changes to add an example
 @phaseOne: This is awesome work here. It would be awesome to replace a scene such as [this one](https://codepen.io/vinsongrant/pen/grzOmb?editors=1000#0) with more succinct markup enabled by this `<a-skybox>` primative. Let us know if you need any help. üòÑ 
 @phaseOne did you want to address the remaining issues so this can get merged? how's this PR look, @dmarcos, @ngokevin?  Thanks!
  r? @cvan 

What three.js does, and @donmccurdy says it would allow him to do blanket PRs. It looks harmless, but I am not sure of the implications.
 I'm fine with it
  thanks for doing this üëç

[`webcomponents-lite`](https://www.npmjs.com/package/webcomponents-lite) (updated a year ago) still includes Custom Elements, HTML Imports, and Templates. we use Custom Elements but not the other two in A-Frame (we used HTML Imports in 0.1.0 but they're gone now).

could try [`webcomponentsjs/micro`](https://www.npmjs.com/package/webcomponentsjs) (updated two months ago) includes only Custom Elements and Templates. can we try to see if that works?
 Am not sure that'll you find a working one, we had to fix a couple of very subtle things with the polyfill we're currently using. If we wanted to save some of the bytes, we'd probably hack on https://github.com/dmarcos/document-register-element and remove lines of code. Not sure that is worth doing because then we are really maintaining a true fork.
 @gasolin: @ngokevin: I've heard from numerous folks that the WebReflection document.registerElement polyfill is incomplete and not spec compliant (and there are issues filed for them). @csuwildcat told me we should be using the webcomponentsjs Custom Element polyfill instead.
 OK, we can try if @gasolin you want to help out with that, would be much appreciated. There may be quirks as A-Frame was developed on top of the other polyfill so it will take a lot of investigating and massaging.
 The webreflection polyfill has served us well. besides saving a few KBs what's the benefit of this?
 Added a WIP tag. Let us know you can get the tests passing and investigate the quirks in switching. 
 Going to close for inactivity, let us know if you make progress on this. Thanks!
  Yeah, no HTML Imports coming.

Also try https://github.com/ngokevin/aframe-template-component which can load external HTML.
  @dmarcos Looks good to me. The alternative is to have the raycaster traverse up, but that's not performant.
 Can you add a small test in the entity suite?
 @msimpson Thanks!
  What'd you do?
 @cvan any ideas?
  ## Guide
- [x] 1. Introduction
- [x] 2. Getting Started / Installation
- [x] 3. Building a Basic Scene 
- [x] 4. Building an Advanced Scene
- [x] <s>5. Thinking in A-Frame</s> _concepts already explained everywhere, for now_
- [x] 6. Best Practices
- [x] 7. Device &amp; Browser Support
- [x] <s>8. Optimizing Performance</s> _merged into Best Practices_
- [x] <s>Example: Making Scenes Multiuser</s> _leave for a blog post_
- [x] <s>Example: Creating Data Visualizations</s> _leave for a blog post_
- [x] <s>Example: Creating Audio Visualizations</s> _leave for a blog post_
## Geometry
- [x] cone
- [x] registerGeometry
- [x] geometry.buffer
- [x] geometry.skipCache
- [x] geometry.mergeTo
- [x] Isocahedron, octahedron, dodecahedron, tetrahedron
## Primitives
- [x] a-circle primitive
- [x] sound primitive
- [x] torusKnot primitive
- [x] registering a primitive
- [x] analogy to 'assemblage' or 'bundle' or 'prefab'
- [x] a-*hedron primitives
## Misc
- [x] updateSchema
- [x] combine shader docs into material component
- [x] utils
- [x] rStats
- [x] debug component
- [x] explain DOM serialization
- [x] camera.zoom
- [x] default lighting tweak
- [x] mention useful components where appropriate (gltf, fit-texture, etc)
- [x] fix element/HUD in camera docs
- [x] flushToDOM
## Future
- embedded
- fullscreen on flat
- controllers
 ready
 Thanks @bryik! Let me know if you catch anything else.
 Unleash the @cvan 
 GD!
 Updated. We'll have to add some few extra docs as we land the last few things, but perhaps get this out of the way first.
 @cvan you went through this thoroughly. Can we merge? 
 looking through again now
 done; let me know when you're ready for me to look again. thanks
 Let use the labels need changes / needs review to determine if a PR has to be looked again
 > Let use the labels need changes / needs review to determine if a PR has to be looked again

that's exactly what I did‚Ä¶

![image](https://cloud.githubusercontent.com/assets/203725/16637128/ae1422c2-4391-11e6-89ea-15363890fa94.png)
 Updated.
 @dmarcos want to merge so people aren't updating old docs? we can continue to build/edit off of this
  Thanks!
  AFRAME only uses the custom elements API. We decided to go that route because the API spec is mature and it can be easily  polyfilled. We want AFRAME to reach the largest possible browser base without much performance hit and minimum bloat in the code base. We keep en eye on the shadow DOM but we have not played with it in the context of AFRAME but we are defintively interested. @trusktr how does your approach work across different browsers with no shadow dom implementation?
 Don't think shadow DOM is necessary (at least for core). The template component or using three.js scene graph to represent as the "shadow" scene graph are other options
 Actually not too worried about shadow DOM. I don't think it solves many issues in the 3D/VR space where the actual HTML ends up pretty hidden, and we have a lot of components/tools to abstract/render subtrees (whether in DOM or 3D scenegraph). Even in Web Component land (which is not too adopted itself), shadow DOM isn't well adopted. But yeah, if you can find an easy fix that doesn't require much maintenance, cool!
 One important note that I don't think has been mentioned in this thread ‚Äî A-Frame does not, by default, write attribute values to the DOM. If an entity's position changes on every frame, A-Frame will only add the `position` attribute to the DOM once, and after that all updates are virtualized. More information in docs for the [`debug` component](https://aframe.io/docs/0.6.0/components/debug.html).

All that to say, A-Frame's entities are already a sort of virtual DOM ‚Äî if you can measure noticeable DOM overhead (after initial scene setup) I would be surprised.

Being able to run A-Frame in DOM-less environments, e.g. serverside, is not built in. I would be curious how that goes for you, if that's something you're planning to try.  Do you think you could add a unit test for this?
 Thanks!
  You can try https://github.com/donmccurdy/aframe-extras for now

There's a PR open for merging extensible controls in.
 @dmarcos an simple-ish fix for this, #333, and #1409 (short of the whole controls refactor) would be to (1) support the arrow keys, and (2) use `event.code` instead of `event.keyCode` if it's provided. In browsers that implement it, that will reflect the physical location of the key so that Dvorak and ZQSD keyboards work as expected.

Example:

``` javascript
// Tiny KeyboardEvent.code polyfill.
var KEYCODE_TO_CODE = {
    '38': 'ArrowUp',
    '37': 'ArrowLeft',
    '40': 'ArrowDown',
    '39': 'ArrowRight',
    '87': 'KeyW',
    '65': 'KeyA',
    '83': 'KeyS',
    '68': 'KeyD'
};

var code = event.code || KEYCODE_TO_CODE[event.keyCode];

```
 thanks
  I created a `template-set` component: https://github.com/ngokevin/staryu/blob/master/components/template-set.js when I was loading data from an API.

https://github.com/ngokevin/staryu/blob/master/index.html#L26
 Yeah, I guess I can add it as sugar to the template component. 
  Can you provide an example?
 I'm no able to reproduce this. @justvova please reopen if you can provide a test case that illustrates the problem.  To both. Have to hack with our complicated Browserify steps and make sure source maps still work.  **Description:**

@dmarcos and I don't know why this is needed. Before the callback, parentNode is defined. At the callback parentNode is briefly null. parentEl works for some reason. Have no idea what is happening to the read-only parentNode.
## **Changes proposed:**
## 
## 
 Not being swapped, the defining lights replaces the default ones. They shouldn't be related to one another. But seems this might be a bug.
  Thanks for filing. This is also filed at https://github.com/aframevr/aframe/issues/451
  Should we include this in the core lib? I don't care much about IE11 given it doesn't have WebVR, but it seems small enough.
 I use Windows 10 and aframe.io works properly on Edge. If Windows 10 includes both (IE 11 and Edge) you're always one click away from an aframe capable browser. On Windows 7/8 you can just install Chrome or Firefox. 

The problem with IE 11 goes beyond CustomEvent support. I've tried [the three.js examples](http://threejs.org/examples/#webgl_decals) and many of them don't even render or are extremely slow. It seems that there also WebGL compatibility issues. I don't think IE 11 reaches the minimum quality bar to do any sort of 3D work. I'm closing this.
  ‚Ä¶ and positioning can be controled styling the a-scene when adding the embedded attribute
 Should we add a test example showing multiple scenes on a page?
 I don't think multiple scenes per page works quite yet
 Need to move the A-Frame scene above the fold, else it looks like a normal Wikipedia page:

<img width="1440" alt="screen shot 2016-06-10 at 3 24 54 pm" src="https://cloud.githubusercontent.com/assets/674727/15967471/cc4160c4-2f1f-11e6-828e-f1a94ad23bb8.png">
 This puppy is ready to go home.
 ok will look when i can
 Clicking on the Goggles for `Anime UI`, `Dynamic Lights`, other examples, the icon just disappears. For `Composite`, you get teleported into the cube. It works for `Cube` though.
 Can we maintain some of the padding in non-embedded mode? It's a bit too close to the corner now.
 This is ready to go. I made an important change I think it's sensible at that point. The default camera position was `x: 0; y:1.8; z: -4` so objects at `x: 0; y: 0; z: 0` are visible in front of the user. Now the camera starts by default at `x: 0; y: 1.8; z:0` so it's consistent with the position returned by a headset when entering VR.
 Can we maintain that offset if we detect non-VR fullscreen? 
 No because the scenes will look different with and without a headset. It's better to be consistent and behave in the same way that other libraries operate. I think it only adds confusion. -4 meters default displacement in the z axis it just feels arbitrary. 1.8 metes in the y axis makes sense because it's human scale
 Right now, if I play a scene on desktop and enter fullscreen, I'm on the ground or below the ground.
 The offset in the y axis should still apply
 Yeah, I'm just talking about the Y-axis. Try the geometry gallery scene and enter fullscreen (non-VR).
 I believed I covered all the cases: Desktop with and without headset, mobile, scenes with and without default camera. I have to do one more round of tests with a headset. 
 1. Consider configurable camera property `nonVRHeight` or similar name such that user-defined cameras can benefit from the non-VR offset. Default camera can set this to 1.8 by default.
2. Consider, now or later, to differentiate between VR and flat fullscreen. The save/restore camera pose when entering in and out seems useful for only VR, not flat fullscreen.
 Ready to go. The offset in the y is now applied to all cameras and configured via the `userHeight` property in camera. The offset is removed in the presence of a headset. When exiting VR the previous (before entering VR mode) position of the camera is restored when a headset is connected.
 very nice
 r+ when you ready to merge
 I would probably add `userHeight: 1.8` to `<a-camera>` as a default.
 @ngokevin can you test a bit to see if everything make sense?
 I tested around a few examples on my laptop, everything makes sense there:
- Flat:
  - Default camera, 1.8m offset.
  - Enter fullscreen, offset still applies.
  - Exit fullscreen, pose is not overwritten.

I haven't tested in VR. But I assume you have this:
- VR:
  - Enter VR, offset is removed.
  - Exit VR, pose is restored to before entering VR.

Just the one note that if I did `<a-camera></a-camera>`, I would sort of expect to have similar defaults as the default camera.
 We can decide on the user-defined `<a-camera>` default later.
 Nice. Love resolving the camera height inside and outside VR.
  **Description:**

``` js
document.querySelector('a-scene').enterVR();
document.querySelector('a-scene').exitVR();
```

And also document how to when `<iframe>`-ing content.
- A-Frame Version: any
- Platform/Device: all
 https://github.com/aframevr/aframe/blob/master/docs/core/scene.md#methods
 [Nice section here](https://github.com/aframevr/aframe/blob/master/docs/core/scene.md#running-content-scripts-on-the-scene), but for some reason waiting for `loaded` doesn't work. you have to add a `setTimeout`. gotta figure out why:

``` js
<script>
   (function () {
       // switch to stereoscopic mode directly on page load, this needs to be after the a-scene loads.
       var scene = document.querySelector('a-scene');
       if (scene.hasLoaded) {
           scene.enterVR();
       } else {
           scene.addEventListener('loaded', function () {
               setTimeout(function () {
                   scene.enterVR();
               }, 1000);
           });
       };
   })();
</script>
```

Also, not exactly specific to this issue, but still think we should support #705.
 Well, no one is against #705. Though I might also just recommend creating a scene component. They have the advantage that you don't have to worry about query selecting, waiting for events. Just write JS and attach:

``` js
AFRAME.registerComponent('auto-enter-vr', {
  init: function () {
    this.el.sceneEl.enterVR();
  }
});
```

``` html
<a-scene auto-enter-vr>
```
 like it
 Though I guess you might still have to add the event listener...but at least you don't have to query selector or worry whether it's already loaded. And you get reusable code for free.
 > This is not working with version >=0.3.0

Are you testing in Chromium or Firefox Nightly? Chromium currently has a temporary user-gesture requirement; Firefox Nightly does not.

 (Accidentally closed issue.) @Silver-Seagull yep, there is - I'm working on it right now. out of curiosity, are you working with only Cardboard? or are you using Chromium/Firefox w/ Vive/Rift? I'm just curious which platforms A-Frame devs are using. @Silver-Seagull there are a couple bugs in that code. I'm fixing them right now. but if you're trying to do it right now, just set `<a-scene auto-enter-vr="display: all">`; that's a temporary workaround though. Just for the record. `auto-enter-vr` will go away in next version in favor of the `link` component and system I got [this patch](https://gist.github.com/cvan/c9351d20223e7824041557a94c414ced) working to auto-enter VR, but I still have to fix up the tests (and write new ones).

As Diego mentions above, the code in A-Frame (and three.js) is going to have to be reimplemented soon anyway (to support all the variations in Oculus Carmel, Google Daydream, Google Cardboard, Firefox Nightly, and Chromium Desktop), as the [WebVR API](https://w3c.github.io/webvr/)'s navigation flow (for auto-entering VR) is in flux right now (see issues w3c/webvr#30 and w3c/webvr#152).

@Silver-Seagull: I'd recommend dropping this JS snippet into your scene for now:

```js
window.addEventListener('load', function () {
  var scene = document.querySelector('a-scene');
  if (scene.hasLoaded) {
    scene.enterVR();
  } else {
    el.addEventListener('loaded', function () {
      scene.enterVR();
    });
  }
});
```

Hope that gets you where you need to be.
  Thanks for catching. Can you click edit on github at bottom of docs page
  You can create a system and move your tick function there so it's called once per frame regardless of the number of models in the scene
 Yeah, that would be easiest. People can consume it right away, and later we will allow lazy-loading components in.
 Thanks for doing the good work. Shall we close this?
  **Description:**
- `registerShader` API is actually registering materials. Even for custom shaders, it is using `ShaderMaterial`.
- Confusing that `registerShader` maps to providing options for the material component. It's pretty tough in the docs to explain this.

Related: https://github.com/aframevr/aframe/issues/1457
 How might `type` be ambiguous? It maps to `THREE.Material.type`.
 @dmarcos Thoughts? I think this will be less confusing.
 `type` isn't actually reserved:

This is single-prop:

``` js
schema: {
  type: 'string'
}
```

This is multi-prop:

``` js
schema: {
  type: {default: 'string'}
}
```
 @dmarcos Any objections?
 I would keep registerShader. Material use shaders and it's what you select on the shader property. It's also consistent with the registerPrimitive API for geometries. 
 Shaders is an advanced feature. We have to document it but it's not necessary to dumb it down.
 Shader is a wide spread computer graphics concept. ShaderMaterial is specific to three.js
 Yeah, materials use shaders technically, but API is an abstraction on top of three.js materials and an extension to the material component. registerMaterial registering materials and is way more clear than registerSbader registering materials.

geometry is registerGeometry, not registerPrimitive. 

For documentation, I'm not referring to documenting custom shaders, I'm referring to documenting our materials that we refer to as Shaders. Readers would not expect that A-Frame materials map to A-Frame shaders.

Just doesn't make sense to break a perfect mapping.
  **Description:**

Allow configuration of systems through the DOM like we have for components. 

For example to adjust physics gravity `<a-scene physics="gravity: 9.8">`

Or Websocket server `<a-scene multiuser="http://myserver.5000">`
 Currently, all systems are initialized before the scene has initialized. So systems currently cannot do `getAttribute` to retrieve data. Having a schema and data initialization in place would allow systems to access scene data. Having this issue with the broadcast component+system
 Yeah, I have been using proxy components as well. 

I think we do initialize systems before components ATM.

A schema would solve problems.
  On a user gesture, explicitly play sounds that have `autoplay`. (Born out of #316.)

Firefox for Android (and soon for iOS) enables `autoplay` playback by default! woo! üéà 
 I don't know whether I fully understand the problem here, but in my Chrome for Android the sound autoplay just works. In iOS, it doesn't.

In Firefox for Android, though, I can't even open the initial screen of my app without crashing the browser.

Am I missing something?
 Whoa, that's a different issue. Does the scene load okay on desktop?
 Yes. Actually I've now finished my project, and probably won't be using a-frame again in the next weeks. But in the end, I just couldn't make audio play at all on iOS, on both Chrome and Safari, even on user events like `mouseenter` (with fuse cursor) and even with `click`. It did work on Android and desktop, though. 
 We ought to create an FAQ entry about this, as the question does come up a lot... There is really no way to start an audio clip on iOS without a user interaction. If you want ambient noise or music in the background, you could have a "Begin" button overlaying your screen, prompt users to click that before they enter VR, and kick off VR mode and the audio at the same time.

For sound that would play at arbitrary times, I haven't seen a working example yet. Presumably you would need to put all your sounds into a single file, start that at the beginning, and skip around in the file as needed to play specific effects. This is a pretty painful solution. :/

> But in the end, I just couldn't make audio play at all on iOS, on both Chrome and Safari, even on user events like mouseenter (with fuse cursor) and even with click.

A couple notes here:

1) Chrome and Safari on iOS are effectively the same thing; Firefox might work, per @cvan's comment a year ago?
2) `mousenter` and `click` events generated by the fuse cursor are not user interaction from the browser's perspective... those are still events generated by the scene's `cursor` component. You would need the user to press the screen, physically, to generate supported user interaction.

A few more resources:

- https://stackoverflow.com/a/15108385/1314762
- https://www.ibm.com/developerworks/library/wa-ioshtml5/
- http://matt-harrison.com/perfect-web-audio-on-ios-devices-with-the-web-audio-api/ We've had really good results using howlerjs for some production projects and games. It'd be great to see someone write a component that extends the standard `sound` component to add audio sprite support using howlerjs. > Everything says you need a user interaction on ios to play audio, but i can't find a working example of that.

The problem is that interaction within an A-Frame scene doesn't count. The browser can't tell what's going on inside WebGL, so it has to assume those events are just generated by arbitrary JS. You need an old-fashioned physical `touchstart` or `click` event, triggered by the user's finger (or Cardboard button) and not by a fuse or gaze cursor. Gamepad buttons might also count. I don't know of a live example of this though.

> It'd be great to see someone write a component that extends the standard sound component to add audio sprite support using howlerjs.

+1, this sounds like great idea. It would be nice to see this prototyped as a separate component (`sound-sprite`?) and added to the registry, where multiple instances of the component can share a single audio file.  This works on my iPhone 6 Plus by gazing at the cubes. I had to make sure I turned the silent lock switch off on the device otherwise sound wouldn't play (expected behaviour).  It looks good to me. I let @ngokevin merge it.
  thanks!
  **Description:**

With the `registerGeometry` API, a variety of geometries can be registered that won't have to be geometric primitives (e.g., text, extrude, svg)

Smaller reasons would consistency with three.js API as Geometry objects have a `type` and simpler wording.
 Or alternatively if we detect an attribute that is not type/default/parse/stringify, then we switch it to multi-property.
 Actually, `type` is not reserved. If `type`'s value is a string, then it will be single-prop. If it is an object `type: { type: 'string' }` then it is multi-prop.
 I think type is ambiguous and carries a different meaning in a programming context. Primitive is commonly used in many 3D packages: [3D Studio](http://docs.autodesk.com/3DSMAX/15/ENU/3ds-Max-Help/files/GUID-66152BDE-BA64-423F-8472-C1F0EB409E16.htm), [Maya](https://knowledge.autodesk.com/support/maya-lt/learn-explore/caas/CloudHelp/cloudhelp/2016/ENU/MayaLT/files/GUID-6D21314A-54AD-41D4-AFC0-AAED13CD50A6-htm.html), [Blender](https://wiki.blender.org/index.php/Doc:2.4/Manual/Modeling/Meshes/Primitives)
 In 3D programs, the word primitives is used to create geometric primitives, yes. But three.js geometries don't have to be geometric primitives. 

`type` is what three.js refers to their geometry types. No one is going to confuse geometry component type with programming types. Better the possibility of being ambiguous than being incorrect anyways.
 type is not descriptive enough in this context. let's move on
 I made points and counterpoints. If you want to close it, it would be copacetic to address them rather than brushing them off.
 I think renaming does not bring any benefit. it's changing for the shake of changing and type is a very ambigous word and used in other contexts. primitive is a common concept used in computer graphics https://en.m.wikipedia.org/wiki/Geometric_primitive
 OK. The main exception I was thinking of was text, SVG, and extrude, but if they're the minority, and we're okay with the slight awkwardness of `<a-entity geometry="primitive: text">` or `<a-entity geometry="primitive: svg; src: mysvg.svg>`, this isn't too big of a deal.
 text should probably be a separate component. 
 and svg as well
 You could, but then you don't get free geometry merging, caching, buffering, and automatic memory management provided by the geometry component.
  thanks!
  nice
  thanks!
  Animations don't take components. I imagine this will work:

``` html
<ent yourlistener>
  <anim/>
</ent>
```
  Where is this happening?
 We don't set any favicon iirc
 OK, we should probably remove that.
 if you set a `<link rel="icon">`, we won't inject our own. is this an issue?
 @alexcheninfo sorry about this. opened PR #1477. it should get merged very soon üòÑ 
  We're actively working on this. https://github.com/aframevr/aframe/pull/1322 helped, and we're doing some extra stuff right now
 http://stackoverflow.com/questions/38380912/why-is-my-video-or-videosphere-not-playing-on-mobile-in-a-frame-vr
  **Description:**

Like http://codepen.io/anon/pen/XdGpEy?editors=1010
 > https://files.slack.com/files-pri/T0FAGUM6W-F1846MQ5U/animations-from-dae
> 
> Hey @ngokevin we got that dino animating yesterday ‚Äî but it looks like AFrame is only set up for skinned animations (where the animation is a child of the geometry) ‚Äî in (regular?) animations, they are in the Collada object which is discarded in Aframe‚Äôs loader implementation
 To contribute, check out how it's done in  http://codepen.io/anon/pen/XdGpEy?editors=1010

In the COLLADA component (src/components/collada-model.js), use `THREE.Animation` if the mesh is a `SkinnedMesh`. Once the animation is created, use component `tick` handler to step the animation.
 Discussing this a bit here: https://github.com/donmccurdy/aframe-extras/issues/82

@ngokevin any thoughts on what the play/pause API should look like, since models can include multiple animations?
 Making some progress on animation support in [three-model](https://github.com/donmccurdy/aframe-extras/blob/master/src/loaders/three-model.js). But since THREE.AnimationMixer (the replacement to THREE.AnimationHandler) isn't specific to a particular model format, it probably makes most sense to not bundle animation code into the `model-*` components themselves.

Strawman syntax:

``` html
<a-entity collada-model="src: url(...);"
          model-animation="name: run;
                           duration: 0.5;
                           fps: 30;"></a-entity>
```

Animation name can be optional; perhaps the first animation available will just autoplay.

There are multiple kinds of animation: morph-based, skeletal, and keyframe-based (?). Options need to be set on the material to support morph and skeletal animations. [Perhaps that can be done automatically by loaders](https://github.com/donmccurdy/aframe-extras/blob/master/src/loaders/three-model.js#L46-L48), or retroactively applied to the material.

A `model-animation` component could be fairly detached from the model-loading code, so it might make sense to include it in core. It should be triggered by events, or programmatically.

Also, idle thought, would the current `animation` component be better named as `tween` to reflect that it's not the right choice for effects like changing `src` attributes?
 Wrote an [animation-mixer component](https://github.com/donmccurdy/aframe-extras/blob/feat-animation/src/loaders/animation-mixer.js) that works out of the box with [json-model](https://github.com/donmccurdy/aframe-extras/blob/feat-animation/src/loaders/json-model.js) and [gltf-model](https://github.com/xirvr/aframe-gltf). It should work for ObjectLoader aka `blend-character-model` too, but i'm working out some issues there.

I think it's probably worth having a dedicated component for animation, rather than baking it into model loaders, to support things like [blend tree animation](https://docs.unity3d.com/Manual/class-BlendTree.html) and to have a consistent API. This component depends on [THREE.AnimationMixer](https://github.com/mrdoob/three.js/blob/dev/src/animation/AnimationMixer.js) (the fancy new animation system in THREE.js).

But Collada models still require the older [THREE.Animation](https://github.com/mrdoob/three.js/blob/302c693b27663d4d280b156b5ebe4ed38cd062e4/examples/js/loaders/collada/Animation.js), which has been moved into an example folder with just Collada-specific code. We could bundle both animation systems, but I'm more inclined to use the new system and encourage people to convert their Collada stuff to glTF with the online converter.

---

EDIT: I was incorrect about glTF, the animation was playing because `gltf-model` autoplays animations itself. THREE.gltfLoader has its own, third, [animation system](https://github.com/mrdoob/three.js/blob/302c693b27663d4d280b156b5ebe4ed38cd062e4/examples/js/loaders/gltf/glTFAnimation.js). üòê
 The glTF-specific animation system has been removed in favor of the new/common animation system, THREE.AnimationMixer: https://github.com/mrdoob/three.js/pull/10276.

In terms of adding model animation support to A-Frame, I think it would make most sense to start with the THREE.js JSON format and glTF ‚Äî those are the two formats that use the new animation system. @msj121 everything in THREE.js `dev` is now cross-compatible for that to work ‚Äî hopefully all we need to do is update `gltf-model` to the latest version of THREE.GLTFLoader. 

But definitely a chance there will be version mismatch issues, and if so it may be necessary to wait for the next THREE.js + A-Frame releases. Going to close in favor of supporting glTF animations. If COLLADA benefits from that then great. Otherwise, see the three.js code for playing COLLADA animations (use the `model-loaded` event to grab the collada scene):

1. Import animation code 

https://github.com/mrdoob/three.js/blob/dev/examples/webgl_loader_collada.html#L36


2. Traverse the model and play animations

https://github.com/mrdoob/three.js/blob/dev/examples/webgl_loader_collada.html#L57

3. Tick the animation

https://github.com/mrdoob/three.js/blob/dev/examples/webgl_loader_collada.html#L181 For posterity, is an example implementation of animation with COLLADA:

https://github.com/donmccurdy/aframe-extras/issues/101#issuecomment-257197602  Which Chromium? Brandon's builds use WebVR API 1.0. Chromium doesn't have WebVR. For the former, it's a WIP with a PR up now, for the latter can't do anything about that
 Yeah https://github.com/aframevr/aframe/pull/1423

diego has been testing it on multiple devices. working on the iOS part atm
  Is this just a jQuery thing, or maybe a bug in your code snippet?
 It does not work after remove you mean? We call remove in the components when removed from the DOM
  dupe https://github.com/aframevr/aframe/issues/316
  Thanks for tackling this. I don't think emitting events from the render loop is a very good idea. It adds overhead (and most of the time you won't even use it) and compromises performance. Having a way to do postprocessing effects would be indeed very cool. I like more @donmccurdy approach of providing two methods at the component level. You can currently insert your logic in the render loop via the `tick` function of components and systems. It would be nice to have a way to throw warnings or stats on console if  any those user defined functions in the render loop are too slow.
 Can you remove the `dist` bumps?
 Hmm, after going over the PR, I'm not sure about piggybacking off the component API. It assumes `postRender` might have a wider use case than just post-processing. And having to add special cases for pause/play is not great since post-processing shouldn't have a concept of pause/play. Maybe we need a tighter API for register post-processing effects. Thinking about it...
 I don't like using the component API too much. We are adding a special handler and property that from what I can tell would only be used for post-processing, and then we have to touch play/pause code, and such.

Brainstorming, but here's an alternative API, which would be harder to implement, but would be a bit more explicit. Using the System API, this would be a bit similar to Don's Controls API:

```
AFRAME.registerPostProcessor('some-effect', {
  schema: {},
  vertexShader: 'vertexshaderstring',
  fragmentShader: 'fragmentshaderstring'
});

<a-scene postprocess="bloom, hdr, ssao" bloom="intensity: 0.5>
```
 Ah, right, thanks for the details. I should clarify the sample API I had would still make post-processing effects a component, but just a subset API of a component. Just because `postRender` + `postRenderPriority` would only be used by effects, seems to make sense to fence it off. 
 Thanks, will take a look when I can
 Can you remove the `dist` files from the PR?
 - `dist/` files are out and look OK now.
- Yeah, that's not great. But @dmarcos just pulled them into `vendor/` for WebVR 1.0 API reasons. We still wouldn't want to touch them. Maybe we need that module to live in its own home?
 Needs a rebase. I'm not sure how we should handle the `VREffect` change collisions. Ideally, all the changes would be upstreamed to three.js, but maybe we should just move it to `lib/` and maintain it for now...
 Bunch of `npm run lint` errors
 Yeah, still need to resolve it with the VREffect in `vendor/`, but there'll be a lot of lint errors for `a-scene`, and all the example JS files.
 @fernandojsg r?
 I'm looking around the API and I'm thinking how to deal with multiple postprocessing on the scene.
Sometimes you may want to add gloom + ao for the whole scene but also want to active from time to time other effects like nightvision or some kind of underwater distorsion.
Ideally you could be able to chain them, switch on/off and change the parameters for each one.
Did you already think about a way to solve this with the current implementation?
I was thinking on something like:

```
<a-postprocessing>
    <a-effect id="sparkles1" type="sparkles" img="sparkes1.jpg" opacity="0.5" color="#fff">
    <a-effect id="sparkles2" type="sparkles" img="sparkes2.jpg" opacity="1.0" color="#f00">
    <a-effect id="gloom" type="gloom" intensity="1.2" radius="2.0">
    <a-effect id="nightvision" type="nightvision" intensity="2.0" noise="1.2">
</a-postprocessing>
```

Everyone will be loaded but just some of them will be used, defined by the `post-process` param on `a-scene`, and just the last one is the one that will render back to the framebuffer.

```
<a-scene post-process="gloom, nightvision"/>
```

So you could add or remove effects from the postprocessing chain modifying `post-process` effect. And also you could modify the parameters for each effect accessing directly to the element defining it.
 Those individual effects could be components rather than adding a new element too.

@wizgrav I'm rethinking the tick/tock...It would be more flexible to explicitly define an order like you had before right?
 but if you want to reuse some like the `sparkles` but with different parameters, do you need to create a new component? or will you create a `a-mixin` for each one?
 What about this:

``` html
<a-scene post-process="effects: sparkles, sparkles, bloom, nightVision; bloomIntensity: 1.0; nightVisionIntensity: 0.6; sparkles1Color: red; sparkles2Color: blue">...</a-scene>
```

The name of the effect and the index are automatically prepended based on the schema of the effect and the order in the list.
 I think we should decide on a post-processing API later. This PR is really about being able to order component `tick` calls and being able to hook into the post-render. That is very flexible for now, and when we have more experience, we can maybe define an explicit PP API later.
 I think the post-processing component should be the one calling the tick methods of each effect.
 That could be layered in or decided later. Note that PP is just a component in `examples/`; it's just one use case. The PR is actually about ordering components. Another use case for that is the controls API needs support for ordering `controls` before `velocity`. 
 What I mean is that we just need a new method tock called after the render call and that's all. If there are multiple tick functions to call on a specific order should be managed by the component post-processing. We don't need a generic API at this point. What other use cases are there? The API proposed is over killing in my opinion.
 So if we had two components `controls` and `velocity`, where `controls` needs to be run before `velocity`, we wouldn't be able to control that with just `tick`/`tock`. We need a way to order those `tick`s as well. That could be a different PR though, yeah.

Yeah, I think the bare minimum for this PR, is a `tock` and events on `add/removeBehavior`. I think PP could be accomplished within those constraints?
 You can express that with the dependency components. If a component is a dependency it will be initialized in first place and the tick method called before the dependent component one.
 As the active PP `effects` could be dynamically modified I believe the order must be controlled from a `post-process` component that is the responsible to access the PP system. I'm not sure why do you want to implement `tick/tock` for PP instead of doing a composer similar to the one used in threejs' `THREE.EffectComposer` or Jaume's `Wagner`. So you could just inject a call in the `a-scene` render when postprocessing is active and the order, passes and so on will be delegated to the `post-process` components, instead of worry about `tick` order for each effect's component.
 @wizgrav With that approach you're avoiding multiple drawcalls but if the effects change dynamically (going inside/outside water, nightvision on/off) you're rebuilding the whole shader on each switch which is not very performant :\
Also the `fragmentText` should be defined in that way by the user? or it's dynamically generated from the original fragment shader from the user?
 I believe it will be quite hard to come out with an hybrid system to control the passes in order to optimize the drawcalls as creating just one whole shader is not possible for many effects so it should be necessary to create a logic to separate the "full" passes from the "composed" passes as you described.
For example if you want to apply blur, it's way much faster to do two passes with horizontal `blur -> rotate 90¬∫-> horizontal blur`, instead of one pass. Also you will have some passes that will be applied to RT of different sizes, so the system should be intelligent enough to deal with this...
Maybe you could define which passes should be executes separately in the API to prevent overengineering it.
 Yeah, we can fix the tests to `delete`
 The `precedents`/`following` ain't too bad. It's better than just hijacking the `dependencies` API because that is meant for a different purpose (i.e., controls initialization rather than tick execution). It's also better than assigning numbers because it's much tighter and explicit.

Will have to look at the graph-based API because it is fairly complex. But sounds cool.
 Thanks. We'll try to get to this and understand it. Though it's Memorial Day Weekend, I'll be on a trip next week, and we'll all be in London for a week right after. Focuses will be on controls, documentation, and 0.3.0 release, but I hope we can get to this!
 Do you think it'd be a good idea to split this PR up into three parts so it'd be easier to review?
- `tock`
- execution ordering
- post processing exaple
 Is it possible to do `tock` addition first? I think that would be easiest. And then later, we can layer on the ordering?
 Yeah, I was suggesting that we save the post-processing example for last.
 Cool. We can keep this one open to track the overall work.
 @wizgrav did you want to wait until PR #1564 is merged before fixing this one up too? @wizgrav thanks. @ngokevin and @dmarcos are best to review #1564. thanks; excited to see this get merged üëç  I think we can close. Not much demand for ordering past tick/tock and it seems aframe-effects was able to get by.  Yes, we've known this for a bit but haven't addressed it. We need to clarify this. Sorry about this.
 The button should show a full screen icon instead of the googles.
 https://github.com/aframevr/aframe/issues/1060
 The text is gone for now.  Thanks!
  A-Frame is not expected to work on nodejs. It's a front end library
 NPM is heavily used these days for frontend dependency management for use with Browserify or Webpack.
 Yeah, or with Webpack. Not Node.
  Thanks! The convention we were trying to introduce for event names was: componentname-eventname. @ngokevin why do you think the new events are not working as expected?
 I wanted to remove the prefixes too. I think we can make these events standard.
 I see that the cursor component in master indeed emits events of the form cursor-eventname . The problem is that the  published docs don't reflect 0.2.0 but master. Someone reported that the color animations don't work as stated in the docs https://aframe.io/docs/core/animations.html#Color-Attributes. That's a feature that recently landed in master @cvan have we recently republished the docs? We should deploy 0.2.0 tag instead of master
 Yeah, we've been deploying master documentation. I agree, I can make it go back to the 0.2.0 tag and I can put a dropdown to view old/master docs.
 The current docs correctly reflect the API. The problem is that the published version on the website corresponds to master instead of the latest public release 0.2.0. I'm closing this and I filed https://github.com/aframevr/aframe/issues/1428 to take care of the issue
  This does not make the code harder to maintain (for loops leak an extra variable) and a bit more brittle? If you for example have two nested for loops. You need two variables and make sure you use the appropriate one. I've quickly checked backbone and react (just picking two random popular libraries) and they don't use that form of for loops. Why is that?

https://github.com/facebook/react/blob/master/src/renderers/dom/client/ReactDOMTreeTraversal.js#L120

https://github.com/jashkenas/backbone/blob/master/backbone.js#L145

Also most of the Stack Overflow discussion you pointed out is from 2011. Are the claimed perf gains still relevant in the JS VMs of 2016?
  I am proposing https://github.com/ngokevin/aframe-event-set-component as the alternative to deprecate declarative events.
 Declarative events deprecated. Event Set should work
  thanks!
  Defaults live at https://github.com/aframevr/aframe/pull/1421/files#diff-cc37208f3a65c67afe166320bf095ca6R10
 @dmarcos Approve the idea? I've built a bunch of scenes, I almost always want `linear` over `ease`.
 The conventional wisdom is that animations should always have some easing because it's how natural movement occurs in real world. Linear animations usually feel unnatural. Look at how biological systems move and operate and how that influence animations in UIs and games. @ngokevin why did you prefer linear over ease in your experiments?
 I've used animations for:
- Falling. A cheap way for gravity.
- Continuous movement. Like a butterfly flying around a try, or something running, or like a plane/car. Or a laser. Something on a conveyor belt.

But those are probably exceptions, and even then they would probably have some miniscule easing. so I agree. Linear is unnatural. Sorry for the goose chase, @gasolin 
  thanks
  iOS might be able to play m3u8. The problem is using that video stream in the context of a WebGL texture. Please reopen If you can provide a working example.
 @radenui thanks for letting us know I would try first to make a core shader `video`. Can we expose the video texture to custom shaders? If tha's hard or not posible we can maybe try something like `video-material` approach There is now support merged into latest master for HLS on iOS 10 with Mobile Safari.

Unfortunately my understanding is that said support will not work on earlier versions (e.g. iOS 9) and no further work is planned there.

Should we close this one now?
  Thanks!
  dupe #333
  Can you show a bit of code?
  Thanks for PR! Unfortunately, this heavily collides with https://github.com/aframevr/aframe/pull/1399 because of the way texture loading and caching is changed. Let's re-open after that lands.

https://github.com/aframevr/aframe/pull/1399 will make it easier to add more texture properties.
  thanks
  **Description:**

```
// Emit intersected on intersected entity per intersected entity.
    intersections.forEach(function emitEvents (intersection) {
      var intersectedEl = intersection.object.el;
      intersectedEl.emit('raycaster-intersected', {el: el, intersection: intersection});
    });
```

reported by @drakon58
- A-Frame Version: master
- Platform/Device:
  Thanks!
  I think that would be pragmatic.
 We've deprecated a-animation. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.

The component won't take into account the delay on subsequent runs. If you do want delay on subsequent runs, you can control the anim with a bit of JS  Thanks!
  Thanks!
  I think for now, iPad/Android Tablet should be detected as mobile so that they still work without having to create custom touch controls. If they were not detected as mobile, then all of the Cardboard scenes that were built with accelerometer in mind would not work correctly.

You can open a PR for fixing TV detection; we're focusing more on VR rather than flat.
 For thumbpads or touch thumbpads, you'd be free to register your own controls. Each application has such specific controls requirements so we're leaving it up more to the dev.
  This is a limitation of Android.

GearVR has special IMU (internal measurement units) within the headset that it can retrieve faster data from. For Android browsers, we are limited to device orientation API which is much slower.
  **Description:**

How would we allow having multiple components of the same type, declaratively? If we should at all.
- Right now, you could create a custom parser and allow passing a complex string. Would be hard to code.
- You could do `setAttribute`, but you wouldn't be able to declaratively code that.
- Maybe a number suffix?

**Use cases:**

Set on event:

``` html
<a-entity set-on-event-1="event: click; property: material.color; value: red"
               set-on-event-2="event: mouseenter; property: material.color: value: green; target: #enemy"></a-entity>
```

Randomizer:

``` html
<a-entity random-1="property: material.color; min: 0 0 0; max: 0 0 0"
               random-2="property: geometry.primitive; oneOf: box circle sphere"
               random-3="property: material.roughness; min: 0; max: 0"></a-entity>
```
 The first case is logic `when this happens do this` and should be in JS. You're cramming imperative logic in a declarative language. In a real world application the logic is usually more complicated than `if this event happens change this single component attribute and nothing else`. Having logic in both JS and your DOM will make things harder to understand and follow. 
I think I don't fully understand the second case.
 Declarative doesn't mean logicless. Many components should and do have logic. 

Declarative events is just an example. It is not expected by all means to handle all logic, but it is a common pattern. I just want it to fit better into the framework, even as a third-party component. Think CSS hover states, active states. When something happens (click, hover, collide, gaze), do something.

Everything is up front and there is no behavior hiding in a script tag somewhere. ECS makes it easy to encapsulate logic such that all I have to do is append to DOM to get things to execute:

``` html
<a-entity sound="on: click; src: scream.mp3"></a-entity>
<a-entity event-set-1="on: collide; property: explode"
               event-set-2="on: collide; property: material.color; color: red"></a-entity>
```
 @andreasplesch That wouldn't work because then those would be modifying different entities. I'd want to be able to randomize any property value on a single entity.
 We're thinking animation is a special case because it will be too complex to define as HTML attributes (e.g., sequencing, keyframing). Components are defined as HTML attributes.

For the randomizer component (again, it's just an example), it doesn't require any parent-child relationship. You could register a custom element to do it, but that breaks away from the ECS mold. We generally reserve parent-child relationship for the scene graph.
 For this issue specifically, the only problem we have is trying to define more complicated data structures in the DOM. With traditional ECS, you just use code so it's easy to pass around arrays of objects. 

rotation/position/scale aren't an exception. They apply to the entity they are attached to. It's just the way that local and nested coordinate systems affect each other, which is documented.
 The declarative must not contain any logic to keep a good separations of concerns. Declarative: Describes what you want (HTML): A red cube, a cursor, a tiny elephant. Imperative: Describes how things will behave (JS). If you start adding logic to HTML you will have it scattered all over the place in JS and HTML making hard to follow the flow of your program. Writing the logic you propose above in JS is pretty trivial. You're optimizing for the trivial stuff and making the complicated stuff potentially more confusing and harder to understand.
 This is unrelated to the PR, but I heavily disagree.

No, again, declarative does not mean no logic. It completely makes sense to declaratively define behavior and functionality. Components can define behavior and logic, and that's what makes them useful. Does that mean we should get rid of `<a-entity sound="on: ...">`? That's logic. Should we get rid of controls? That's functionality.

It's not logic into HTML. The logic is encapsulated. It does not scatter it, but it encapsulates it into reusable pieces. If you put game/application logic into raw JS, then you no longer have control over its execution. Hell, it makes it easier to follow. Because it's defined right on the entity rather than in a bundle of ugly JS somewhere.

It's not about making it "trivial". It's about making it reusable.
 the logic of controls is not expressed in the component. The component API just configures that logic/behavior. Sounds logic is to play a sound when an event is emitted. The API let's you define the name of that event, and that's all. It's not expressing any logic. `If this happens do this` That's logic and it's what you propose that it's different.
 No, it's not easier to follow once things get complicated. It only works in toy examples. You will have to use JS in any non trivial application and then it will get confusing. Adding logic in declarative contexts has been tried many times and ends up being messy (angular I'm looking at you)
 How is "play a sound when X event is emitted" any different from "change this property when X event is emitted"?  What if I just want to make something red when it's clicked on, collided, or hovered? That's pretty much an analog to CSS which declarative.
 `play a sound when an event is emitted` is expresed in JS. Not in the markup
 `change this property when X event is emitted` is also expressed in JS. It's encapsulated within the component.
 Well. Ignore the declarative event example. There's controversy there. The other example just sets random property values, that doesn't contain logic. How could we define possibly multiple components of the same type?

The only way I can think of is create a DSL that's up to the dev, which might be hard to manage.

`<a-entity randomizer="property: material.color | property: position | property: scale; min: 1 1 1">`
 CSS pseudo only changes the visual aspect of your UI. They don't interfere in how the application operates. Our components do much more than visual aspect.
 Our components do much more than visual aspects, but shouldn't contain logic?
 OK. I think I will go down the DSL path and custom parsers path.

I think the component arguments will solve themselves as we build more demos. Good thing we have permissionless innovation.
  How does it compare to other WebGL content? Have you done your test with any three.js demo?
 Interactive WebGL applications are demanding and the browser adds overhead on top of that. There's indeed room for improvement on the browsers side. I'm going to close this since this is not an aframe specific issue. It would better to file it against Firefox or Chrome :)
  I think option 1 is more readable.

We do have a `transforms` attribute though that does what the second case you're talking about, though it might need some discussion/expansion.
  **Description:**

Details at https://github.com/ngokevin/aframe-template-component

**Changes proposed:**
- Move template component to core.
 I'm not sure that the template should be part of the core. 
 Maybe not. Though it's immensely useful. I use it in most my scenes, and we have a lot of examples that could be cleaned up with it. It's a useful testbed for testing dynamically injected entities, mixins, and animations. And there's potential for enabling sharing of reusable snippets/templates.

With that, what do you propose?
- Put it in the examples folder, like three.js .
- Put it in the `extras/` folder, which is seeming like a place where we shove stuff that we're unsure about it.
- Keep it separate, and promote it elsewhere. 
- `aframe-extras` bundle?
 It's opinionated. I would not pollute the examples with those opinions. They should be as vanilla as possible even if they are a bit uglier. 
 I think this should be out of the core and stay as a third party thing.
 Shader toy is my personal bet for the future and something I think will become increasingly important. Being able to create completely procedural scenes (with no geometries) is something I want a-frame to support out of the box to give a chance for people to discover and serendipitously stumble on it.
 I deleted my comment because I was still mulling over it. A lot of the code was Shader Toy agnostic, but I would keep Shader Toy-specific things (if any) out of it if we're going to keep things unopinionated. I'm gonna move discussion there.
 Shader toy is just an extra shader it does not change the perception what a-frame is about. Writing the examples using a template engine obscures the a-frame core message. Is it a template engine? Entity component? declarative 3D DOM? All of the above?
 I think the core message is declarative ECS, which **enables** all of the above. I do think it is immensely useful to reuse chunks of HTML; I use it in every scene. But whether it's part of the core, or part of a component, I still have the ability to do so.

Later, we will promote third-party components more on the homepage, and support lazy-loading from a registry of components. So the lines of what ships with A-Frame and what's third-party will blur.
 It would be indeed useful to showcase examples of aframe using whatever template engine, d3, react... but making explicit that those are AFRAME + something else that it's not aframe. We could have a section in aframe.io examples that points to those demos.
  You cannot use images or videos as textures that are hosted in a different domain than your project unless the third party serves its content using CORS headers:

https://aframe.io/faq/#Why-does-my-asset-e-g-image-video-model-not-loading

The way to play youtube on a third party site is via their embed player that uses an iframe. You cannot use an iframe as a texture in webgl:

https://aframe.io/faq/#How-do-I-display-lt-iframe-gt-s-or-render-HTML-in-A-Frame

Please use Stack Overflow with the aframe tag for questions:

http://stackoverflow.com/questions/tagged/aframe
 Yes, you are adding an iframe that runs the embeded youtube player. The video indeed plays but it cannot be rendered as a texture within webgl. This is why you hear it but not see it.
 No, I don't think so unless Youtube decides to distribute its content with CORS headers. This is unlikely since they would lose control on the kind of advertisements they can insert in their videos. 
 If they use CORS headers, yes. For the Youtube case you have to download the video and host it in your CDN but this will go against their terms of service.
  Nope. But I encourage you to try to do it in a separate project or component :)
 I mean it wouldn't be a core part of A-Frame.
  Do you mean AR, or VR? Also that isn't A-Frame, so it seems this issue doesn't belong in this repo.

You could just do `<a-box ...><a-animation .../></a-box>` if you want to do that in A-Frame.
  **Description:** 

If value specified by the texture/map property type is a selector to an img/video, then don't do `getAttribute`, just return the `<img>` or `<video>`. That way the texture system won't have to create a new img/video element and do duplicate loading.
 @fernandojsg What do you think about the name `texture` vs. `map`?

`texture` is possibly more intuitive to A-Frame developers. `map` is technically more accurate.

If we use `texture`, would it be odd to have `{heightMap: {type: 'texture'}}`?
 Also `three.js` refers to them as `t` for texture uniforms (sampler2D), might want to match that. Even though it uses `map` for material properties.
 I use to prefer `map` over `texture`, maybe for a simple diffuse texture/map they could be used the same way, but when you talk about `normal map`, `envmap`, `bump map`, and so on, I believe it's more accurate and coherent as you'll find more references both in libraries, engines, and 3d programs.
 This has been done. `asset` property type returns `<img>`/`<video>`/`<canvas>` down.  **Description:** 

For true VR experiences, standard cursor should be mouse cursor like http://threejs.org/examples/webgl_interactive_draggablecubes.html

The current cursor component is meant more for Cardboard, which many of us don't want to be the primary VR experience.

@mayognaise's mouse cursor component is pretty inline with this. You move the mouse cursor, and it will project raycaster depending on the coordinate on the canvas. To look around, you use the HMD. 

There should be pointer lock upon entering VR mode so that we can create custom cursor appearances.

Should bounce off the raycaster component. Just like the current Cardboard cursor does.

Recent raycaster work https://github.com/aframevr/aframe/pull/1196 was a stepping stone to exactly this.
 Would be awesome if @mayognaise could tackle this. Else it'll be until I get around to it.
 @ngokevin okay ill work on it :)
 We'll keep it separate for now, and solve with component consumption story next cycle.
  @cvan Does this look good to you?
 @mkeblx Can you squash your commits?
 Just tested out GitHub squash merging. What's our opinion on that?
 I wanted @cvan feedback. I'm not sure this should have landed. We have no support for WebVR 1.0 in a-frame yet. I believe the value of hasNonPolyfillWebVRSupport is not correct after this patch.
 My bad, for some reason I thought the second comment was cvan's.
 I'm actually working on this in #1132... but thanks.
 @cvan this PR has been merged. Are you ok with this change or do you want to handle it differently?
 No, it's fine. But have to change a few other things. Finishing up my PR as we speak. 
  **Description:** `repeat` property from from material can't be used dynamically as once the `src` map is loaded, the texture won't be recreated based on a new `repeat` value.
  You can do `sceneEl.addEventListener('render-target-loaded')` or `render-started`

Maybe we should just rename that to `canvas-loaded`.
 Yeah, there're lot of ways to do that. I don't really have a recommended way of doing that yet.
 That isn't really public API. So what is the use case for forcing an update? Currently, `update` is called when the component's data changes. When would you need to call `update` when the component data has not changed? You can use `tick` to update in the background if that works, or use events.
 OK, you should use the event listeners for when the canvas is loaded or resize. From within the component.
 https://github.com/aframevr/aframe/blob/master/src/components/look-controls.js#L77
 Because you shouldn't have to force updates outside of the component. It should be handled by the component.
  lgtm, we'd file a follow-up issue on that obj-model dep bug. can you squash?
  **Description:**

This works as expected:

``` js
<a-plane width="12.5" height="20" position="0 0.1 0" pivot="0 0 10"
               color="#21897C" rotation="-90 0 0">
  <a-animation attribute="scale" from="1 1 0" to="1 1 1" easing="ease-out" begin="600"
                        dur="1000" fill="both"></a-animation>
</a-plane>
```

This does not:

``` js
<a-plane width="12.5" height="20" position="0 0.1 0" pivot="0 0 10"
               color="#21897C" rotation="-90 0 0" from="1 1 0">
  <a-animation attribute="scale" to="1 1 1" easing="ease-out" begin="600"
                        dur="1000" fill="both"></a-animation>
</a-plane>
```
- A-Frame Version: master
 We've deprecated a-animation. Try https://github.com/ngokevin/kframe/tree/master/components/animation and file issues, and component will be merged in in the future.

The component will take the current value if from not specified  **Description:** Open scene on iPhone 6 with Safari, click on the Goggles. The scene renders, but it won't split into stereo mode.
- A-Frame Version: master
- Platform/Device: iphone 6 safari
 cvan is on this . https://github.com/aframevr/aframe/pull/1132 will help
 Should be fixed by now 
  Thanks for filing.

Might have to do with the scale? I tried shrinking the map to 10x10 and moved the camera to z=5, and it looks better.
 Increase camera.far   Fixed by #1366. Thanks, @dbradleyfl!
  **Description:** We could reduce the number of requestAnimationFrame if we implement THREE.VideoTexture ourselves using `tick`. Here is the source of three.js `VideoTexture`

``` js
THREE.VideoTexture = function ( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {

  THREE.Texture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );

  this.generateMipmaps = false;

  var scope = this;

  function update() {

    requestAnimationFrame( update );

    if ( video.readyState === video.HAVE_ENOUGH_DATA ) {

      scope.needsUpdate = true;

    }

  }

  update();

};

THREE.VideoTexture.prototype = Object.create( THREE.Texture.prototype );
THREE.VideoTexture.prototype.constructor = THREE.VideoTexture;
```
  I also have a json loader in one of my side repos. I was thinking of creating a repo for all the loader components
 I have it at https://github.com/ngokevin/respecular/blob/master/assets/components/json-model.js

Might do: https://github.com/aframevr/aframe/issues/1342 since there are so many loaders
 Ok, yeah I think we can close this in favor of gltf.  https://github.com/aframevr/aframe/pull/1339 will fix it
  Can we add a test for this?
 Should we add a test that tests the whole animation grabbing the correct `from` value if using dot notation?
 OK, that's fine. I'd emphasize that in the docstring more `getComputedAttribute that supports dot notation to look up a component property.`
 Did you see my comment about adding a more integrated test?
 I know it's a pain the ass (I'm going through this myself now) but we need to isolate the problem. @JohnRodney  Does the failure go away if you comment your test out?
 Got the tests working https://github.com/aframevr/aframe/pull/1349

I think the problem is you are creating a scene outside of the setup/teardown. We have global setup methods that expect the scene to be created in a setup handler.
 You can apply this diff https://github.com/aframevr/aframe/pull/1349/commits/5bfc71ae63bdb2fdaaca90daf11de5129862bd96
 @JohnRodney What's left to do here?
 I can volunteer to pick this up.
 @JohnRodney I have restarted the travis build. It seems you need to be an admin of the repo to do it.
 Almost there. Just one more style change.
 Nice. Thanks for the patience :)
  **Description:**

Document in the `obj-model` component docs that if an MTL isn't working and you don't see your texture applied correctly, you have to dig into the MTL file to check out that all the paths are correct and that all related assets are where they should be.
 There is a [3D Models ‚Ä¢ Troubleshooting](https://aframe.io/docs/0.5.0/introduction/models.html#troubleshooting) section in the documentation now; I think this issue can be closed if we just add a link from the `obj-model` docs.

That said, please feel free to improve these docs with PRs! :)  **Description:** For primitives, we specify a set of default components in the primitive definition. These are named defaultAttributes, but it would be more correct to call them defaultComponents. A simple grep job.
 OK. If possible, we could deprecate `defaultAttributes` for one version. So `defaultAttributes` still work, but everything is renamed to `defaultComponents`. If we detect `defaultAttributes`, just set `defaultComponents` to `defaultAttributes`.
  Sounds awesome. Could you publish an example so we could try it out? As a separate component would be cool so people can try it out in the meantime while waiting for possible merge + release.
 It's not a priority at the moment. @intensr Can you describe your use case?   I did some investigation, and it appears that the primitive attributes (e.g., `src`) aren't taking into account previous component attribute values (e.g., `material`).

Obviously because the primitive attributes break entity-component pattern, it can get confusing combining attributes like `material` and `src` - because you have to merge the existing properties of `material` with the properties that will change from modifying `src`. I didn't check, but I'd assume the same issues occur with mixins with component attributes.
 Mixins are fine.
  Yeah, maybe let's include that as a start for embedded/inline scenes? That's one of our goals:

like: `boilerplate-embedded-scenes`
 @enjalot this is almost ready - let us know when you've made the minor changes above. thanks! :smile: 
 Patch looks good. Still a bit of work to go for better support for embedded scenes, but this is a big step:

<img width="1440" alt="screen shot 2016-04-15 at 12 18 57 pm" src="https://cloud.githubusercontent.com/assets/674727/14572543/42b987ba-0304-11e6-9696-e61fbb3971e4.png">

@dmarcos look good?
 @enjalot Thanks!
 nice!

@dmarcos for future, you can use the github squash merge, the green button has a dropdown now
 @ngokevin I know the button but I don't always check that there's a single commit on the PR.
  Thanks!
  @FintanK Can you squash your commits?
  Thanks!
  Thanks!
  **Description:** Stringification to DOM, and using the DOM to fetch data is one of the bottlenecks in perf.

We only want to stringify to DOM if the DOM inspector is open (still want to debounce that) or a flag is set. This may affect integration with other libraries, in which case the flag can be turned on.
 @bnolan look at https://github.com/aframevr/aframe/pull/1323
  **Description:** The default radius is currently 5000, which is huge (5000 meters to scale). A single sky alone creates 8K faces and 24K vertices. Maybe a better default would be 50 to 100. 
- A-Frame Version: master
  @dmarcos This looks pretty good. He made it not explicitly check for color, just let it fall through the if/else statements, saving about probably 50 LOC. I think even if we add more interpolation types, this should still hold. 
 Tested, works on both ECS box and primitive-style box:

![box](https://cloud.githubusercontent.com/assets/674727/14259829/9a793a72-fa5d-11e5-8bf3-da28b491b93e.gif)

![cube](https://cloud.githubusercontent.com/assets/674727/14259832/9b578b42-fa5d-11e5-8a04-ea045a6736c8.gif)

(In that, I discovered an issue that is not related to this PR: https://github.com/aframevr/aframe/issues/1334)
 I think we're ready to squash, and @dmarcos to sign off.
 Yeah that'd be great. An `test-animations-color` example would be cool too.
 We need to organize/rename the examples. But `test-` examples, to me, are examples that you check to make sure a particular feature works. They all have stats enabled on the scene at the moment so we can check mobile stats, but we could re-eval that.
 woo! this is awesome! :tada: 
 Thanks, hope you're better!
 @JohnRodney Is there any work left here?
 @JohnRodney Thanks! I hope the sun shines soon over there.
 OK, that should be the last of it!
 Awesome! I'll merge this once I get to the office.
 Thanks so much!!! That was a long process, but everything works, and your example is pretty cool and running at 60fps  :)
  You press the physical back button on your Android. I have a branch that updates to use the latest webvr-polyfill which now features a graphical back button on mobile in the top-left corner (used to be part of the webvr-boilerplate). There have been a few iOS bugs in the latest webvr-polyfill version so we've been holding off on updating: borismus/webvr-polyfill#46 and borismus/webvr-polyfill#57 Will be updating soon though, so stay tuned.
 > How can I add another back button to go back to other screen then if the back button is for switching between normal and vr mode?

what do you mean "other screen"? on Android devices, pressing the physical back button will exit Fullscreen; pressing the physical back button twice will take you back in history in the browser. on iOS, since there there is no Fullscreen API, when you rotate from landscape to portrait we let you exit VR mode.

clicking on webvr-polyfill's back button icon exits Fullscreen on Android but doesn't do anything on iOS. it should exit pseudo-fullscreen/VR mode on iOS. I'll have to open a PR for it to do that.
 wontfix, just use browser/physical back button or navigate somewhere else  Thanks for filing. I have a branch that updates to use the latest webvr-polyfill. There have been a few iOS bugs in the latest webvr-polyfill version so we've been holding off on updating: borismus/webvr-polyfill#46 and borismus/webvr-polyfill#57 Will be updating soon though, so stay tuned.
 Distortion is provided by the `webvr-polyfill`.  @cvan Can we close this as an aframe issue?
 > Any luck on this? Can we use the WebVRConfig json to add more buffer and add more referesh rate? the video is a bit slow, does it support stereoscopic spherical videos?

You can set it yourself before you include `aframe.js`:

``` html
  ‚Ä¶
  <head>
    ‚Ä¶
    <script>window.WebVRConfig = { ‚Ä¶ };</script>
    <script src="aframe.js"></script>
  </head>
  ‚Ä¶
```

and we'll respect the config values set on `window.WebVRConfig`.
 Should look at @borismus' https://github.com/borismus/webvr-polyfill#configuration
 > @cvan Hi Chris, am I right in reading that the latest WebVR polyfill contains the code for lens distortion and device configuration for different cardboard headsets? Do you know when aframe will update to the latest version or which branch we can get a preview from? Thanks for the help!

yes, it does. per [my comment above](https://github.com/aframevr/aframe/issues/1295#issuecomment-223476637), just set this:

``` html
  ‚Ä¶
  <head>
    ‚Ä¶
    <script>window.WebVRConfig = {CARDBOARD_UI_DISABLED: false};</script>
    <script src="aframe.js"></script>
  </head>
  ‚Ä¶
```
  Is this still relevant?  We use `THREE.OBJLoader` so it might be an issue with that: http://threejs.org/docs/#Reference/Loaders/OBJLoader
 If that's the case, I'd like to make a pull request to three.js to fix that. I'll do this.
   Note that they are percentages.
 Looks like the scene resizing is overwriting it
  thanks!
  very good catch. I updated the CodePen pen. thanks!
  Do the changes require Three r75? If not we should update three in a different PR since they're unrelated changes.
 The changes should be required for r75
 Need to update the docs about `scaleHeight`
 @ngokevin @cvan is there any reason to **not update** to Three r75?
 I tested every scene in the Examples, and everything looks perfect. good work. thanks!
 thanks!
  This can be application behavior. Use a video element in `<a-assets>`, listen to its events, and show an image texture on an entity in the meantime I'd like to work on this. Especially when videos take a while to load (which is pretty much always), having a black screen while the video loads (or having to manually apply an image texture yourself), it's just not ideal default behaviour.

The HTML5 `<video>` tag already supports the [`poster` attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attr-poster) (not just used on default HTML5 players, but it's used by YouTube/Vimeo players too).

So, like you have `<video poster="poster.png" src="poster.mp4">`, A-Frame devs could just similarly do `<a-videosphere poster="poster.png" src="poster.mp4">`.

Would be fantastic! This can be handled application level. Show image, when video ready, toggle the visible.  Almost there! It just needs a small change on the test.
 Can you update the docs as well?
 Nice! Thank you for keeping at it
  I believe this has been fixed. Thanks!
  Thanks!
  For `<a-obj-model>`, the `url()` wrapping should be done at https://github.com/aframevr/aframe/blob/master/src/extras/primitives/primitives/a-obj-model.js#L11 , maybe something wrong with the extend order.
 As a workaround, try defining it like https://github.com/aframevr/aframe/blob/master/docs/primitives/a-obj-model.md#example
 Found this issue, fixing
 @afvc the [Models ‚Üí Troubleshooting](https://aframe.io/docs/0.6.0/introduction/models.html#troubleshooting) section here is probably what you're looking for. In the `.mtl` file, you need to make sure that the textures are not stored as `C:\\Path\To\texture.png` or `/Path/To/texture.png`, but instead as `texture.png` or `images/texture.png`, based on where the image is relative to the `.mtl` file itself. I'm seeing a fair bit in that scene, including some textures. If there's a particular texture you can't get working, it might be best to write a question on Stack Overflow, tagged with "aframe", and point out the specific problem there. In Chrome, I see this:

![screen shot 2017-07-03 at 9 21 34 am](https://user-images.githubusercontent.com/1848368/27801083-09f7d0d2-5fd1-11e7-866f-83511ba52e01.png)
 Hm I have no idea. :/ 

What device and browser are you using? And, any information in the JavaScript console?  @donmccurdy Is this still relevant? We want to focus efforts on `glTF`? Yeah, ok to close this I think.  Gonna consolidate my ideas here:
- Maybe controls components need their own registration API and prototype? `AFRAME.registerControls` :white_check_mark: 
- Could probably rename `universal-controls` to just `controls`. :white_check_mark: 
- <strike>Perhaps all registered controls include universal-controls as a dependency so it doesn't need to be explicitly attached.</strike>
- Might be good opportunity to utilize/expand the new `Systems` API (global scope/services). A controls system might have controls register their elements, and it might consolidate all updates to one tick. :white_check_mark: 
- <strike>Might want a `default-control-scheme` component that just sets all the control components appropriately</strike>

Summary:
- `<a-entity camera controls="rotation: custom-controls hmd-controls gamepad-controls mouse-controls; position: hmd-controls wasd-controls" mouse-controls="pointerLock: true">`: Controls component defines precedence though it will have default configuration if not specified. Controls can be configured within the individual components. :white_check_mark: 
- rotation/position controls can be registered with `AFRAME.registerControls` which they can define active/delta/getters :white_check_mark: 

Example `registerControls` API:

``` js
/**
 * registerControls automatically detects whether it modifies position, rotation, or both.
 * It will categorize it inside the `controls` system.
 * The `controls` component uses the `controls` system to know which controls are available.
 */
AFRAME.registerControls('airplane', {
  isVelocityActive: function () {},
  getVelocityDelta: function () {},
  getVelocity: function () {},
  isRotationActive: function () {},
  getRotationDelta: function () {},
  getRotation: function () {}
});
```
 I think `position` makes sense over `movement` to keep the mapping. Just as `rotation` modifies `rotation`, `position` modifies `position`. It also maps well to terms like "positional tracking".
 I love that this controls system will automatically disable pointerlock/mousedrag/gamepad when an HMD is connected.
 I would keep `mouse-controls` together for now and re-evaluate later. It is nicer for code to split them up, though if someone wants to use pointer-lock over mousedrag, they would have to redefine the whole controls rotation order, rather than just flipping a flag.
 Nice, how much do you got left before you think it's ready for full line-by-line review phase?
 There's also docs if you want to handle that as well, else I could pitch in.
 - Also need to update all examples to use the new controls.
- Need to update the default camera configuration in `systems/camera.js`.
 Found an edge case where updating `mouse-controls.pointerlockEnabled` to `true` in the DOM inspector instantly crashes Firefox
 @donmccurdy go ahead with the docs and the unit tests
 Nice on the docs. Yeah, good to keep it simple and in one page for now.

We're probably going to split up the geometry component documentation later, so we might do it with the controls to be consistent and give it its own little section. But later.
 Thanks, will test positional tracking tomorrow.
1. What's the context?
2. That seems okay to me. We can always change it later if we come up with API verbiage.
 Should we insert `enabled: {default: true}` into the schema automatically and have it work out of the box? Then you wrap every `is*Active` and automatically return depending on `data.enabled`.
 **Testing:**

Haven't testing positional tracking yet because I left my camera in SF...

## keyboard + mousedrag

![keyboard-mousedrag](https://cloud.githubusercontent.com/assets/674727/14722882/dbbc5c0e-07c2-11e6-9350-a1af34d5bf61.gif)

## keyboard + hmd

![hmd](https://cloud.githubusercontent.com/assets/674727/14722976/78275706-07c3-11e6-99c8-41a2667f4f5d.gif)

## mobile

![done](https://cloud.githubusercontent.com/assets/674727/14724613/2ee80d20-07cc-11e6-8438-ef3d18f51b70.gif)
 I get an `component/control not registered` error when I try my custom component alongside a standard one:

``` html
<a-entity camera
          controls="position: hmd-controls; rotation: comfort-turn-keyboard-controls mouse-controls"></a-entity>
```
 I'm trying it out here: https://github.com/ngokevin/aframe-comfort-turn-controls/blob/master/index.js#L123

Couldn't get the `getRotationDelta` to get called. Will try more tmr.
 @dmarcos A couple of questions about strong changes to the direction the project we'd like your input on.
 @dmarcos and I talked.

Going to keep `keyboard-controls` around as a placeholder to ease into new locomotion. But the compromise for VR is that we remove it from the default camera, and have it go in "steps" rather than continuous motion. We can add the step/teleportation in later, but I imagine it wouldn't use the velocity API.
 By steps kevin meant that instead of continuous movement like wasd-controls do now we would move on discrete steps. You teleport 1 unit forward each time you press 'W'. The step should be configurable. There's no acceration or easing that can cause motion sickness
 This might complicate things, but perhaps we need `getPosition`. For HMD positional tracking, I don't think we want velocity controlling the position because the position should always absolute. When I move the camera up above the tracking volume, there's some leftover velocity that keeps moving the camera up and up even though the HMD is no longer moving.
 OK, I found my comfort turn snap controls aren't working because both my controls and the HMD controls use `getRotation` so the HMD controls are overwriting changes from my controls.
- Comfort Turn changes rotation by 15 degrees from the current rotation using `getRotation` on keyboard press.
- HMD is active again and sets its absolute rotation using `getRotation`, overwriting comfort turn.
 OK. Let's try `getPosition` that calculates velocity under the hood. And make rotation absolute (though if you didn't want it absolute, how would you do it?).

The main use cases for the controls component I think is:
- HMD - has to be absolute and exact. any controls changing the rotation would probably not want easing
- Vive controllers - has to be absolute and exact. but will still want to calculate velocity and angular velocity data and case you want to hit stuff
- But will still have to support flat experience controls? (drag-look, wasd for now, which we may want to snap by default as well)

Do we replace velocity with position, or do we add getPosition? That sort of solves the issue from earlier with rotation mapping to rotation but position mapping to velocity.
 OK, comfort turn controls work for me now.

Let's publish touch controls separately as well for reasons discussed above (recommendations on movement in VR, reserve for interaction, less code to maintain/test for us).

I'll have to wait until next week to get access to a headset, I'm abroad atm :(
 Disregard my deleted comments, I think I needed to restart my server.
 OK, I think most stuff works. We're going to land the new WebVR API soon so the hmd-controls might need changing in a bit. @dmarcos will update the current look-controls so we'd port those changes over.
 Got your rift? WOOT!
 @dmarcos just landed the WebVR 1.0 API changes. Just need to port his changes from the old look-controls. 
 Changes to look-controls at https://github.com/aframevr/aframe/pull/1423/files#diff-6285039eee70ed830f70f7d2f7b7dfa5R33 

Gonna test this out and see what needs changing.
 I think in the context of the controls component, makes sense to be just `positionEnabled` and `rotationEnabled`. Only for `<a-camera>` does it need to be explicit.
 OK, I tested this with Vive + Oculus. Mostly works, but compared to `master`, it is jankier. Any ideas why? Maybe something around the velocity stuff.

I see that we have a `getPositionDelta` now. For controllers + HMD, should we just make `getPosition`? Those don't really care about the velocity, we just want to set absolute pose, right?

Right now, what's the flow for updating the position? Is it:
- Get new position
- Get delta using old position
- Use delta to calculate velocity
- Have velocity set position
 Not sure about having velocity update the position of the HMD. If you lose tracking, the velocity will just keep going, right? The tracking needs to be on point, velocity introduces some unpredictability with that.

Hmm, I'll have to think about the absolute vs. relative position. 

Yeah, no easing for tracked inputs. I'm not sure how that will play for flat experiences. Will need to think more on that also. For teleporting, you can use a wrapper entity.
 The post-processing PR adds support for tick/tock. So you could put controls before position. I'll try to see if that helps.
 I think a phase or order is starting to sound good. That's what the PP PR did at first... Will think about that.
 Would the next step for this be to decouple the controls from the velocity, and for physics we can have velocity be inferred based on changes to position?
 Not sure. I tested it by turning my head around quickly a lot, but maybe caused by subtle changes in position?

Are there any disadvantages of pulling out velocity?
 Looks like velocity wasn't the issue, still getting some lag. Have you tried testing the PR vs. master? I usually test on the geometry gallery scene.

On the Chromium builds (WebVR API 1.0), master is smooth, and the PR has some slight jank when turning head.

On Firefox Nightly (old WebVR API), master is smooth, and the PR stutters a lot when turning head.
 Awesome, everything looks good so far. Looks amazingly smooth on CV1. The Vive looks good so far, I'll have to side-by-side compare it to master more.

In the component property, I would rename rotationControlsEnabled/positionControlsEnabled to just rotationEnabled/positionEnabled. To be consistent and less redundant within the context.
 @dmarcos This seems ready for review after passing manual regression testing.

Note that we disabled `keyboard-controls` by default. Perhaps let's enable `keyboard-controls` by default again, but perhaps put it before `hmd-controls` in terms of precedence. This allows flat experiences to move around, but dissuades against using it for VR. Either way, this will be a change, what do you prefer?
 Yeah, I think we can have touch-drag back, but only if it doesn't affect tapping.
 @ngokevin about adding `keyboard-controls` before `hmd-controls`, what's the effect? Keyboard controls aren't active unless a key is down, so I don't follow how/if that would dissuade their use in VR (although I agree with the goal).
 I've added TODOs in the original comment for those last two items (resolving conflicts with #1474, and adding `touch-controls`).

Before I do that though, @dmarcos, do you have concerns with merging this into core, or is it just a matter of doing a full review? I'm really just playing catch-up-and-rebase at this point, and I see you have incoming changes to `look-controls`.. Fine with me if this should be separate, or put into an `aframevr/aframe-controls` repo or something, but let's make that decision with v0.3.0 coming up. Thanks!
 Let's look at this first thing post 0.3.0. This is a big change and I'm worried about rushing it.
 I'm currently writing integration unit tests for controls to cover all the cases, protect from regressions, and since there's currently no coverage. Combined with your unit tests, that should make getting this large change through easier once we get to it.
 @ngokevin sounds good! I'm traveling until Monday so I'll be slow on replies, but will try to take a look at those integration tests.
 I think we'll close this for now due to age and amount of work. What A-Frame has now can be considered a sensible default geared for WebVR, and other control schemes are welcome as community plugins. Both thanks and sorry for the amount of work on this. Could perhaps revisit later on?

Though I think perhaps we could take the Pointer Lock pieces and hook it up to full screen mode for A-Frame if you don't have a headset. Makes sense to me, no problem. There are also enough open questions about encapsulating a 'player' and keeping arbitrary controller components aligned with teleporting, that maybe it's better to come at any controls changes from the direction of roomscale, rather than touch/gamepad/keyboard as done here. (Referring to #2265)  Thanks! Can you do segmentsPhi as well?
 Aye, good catch.
 Future ref, you can append commit message with `(fixes #ISSUENUMBER)` so that issue auto closes on merge
 @ngokevin as I discovered, it'll auto-close the issue only if the author is added as a ["Collaborator"](https://github.com/aframevr/aframe/settings/collaboration) to the project. I wish GitHub did that automatically.
 As long as it's in the PR message when one of us merges it, it'll close.
  Thanks!
  Nice! Can you squash your commits?
 What happened to this?
 You don't have to close it. Just force-push to the branch and the pull request will update. I guess now you can just re-open or open a new one.
  Thanks!
  **Description:**

If a user has **Portrait Orientation Lock** ¬π enabled (like any sane user does such as myself), we should tell the user. The first time we added this back in November/December, I was confused initially because nothing happened when I rotated my phone from portrait to landscape. I just kept seeing "Insert phone into Cardboard holder." Then, doy! I realised I had portrait orientation lock on, and since we only hide that message when an `orientationchange` event fires (which never would with portrait orientation lock on), nothing happened. FWIW, the **[webvr-polyfill](https://github.com/borismus/webvr-polyfill)** has the same problem.

Also, FWIW, I know I'm not alone. I've seen two other people encounter the same problem as I did. I do realise not everyone has portrait orientation lock on, but let's give a good experience. Otherwise, folks will just leave the site if it seems broken.

Anyway, we can easily solve the potential user confusion in this case. Using `deviceorientation` events, if we detect the user turned the phone landscape on iOS (or any mobile browser where the Fullscreen API is not supported) but no `orientationchange` event has fired, then let's add a small message below `Insert phone into Cardboard holder` that says `Disable Portrait Orientation Lock`.

‚Äì‚Äì
 ¬π
<img src="https://cloud.githubusercontent.com/assets/203725/13979039/d522f642-f092-11e5-8a13-72e8af50f7ee.png" alt="Portrait Orientation Lock on iOS 9" width="250">

<hr>
- A-Frame Version: `0.1.2`, `master`
- Platform/Device: iOS/Android
 This gets me every time! This is technically a bug of the webvr-polyfill. We ought to fix it there.
  **Description:**

WebKit does not support the Fullscreen API. In Safari for iOS, fullscreen can be emulated using `<meta name="apple-mobile-web-app-capable" content="yes">` (which A-Frame already injects if `meta[name="apple-mobile-web-app-capable"]` doesn't already exist on the page).

Chrome and Firefox for iOS unfortunately do not support such a method of pseudo-fullscreen. In both browsers though, as you scroll down on a page, the chrome navbar disappears. But because we are `preventDefault`-ing on `touchmove` on the `canvas` and the `html` has `position: fixed` styles, this doesn't work. I have a WIP branch that sets iOS-only styles that adds a bunch of `padding-bottom` to the `html` element and then when the user swipes down, it works.

Calling `window.scrollTo` or setting `document.body.scrollTop` doesn't seem to work. I'll have to investigate that some more though. That'd be the "ideal hack."
 As stated above, Firefox for iOS (like Chrome for iOS) hides the chrome nav bar when a user scrolls down the page. Safari for iOS hides the chrome nav bar in landscape if `<meta name="apple-mobile-web-app-capable" content="yes">` exists on the page. We should get Firefox for iOS to do the same pseudo-fullscreen behaviour if `<meta name="mobile-web-app-capable" content="yes">` exists on the page (which is what Chrome 32-39 used before using the W3C manifest: https://developer.chrome.com/multidevice/android/installtohomescreen#fallback).

We should file a bug for Firefox for iOS to do this.
 This issue can be fixed in A-Frame's dependency, [`webvr-polyfill`](https://github.com/googlevr/webvr-polyfill). When this issue is properly addressed and fixed, this will also be fixed in A-Frame too: googlevr/webvr-polyfill#114 @MagicIndustries you can do "Add to Homescreen" on iOS. Do you have a URL of your site andcau explain the user flow and what you're expecting vs. encountering. On a related note, have you seen these comments?

* https://github.com/aframevr/aframe/issues/316#issuecomment-209147896
* https://github.com/aframevr/aframe/issues/316#issuecomment-212608703
* https://github.com/aframevr/aframe/issues/316#issuecomment-219181039
  **Description:** Everything in the examples directory is under one level, though we have multiple categories. We have asset folders prefixed with underscores in this directory as well. We should:
- Put all examples under one more directory respective to their category. For example, `examples/showcase-composite` would become `examples/showcase/composite`.
- Move all assets under the directory of their respective example. For example, `ui/1.png` should move to `examples/showcase/curved-mockups` since it is being used in that example only. This helps keep track of which asset belongs to which example, and if an example is removed, then it ensures the related assets are as well.
- Optionally, very commonly-used assets (at least three uses) live in an `examples/assets` folder.
- A-Frame Version: master
 @BhasinParth go ahead!
 @BhasinParth What's the problem exactly? You should move the images under the directory of each example unless they're shared by multiple of them.
 @BhasinParth you have to open a Pull Request against the master branch. https://help.github.com/articles/using-pull-requests/
 Going to work on this.
 #1394 
  **Description:** It is a common pattern to add event listeners in `play()` and remove them in `pause()`, but it is a lot of work to do for each component, and it ends up not being done at all. Perhaps have a utility that automatically does this. Like:

``` js
// Listener is only added on `play()` or if `isPlaying`.
// When `pause()`, the listener is automatically detached.
// If this is not desired, then one can still use native addEventListener.
Component.addEventListener(element, eventName, handler);
```
- A-Frame Version: master
- Platform/Device: all
  @cvan Anything in the top of your mind?
 I haven't changed anything here yet. I am in #1132 but haven't touched it. I will investigate though.
 Investigated this a bit and figured out a solution. A slight regression occurred (I think when the code was moved to a component): On iOS, the orientation modal doesn't appear until you rotate to landscape then rotate to portrait again. If the device is in portrait mode when VR mode is entered, the orientation modal doesn't show up. (In A-Frame 0.1.2, this works as expected.)

On Android, the orientation modal never shows up. There's an explicit check for only iOS; that's because it's assumed that iOS is the only mobile platform where the Fullscreen API isn't supported. This is mostly true (except Windows phone; I know, not a big deal here). Anyway, I have a fix for this too.
 FWIW, it was working 2 weeks ago https://github.com/aframevr/aframe/pull/1111
 From what I found, it works only when you rotate to landscape immediately after entering VR mode then go back to portrait. Anyway, not sure which commit caused it; I didn't bother bisecting. But I've got a fix on the way, and it addresses a few other edge cases. And a few others, but I'm going to open up separate PRs for those.
 Yeah, I think that's always been an issue. https://github.com/aframevr/aframe/issues/879
 > Yeah, I think that's always been an issue. #879

ah, well then this bug is a dupe
  You can control the HTML5 video element used to create the texture https://github.com/aframevr/aframe/blob/master/docs/components/material.md#video-textures ... e.g, `<video>.pause()`
  **Description:** Currently, child entities initialize before parent entities. The scene is the most-parent/root "entity". Thus, all entities initialize before the scene. This means that scene components aren't initialized when entities are initialized. This might cause components having to register listeners to the scene to do things such as retrieve the canvas. We should initialize scene components first (for now, all of them, until we see a use case to not do so).
- A-Frame Version: master
- Platform/Device: all
 Canvas initialization and other logic has moved from components to the scene itself. Not sure if this is still relevant. Should we close?  Probably keep using a-entity. Those aren't deprecated. a-camera and a-cursor are helpers and we'd rather have these examples not be testing that layer
 Thanks!
 a-camera and a-cursor are just aliases of a-entities + components. These test examples illustrate how to configure a camera and a cursor using components. If we use primitives / aliases we lose the learning value.
 @amberroy nice! thanks! can you squash your commits?
  Similarly, might also want to check if sound is already playing before playing
 In `tests/components/sound.test.js`, can we add a small test?:

``` js
suite('pause', function () {
  test('checks if playing before pausing', function () {
    var el = this.el;
    el.pause();
    el.pause();
  });
});
```
 I can add the test.
 @ngokevin You should let contributors handle that. PRs have to come with tests or they won't merge.
  **Description:** three.js r74 introduced intensity property on ambient light https://github.com/mrdoob/three.js/pull/7621 . Add that to the light component.
- A-Frame Version: master 
- Platform/Device: all
   Do you think this belongs as a standard shader? It could function well either on your GitHub with you maintaining it, or within an examples/ directory.
 I always think about making a-frame a more flexible alternative to shader toy that you can embed in any page. If the toy shader is part of the examples or a separate module the message gets diluted. 
 As cool as Shader Toy is, it seems not-very-core to be catering to one service or website as a standard module. It is a "toy" after all. I don't think it will dilute the message much as long as we showcase it well, and being able to lazy-load curated shaders will help too.

At the very least, we could move it to the `extras/` directory. 
 I also want a-frame to be an outreach tool for computer graphics knowledge among devs. The cost of shipping with it (50 lines) it's negligable compared to the potential upside. I think it's a delightful easter egg. 
 Easter egg would be a perfect reason to put it in `extras/`. I agree Shader Toy is a good community to tap into but not by bloating the core API. This is debatable, but the only upside I realistically see is bragging rights.

I'm worried about the focus here. We've had a good sense on keeping a clean API and thus reducing code we have to maintain. I've had one-LOC PRs rejected on this basis, let alone 50 LOC! I hope we can keep our focus on WebVR.
 it can be in extras if shipped with the build. the 50 loc don't increase API surface, they don't run if not used. And the shader can be used also to generate cool viz in VR mode. the potential if these techniques catch on is huge. The cost is totally worth it
 @cvan this is flagged as WIP. not worth going over nits at this stage
 @cvan this is flagged as WIP. not worth going over nits at this stage

just for your reference - you'll need to clean them up regardless
 Question, is any part of this PR actually ShaderToy specific? Or is it just inspired by ShaderToy?
 It's just inspired on. I want a mechanism that allows creating 100% procedural scenes a la Shader Toy.  An easy way to explore techniques like raymarching.
 OK, that makes me happier. If it was ShaderToy-specific, I'd have qualms.
 Might change to `shader: raymarch`
 It's not specific to raymarching. We can change the name of the shader to something else. The core idea is having a shader that allows you specify a scene entirely in a provided fragment shader. It gives a normalized set of uniforms like camera, time delta, mouse coordinates, controller position... That's what shader toy is about.
 In later evolutions we can create a declarative layer to compose the fragment that the shader uses. So people can easily share and consume shader chunks.
 I can see new and enhanced uniforms + allowing specifying shaders from HTML. Does that sum up the PR?
 Going to close due to inactivity / age. We can open this when it's ready again and have a fresh PR.
 i want to keep it open
 @blairmacintyre This just did not get prioritized but I'm more than happy to revisit if there's interest. What this does it's what you described. It adds some extra uniforms that shader toy has a standard API. As it is you can almost copy and paste shader toy shaders this is cool. did you still want to have this live in this repo? or want to move it to its own repo under the `aframevr` org? I'd r- this. Still don't think it's right to cater to a service; people can do in a custom component, or as one-off component. Squeezing into the material component doesn't work as well and more to maintain. In the end, raymarching is too expensive to work well in VR scenes anyways, and Shadertoys' would only work on flat planes. IMO this is best packaged as component which is the approach I took for Shaderfrog Closing this since it's outdated and I want to revisit in a different form.  **Description:** Improve overall cursor + raycaster components with respect to performance, configuration, and code quality. This is a stepping stone for more complex cursor/interactions later on.

**[DEMO](http://ngokevin.github.io/aframe/examples/test-raycaster/)**

**Changes proposed:**
- Don't use requestInterval which adds an additional requestAnimationFrame call. Work off of the existing tick handler.
- Generalize raycaster component for general use rather than just the cursor. Allow specifying the near, far, recursive. Thus decoupling raycaster and cursor, and having cursor be an abstraction of the raycaster.
- Raycaster origin/direction can be set with position/rotation of entities
- Allow passing in a list of entities (via selector) that the raycaster should intersect rather than intersecting everything
- Allow passing in a list of entities to ignore
- Return full intersection data in events
- Move intersectioncleared/mouseleave logic to the cursor component to remove cursor/raycaster coupling
- Be able to update the raycaster 
- Prefix event/state names with respective component (`cursor-`/`raycaster-`)
- Removed `cursor.maxDistance` as it was redundant with `raycaster.far` 
- Fully unit test the raycaster and cursor components
 Yeah, returning full intersection data is part of the changes in that huge list.
 @dmarcos r?
- [Example](http://ngokevin.github.io/aframe/examples/test-raycaster/)
- [Example Code](https://github.com/aframevr/aframe/pull/1196/files#diff-37c2905af9feb5afcd95d3cdca3cf5d1R1)
  Thanks! A few changes + squash and we ship this :)
 I plan on handling everything at https://github.com/aframevr/aframe/pull/1196, such as returning full intersection data. Thanks for the PR though! Sorry for your time.
  **Description:**

Heard reports of A-Frame scenes not loading in IE10. Makes sense to not support <= IE9. But perhaps IE10 is worth addressing. In my tests, scenes load fine in Edge on Windows 8.1 + Windows 10.
- A-Frame Version: 0.1.0 (on https://aframe.io/examples/)
- Platform/Device: IE10 on Windows
 IE 10? As far as I know IE 10 does not even support WebGL. Can we close this?
 Who's using IE 10 and why trying to load WebGL/VR scenes?

<hr>

@bryik: the [Anime UI](https://drive.google.com/file/d/0B9kmhkXbM5H8WDF0OWFjVVoxWWs/view) issue I've encountered once or twice. Very peculiar.
 @cvan In the original description you mention IE 10
 I'm going to close this. IE 11 does not even have complete support for CustomEvents http://caniuse.com/#feat=customevent.
  Can you be a bit more precise about the problem? What do you exactly mean by "double click for navigating"? Do you mean "enter VR"?
 When you say navigating through your application what do you exactly mean? Can you point to an a-frame example where the same problem reproduces? 
 I still don't understand what the problem is. Can you share a link so we can look into it?
 Don't include A-Frame twice. Either NPM install it, **or** include it as a script tag, but not both.
  it looks great! Thanks!
  looks good to me. @ngokevin?
 @IagoLast thanks a lot! can you squash your commits?
 tube is radiusTubular
 Thanks for doing this!
 Thanks! I'm gonna make a few small changes myself in another commit.
  Looks good! Thanks and Welcome as a contributor! :)
  Nice! @K4orta Does this also solve when an a-frame scene is open within the twitter app using its appview?
 @K4orta I think it's specific to the Webkit based views. But It seems to work in the Facebook app web view.
 I confirm that this fixes the issue on the twitter WebView. Thanks a lot. This bug is a tricky one to figure out unless you're well seasoned in WebKit matters.
 Thanks! Saved me couple hours of my life.
  @alexcheninfo We've [deprecated](https://github.com/aframevr/aframe/tree/dev#a-frame) the `dev` branch. We are doing all work in `master` now. [The new docs](https://github.com/aframevr/aframe/blob/master/docs/guide/getting-started.md#npm) reflect that, but we haven't pushed them live to https://aframe.io/docs/ yet.

Sorry for the confusion. VR mode should be working for you just fine on `master`.
 i..e, `npm install aframevr/aframe`
  Description: Slow, laggy for A-Frame. Pure three.js (circa. r70) is fine.
- A-Frame Version: 0.1.3
- Platform/Device: Android mobile (S6, Note 4, Note 5)
 Bad performance on iPhone 5 is expected as it runs nearly 4-year old hardware. We haven't come up with an official list of supported devices yet, but iPhone 5 is too old to become on that list (especially since the screen would be too small for VR).
 What demo exaclty? content with video? Scenes with lots of geometry? Lots of different textures? This issue is not actionable.
 Every demo. Like 15 FPS. Is that actionable?

Try Anime UI which runs perfectly smooth in iPhone.
 I will get more information later, but it's pretty widespread and easily noticable.
 @bryik thanks for testing, glad to know it's not on all Android. Don't think this is actionable, @dmarcos pointed out Android accelerometer hardware might not provide data very quickly.
  @IagoLast  Does setting fill="backwards" / fill="forwards" do what you need? 

https://aframe.io/docs/core/animation.html#Fill
 That won't do. We have code that always resets to initial value on `.stop()`.
 Maybe `stop` should consider the fill value.
  This is almost ready to go. @bnolan a couple of quick changes and we can merge
 Thanks!
  You can listen to window click in parallel, the entity's "click" can mean different things, but not necessarily associated to a hardware mouse  check out https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia . 
 also https://github.com/borismus/webvr-polyfill/blob/master/src/webcam-position-sensor-vr-device.js
  There's a timeout attribute on a-assets:

https://github.com/aframevr/aframe/blob/dev/src/core/a-assets.js#L26

It has a default value of 3000ms but we should maybe remove the timeout by default. @ngokevin what do you think?
 I think the issue is that the event is not firing at the right time.
 Maybe it is cached? But I wouldn't doubt there's a bug, the assets system definitely needs to be put through its strides.
  Expected: one single event once all assets loaded
 Thanks, this is fixed: https://github.com/aframevr/aframe/commit/5728902d29cc73b12269f41d5417ae92ab63ae77
  Good catch! Thanks!
  One option:
1. When unknown component is attached to an entity, store the component in an object.

``` js
var queuedComponents = {
  'some-unknown-component': [el1, el2, el3]
}
```
1. When a component is registered, and there is a queue for it, init the component on each entity.

``` js
queuedComponents[registeredComponent].forEach(initComponent);
```
 Good point. Will have to think about that. I hope there's a pub-sub way to do it without introducing asynchronous code into the core API because that will become infectious and spread through the entire codebase.
 - Entity attaches component that is not yet registered. That component is later registered. The entity initializes the component.
- `<a-hyperbolic-star>` and `<a-hyperbolic-grouping-thing>` are not components. If you mean primitives, those are just entities that attach components.
- Most logic will be in `src/core/entity.js`. Perhaps some in `src/core/component.js`

Implementation details and dependencies not sure about yet. This issue is marked as `easy` but that's more of a `help-wanted` label.
 We are currently exploring the trade-offs and ramifications of allowing this.
 I think we are not going to do this. It quickly gets messy. What happens when a component that is not yet registered is initialized via a `setAttribute`? Waiting for it to register will cause a big delay.
 Is this still considered "help wanted"? 

This issue seems to come up a lot, e.g. it's not possible to use the JS panel in Codepen because it is appended at the end of `<body/>`. And, for that matter, putting JS at the end of the body tag is pretty common practice.

Couple ideas:

1. At the bare minimum, component registration should throw an error if run after a scene has been parsed. Silently ignoring the newly registered components is not what the developer expects, and this is a common source of confusion.
2. Agreed that resolving dependencies is difficult. My suggestion would be, if the scene gets to the point of initializing components and any components have dependencies that haven't been registered yet, don't wait or delay ‚Äî throw an error. Then, we've simplified things and all that's left is a way to initialize on attributes that are already in the DOM. If a developer has some components above the scene with dependencies on components below the scene, that still won't work, but I think we can very reasonably consider that an error scenario rather than trying to accommodate it. We won't go for this due to the potential complications. 

Will see for another issue for warnings about component registered after a scene  I made similar changes for the [a-invaders demo](http://swimminglessonsformodernlife.com/a-invaders/) but never submitted them as a PR. For wasd-controls I see use cases where you want to constraint / invert movement on a specific axis or assign WS and AD keys to a different axis:

https://github.com/dmarcos/a-invaders/blob/master/js/components/wasd-controls.js#L20

@RSpace What do you think?
 BTW, while the review process goes down, for clients, feel free to copy-and-paste the look-controls, modify it, register it under a different name, and use it.
 Nice. I think the idea of forking/remixing of components is interesting. I can imagine a site where you can write components with a live editor, share them, and remix them. Like CodePen for components.
 I'm going to tag this as needs-dependencies-fixed for #975
 We may be looking to overhaul the controls API, meaning this patch will have to change. Going to keep it open for now in case we want it later.
 I am going to close this for now. With Don's patch, all the code will completely change. Once that lands, we can evaluate adding this. Thanks!
  We don't want to enable vertical panning by default on mobile. It's disorienting when combined with the orientation given by the phone sensors. You quickly lose track of what's up or down and rotating the phone becomes frustrating. It's a better experience to constraint panning to the y axis
 I don't think it will scale to enable/maintain every controls use case under the sun. For now, I recommend forking the controls like you have. And hopefully https://github.com/aframevr/aframe/issues/975 will make it easier to extend the controls.
  Keep track of things we should document further. Megathread so we don't have individual issues for small parts or typos we should document or fix.
- [ ] animation + cursor
 Yeah can you pr? Thanks!
 Don't think we need to an issue for this. If you find something, PR it! :)
  Nice!
  - `tests` should be `test`
- and added a few more
  Can you rebase, get rid of those misc commits.
 Almost there! :). You need to squash and remove this comment:
https://github.com/aframevr/aframe/pull/1140/files#diff-04c6e90faac2675aa89e2176d2eec7d8R3
 Probably easiest to just start over with a fresh branch since you got a merge commit in there. Cherry-pick the single commit onto a fresh branch and re-PR.
 https://github.com/aframevr/aframe/pull/1143
  Thanks! And thanks @larouxn for testing :)
 Can you open this against the Master branch?
  I'm fine with ignoring them. @ngokevin what do you think?
 r+
 Thanks!
  Thanks!
  Tested in
- latest Chromium builds
- old deprecated Chromium builds on Mac
- Firefox Nightly on Windows
- Firefox Nightly on Mac
- Safari on iOS
- Firefox stable on Mac
- Firefox stable on Windows
- Chrome stable on Windows
- Chrome stable on Mac

Opened up a PR against three.js to fix several things in `VREffect`: mrdoob/three.js#8330

Needs testing + help in
- Firefox for Android
- Chrome for Android

I tried for quite a while but the remote debugging workflow was a PITA and I kept getting weird issues. Anyway, on Android, stereo upon clicking the "Enter VR" button is not working and some resize issues have been introduced. I don't yet know if they're related to pieces of A-Frame I've touched, `VREffect`, or latest `webvr-polyfill` w/ WebVR 1.0 API changes. Help needed!
 @masom Thanks for helping
 Travis complains
 @K4orta Thanks for testing this
 thanks, y'all. any help with figuring out how to get Android (and all other browsers) to play nicely when
- `navigator.getVRDisplays` is polyfilled by webvr-polyfill
- `navigator.getVRDevices` is polyfilled by webvr-polyfill
- `navigator.getVRDisplays` is natively supported
- `navigator.getVRDevices` is natively supported

https://github.com/cvan/three.js/blob/fix-vreffect-safari/examples/js/effects/VREffect.js
https://github.com/mrdoob/three.js/pull/8330/files

https://github.com/borismus/webvr-polyfill/issues/41 would help identify more reliably whether the interfaces are polyfilled.

thoughts with the `VREffect` changes?
 I think there will be more progress this week as the team gets back together. This PR is high priority.
 branch updated. sorry for the delay, folks. currently, there are quite a few changes/regressions with `THREE.VREffect` and [webvr-polyfill](https://github.com/borismus/webvr-polyfill) that need to be resolved. also, the 1.0 API implementation in the Chromium builds is _very_ buggy and unreliable, but I'm glad it exists. so, I'm experiencing a lot of WebGL crashes, and the logs are cryptic (to me at least). anyway, could use some help with this. @ngokevin, do you have some cycles early next week to help?
 yes
 I've tried this PR with on Chromium WebVR 1.0 + CV1 + Windows 10. Android and iOS. The only weird thing I've seen is that Android does not trigger stereo mode. @cvan Is that the only thing that was missing?
 @cvan Do you have a list of the open problems on the VREffect/VRControls/WebVR-polyfill front?
 Do we need to import all the individual files of the webvr-polyfill? We can just use the dist/bundle? I've realized that webvr-polyfill imports the three.js Math library. We could cut its size in more than half if we build the polyfill to use the THREE math we already have in aframe.
 I close this in favor of https://github.com/aframevr/aframe/pull/1423
@cvan can you provide feedback
  We will be working on standard physics implementation and collision detection some time.

You can use https://github.com/ngokevin/aframe-physics-components 
  Follow up to @legendtang's https://github.com/aframevr/aframe/pull/1099
 I know the naming is unrelated, but perhaps could call it just `query` √† la `xtag.query`:

https://x-tag.github.io/

![image](https://cloud.githubusercontent.com/assets/203725/13662508/e4c1ce54-e64f-11e5-84c3-5bd005169f49.png)
 @cvan But x-tag requires additional polyfills for mainstream browsers for now. Maybe too early to use this name?

I was not suggesting to use X-Tag, just using its method names as inspiration/prior art. And we are already using a polyfill for Custom Elements: https://github.com/WebReflection/document-register-element - I've heard bugs with the polyfill, and we have an issue (#567) on file to investigate if the more "popular" [WebComponentsJS Custom Elements polyfill](https://github.com/webcomponents/webcomponentsjs/tree/master/src/CustomElements) fixes the bugs/inconsistencies we've seen between native and polyfilled.
 Hard to tell whether you are selecting one element or multiple with `query`. And I think selector/selectorAll is easier to get what it means. (query)selector/selectorAll are in the browser and probably make a stronger for "prior art".
 yeah, I think that's a good point. though jQuery seems to handle this fine - `$()` vs `$()[0]`. I've always liked `$` vs `$$`. but, the naming you have is fine.
 Yeh. This is for property types though, not for manually running queries.
  Thanks!
  Can you squash your two commits into one?
 Thanks! Good work!
  @larouxn Thanks for catching that up 
  Thanks!
  @ngokevin Should fit-texture be a property of the flat/standard components instead of a separate one?
 It's very edge case because it only works well for the plane geometry, and is mostly for `<a-video>`. I don't think this crosses the line for being a standard component, but we make this a third-party component and document this harder.
 Then maybe once we have lazy-loading curated components, this won't even need to be a standard component. Does that sound alright?
 Yeah, thinking about it again, images/videos on planes will be very common. Gonna rethink this.
 This component seems to only work with primitives that expose a height /width attributes. Two problems:
1. Primitives other than a-image or a-plane might expose height and width that have different semantics.
2. We shouldn't couple components to primitve APIs. Primitives are just aliases for an entity and a set of components.

If we are going to implement a fit-texture it should be implemented at the material component level
 Let me know if you disagree, but I think this is better as a third-party component.

In some cases, you might not want to keep it to proportion. And usually if a component is for convenience and could be done thru other means, it doesn't need to belong in the core. 
 It's a fine line to decide between usefulness and inclusion to core code. We're thinking more on the stricter side. Gives us less code to maintain, allows module ownership, and with the component system, this can be used by anyone that would like it.

Just a matter of teaching and showcasing to devs about these cool components.
 Would be awesome if you can publish it in a repo or code snippet!
  Thanks!
  Not to revert that, but to have removeState look up the index.

Better to return `true` because index `0` should be a truthy case.
 Fixed in https://github.com/aframevr/aframe/pull/1115
  Nice. Thanks! Can you squash your commits?
 Thanks a lot!
  If you are inlining the URL to the material component (as the `<a-video/sphere>` elements) do, then the video element created will loop by default. I will document this.

It is recommended to provide your own video element:

``` html
<a-assets>
  <video id="my-video" src="vid.mp4">
</a-assets>

<a-video src="#my-video>
```
 Added to doc list at https://github.com/aframevr/aframe/issues/1072
  Currently can't pass position as a single number. Has to be X Y Z

We have issue on file https://github.com/aframevr/aframe/issues/451
 Actually the issue on file is just for scale. Position should be three numbers always
 Here's a demo: https://codepen.io/donmccurdy/pen/qxEpzy. Note that you can see only one `<a-sky/>` initially, but if you swap the order of the DOM elements you will be able to see both photospheres.

This problem occurs, in one form or another, in all realtime WebGL renderers. Because of certain limitations in the WebGL API, three.js renders opaque objects followed by transparent objects, sorting the objects in each group from back-to-front. Because these are spheres surrounding the camera, three.js can't effectively sort them, and so depending on the default order in the DOM you get different results.

You can work around the problem sometimes, reordering objects or by setting `el.object3D.renderOrder`, but neither three.js nor A-Frame can automatically guess how to resolve this problem in all cases. For more information see https://github.com/mrdoob/three.js/issues/4724.

Note that if you don't need partially-transparent materials, but just want to see through the 100% transparent parts of a PNG or GIF, you can set `material="alphaTest:0.5"` _without_ setting `transparency`, and avoid many of these issues. This can be helpful for things like leaves, fences, and shrubbery.  Nice! Thank you!
  To hide/show an entity you can use the visible attribute 

``` html
<a-entity visible="false:></a-entity>
```

We have [mixins](https://github.com/aframevr/aframe/blob/master/examples/test-mixin/index.html#L12) as an analog of CSS. This allows you to group a set of components/properties and apply them to multiple entities the same way you group CSS properties in classes.

We could have used a CSS syntax for mixins but custom properties on CSS are discarded by many browsers. Their properties are not calculated and the values not shown in the dev tools. We could have carried our own parser but using CSS can lead to misunderstandigs. Most of the standard CSS properties don't apply to a 3D scene. We would have recreated CSS with complete different semantics. Also the CSS syntax does not accommodate well properties with complex values. background, padding or border have unlabeled complex values but it would be very confusing in the case of components. We would have to come up with an extended CSS syntax that allows for things like this:

``` css
.red-cube {
  geometry: { primitive: box; size: 5 }
  material: { color: red }
}
```
 @trusktr Have you tried  a `MutationObserver` on a stylesheet? I could not apply them to `CSSStyleRule ` elements. What would be the advantage of using CSS over the current mixins mechanism? Reusing CSS comes with a lot of baggage and we would like to explain why traditional properties don't work . Why does ` visibility: hidden;` not work? Mixins are close enough to CSS, we can break expectations and we don't have to support all the functionality and intricacies of traditional style sheets. I'm more than happy to see the community experimenting with different approaches. Concerning the core, browsers are not ready to implement the functionality we need (lack of MutationObserver) and in my opinion the cost of implementation, maintenance and user reeducation are not worth the delivered value.  Good catch and welcome as a contributor! I realized that you are submitting the PR against the `gh-pages` branch. Can you reopen it against master? Thanks!
  Nice. Good catch! Nice to see PRs with faces :) We have moved development to the master branch. Would you mind reopening the PR against `master`? Thanks!
  @nylki Are you on Windows/OSX? Can you file an issue?
 Can you describe a use case for this? Should the `selector` type behave like `selectorAll` instead of having two separate types? @ngokevin What do you think?
 It's useful when you want a list of entities (class) rather than a single entity (id). But both have distinct cases:
- selectorAll use case was to be able to pass in a class name to whitelist raycaster targets.
- selector use might be to select a single target like `look-at`.
 This looks good to me.
 A single selector type that returns all the matches  can cover both cases described above: raycaster and look-at. In the case of look-at and multiple matches the component would just pick the first one. 
 It _would_ work, but it's better to explicitly define in the schema whether a property is intended to return a single match or multiple matches. Doesn't make sense (and is inconvenient) to have it return an array when you only want a singular match; it'd be akin to defining an int array when you intend to define an int.
 On more style change and this is ready to go
  Can you squash your commits?
 Thanks!
  @legendtang want to bump karma-sinon-chai?
  Love to see new contributors!
 Travis is complaining
   Maybe also viewport size like shader toy. Should those be new schema types?
 Let's create some shaders and see what's useful :)
 Yeah I think these would be built-in schema types.
 A shader we need is a neat animation for the loader spinner. The loader should not use any assets ( textures, models, sounds...) so it loads super quick. It has to be self contained within the aframe library without adding bloat
 Would be good for placeholder for loading models.

Don't think we can use shaders for the spinner blocking scene load. Because that depends on rendering, and we are blocking rendering until assets load which is when we show the spinner. A simple image or data URI would do, it could also function as the "click to play" placeholder.
 We can create a `loader`  `scene component` that creates it's own renderer and render loop independent to the scene one. It renders on the `a-scene` canvas
 Yeah, I guess it is good to have the loading screens support VR too. 
   I believe this is fixed by removing command substitution in the lint command.
  Perhaps one of the LCD variety

The sound system should handle creation of the AudioListener.
  Should probably do the `bind` method since that is the intent, and just to please the standard linter.
 Yeah, I was wondering why we couldn't just do `sound.onEnded()`
 There are conflicts. Needs rebase. We also moved development to master.  @meta-meta Would you mind to reopen the PR against master? Sorry for the inconvenience.
 These changes landed on https://github.com/aframevr/aframe/pull/1106
  Nice I love to see you tinkering with the soud. 

Travis is complaining. One linter error:

https://travis-ci.org/aframevr/aframe/jobs/113555636#L503

And the sound tests fail as well.
 I have the same problem with the linter. On Windows it doesn't output anything. I filed https://github.com/aframevr/aframe/issues/1084
 Thanks! Sound really needs love! 
 @dmarcos SQUASH!
 I always forget :S 
  dupe https://github.com/aframevr/aframe/issues/1069
  Try `npm install aframevr/aframe#dev` for now. The newer branches pre-build the bundle published to NPM so it should be smoother. It's latest code which will be released soon.
 Lots of issues with different versions of NPM in older builds, I think newer builds have corrected it.
  Thanks for requesting. This doesn't seem like it will be a core feature, but you can write your own A-Frame component to do anything you want: http://ngokevin.com/blog/aframe-component/

Or sounds like you might be able to use an animation and rotate the camera in a circle.
  So once can just listen for cursor events to get what element has been clicked.
  Can you add a test to `tests/core/a-animation.test.js` in `suite('detachedCallback')`:

``` js
    test('stops animation', function (done) {
      setupAnimation({begin: 'test-event'}, function (el, animationEl) {
        animationEl.parentNode.removeChild(animationEl);
        // Check that it doesn't have event listener somehow.
        // Maybe emit the event + process.nextTick + check it isn't running + done().
      });
    });
```
  It should work. It already works with React and d3 which also do data binding. Feel free to publish your own example and we can share it :) 
  Currently can't enter fullscreen because that's reserved for VR.

We should allow fullscreen (and swap out the Goggles icon for a fullscreen icon) for mono experiences if a headset is not detected.

If a headset is detected, then fullscreen will also enter VR mode.
 This is related to https://github.com/aframevr/aframe/pull/1056 because there is less reason to have pointer lock until we support fullscreen + mono. 

vr + pointerlock doesn't seem to go well together (unless we maybe restrict the pointerlock to a single axis)
 I like this. And I also like the idea of making the "enter VR" button a friendlier color (like green) when a headset is plugged in.
 Maybe Goggles when headset plugged in or mobile...else fullscreen arrows?
 The minimum work required for this when a VR headset is not detected, then clicking on the Goggles button triggers a simple requestFullScreen.

Then we can subsequently layer on proper UI for it.
 perhaps, this is one way. but we shouldn't conflate "entering VR" with "entering fullscreen" (or even being a sufficient fallback). some folks may actually be using A-Frame and just want to enter fullscreen w/o VR. or may want to enter VR but on a VR-capable device (e.g., my phone). also, what would the icon look like? a VR googles/fullscreen icon - would it be conditional?

load https://mozvr.com/demos/SECVRITY/ in Chrome and Firefox Nightly to see how we handled this for the Unity WebVR template. since game devs often want to enter fullscreen, we just gracefully add VR icons if they have VR support (even if no devices are connected yet).

<img src="https://cloud.githubusercontent.com/assets/203725/15520475/80f8ed9c-21bb-11e6-8ff0-b239faefe0f9.png">

/cc @caseyyee 
 Just breaking up the chunks of work.

Right now, simply just allow fullscreen.

Then work on conditional icons:
- Desktop, headset connected: googles -> VR mode
- Desktop, no headset: fullscreen icon -> fullscreen
- Mobile: always goggles
 Fixed by https://github.com/aframevr/aframe/pull/1474
  When a component is defined as a key in `defaultComponents`, the component's `init` method gets called twice.

Reproduced with `<a-scene>` for `canvas`, `keyboard-shortcuts`, and `vr-mode-ui`.
 You sure? Only getting it once the anime UI

<img width="1306" alt="screen shot 2016-03-01 at 6 51 10 pm" src="https://cloud.githubusercontent.com/assets/674727/13449275/a2a299e4-dfde-11e5-8703-5e05ee44a772.png">

<img width="678" alt="screen shot 2016-03-01 at 6 51 15 pm" src="https://cloud.githubusercontent.com/assets/674727/13449274/a2a279aa-dfde-11e5-8118-cfc494d02b09.png">
 sorry, I didn't mention. reproducible in Chrome + new Chromium builds only:

<img width="727" alt="screenshot 2016-03-01 19 11 13" src="https://cloud.githubusercontent.com/assets/203725/13449542/59feea32-dfe1-11e5-8db6-55ee94272146.png">
 OK I see
  Reported on A-Frame Slack in `#issues` room by @leemark.

> I am experiencing an issue where my screen times out/goes to sleep in android chrome, in VR mode.
> android 5.1, moto g lte (motorola xt1045), chrome 48.0.2564.95

Could be related to 7d1ab4ca
 This was fixed on the dev branch: https://github.com/aframevr/aframe/issues/875

0.1.x doesn't have this fix so people will experience it
 ah, sweet - thanks. can you tell `@ml` in Slack?
  Thanks! We'll take a look at this
 this works very nicely. thanks for doing this :+1:.

perhaps we want some way of toggling between mouse-drag controls and Pointer Lock (which IMO is much easier and more intuitive when you actually have a headset on).
 Is there an argument to keeping mouse-drag? Either mouse-drag or pointer lock, you have to click to discover. 

@dmarcos has mentioned to support multiple scenes on a page. Not sure if we should optimize for that use case. We have also proposed pointer lock only on full screen.
 though we can't assume that the user will use the mouse/pointer for look controls, it might be nice to call `requestPointerLock` if it hasn't been already. maybe not. it could be too presumptuous + annoying.
 This would be assuming if the user is using the mouse. If not, then it doesn't matter mouse-drag vs. pointer lock. But let's assume the user is using the mouse. When to mouse-drag (if at all) vs pointer lock?
 > This would be assuming if the user is using the mouse.

Precisely what I said above, yeah.

> If not, then it doesn't matter mouse-drag vs. pointer lock. But let's assume the user is using the mouse. When to mouse-drag (if at all) vs pointer lock?

Pointer Lock requires you to keep still. Mouse drag allows you to move and sit still until you explicitly click + drag. Two different types of look controls with some different and some overlapping use cases.
 again, we don't know if the user is going to use the mouse. I meant to mention above it would be nice to request pointer lock upon entering VR (if we deem the user wants pointer lock). this way you can avoid the Pointer Lock permission prompt in Firefox. [see this example.](http://dontcallmedom.github.io/web-permissions-req/tests/pointerlock-fullscreen-combined.html)
 I think pointer lock should belong to a different component. `fps-controls`?
 > I think pointer lock should belong to a different component. `fps-controls`?

I like that :+1:

I fancy myself FPS in (Web)VR, so I'd use that component _a lot_.
 Let's figure how this is going to work. Are we thinking something like:
- `first-person-controls`: WASD + mouse (pointer lock by default, I agree, even with the prompt, it's way better than mouse-drag)
- `look-controls`: WASD + VR + WebVR polyfill

How does responsiveness work? What if we want first-person-controls for a mono experience, but look-controls for a stereo experience? Is that done by the developer?
 Mobile would be handled by look-controls that has the WebVR polyfill. Maybe first-person isn't the best name, maybe fps-controls might have been the better name even though it's not always a shooter.

We don't have solutions out of the box for mobile locomotion yet. Right now you can do gaze-based teleport navigation manually. Later will probably use Cardboard V2 mouse/touchdown to move forward
 > I think another component makes sense - but my vote would be for pointer lock to be the default interaction component on desktop.

I 100% think A-Frame should ship with a Pointer Lock component. For non-VR content on desktop, mouselook can sometimes be more desirable.

Because we didn't have a Pointer Lock-like component, we've seen folks create custom components to support the mouse-based FPS controls that Pointer Lock makes real simple.

Here's [`no-click-look-controls`](https://github.com/alexrkass/aframe-no-click-look-controls). And an [example](http://alexrkass.com/no-click-example/). And an [issue I filed about using Pointer Lock](https://github.com/alexrkass/aframe-no-click-look-controls/issues/1).

Besides my [old closed PR](https://github.com/aframevr/aframe-core/pull/121), I guess I forgot someone made a component for Pointer Lock: [`fps-look-component`](https://github.com/cemkod/aframe-fps-look-component/blob/master/index.js).

Have you compared this last one with yours? I haven't looked closely, but I'm curious if there's anything better or overlooked in his approach. Personally, I like the `sensitivity` property - that's super useful (even to make it configurable for mouse-look controls too).

> The drag-to-look is an inferior user experience imo.

For VR mode, I 100% agree.

My opinion: I love Pointer Lock for FPS (whether in VR or just plain mono content on desktop) and whenever I have a VR headset on and can't see my trackpad/keyboard. I like mouse-look controls for when I want to be careful about where/when/how I want to pan.

My conclusion: If I had to pick one, I'd go with Pointer Lock (`fps-controls`) be the default with a configurable `sensitivity` property.
 We could make this real simple and just always enable Pointer Lock when entering VR mode but keep mousedrag-look controls for non-VR (for now). Can everyone agree that'd be the best user experience?
 That's the hard part. Encapsulating WASD+mouse control schemes vs. HMD-oriented control schemes.

Pointer Lock for mono desktop + mono full screen is great. But it doesn't pair well with an HMD.
 - **Desktop, headset, not fullscreen**: WASD + pointer lock
- **Desktop, headset, fullscreen/VR mode**: WASD + HMD
- **Desktop, no headset, not fullscreen/fullscreen**: WASD + pointerlock
- **Mobile**: Touch to move + WebVR polyfill

Sometimes might want a floating cursor too: https://www.youtube.com/watch?v=uteFosiioUI

What comes built-in, what is configurable, how do we make it easy for people to fork and compose their own controls?
 Also be aware that aframe scenes when in mono mode might not be alone on the page. Look at code pen or aframe.io. It doesn't seem right to me to capture the pointer by default. For next version we will also allow multiple aframe scenes on a single page. 
 re: @dmarcos multiple scenes on a page, haven't seen anyone try/request that use case yet so i'm wary about going out of our way for it. Even then I think pointer lock is better, you click on one of the scenes to select it and lock into it. The experience of mouse-drag is poor enough to warrant that.

re: @ashconnell Yeah, I noted in that comment to restrict it to an axis. But yeah, WASD + HMD + restricted-axis-mouse sounds good.
 I want people to easily integrate vr content on 2d pages. aframe scenes have to easily cohexist with other elements in the page. When a scene goes fullscren pointer lock would be acceptable.
 Aframe scene hijacking or hiding the pointer does not seem a good experience to me
 > I want people to easily integrate vr content on 2d pages.

That's extra work and consideration for something I haven't seen anyone try or request. We should optimize for full-page 3D + VR.

> Aframe scene hijacking or hiding the pointer does not seem a good experience to me

Mousedrag is definitively worse though. Hiding the pointer (via a browser API) is not that bad if it's activated with focus/click. In fact, it's expected for a first-person experience.
 > I want people to easily integrate vr content on 2d pages.

I don't understand why Pointer Lock makes it more difficult to integrate VR content. The browser handles the pointer capturing/releasing. You can have a button over your VR content that says "play"/"enter." For obvious performance reasons and presentation reasons (not wanting audio/video to play in the background), it's unlikely you're going to be playing more than one 3D/VR experience at a time.

I think it'd be great to have a newspaper article with three embedded 3D/VR A-Frame scenes. But those scenes IMO shouldn't just automatically load and have to rely on tedious mousedrag look controls.

You can add a Play/Start button. That's how YouTube/Vimeo embeds work, and it's how JSFiddle snippet embeds used to work as well.

> Mousedrag is definitively worse though. Hiding the pointer (via a browser API) is not that bad if it's activated with focus/click. In fact, it's expected for a first-person experience.

:+1: definitely agree here. I'd love for A-Frame to get to **[Quake status](http://media.tojicode.com/q3bsp/)**. Imagine how hard it would be to navigate that scene using mousedrag (by default).
 you haven't seen it because there's no production sites out there yet. Do you think people are going to go all out and convert their sites to aframe? I doubt it. I want to see the new york times including pieces of VR content or Wikipedia enhancing articles with VR media. aframe.io or codepen already follow that model. When an aframe scene is on 2D / no fullscreen mode I consider that the experience is on preview mode. Drag to look is ok. As I said pointer lock is acceptable when going fullscreen. What we should do is enaging fullscreen + mono when the user clicks on the goggles icon if an HMD is not present. We can then enable pointer lock.
 As cvan said the play button would be the goggle icon. It conveys that the user wants to engage with the experience. Otherwise pointerlock should stay out of the way
 That sounds like an improvement (given that desktop users are allowed to enter fullscreen without a headset) and a step in the right direction.

Though it's not very optimal to consider a full-page A-Frame site "preview mode". Mousedrag still sucks in that case. Allowing non-VR mono fullscreen experiences will help though.
 > a seperate component for proper pointerlock + wasd + arrow keys (for the germans) and we can abandon this PR.

I think that could be done in this PR
 @dmarcos @cvan We talked about this earlier. Did we decide on (for behavior):
- Non-fullscreen
  - Pointer-lock by default. Can be configured to mousedrag (e.g., `look-controls="nonFullscreenMouseDrag: true"`) to satisfy embedded scenes
  - Or vice-versa? Mousedrag by default. Can be configured to pointer lock (e.g., `look-controls="nonFullScreenPointerLock: true"`) to satisfy full A-Frame sites
- Fullscreen
  - Pointer-lock always
  - Pointer-lock restricted axis if headset is plugged in
 Bump for discussion.
 When it's not fullscreen pointer lock is disabled by default to prevent aframe hijacking the page where it's embedded. The rest of the description above is sensible behavior IMO
 In the proposal, it'd be up to the developers who embed A-Frame to specify mousedrag in non-fullscreen mode. I think once we validate the embedded use case, we can re-evaluate. But in the meantime, it seems less confusing for A-Frame sites, most of which are non-embedded, to default to pointer lock. I think it's not optimal to start with mouse drag and then go to pointer lock (remember not everyone will think to full screen).
 As I said what we're seeing now is people getting their feet wet with aframe and not creating production content. Websites won't be completely rebuilt in aframe. It just does not make sense at this point. Hijacking the pointer by default is too prescriptive and gets in the way of the experience a website wants to provide. In my opinion the user should decide when to fully engage with the content by clicking fullscreen. We should consider **no-fullscreen as a preview mode by default** and drag to look around seems appropriate. I agree we can let devs override the default behavior.

I think that our codepen demos would be immediately worse if pointerlock is the default in non fullscreen mode.

Most of [playcanvas](https://playcanvas.com/explore/featured) and [turbulenz](https://ga.me/) content doesn't use pointer lock and the demos that do I find it irritating. Look at tanks for instance (http://tanx.playcanvas.com/) and try to interact with your browser (switch tabs for instance). It's just not a good experience.

[Clara.io](https://clara.io/library) and [sketchfab](https://sketchfab.com/models/staffpicks) previewers don't lock the pointer either I think the experience is what it should be.
 Referencing the author of the PR. Visit the gallery of sceneVR:  https://www.scenevr.com/scenes
With AFrame those previews could be interactive with click/drag to look. Selecting one is for me the equivalent of clicking play/fullscreen. The user wants to engage with a particular experience and pointer lock then makes sense. 
 OK I have reservations about that:
- Mousedrag is not great for embedded scenes with preview mode. You have to click the scene to play it (assuming not all scenes will be rendering at the same time), and then click again to drag it.
- I think hijacking is okay given that the user has already expressed interest in interacting with the scene by clicking it + giving the browser permission.

But let's move forward and re-evaluate later. We can make these agreed improvements today:
- Pointer lock upon fullscreen (axis-restricted if HMD is plugged in). This can be done in this PR
- Option for pointer lock on non-fullscreen (something like `look-controls="pointerlock-always: true"`)
 @bnolan I think we should handle our extensible controls story first (https://github.com/aframevr/aframe/issues/975#issuecomment-196093953) because every change to controls is like a temporary fix at the moment. If we go ahead with Don's proposal, all the controls API will change.
 Going to close for now to checkout https://github.com/aframevr/aframe/issues/975 first, and since this PR has gone a bit off-track. But we still do want pointer lock as an option, just not sure if it will be part of a look-controls component.
 Related: https://github.com/cemkod/aframe-fps-look-component
  oops, so sorry! 2995220. this one was my fault/Brandon's fault. mostly my fault for not testing.
 fixed in PR #1065 for polyfilled environments such as mobile and all pre-WebVR v1.0 environments (Firefox Nightly and deprecated Chromium builds), along with support in experimental Chromium WebVR v1.0 builds
 @meta-meta did you run `npm install` after checking it out?
 @cvan any insight on this?
 I'll check whether the scene refactor regressed this.
 @masom What phone are you testing on?
 This was due to a regression in the latest webvr-polyfill: https://github.com/borismus/webvr-polyfill/tree/webvr-1.0

I'm reverting my original commit until there's a fix.
  Thanks!
  https://github.com/aframevr/aframe/blob/dev/src/utils/coordinates.js#L5

`setAttribute('position', [1, 2, 3]);`
 It's just a coincidence:

You can do  `this.el.setAttribute('position', { x: 1, y: - 2;  z: 6 });`

It happens that `three.js` Vector3 stores the coordinate values on the x, y and z attributes as well.
 Ah, okay sweet. Someone was saying it didn't work with Vector3s.

Still need to get it to work with arrays.
 What's the value of adding support for arrays? An array carries implicit information on what position corresponds to each coordinate. I pretty much prefer to always see { x: 1, y: 2, z: 5 }. I think arrays don't add much, reduce clarity and potentially introduce bugs.
 `Vector3` carries implicit information on what position corresponds to each coordinate.
 The benefit is that it's a more compact data structure for something that's going to be typed over and over. Much easier to type since `{x: 0, y: 1, z: 3}` uses keys from all over the keyboard back-and-forth.
 No. it doesn't. The coordinates are labeled with x, y, z. In an array the correspondence is positional and totally implicit. You can easily mess up the indices and pass the wrong thing.
 Typing is not something you want to optimize for on API design:
1. Code is write once ready many. You have to optimize for legibility and understanding and reduce cognitive load.
2. Autcompletion on modern IDE's makes typing a non issue.
 Though when you instantiate a Vector3, you are passing x, y, z in order. There's no difference in using an array shorthand and the precedence that three.js has made on this:

`new THREE.Vector3(1, 5, 7)`

`new THREE.Vector3.apply(this, [1, 5, 7])`

Internally, it will still be converted to an XYZ object
 That you are used to it doesn't mean is a good design decision. Also a-frame targets an audience that it's not familiarized with graphics / game development.
 Math is not a good example of consistent and terse notation either.
 three.js does it, and it's [been requested](https://github.com/ngokevin/aframe-react/issues/12). Having built lots of scenes and components, you can feel having to create XYZ objects over and over gets irritating.

There's no potential for bugs. The only case is if a developer does `setAttribute('position', [1, 2, 3])`, it gets converted to an XYZ object. It's completely external.
 I really don't think an array adds much value. It's just more code to maintain and extra risk for bugs when managing your local variables and passing them around. There's less chance to make a mistake when you are forced to be explicit { x: -1, y: 0, z: -4 }
 Even in A-Frame, we are already making it implicit `position="0 1 2"`...
 It does add value. Lots of developers that are actually using A-Frame (including me) say it would improve our workflows.
 The XYZ order is already implicit in A-Frame, three.js, WebGL, math, our heads. There's no need to make this explicit.
 `position="0 1 2"` is just for backwards compatibility to be able to pass strings to `setAttribute`. It's not a design decision. When using the DOM inspector there's no option. I would get rid of the string notation if I could.
 It's not just for backwards compatibility, that's the API design when people are writing scenes in HTML.
 Still backwards compatibility. You cannot write HTML attributes as objects.
 When writing code is always better to be explicit. Have you never messed up with the order of the arguments in a function? This is why I like objective C and its labeled parameters.
 Sure we can, it could have been `position="x: 5; y: 10; z:15"`, but we didn't because it's annoying to define something so commonly accepted explicitly. 
 That rule doesn't apply in this caseIt's not always better to be explicit if it doesn't make sense to. There's precedence in A-Frame. The way we define single-property schemas is very implicit.
 Typing on the DOM inspector is a real pain so it's sensible to have a more compact notation. Also when manipulating the DOM on a text editor and DOM inspector you're writing the values directly. There's no chance that you have an array manipulated somewhere else that you have to keep track the origin and state.
 How can we address these points in favor of an array?
- XYZ order is universally accepted in A-Frame, Unity, three.js, WebGL, shaders, game development, math, our heads.
- Many developers are saying their workflows would improve if they could pass an array. 

An umbrella argument of "explicit is better than implicit" isn't really a strong enough argument either. There's already precedence of favoring implicitness for ergonomics in A-Frame.
 Because we're forced to by legacy systems, mainly the DOM inspector and the string nature of DOM attributes. It's not a decision we would make without those constrains. In JS world those limitations don't apply.
 I still have to understand why arrays improve workflows more than the risks they introduce. There could be some marginal value on but it doesn't pass the cost / benefit analysis.
 I'm not really worried about the DOM inspector or DOM. I just want to be consistent with the fact that XYZ order is already universally accepted as arguments in universally all of math and development.

I'm willing to let it go because you're right, it's fairly marginal. But it would be an enhancement nonetheless
 On the other hand, I can imagine people writing all sorts of helpers to convert XYZ objects to arrays within their projects, which would be a little riskier than ensuring + testing it ourselves.
 I'm going to leave this open as _needs answers_ since it's not quite resolved. But won't take action yet.
 Is this our first public flame war? I guess we're a real open source project now :)
 Yeah, it's like our [own mini Rust int/uint](https://internals.rust-lang.org/t/restarting-the-int-uint-discussion/1131) :)
 For now, you can do in your projects:

``` js
function v (x, y, z) {
  return {x: x, y: y, z: z};
}
setAttribute('position', v(1, 2, 3));
```
 I'll close this for now. One way to do things keeps things simpler. The helper is above pretty simple.  I think this sort of makes sense for stdlib. Later on, we have APIs to be able to dynamically swap the schema based on conditions, which will allow us to internally split up the geometry component for cleaner code.
 We could possibly have `registerGeometry`. Dunno.
 Need a lot of input from @dmarcos since the potential API for geometry component might change

Thanks for the PR! I was thinking of being able to pass vertices.
 A registerGeometry API makes more sense to me than passing vertices on the component. I need to think a bit more about this.
 Yeah, at the very least it can be a separate component for now. I feel like we might the geometry component API more generic and extensible later.
 I think we will close this in favor of a future `registerGeometry` where you can define a name + Geometry object + options and share with other people.

``` js
AFRAME.registerGeometry('triangle', {
  vertices: [ // ... ],
  faces: [ // ...]
});
```
 But it can be separate component until then!
   Thanks! I created a Stackoverflow question so hopefully this can get found later: http://stackoverflow.com/questions/39768099/how-to-ignore-seems-to-be-a-pre-built-javascript-file-try-to-require-the-orig/39768100#39768100
  On dev branch of A-Frame `aframevr/aframe#dev`, the bundle will be prebuilt so no build step will be required.
  Looks good after those comments! Thanks!
 Thanks!
  You can define custom `parse` and `stringify` functions to effectively create one-off types because that is mostly what types do. That should work well: http://codepen.io/team/mozvr/pen/yeEQNG

I previously thought of it at https://github.com/aframevr/aframe/issues/881, but we agreed that it would get messy if there were lots of components registering types into the global space, it'd be hard to tell what was a built-in type and what was third-party. Let me know what you think.
 Definitely, I had that in mind, never filed it.
 Feel free to PR that, should be simple. Function to split on comma, function to join with comma, then a small test.
 Thanks!
  Have not experimented with streaming. It would be nice if someone could give it a shot and write an A-Frame component to stream a video feed into a texture.
 Would leave this for a third-party A-Frame component + JS library  Probably an `end` attribute? Similar to `begin`
  Can you try with an event name that is not `play`? I think entities will emit `play` when they are attached.
 Confirmed, don't use the `play` event name. This will be documented later. https://jsfiddle.net/yL0cozoh/
  see https://github.com/aframevr/aframe-core/pull/796
 @meta-meta Thanks for investigating. @cvan Does anything ring a bell?
  @dmarcos will look at this once he finishes up his current work
 @dmarcos r?
 Does not nesting solve the problem? 

``` html
<a-entity gamepad-controls>
   <a-entity camera  look-controls></a-entity>
</a-entity>
```
 @donmccurdy Should we investigate your universal controls solution rather than pulling in this temporary fix?
 @dmarcos hasn't looked at it yet, but it looks promising to me. I'd poke him.
 Going to close for now to look at a bigger solution. If we don't arrive to that, we can reopen this.
  `material-texture-loaded` would be a good event name. It prefixes the component name to the event name, and we haven't been using camelCase for our event names.
 Once we rename to `material-video-ended`, this looks good to me. The nitpicks are optional, I can clean up later.
 Adding a test would be a bonus, but I could do that if you want.
 Tests and nitpicks are important. It costs nothing to do it right away. We will never do it later.
 Do we need our own style guide on top of https://github.com/Flet/semistandard? The idea of that was to spend less time nitpicking, but it seems we need more rules?
 It would be nice If there's a way to automate those nits.
 I looked and we can configure our own with http://eslint.org/docs/rules/ , there are a lot of rules there that we are using that aren't configured in semistandard (e.g., force vars on top, no else after return)
 Yeah, sorry, we hijacked your PR to talk about stuff :)

You can just add a test in the material component to check the event is triggered, yeah.
 do you have your devdeps installed for testing?
 Tests don't pass
 PR needs rebase
 OK looks mostly good :)

@dmarcos we should get this in before your custom shaders so you can handle the future merge conflict
 @dmarcos looks good to me
 Cool stuff! Thanks!
  Can you remove the dist files from the PR?
 Ok. I had no idea what the difference was.
 Waiting for green! 
 AFrame works on IE and almost on windows phone. There's a problem with the values we read from the device orientation API that we will fix on next release.
 Thanks! Congratulations! You're the 8th contributor. I guess we have to order t-shirts soon to give away :). Ideas for a awesome designs are more than welcome. 
  look-controls changes the rotation of the camera by modyfing the rotation attribute. If the rotation attribute is not defined on the entity getAttribute will return null. This is how dom attributes behave. I consider this expected behavior
 Actually the expected behavior is `{ x: 0, y: 0, z: 0 }`, and a-camera comes with look-controls

But this has since been fixed on the dev branch for a-camera
 You can report either, and then I can help confirm whether it has been fixed or not. I think at the moment, I prefer people use the `dev` branch as it feels more stable than master.
  When do you say an image what do you exactly mean? An image floating in the user's field of view? A completely different scene? For the former you can now show/hide entities based on user interactions. For the latter we will be soon supporting multiple `a-scene` elements on the same page.
 Yea, there's also http://codepen.io/team/mozvr/pen/RrxgwE for Cursor with Visual Feedback.

And yeah, there are many ways to do transitions. One way we did before is to create a black mask entity that fades in when transitioning, and you change the scene during the transition.
 For now, use `<a-entity camera>` instead of `<a-camera>` to get fuse working
 @coleholyoake Something similar to http://codepen.io/team/mozvr/pen/RrxgwE but you can animation the theta-length/geometry.thetaLength rather than the scale
  There was a WIP at https://github.com/aframevr/aframe-core/pull/768 , will revisit later.
 try out https://github.com/oscarmarinmiro/aframe-stereo-component by @oscarmarinmiro
  I believe this is a limitation of iOS not being able to copy pixels from a m3u8 stream to a texture. Have you seen any WebGL/Three.js demo rendering one? I haven't. I flag this as an iOS platform limitation and not an aframe bug. Please reopen if you find a working example of WebGL rendering a m3u8 stream.
  Yeah, might be organized to prepend the component name to the event.

I should probably make it past tense like yours though to be consistent with the rest of the codebase. Ideally, it would be present tense like how the rest of the web does it, but a bit too late now.
 Hm, that works
 Want to change this PR to handle for collada? I can handle for the OBJ since I have that already
 lgtm
 Thanks!
  Firefox has poor video texture perf, not sure what to do from the A-Frame side, but it might depend on the video.  lgtm
  try out https://github.com/oscarmarinmiro/aframe-stereo-component by @oscarmarinmiro

and then you can try `document.querySelector('a-scene').renderer = document.querySelector('a-scene').stereoRenderer`
  Thanks for filing. We have a lot filed on this:
- https://github.com/aframevr/aframe/issues/316#issuecomment-170182397
- https://github.com/aframevr/aframe/pull/988/files#diff-c90a11d27e2d2b84de947d5d1dbb5f0aR36
  Good catch.

I address that here. https://github.com/aframevr/aframe/pull/988

Want to copy-and-paste what I have there to the current A-Frame docs?
  ``` html
<a-assets>
  <a-mixin id="frame">
    <a-box position="0 1 0"/>
    <a-box position="1 0 0"/>
    <a-box position="0 0 1"/>
    <a-box position="1 0 1"/>
  </a-mixin>
</a-assets>

<a-entity mixin="frame">
  <!-- All of the boxes will be injected here. -->
</a-entity>
```
 Mixins are applied left-to-right. So right mixin trump the left ones.

Entity attributes trump attributes applied by mixins.
 I am not sure what to do if you apply multiple mixins with children. Could either _replace_, or _merge_.
 Being mixins, it seems more predictable to merge
 as I'm sure you know, this is reinventing templates lol. you do have to make `a-mixin` inert (behind the scenes, it should extend `<template>`) or else a bunch of custom elements are going to get prematurely called and callbacks called and events fired and so on.
 if I have `<a-entity mixin="frame">`, you're going to inject a bunch of elements (event delegation now again needed for `<a-event>`, btw).

then suppose some other elements get inserted. or some JS modifies some attributes - or some elements inside have `mixin`s themselves. the HTML is going to change.

and then if I set `<a-entity mixin="">`, what happens? do you remove everything?
 Yeah, it provides a subset of the feature set of templates. But it doesn't try to do any custom element registration or parameter passing. It solves the most basic use case of templates, I have something, and I want to copy/paste it.

I'd expect removing the mixin to remove that was everything injected. It's a bit of an edge case. But removing vanilla mixins at the moment doesn't do anything right now anyways.

I'm not worried about `a-event`. Mixins are a first-class citizen, `a-event` is not. `a-event` will still work anyways since it applies the listener to the parent node. We never really agreed as a team on its place within A-Frame so it's almost even on the chopping block let alone getting in the way of core implementation.

``` html
<a-entity mixin="frame">
  <a-event></a-event>
  <!-- Elements injected here. -->
</a-entity>
```
 `<!-- Elements injected here. -->`

you're going to have to keep track of where that element is (that's what the `<a-root>` was for)
 > We never really agreed as a team on its place within A-Frame so it's almost even on the chopping block let alone getting in the way of core implementation.

I don't remember having a team discussion on mixins
 this isn't templating exactly, it's not taking attributes and templating them so i don't think we need a-root. If we want to support removal, we can just assign data attribute

Mixins weren't created in a vacuum though. Maybe not the whole team, but at least some agreement
 note i'm not 100% sold on this idea yet since it does provide a subset of template logic. but it could be useful for simple copy/paste common sets of entities or mixing in animations
 https://github.com/ngokevin/aframe-template-component 
    The states for sound component in relation to the Component.play() method is a bit hairy.

When a component is initialized, it will try to play. For the sound component, this means it will try to play even if autoplay is not set. And then when the sound is loaded, THREE.Audio will also play the sound if autoplay is set.

We could maybe get rid of the play() method for sound, but how do we handle resume? We need a way to detect when play() is being called as initialization vs. being called to resume. For the sound component, we don't want to call play(), but we do want a way to provide a resume if the scene was paused.
 Also where does tick come into play?
 `playSound` seems to solve it, thanks!
  for the following:

``` html
<a-scene>
  <a-camera></a-camera>
  <a-cube></a-cube>
</a-scene>
```

I see:
![image](https://cloud.githubusercontent.com/assets/1560884/13120944/fa935604-d564-11e5-89f7-e3bbe92b745d.png)

Expected to see nothing, since the camera and cube should be sharing the same position.  

This is only an issue on the dev branch.   Seems to be fine with 0.1.0
 I'm touching this right now. Might be that the scene doesn't catch `<a-camera>` initializing its camera, and it swaps to the default camera, disabling the set camera. setTimeout in camera setup code fixed for me.
 FWIW, I tried setting the camera and cube object to position 0 0 0 and basically get the same as the screen capture.   It looks like the camera is set back and higher than the cube.
 https://github.com/aframevr/aframe/pull/883
  Thanks!
  Yeah, should be doable to escape semicolons in url().
 Want to make a PR to aframe#dev to bump the style-attr version?
 https://github.com/aframevr/aframe/pull/985
 Ah right, it still worked, but good to mark it down
  The a-image helper currently doesn't accept selectors. It will in the next version. Sorry about that, the docs might have been misleading 
 You can use `<a-entity material="src: #img-01">` if you are using 0.1.0. The `dev` branch will soon have a patch landing that will let you set that material component on the `<a-image>` element.
  Set the material to visible false for raycaster to ignore

`material="visible: false"`    You can enable/disable components by
calling el.components.yourcomponent. pause() / play() 
What about handling the configuration of your controls in a separate component "my-controls" that sets up mouse-look, gamepad, hmd-controls... and enable / disable them based on the specific needs of your content? I'm trying to determine if we should handle controls collisions at the core or if it should br up to the application to manage it.
 Sorry, I'm a bit late to this issue. Is it possible to add controls to wrapper entities so they don't collide?

``` html
<a-entity gamepad-controls>
  <a-entity camera look-controls></a-entity>
</a-entity>
```
 Thanks for the proposal, will read through thoroughly once I have time.
 @donmccurdy OK, that is awesome. I'm looking through it, and it might solve our controls story. Looks like we'd be able to register new controls and have them all concatenate correctly using an single interface. I love the separate velocity component, will be necessary for physics.

There could probably be further abstraction to have preconfigured control schemes? 
 @dmarcos Can you look through those controls when you have time? They are device-specific, but looks like they can be composed to create control schemes.
 Will close for now to focus on WebVR and keep simplicity without the extra layer. But the `universal-controls` are still a great option and can reconsider layer or take some of its nice defaults (e.g., pointer lock, but only after entering fullscreen).  rendering html into as a texture is fairly non trivial. 
 In order to render HTML to texture we need a new browser API that allows us to do that. There's a hack using foreignObjects in SVG with the limitation that you cannot use external resources https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Drawing_DOM_objects_into_a_canvas
 I created this pretty basic script called [dom2screenshot](https://github.com/cvan/dom2screenshot), which behind the scenes uses [html2canvas](https://github.com/niklasvh/html2canvas) (different but similar to the SVG hack).

With dom2screenshot, you can create images from HTML, they get uploaded to a CDN, and you get a URL back you can use in your scene. See this [CodePen example](http://codepen.io/cvan/pen/xZYKqO?editors=1100).

All you get is a static image (and not a high-res one at that).

As @dmarcos says, rendering live DOM in WebGL is not possible today. But you can take an `<iframe>` and apply a CSS transform to give the perspective that it's in your scene, but it's really just layered atop your scene.

See [gl-css3d](https://github.com/deathcap/gl-css3d) as an example of this.

Also:
- http://learningthreejs.com/blog/2013/04/30/closing-the-gap-between-html-and-webgl/
- http://jensarps.de/2013/07/02/html-elements-in-webgl-recursion/
 You can use an iframe or any other element + css 3D transforms but you will have to handle stereo rendering by duplicaing the DOM and even in that case distortion won't be applied to the DOM content in VR mode
 > You can use an iframe or any other element + css 3D transforms but you will have to handle stereo rendering by duplicaing the DOM and even in that case distortion won't be applied to the DOM content in VR mode

True, good point.
 > @cvan technically, with the dom2screenshoot, couldn't you map a users position on the screenshot to an action in an iframe? example: In cardboard they see the image version of the page, and they hover over a button to trigger the js to actually correspond with the iframe and reload a new view?

if you have the iframe is on the same origin, yes. otherwise, no. and you'd still need to duplicate the iframe twice (for the stereo rendering), which gets tricky.
  Every time someone makes a PR then, it will auto-target the `dev` branch.
 I'm kind of favour of this, but when people land on https://github.com/aframevr/aframe they're going to see the unstable (`dev`) version of A-Frame.

idk, I'm not a big fan of this `dev` vs. `master` workflow. I'd prefer to just do very regular releases.
 Maybe that's fine if the people checking out Github are people that more interested in seeing what's happening or want to use the latest builds. If `dev` is `master`, then every PR is sort of an unstable release to the Github repo.
 again, yeah, that's why I think `dev`/`master` workflow isn't the best system. it encourages breaking trunk and longer releases. I realise the intention may be to move faster, but it seems to do the opposite.
 Okay, I agree, just have a single `master`. Bump dist when we feel ready. Publish NPM when we really feel ready
 I like that
 What would staggered releases look like?
 @dmarcos Input? I'm currently for developing on master:
- More transparent
- Project looks more active
- People see latest code when they hit GitHub
- Many people already working off of dev branch
- The people that go to GitHub are interested in grabbing latest code + developing. Those that want to use Stable A-Frame will grab from CDN or NPM.

Master would then not be expected to be Stable. Which is fine since `dev` is arguably more stable than `master` at the moment with its mass amount of bug fixes.
 I'm fine with converging development on master. Should the files on the dist directory reflect the stable version?
 We can have both stable dist + nightly dist in the `dist` folder?
  √† la https://github.com/servo/servo/blob/master/HACKING_QUICKSTART.md

Perhaps move/duplicate a bunch of the commands from the [`README.md`](https://github.com/aframevr/aframe/blob/dev/README.md) and throw them here. The [A-Frame Docs](https://aframe.io/docs/) are specific to _usage_ of A-Frame as a library, not about contributing to the A-Frame codebase itself.
 consider consolidating into CONTRIBUTING to avoid plethora of `.md` files
 @joshgalvin: "most windows node devs don't have the node-gyp compiler tool chain installed"

need to note that
 some updates https://github.com/aframevr/aframe/commit/35de321a704578cb284667c630a6cc7c2673370d

could go into more detail like writing tests or style guide
 I was going to file a separate issue, but it's probably fine to add as a comment here. We need to document how to enable the debug-level console logs.

I had this information in the README, but [it was removed](https://github.com/aframevr/aframe/commit/4171d021#diff-04c6e90faac2675aa89e2176d2eec7d8L52).

I couldn't find this info. anywhere in the docs, only [in the code as comment](https://github.com/aframevr/aframe/blob/701e47e/src/utils/debug.js#L73-L82).

Let's add it probably to both the docs and the `CONTRIBUTING.md`.

``` js
localStorage.logs = 1
```
 FWIW, we only have one debug-level log in the whole codebase, and I've never used it.
 Things I would add:

**Contributing Code:**
- [ ] Mention of style guide (`semistandard`) and to use `npm run lint` to check.
- [ ] Add a note on how to rebase
- [ ] Add a note on testing and link to tests/README.md
- [ ] **Spreading the Word** (maybe)
  - [ ] Links to good slidedecks for A-Frame/WebVR evanglism until we have an official onboard kit
  - [ ] Where to give talks (e.g., meetups, contact Mozilla reps)

In tests/README.md, I would add more details on how to use the test suite. (explain the tool chain of karma/mocha/sinon, the process of adding a test).
  Add a note on how to rebase is good idea, but also other git stuff for PR life cycle  
Since you most likely first clone you fork then that is your `origin` remote
1. **first you add upstream remote**
`git remote add upstream git@github.com:aframevr/aframe.git`
2. If you want to make contibution you would create new branch shortly describing what you working on or just name it `patch-x`
`git fetch --all`  _to update trackers_
`git checkout -b patch-x upstream/master` _checkout new branch from upstream master_
`git push -u origin HEAD` _push and create new branch under your github_
3. Do some work, commit it, push and PR
4. If you branch fells behind or needs rebase run
`git fetch --all` \* to update trackers*
`git rebase upstream/master` to rebase and play your commits on top
`git push -f` to fast forward your `patch-x` branch on github
5. After PR is merged you can just delete this branch by running
`git branch -D patch-x`
`git push origin :patch-x`
 Yeah, thanks. I saw that is already linked in the CONTRIBUTING guide. Just wanted to address rebasing because sometimes people's branches get all messed up and they have to open a new PR.
  Still reproducible per https://twitter.com/marcinignac/status/709880816449544192
 Ah, this will be solved by my PR: https://github.com/aframevr/aframe/pull/1112
 #1112 is merged. this appears fixed to me from my iOS tests.
  Moved to https://github.com/ngokevin/aframe-look-at-component/issues/1
   Ah, the rotation component must be overriding it?
 moved to https://github.com/ngokevin/aframe-look-at-component/issues/2
  Thanks for filing. Sorry, it's on file as issue #316. Will be fixed soon. We are prepping for our next release, 0.2.0. Stay tuned :smile: 
  I think you are setting `color="yellow"` for the entity. Setting `color` on the entity won't do anything. I think for entity, you will have to manually register an event listener in Javascript to set the color. I don't think those declarative events can handle setting a component property.
  I think this is an addressed issue on the `dev` branch where we bumped 3js to fix Android shader bugs.

Today, I think I will try to publish a patch version to master to address Android. Sorry we have not done this earlier. Thanks for reporting!
  They should be supported. Ping us on Slack for questions and let's see what's happening https://aframevr-slack.herokuapp.com/
   I like Rust's: https://www.rust-lang.org/conduct.html
  (Similar but different from #927.)

STR:
1. Load https://aframe.io/aframe/examples/showcase-spheres-and-fog/
2. Hold down the `Command` + `A` keys
3. Release the keys
4. Notice you keep moving left

For WASD controls, we should abort if `shiftKey`, `ctrlKey`, `altKey`, or `metaKey` are also being held.
 I think it affects all except perhaps `shiftKey`
  In 0.1.0 we had the concept of templates:

``` html
<template is="a-template"
          element="a-image"
          width="1.75"
          height="1.75"
          opacity="1.0"
          src="">
  <a-entity geometry="primitive: plane;
                      width: ${width};
                      height: ${height}"
            material="shader: flat;
                      src: url(${src});
                      opacity: ${opacity};
                      side: double;
                      transparent: true">
  </a-entity>
</template>
```

Because our primary use case has been to _extend_ entities for common use cases, we agreed to rethink "templates" (formerly known as "mixins" - not to be confused with `<a-mixin>`s, heh). And by rethink I mean remove until we've proven all the interesting use cases (and there certainly are some).

So instead of providing a declarative means of encapsulating one or many entities and exposing it as a custom element by some name (via the `element` attribute) through a `<template is="a-template">`, we've decided to use "primitives" as a way of extending entities.

The "old" templates are now not a high priority, but they're something we should not forget about and revisit some time.

If we don't want to enable devs to define templates from inline HTML (or HTML imports), we could introduce a JS API √† la `registerComponent` for registering templates. For inspiration, check out X-Tag's `xtag.register` (go to https://x-tag.github.io/ and check out the examples in `Docs > Content is King`).

<hr>

Relevant: PR #883
 If we decide to reintroduce declarative templates and allow them to be defined from HTML imports, we ought to revisit #579 and resolve that issue. If templates do get resurrected but in the form of a JS API, that's a non issue.
 Good sticky note, but not actionable at the moment/not an issue.
 I think we need a discussion about which types of bugs to file and which to keep in our heads. I file issues like these so that we can track our thoughts and point contributors to them.
 I just take things case-by-case. We file whatever and then we decide what to do with them.

For this issue, I felt it was ok to close since it was just a note that summed up to something like "we are removing templates, maybe sometime we can look at them later", which I'm predicting will be quite a ways out and our expectations will have changed.
 if we set the proper expectations for what's a valid issue to file, I'll know what I should bother filing - and what I should not bother filing and just make a personal mental note of.
 i just say file whatever seems right and we'll handle it. but we can chat more later
 Would also be good to think what an A-Frame templating layer would provide over existing templating solutions.
 I did have that idea earlier that you could add child entities to mixins, and those entities would get mixed into the scene when used. It's not template registration, but i like that.
 Not necessarily. While components change the appearance/behavior of an entity, mixins aim to make component property definitions reusable across the scene as a whole.
 Doing a lot of experiments with templating at https://github.com/ngokevin/aframe-templating-examples

I'm converging to a flexible template component which I think has an elegant and powerful API with more predictability the previous a-template/a-root implementations.
 @dmarcos and I talked and agreed any implementation would be too opinionated. It functions very well as a third-party library for now, and we can promote these elsewhere:

https://github.com/aframevr/aframe/pull/1384
  Have you tried https://github.com/Jam3/threejs-generate-gif?
 I think we should create a renderer scene component that allows the user to set the flags that three.js exposes. `preserveDrawingBuffer` among them. 
 I would do a renderer component for the scene that let you do:

``` html
<a-scene renderer="antialias: true; preserveDrawingBuffer: true; ‚Ä¶">‚Ä¶</a-scene>
```
 you're right. It might be confusing. Could we reinitialize the renderer if one of the values changes?
 @RSpace I have to update the docs. With `<ctrl> + <alt> + <shift> + s` you can take an equirectangular screenshot (aka 360 image)
 @chriscar you can take a screenshot programmatically if you do:
`sceneEl.components.screenshot.capture()` pass `perspective` as parameter if you want a normal screen capture `sceneEl.components.screenshot.capture('perspective')`
 https://github.com/aframevr/aframe/pull/2316 should allow it now?

Shader should now compile since it's just string concat via array join. Let me know if that's still an issue.

 @Esmolan Can you provide a link? Not sure what you mean by camera feed. `ctrl+alt+s` takes the screenshot below in `https://aframe.io/aframe/examples/showcase/anime-UI/` that it's what you would expect.

![screenshot-anime ui-1528137031829](https://user-images.githubusercontent.com/39342/40934776-c1cb6238-67ea-11e8-8626-291c750313af.png)
 I don't know how the camera feed is rendered in ar.js. It's probably not rendered in THREE and that's probably why it's not visible using the screenshot component. If you can bring that camera feed into THREE then it will be picked up automatically by the component. Render the camera feed as a texture. That's more of a question for AR.js folks. It will probably not be worth since it will likely degrade performance. I would look for alternative ways to take screenshots in ar.js. There;s not much we can do on the A-Frame side  We can provide a default spinner with a cool aframe logo animation shown while assets load. It also serves as an example for people to implement their own spinners if they don't want the default one. @cvan @ngokevin What do you think?
 I don't think this has been implemented. Just crossed my mind again; I've written up some thoughts on the component wishlist: 

https://github.com/aframevr/aframe-registry/issues/64 There's a work in progress https://github.com/aframevr/aframe/pull/2153 Nice! I'd been thinking of something in CSS (quick and easy; could be done as a third-party component, etc.). I assume you chose canvas instead so the loading screen could be visible in VR? Good point...   No, it's just to assist with user/developer errors. I mess this up sometimes.

Although I sort of want to deprecate `<a-animation>` for better solutions in the future, so this is not too important.
  see https://gist.github.com/cvan/eb86d3f45992575d9943
 We're going to document _everything_ we know :)
 Going to track and do this as a part of https://github.com/aframevr/aframe/issues/921 . I got it documented
  Confirmed bug
 "If you're texture is not a pow of 2 size one, don't use (or do disable) mippmapping on that texture minifier method."

http://stackoverflow.com/questions/13905652/non-power-of-2-texture-render-warning-in-chrome
 This also happens on Safari I believe, @mayognaise 
 Maybe https://bugs.webkit.org/show_bug.cgi?id=133511
 I found it works if the asset is on the same origin.
 Chromium and Safari are not respecting `crossOrigin/crossorigin`.
 Don't think this can be addressed soon, but I can at least document it.
 This certainly seems like a regression in Chromium. Wonder if it's specific to Brandon's builds or not. Will have to check.
 I just used the standard Chromium builds.
 see this relevant three.js issue: https://github.com/mrdoob/three.js/issues/8110

see this [relevant comment](https://github.com/mrdoob/three.js/issues/8110#issuecomment-198209586) of a relevant Safari/iOS issue: https://bugs.webkit.org/show_bug.cgi?id=125157#c29
 Confirmed by @davatron5000 that you can clear the cache to make it work on iOS if the `img` or asset was previously loaded without `crossorigin`. This is because iOS pulls it from the cache and doesn't recognize the new CORS flag.
  Fullscreening (entering VR) with iframes work with Firefox but not with Chrome
 This should be possible. Check out https://github.com/aframevr/aframe/blob/master/docs/components/canvas.md
 > This is probably the reason we'll need to abandon A-Frame for our project. It stinks, but we can't use the iframe solution.

Actually, this is supported now. Sorry, this issue didn't get closed with a mention of the proper pull request that enabled this to work.

@dmarcos worked on this for [A-Frame v0.3.0](https://aframe.io/blog/aframe-v0.3.0/) (also documented in [the release notes](https://github.com/aframevr/aframe/releases/tag/v0.3.0)). [Here's an example of a mock Wikipedia entry](https://aframe.io/aframe/examples/showcase/wikipedia/), demonstrating the ability to embed one scene (but could be multiple) in an existing 2D page alongside content.
 @cvan multiple scenes on a page do not work yet. It is complex to do. And the issue is still 
 I frames don't quite work entering fullscreen yet
 > I frames don't quite work entering fullscreen yet

even with `<iframe allowfullscreen>`? what's the issue? is there an issue on file in this repo?
 I'm actually not sure. I neglected the `allowfullscreen`. I remember it didn't work in CodePen. Need to check.
 Multiple scenes on the same page are not still supported directly. You could embed multiple scenes within iframes. @hawaiikaos  I'm closing in favor of I-Frames. three.js doesn't support multiple scenes with their own contexts either. > I'm closing in favor of I-Frames. three.js doesn't support multiple scenes with their own contexts either.

is the existing "embedded scenes" not a use case that A-Frame intends to support? @dmarcos' [Wikipedia example](https://aframe.io/aframe/examples/showcase/wikipedia/), for example, does not use `<iframe>`s; isn't that a valid use case A-Frame would want to support (especially considering how likely it would be for there to be two scenes on a web page)?
 @cvan The issue is about multiple scenes, not one embedded scene.

@brianblakely Sorry, it is not easily possible with three.js to have multiple embedded scenes with separate contexts. Even if so, it would require major refactor and energy to make it possible. A-Frame is focused on immersive WebVR meaning we'll be consuming one scene at a time in a headset and traversing between them in a headset. This is not going to be a sticking point in the long term at all. > @cvan The issue is about multiple scenes, not one embedded scene.

correct, see my comment above:

> (especially considering how likely it would be for there to be two scenes on a web page)

my point about the Wikipedia use case, is that there likely would be more than only one scene on a given Wikipedia page (just like there are multiple images, charts, tables, etc. on Wikipedia pages).

> Even if so, it would require major refactor and energy to make it possible.

I trust your assessment here. my fear is that we ought to not close issues because of today's constraints and efforts of the current core A-Frame developers. if we were to vote on this, I'd vote for this to remain an issue - not necessarily fix it any time remotely soon.

> A-Frame is focused on immersive WebVR meaning we'll be consuming one scene at a time in a headset and traversing between them in a headset. This is not going to be a sticking point in the long term at all.

this is a very large assumption actually - that all A-Frame scenes will be constructed as separate documents as scenes. (the recent influx of JS frameworks for supporting single-page, reactive apps I think is proof that we didn't always correctly predict future Web tech trends and evolved user expectations.)

also, we know how WebVR experiences are being delivered for consumption by users in Chrome for Google Daydream (and beginning to with Oculus Carmel). multi-tasking, preloading, shared messaging of scene/entity contexts, universal inputs - all that becomes incredibly complicated when an A-Frame scene is isolated to a single document (resulting in such workarounds as `<iframe>`s + `postMessage`).

√† la [DrawVR's "Escape Room" game](http://drawvr.com/escape/), users can carefully construct SPA-like experiences by separating levels/worlds in separate entities whose visibility are toggled appropriately.

then there is the case of unnecessarily duplicated code (and inability to easily share state). even if you have the best-in-class server-side caching and a Service Worker, the perf penalty is certainly _not_ negligible by loading three separate documents in `<iframe>`s for three different A-Frame scenes vs. one document for the same three scenes. you can reuse all the code that was fetched, parsed, and executed - those seconds, and even milliseconds, break _immersion_.

is there harm in keeping an issue open? I wouldn't want to see A-Frame issues getting closed without having a full community discussion.
 SPAs can swap entities in and out as you say, you can use the very same JS frameworks to implement the SPA logic; you don't need multiple scenes for that. Separate WebGL contexts can not share resources and are just as non-performant. Introducing multiple scene support will add more layers to maintain in the codebase. I also don't imagine Wikipedia ever embedding A-Frame scenes given the weight; a VR-specific parallel site would be more realistic.

Yes, there is harm because it draws focus and energy from more important issues (as seen from the amount of time discussing here). I'm happy to address feedback as I do interfacing with the community every day, but a full community discussion on every single issue would burn everyone out. 

Understand we're in a position where we're faced with 200+ open issues, many of which would not be worth spending time reviewing, maintaining, testing. I ask not to try to paint closing issues and triaging as a Bad Guy move.  I agree with @ngokevin keeping issues opened is not free. You have to manage the expectations around those bugs as long as they stay open and makes the direction and priorities of a project confusing. I would love to support multiple scenes. That was my longer term goal after the Wikipedia embedded scene. Affer analyzing perf and other implications like for instance the behavior of the inspector I decided that the effort was not worth it given the focus of our roadmap on VR immersive experiences.  Thanks for filing! There's an existing issue on file: #316. Sorry about the issue; we're working on a fix soon.
  That's not using A-Frame either, can you file it at https://github.com/MozVR/sechelt ?

Thanks!
  That actually isn't using A-Frame. A-Frame examples are at https://aframevr.github.io/aframe or http://aframe.io/examples
 The project is at https://github.com/MozVR/panorama-viewer
 (Filed as MozVR/panorama-viewer#11)
  Thanks for the PR! It's weird that the cursor doesn't work on mobile with a flat shading.If we change the shader to standard the cursor then will be affected by the lights in the scene and this is something you don't normally want. Let's investigate why the flat shading is not working for you.  Do you have a screenshot of the problem? 
 This might be due to the Android bug we fixed by bumping three.js. The shaders had some bugs on Android. It might work on the latest branch now.
 @sergioroja Have you tried if the bug is fixed on the dev branch?
  /cc @ngokevin 
 fixed when we bumped three, on our dev branch. we releasing a patch today
  Thanks for the feedback! Each entity can take one component of each type. If animations were components, How would you apply multiple animations to a single entity? How would an API to play animations in parallel or in sequence look like?
 We have https://github.com/aframevr/aframe/issues/732

I had an idea to refactor animations such that we create an imperative API and `<a-animation>` uses that API, but unfortunately we have a couple other priorities before we start to focus on improvements to the animation system.
  This is a Nightly issue, not A-Frame. You will get that error on most pages you will visit, and you will have to create a new Firefox profile. I ran into this.
 No problem, sucks that it corrupts your profile.
  Hi, we will support this with custom shaders https://github.com/aframevr/aframe/issues/880 alongside the extensibility with the custom component API we already have. These use cases can be implemented within the project rather than the core library. Thanks for filing!
  we wrap `setAttribute` and you can do for instance:

el.setAttribute('wasd-controls', { enabled: true, acceleration: 120 });

or to update a single property

el.setAttribute('wasd-controls', 'acceleration', 120);
 Going through the docs will help in understanding the entity-component system that A-Frame is introducing to the DOM. It's a new concept, but its composability over inheritance is powerful once learned. It's not actually complexity creep, it's actually the core and heart of A-Frame. If anything, helpers like `<a-cube>` can be considered creep.

If you want to update the component properties programatically, you can do:

``` js
el.setAttribute('wasd-controls', 'acceleration', 120);
// or...
el.setAttribute('wasd-controls', { acceleration: 120 });
```

Further reading: http://ngokevin.com/blog/aframe-vs-3dml/
 @potch We actually do all the components update within `setAttribute` to avoid the asynchrony of using `attributechangecallback`
 @potch in reall world applications you will potentially have thousands of entities and thousands of components. I prefer to see an entity and its associated components all in one place. We also explored a child/parent relationship but that results in confusion because you won't be able to differentiate what elements belong to your scene vs their associated components.
 Yeah, `setAtttribute` was made to run synchronously.

At this point, A-Frame is nearly a game engine and not just a toy, so naturally there will be some learning curve for traditional web developers. If we learn it, then we can appreciate the composability. There are solid reasons for the new syntax that overcomes the limitations of flat HTML attributes.

The problem with baking the logic into elements is that you lose complete flexibility such that it becomes useful to only a few people. That was always my problem with Web Component libraries like Brick. It looks pretty and succinct from the front, but in the end it's only as useful as the number of elements the maintainer ships and the attributes it exposes. 

With A-Frame, if someone ships, say, a Speech Recognition or Physics component, it can be plugged into any existing entity to modify its behavior today rather than having to ship and bake another Web Component.
 @potch the `setAttribute` wrapper only affects entity elements. In all the rest of DOM elements the default `setAttribute` applies
 Hm, at the moment, I'd say it's for web developers to easily create VR experiences. It's deceptively powerful, and we hope to resolve and improve messaging about it.

The DOM actually works nicely with entity-component. The DOM isn't just for writing static markup, but  it's also an interface. It's something web developers are familiar with, and we get interoperability with libraries like React, D3, and Popmotion for free. It greatly reduces the barrier to entry, although there are still concepts to learn.
 I like this translated-from-German quote from [this A-Frame article](https://translate.google.com/translate?sl=auto&tl=en&js=y&prev=_t&hl=en&ie=UTF-8&u=http%3A%2F%2Fthevrjump.com%2Fde%2Faframe-komponenten&edit-text=) by @rubenmueller

> So far, we have focused in the series of articles to A-frame on the basics and simple areas. It can quickly create the impression that A-frame something for beginners is more and nothing for experienced programmers \* inside or larger and complex projects.
> 
> Exactly the opposite is not the case: A-Frame enables especially in larger projects a clean structure and long-term expandability. I had already addressed this integration with the React Framework. 
 VR development tools are currently tailored to game / computer graphics developers. Even in JS world libraries like three.js / playcanvas / goo create are more appealing to a game developer wanting to deliver content in the Web than they are for a pure front end Web developer. A-Frame approaches the space from the other side of the spectrum. How can we onboard front end developers into the computer games/graphics domain? A-Frame fills a knowledge gap by letting people reuse some of the concepts and ideas that they already understand (that doesn't mean there are no new things to learn)
1. Entities are DOM elements and represent things that are rendered on screen.
2. Components with their CSS like syntax customize their appearance and behavior.
3. The events API is the same one you already know and use in the traditional DOM.
4. Web inspectors operate as expected
5. And as @ngokevin said. a-frame can easily integrate with existing front end libraries. We don't force people to give up the tools they already know and like.

A-Frame might become obsolete as Web Developers learn new skills. It will be worth the effort If a-frame just helps some people with the transition. Only time will say if a-frame is just an interim solution or delivers long term value. We have a bunch of features in the pipeline that we think enable interesting use cases that no other existing solutions offer today.
 @potch A-Frame will still have the `<a-camera look-controls-enabled="true" fov="80" acceleration="20">` syntax helpers for newcomers. We believe the extensibility and permissionless innovation enabled by entity-component is one of the core values of A-Frame and will not being going away

To help get past the style-like syntax, in the future we will have a stylesheet format for defining component properties.

Seriously, thanks for the feedback! Will be closing as not actionable.
  Related: https://github.com/aframevr/aframe/issues/857
 @enjalot if you replace your `a-cubes` with `a-entity`. Do you see the same problem?
 I don't think this is a problem with the cursor. If you wait for the animation triggered on mouseenter to finish and then you move the mouse out of the object the animation triggered on mouseleave plays consistently. I think it's a problem with having two animations playing at the same time.
 If it was cursor-related, this was probably fixed by e4900e16ea9228af39d2a4fef6798393e79bd82a.
 mouseleave is fixed, but this is a dupe of two animations at the same time https://github.com/aframevr/aframe/issues/857
  @misterburton Can you provide an example to reproduce?
 We believe it is a bug with the cursor. Manually registering the events, `mouseleave` still doesn't fire well.
 I don't think this is a problem with the cursor. If you wait for the animation triggered on mouseenter to finish and then you move the mouse out of the object the animation triggered on mouseleave plays as expected. The problem only reproduces if you move the mouse out of the object before the mouseenter animation finishes. I think it's a problem with having two animations playing at the same time.
 We have logged this in our next milestone: https://github.com/aframevr/aframe/issues/1036

The two animations are colliding, so introducing an `end` event may help. Feel free to submit a PR!
 Can do in https://github.com/ngokevin/kframe/tree/master/components/animation

Like: `startEvents: mouseenter; pauseEvents: mouseleave`  > `aframe.js:58458 The key "shrink-to-fit" is not recognized and ignored.`
 > Why should this be removed? It is needed so that layouts behave on iOS 9 and above. Yes it won't be recognized on devices other than iOS, so thus the warning. It is only a warning after all, not an error.

That warning was actually from the Safari remote debugger when I had connected my iPhone device.

Perhaps we should look into
https://github.com/bendrucker/meta-viewport-ios-9
https://github.com/gajus/scream
  Thanks for filing! We'll take a look the second we get our hands on a 5S.
 Going to dupe with https://github.com/aframevr/aframe/issues/967. 
  Thanks for filing! And very sorry about this issue.

> aframe.js:39054 THREE.WebGLRenderer: OES_texture_float_linear extension not supported.

Hmm, that's very interesting considering we don't have any textures whatsoever in the Hello World example. It could be that the [blank `url()` for `<a-sky>`](https://github.com/aframevr/aframe/blob/e49552/src/elements/templates/a-sky/index.html#L13) is causing this. I'm not sure.

I see mrdoob/three.js#6606 mention similar issues but it seems to be related to only videos and cubemaps.

I wonder if this error is even what's causing the black error though. Will need to investigate some more.
 @i3games: thanks for sharing that info - that helps. and sharing the snippet should help folks until this gets fixed in the upcoming release. appreciate it :+1: 
 is fixed on our dev branch, we will be releasing a patch today
  I think HMD-control should be its own component. When I was writing [fps look component](https://github.com/cemkod/aframe-fps-look-component), I found out mouse look and hmd look are coupled in a single component, so replacing one of them is not possible without duplicating code. 

[No click look controls](https://github.com/alexrkass/aframe-no-click-look-controls) also seems to hit this barrier and chose to duplicate the hmd tracking code in their component.

I think this should be more modular so that we can replace just the desktop look behaviour with a component.
 @dmarcos Does this sound good to go ahead with?
 I would like to keep look-controls as they are. We can have other components like `fps-controls` that will be used instead of `look-controls`. They will manage internally the different inputs mouse/hmd to move the entity accordingly.  I prefer to see purpose specific controls instead of a set of input method oriented ones. How you handle hmd/keyboard/mouse input is application specific.
 If it's split up, can we create purpose-specific controls that use dependency components like hmd-controls and mouse-controls and fps-controls?
 as @donmccurdy said making them composable is difficult. Composing rotations and translations in the way you want is tricky. It's better to just let each controls listen to the inputs they care about and handle the composition internally. I think self contained single purpose specific controls is a better approach 
 I think for now, we will recommend self-contained controls, even if they are duplicating logic for now. 
  This is because npm runs the npm directives through `cmd.exe` on Windows. We're using pure node scripts now on the (dev)[https://github.com/aframevr/aframe/blob/dev/package.json] brand and this problem will be fixed in the next release. Thanks for reporting.
  Controls should be non-opinionated and should be free to swap out, but for an out-of-the-box experience, we should use some form of pointer lock rather than click/drag (on desktop, maybe VR mode only?).
 Here is my implementation of pointer locked look controls for reference: https://github.com/cemkod/aframe-fps-look-component
 I don' think lock by default it's the more sensible since an aframe scene can share space with other content in the page
 I would prefer to have a separate set of controls to provide that functionality as @cemkod has done. theres's a lot of value on keeping components as simple as possible. There will be less bugs and make it easier for people to understand them and do derivative work. @RangerMove would it make sense to you to see look-controls (with no pointer lock) and a different set of fps-controls (with pointer lock)?
 @dmarcos: Please see: https://github.com/aframevr/aframe/issues/850 as it is somewhat relevant.
Currently a component like the fps look control i made needs to duplicate hmd controls too, otherwise it camera doesn't work as expected on vr mode.
 Pointer lock only on focus or full screen would allow for multiple scenes. Separate components sound good. Until we resolve our component consumption story, might be worth pulling into standard components.
 Thanks! @alexrkass I point to your examples so people can have a quick look:

https://alexrkass.github.io/no-click-example/

http://alexrkass.github.io/aframe-thetarestricted-example/
 I definitely think we should _support_ Pointer Lock. But I'm not sure if Pointer Lock should be the default. IMO the main reasons would be (1) Pointer Lock, though very useful, is not super common on the Web so it might be confusing for users, and (2) Firefox still prompts for permission first (Chrome doesn't, fwiw). I mentioned some pros and cons of using Pointer Lock in this issue: https://github.com/alexrkass/aframe-no-click-look-controls/issues/1#issue-126760588
 Pointer lock _upon entering fullscreen / VR_ would be the default. Mousedrag is a bit irritating for first-person scenes.
 > Pointer lock upon entering fullscreen / VR would be the default.

IMO, a gamepad is the ideal experience. Though I saw you closed #785 since we probably don't want to introduce gamepad support in the core aframe lib. I'd rather us have stellar out-of-the-box gamepad support for many controllers. And if we detect the presence of a gamepad we use that. Otherwise, we fall back to these mouse/WASD controls (or Pointer Lock, in the case of FPS).

> Mousedrag is a bit irritating for first-person scenes.

Yeah, good point. I totally agree.
 Also, FWIW, I filed this back in September as #471
 See my good comment [here](https://github.com/aframevr/aframe/issues/471#issuecomment-190048811)
 https://github.com/aframevr/aframe/pull/1248#discussion_r60652822

We're going to publish pointer lock as a third-party controls. The direction of A-Frame is veering more towards serious VR rather than flat experiences. Mousedrag is the bare minimum default controls for non-VR users to at least look around. But if you want to design for flat experiences, the components/controls will be available
 @ZhuJo I would open an issue on https://github.com/alexrkass/no-click-look-controls 
It's also not that big, just 262 lines. I see that the `dist` is including A-Frame itself and it should not. Try to create your own controls by using only the component code: https://github.com/alexrkass/aframe-no-click-look-controls/blob/master/index.js On a quick glance I don't see any reasons why it should not work with A-Frame 0.7.1  From @brianchirls on [WebVR Slack](https://webvr.slack.com/messages/help-and-bugs/):

> **brianchirls [5:53 AM]**
> @joshcarpenter et al: I ran a quick CPU profile of a-frame, and it looks like raycasting is the slowest thing. I‚Äôll be working on my own optimized solution for that today and will let you know what I find out. But‚Ä¶a good way to speed it up is to turn off raycasting for photo spheres, since they‚Äôll ‚Äã_always_‚Äã show up wherever you look. Or even exclude any objects that don‚Äôt have an event listener or something on them.
 Thanks for analysis and raising the performance issue. In the issue you posted there's a link to an octree based raycaster implementation. I think this should be fixed on the three.js side. @brianchirls Do you think there's something on the aframe side we should do?
 The easiest thing I plan on doing is adding options to the raycaster component to whitelist (and possibly ignore) targets. Then reflect that in the cursor component.

Clear color rather than single-color skyspheres would also be a good enhancement.
  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Nov 26, 2015 at 03:25 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/532_

---

Am getting lots of feedback about using DAE in A-Frame. Feedback seems pretty unanimous that DAE is an awful format for end user delivery, and outdated in broader industry. I think we need to seriously consider whether we want to encourage it's use by including in A-Frame. Switching to GLTF would (apparently, I haven't had time to look into it deeply) give performance and load time benefits.

I've pinged the internal games mailing list for their opinion. In meantime we should be look at level of effort to switch from DAE to GLTF in A-Frame. Tony says his new Three.js GLTF importer should be ready soon.

eg:

https://www.reddit.com/r/WebVR/comments/3scbtx/video_the_mozvr_team_talks_about_their_new_aframe/

> a-frame supporting DAE would be like img tags supporting PSD. It sounds kinds nice and super-convenient. But, it's also a very sure plan to give webvr a solid reputation for being embarrassingly slow to load.
> 
> DAE is explicitly designed to be an editor format and explicitly not designed to be an end-user delivery format.
> 
> Although I can see many arguments in favor of making DAE convenient to embed in the web, I must strongly recommend against it. Instead, promoting DAE -> glTF converters as the equivalent of PSD -> PNG (an important step in the sensible and responsible process required to respect the users bandwidth/time) would be much better in the long run.
> 
> edit: Just in case FBX, OBJ or STL support is also planned, I'll also recommend thinking more than twice about reconsidering their support. Frankly, glTF (preferably compressed) is the first simple, non-proprietary 3D model format I'm aware of that isn't ridiculously bad for end-user delivery.

Also: https://twitter.com/albertomoss/status/649646033790631936

> FWIW, Collada is basically dead in the CG industry. No idea who, if anyone, is still using it in production.
> Alembic mostly for meshes. FBX is still used in some instances. OpenVDB for volumes.

Tony Parisi reports (via WebVR Slack discussion):

> The official glTF repo has the latest Three.js loader, which is ‚Äã_almost_‚Äã done: https://github.com/KhronosGroup/glTF
> branch threejs-importer has the truly latest. i need another week or so, squashing some serious bugs with skinning
> after that I will send Ricardo a PR and it should get into the Three.js repo shortly after that
> glTF spec itself is ready, version 1.0 shipped

Using DAE-to-GLTF converter I could start exporting GLTF files from C4D tomorrow.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Nov 26, 2015 at 03:29 GMT_

---

Tony's WIP Three.js GLTF loader is here (KhronosGroup/glTF, `threejs-importer` branch):

https://github.com/KhronosGroup/glTF/tree/threejs-importer/loaders/threejs
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Nov 26, 2015 at 03:30 GMT_

---

Jeff Gilbert responds on Games mailing list:

> PNG for 3D is sort of the goal for GLTF. (Really more of a modern .obj format)
> I haven't looked too closely at it, as it's something that exists largely independent of platform APIs.
> It sounds like a good idea for your usecase, though.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Nov 26, 2015 at 03:36 GMT_

---

Re dependency sizes, wrt to https://github.com/KhronosGroup/glTF/tree/threejs-importer/loaders/threejs, Tony says:

> these files are used:
> glTFLoader.js
> glTFLoaderUtils.js
> glTFAnimation.js
> glTFShaders.js
> glUtilities.js
> about 100k of source which should minify down to nothing
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Nov 26, 2015 at 03:41 GMT_

---

Highly recommend this Twitter thread for various smart people's take on current C4D & Three.js workflows: 

https://twitter.com/mrdoob/status/649657743574466560
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Friday Nov 27, 2015 at 17:18 GMT_

---

More feedback from Vlad:

> Yep, what jeff said. Collada is really a tool interchange format, it was never good (or intended for) direct asset loading.  GLTF is designed for explicitly that (and conversely, is not great for interchange -- you'd use collada to ship stuff between various tools, then do a final bake/cook into GLTF).

And @kearwood:

> +1 for GLTF as a run-time format. Note that GLTF also has the capacity to encapsulate an entire scene, but in a less human-friendly (although json based) format.  A broader topic may be to determine the interaction between the GLTF imported scene graph nodes and those declared with a-frame syntax.  For example, Unity deals with this by presenting similar UX as a prefab within the editor and IIRC allows you to traverse these nodes as regular scene graph nodes through its api.  Exposing these interior nodes from the GLTF format may be necessary when rigged models are supported within a-frame.
 <a href="https://github.com/dmarcos"><img src="https://avatars.githubusercontent.com/u/39342?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [dmarcos](https://github.com/dmarcos)**
_Sunday Nov 29, 2015 at 23:32 GMT_

---

We currently support OBJ and Collada formats. Investing in GLTF in the long term might be the way to go. In the short term, the spec is not finalized and there's no content out there published in GLTF. Most of the `aframe` users won't create their own models and will want to use premade assets. None of the sites out there with free content will be useful for them. 
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Monday Nov 30, 2015 at 01:35 GMT_

---

Regarding the spec, [the word](https://github.com/KhronosGroup/glTF/issues/473#issuecomment-154710317) from Khronos is:

> It is still technically a draft since the spec is going through Khronos ratification; however, we do not expect any significant changes.

Having looked into this further, I agree that it's probably too early to go with gLTF only. I've been trying to use the converters today and the workflows are all pretty rough. Or based on the outdated 0.8 spec. I instead will change this issue to "Add support for gLTF", instead of "switch to"
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Monday Nov 30, 2015 at 02:28 GMT_

---

Woot. Got a workflow going here by using Tony's latest loader from the glTF repo and the Cesium Collada to GLTF converter:

<img width="1440" alt="gltf-workflow" src="https://cloud.githubusercontent.com/assets/1425497/11462275/eed5cfa4-96c6-11e5-9ed7-7f7819f4ec55.png">

https://github.com/KhronosGroup/glTF/tree/threejs-importer/loaders/threejs
http://cesiumjs.org/convertmodel.html
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Monday Nov 30, 2015 at 05:15 GMT_

---

Initial promising results have turned into new dead ends:
- Cannot get textured modes from DAE source --> [Cesium Converter](http://cesiumjs.org/convertmodel.html) --> new glTF loader. Have tried lots of different approaches, with no luck.
- The `.gltf` source from the Cesium Converter looks different (much more verbose) than the files included in the gltf repo. Even when I use identical source DAE files. Makes me think the repo models were converted with the command line 
- I tried switching to the command line tools, and there too, I hit problems, as documented here: https://github.com/KhronosGroup/glTF/issues/494

Overall impression is the workflow is still half baked. If I could find a reliable Cinema4D to textured GLTF pipeline we'd be set. But for the time being it doesn't look possible.
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Monday Nov 30, 2015 at 07:10 GMT_

---

> - Cannot get textured modes from DAE source --> [Cesium Converter](http://cesiumjs.org/convertmodel.html) --> new glTF loader. Have tried lots of different approaches, with no luck.

The monster model in the [the three.js example](http://threejs.org/examples/webgl_loader_gltf.html) looks like it was converted from the COLLADA model from the [original source](http://www.3drt.com/3dm/free/3drt.com-free-monster-animated-character.zip): https://github.com/mrdoob/three.js/blob/master/examples/models/gltf/monster/monster.dae
https://github.com/mrdoob/three.js/blob/master/examples/models/gltf/monster/monster.json#L2436

The duck model used in the same [three.js example](http://threejs.org/examples/webgl_loader_gltf.html) looks like it was converted from a COLLADA model: https://github.com/mrdoob/three.js/tree/master/examples/models/gltf/duck#readme
https://github.com/mrdoob/three.js/blob/master/examples/models/gltf/duck/duck.json#L61

Tony added both of those models.

> - The `.gltf` source from the Cesium Converter looks different (much more verbose) than the files included in the gltf repo. Even when I use identical source DAE files. Makes me think the repo models were converted with the command line 

This converter is actually backed by a simple Node service that just calls the command-line `collada2gltf` binary directly (with simple input, output, and some undocumented flag [at least not in `./collada2gltf -h`] called `-e` [which seems to _embed_](https://github.com/AnalyticalGraphicsInc/collada2gltf-web-service/blob/master/lib/collada2gltf.js#L29) the resources [e.g., shader files]):

https://github.com/AnalyticalGraphicsInc/collada2gltf-web-service/blob/master/lib/collada2gltf.js#L47-L50

> - I tried switching to the command line tools, and there too, I hit problems, as documented here: https://github.com/KhronosGroup/glTF/issues/494

Commented on how to get CLI working here: https://github.com/KhronosGroup/glTF/issues/494#issuecomment-160538331
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Monday Nov 30, 2015 at 07:18 GMT_

---

> - Cannot get textured modes from DAE source --> [Cesium Converter](http://cesiumjs.org/convertmodel.html) --> new glTF loader. Have tried lots of different approaches, with no luck.

If you run `./collada2gltf` without the `-e` flag, that'll get you what you want.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Monday Nov 30, 2015 at 07:31 GMT_

---

> This converter is actually backed by a simple Node service that just calls the command-line collada2gltf binary directly (with simple input, output, and some undocumented flag [at least not in ./collada2gltf -h] called -e which seems to embed the resources [e.g., shader files]):

Yeah I came across some of these undocumented commands earlier today in convertAll.sh: https://github.com/KhronosGroup/glTF/blob/master/sampleModels/convertAll.sh

Make standard glTF:
`collada2gltf -d -f sourcefile.dae -o outputpath/outputfile.gltf`

Use `-e` flag to embed assets:
`collada2gltf -d -e -f sourcefile.dae -o outputpath/outputfile.gltf`

Use `-k` flag for MaterialsCommon
`collada2gltf -d -k -f sourcefile.dae -o outputpath/outputfile.gltf``

And there also seems to be a ModelConverter for outputing binary glTF:
`ModelConverter -b -i sourcefile.dae -o outputpath/outputfile.glb`

I haven't had time to pick through the glTF spec, but it based on examples like the [CesiumMilkTruck](https://github.com/KhronosGroup/glTF/tree/master/sampleModels/CesiumMilkTruck) it looks like standard glTF leaves everything unbundled, and binary, embedded and MaterialsCommon all have varying levels of optimization/bundling.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Monday Nov 30, 2015 at 07:34 GMT_

---

> The monster model in the the three.js example looks like it was converted from the COLLADA model from the original source. . . . Tony added both of those models.

I've been working with those models as well as others from the glTF repo, and comparing them with DAEs from C4D. There's not much consistency in results, unfortunately. Even among the "canonical" models.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Monday Nov 30, 2015 at 07:35 GMT_

---

> Commented on how to get CLI working here: KhronosGroup/glTF#494 (comment)

I saw that! Thanks :+1: 
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Monday Nov 30, 2015 at 07:50 GMT_

---

Ah, here we go:
<img width="734" alt="collada2gltf-commands" src="https://cloud.githubusercontent.com/assets/1425497/11466190/052ff504-96f4-11e5-837b-4a6df4f5d0db.png">
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Friday Dec 11, 2015 at 09:49 GMT_

---

Paused this until after initial launch
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Friday Jan 08, 2016 at 02:06 GMT_

---

Excellent scene, but this is a prime example of why COLLADA files are too big + not suitable for Web scenes: http://asadotzler.github.io/

![](https://cloud.githubusercontent.com/assets/203725/12188459/6e7282ae-b56a-11e5-840a-27a124180555.png)
 <a href="https://github.com/kliang3"><img src="https://avatars.githubusercontent.com/u/16121115?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [kliang3](https://github.com/kliang3)**
_Monday Jan 11, 2016 at 17:11 GMT_

---

Hi @jcarpenter  @cvan, is support for a gLTF loader available in a-frame?  
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Monday Jan 11, 2016 at 19:16 GMT_

---

@kliang3: it's on the roadmap. we've been waiting for gLTF stability before add support. there are several upcoming changes to the THREE.js loader we've heard.

it's just a matter of adding the THREE.js loader (and keeping it up to date, likely using [`three-dev`](https://github.com/ngokevin/three-dev)):
https://github.com/mrdoob/three.js/blob/dev/examples/webgl_loader_gltf.html
https://github.com/mrdoob/three.js/blob/dev/examples/js/loaders/gltf/glTFLoader.js

anyone is welcome to help here. but we'll keep this issue up to date. let us know if you have any other questions.
 Support has landed on three.js https://github.com/mrdoob/three.js/pull/8316
 Yep, I saw - we should test
 Nice work! https://github.com/xirvr/aframe-gltf

This will become "out-of-the-box" once we have component lazy-loading.
  <a href="https://github.com/cemkod"><img src="https://avatars.githubusercontent.com/u/4003996?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cemkod](https://github.com/cemkod)**
_Wednesday Jan 13, 2016 at 00:55 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/793_

---

Device: Nexus 7 II
Browser: Firefox 43.0

When running the examples, there is a constant stream of the following error message in console log:
`Invalid timestamps detected. Time step between successive gyroscope sensor samples is very small or not monotonic`

Gyro controls seem to be responsive with no lag.
 @eskalera Is this still an issue on master?
 @jsantell sweet! thanks.  <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [ngokevin](https://github.com/ngokevin)**
_Tuesday Jan 12, 2016 at 06:46 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/790_

---

If you make a small typo like `<a-entity geometry="primitive box;">`, it fails silently.
 We log the component name now, should be good.  <a href="https://github.com/joshkpeterson"><img src="https://avatars.githubusercontent.com/u/2294194?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [joshkpeterson](https://github.com/joshkpeterson)**
_Friday Jan 08, 2016 at 21:54 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/775_

---

When viewing the example in the package at examples/template-video/index.html on mobile devices, all I see is a black rectangle where the video should be.

Chrome 47.0.2526.83 on Android 5.1.1 Samsung Note 5
Safari on iOS 9.0.2 on iPhone 6 

There are no javascript errors when running this on Android Chrome. 

The example at http://threejs.org/examples/#canvas_materials_video is giving me similar results, perhaps I should escalate to threejs? (Edit: created an [issue there too](https://github.com/mrdoob/three.js/issues/7932))

I've tried a bunch of different video file formats on different browsers/devices, and results are very uneven and scattered, but I couldn't get any video files to work on mobile whatsoever except I got this example to work in firefox on Android.

I could list out everything I've tried, but since sharing and working with video files is kind of cumbersome, let's see if we can get _just this one_ video file to work on mobile chrome/safari first. 

Thanks!
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Saturday Jan 09, 2016 at 02:04 GMT_

---

Thanks for the detailed issue. Unfortunately, this is a known issue. See original issue filed here: aframevr/aframe#316.

It has to do with Chrome for Android disabling `<video>` autoplay by default; you have to play a video upon a user-initiated event. We'd love if the platform just supported it out of the box, but likely for some time things aren't going to change. In the meantime, I'm going to introduce a "play" button that will start the videos that are detected on the page (if any).
 <a href="https://github.com/joshkpeterson"><img src="https://avatars.githubusercontent.com/u/2294194?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [joshkpeterson](https://github.com/joshkpeterson)**
_Saturday Jan 09, 2016 at 05:48 GMT_

---

Whoops thanks, that slipped by me. It would be great to have a little documentation or example on how to incorporate user input to trigger a play on a video, I tried quickly but must have had something wrong.
  <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [caseyyee](https://github.com/caseyyee)**
_Friday Jan 08, 2016 at 00:24 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/773_

---

Anti-aliasing is not working with A-Frame examples in Firefox.

It appears to be a A-Frame issue since mozvr.com examples (that are not A-Frame) seem to work fine.

Using Windows 10, Firefox Nightly, Oculus 0.8 runtime.
 <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [caseyyee](https://github.com/caseyyee)**
_Friday Jan 08, 2016 at 00:26 GMT_

---

I should also mention that I am running a NVDIA GTX 780, which is not blacklisted (unlike ATI R9).
 <a href="https://github.com/dmarcos"><img src="https://avatars.githubusercontent.com/u/39342?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [dmarcos](https://github.com/dmarcos)**
_Friday Jan 08, 2016 at 14:52 GMT_

---

Antialiasing is disabled. We saw a big performance boost by disabling it.
Performance takes priority over image quality.
 Disabled by default, can reconsider in a later issue if needed
  <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [ngokevin](https://github.com/ngokevin)**
_Wednesday Dec 23, 2015 at 17:57 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/748_

---

Want to be able to have positional audio from a video which would require a separate sound entity and a video-textured entity. Sound component accepting a video source would allow them to sync.
  <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Saturday Dec 19, 2015 at 14:11 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/725_

---

JS Bin, JS Fiddle, and many online code editors that embed pages do so using just an `<iframe>`. This means when we `requestFullScreen({vrDisplay: vrHMD})`, the browser blocks the ability to enter fullscreen/VR mode.

So actually when you click on the enter VR button, we enter stereo, the button disappears, but we don't actually enter fullscreen mode.

Load http://bl.ocks.org/enjalot/8be32e6f1f32920ba841 for example
And see the console:

> Request for full-screen was denied because at least one of the document's containing iframes does not have an "allowfullscreen" attribute.

<hr>

CodePen, thankfully, does `<iframe allowfullscreen="yes">` so we're good there :heart_eyes:. We should look into reaching out to JS Bin and JSFiddle seeing if they would be willing to allow bins to enter fullscreen. In just the past few days, I've seen many folks creating their own JS Bins even though we have a forkable CodePen ready to use. So, there's definitely folks out there who could benefit from this.

So, let's first fix the Enter VR button when we failed to actually enter VR. We can provide some error state - some icon with messaging. Then we can do do some outreach to get folks to allow codebin services to allow entering fullscreen on iframes. And hopefully sometime next year we'll have an API that replaces `requestFullScreen` so we don't have any of these issues.
 @cvan originally filed the issue. I haven't seen much use of embedded bins, but have seen some share the full editor around. It would be a bit more useful to fullscreen embedded scenes given their smaller size.

But the new WebVR API no longer depends on fullscreen which makes this less of an issue.
 API no longer depends on full screen. Don't think it should be A-Frame to handle runtime compat warnings with third-party playground sites. We are recommending Glitch/CodePen which does not have this problem.  <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Friday Dec 18, 2015 at 01:34 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/704_

---

https://aframe.io/aframe/examples/showcase-shopping/?mode=vr doesn't seem to force stereo. Perhaps we want `?mode=stereo`, idk.

Per https://webvr.slack.com/archives/declarative-vr/p1450387507000072
 <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [caseyyee](https://github.com/caseyyee)**
_Friday Dec 18, 2015 at 05:34 GMT_

---

Yeah, I think its useful to force stereo.   You wouldn't be able to so otherwise unless you are on mobile using a VR enabled browser.
 <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [caseyyee](https://github.com/caseyyee)**
_Friday Dec 18, 2015 at 05:40 GMT_

---

Also would be useful to have a function call to do the same.
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Friday Dec 18, 2015 at 05:45 GMT_

---

And a `postMessage` call.
  <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Wednesday Dec 16, 2015 at 00:55 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/669_

---

So we don't have to manually write data URIs :+1: 
 done long time ago
 Nevermidn
  <a href="https://github.com/dmarcos"><img src="https://avatars.githubusercontent.com/u/39342?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [dmarcos](https://github.com/dmarcos)**
_Tuesday Dec 15, 2015 at 18:05 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/663_

---

The goal is to make the concept of mixin easier to grasp by Web Developers. This is an example taken from Twitter bootstrap:

``` html
 <div class="dropdown"></div>
```

Our entities would look like:

``` html
<a-entity class="cube"></div>
<a-class geometry="primitive: box" material="color: red"></a-class>
```

Not 100% sure if this is a good idea because our mixins behave a bit differently than CSS classes. For instance, mixins are dynamic as opposed to classes being static. You can change the list of classes for a given element but you cannot modify an existing class at runtime.  Our classs will also be defined in the DOM and not in a style sheet. 
 <a href="https://github.com/dmarcos"><img src="https://avatars.githubusercontent.com/u/39342?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [dmarcos](https://github.com/dmarcos)**
_Tuesday Dec 15, 2015 at 18:13 GMT_

---

We could provide primitives that help people getting acquainted with the E/C arquitecture.  It would be an `a-frame bootstrap` library with a set of mixins/classes to create basic elements. Specialization will still work as you would expect. If you want to make a green cube you would do:

``` html
<a-entity class="cube" material="color: green"></a-entity>
```
 I think mixin is more clear on what it does. We can still have the bootstrap idea but with mixins.

`class` might be used by developers for running querySelectors later rather than applying mixins, so we don't want to conflate the two.

Re-open if you think there's a good case for this.
  <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Tuesday Dec 08, 2015 at 21:19 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/627_

---

If I na√Øvely create a `<video autoplay="false">`, the video will still autoplay.

See http://codepen.io/team/mozvr/pen/6b5b73a9b78c8e3d315d6976723da3a1/

The `<video>` element has been [spec'd to be kind of weirdly](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#Attributes).

It'd be nice to prevent such footguns (or handle logic in templates - but primitives will solve).
 <a href="https://github.com/dmarcos"><img src="https://avatars.githubusercontent.com/u/39342?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [dmarcos](https://github.com/dmarcos)**
_Thursday Dec 10, 2015 at 05:28 GMT_

---

Fixed in https://github.com/cvan/aframe-core/commit/45cc4099e66850125d9f1d8923ba4c97fc021c98
  <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [ngokevin](https://github.com/ngokevin)**
_Friday Dec 04, 2015 at 03:19 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/593_

---

does one browser have positional audio and the other doesn't?
 <a href="https://github.com/dmarcos"><img src="https://avatars.githubusercontent.com/u/39342?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [dmarcos](https://github.com/dmarcos)**
_Monday Dec 07, 2015 at 18:11 GMT_

---

Just curious. Do you see the same problem in other WebAudio demos?
 <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [ngokevin](https://github.com/ngokevin)**
_Monday Dec 07, 2015 at 21:47 GMT_

---

It looks like the Audio was positioned different in chrome than Firefox 
 I'll have to try again at some point and post a test case.
 I found that if you position the sound at the level of your head, a bit forward, it sounds pretty fine:

``` 
<a-entity position="0 1.7 -0.5" sound="src: #soundAsset; autoplay: true;"></a-entity>
          ^^^^^^^^^^^^^^^^^^^^^
```  This happens when the audio source is exactly on the same plane as the camera and you move the camera cut across the plane perpendicularly.

e.g., `<a-entity sound position="0 0 0">` and `<a-camera position="0 1.6 0">`.   <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Saturday Nov 21, 2015 at 00:16 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/499_

---
 Accidentally closed during merge
 Reference to the three.js animation system:

https://github.com/mrdoob/three.js/tree/master/src/animation
 I think this is not relevant anymore. We have to talk about moving the animation system out of the core.
  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Friday Nov 20, 2015 at 23:32 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/498_

---

It will be common to superimpose images w/ alpha channels. There is a currently a footgun where order of declaration in the DOM must be carefully managed, or transparent elements will cull each other.

For example, in the AnimeUI test scene in A-Frame, I have a series of transparent images arranged on the z-axis. I must declare them in order of depth, furthest from camera to closest, or I get blending problems.

``` html
<vr-image src="images/schematic1.png" width="7" height="7" position="0 0 -6"></vr-image>
<vr-image src="images/ring2.png" width="3" height="3" position="0 0 -2"></vr-image>
<vr-image src="images/ring1.png" width="0.5" height="0.5" position="0 0 0"></vr-image>
```

This is what it looks like when the user takes the correct steps:

![anime-ui](https://cloud.githubusercontent.com/assets/1425497/11314580/b3768a20-8f9b-11e5-97d4-a49b65d7f3ca.png)

This is problematic because:
- The failure state is obvious and ugly
- The cause will not be obvious to users
- The resolution is sometimes not feasible. The point of A-Frame is grouping elements to fit your scene layout and mental model. The current resolution forces you to group things by z-axis.

We should solve this automatically for users.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Friday Nov 20, 2015 at 23:34 GMT_

---

I believe Jaume refers to this issue in a recent tweet re: OIT (order independent transparency):

https://twitter.com/mrdoob/status/667835175108112384

Paging @caseyyee who's dealt with this before. Perhaps @fernandojsg also has some suggestions.
 <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [caseyyee](https://github.com/caseyyee)**
_Saturday Nov 21, 2015 at 00:19 GMT_

---

I've had to fiddle with a bunch of different properties in the past.   I really don't fully understand how each one works under the hood, but if re-arranging the order in which objects are added to the scene doesn't work, i've used some of these properties in different combinations to get things working:

`Mesh.renderOrder`
Controls the order in which objects are rendered.

`Material.depthTest=false`
Whether to have depth test enabled when rendering this material. Default is true.

Here's a good fiddle I found that demonstrates the combo:
http://jsfiddle.net/sg02e5sm/2/

`Material.alphaTest`
Sometimes the alpha on the texture itself is problematic.   Adjusting this value can make it work properly.   It does clip data sometimes though if you are not careful.

`Renderer.sortObjects`
Defines whether the renderer should sort objects. Default is true.

Each of these have different impacts on perf as well (especially forcing sort order).

As per @jcarpenter, The user shouldn't have to deal with any of this.    I think we could probably be intelligent with how objects are sorted in the scene to make it work for most people.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Saturday Nov 21, 2015 at 02:18 GMT_

---

More from Doob: https://twitter.com/mrdoob/status/667850994068422656

> I fear OIT cant be easily solved by mere mortals like us in the application layer. GPUs should solve that for us...
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Saturday Nov 21, 2015 at 02:18 GMT_

---

Adding @kearwood to thread also...
 <a href="https://github.com/fernandojsg"><img src="https://avatars.githubusercontent.com/u/782511?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [fernandojsg](https://github.com/fernandojsg)**
_Saturday Nov 21, 2015 at 09:57 GMT_

---

Yes as mrdoob says it's not an easy problem and there're a lot of papers about how to do a real OIT.
@caseyyee pointed some properties that can be use for simple scenes and mainly for billboards as the one used on particles that they're just simple planes. 
The problem is when the objects intersect between them, just as simple as like two boxes colliding. If two boxes intersect each other you can't fix it by change the rendering order, in that case you should split the faces and do a sorting for faces not objects. In this case the sorting is a huge bottleneck.
One step further is when some faces intersect each other in this case, the most general one, you need to sort by fragments not just even by faces, so the result is a huge performance problem.
So as mrdoob pointed the only easy solution could be that the GPU would take care of that for the most general case, meanwhile I believe we could just rely on this kind of tricks and simple properties to finetune our scene :disappointed: 
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Nov 26, 2015 at 04:06 GMT_

---

Just spent 20 minutes trying to figure out why animating opacity on a foreground element was making all other images in the scene disappear. It‚Äôs because they were further away in z-space, and I forgot to take into account this issue. I definitely foresee some huge user confusion on this one...
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Sunday Nov 29, 2015 at 22:28 GMT_

---

Sent email to Games mailing list about this...
 `material="alphaTest: 0.5"` seems to magically help in most cases. I'm not sure why that's disabled. @dmarcos, aware of any history? As far as I remember it was disabled to favor manual control. We can revisit. I have not dealt much with transparent objects so no familliar with all the problematic of automatic sorting. +1 for defaulting to `true` with an option to disable. Here is an example: https://gltf-viewer.donmccurdy.com/#model=https://raw.githubusercontent.com/KhronosGroup/glTF-Blender-Exporter/master/polly/project_polly.gltf

^Large file; best viewed on desktop.

| angle 1 | angle 2 |
|---|---|
| ![screen shot 2017-11-29 at 2 55 05 pm](https://user-images.githubusercontent.com/1848368/33403464-5b8681f0-d515-11e7-9f96-2462b80b2df3.png) | ![screen shot 2017-11-29 at 2 55 08 pm](https://user-images.githubusercontent.com/1848368/33403467-5dc91252-d515-11e7-970f-8565026db869.png) |


As you rotate the scene around, watch the glass display sign at the front of the scene. The "Polly" text will appear and disappear from the sign, depending on camera orientation, because of transparency sort issues. This type of problem cannot be trivially solved in WebGL... the proper solution here would be for the artist to split the mesh of the glass casing in two parts, so that transparency sort will resolve correctly. Scene tree order isn't used, the order is:

1. draw opaque objects, in order from furthest away to nearest.
2. draw transparent objects, in order from furthest away to nearest.

Three.js does expose an [`object.renderOrder`](https://threejs.org/docs/#api/core/Object3D.renderOrder) property to override sort order. You can also turn off the depth sort, in which case order is probably based on the scene tree but I'm not sure. Related reading: https://www.khronos.org/opengl/wiki/Transparency_Sorting

Usually three.js's defaults are what you want. A-Frame does not currently expose an HTML attribute to override sort order, but this is easy to implement. I do still say +1 for removing that line. Even better (IMO) would be to create  a `renderer` scene component exposing a few more advanced options:

```html
<a-scene renderer="sortObjects: true;
                   gammaOutput: true;
                   physicallyCorrectLights: true">
  ...
</a-scene>
```

^The other two properties I suggest are required for "technically correct" glTF rendering. These can be done in user-land components, but to change `gammaOutput` you have to recompile every shader in the scene, so it's definitely preferable to have that set correctly during initialization. Suggested a fix in #3424, and we could leave the default `sortObjects=false` while still allowing others to override it. For what it's worth, since I don't see it mentioned elsewhere in the thread, it is easy to do a component patching this as needed:

```js
AFRAME.registerComponent('my-renderer-settings', {
  init: function () {
    var sceneEl = this.el;
    sceneEl.renderer.sortObjects = true;
    sceneEl.renderer.gammaOutput = true;
  }
});
```  <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Wednesday Nov 18, 2015 at 23:07 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/480_

---

It's currently `#fff` outside of VR mode but `#000` when you enter VR mode.
 <a href="https://github.com/dmarcos"><img src="https://avatars.githubusercontent.com/u/39342?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [dmarcos](https://github.com/dmarcos)**
_Monday Nov 23, 2015 at 18:58 GMT_

---

The canvas where we paint the scene has transparent background. When we go fullscreen we lose the default color of body and it's replaced with whatever the compositor puts in the background when an element goes fullscreen. How should we handle this?
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Monday Nov 23, 2015 at 22:19 GMT_

---

> The canvas where we paint the scene has transparent background. When we go fullscreen we lose the default color of body and it's replaced with whatever the compositor puts in the background when an element goes fullscreen. How should we handle this?

I thought we should enable `<vr-scene material="color: black">` - thoughts?
 Accidentally closed during merge
 Use renderer `.setClearColor` in `src/core/scene/a-scene.js`. 

Off-white is appealing (`#DADADA`)...though also consider off-black `#111` to reduce eye strain in headsets.

Bonus points for making this configurable. `<a-scene renderer="clearColor: #222">`
  <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [caseyyee](https://github.com/caseyyee)**
_Wednesday Nov 18, 2015 at 19:02 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/470_

---

It doesn't seem that lighting casts any shadows.  Would be great to have this.
 <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [ngokevin](https://github.com/ngokevin)**
_Wednesday Nov 18, 2015 at 19:04 GMT_

---

Keeping a WIP at https://github.com/MozVR/aframe-core/pull/348
 This would add a ton of depth to even basic scenes.   Would love to have this in the next release.
 We have our plates full for the next release and need to fight off some feature creep, but definitely soon after. There's extra work involved in bumping three.js since they revamped shadows. And arguably, text + physics are more valuable features. But the component itself is fairly simple, though I had some trouble fine-tuning the shadows back in Nov
 Cool. Yeah, didn't get it merged last time because I had trouble tuning the shadows to look good, and then never got back around to it.
 Or an API like:

```
<a-scene shadow="type: soft">
  <a-box shadow="cast: false; receive: true"></a-box>
  <a-entity light light-shadow>
</a-scene>
```

Where `<a-scene shadow>` is defined as a system: `AFRAME.registerSystem('shadow', {})`
 @takahirox I'm not sure about a roadmap for official support, but the bugs I mentioned above about `aframe-extras.shadows` have been fixed. @ngokevin +1 for that suggested syntax change, and having either a system or a scene-level component that configures the renderer. What do you think about aiming to include shadows in 0.5.0? Or would a registry package be best? I support shadows for core, the PR is already tagged for the 0.5.0 milestone SG. Before I (or someone) opens a PR, here's a proposed structure:

```
src/extras/
‚îú‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ shadows/
    ‚îú‚îÄ‚îÄ components/
    ‚îÇ   ‚îú‚îÄ‚îÄ index.js
    ‚îÇ   ‚îú‚îÄ‚îÄ shadow.js
    ‚îÇ   ‚îî‚îÄ‚îÄ shadow-light.js
    ‚îú‚îÄ‚îÄ systems/
    ‚îÇ   ‚îú‚îÄ‚îÄ index.js
    ‚îÇ   ‚îî‚îÄ‚îÄ shadow.js
    ‚îî‚îÄ‚îÄ index.js
```

Is this consistent with what you have in mind, @ngokevin @dmarcos @takahirox ? May be worth considering whether `shadow-light` should be a separate component or simply add some functionality into the `light` component. It [modifies the schema significantly](https://github.com/donmccurdy/aframe-extras/blob/master/src/shadows/shadow-light.js), but doesn't do all that much otherwise. Slightly leaning towards putting the light's shadow parameters as a part of light since the shadow-light component needs a light, and the light component is very small so it doesn't hurt adding the shadow pieces. Cool, this sounds good to me (i just haven't had time to start yet).

I'll re-assign to myself and remove the 'help wanted' tag if my schedule frees up before someone else takes it. So this issue is still up-for-grabs now.  I agree also that looks more convenient to add it to `light` instead of another component, it's typically how it works on 3d software, you add a light, click shadows and you're ready to go.  <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [caseyyee](https://github.com/caseyyee)**
_Monday Nov 16, 2015 at 20:30 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/448_

---

Otherwise the cursor can be obscured by foreground element and rendered behind objects.

Also causes eye strain since it is basically floating in your gaze in front of everything.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Wednesday Nov 18, 2015 at 10:51 GMT_

---

Yeah, this is the standard approach. I recall first reading about it in the Team Fortress 2 VR conversion post mortem.
 <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [caseyyee](https://github.com/caseyyee)**
_Thursday Nov 19, 2015 at 04:58 GMT_

---

Just watched "Oculus Connect 2: Game Design Un-Rules: Examining Design Failures in Time Machine VR" https://www.youtube.com/watch?v=14p9mqs2LiQ

In this game, Instead of a specific target reticule.   The designers used concentric circles to form a holographic  tube.   They found that this:
- Avoids parallax eye un-focus issues.  Much more comfortable for users.
- The holographic/semi-transparent treatment proved less distracting to users.
- Surprisingly accurate.
 I'm ok to close. I don't think this is easy to implement in a generic way and would probably better done in an external component. Crawling Cursor: https://github.com/jujunjun110/aframe-crawling-cursor  <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [caseyyee](https://github.com/caseyyee)**
_Saturday Oct 31, 2015 at 19:12 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/366_

---

![image](https://cloud.githubusercontent.com/assets/1560884/10865435/909d63c6-7fc8-11e5-9147-b79964f1a6b2.png)

Running Nightly edition.

This was working previously, not sure what has changed.
 <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [ngokevin](https://github.com/ngokevin)**
_Saturday Oct 31, 2015 at 19:25 GMT_

---

might need to tone down the default ambient light a bit 

https://github.com/MozVR/aframe-core/pull/359
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Sunday Nov 01, 2015 at 00:05 GMT_

---

The lighting looks correct to me on desktop (Nightly, Mac):

![screen shot 2015-10-31 at 5 04 31 pm](https://cloud.githubusercontent.com/assets/1425497/10866570/8fd604ec-7ff1-11e5-9575-ead943797505.png)
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Sunday Nov 01, 2015 at 00:05 GMT_

---

Same result in desktop Mac Chrome also...
 <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [caseyyee](https://github.com/caseyyee)**
_Sunday Nov 01, 2015 at 03:13 GMT_

---

Yeah, looks fine on desktop.   Just FF Android it seems to be an issue.

Not sure why it would be different.

Casey
 Fixed when we bumped three
  <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Friday Oct 30, 2015 at 03:21 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/350_

---

Currently, if I have an **invisible** sphere in front of a **visible** cube, clicking with gaze-based cursor results in a `click` event for the invisible sphere, not the cube. This was unexpected to me and was not the behaviour I desired.

If you want elements that can be intersected when "invisible" then I would recommend folks use `material="opacity: 0"`. Thoughts, @dmarcos?
  <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Tuesday Oct 27, 2015 at 00:48 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/327_

---

![text-selection-canvas](https://cloud.githubusercontent.com/assets/203725/10746552/55ad0d6a-7c09-11e5-8fc6-981b780b8f06.gif)
1. Load http://localhost:9001/examples/panoexplorer/
2. Double click on the page a couple times
3. Notice the blue highlight, especially visible with the three block images
4. Select the entire text of the page (using **`Command` + `A`**)
5. Notice the blue highlight again

How to fix?

This is a start:

``` css
.vr-canvas {
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

::selection {
  background: transparent;
}

::moz-selection {
  background: transparent;
}
```

But it doesn't completely solve the problem. And you don't want to disable the text-selection color for the entire page; there could be a sidebar, text/legend at the top or bottom of the site.

I think you need to actually do like disable text selection on all the canvases like so:

``` js
canvas.addEventListener('selectionstart', function () {
  // stop propagation *and* prevent default!
  return false;
});
```

There's probably some better solution. Investigate!
 cant repro, is this fixed?
  <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [cvan](https://github.com/cvan)**
_Tuesday Sep 29, 2015 at 18:34 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/215_

---

```
npm run ghpages lolerz
```

should throw an error
 #1867  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Sep 17, 2015 at 23:15 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/158_

---

Enables the dev to use vector SVG elements. Add to either a generic vr-image component, to a new dedicated svg component, or do both?
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Wednesday Oct 21, 2015 at 18:50 GMT_

---

Interesting techniques: https://css-tricks.com/rendering-svg-paths-in-webgl/
 Awesome thanks, will look to get it for the Registry! I've also done this before, but haven't released.  Although it'd be great to load SVG files You're including A-Frame in your bundle. I recommend using `angle` for a component template.

```npm install -g angle && angle initcomponent```  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Friday Sep 04, 2015 at 17:36 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/74_

---

Enables the developer to specify the physics properties of their scene.

For example:
- Collision behaviors (eg all objects default to rigid bodies w/ collision enabled by default?)
- Player movements (eg slower walking speed for underwater level)
- Gravity (eg low gravity for moon level)
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Friday Sep 04, 2015 at 17:36 GMT_

---

Related to #68 
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Friday Sep 04, 2015 at 17:37 GMT_

---

Goal of this issue is to arrive at a long term solution for vr-markup, then implement the essential first few interactions for v1 release.
 <a href="https://github.com/nickdesaulniers"><img src="https://avatars.githubusercontent.com/u/1823839?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [nickdesaulniers](https://github.com/nickdesaulniers)**
_Friday Sep 04, 2015 at 21:40 GMT_

---

I'm taking a look at [cannon.js](https://github.com/schteppe/cannon.js) currently.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Saturday Sep 05, 2015 at 18:56 GMT_

---

Per @kearwood's advice, we should also make sure that collisions are relatively low-friction, so a user walking past a cube does not become stuck unnecessarily.
 https://github.com/ngokevin/aframe-physics-components
 And with Oimo https://github.com/JoshGalvin/aphysics

We'll compare which is more appropriate. Feel free to vote for an engine.
 @bnolan Thanks for the breakdown
 @bnolan thanks so much for input from your experience! We knew about the Cannon being better documented, Oimo being quick, and Ammo being big, but the notes about friction, framework, interpolation are great to know
 I think we'll keep external at https://github.com/donmccurdy/aframe-physics-system for now (given the file size and not all scenes need physics). If it becomes more ubiquitous, we can naturally re-consider.  <a href="https://github.com/nickdesaulniers"><img src="https://avatars.githubusercontent.com/u/1823839?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [nickdesaulniers](https://github.com/nickdesaulniers)**
_Friday Sep 04, 2015 at 16:36 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/71_

---

three.js doesn't seem to resample from images when they're animated gifs.  I'm not sure if there's a turn this on easily or not.  In raw webgl, I could do this easily, but I don't know if I can feed three a WebGLTexture object.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Friday Sep 04, 2015 at 17:14 GMT_

---

An example: http://stemkoski.github.io/Three.js/Texture-Animation.html

Each frame of the animation is captured as a texture, which are then cycled through with offsets.
 <a href="https://github.com/nickdesaulniers"><img src="https://avatars.githubusercontent.com/u/1823839?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [nickdesaulniers](https://github.com/nickdesaulniers)**
_Friday Sep 04, 2015 at 17:35 GMT_

---

No, that example is using Texture Atlases, not animated gifs.
http://stemkoski.github.io/Three.js/images/run.png
http://stemkoski.github.io/Three.js/images/explosion.jpg
 https://github.com/maxkrieger/aframe-draw-component
 https://github.com/mayognaise/aframe-gif-component
  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Friday Sep 04, 2015 at 02:10 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/67_

---

Enables user to look at a position in the 3D world and "warp" to it.
 Currently, Don's https://github.com/donmccurdy/aframe-extras has a component for this called `checkpoint-controls` for now.
 https://github.com/fernandojsg/aframe-teleport-controls
  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Saturday Aug 29, 2015 at 01:20 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/46_

---

Enables developer to display something in scene for user while asset is being pulled down. It's not uncommon for models to be multiple MB.
 This could be done as a simple component, possibly for the Registry or as a project component. Display something until `model-loaded` fires.

```
<a-entity model>
  <a-entity indicator geometry material/>
</a-entity>
```

```
AFRAME.registerComponent('indicator', {
  init: function () {
    // Remove this entity when `model-loaded` fires.
  }
});
``` Yeah. You can also check if the model is already there with getObject3D('mesh'). I'll see if I can get an example  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Aug 27, 2015 at 00:46 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/25_

---

Enables user to add text labels to their scene.

User can specify:
- Text color
- Background color
- Padding (top, bottom, left, right)
- Font
- Text content (specify as attribute, or within open/closing tags?)
- Scale
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Thursday Aug 27, 2015 at 08:17 GMT_

---

Look at reusing HIRO solution for this.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Sunday Sep 06, 2015 at 20:01 GMT_

---

@caseyyee I dug into our previous canvas-based solution in https://github.com/MozVR/hiro/blob/master/js/lib/vruikit.js, but it's a bit beyond my skills to port to our new component model. If you don't mind I'm going to transfer this to you, as creator of the original?
 <a href="https://github.com/caseyyee"><img src="https://avatars.githubusercontent.com/u/1560884?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [caseyyee](https://github.com/caseyyee)**
_Sunday Sep 06, 2015 at 21:58 GMT_

---

Sure, I'll get something going.
 <a href="https://github.com/dmarcos"><img src="https://avatars.githubusercontent.com/u/39342?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [dmarcos](https://github.com/dmarcos)**
_Wednesday Oct 07, 2015 at 17:23 GMT_

---

Should text be part of `vr-markup` or provided by `vr-elements`?
 <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [ngokevin](https://github.com/ngokevin)**
_Tuesday Dec 22, 2015 at 00:18 GMT_

---

alternatively https://github.com/ngokevin/aframe-text-component
 This will be handled by 3rd party components.
 https://github.com/bryik/aframe-bmfont-text-component has a case for standard since it works well. But component consumption story would solve it as well and give us less code to maintain.
  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Wednesday Aug 26, 2015 at 19:46 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/16_

---

Enables user to easily add links to their scenes.

User can specify:
- href
- Name of link
- Anything else?

We'll need to decide if the link is triggered by physical collision and/or by cursor click event. I imagine we can start with physical collision. And if users want to define clickable links on other types of objects, they can use click event components to do so.
 <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [jcarpenter](https://github.com/jcarpenter)**
_Wednesday Oct 14, 2015 at 05:50 GMT_

---

From Oct 13 meeting: 

vr-loader as currently implemented will work on Chrome Mobile, but not on Chrome desktop. Team consensus is therefore not to ship it in v1. Instead, we will: 
- For v1: attribute changes (eg swap panos) only. Evangelize this to devs.
- In the future: either...
  - Wait for new WebVR API and new mechanism for entering VR
  - `[or]` Implement `vr-loader`, with new implementation that switches inner content of the page, instead of current iframe hacks. Limitation is it only works across sites that use A-Frame.
 <a href="https://github.com/cvan"><img src="https://avatars.githubusercontent.com/u/203725?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [cvan](https://github.com/cvan)**
_Tuesday Nov 10, 2015 at 04:18 GMT_

---

If the site is built with A-Frame, we should swap the scene contents (see issue #113 and PR #264). If the site is not built with A-Frame or is not a VR site, we should just do a synchronous `window.location.href`.
 <a href="https://github.com/sirkitree"><img src="https://avatars.githubusercontent.com/u/28543?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [sirkitree](https://github.com/sirkitree)**
_Thursday Dec 17, 2015 at 19:32 GMT_

---

Any thoughts on how this will look? If the look of a link is defined by default you might consider adding attributes based on how it looks, like an outline color, an image for the link, etc. Coming from Janus I'm used to a link looking like a portal but I'm not sure what you guys are envisioning here.
 <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [ngokevin](https://github.com/ngokevin)**
_Thursday Dec 17, 2015 at 19:34 GMT_

---

The link component would only add behavior of linking (check for collision detection, or clicks, then navigate). The appearance is agnostic and would be defined by components such as `material` and `geometry` components.

An example API would be

``` html
<a-entity link="to: http://janusvr.com" geometry="primitive: plane" material="src: portaltexture.jpg">
```
 <a href="https://github.com/sirkitree"><img src="https://avatars.githubusercontent.com/u/28543?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [sirkitree](https://github.com/sirkitree)**
_Thursday Dec 17, 2015 at 19:35 GMT_

---

So more like typical HTML where you can surround something like an image in an anchor tag?
 <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [ngokevin](https://github.com/ngokevin)**
_Thursday Dec 17, 2015 at 19:42 GMT_

---

Well, I wouldn't say so because surrounding something implies hierarchy and a parent-child relationship.

Combining link + geometry + material components implies composability. Like you could add a sound component too to give a portal sound. Or a look-at component to always have portals face the user.
 <a href="https://github.com/sirkitree"><img src="https://avatars.githubusercontent.com/u/28543?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [sirkitree](https://github.com/sirkitree)**
_Thursday Dec 17, 2015 at 19:49 GMT_

---

Ok, I replied before I saw the example. Thank you.
 <a href="https://github.com/ngokevin"><img src="https://avatars.githubusercontent.com/u/674727?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [ngokevin](https://github.com/ngokevin)**
_Thursday Dec 17, 2015 at 19:50 GMT_

---

Yeah sorry I ninja-edited that in
 Until we land this in this repo (if we so choose to do anytime soon) and until the WebVR 1.0 API ships, in the interim we should show folks how to do this if they want to. CodePen snippets would suffice. It'd probably be helpful to document this in the A-Frame FAQ and/or Docs.
 Sorry, I will update the FAQ now. We are currently improving the link traversal experience in the browser and spec. While we got it working, we want to improve it before releasing documentation + components.
 My PR with the link component is still opened https://github.com/aframevr/aframe/pull/1575/files#diff-de1c6f37e5303b00ff65041ea3b0ad69R3

The API for link traversal is not completely agreed upon yet. Should we hold on a link component a bit more?
 The `vrdisplayactivate` event does not seem to be properly implemented on either Firefox or Chrome. I would postpone this to a `0.4.1` release as soon as a minimal functionality is available in browsers.
 Sounds good to me.
 Not yet. the feature is scoped for 0.6.0 #1575  <a href="https://github.com/jcarpenter"><img src="https://avatars.githubusercontent.com/u/1425497?v=3" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [jcarpenter](https://github.com/jcarpenter)**
_Wednesday Aug 26, 2015 at 19:17 GMT_
_Originally opened as https://github.com/aframevr/aframe-core/issues/12_

---

Enables user to display a floating 2D web view in the world
- Source URL
- Width
- Height
 <a href="https://github.com/nickdesaulniers"><img src="https://avatars.githubusercontent.com/u/1823839?v=3" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [nickdesaulniers](https://github.com/nickdesaulniers)**
_Friday Aug 28, 2015 at 22:09 GMT_

---

cssvr shared depth buffer issues
 Due to browser security, this is non-trivial.

With three.js, you can currently overlay a CSS-transformed I-Frame element over the canvas. This works okay, but this falls apart with VR and stereoscopic rendering.

It is possible to render a canvas as a texture, and we can create images using the DOM. But not sure if we can do that with I-Frames.

Crazier solutions involve a backend server streaming textures.
 Unfortunately, this is not possible without having a new Web API to render elements as textures in WebGL. We could indeed position an iframe with CSS 3D transforms that integrates in the same coordinate system as the WebGL content but:
1. For stereo rendering, we would have to manually duplicate the DOM which is inefficient and will introduce confusion when handling events and selecting elements. 
2. Distortion wont be applied to the iframe since it's handled by the browser on the canvas element pushed to the HMD.
3. The iframe would always sit on top of the WebGL content making it useful only for HUD kind of applications. You could hack your way with techniques like alpha punching (that creates multiple canvases with wholes that let DOM elements pass through) that are very inefficient.
4. No shading can be applied to the iframe to integrate it in the 3D scene. Imagine you want to show an iframe behind a glass surface that reflects the environment. 

Until we have a browser API to render an arbitrary element as a texture in WebGL you won't be able to use iframes (or any other DOM element) in an aframe scene. There's some discussion going on to bring such a feature to gecko. More info here:

https://bugzilla.mozilla.org/show_bug.cgi?id=1237489
 Parallel discussion https://github.com/aframevr/aframe/issues/974#issuecomment-189995329
 Closing because not possible. If a solution ever lands, we can re-open and add the feature ASAP.
 @cjroth btw, there is a MediaRecorder API (supported in both Firefox and Chrome/Chromium):

* https://hacks.mozilla.org/2016/04/record-almost-everything-in-the-browser-with-mediarecorder/
* https://mozdevs.github.io/MediaRecorder-examples/
  /cc @ngokevin + @dmarcos 
 Is it working now?
 Needs more info / update
  Sure does!

https://github.com/ngokevin/aframe-react
https://github.com/ngokevin/aframe-react-boilerplate
 https://github.com/ngokevin/threeschwifty
https://github.com/ngokevin/a-wakens
 Yeah, we use the Custom Element API pretty heavily.

You can use plain A-Frame with plain React, but I'd recommend using `aframe-react` so you can pass component data as props using plain objects. You're going to end up doing that yourself anyways. It's a very thin unopinionated layer that preserves the entity-component system of A-Frame. I have some more features in mind too to help pair along with A-Frame.

``` js
const material = {color: 'red', metalness: 1};
<Entity geometry={{primitive: box, width: 5}} {...material}/>
```
 Yeah, it's quite genius, bringing ECS to the DOM. @jcarpenter and @dmarcos idea.
 Sorry, shouldn't be using acronyms :)

https://en.wikipedia.org/wiki/Entity_component_system
 Ah wow, yeah, that's very similar. I should read through that more and see if we can take any ideas from it.

Yeah, it's pretty agnostic. We found it works well with D3 too.
  Could be configurable with a scene component.
 @jcarpenter, @dmarcos we've talked about how to trigger/delay animations several times on and off weeks back. did we reach a conclusion of how we want to handle (either imperatively or declaratively) starting animations? we should probably put all the proposals together somewhere here in an issue to weigh the pros and cons and come to a conclusion.

a related issue: aframevr/aframe-core#761
 Not heavily documented yet, but components can be created for scenes. If we implement this, clever to force the scene to wait would be attaching a custom node and controlling when it becomes loaded, and thus controlling when the scene is loaded.

@dmarcos is also working on global play/pause functionality that might help this.

``` js
registerComponent('scene-wait-event', {
  schema: {
    eventName: { default: '' }
  },

  init: function () {
    if (!this.data.eventName) { return; }
    var node = document.createElement('a-node');
    el.appendChild(node);
    document.body.addEventListener(eventName, function () {
      node.load();
    });
  }
});
```
 You can also use the `begin` attr to control when animations play https://aframe.io/docs/core/animation.html#Begin
  Thanks!
  This is a bug. I filed https://github.com/aframevr/aframe-core/issues/765 in core to track this problem.
  There's not support for animated gifs applied as textures. This is why you only see the first frame.
 Sure! Please do
 https://github.com/mayognaise/aframe-gif-component
  Been following your work here. Excited to see where this goes.

Also related: aframevr/aframe-core#699 and #347
 Thanks for filing. We found this works: https://github.com/aframevr/aframe-core/pull/782

Let us know if you have better solutions.
  It's `thetaLength` and `phiLength` instead of `phiEnd` and `thetaEnd`
 The documentation is ahead of the released version. `phiLength` and `thetaLength` are still in the `dev` branch of [aframe-core](https://github.com/aframevr/aframe-core) this is why they're not working on your example. You can play with this example and see: http://swimminglessonsformodernlife.com/aframe-core/examples/cube/

If you're not going to use the primitives and you have some tolerance for quirks :) you can move to use dev branch of the core. Sorry for the inconvenience
 @cvan We have to make sure that the published docs correspond to the
released version aka master branch. There's no `thetaLenght` and
`phiLength` properties in the published version

On Mon, Jan 4, 2016 at 1:20 PM, staus notifications@github.com wrote:

> Ah, it's no problem for me right now. In my case I found I could use a
> cone in stead (I a cone also performs better as it has less segments), but
> thanks for looking into it and good it's on it's way :) Will definitely be
> useful!
> 
> ‚Äî
> Reply to this email directly or view it on GitHub
> https://github.com/aframevr/aframe/issues/352#issuecomment-168664472.
 Thanks for catching this. I'll need to start versioning our docs now. :+1: 
 blocked on aframevr/aframe-site#121
 @ngokevin: can you confirm this is fixed in PR #883?
 yeah
  Not a bug. Expected security behaviour of the browser.

It doesn't matter if the transport is http or https, the browser expects an access-control-allow-origin header to allow the resource to be loaded. 

aframe.io webserver returns this in the response header:
access-control-allow-origin:*

Your webserver doesn't have this field in response header. If you configure your webserver to send a response header that allows http://s.codepen.io or all domains (*), it will work.

Please see: https://en.wikipedia.org/wiki/Cross-origin_resource_sharing
  Does the examples of the website work for you? https://aframe.io/examples/showcase/sky/

You should be able to rotate the panorama with the mouse
 I think what he meant was rotating by linked x,y coords of mouse as opposed to dragging.
 Sorry for the misunderstanding. `look-controls` component only provides mouse dragging. Implementing a different component with a different control scheme is definitively possible. 
 Is there something actionable we want to do in this issue? Docs, create an example?
 @wahengchang: Have a look at this component I made. It may solve your problem:
https://github.com/cemkod/aframe-fps-look-component
 You can use the third-party components that simulate or implement pointer lock. We have issues on file to evaluate the default mouse controls. Thanks!
  Hi Peter, we haven't looked at AR applications yet and we're focused on other priorities for the next few months (eg improving mobile support, fixing bugs, etc) but this is an intriguing idea. Perhaps it could be implemented as a custom component. Eg "ARcamera". I'd start by writing up a mini spec and circulating it here, on Twitter, and on the A-Frame Slack. You may find people jump in to help :)
 I think we should change it back such that the orientation is absolute, rather than centered at 0,0,0 based on how the user holds the phone when they load the page. It used to be this way, but we arguably erroneously changed it to support the use case where the phone is laying on the desk and it starts off looking at the ground.
 I tend to agree. I open my phone a lot when it's flat on my desk.
 AR cameras and utilities: https://github.com/argonjs/argon-aframe for A-Frame There's also https://github.com/jeromeetienne/aframe-artoolkit that's worth checking out  Thanks @staus. Curved image in general needs a lot of work to be "smarter". We're looking to address that when we move to a new implementation of the primitives. My first draft of the new approach for curved image is here: https://github.com/jcarpenter/aframe/blob/primitives/elements/primitives/a-curvedimage.js It does not yet have the logic for automatically determining theta-length / height based on image dimensions, but it does implement new approach to setting texture, using `repeat: -1 1` instead of scale. TBH I can't recall _why_ I went this route (a month ago seems so long!) but I do recall it was after much fiddling with different combinations of side, scale, and repeat.
 now using repeat -1 1 https://github.com/aframevr/aframe/pull/883
  Very sorry about this; we'll be addressing this very soon. Thanks for filing!
 @mattpolicastro thanks! yep, that looks about right. could you open a PR for that (and change the tabs to spaces while you're at it)?
 this should be working now - thanks, @mattpolicastro :)
  Thank you for your report.
- Please specify your device make, model, operating system version, and browser.
- Please describe the problem in detail. Explain what happened, and what you expected would happen
 On mobile the cursor switches to fuse mode: You hover the element for a couple of seconds and a click event triggers. @AlexandreLeitao Does this work for you: http://swimminglessonsformodernlife.com/aframe-core/examples/panoexplorer/
 in response to https://github.com/aframevr/aframe/issues/346#issuecomment-169760743:

I'm on iPhone 6, iOS 9.1, Safari browser, and the [Cursor & Hover](https://aframe.io/examples/showcase/cursor/) demo works just as well on mobile as it does for me on desktop.

The orange cube is supposed to change color to a longer yellow rectangle on hover. Is that not happening for you? When you get a chance, @AlexandreLeitao, could you please provide a screenshot?
 @cvan It seems that the hover is not playing well with the primitives

@AlexandreLeitao: this is the code of the working example. https://github.com/aframevr/aframe-core/blob/master/examples/panoexplorer/index.html
 > @cvan It seems that the hover is not playing well with the primitives

how so? 
 https://github.com/aframevr/aframe/pull/883
  Done, anything else? Should we direct people to codepen instead of jsfiddle? Does it matter?
 thanks so much for this; much appreciated!
 No problem :metal: 
All notes addressed. You can check again.
 I have added some instructions regarding slack.
See: https://github.com/aframevr/aframe/issues/364
 Thanks for addressing all of our nit-picky comments :)

Can you squash your commits? 

(`git rebase -i HEAD~20` just in case)
 No problem :) I expected many edits when I took on CONTRIBUTING.md
Thanks for putting up with my noob mistakes.
 Thanks!!
  Thanks for filing this, @cemkod. We weren't able to do this before launch. In interim you should be able to use the sound component on an `<a-entity>`. Docs are here: https://aframe.io/docs/components/sound.html
 FWIW, in [aframe-core](https://github.com/aframevr/aframe-core/), we do have a example, the [Pano Explorer](https://github.com/aframevr/aframe-core/blob/1d07db6e/examples/panoexplorer/index.html#L17-L21), which makes use of the `sound` component. _(sidenote: those examples are not hosted online unfortunately [originally to minimise the size of the git checkouts]; see aframevr/aframe-core#689.)_
 I would probably file an issue to have a sound example added to the site though: https://github.com/aframevr/aframe-site

There is a PR (#362) to merge aframe-core into this repo, so we would inherit the example with sound (Pano Explorer). But, IMO we should have an example dedicated purely to "sound" - hopefully nicely demonstrating positional sound. So, I would reopen this if you don't mind.
 I reopened the issue with comments from @cvan here: https://github.com/aframevr/aframe-site/issues/131
  This is a limitation of the WebVR APIs relying on `requestFullScreen` API. Whenever the location of the page changes, the full screen mode and hence the VR mode disengages. In future iterations of the WebVR APIs we will probably move away from `requestFullScreen` to allow page navigation without dropping the user from VR.
 As @dmarcos says, we are in the process of writing a spec that will enable seamless link-to-link traversal of WebVR pages. We are evaluating our platform options at the moment. We will be public and transparent with the authoring of the spec (likely to live here on GitHub √† la the the [WebVR Spec](https://github.com/mozvr/webvr-spec). Once implemented, this will be a non issue.

I can keep this issue open, but there's nothing in A-Frame we can do beyond hacks. We have previously implemented a solution that works in Firefox only using `<iframe>` - originally designed for [HIRO](https://github.com/mozvr/hiro), a browser prototype from back in 2014 (check out [this video here](https://www.youtube.com/watch?v=7-72zb81QFw), if you're interested).

And, there was also [a proof-of-concept solution](https://github.com/aframevr/aframe/pull/105/files) of swapping out the scene markup (and JS) from one A-Frame scene to another. But we decided to forgo this solution because it requires the scene to be an A-Frame scene to go from one to the next.

The third option is to embed multiple "pages" as different worlds wrapped in `<a-entity>`s and just use the `visible` component to do the toggling. It's not ideal, but you can achieve some pretty compelling effects using that.

Hope that helps :smile: 
 Yeah, I've implemented this before using hashes.

So you'd have `http://localhost:8080/panoviewer/#paris`, `http://localhost:8080/panoviewer/#tokyo`, `http://localhost:8080/panoviewer/#boston` which would just toggle the visibility so only the one defined in the hash gets disabled. That's one way to go about it.
 Also, if you're curious, here are how we've achieved (hacky) "link traversal" in Firefox before:

https://github.com/cvan/vrloader/blob/master/VRLoader.js
https://github.com/MozVR/hiro/blob/a6498dd/js/vrtab.js
https://github.com/MozVR/hiro/blob/a6498dd/js/vrmanager.js

Chrome will let you fullscreen only the canvas, so these hacks won't work there (that is, you'll be dropped out of fullscreen mode).
 User input is needed to request full screen. That's a security constraint of the requestFullscreen API so websites cannot take control of the display without the user being aware of it.
 @tbalouet: we would have an "Enter VR" button which would trigger a fullscreen for the first scene. and then as long as you have `<iframe allowfullscreen>`, you'll be able to fullscreen the iframe (i.e., enter VR mode).
 This will have to wait for the next WebVR API which we will have a separate issue for when it comes time. Thanks for filing!
  If you have an Oculus or Cardboard you can use it with a-frame. Does this answer your question?
 Documentation on using A-Frame sites with VR devices is here: https://aframe.io/docs/guide/entering-vr.html
 Kindly closing as the question was answered. If there's anything else you need, please do let us know. Thanks!
  Material is undefined unless it's explicitly added by a component. We can do it through the DOM. Here's an encapsulated approach.

``` js
init: function () {
  el.setAttribute('material', 'map', fontMap);
  el.setAttribute('material', 'side', 'double');
  el.addEventListener('componentchanged', function (evt) {
    if (evt.detail.name === 'material' && 'color' in diff(evt.detail.oldData, evt.detail.newData)) {
      updateSDFShader()  
    }
  });
}
```

I think it's up to you whether you want that in a new separate material component or within the font component, depending on use cases.
- A-Frame Core has Promise polyfills in the bundle.
- The `update()` called after `init()` is intended. The no `oldData` parameter is expected, but I'm up for suggestions to improve the API there.
- Nesting within another Object3D and internally scale sounds good.
 Nice! Two things:

-Components can declare dependencies. We use the mechanism on the cursor component:

https://github.com/aframevr/aframe-core/blob/master/src/components/cursor.js#L11

-I think we should open a new repo `aframe-components` with a curated list of cool components that people can contribute to. The BMFont component could be a good first candidate
 We have an API to register custom materials and shaders now!
  thanks!
  the rest looks great. let me know. thanks!
 many thanks!
  Sorry, was out for the holidays. This looks good, thanks!
  :+1: Yes, we need to allow customisable keyboard mappings.

Specifically, https://github.com/aframevr/aframe-core/blob/1d07db6/src/components/wasd-controls.js#L83-L89 and https://github.com/aframevr/aframe-core/blob/a3855a3/src/core/a-scene.js#L539-L551 need to be developer-overridable (and possibly user-overridable, though that could be left as an exercise for the developer to do with JS; we'll have to make a call there).

We handled keyboard bindings with [simple language in Horizon](https://gist.github.com/cvan/a1e1a2ea9fb341dd6ad3). A popular library folks use is [Mousetrap.js](https://craig.is/killing/mice). I wrote a ["polyfill" for `KeyboardEvent.prototype.key`](https://github.com/cvan/keyboardevent-key-polyfill) (which lets you listen for `e.key == 'ArrowRight` instead of `e.keyCode === 39`). Open to alternatives.
 Not sure about the DSL at the component property level. Those things get out of control pretty quickly and are very difficult to debug.

A more centralized way for components to listen to input events that adds some sugar (listening for a key name instead of using codes) could be cool. I thinks something at the `a-scene` level might work.  A keyboard-input module that the scene uses to broadcast keyboard events. 
 Don's new keyboard controls will help in the short-term, but I recommend against using FPS keyboard controls for VR. 
 I'm going to close this in favor of https://github.com/aframevr/aframe/issues/1490 to map the controls to the arrows so we don't have to consider every single keyboard layout
  @staus: Unfortunately, we changed the cylinder geometry to no longer accept `radiusTop` and `radiusBottom` - so you need to use `geometry: cone` instead of `geometry: cylinder` if you want a cone shape.

https://aframe.io/docs/components/geometry.html#Cone

> <a-entity geometry="primitive: cone; radiusBottom: 1; radiusTop: 0.1"></a-entity>

if you do that, it works fine (also [confirmed](https://github.com/aframevr/aframe/issues/332#issuecomment-166773700) by @fernandojsg):

> http://codepen.io/team/mozvr/pen/dGXByq?editors=100

<hr>

We need to make a `<a-cone>` primitive, and that work will be done soon in aframevr/aframe#330 (also see https://github.com/aframevr/aframe-core/issues/741#issuecomment-166498744).

That should clear up things. But let us know if you have any other problems. Thanks!
 Cone template was added in PR #337 - :smile: thanks @cemkod!
  You can do el.addEventListener('componentchanged') and check the event is on wasd-controls.
 It might have been added recently, but it's briefly at the bottom of:

https://aframe.io/docs/core/entity.html#Events
  Thanks for flagging @Kshukla. I'm only seeing black, however. I checked with both Firefox Nightly and Chrome on my Mac Book Pro w/ El Capitan. Console confirms successful login with Faceook, but errors for jquery loading.
 Likewise. I'm seeing this:

<img width="1316" alt="screenshot 2015-12-21 22 44 17" src="https://cloud.githubusercontent.com/assets/203725/11947416/61ba80b8-a834-11e5-83a2-f90fec860053.png">
 Is there a still an issue here?
 okay, I signed in through FB and checked this out. pretty neat grid!

all the images initially appear at `1.5` scale.
when I hover over an image, it appears at `2` scale.
when I stop hovering that image, it appears at `1` scale. _(shouldn't this be `1.5`?)_

![image](https://cloud.githubusercontent.com/assets/203725/12248628/89617176-b86f-11e5-90a6-27eb05fc36c7.png)

also, I see `target="#shadow"`, but I don't see a `#shadow` element anywhere. _is this dead code?_
  You can use https://github.com/ngokevin/aframe-text-component for now.

Download the `dist` files in the repository. Include it after `aframe` JS file. Then:

``` html
<a-entity text="text: HELLO"></a-entity>
```

We'll have official support for this soon. Thanks!
  first off, woo thanks!

we haven't mentioned it in the Contributing doc yet (#241), but no need to run `dist` when pushing changes. also, see #320 that uses the `build/` when serving the local server (instead of `dist/`).

also, looks like `a-ring.html` is missing in this branch
 > So is doing npm start after changing the files enough to test the changes I made?

until #320 lands, the best way to test is to
1. run `npm start`
2. change `../../dist/aframe.js` to `../../build/aframe.js` in `examples/template-ring/index.html`
3. make changes, load the page, etc.

it'd probably be easier to do a new branch to remove the `dist/` changes. also, something we (I) haven't done a good job of communicating yet (again: apologies, will address in #241) is that PRs should be made against `dev` (unstable, under "development") instead of `master` (stable).

so you'll likely want to close this PR, commit only `examples/` and `elements/` files, and open a new one PR against `dev` instead of `master`.

thanks for your understanding - and thanks for contributing!
  seems to work well - thanks for cleaning things up :+1: 
 let me know about the above harcoded `watch` above and we can merge (we can do address that as an issue against `budo` later as well)
 > `watchGlob` added to `budo@7.1.0`, small example here:
> https://github.com/mattdesl/budo/blob/master/docs/api-usage.md#http-server

heh, that was quick. amazing. :tada: 

> The only file that isn't triggering a live-reload now is `VRLoader.js`, but I can't find any require references to it.

yeah, we aren't using it anymore. will be revisiting the loader likely with aframevr/aframe-core#16.
 can you pull `dev` and rebase when you get a chance?
 thanks, this works great.

p.s. I like keeping everything in this script, but it's interesting to me that now actually most of the stuff we're doing in this budo script can be done via the budo CLI except the middleware. :+1: 
 > The env vars are a bit clunky. Maybe just enable live reload by default and move the live/open flags to a new PR. I think `--` is a cleaner approach and also easier to type.

:+1: let's do that. thanks.
 :shipit: awesome, everything looks + works well
 thanks, @mattdesl!
  ah, I added the `npm` and `node` versions required in `aframe-core`'s [`package.json`](https://github.com/aframevr/aframe-core/blob/master/package.json#L80-L83), but I forgot to do it here for `aframe` proper's. will do. thanks, @mattdesl, @cemkod!
  You can pass a selector as `src` parameter of the material. Example:
https://github.com/aframevr/aframe-core/blob/dev/examples/video/index.html#L19
 Yes. I think it should just work.
  Custom shaders are coming soon. Top in the features list.
 We have work tracking at https://github.com/aframevr/aframe/pull/861 and we will iterate on it over time. We are using shadertoy as inspiration.

For applying a shader to the entire scene, maybe try making a component that hooks into the renderer?
  Thanks for filing. I think this was reported on the Slack but not filed here. Playing videos on mobile requires a user-initiated event (e.g., click). It's on the "roadmap" (TBD in #299) to design and expose video controls for videos.
 @gtk2k made a workaround using a component: https://gtk2k.github.io/aframe_videosphere/ (source: https://github.com/gtk2k/gtk2k.github.io/tree/master/aframe_videosphere)

I'll likely be implementing something similar in the interim.
 Investigate http://krpano.com/plugins/videoplayer/#iphonepanovideo
 For iOS, need to set `webkit-playsinline` or else the video will open in a separate window.

For `webkit-playsinline` to work, need to pin the website to the homescreen.
 If a VR page is pinned and launched from the homescreen (i.e., `navigator.standalone`), we can play inline videos.

To encourage users to do that, I want to show instructions in a modal/toaster similar to http://forecast.io/'s:

<img src="https://cloud.githubusercontent.com/assets/203725/13092874/20247910-d4b7-11e5-9e81-3bafe5c500ea.png" width="50%">

<img src="https://cloud.githubusercontent.com/assets/203725/13092873/1da33cf8-d4b7-11e5-90ca-9a0e9c330721.png" width="50%">
 Interesting: https://github.com/misterburton/ideo-sf-vr-nerd-night#bonus-points
 @mattdesl brings us https://github.com/jam3/ios-video-test!
 @mobiwu Have any more details than that? That might be a result of trying to do cross-origin videos on Safari, which I haven't found a way to support.
 Summary from the docs:

```
iOS has a lot of restrictions on playing videos in the browser. To play an inline video texture, we must:

- Set the `<meta name="apple-mobile-web-app-capable" content="yes"` metatag.
- Set the `webkit-playsinline` attribute to the video element.
- Pin the webpage to the iOS homescreen.
```
 Android needs user action to trigger video. We have work-in-progress to improve the UX for this.
 More info https://github.com/mrdoob/three.js/issues/6606
 We're spread thin. If people can figure out reliable patches, let us know :+1: 
 > From further testing I have discovered that video textures work as expected on Android using the latest Firefox mobile browser (45.0.1) in non-VR mode but when you switch to VR it crashes the browser after 1 second. Nexus 5 (Android 6.0.1). Video textures in Chrome still show black screens for me.

Which version of Chrome are you running? And can you provide the video source?
 > ¬†Do you know when Chrome will get fixed for this?

I would track https://bugs.chromium.org/p/chromium/issues/detail?id=178297 - no time soon it seems
 @SonarSystems if you can connect your device using USB to use remote debugging in Firefox or Chrome for Android, you get the console logs/warnings. if you have those, paste them here and those will be super helpful.
 @SonarSystems whoa, very odd. I'm not sure. @caseyyee, do you know? I know you're good with mobile debugging.
 @Chocap Safari for iOS provides an option to pin a web page to the iOS homescreen; [see this comment above for an image showing it](https://github.com/aframevr/aframe/issues/316#issuecomment-184896858)

![image](https://cloud.githubusercontent.com/assets/203725/14478467/c30b5704-00ca-11e6-899c-a5830ccf8b82.png)

There's actually a whole open-source library that adds a modal that makes it more obvious:

http://cubiq.org/add-to-home-screen
https://github.com/cubiq/add-to-homescreen

I considered it, but I'm thinking it'd be overkill to add to A-Frame. Someone could create a third-party A-[Frame component](https://aframe.io/docs/core/component.html) ([see this curated list of community components](https://github.com/aframevr/awesome-aframe#components)).
 > Does somebody know the code to implement the webkit-playsinline?

Since #1179, with the latest version of A-Frame (`0.2.0` or `master`), we automatically add this to all videos.

(I've filed #1373 to clarify the docs.)
 > Here, take this... it should help you on your way:
> 
> http://bfred-it.github.io/iphone-inline-video/demo/

you have to pass the video element or a canvas texture to WebGL. https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Animating_textures_in_WebGL so that means this iOS trick, which actually just `seek`s the `currentTime`, doesn't do anything.

https://github.com/bfred-it/iphone-inline-video ([demo](http://bfred-it.github.io/iphone-inline-video/demo/)) works for only 2D/3D CSS stuff, not WebGL stuff. it's a sweet trick nonetheless.

read https://mobile.twitter.com/feross/status/715826759032287232 for more info.
 - https://github.com/mayognaise/aframe-video-shader
- https://github.com/mayognaise/aframe-gif-component
 @ngokevin this is awesome. great work, @mayognaise - thanks!

I'm glad we now have a (third-party) component for iOS video now. now, we just need a component to enable video `autoplay` playback (via a user gesture such as a `click`) for Chrome for Android. since I added support for `webkit-playsinline` in c6aad59, and we've filed #1008 for adding a help message for "Add to Homescreen" for iOS, IMO we ought to now close this issue.

I could be convinced to add to A-Frame support for `autoplay` playback for Chrome for Android via some "Play" button if we detect any videos in the scenes on the page. But, iOS inline playback? The hacks (such as [this one](https://github.com/mayognaise/aframe-video-shader)) work, but the performance leaves a lot to be desired. And I would not want to ship A-Frame with suboptimal workarounds that degrade video performance.

I am almost done with [a PR](https://github.com/mozilla/firefox-ios/pull/1651) for [Firefox for iOS](https://github.com/mozilla/firefox-ios) that will enable inline video playback: https://github.com/mozilla/firefox-ios/pull/1651

When it merges and is shipped in the release version of the browser, I'll be so happy :smile:! And we can talk to Apple and Google to try to get them to do the same with their Safari and Chrome browsers for iOS. But, that's the best we can do.

**This is not an A-Frame problem. It's a restriction with Safari/Chrome for iOS.** (And, although it's less than ideal, having users pin a site/webapp to the homescreen is not the end of the world.)

I understand the desire for out-of-the-box inline video playback for iOS, but A-Frame should not bend over backwards for this.
 http://bfred-it.github.io/iphone-inline-video/demo/
This is nice! I'll look into it so that it will solve any issue with the current `video-shader`.
right now it won't show if the video is big or something.
Also hope FF will be the best browser for iOS üëØ 
 > Any news on this? Pretty big use killer for Cardboard

You can read [my comment above](https://github.com/aframevr/aframe/issues/316#issuecomment-212608703)
 I've filed the last remaining issue (IMO): #1463 - enabling autoplay of sounds for iOS/Chrome for iOS + Chrome for Android. Other issues have been filed and fixed.

If you have any questions about iOS inline video playback support, please read this comment: https://github.com/aframevr/aframe/issues/316#issuecomment-212608703

If you have any further questions or comments, hop on over to [Slack](https://aframevr-slack.herokuapp.com) or [Stack Overflow](http://stackoverflow.com/questions/tagged/aframe).

Thanks, everyone!
  The screen is black, although the googles icon shows up. I built a scene with a sky myself, same result, black screen. Other examples work, eg. Anime etc.
 Hey thanks for reporting, we're currently resolving issues with some Android devices by bumping to a later version of three.js, look for it soon.
 Ok!
 I believe we have it fixed on our `dev` branches where we upgraded three.js to a more recent commit. We'll have to wait until we release the next version of A-Frame where we'll be shipping a lot of changes.
 We haven't run a dist on the dev branch yet. Did you build aframe-core?
 Glad to know :)
 That's great!
  @Dogfalo thanks for filing. I think this behaviour is similar to the behaviour described in #293 - can you confirm if that's the same issue you're seeing?
  awesome, thanks! will take a look in a bit
 everything looks great except for the MozVR text. In the shopping example, it looks a bit low-res. Can we upscale rather than downscale that one?
 first off, many thanks or taking this on! much appreciated :+1:

could you change your commit message from `Make textures POT (Issue: #300)` to `Make textures POT (fixes issue #300)` - so that issue #300 gets automatically closed when this PR gets closed?

also per @ngokevin, these in particular I noticed the images are upscaled (with degradation) and there is padding around the increased images:
- [`examples/_images/mozvr.png`](https://github.com/aframevr/aframe/pull/312/files#diff-02a70a894c5875f35c6a967f36a64524)
- [`examples/_images/webvr.png`](https://github.com/aframevr/aframe/pull/312/files#diff-2525e623c11e254dcb2eb89452835637)
- [`examples/_models/tree2/tex/shadow-circle.png`](https://github.com/aframevr/aframe/pull/312/files#diff-ef7c149f83680eb4d220e43f0b4fb2e9)
- [`examples/showcase-composite/portland.png`](https://github.com/aframevr/aframe/pull/312/files#diff-8802048f80398add331bff00a56e96a9)
- [`examples/showcase-shopping/price.png`](https://github.com/aframevr/aframe/pull/312/files#diff-a2fbee1d60bed01576109439cd96436d)
- [`examples/showcase-shopping/shoes.png`](https://github.com/aframevr/aframe/pull/312/files#diff-d64d04822557afb3a361c1b901fc18cc)

most of the rest of them (e.g., [`examples/showcase-anime-UI/images/glow1.png`](https://github.com/cemkod/aframe/blob/make-textures-pot/examples/showcase-anime-UI/images/glow1.png)) look downscaled okay without excess padding created.
 fwiw the increased padding seems accounted for by changing positions.
 thanks!
  Nah, it's something we should have. I'm working on an example text component implementation using TextGeometry at https://github.com/ngokevin/aframe-text-component

Also https://github.com/MozVR/aframe-core/issues/319
 https://github.com/ngokevin/aframe-text-component is working now. Requires that you register it but it's there :)

Eventually it will come out of the box. Thanks for filing!
  Yep, we need to fix this limitation. It may happen with an updated primitives implementation that we are currently exploring. @cvan 
 For people running into this issue, for now I recommend falling back to using raw entities and components. This is a bug on an abstraction layer.

https://aframe.io/docs/components/material.html#Defining_Textures
 FWIW: I opened a PR that fixes this issue: https://github.com/aframevr/aframe/pull/323
 Fixed 
  Thanks @tbalouet. Getting more consistent results on Android devices is a top priority for us. Bug reports like this are very helpful. :+1: 
 Fixed at ceb5fa9a71ad75d637e4ebe53fd178aeb189f1f8
  @caseyyee have you encountered this one?
 All Android phones have back buttons.  In some cases, you may have to swipe up from the bottom to expose the soft-keys.    This could be the case with the MotoX?

We could put a Exit VR button as we have with IOS for, though I figure this would be a common UX for similar apps (ie: Gallery).
 Yeah OK, I agree, adding a back button will help for this.
 After more than 8 months I haven't heard many complains about this being an issue? Do you this this is something we should tackle? @ngokevin 
 Rotating to portrait and pressing the X works for now. That would satisfy case on both fullscreen scenes (where you could also just navigate away), and embedded.
  Yep, check out the model component: https://aframe.io/docs/primitives/a-model.html

It supports OBJ and Collada (DAE) files. With intent to add support for GLTF as soon as the Three.js importer and workflows are a bit more robust.
 We try to use GitHub for bug reports, feature requests, etc. In the future the best way to ping the team with questions is [@aframevr](http://twitter.com/aframevr) on Twitter, or via the A-Frame [Slack channel](https://aframevr-slack.herokuapp.com/)
  @thelucre do you have an example scene/site somewhere we can take a look at?
 @ngokevin @dmarcos is this possible now in `dev`?
 For now as a workaround, you can add `<a-node>` to your scene, and then when you are ready, call `document.querySelector('a-node').load()`. This should work because the scene blocks on all nodes loading before rendering.
 heh, that's a beautiful hack. we ought to properly support this, but I like that.
 It's fine enough, or inject the A-Frame scene into your app when you're ready. I know there are several projects using Vue.js without much issue.  All images we use in the examples should be of power of two (for pef reasons):

![](https://pbs.twimg.com/media/CWc179zUkAAaCUC.png:large)

/cc @jcarpenter
 dupe of #300
 @alwell-kevin Is not a necessity but it will yield better performance  Per https://twitter.com/mrdoob/status/677569574020100097

All images we use in the examples should be of power of two (for pef reasons):

![](https://pbs.twimg.com/media/CWc179zUkAAaCUC.png:large)

/cc @jcarpenter
 Thanks for filing!
 Fixed thanks @cemkod 
  I like https://github.com/mattdesl/budo/blob/master/CHANGELOG.md and https://github.com/olivernn/lunr.js/blob/master/CHANGELOG.mdown
 I looked into https://github.com/semantic-release/semantic-release; I think I'm going to go with that. writing manual npm `script`s is becoming a pain. thanks for sharing the other links. commitizen looks quite nice too.
 https://github.com/aframevr/aframe/pull/817
  Load `file:///opt/aframe/examples/template-sky/index.html`
### Firefox

![image](https://cloud.githubusercontent.com/assets/203725/11878260/7f4d0d46-a4a9-11e5-8c81-8c8cea527fdd.png)
### Chrome

![image](https://cloud.githubusercontent.com/assets/203725/11878365/2eb7dbf8-a4aa-11e5-8973-aff1e5a59e29.png)

Same issue with `file:///opt/aframe/examples/animation-generic-logo/index.html`

But somehow aframe-core's examples (`file:///opt/aframe-core/examples/texture/index.html`, for example) are throw proper errors in the Console in Firefox:

![image](https://cloud.githubusercontent.com/assets/203725/11878446/c979417c-a4aa-11e5-9a12-4841e56b1d75.png)
 fixed by PR #930 when templates are removed in favour of primitives. if we reintroduce templates defined in HTML, this will again be an issue (see issue #930).
  sweeet - thanks for the PR!

> - `browserify-css` should now emit file events (https://github.com/cheton/browserify-css/issues/20), so it should be picked up by watchify and trigger a hard live-reload. However it seems like all the browserify-css stuff is legacy, I am not seeing much CSS in this repo.

the CSS has since been moved to [`aframe-core`](https://github.com/aframevr/aframe-core/blob/master/style/aframe-core.css), so, yeah, can remove.

> - The HTML inside `examples/` are not live-reloading

this seemed to work with [my original patch](https://github.com/cvan/budo/commit/81c9e336). I gave up on using my fork because while I could get one example to work, loading multiple documents proved problematic (which I filed as mattdesl/budo#79). also, we used to use HTML imports in all the examples, which we removed but it's still a supported use case for folks who want to define templates in external HTML imports (I filed an issue against budo to address/discuss: mattdesl/budo#119).

now if I point to the latest budo, and enable the `.live()` line in `scripts/budo.js` (or using your branch here, with the `host` changes too), I no longer can get the examples to live reload.

> - The `browserifyArgs` option can be replaced by a `browserify: { ... }` options object for code clarity

:+1: 
 gotcha, thanks.

also a related issue - which you probably already noticed: #282
 thanks!

I figured out the other issues - PR coming :smile: 
  Yeah, good call. We'd need to address it here: https://github.com/aframevr/aframe-core/blob/52ddcc/src/components/look-controls.js#L44-L53

Related: we previously had this [issue with dragging with dragging beyond the canvas and releasing](aframevr/aframe-core#328).
 Accidentally closed during merge
 Fixed https://github.com/aframevr/aframe/commit/f420a45251f38f0c6484038c3c2db884a003c9bc
  /cc @dmarcos, @caseyyee 
 @eviljeff which OS?
 Fixed with latest polyfill bump  the Codepen is privacy until release
 Private*
 yep, it was a private link, but it's now public
  For launch, shall we remove these?
- https://github.com/aframevr/aframe/tree/master/examples/showcase-panoexplorer_OLD
- https://github.com/aframevr/aframe/tree/master/examples/showcase-mario
- https://github.com/aframevr/aframe/tree/master/examples/showcase-legos
- https://github.com/aframevr/aframe/tree/master/examples/animation-template-test
- https://github.com/aframevr/aframe/tree/master/examples/animation-aframe-logo
 Yes, agreed; we can remove these.
 thanks
  It's great: https://www.npmjs.com/package/ghpages

(I use it for the [boilerplate](https://github.com/aframevr/aframe-boilerplate).)

<hr>

Also see aframevr/aframe-core#622.
  `http://localhost:9000/examples/cubes/?ui=0` or `http://localhost:9000/examples/cubes/?hide_ui=1` or something

Useful for when you want to `<iframe>` an A-Frame scene and perhaps want to enable some other method of entering VR - or you may not not even want the user to view the scene in VR.
 I have pending work to move VR Mode UI to `vr-mode-ui` component where they can do

`<a-scene vr-mode-ui="enabled: false">`

But I can make it check querystring too.
 Accidentally closed during merge
 We now hide the ui via the component configuration. Is this still an issue?
 Depends on the iframe use case if it's possible to have the button within the iframe be able to trigger VR, or whether we would need an outside button postmessage into the iframe. I don't know much about the constraints of iframe + entering VR to say for sure
 ui=false
  See this note in the README about needing to run `npm login` because our npm package is private:

https://github.com/MozVR/aframe/blob/master/README.md#local-development

Username: mozvr
Email: cvan@mozilla.com
Password: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ (PM'd)
  This is not meant to be merged. It's just me trying to get rid of the root node. @cvan Do you think we really need it? Is there a way we can get rid of it? This PR seems to work but probably my approach is simplistic
 the original source is

``` html
<a-cube color="blue">
  <a-plane color="green">
    <a-entity primitive="type: plane" material="color: purple"></a-entity>
  </a-plane>

  <a-cylinder color="red">
  </a-cylinder>
</a-cube>
```

becomes

``` html
<a-cube color="blue">
  <a-root>
    <a-entity primitive="type: plane" material="color: blue"></a-entity>
  </a-root>

  <a-plane color="green">
    <a-root>
      <a-entity primitive="type: plane" material="color: green"></a-entity>
    </a-root>

    <a-entity primitive="type: plane" material="color: purple"></a-entity>
  </a-plane>

  <a-cylinder color="red">
    <a-root>
      <a-entity primitive="type: cylinder" material="color: red"></a-entity>
    </a-root>
  </a-cylinder>
</a-cube>
```

now say if we got rid of the `<a-root>` elements:

``` html
<a-cube color="blue">
  <a-entity primitive="type: plane" material="color: blue"></a-entity>

  <a-plane color="green">
    <a-entity primitive="type: plane" material="color: green"></a-entity>

    <a-entity primitive="type: plane" material="color: purple"></a-entity>
  </a-plane>

  <a-cylinder color="red">
    <a-entity primitive="type: cylinder" material="color: red"></a-entity>
  </a-cylinder>
</a-cube>
```

it now becomes unclear which elements (`<a-entity>`s) correspond to the actual template instance. so if we want to change an element, such as `$('a-plane[color=green]').setAttribute('color', 'blue')`, then we need to know which of the potentially several child `<a-entity>` elements to update. that's why `<a-root>` exists.
 Can you store the elements somewhere before applying the template? In my PR I have two variables lightHTML and shadowHTML. You have shadowEls and lightEls to know what elements to update
 > Can you store the elements somewhere before applying the template? In my PR I have two variables lightHTML and shadowHTML. You have shadowEls and lightEls to know what elements to update

yes, but what if the attrs change?
 As I understand the reason for having `a-root` is to have all the template content within a single node so it can be easily replaced if one of the attributes of the template changes. We can can get rid of the `a-root` if we implement a binding between the attributes of the template and it's content elements. We need to do it also for performance reasons. Currently, for each template attribute change template we destroy all entities and recreate the whole sub tree. 

By **binding** templates and entities I mean a list that associates each template attribute to the entities and component attributes affected by them. This way you just update the relevant entities on `attributeChangedCallback` instead of recreating the whole tree.
 :+1: to what you've said, @dmarcos. we need to do it regardless. I was investigating using [Virtual DOM](https://github.com/Matt-Esch/virtual-dom) for this, but it's not necessary at themoment.

> We can can get rid of the `a-root` if we implement a binding between the attributes of the template and it's content elements. We need to do it also for performance reasons.

How would you imagine we could implement this? Shadow DOM kind of solves this, but using the [polyfill](https://github.com/webcomponents/webcomponentsjs/tree/master/src/ShadowDOM) is out of the question (it's incredibly slow and not spec-compliant).
 I have an idea but it might be silly. It involves making your [template formatter](https://github.com/MozVR/aframe/blob/master/elements/lib/utils.js#L104) a bit smarter. It would not only replace `$XXX` with the template values but also annotate the entities with special attributes that you will use later to create the bindings. We have the following template:

``` html
<template is="a-template"
          element="a-cube"
          color="gray">
  <a-entity geometry="primitive: box; width: 5; height: 5; depth: 5"
                 material="color: ${color};"></a-entity>
</template>
```

It would generate this markup:

``` html
<vr-cube color="gray">
  <a-entity material="color: gray;" data-bind-color="material.color" geometry="primitive: box; width: 5; height: 5; depth: 5" ></a-entity>
</vr-cube>
```

Note the attribute **data-bind-color="material.color"**.  It means that the `color` attribute of the template is bound to the `material.color` attribute of the entity.

Once the `shadow` entities are initialized your template code will do a second pass of processing. It will take all the entities with data-bind-XXX attributes and create bindings for them. I would keep a list `this.bindings[attrName] = [bindings to specific entities]` that you will traverse in the `attributeChangedCallback` of the template node to update the `shadow` entities. Once you create those bindings you can remove the `data-bind-XXX` attributes from the entity elements. 

This will give us what we want. Granular update of entities each time the template attributes change and we can also get rid of the `a-root` node. Additionally we can mark all the `shadow` entities with the `shadow` attribute if we want to make a clear distinction from the `light` ones. This could be used for instance by the editor to hide the `shadow` DOM. And as a stretch we could think about wrapping `querySelector` native method to filter out the `shadow` nodes.

@cvan What do you think?
 I think we can close this PR. We plan on moving to use primitives, which extend entities rather than template entities.
 There are some good points raised in here. Primitives are for wrapping and extending single entities. Templates serve a different use case: grouping multiple elements (and potentially some more advanced templating logic beyond the current variable string interpolation). Templates ought to continue to exist, but perf-wise there are some good ideas @dmarcos had that we ought to implement. In due time, yeah. I think they'll need to happen outside of this PR though.
  **`2.64 MB`** https://github.com/aframevr/aframe/blob/master/examples/showcase/composite/lake.jpg
**`149 KB`&nbsp;&nbsp;** https://github.com/aframevr/aframe/blob/master/examples/showcase/composite/portland.png
**`379 KB`&nbsp;&nbsp;** https://github.com/aframevr/aframe/blob/master/examples/showcase/composite/sculpture-tex.jpg
 @gasolin thanks - updated the links in the first comment
 also filed #1420 for other images that could use some compression. (many others have already been crushed/compressed.)
  it's working in https://mozvr.github.io/aframe/kit/docs/

expect to be fixed with #135 
  ![image](https://cloud.githubusercontent.com/assets/1560884/11157953/9de21504-8a09-11e5-9c9c-6742145aec07.png)

Looks to be an issue only with template objects (eg. vr-cube)

Works fine on standard vr-object entities.
 oops, yeah. for now just do `setAttribute('position', '0 0 5')`
 https://github.com/aframevr/aframe/pull/883
  https://github.com/MozVR/aframe-core/blob/93f1bdc/src/components/geometry.js#L88-L92
 Yep. We already have a torus
 Reopening. We do have a torus primitive geometry but this issue refers to a primitive `<`a-torus></a-torus>``
  Users should not have to manually specify the file format of a model (eg obj, collada, etc). 

In the current model template we provide a format attribute, defaulted to `format="collada"`. That's good enough for View Source, where we'll only be using Collada files, but we can't make that assumption for release. Novice users may very well try to drop obj files into their scenes, and shouldn't have to know about format="obj" for them to work.

A potential implementation:
- Maintain a format attribute
- If no format is specified, automatically apply the correct format based on src file extension
- If format is defined use that instead.
 We have separate components for `obj-model` and `collada-model`. Will have separate primitives as well `a-obj-model` and `a-collada-model`
  We like the simplicity of a `<a-sky>` template over separate (and more abstract) `<a-skysphere>` and `<a-skycube>` templates. However a combined approach will necessitate a way for devs to specify which type they want to use.

We envision something like the following:
- `type=""` Options are `sphere` or `cube`. Default is `sphere`.
- Other attributes then depend on the type.
- If sphere, user can specify `segments-width`, `segments-height`, `radius`, etc.
- If cube, user can specify `size`
- In both cases, user can specify `src`. 
  - For `sphere`, it must be the path to an image asset. 
  - For `cube`, it must be the path to a directory containing top, bottom, left, right, front, back images.
    - Note: this is subject to change, depending on what we do in core for cube map handling.

JS inside the template then handles the switching between types. 
 Will stick to https://github.com/aframevr/aframe/issues/45  change these too:

https://github.com/MozVR/aframe/blob/b8f6f0/examples/spheres/index.html#L12
https://github.com/MozVR/aframe/blob/b8f6f0/examples/spheres/index.html#L14
https://github.com/MozVR/aframe/blob/b8f6f0/examples/cubes/index.html#L14
https://github.com/MozVR/aframe/blob/b8f6f0/examples/cylinders/index.html#L14
https://github.com/MozVR/aframe/blob/b8f6f0/examples/planes/index.html#L14
 ok thanks
 # r+
  oooof
 mattdesl/budo#79 is closed. budo's ecstatic is gone. and I haven't seen this even in the days before budo's ecstatic dependency was removed.
 Budo's Live Reload still hangs on Windows. It takes a long time to reload and if the page is reloaded manually it takes about a minute to get the page loaded.
 /cc @mattdesl 
 I'm starting to see this again on Mac OS X. Very strange. I've filed #934 to check new budo and bump.
 Accidentally closed during merge
  replacing https://github.com/aframevr/aframe/pull/1671
  Enables the dev to add a grid to their scenes.

Dev can specify:
- Color (default is gray)
- Size (width and height of grid in meters. Default is 10)
- Density (number of horizontal and vertical segments in the grid. Default is 10).
 Removing blocker label for launch
 You could also write a fragment shader for the grid: https://aframe.io/docs/core/shaders.html#Creating-a-Custom-Shader
 What is the state of that issue?
 Not sure if we need to add to core, but can point to Don's which is on the Registry: 

https://github.com/donmccurdy/aframe-extras
https://npmjs.com/package/aframe-extras.grid
<img width="982" alt="screen shot 2017-03-31 at 10 20 50 pm" src="https://cloud.githubusercontent.com/assets/674727/24575629/52bafb4c-1660-11e7-80ae-6d8552e33b53.png">
  Enables devs to create 360¬∞ video players.

Features should be in line with what we had in pre-refactor `<vr-video>` and `<vr-video360>` components, and with the HTML5 `<video>` [spec](https://developer.mozilla.org/en/docs/Web/HTML/Element/video).  

Dev can specify:
- Video source
- Autoplay boolean
- Looping boolean
- Height
- Width
- Muted boolean
- Controls boolean (shows or hides controls for playback)

Please add anything missing from the above. Looking at the `<video>` element spec, I'm not sure how important `autobuffer`, `crossorigin`, and `poster` are, for example.

While the image is loading, nothing is visible. Should look at adding preloaders and/or placeholders in the future.
 Controls can be limited to a play/pause toggle initially. Longer term we can imagine adding:
- Time indicator
- Volume control
 Dependent on https://github.com/MozVR/vr-markup/issues/249
 This is done.
  In the [`vr-hemispherelight` component](https://github.com/MozVR/vr-components/blob/master/core/vr-hemispherelight.js), there's only a `createdCallback`, not a `attributeChangedCallback`.
 nice!
 it's gone
   is this clear to folks?
 and perhaps I should add a comment about `npm unlink`
 > Besides that, I would also document that the user should run both dev servers for `vr-components` and `vr-markup`, and they should use the bundle served in memory at `http://localhost:9001/build/vr-components.js` rather than the one on the filesystem so they don't have to re-run build all the time.

Even if just `vr-components`'s dev server is running, the bundle gets recompiled automatically actually when the files change. Does that not happen for you?
 @ngokevin: thanks for the good feedback. I've addressed everything except the most recent comment, which I just responded to.

let me know what you think.
